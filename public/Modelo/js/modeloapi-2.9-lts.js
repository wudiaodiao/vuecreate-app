!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Modelo",[],t):"object"==typeof exports?exports.Modelo=t():e.Modelo=t()}(this,function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}({"./00utility/Config.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"Config",function(){return i});const i={webvr:!1,compressNormals:!1,maxInstanceCount:1e3}},"./00utility/Environment.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"Environment",function(){return i});var i={isMobile:!1,devicePixelRatio:1,littleEndian:!0,gpuMemory:256,browserName:"",browserVersion:""}},"./00utility/Path.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"Path3D",function(){return n});var i=r("./glMatrix.js");class n{constructor(e,t=[0,0,1],r){this.path=e,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(var n=0;n<e.length;n++)this._curve[n]=i.vec3.clone(e[n]);this._useDefaultUpVector=r,this._compute(t)}getCurve(){return this._curve}getTangents(){return this._tangents}getNormals(){return this._normals}getBinormals(){return this._binormals}getDistances(){return this._distances}update(e,t,r){for(var i=0;i<e.length;i++)this._curve[i].x=e[i].x,this._curve[i].y=e[i].y,this._curve[i].z=e[i].z;return this._useDefaultUpVector=r,this._compute(t),this}_compute(e){var t=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),i.vec3.normalize(this._tangents[0],this._tangents[0]),this._tangents[t-1]=i.vec3.create(),i.vec3.subtract(this._tangents[t-1],this._curve[t-1],this._curve[t-2]),i.vec3.normalize(this._tangents[t-1],this._tangents[t-1]);var r,n,a,s=this._tangents[0],o=this._normalVector(s,e);this._normals[0]=o,i.vec3.normalize(this._normals[0],this._normals[0]),this._binormals[0]=i.vec3.create(),i.vec3.cross(this._binormals[0],s,this._normals[0]),i.vec3.normalize(this._binormals[0],this._binormals[0]),this._distances[0]=0;for(var l=i.vec3.create(),d=1;d<t;d++)r=this._getLastNonNullVector(d),d<t-1&&(n=this._getFirstNonNullVector(d),this._tangents[d]=i.vec3.create(),this._tangents[d]=n,i.vec3.normalize(this._tangents[d],this._tangents[d])),this._distances[d]=this._distances[d-1]+i.vec3.length(r),a=this._tangents[d],this._binormals[d-1],this._normals[d]=i.vec3.create(),i.vec3.cross(l,a,this._normals[d-1]),i.vec3.cross(this._normals[d],l,a),i.vec3.normalize(this._normals[d],this._normals[d]),this._binormals[d]=i.vec3.create(),i.vec3.cross(this._binormals[d],a,this._normals[d]),i.vec3.normalize(this._binormals[d],this._binormals[d])}_getFirstNonNullVector(e){var t=1,r=i.vec3.create();for(i.vec3.subtract(r,this._curve[e+t],this._curve[e]),this._useDefaultUpVector&&(r[2]=0);0===i.vec3.length(r)&&e+t+1<this._curve.length;)t++,i.vec3.subtract(r,this._curve[e+t],this._curve[e]),this._useDefaultUpVector&&(r[2]=0);return 0===i.vec3.length(r)&&(r=i.vec3.fromValues(0,1,0)),r}_getLastNonNullVector(e){var t=1,r=i.vec3.create();for(i.vec3.subtract(r,this._curve[e],this._curve[e-t]),this._useDefaultUpVector&&(r[2]=0);0===i.vec3.length(r)&&e>t+1;)t++,r=this._curve[e].subtract(this._curve[e-t]),this._useDefaultUpVector&&(r[2]=0);return 0===i.vec3.length(r)&&(r=i.vec3.fromValues(0,1,0)),r}_normalVector(e,t){var r,n=i.vec3.create(),a=i.vec3.length(e);(0===a&&(a=1),null==t)?(r=Math.abs(Math.abs(e.y)/a-1)>.001?[0,-1,0]:Math.abs(Math.abs(e.x)/a-1)>.001?[1,0,0]:Math.abs(Math.abs(e.z)/a-1)>.001?[0,0,1]:i.vec3.create(),i.vec3.cross(n,e,r)):(i.vec3.cross(n,e,t),i.vec3.cross(n,n,e));return i.vec3.normalize(n,n),n}}},"./00utility/m3d_hwinfo.js":function(e,t,r){"use strict";r.r(t);var i=r("./node_modules/ua-parser-js/src/ua-parser.js"),n=r.n(i);t.default=function(){return function(){this.vramSize=0,this.littleEndian=!0;var e=(new n.a).getResult(),t=(e.device.model||"").toLowerCase();switch(this.browserName=(e.browser&&e.browser.name||"").toLowerCase(),this.browserVersion=(e.browser&&e.browser.major||"").toLowerCase(),t){case"iphone":this.vramSize=1024;break;case"ipad":this.vramSize=2048;break;default:this.vramSize=4096}}}()},"./00utility/m3d_interpolator.js":function(e,t,r){"use strict";var i;r.r(t),t.default=((i={linear:{}}).linear.vec3=function(e,t,r,i){var n=1-i;e[0]=n*t[0]+i*r[0],e[1]=n*t[1]+i*r[1],e[2]=n*t[2]+i*r[2]},i.linear.scalar=function(e,t,r){return(1-r)*e+r*t},i.cubic={},i.cubic.vec3=function(e,t,r,i){var n=1-(i=3*i*i-2*i*i*i);e[0]=n*t[0]+i*r[0],e[1]=n*t[1]+i*r[1],e[2]=n*t[2]+i*r[2]},i.cubic.scalar=function(e,t,r,i){return(1-(i=3*i*i-2*i*i*i))*t+i*r},i)},"./00utility/m3d_math.js":function(e,t,r){"use strict";r.r(t);var i=r("./glMatrix.js");t.default=function(){var e={cone:{_theta:0,_tanTheta:0}};e.cone.create=function(){return{tip:i.vec3.create(),direction:i.vec3.create(),cosThetaSquared:0,sinThetaSquared:0,invSinTheta:0}},e.cone.updateShape=function(e,t,r){this._theta=.017453293*t*.5,this._tanTheta=Math.tan(this._theta),this._tanTheta*=Math.sqrt(1+r*r),e.cosThetaSquared=1/(this._tanTheta*this._tanTheta+1),e.sinThetaSquared=1-e.cosThetaSquared,e.invSinTheta=1/Math.sqrt(e.sinThetaSquared)},e.aabb={_vec:new Float32Array(3)},e.aabb.createFromArray=function(e){var t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.aabb.createFromSphere=function(e){var t=new Float32Array(6);return t[0]=e[0]-e[3],t[1]=e[1]-e[3],t[2]=e[2]-e[3],t[3]=e[0]+e[3],t[4]=e[1]+e[3],t[5]=e[2]+e[3],t},e.aabb.createFromPoints=function(e,t){e[0]=t[0][0],e[3]=t[0][0],e[1]=t[0][1],e[4]=t[0][1],e[2]=t[0][2],e[5]=t[0][2];for(var r=1,i=t.length;r<i;r++)e[0]>t[r][0]&&(e[0]=t[r][0]),e[3]<t[r][0]&&(e[3]=t[r][0]),e[1]>t[r][1]&&(e[1]=t[r][1]),e[4]<t[r][1]&&(e[4]=t[r][1]),e[2]>t[r][2]&&(e[2]=t[r][2]),e[5]<t[r][2]&&(e[5]=t[r][2]);return e},e.aabb.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e};var t=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],r=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE];e.aabb.create=function(e,i){var n=new Float32Array(6);return e=e||t,i=i||r,n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=i[0],n[4]=i[1],n[5]=i[2],n},e.aabb.invalidate=function(e){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=r[0],e[4]=r[1],e[5]=r[2]},e.aabb.min=function(e){return i.vec3.fromValues(e[0],e[1],e[2])},e.aabb.max=function(e){return i.vec3.fromValues(e[3],e[4],e[5])},e.aabb.length=function(e){var t=e[3]-e[0],r=e[4]-e[1],i=e[5]-e[2];return Math.sqrt(t*t+r*r+i*i)},e.aabb.isEqual=function(e,t){return Math.abs(e[0]-t[0])<1e-6&&Math.abs(e[1]-t[1])<1e-6&&Math.abs(e[2]-t[2])<1e-6&&Math.abs(e[3]-t[3])<1e-6&&Math.abs(e[4]-t[4])<1e-6&&Math.abs(e[5]-t[5])<1e-6},e.aabb.union=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e[4]=Math.max(t[4],r[4]),e[5]=Math.max(t[5],r[5]),e},e.aabb.moveTo=function(e,t,r){let i=r[0]-.5*(t[0]+t[3]),n=r[1]-.5*(t[1]+t[4]),a=r[2]-.5*(t[2]+t[5]);return e[0]=t[0]+i,e[1]=t[1]+n,e[2]=t[2]+a,e[3]=t[3]+i,e[4]=t[4]+n,e[5]=t[5]+a,e},e.aabb.scaleTo=function(e,t,r){var i=.5*(t[0]+t[3])-.5*r[0],n=.5*(t[0]+t[3])+.5*r[0],a=.5*(t[1]+t[4])-.5*r[1],s=.5*(t[1]+t[4])+.5*r[1],o=.5*(t[2]+t[5])-.5*r[2],l=.5*(t[2]+t[5])+.5*r[2];e[0]=i,e[3]=n,e[1]=a,e[4]=s,e[2]=o,e[5]=l},e.aabb.scale=function(e,t,r){var i=.5-.5*r,n=.5+.5*r,a=t[0]*n+t[3]*i,s=t[0]*i+t[3]*n,o=t[1]*n+t[4]*i,l=t[1]*i+t[4]*n,d=t[2]*n+t[5]*i,u=t[2]*i+t[5]*n;e[0]=a,e[3]=s,e[1]=o,e[4]=l,e[2]=d,e[5]=u},e.aabb.expand=function(e,t){void 0===t&&(t=1e-4),e[0]-=t,e[1]-=t,e[2]-=t,e[3]+=t,e[4]+=t,e[5]+=t},e.aabb.points=function(e){var t=[];return t.push(i.vec3.fromValues(e[0],e[1],e[2])),t.push(i.vec3.fromValues(e[3],e[1],e[2])),t.push(i.vec3.fromValues(e[3],e[4],e[2])),t.push(i.vec3.fromValues(e[0],e[4],e[2])),t.push(i.vec3.fromValues(e[0],e[1],e[5])),t.push(i.vec3.fromValues(e[3],e[1],e[5])),t.push(i.vec3.fromValues(e[3],e[4],e[5])),t.push(i.vec3.fromValues(e[0],e[4],e[5])),t},e.aabb.points2=function(e,t){return t[0][0]=e[0],t[0][1]=e[1],t[0][2]=e[2],t[1][0]=e[3],t[1][1]=e[1],t[1][2]=e[2],t[2][0]=e[3],t[2][1]=e[4],t[2][2]=e[2],t[3][0]=e[0],t[3][1]=e[4],t[3][2]=e[2],t[4][0]=e[0],t[4][1]=e[1],t[4][2]=e[5],t[5][0]=e[3],t[5][1]=e[1],t[5][2]=e[5],t[6][0]=e[3],t[6][1]=e[4],t[6][2]=e[5],t[7][0]=e[0],t[7][1]=e[4],t[7][2]=e[5],t},e.aabb.points3=function(e,t){return t[0][0]=e[0],t[0][1]=e[1],t[0][2]=e[2],t[1][0]=e[3],t[1][1]=e[1],t[1][2]=e[2],t[2][0]=e[3],t[2][1]=e[1],t[2][2]=e[5],t[3][0]=e[0],t[3][1]=e[1],t[3][2]=e[5],t[4][0]=e[0],t[4][1]=e[4],t[4][2]=e[2],t[5][0]=e[3],t[5][1]=e[4],t[5][2]=e[2],t[6][0]=e[3],t[6][1]=e[4],t[6][2]=e[5],t[7][0]=e[0],t[7][1]=e[4],t[7][2]=e[5],t},e.aabb.planes=function(e){var t=[];return t.push(i.vec4.fromValues(-1,0,0,e[0])),t.push(i.vec4.fromValues(0,-1,0,e[1])),t.push(i.vec4.fromValues(0,0,-1,e[2])),t.push(i.vec4.fromValues(1,0,0,-e[3])),t.push(i.vec4.fromValues(0,1,0,-e[4])),t.push(i.vec4.fromValues(0,0,1,-e[5])),t},e.aabb.volume=function(e){return(e[3]-e[0])*(e[4]-e[1])*(e[5]-e[2])};var n={width:0,height:0,depth:0};e.aabb.size=function(e){return n.width=e[3]-e[0],n.height=e[4]-e[1],n.depth=e[5]-e[2],n},e.aabb.center=function(e){return[.5*(e[0]+e[3]),.5*(e[1]+e[4]),.5*(e[2]+e[5])]};var a=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]];e.aabb.transform=function(t,r,n){e.aabb.points2(r,a),i.vec3.transformMat4(a[0],a[0],n),i.vec3.transformMat4(a[1],a[1],n),i.vec3.transformMat4(a[2],a[2],n),i.vec3.transformMat4(a[3],a[3],n),i.vec3.transformMat4(a[4],a[4],n),i.vec3.transformMat4(a[5],a[5],n),i.vec3.transformMat4(a[6],a[6],n),i.vec3.transformMat4(a[7],a[7],n),t[0]=a[0][0],t[3]=a[0][0],t[1]=a[0][1],t[4]=a[0][1],t[2]=a[0][2],t[5]=a[0][2];for(var s=1;s<8;s++)t[0]>a[s][0]&&(t[0]=a[s][0]),t[3]<a[s][0]&&(t[3]=a[s][0]),t[1]>a[s][1]&&(t[1]=a[s][1]),t[4]<a[s][1]&&(t[4]=a[s][1]),t[2]>a[s][2]&&(t[2]=a[s][2]),t[5]<a[s][2]&&(t[5]=a[s][2])},e.plane={},e.plane.create=function(e,t,r){var n=t[0]-e[0],a=t[1]-e[1],s=t[2]-e[2],o=r[0]-e[0],l=r[1]-e[1],d=r[2]-e[2],u=i.vec4.create();return u[0]=a*d-s*l,u[1]=s*o-n*d,u[2]=n*l-a*o,u[3]=-(u[0]*e[0]+u[1]*e[1]+u[2]*e[2]),this.normalize(u),u},e.plane.createABCD=function(e,t,r,n){var a=i.vec4.fromValues(e,t,r,n);return this.normalize(a),a},e.plane.normalize=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t,e[3]/=t},e.sphere={},e.sphere.createFromAABB=function(t){var r=new Float32Array(4);return r[0]=.5*(t[0]+t[3]),r[1]=.5*(t[1]+t[4]),r[2]=.5*(t[2]+t[5]),r[3]=.5*e.aabb.length(t),r},e.sphere.createFromArray=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.frustum={};var s=i.mat4.create();e.frustum.createFromMatrix=function(t){var r,n=[];for(r=0;r<14;++r)n.push(i.vec4.create());for(i.mat4.invert(s,t),i.vec4.transformMat4(n[6],[-1,-1,-1,1],s),i.vec4.transformMat4(n[7],[1,-1,-1,1],s),i.vec4.transformMat4(n[8],[1,-1,1,1],s),i.vec4.transformMat4(n[9],[-1,-1,1,1],s),i.vec4.transformMat4(n[10],[-1,1,-1,1],s),i.vec4.transformMat4(n[11],[1,1,-1,1],s),i.vec4.transformMat4(n[12],[1,1,1,1],s),i.vec4.transformMat4(n[13],[-1,1,1,1],s),r=6;r<14;++r)i.vec4.scale(n[r],n[r],1/n[r][3]);var a=-t[3],o=-t[7],l=-t[11],d=-t[15];return n[0]=e.plane.createABCD(a-t[2],o-t[6],l-t[10],d-t[14]),n[1]=e.plane.createABCD(a+t[2],o+t[6],l+t[10],d+t[14]),n[2]=e.plane.createABCD(a+t[1],o+t[5],l+t[9],d+t[13]),n[3]=e.plane.createABCD(a-t[1],o-t[5],l-t[9],d-t[13]),n[4]=e.plane.createABCD(a-t[0],o-t[4],l-t[8],d-t[12]),n[5]=e.plane.createABCD(a+t[0],o+t[4],l+t[8],d+t[12]),n},e.frustum.points=function(e){return e.slice(6)},e.frustum.planes=function(e){var t=[];return t.push(e[0]),t.push(e[1]),t.push(e[2]),t.push(e[3]),t.push(e[4]),t.push(e[5]),t},e.intersect={_temp:[0,0,0],_U:[0,0,0],_D:[0,0,0],_vec:[0,0,0],_diff:[0,0,0],_v0:[0,0,0],_v1:[0,0,0],_v2:[0,0,0]},e.intersect.line_plane=function(e,t,r){i.vec3.subtract(this._diff,e,t),i.vec3.normalize(this._vec,this._diff);var n=i.vec3.dot(this._vec,r);if(Math.abs(n)<=.001)return null;for(var a=-(i.vec3.dot(t,r)+r[3])/n,s=0;s<3;++s)if(a*this._vec[s]/this._diff[s]<0||a*this._vec[s]/this._diff[s]>1)return null;var o=i.vec3.create();return o[0]=t[0]+a*this._vec[0],o[1]=t[1]+a*this._vec[1],o[2]=t[2]+a*this._vec[2],o},e.intersect.line_frustum=function(t,r,i,n){for(var a=[[0,1,5,4],[2,3,7,6],[4,5,6,7],[0,3,2,1],[0,4,7,3],[1,2,6,5]],s=!1,o=0;o<6;o++){var l=i[o],d=[];d.push(i[a[o][0]+6]),d.push(i[a[o][1]+6]),d.push(i[a[o][2]+6]),d.push(i[a[o][3]+6]);var u=e.intersect.line_frustum_quad(t,r,l,d);null!==u&&(n.push(u),s=!0)}return s},e.intersect.line_aabb=function(t,r,i,n){for(var a=e.aabb.planes(i),s=!1,o=0;o<6;o++){var l=e.intersect.line_aabb_quad(t,r,a[o],i,o);null!=l&&(n.push(l),s=!0)}return s},e.intersect.line_frustum_quad=function(t,r,i,n){var a;return null==(a=e.intersect.line_plane(t,r,i))?null:e.inside.point_triangle(n[0],n[1],n[2],a)||e.inside.point_triangle(n[2],n[3],n[0],a)?a:null},e.intersect.line_aabb_quad=function(t,r,i,n,a){var s;if(null===(s=e.intersect.line_plane(t,r,i)))return null;var o=!1;switch(a){case 1:case 4:o=e.inside.point_slab(s[0],n[0],n[3])&&e.inside.point_slab(s[2],n[2],n[5]);break;case 5:case 2:o=e.inside.point_slab(s[0],n[0],n[3])&&e.inside.point_slab(s[1],n[1],n[4]);break;case 0:case 3:o=e.inside.point_slab(s[1],n[1],n[4])&&e.inside.point_slab(s[2],n[2],n[5])}return o?s:null};var o=new Array(4);return e.intersect.ray_aabb=function(e,t,r){for(var i=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,a=!0,s=-1,l=0;l<3;l++){var d=t[l],u=e[l],c=r[l],h=r[l+3];if(0!==d){var m=(c-u)/d,f=(h-u)/d,p=0;if(m>f){var v=f;f=m,m=v,p=1}if(m>i&&(i=m,s=2*l+p),(i=Math.max(m,i))>(n=Math.min(f,n))){a=!1;break}if(n<0){a=!1;break}}else if(d<c||d>h){a=!1;break}}return a?(o[0]=e[0]+t[0]*i,o[1]=e[1]+t[1]*i,o[2]=e[2]+t[2]*i,o[3]=s,o):null},e.intersect.sphere_frustum=function(e,t){return i.vec3.dot(t[0],e)+t[0][3]<e[3]&&i.vec3.dot(t[1],e)+t[1][3]<e[3]&&i.vec3.dot(t[2],e)+t[2][3]<e[3]&&i.vec3.dot(t[3],e)+t[3][3]<e[3]&&i.vec3.dot(t[4],e)+t[4][3]<e[3]&&i.vec3.dot(t[5],e)+t[5][3]<e[3]},e.intersect.sphere_cone=function(e,t){i.vec3.scale(this._temp,t.direction,t.invSinTheta*e[3]),i.vec3.subtract(this._U,t.tip,this._temp),i.vec3.subtract(this._D,e,this._U);var r=i.vec3.dot(this._D,this._D),n=i.vec3.dot(t.direction,this._D);return n>0&&n*n>=r*t.cosThetaSquared&&(i.vec3.subtract(this._D,e,t.tip),r=i.vec3.dot(this._D,this._D),!((n=-i.vec3.dot(t.direction,this._D))>0&&n*n>=r*t.sinThetaSquared)||r<=e[3]*e[3])},e.intersect.aabb_frustum=function(t,r){var i,n=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],a=e.aabb.points(t),s=e.frustum.points(r),o=[];for(i=0;i<12;i++)e.intersect.line_frustum(a[n[i][0]],a[n[i][1]],r,o);for(i=0;i<12;i++)e.intersect.line_aabb(s[n[i][0]],s[n[i][1]],t,o);for(i=0;i<8;i++){var l=a[i];e.inside.point_frustum(l,r)&&o.push(l)}for(i=0;i<8;i++){var d=s[i];e.inside.point_aabb(d,t)&&o.push(d)}return o},e.intersect.aabb_aabb=function(t,r){return(e.inside.point_slab(t[0],r[0],r[3])||e.inside.point_slab(t[3],r[0],r[3]))&&(e.inside.point_slab(t[1],r[1],r[4])||e.inside.point_slab(t[4],r[1],r[4]))&&(e.inside.point_slab(t[2],r[2],r[5])||e.inside.point_slab(t[5],r[2],r[5]))||(e.inside.point_slab(r[0],t[0],t[3])||e.inside.point_slab(r[3],t[0],t[3]))&&(e.inside.point_slab(r[1],t[1],t[4])||e.inside.point_slab(r[4],t[1],t[4]))&&(e.inside.point_slab(r[2],t[2],t[5])||e.inside.point_slab(r[5],t[2],t[5]))},e.inside={_v0:new Float32Array(3),_v1:new Float32Array(3),_v2:new Float32Array(3)},e.inside.point_triangle=function(e,t,r,n){i.vec3.subtract(this._v0,r,e),i.vec3.subtract(this._v1,t,e),i.vec3.subtract(this._v2,n,e);var a=i.vec3.dot(this._v0,this._v0),s=i.vec3.dot(this._v0,this._v1),o=i.vec3.dot(this._v0,this._v2),l=i.vec3.dot(this._v1,this._v1),d=i.vec3.dot(this._v1,this._v2),u=1/(a*l-s*s),c=(l*o-s*d)*u;if(c<0||c>1)return!1;var h=(a*d-s*o)*u;return!(h<0||h>1)&&c+h<=1},e.inside.point_aabb=function(e,t){return e[0]>t[0]&&e[1]>t[1]&&e[2]>t[2]&&e[0]<t[3]&&e[1]<t[4]&&e[2]<t[5]},e.inside.point_frustum=function(e,t){return i.vec3.dot(t[0],e)+t[0][3]<0&&i.vec3.dot(t[1],e)+t[1][3]<0&&i.vec3.dot(t[2],e)+t[2][3]<0&&i.vec3.dot(t[3],e)+t[3][3]<0&&i.vec3.dot(t[4],e)+t[4][3]<0&&i.vec3.dot(t[5],e)+t[5][3]<0},e.inside.sphere_frustum=function(e,t){return i.vec3.dot(t[0],e)+t[0][3]<-e[3]&&i.vec3.dot(t[1],e)+t[1][3]<-e[3]&&i.vec3.dot(t[2],e)+t[2][3]<-e[3]&&i.vec3.dot(t[3],e)+t[3][3]<-e[3]&&i.vec3.dot(t[4],e)+t[4][3]<-e[3]&&i.vec3.dot(t[5],e)+t[5][3]<-e[3]},e.inside.point_slab=function(e,t,r){return e<r&&e>t},e.inside.aabb_frustum=function(t,r){var i=e.aabb.points(t);return e.inside.point_frustum(i[0],r)&&e.inside.point_frustum(i[1],r)&&e.inside.point_frustum(i[2],r)&&e.inside.point_frustum(i[3],r)&&e.inside.point_frustum(i[4],r)&&e.inside.point_frustum(i[5],r)&&e.inside.point_frustum(i[6],r)&&e.inside.point_frustum(i[7],r)},e.outside={},e.outside.point_frustum=function(e,t){return i.vec3.dot(t[0],e)+t[0][3]>0||i.vec3.dot(t[1],e)+t[1][3]>0||i.vec3.dot(t[2],e)+t[2][3]>0||i.vec3.dot(t[3],e)+t[3][3]>0||i.vec3.dot(t[4],e)+t[4][3]>0||i.vec3.dot(t[5],e)+t[5][3]>0},e.outside.sphere_frustum=function(e,t){return i.vec3.dot(t[0],e)+t[0][3]>e[3]||i.vec3.dot(t[1],e)+t[1][3]>e[3]||i.vec3.dot(t[2],e)+t[2][3]>e[3]||i.vec3.dot(t[3],e)+t[3][3]>e[3]||i.vec3.dot(t[4],e)+t[4][3]>e[3]||i.vec3.dot(t[5],e)+t[5][3]>e[3]},e.outside.aabb_frustum=function(e,t){for(var r=0;r<6;r++){var i=t[r][0]>0?e[0]:e[3],n=t[r][1]>0?e[1]:e[4],a=t[r][2]>0?e[2]:e[5];if(t[r][0]*i+t[r][1]*n+t[r][2]*a+t[r][3]>0)return!0}for(r=0;r<3;r++){if(t[6][r]>e[1][r]&&t[7][r]>e[1][r]&&t[8][r]>e[1][r]&&t[9][r]>e[1][r]&&t[10][r]>e[1][r]&&t[11][r]>e[1][r]&&t[12][r]>e[1][r]&&t[13][r]>e[1][r])return!0;if(t[6][r]<e[0][r]&&t[7][r]<e[0][r]&&t[8][r]<e[0][r]&&t[9][r]<e[0][r]&&t[10][r]<e[0][r]&&t[11][r]<e[0][r]&&t[12][r]<e[0][r]&&t[13][r]<e[0][r])return!0}return!1},e.outside.aabb_aabb=function(e,t){return e[3]<=t[0]||e[0]>=t[3]||e[4]<=t[1]||e[1]>=t[4]||e[5]<=t[2]||e[2]>=t[5]},e.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},e.lerp=function(e,t,r){return e+(t-e)*r},e}()},"./00utility/m3d_utils.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{static isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}static indexOf(e,t){if(!i.isArray(e))return console.error("Not an array!"),-1;for(var r=0,n=e.length;r<n;++r)if(e[r]===t)return r;return-1}}},"./01wrapper/glenum.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"gl",function(){return i});var i={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,LINEAR_MIPMAP_LINEAR:9987,LINEAR:9729,NEAREST:9728,NEAREST_MIPMAP_NEAREST:9984,REPEAT:10497,CLAMP_TO_EDGE:33071,RGBA:6408,RGB:6407}},"./01wrapper/m3d_wgl.release.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/Environment.ts");t.default=function(){return function(e,t){t.antialias=!t.webgl2&&t.samples>1,t.depth=!t.webgl2&&t.depth;var r=WebGLUtils.setupWebGL(e,t);r.version=r.getParameter(r.VERSION);var n=null!==r.version.match("WebGL 2.0");if(n)r.floatTextureExtension=r.getExtension("EXT_color_buffer_float"),r.floatTextureExtension2=r.getExtension("OES_texture_float_linear"),r.instancingExtension=t.instancing,r.COLOR_ATTACHMENT0_WEBGL=r.COLOR_ATTACHMENT0;else{t.instancing&&(r.instancingExtension=r.getExtension("ANGLE_instanced_arrays")),r.instancingExtension?(t.vao&&console.warn("Instance drawing and VAO cannot use at same time. Turn off VAO."),r.drawElementsInstanced=function(e,t,i,n,a){r.instancingExtension.drawElementsInstancedANGLE(e,t,i,n,a)},r.vertexAttribDivisor=function(e,t){r.instancingExtension.vertexAttribDivisorANGLE(e,t)}):(t.vao&&(r.vaoExtension=r.getExtension("OES_vertex_array_object")),r.vaoExtension&&(r.deleteVertexArray=function(e){return r.vaoExtension.deleteVertexArrayOES(e)},r.bindVertexArray=function(e){return r.vaoExtension.bindVertexArrayOES(e)},r.createVertexArray=function(){return r.vaoExtension.createVertexArrayOES()})),r.floatTextureExtension=(r.getExtension("OES_texture_float")||r.getExtension("WEBGL_color_buffer_float"))&&r.getExtension("OES_texture_float_linear"),r.depthTextureExtension=r.getExtension("WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture"),r.uintIBOExtension=r.getExtension("OES_element_index_uint");var a=r.getExtension("WEBGL_draw_buffers");r.COLOR_ATTACHMENT0_WEBGL=a?a.COLOR_ATTACHMENT0_WEBGL:r.COLOR_ATTACHMENT0,r.s3tcExtension=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),r.halfFloatExtension=r.getExtension("OES_texture_half_float"),r.halfFloatLinearExtension=r.getExtension("OES_texture_half_float_linear")}var s=new Uint8Array(4);return r.syncGPU=function(){"chrome"===i.Environment.browserName?r.readPixels(0,0,1,1,r.RGBA,r.UNSIGNED_BYTE,s):r.finish()},r.isWebGL2=n,r.isWebGL2||(r.RGBA8=r.RGBA,r.RGB8=r.RGB,r.DEPTH24_STENCIL8=r.DEPTH_STENCIL,r.DEPTH_COMPONENT24=r.DEPTH_COMPONENT,r.RGBA32F=34836,r.RGB32F=34837),r.wbSamples=t.samples,r.wbFormat=t.alpha?r.RGBA8:r.RGB8,r.wbDepthFormat=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,r}}()},"./02resource/BitmapFont.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./02resource/Resource.ts"),n=r("./02resource/Texture.ts");const a="data:image/png;base64,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";class s extends i.default{constructor(e){super("bitmap-font",e),this._asciiMap=new Map,this._bitmap=new n.default("bitmap-font",e),this.ready=!1,this._fontInfo={name:"Arial",size:32,bold:!1,italic:!1,width:1024,height:128,characters:{0:{x:288,y:42,width:27,height:35,originX:5,originY:29,advance:18},1:{x:630,y:42,width:21,height:35,originX:3,originY:29,advance:18},2:{x:120,y:42,width:28,height:35,originX:5,originY:29,advance:18},3:{x:315,y:42,width:27,height:35,originX:5,originY:29,advance:18},4:{x:148,y:42,width:28,height:35,originX:6,originY:29,advance:18},5:{x:176,y:42,width:28,height:35,originX:5,originY:28,advance:18},6:{x:342,y:42,width:27,height:35,originX:5,originY:29,advance:18},7:{x:735,y:42,width:27,height:34,originX:5,originY:28,advance:18},8:{x:204,y:42,width:28,height:35,originX:5,originY:29,advance:18},9:{x:232,y:42,width:28,height:35,originX:5,originY:29,advance:18}," ":{x:471,y:77,width:12,height:12,originX:6,originY:6,advance:9},"!":{x:672,y:42,width:16,height:35,originX:3,originY:29,advance:9},'"':{x:304,y:77,width:21,height:20,originX:5,originY:29,advance:11},"#":{x:393,y:0,width:30,height:36,originX:6,originY:29,advance:18},$:{x:197,y:0,width:27,height:40,originX:5,originY:30,advance:18},"%":{x:562,y:0,width:37,height:35,originX:4,originY:29,advance:28},"&":{x:361,y:0,width:32,height:36,originX:5,originY:29,advance:21},"'":{x:325,y:77,width:16,height:20,originX:5,originY:29,advance:6},"(":{x:85,y:0,width:20,height:42,originX:4,originY:29,advance:10},")":{x:105,y:0,width:20,height:42,originX:4,originY:29,advance:10},"*":{x:281,y:77,width:23,height:22,originX:5,originY:29,advance:12},"+":{x:143,y:77,width:28,height:27,originX:4,originY:24,advance:18},",":{x:341,y:77,width:16,height:19,originX:3,originY:9,advance:9},"-":{x:403,y:77,width:21,height:15,originX:5,originY:15,advance:10},".":{x:424,y:77,width:16,height:15,originX:3,originY:9,advance:9},"/":{x:478,y:0,width:21,height:36,originX:6,originY:29,advance:9},":":{x:127,y:77,width:16,height:28,originX:3,originY:22,advance:9},";":{x:762,y:42,width:16,height:33,originX:3,originY:22,advance:9},"<":{x:171,y:77,width:28,height:27,originX:4,originY:25,advance:18},"=":{x:253,y:77,width:28,height:22,originX:4,originY:22,advance:18},">":{x:199,y:77,width:28,height:27,originX:4,originY:25,advance:18},"?":{x:369,y:42,width:27,height:35,originX:5,originY:29,advance:18},"@":{x:0,y:0,width:42,height:42,originX:4,originY:29,advance:32},A:{x:599,y:0,width:34,height:35,originX:6,originY:29,advance:21},B:{x:0,y:42,width:30,height:35,originX:4,originY:29,advance:21},C:{x:328,y:0,width:33,height:36,originX:5,originY:29,advance:23},D:{x:799,y:0,width:32,height:35,originX:4,originY:29,advance:23},E:{x:30,y:42,width:30,height:35,originX:4,originY:29,advance:21},F:{x:260,y:42,width:28,height:35,originX:4,originY:29,advance:19},G:{x:294,y:0,width:34,height:36,originX:4,originY:29,advance:25},H:{x:831,y:0,width:31,height:35,originX:4,originY:29,advance:23},I:{x:688,y:42,width:16,height:35,originX:3,originY:29,advance:9},J:{x:583,y:42,width:25,height:35,originX:5,originY:29,advance:16},K:{x:862,y:0,width:31,height:35,originX:4,originY:29,advance:21},L:{x:396,y:42,width:27,height:35,originX:4,originY:29,advance:18},M:{x:633,y:0,width:34,height:35,originX:4,originY:29,advance:26},N:{x:893,y:0,width:31,height:35,originX:4,originY:29,advance:23},O:{x:259,y:0,width:35,height:36,originX:5,originY:29,advance:25},P:{x:60,y:42,width:30,height:35,originX:4,originY:29,advance:21},Q:{x:224,y:0,width:35,height:37,originX:5,originY:29,advance:25},R:{x:667,y:0,width:33,height:35,originX:4,originY:29,advance:23},S:{x:924,y:0,width:31,height:35,originX:5,originY:29,advance:21},T:{x:955,y:0,width:31,height:35,originX:5,originY:29,advance:19},U:{x:986,y:0,width:31,height:35,originX:4,originY:29,advance:23},V:{x:700,y:0,width:33,height:35,originX:6,originY:29,advance:21},W:{x:520,y:0,width:42,height:35,originX:6,originY:29,advance:30},X:{x:733,y:0,width:33,height:35,originX:6,originY:29,advance:21},Y:{x:766,y:0,width:33,height:35,originX:6,originY:29,advance:21},Z:{x:90,y:42,width:30,height:35,originX:5,originY:29,advance:19},"[":{x:159,y:0,width:19,height:41,originX:4,originY:29,advance:9},"\\":{x:499,y:0,width:21,height:36,originX:6,originY:29,advance:9},"]":{x:178,y:0,width:19,height:41,originX:6,originY:29,advance:9},"^":{x:227,y:77,width:26,height:24,originX:5,originY:29,advance:15},_:{x:440,y:77,width:31,height:14,originX:7,originY:1,advance:18},"`":{x:385,y:77,width:18,height:16,originX:5,originY:29,advance:10},a:{x:960,y:42,width:27,height:29,originX:5,originY:23,advance:18},b:{x:423,y:42,width:27,height:35,originX:4,originY:29,advance:18},c:{x:987,y:42,width:27,height:29,originX:5,originY:23,advance:16},d:{x:450,y:42,width:27,height:35,originX:5,originY:29,advance:18},e:{x:848,y:42,width:28,height:29,originX:5,originY:23,advance:18},f:{x:608,y:42,width:22,height:35,originX:6,originY:29,advance:9},g:{x:451,y:0,width:27,height:36,originX:5,originY:23,advance:18},h:{x:531,y:42,width:26,height:35,originX:4,originY:29,advance:18},i:{x:704,y:42,width:16,height:35,originX:4,originY:29,advance:7},j:{x:125,y:0,width:19,height:42,originX:8,originY:29,advance:7},k:{x:557,y:42,width:26,height:35,originX:4,originY:29,advance:16},l:{x:720,y:42,width:15,height:35,originX:4,originY:29,advance:7},m:{x:778,y:42,width:35,height:29,originX:4,originY:23,advance:26},n:{x:27,y:77,width:26,height:29,originX:4,originY:23,advance:18},o:{x:876,y:42,width:28,height:29,originX:5,originY:23,advance:18},p:{x:477,y:42,width:27,height:35,originX:4,originY:23,advance:18},q:{x:504,y:42,width:27,height:35,originX:5,originY:23,advance:18},r:{x:105,y:77,width:22,height:29,originX:4,originY:23,advance:10},s:{x:53,y:77,width:26,height:29,originX:5,originY:23,advance:16},t:{x:651,y:42,width:21,height:35,originX:6,originY:29,advance:9},u:{x:79,y:77,width:26,height:29,originX:4,originY:23,advance:18},v:{x:904,y:42,width:28,height:29,originX:6,originY:23,advance:16},w:{x:813,y:42,width:35,height:29,originX:6,originY:23,advance:23},x:{x:932,y:42,width:28,height:29,originX:6,originY:23,advance:16},y:{x:423,y:0,width:28,height:36,originX:6,originY:23,advance:16},z:{x:0,y:77,width:27,height:29,originX:6,originY:23,advance:16},"{":{x:42,y:0,width:22,height:42,originX:5,originY:29,advance:10},"|":{x:144,y:0,width:15,height:42,originX:3,originY:29,advance:8},"}":{x:64,y:0,width:21,height:42,originX:5,originY:29,advance:10},"~":{x:357,y:77,width:28,height:17,originX:5,originY:20,advance:18}}},this._init()}_init(){var e=this._manager.gl;this._bitmap.create(1024,128,e.RGB8,e.LINEAR,e.CLAMP_TO_EDGE);var t=new Image;t.onload=(()=>{this._bitmap.updateImage(t,e.RGB,e.UNSIGNED_BYTE,e.LINEAR,e.CLAMP_TO_EDGE)}),t.src=a}getGlyphs(e){for(var t=[],r=0;r<e.length;r++){var i=e.charCodeAt(r);let n=this._fontInfo.characters[e[r]];if(this._asciiMap.has(i))t.push(this._asciiMap.get(i));else{let e={x1:n.x/this._fontInfo.width,y1:(n.y+n.height)/this._fontInfo.height,x2:(n.x+n.width)/this._fontInfo.width,y2:n.y/this._fontInfo.height,size:n.advance/this._fontInfo.size,width:n.width/this._fontInfo.size,height:n.height/this._fontInfo.size,xoffset:n.originX/2/this._fontInfo.size,yoffset:n.originY/this._fontInfo.size};t.push(e),this._asciiMap.set(i,e)}}return t}getTexture(){return this._bitmap}}},"./02resource/Buffer.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./02resource/Resource.ts");class n extends i.default{constructor(e,t){super(e,t);const r=t.gl;this._target=r.ARRAY_BUFFER,this.buffer=r.createBuffer()}destroy(e=!1){if(e||(this._ref--,!(this._ref>0))){if(null!==this.buffer){this._manager.gl.deleteBuffer(this.buffer),this.buffer=null,delete this.buffer}this.ready&&this._manager&&(this._manager.deleteBuffer(this.name),this._manager=null),super.destroy()}}create(e,t){if(this.ready)return;const r=this._manager.gl;this._target=e,r.bindBuffer(e,this.buffer),r.bufferData(e,t,r.STATIC_DRAW),r.getError()===r.NO_ERROR?this.ready=!0:(r.deleteBuffer(this.buffer),this.buffer=null,this.ready=!1)}update(e){const t=this._manager.gl;t.bindBuffer(this._target,this.buffer),t.bufferData(this._target,e,t.STATIC_DRAW),t.getError()===t.NO_ERROR?this.ready=!0:(t.deleteBuffer(this.buffer),this.buffer=null,this.ready=!1)}}},"./02resource/DDS.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"TextureType",function(){return u}),r.d(t,"DDSTools",function(){return C});var i=542327876,n=131072,a=512,s=4,o=64,l=131072;function d(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var u,c=d("DXT1"),h=d("DXT3"),m=d("DXT5"),f=d("DX10"),p=113,v=116,_=2,g=10,b=88,y=31,x=0,w=1,E=2,M=3,A=4,T=7,S=20,k=21,D=22,I=23,N=24,P=25,O=26,R=28,F=32;!function(e){e[e.TEXTURETYPE_UNSIGNED_INT=0]="TEXTURETYPE_UNSIGNED_INT",e[e.TEXTURETYPE_HALF_FLOAT=1]="TEXTURETYPE_HALF_FLOAT",e[e.TEXTURETYPE_FLOAT=2]="TEXTURETYPE_FLOAT"}(u||(u={}));class C{static GetDDSInfo(e){var t=new Int32Array(e,0,y),r=new Int32Array(e,0,y+4),i=1;t[E]&n&&(i=Math.max(1,t[T]));var d=t[k],b=d===f?r[F]:0,x=u.TEXTURETYPE_UNSIGNED_INT;switch(d){case p:x=u.TEXTURETYPE_HALF_FLOAT;break;case v:x=u.TEXTURETYPE_FLOAT;break;case f:if(b===g){x=u.TEXTURETYPE_HALF_FLOAT;break}if(b===_){x=u.TEXTURETYPE_FLOAT;break}}return{width:t[A],height:t[M],mipmapCount:i,isFourCC:(t[S]&s)===s,isRGB:(t[S]&o)===o,isLuminance:(t[S]&l)===l,isCube:(t[R]&a)===a,isCompressed:d===c||d===h||d===m,dxgiFormat:b,textureType:x}}static _ToHalfFloat(e){C._FloatView||(C._FloatView=new Float32Array(1),C._Int32View=new Int32Array(C._FloatView.buffer)),C._FloatView[0]=e;var t=C._Int32View[0],r=t>>16&32768,i=t>>12&2047,n=t>>23&255;return n<103?r:n>142?(r|=31744,r|=(255==n?0:1)&&8388607&t):n<113?r|=((i|=2048)>>114-n)+(i>>113-n&1):(r|=n-112<<10|i>>1,r+=1&i)}static _FromHalfFloat(e){var t=(32768&e)>>15,r=(31744&e)>>10,i=1023&e;return 0===r?(t?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):31==r?i?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,r-15)*(1+i/Math.pow(2,10))}static _GetHalfFloatAsFloatRGBAArrayBuffer(e,t,r,i,n,a){for(var s=new Float32Array(i),o=new Uint16Array(n,r),l=0,d=0;d<t;d++)for(var u=0;u<e;u++){var c=4*(u+d*e);s[l]=C._FromHalfFloat(o[c]),s[l+1]=C._FromHalfFloat(o[c+1]),s[l+2]=C._FromHalfFloat(o[c+2]),C.StoreLODInAlphaChannel?s[l+3]=a:s[l+3]=C._FromHalfFloat(o[c+3]),l+=4}return s}static _GetHalfFloatRGBAArrayBuffer(e,t,r,i,n,a){if(C.StoreLODInAlphaChannel){for(var s=new Uint16Array(i),o=new Uint16Array(n,r),l=0,d=0;d<t;d++)for(var u=0;u<e;u++){var c=4*(u+d*e);s[l]=o[c],s[l+1]=o[c+1],s[l+2]=o[c+2],s[l+3]=C._ToHalfFloat(a),l+=4}return s}return new Uint16Array(n,r,i)}static _GetFloatRGBAArrayBuffer(e,t,r,i,n,a){if(C.StoreLODInAlphaChannel){for(var s=new Float32Array(i),o=new Float32Array(n,r),l=0,d=0;d<t;d++)for(var u=0;u<e;u++){var c=4*(u+d*e);s[l]=o[c],s[l+1]=o[c+1],s[l+2]=o[c+2],s[l+3]=a,l+=4}return s}return new Float32Array(n,r,i)}static _GetFloatAsUIntRGBAArrayBuffer(e,t,r,i,n,a){for(var s=new Uint8Array(i),o=new Float32Array(n,r),l=0,d=0;d<t;d++)for(var u=0;u<e;u++){var c=4*(u+d*e);s[l]=255*Math.min(1,Math.max(0,o[c])),s[l+1]=255*Math.min(1,Math.max(0,o[c+1])),s[l+2]=255*Math.min(1,Math.max(0,o[c+2])),C.StoreLODInAlphaChannel?s[l+3]=a:s[l+3]=255*Math.min(1,Math.max(0,o[c+3])),l+=4}return s}static _GetHalfFloatAsUIntRGBAArrayBuffer(e,t,r,i,n,a){for(var s=new Uint8Array(i),o=new Uint16Array(n,r),l=0,d=0;d<t;d++)for(var u=0;u<e;u++){var c=4*(u+d*e);s[l]=255*Math.min(1,Math.max(0,C._FromHalfFloat(o[c]))),s[l+1]=255*Math.min(1,Math.max(0,C._FromHalfFloat(o[c+1]))),s[l+2]=255*Math.min(1,Math.max(0,C._FromHalfFloat(o[c+2]))),C.StoreLODInAlphaChannel?s[l+3]=a:s[l+3]=255*Math.min(1,Math.max(0,C._FromHalfFloat(o[c+3]))),l+=4}return s}static _GetRGBAArrayBuffer(e,t,r,i,n,a,s,o,l){for(var d=new Uint8Array(i),u=new Uint8Array(n,r),c=0,h=0;h<t;h++)for(var m=0;m<e;m++){var f=4*(m+h*e);d[c]=u[f+a],d[c+1]=u[f+s],d[c+2]=u[f+o],d[c+3]=u[f+l],c+=4}return d}static _ExtractLongWordOrder(e){return 0===e||255===e||-16777216===e?0:1+C._ExtractLongWordOrder(e>>8)}static _GetRGBArrayBuffer(e,t,r,i,n,a,s,o){for(var l=new Uint8Array(i),d=new Uint8Array(n,r),u=0,c=0;c<t;c++)for(var h=0;h<e;h++){var m=3*(h+c*e);l[u]=d[m+a],l[u+1]=d[m+s],l[u+2]=d[m+o],u+=3}return l}static _GetLuminanceArrayBuffer(e,t,r,i,n){for(var a=new Uint8Array(i),s=new Uint8Array(n,r),o=0,l=0;l<t;l++)for(var d=0;d<e;d++){var u=d+l*e;a[o]=s[u],o++}return a}static uploadDataToTexture(e,t,r,i,n,a,s,o,l=!1){var d=e.TEXTURE_CUBE_MAP_POSITIVE_X+s;const u=Math.round(Math.log(t.width)*Math.LOG2E),c=Math.round(Math.log(t.height)*Math.LOG2E),h=l?t.width:Math.pow(2,Math.max(u-o,0)),m=l?t.height:Math.pow(2,Math.max(c-o,0));e.isWebGL2||(n=a),e.texImage2D(d,o,a,h,m,0,n,i,r)}static uploadCompressedDataToTextureDirectly(e,t,r,i,n,a,s=0,o=0){var l=e.TEXTURE_CUBE_MAP_POSITIVE_X+s;e.compressedTexImage2D(l,o,r,i,n,0,a)}static UploadDDSLevels(e,t,r,a,s,o,l=-1,d){var u,S,R,F,B,L,j,V=e.s3tcExtension,z=new Int32Array(r,0,y),U=0;let G=0,q=1;if(z[x]!==i)return void console.error("Invalid magic number in DDS header");if(!a.isFourCC&&!a.isRGB&&!a.isLuminance)return void console.error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(a.isCompressed&&!V)return void console.error("Compressed textures are not supported on this platform.");var Q=z[D];F=z[w]+4;let H=!1;if(a.isFourCC)switch(u=z[k]){case c:q=8,G=V.COMPRESSED_RGBA_S3TC_DXT1_EXT;break;case h:q=16,G=V.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case m:q=16,G=V.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case p:case v:H=!0;break;case f:F+=20;let e=!1;switch(a.dxgiFormat){case g:case _:H=!0,e=!0;break;case b:a.isRGB=!0,a.isFourCC=!1,Q=32,e=!0}if(e)break;default:return void console.error("Unsupported FourCC code:",(Y=u,String.fromCharCode(255&Y,Y>>8&255,Y>>16&255,Y>>24&255)))}var Y;let W=C._ExtractLongWordOrder(z[I]),X=C._ExtractLongWordOrder(z[N]),Z=C._ExtractLongWordOrder(z[P]),K=C._ExtractLongWordOrder(z[O]);L=1,z[E]&n&&!1!==s&&(L=Math.max(1,z[T]));const J=d||0;for(var $,ee,te,re=e.isWebGL2||e.halfFloatExtension,ie=J;ie<o;ie++){for(S=z[A],R=z[M],j=0;j<L;++j){if(-1===l||l===j){const i=-1===l?j:0;if(!a.isCompressed&&a.isFourCC){$=e.RGBA,U=S*R*4;var ne=null;128===Q?(te=e.FLOAT,ee=e.RGBA32F,ne=C._GetFloatRGBAArrayBuffer(S,R,F,U,r,i)):64!==Q||re?(te=e.HALF_FLOAT||re.HALF_FLOAT_OES,ee=e.RGBA16F||e.RGBA,ne=C._GetHalfFloatRGBAArrayBuffer(S,R,F,U,r,i)):(te=e.FLOAT,ee=e.RGBA32F,ne=C._GetHalfFloatAsFloatRGBAArrayBuffer(S,R,F,U,r,i)),ne&&C.uploadDataToTexture(e,t,ne,te,$,ee,ie,i)}else if(a.isRGB)te=e.UNSIGNED_INT,24===Q?($=e.RGB,ee=e.RGB8,U=S*R*3,B=C._GetRGBArrayBuffer(S,R,F,U,r,W,X,Z),C.uploadDataToTexture(e,t,B,te,$,ee,ie,i)):($=e.RGBA,ee=e.RGBA8,U=S*R*4,B=C._GetRGBAArrayBuffer(S,R,F,U,r,W,X,Z,K),C.uploadDataToTexture(e,t,B,te,$,ee,ie,i));else if(a.isLuminance){var ae=e.getParameter(e.UNPACK_ALIGNMENT),se=S;U=Math.floor((S+ae-1)/ae)*ae*(R-1)+se,B=C._GetLuminanceArrayBuffer(S,R,F,U,r),$=e.LUMINANCE,ee=e.LUMINANCE,te=e.UNSIGNED_INT,C.uploadDataToTexture(e,t,B,te,$,ee,ie,i)}else U=Math.max(4,S)/4*Math.max(4,R)/4*q,B=new Uint8Array(r,F,U),te=e.UNSIGNED_INT,C.uploadCompressedDataToTextureDirectly(e,t,G,S,R,B,ie,i)}F+=Q?S*R*(Q/8):U,S*=.5,R*=.5,S=Math.max(1,S),R=Math.max(1,R)}if(void 0!==d)break}}}C.StoreLODInAlphaChannel=!1},"./02resource/FrameBuffer.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./00utility/m3d_utils.ts"),n=r("./02resource/Resource.ts");class a extends n.default{constructor(e,t){super(e,t),this._framebuffer=null,this._colorBuffers=[],this._depthBuffer=null}create(e,t){const r=this._manager.gl;if(!this.ready){for(let t=0,r=e.length;t<r;t++)if(!e[t].ready)return;if(!t||t.ready){if(i.default.isArray(e)||(e=[e]),this._colorBuffers=e,this._depthBuffer=t,this._framebuffer=r.createFramebuffer(),r.bindFramebuffer(r.FRAMEBUFFER,this._framebuffer),r.isWebGL2||r.drawBuffers){let t=[];for(let i=0,n=e.length;i<n;i++)this._colorBuffers[i]._rbo?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0_WEBGL+i,r.RENDERBUFFER,this._colorBuffers[i]._texture):r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0_WEBGL+i,r.TEXTURE_2D,this._colorBuffers[i]._texture,0),t.push(r.COLOR_ATTACHMENT0_WEBGL+i);r.drawBuffers(t)}else this._colorBuffers[0]._rbo?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0_WEBGL,r.RENDERBUFFER,this._colorBuffers[0]._texture):r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0_WEBGL,r.TEXTURE_2D,this._colorBuffers[0]._texture,0);this._depthBuffer?this._depthBuffer._rbo?this._depthBuffer._format===r.DEPTH_COMPONENT?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this._depthBuffer._texture):r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,this._depthBuffer._texture):this._depthBuffer._format===r.DEPTH_COMPONENT?r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,this._depthBuffer._texture,0):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,this._depthBuffer._texture,0):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,null,0),this.ready=this._checkCompleteness()}}}_destroy(){const e=this._manager.gl;if(this.ready){e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,null,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,null),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,null);for(let t=0,r=e.isWebGL2||e.drawBuffers?this._colorBuffers.length:1;t<r;t++)e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0_WEBGL+t,e.TEXTURE_2D,null,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0_WEBGL+t,e.RENDERBUFFER,null);e.deleteFramebuffer(this._framebuffer),delete this._framebuffer}let t;(t=e.getError())!==e.NO_ERROR&&console.log("GL error in framebuffer._destroy(): "+t)}destroy(e=!1){!e&&(this._ref--,this._ref>0)||(this.ready&&this._destroy(),this._manager&&this._manager.deleteFramebuffer(this.name),super.destroy())}resize(e,t){if(this.getWidth()===e&&this.getHeight()===t)return;const r=this._manager.gl;if(this.ready){(e>4096||t>4096)&&(e>=t?(t=Math.floor(4096*t/e),e=4096):(e=Math.floor(4096*e/t),t=4096)),this.ready=!1,r.bindFramebuffer(r.FRAMEBUFFER,this._framebuffer);for(var i=0,n=this._colorBuffers.length;i<n;i++)this._colorBuffers[i].resize(e,t);this._depthBuffer.resize(e,t);for(i=0,n=this._colorBuffers.length;i<n;i++)if(!this._colorBuffers[i].ready)return void this.destroy();if(this._depthBuffer.ready){for(let e=0,t=r.isWebGL2||r.drawBuffers?this._colorBuffers.length:1;e<t;e++)this._colorBuffers[e]._rbo?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0_WEBGL+e,r.RENDERBUFFER,this._colorBuffers[e]._texture):r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0_WEBGL+e,r.TEXTURE_2D,this._colorBuffers[e]._texture,0);this._depthBuffer?this._depthBuffer._rbo?this._depthBuffer._format===r.DEPTH_COMPONENT?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this._depthBuffer._texture):r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,this._depthBuffer._texture):this._depthBuffer._format===r.DEPTH_COMPONENT?r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,this._depthBuffer._texture,0):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,this._depthBuffer._texture,0):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,null,0),this.ready=this._checkCompleteness()}else this.destroy()}}_checkCompleteness(){const e=this._manager.gl;var t=!1,r=e.checkFramebufferStatus(e.FRAMEBUFFER);switch(r){case e.FRAMEBUFFER_COMPLETE:t=!0;break;case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case e.FRAMEBUFFER_INCOMPLETEDIMENSIONS:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case e.FRAMEBUFFER_UNSUPPORTED:console.log("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:console.log("Incomplete framebuffer: "+r)}return e.getError()!==e.NO_ERROR&&(t=!1),t}getWidth(){return this.ready?this._colorBuffers[0].width:-1}getHeight(){return this.ready?this._colorBuffers[0].height:-1}use(){const e=this._manager.gl;this.ready?e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer):console.error("framebuffer "+this.name+" is not ready.")}getColorBufferNumber(){return this.ready?this._colorBuffers.length:null}getColorBuffer(e=0){return this.ready&&e<this._colorBuffers.length?this._colorBuffers[e]:null}getDepthBuffer(){return this.ready?this._depthBuffer:null}discard(){const e=this._manager.gl;if(this.ready){this._depthBuffer&&this._depthBuffer.discard();for(var t=0,r=this._colorBuffers.length;t<r;t++)this._colorBuffers[t].discard();e.deleteFramebuffer(this._framebuffer),this._framebuffer=null,this.ready=!1}}restore(){const e=this._manager.gl;if(!this.ready){this._depthBuffer&&this._depthBuffer.restore();for(var t=0,r=this._colorBuffers.length;t<r;t++)this._colorBuffers[t].restore();for(t=0,r=this._colorBuffers.length;t<r;t++)if(!this._colorBuffers[t].ready)return;if(this._depthBuffer&&!this._depthBuffer.ready)return;this._framebuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer);let i=[];for(let t=0,r=e.isWebGL2||e.drawBuffers?this._colorBuffers.length:1;t<r;t++)this._colorBuffers[t]._rbo?e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0_WEBGL+t,e.RENDERBUFFER,this._colorBuffers[t]._texture,0):e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0_WEBGL+t,e.TEXTURE_2D,this._colorBuffers[t]._texture,0),i.push(e.COLOR_ATTACHMENT0_WEBGL+t);(e.isWebGL2||e.drawBuffers)&&e.drawBuffers(i),this._depthBuffer?this._depthBuffer._rbo?this._depthBuffer._format===e.DEPTH_COMPONENT?e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this._depthBuffer._texture):e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this._depthBuffer._texture):this._depthBuffer._format===e.DEPTH_COMPONENT?e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this._depthBuffer._texture,0):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,this._depthBuffer._texture,0):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0),this.ready=this._checkCompleteness()}}copy(e,t){if(this.name===e.name)return;const r=this._manager.gl;if(r.isWebGL2){var i=this._colorBuffers[0].width,n=this._colorBuffers[0].height;const a=r.getParameter(r.DRAW_FRAMEBUFFER_BINDING);r.bindFramebuffer(r.READ_FRAMEBUFFER,e._framebuffer),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this._framebuffer),r.blitFramebuffer(0,0,i,n,0,0,i,n,t,r.NEAREST),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,a)}else console.warn("Framebuffer.copy() only gets supported in WebGL 2.0 context.")}}},"./02resource/Mesh.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./02resource/m3d_geometric_shape.js"),n=r("./02resource/Resource.ts");class a extends n.default{constructor(e,t){super(e,t),this._vao=null,this._vbos=[],this._ibo=null,this._primitive=4,this._type=t.gl.UNSIGNED_INT,this._vboBase=0,this._iboBase=0,this._shared=!1,this.attributes=null,this.length=0,this.bytes=0,this.indexSize=2}destroy(e=!1){if(e||(this._ref--,!(this._ref>0))){if(this.ready){const e=this._manager.gl;var t;this._shared||(this._vbos.forEach(t=>{e.deleteBuffer(t)}),this._vbos=null,delete this._vbos,e.deleteBuffer(this._ibo),this._ibo=!1,delete this._ibo),this._vao&&(e.deleteVertexArray(this._vao),this._vao=!1,delete this._vao),(t=e.getError())!==e.NO_ERROR&&console.log("GL error in mesh.destroy(): "+t)}this._manager&&this._manager.deleteMesh(this.name),super.destroy()}}createShared(e,t,r,i,n,a,s){const o=this._manager.gl;this.ready||(this._primitive=e,this.attributes=t,this.bytes=r.byteLength+i.byteLength,this._type=n||o.UNSIGNED_SHORT,this._type===o.UNSIGNED_BYTE?(this.length=i.byteLength,this.indexSize=1):this._type===o.UNSIGNED_INT?(this.length=i.byteLength/4,this.indexSize=4):(this.length=i.byteLength/2,this.indexSize=2),this._vbos[0]=a.buffer,this._ibo=s.buffer,(o.isWebGL2||o.vaoExtension)&&(this._vao=o.createVertexArray(),o.bindVertexArray(this._vao),this.attributes.bind(this._vbos[0],o),o.bindVertexArray(null)),this._shared=!0,this._iboBase=i.byteOffset,this._vboBase=r.byteOffset,this.ready=a.ready&&s.ready)}create(e,t,r,i,n){if(this.ready)return;const a=this._manager.gl;this._vbos[0]=a.createBuffer(),this._ibo=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this._vbos[0]),a.bufferData(a.ARRAY_BUFFER,r,a.STATIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this._ibo),a.bufferData(a.ELEMENT_ARRAY_BUFFER,i,a.STATIC_DRAW),this._primitive=e,this.attributes=t,(a.isWebGL2||a.vaoExtension)&&(this._vao=a.createVertexArray(),a.bindVertexArray(this._vao),this.attributes.bind(this._vbos[0],a),a.bindVertexArray(null)),this.bytes=r.byteLength+i.byteLength,this._type=n||a.UNSIGNED_SHORT,this._type===a.UNSIGNED_BYTE?(this.length=i.byteLength,this.indexSize=1):this._type===a.UNSIGNED_INT?(this.length=i.byteLength/4,this.indexSize=4):(this.length=i.byteLength/2,this.indexSize=2),a.getError()===a.NO_ERROR?this.ready=!0:(a.deleteBuffer(this._vbos[0]),a.deleteBuffer(this._ibo),this._vao&&a.deleteVertexArray(this._vao))}createFromBufferObject(e,t,r,i,n,a,s){if(this.ready)return;const o=this._manager.gl;this._vbos=e,this._ibo=t,this._iboBase=s,this._primitive=i,this.attributes=r,(o.isWebGL2||o.vaoExtension)&&(this._vao=o.createVertexArray(),o.bindVertexArray(this._vao),this.attributes.bindBuffers(this._vbos,o),o.bindVertexArray(null)),this._type=n,this.length=a,o.getError()===o.NO_ERROR?this.ready=!0:(this._vbos.forEach(e=>{o.deleteBuffer(e)}),o.deleteBuffer(this._ibo),this._vao&&o.deleteVertexArray(this._vao))}createWiredCube(e=1){if(!this.ready){var t=new i.default;t.createWiredCube(e),this.create(t.primitive,t.attributes,t.vertices,t.indices,t.indexType)}}createArrow(e,t){if(!this.ready){var r=new i.default;r.createArrow(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}}createSolidCube(e=1){if(!this.ready){var t=new i.default;t.createSolidCube(e),this.create(t.primitive,t.attributes,t.vertices,t.indices,t.indexType)}}createWiredCubeField(e,t){if(!this.ready){var r=new i.default;r.createWiredCubeField(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}}createSolidCubeField(e,t){if(!this.ready){var r=new i.default;r.createSolidCubeField(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}}createGrid(e,t){if(!this.ready){var r=new i.default;r.createGrid(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}}createTextGrid(e){if(!this.ready){var t=new i.default;t.createTextGrid(e),this.create(t.primitive,t.attributes,t.vertices,t.indices,t.indexType)}}createQuad(e=!0,t=!1,r=!1,n=!1){if(!this.ready){var a=new i.default;a.createQuad(e,t,r,n),this.create(a.primitive,a.attributes,a.vertices,a.indices,a.indexType)}}createPoint(){if(!this.ready){var e=new i.default;e.createPoint(),this.create(e.primitive,e.attributes,e.vertices,e.indices,e.indexType)}}createSphere(e,t){if(!this.ready){var r=new i.default;r.createSphere(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}}createLine(){if(!this.ready){var e=new i.default;e.createLine(),this.create(e.primitive,e.attributes,e.vertices,e.indices,e.indexType)}}createLineStrip(){if(!this.ready){var e=new i.default;e.createLineStrip(),this.create(e.primitive,e.attributes,e.vertices,e.indices,e.indexType)}}createArc(e,t,r,n){if(!this.ready){var a=new i.default;a.createArc(e,t,r,n),this.create(a.primitive,a.attributes,a.vertices,a.indices,a.indexType)}}createTorus(e,t,r,n){if(!this.ready){var a=new i.default;a.createTorus(e,t,r,n),this.create(a.primitive,a.attributes,a.vertices,a.indices,a.indexType)}}render(){this._manager.gl.drawElements(this._primitive,this.length,this._type,this._iboBase)}renderSub(e,t){this._manager.gl.drawElements(this._primitive,t,this._type,e+this._iboBase)}renderInstanced(e){this._manager.gl.drawElementsInstanced(this._primitive,this.length,this._type,this._iboBase,e)}use(){if(!this.ready)return void console.error("mesh "+this.name+" is not ready.");const e=this._manager.gl;this._vao?e.bindVertexArray(this._vao):this.attributes.bind(this._vbos,e),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._ibo)}update(e,t,r){const i=this._manager.gl;this.ready&&(i.deleteBuffer(this._vbos[0]),i.deleteBuffer(this._ibo),this._vao&&i.deleteVertexArray(this._vao),this._vbos=[i.createBuffer()],this._ibo=i.createBuffer(),this._vboBase=0,this._iboBase=0,i.bindBuffer(i.ARRAY_BUFFER,this._vbos[0]),i.bufferData(i.ARRAY_BUFFER,e,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._ibo),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t,i.STATIC_DRAW),(i.isWebGL2||i.vaoExtension)&&(this._vao=i.createVertexArray(),i.bindVertexArray(this._vao),this.attributes.bind(this._vbos[0],i),i.bindVertexArray(null)),i.getError()!==i.NO_ERROR&&(this.ready=!1),this._type=r||i.UNSIGNED_SHORT,this._type===i.UNSIGNED_BYTE?this.length=t.byteLength:this._type===i.UNSIGNED_SHORT?this.length=t.byteLength/2:this._type===i.UNSIGNED_INT&&(this.length=t.byteLength/4),this.bytes=e.byteLength+t.byteLength)}isTriangle(){return this._primitive>=this._manager.gl.TRIANGLES}isLine(){const e=this._manager.gl;return this._primitive===e.LINES||this._primitive===e.LINE_LOOP||this._primitive==e.LINE_STRIP}hasColor(){return this.attributes.hasColor}slice(e){const t=this._manager.gl;if(!t.isWebGL2)return console.error("createSubMesh is only supported in WebGL2"),this;for(var r=0,i=0,n=0,a=e.length;n<a;n++)r+=e[n].verticesBytes,i+=e[n].indicesBytes;var s=this._manager.getMesh((parseFloat(this.name)+Math.random()).toString());s._vbos=t.createBuffer(),s._ibo=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,s._vbos),t.bufferData(t.ARRAY_BUFFER,new Uint8Array(r),t.STATIC_DRAW);var o=0;t.bindBuffer(t.COPY_READ_BUFFER,this._vbos);for(n=0,a=e.length;n<a;n++)t.copyBufferSubData(t.COPY_READ_BUFFER,t.ARRAY_BUFFER,this._vboBase+e[n].verticesOffset,o,e[n].verticesBytes),o+=e[n].verticesBytes;var l=null,d=null;switch(this.indexSize){case 2:l=new Uint16Array(this.length),d=new Uint16Array(i/2);break;case 1:l=new Uint8Array(this.length),d=new Uint8Array(i);break;case 4:l=new Uint32Array(this.length),d=new Uint32Array(i/4)}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._ibo),t.getBufferSubData(t.ELEMENT_ARRAY_BUFFER,this._iboBase,l);var u=0,c=0;for(n=0,a=e.length;n<a;n++){for(var h=e[n].verticesOffset/this.attributes.values[0].stride,m=e[n].indicesBytes/this.indexSize,f=e[n].indicesOffset/this.indexSize,p=0;p<m;p++)d[p+u]=l[p+f]-h+c;u+=m,c+=e[n].verticesBytes/this.attributes.values[0].stride}return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s._ibo),t.bufferData(t.ELEMENT_ARRAY_BUFFER,d,t.STATIC_DRAW),s._primitive=this._primitive,s.attributes=this.attributes,(t.isWebGL2||t.vaoExtension)&&(s._vao=t.createVertexArray(),t.bindVertexArray(s._vao),s.attributes.bind(s._vbos[0],t),t.bindVertexArray(null)),s.bytes=i+r,s._type=this._type,s.indexSize=this.indexSize,s.length=i/s.indexSize,t.getError()===t.NO_ERROR?s.ready=!0:(t.deleteBuffer(s._vbos[0]),t.deleteBuffer(s._ibo),s._vao&&t.deleteVertexArray(s._vao)),s}ibSubData(e,t){const r=this._manager.gl;this.ready=!1,r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this._ibo),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,this._iboBase+e,t),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),r.getError()===r.NO_ERROR?this.ready=!0:(r.deleteBuffer(this._ibo),r.deleteBuffer(this._vbos[0]),this._vao&&(r.deleteVertexArray(this._vao),this._vao=!1,delete this._vao))}vbSubData(e,t){const r=this._manager.gl;this.ready=!1,r.bindBuffer(r.ARRAY_BUFFER,this._vbos[0]),r.bufferSubData(r.ARRAY_BUFFER,this._vboBase+e,t),r.bindBuffer(r.ARRAY_BUFFER,null),r.getError()===r.NO_ERROR?this.ready=!0:(r.deleteBuffer(this._ibo),r.deleteBuffer(this._vbos[0]),this._vao&&(r.deleteVertexArray(this._vao),this._vao=!1,delete this._vao))}getVBSubData(e,t){const r=this._manager.gl;r.bindBuffer(r.ARRAY_BUFFER,this._vbos[0]),r.getBufferSubData(r.ARRAY_BUFFER,this._vboBase+e,t),r.bindBuffer(r.ARRAY_BUFFER,null)}getIBSubData(e,t){const r=this._manager.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this._ibo),r.getBufferSubData(r.ELEMENT_ARRAY_BUFFER,this._iboBase+e,t),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null)}}},"./02resource/MeshAttributes.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"MeshAttribute",function(){return n}),r.d(t,"default",function(){return a});var i=r("./01wrapper/glenum.ts");class n{constructor(e,t,r,i){this.name=e,this.index=-1,this.type=t,this.offset=0,this.stride=0,this.size=i,this.normalized=!!r}}class a{constructor(){this.values=[],this.hasNormal=!1,this.hasColor=!1,this.hasUV=!1,this.id=0,this.primitive=i.gl.TRIANGLES,this.compressed=!1}_getSizeOfType(e){switch(e){case i.gl.UNSIGNED_BYTE:case i.gl.BYTE:return 1;case i.gl.UNSIGNED_SHORT:case i.gl.SHORT:return 2;case i.gl.FLOAT:case i.gl.INT:case i.gl.UNSIGNED_INT:return 4;default:throw new Error("unknown GL type")}}builtin(e,t,r,a){var s=0,o=null;if(e&&((o=new n("m_aPosition",e,!1,3)).index=0,o.offset=0,this.values.push(o),s=3*this._getSizeOfType(e)),t){var l=3,d=!1;l=3,d=!1,t!==i.gl.FLOAT&&(d=!0,l=4),(o=new n("m_aNormal",t,d,l)).index=1,o.offset=s,this.values.push(o),s+=l*this._getSizeOfType(t),this.hasNormal=!0}r&&((o=new n("m_aTexCoord",r,!1,2)).index=4,o.offset=s,this.values.push(o),s+=2*this._getSizeOfType(r),this.hasUV=!0),a&&((o=new n("m_aColor",a,!1,4)).index=5,o.offset=s,t!==i.gl.FLOAT&&(o.normalized=!0),this.values.push(o),s+=4*this._getSizeOfType(a),this.hasColor=!0);for(var u=0,c=this.values.length;u<c;++u)this.values[u].stride=s;this.id=(e?16:0)+(t?8:0)+(r?4:0)+(a?2:0)}compress(){if(this.hasNormal&&!this.compressed){this.compressed=!0,this.id+=32;var e=[];e.push(this.values[0]);var t=null;(t=new n("m_aNormal0",i.gl.BYTE,!0,1)).index=1,t.offset=0,e.push(t),(t=new n("m_aNormal1",i.gl.BYTE,!0,1)).index=2,t.offset=4,e.push(t),(t=new n("m_aNormal2",i.gl.BYTE,!0,1)).index=3,t.offset=8,e.push(t);for(var r=2,a=this.values.length;r<a;r++)this.values[r].offset-=4,e.push(this.values[r]);var s=this.values[0].stride-4;for(r=0,a=e.length;r<a;++r)e[r].stride=s;this.values=e}}clone(){var e=new a;e.id=this.id,e.hasNormal=this.hasNormal,e.hasColor=this.hasColor,e.hasUV=this.hasUV,e.compressed=this.compressed,e.primitive=this.primitive,e.values=new Array(this.values.length);for(var t=0,r=this.values.length;t<r;t++){var i=this.values[t];e.values[t]=new n(i.name,i.type,i.normalized,i.size),e.values[t].index=i.index,e.values[t].offset=i.offset,e.values[t].stride=i.stride}return e}add(e,t,r,i,a,s,o){if(!this.has(e)){var l=new n(e,r,i,a);l.index=t,l.stride=s,l.offset=o,this.values.push(l)}}has(e){for(var t=0,r=this.values.length;t<r;++t)if(this.values[t].name===e)return!0;return!1}bindBuffers(e,t){e.forEach((e,r)=>{t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(this.values[r].index,this.values[r].size,this.values[r].type,this.values[r].normalized,this.values[r].stride,this.values[r].offset),t.enableVertexAttribArray(this.values[r].index)})}bind(e,t){t.disableVertexAttribArray(1),t.disableVertexAttribArray(2),t.disableVertexAttribArray(3),t.disableVertexAttribArray(4),t.disableVertexAttribArray(5),t.disableVertexAttribArray(6),t.bindBuffer(t.ARRAY_BUFFER,e);for(var r=0,i=this.values.length;r<i;r++){var n=this.values[r].index;t.vertexAttribPointer(n,this.values[r].size,this.values[r].type,this.values[r].normalized,this.values[r].stride,this.values[r].offset),t.enableVertexAttribArray(n)}}}},"./02resource/Resource.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(e,t){this._manager=t,this._ref=0,this.name=e,this.ready=!1}ref(){this._ref++}destroy(){this.ready=!1,this._manager=null,delete this._manager,this.name=null,delete this.name}getGL(){return this._manager.gl}getManager(){return this._manager}}},"./02resource/ResourceManager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return d});var i=r("./02resource/Texture.ts"),n=r("./02resource/Mesh.ts"),a=r("./02resource/FrameBuffer.ts"),s=r("./02resource/Shader.ts"),o=r("./02resource/Buffer.ts"),l=r("./02resource/BitmapFont.ts");class d{constructor(e){this._shaders=new Map,this._meshes=new Map,this._textures=new Map,this._framebuffers=new Map,this._buffers=new Map,this.gl=e,this.gl||console.error("ResourceManager requires a valid gl context."),this._bitmapFont=new l.default(this),this._framebuffers.set("default",{ready:!0,manager:null,_name:"default",_framebuffer:null,_width:1,_height:1,destroy:function(){},use:function(){e.bindFramebuffer(e.FRAMEBUFFER,null)},resize:function(e,t){this._width=e,this._height=t},discard:function(){},restore:function(){},getWidth:function(){return this._width},getHeight:function(){return this._height},ref:function(){},copy:function(t,r){if(this._name!==t._name&&e.isWebGL2){var i=t._colorBuffers[0].width,n=t._colorBuffers[0].height;const a=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.READ_FRAMEBUFFER,t._framebuffer),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.blitFramebuffer(0,0,i,n,0,0,i,n,r,e.NEAREST),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,a)}}})}destroy(){this._meshes.forEach((e,t)=>{e.destroy(!0)}),this._framebuffers.forEach((e,t)=>{e.destroy(!0)}),this._textures.forEach((e,t)=>{e.destroy(!0)}),this._shaders.forEach((e,t)=>{e.destroy(!0)}),this._buffers.forEach((e,t)=>{e.destroy(!0)}),this._textures=null,this._meshes=null,this._framebuffers=null,this._buffers=null,this._shaders=null,delete this._textures,delete this._meshes,delete this._framebuffers,delete this._shaders,delete this._buffers}getBitmapFont(){return this._bitmapFont}getTexture(e){this._textures.has(e)||this._textures.set(e,new i.default(e,this));let t=this._textures.get(e);return t.ref(),t}renameTexture(e,t){this._textures.has(e)&&(this._textures.set(t,this._textures.get(e)),this._textures.delete(e))}getFramebuffer(e){this._framebuffers.has(e)||this._framebuffers.set(e,new a.default(e,this));let t=this._framebuffers.get(e);return t.ref(),t}getShader(e,t){(t=t||[]).sort(),t&&(e+=t.join("_")),this._shaders.has(e)||this._shaders.set(e,new s.default(e,this));let r=this._shaders.get(e);return r.ref(),r}getBuffer(e){this._buffers.has(e)||this._buffers.set(e,new o.default(e,this));let t=this._buffers.get(e);return t.ref(),t}getMesh(e){this._meshes.has(e)||this._meshes.set(e,new n.default(e,this));let t=this._meshes.get(e);return t.ref(),t}hasTexture(e){return this._textures.has(e)}hasFramebuffer(e){return this._framebuffers.hasOwnProperty(e)}hasShader(e,t){return(t=t||[]).sort(),t&&(e+=t.join("_")),this._shaders.has(e)}hasBuffer(e){return this._buffers.has(e)}hasMesh(e){return this._meshes.has(e)}deleteTexture(e){this._textures.delete(e)}deleteFramebuffer(e){this._framebuffers.delete(e)}deleteShader(e){this._shaders.delete(e)}deleteBuffer(e){this._buffers.delete(e)}deleteMesh(e){this._meshes.delete(e)}discard(){this._framebuffers.forEach(e=>{e.discard()})}restore(){this._framebuffers.forEach(e=>{e.restore()})}getMemStats(e){e.textureKBytes=0,e.textureCount=0,this._textures.forEach(t=>{t.ready&&(e.textureKBytes+=t.getSize()/1024,e.textureCount++)}),e.meshKBytes=0,e.meshCount=0,this._meshes.forEach(t=>{t.ready&&(e.meshKBytes+=t.bytes/1024,e.meshCount++)}),e.framebufferCount=0,this._framebuffers.forEach(t=>{t.ready&&e.framebufferCount++}),e.shaderCount=0,this._shaders.forEach(t=>{t.ready&&e.shaderCount++})}}},"./02resource/Shader.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./00utility/m3d_utils.ts"),n=r("./02resource/Resource.ts");class a{constructor(e){this.loc=e,this.upload=null}initialize(e,t,r){this.uniforms=new Map;var i=r.getUniformBlockIndex(t,e);r.uniformBlockBinding(t,i,this.loc);var n=r.getActiveUniformBlockParameter(t,i,r.UNIFORM_BLOCK_DATA_SIZE);this.blockSize=0;for(var a=r.getActiveUniformBlockParameter(t,i,r.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES),o=0,l=a.length;o<l;o++){var d=r.getActiveUniform(t,a[o]),u=d.name.replace(/[_\w]+./,"");switch(this.uniforms[u]={type:d.type,size:d.size},d.type){case r.INT:case r.FLOAT:this.blockSize+=4*d.size;break;case r.INT_VEC2:case r.FLOAT_VEC2:this.blockSize+=8*d.size;break;case r.INT_VEC3:case r.FLOAT_VEC3:this.blockSize+=12*d.size;break;case r.INT_VEC4:case r.FLOAT_VEC4:this.blockSize+=16*d.size;break;case r.FLOAT_MAT4:this.blockSize+=64*d.size;break;case r.FLOAT_MAT3:this.blockSize+=48*d.size}}this.blockSize!==n&&console.warn("uniform block "+e+" has packing problem!"),r.isWebGL2&&(this.blockBuffer=null,this.blockBuffer=r.createBuffer(),r.bindBuffer(r.UNIFORM_BUFFER,this.blockBuffer),s=new Float32Array(this.blockSize),r.bufferData(r.UNIFORM_BUFFER,s,r.DYNAMIC_DRAW),r.bindBuffer(r.UNIFORM_BUFFER,null))}destroy(){this.uniforms=null,delete this.uniforms}UniformUpload1fv(e,t){t.uniform1fv(this.loc,e)}UniformUpload1f(e,t){t.uniform1f(this.loc,e)}UniformUpload2f(e,t){t.uniform2fv(this.loc,e)}UniformUpload3f(e,t){t.uniform3fv(this.loc,e)}UniformUpload4f(e,t){t.uniform4fv(this.loc,e)}UniformUpload1b(e,t){t.uniform1i(this.loc,e?1:0)}UniformUpload1i(e,t){t.uniform1i(this.loc,e)}UniformUpload2i(e,t){t.uniform2i(this.loc,e[0],e[1])}UniformUpload3i(e,t){t.uniform3i(this.loc,e[0],e[1],e[2])}UniformUpload4i(e,t){t.uniform4i(this.loc,e[0],e[1],e[2],e[3])}UniformUploadMat4(e,t){t.uniformMatrix4fv(this.loc,!1,e)}UniformUploadMat3(e,t){t.uniformMatrix3fv(this.loc,!1,e)}UniformBlockUpload(e,t){t.bindBufferBase(t.UNIFORM_BUFFER,this.loc,this.blockBuffer),t.bindBuffer(t.UNIFORM_BUFFER,this.blockBuffer),t.bufferSubData(t.UNIFORM_BUFFER,0,e,0,e.byteLength/4),t.bindBuffer(t.UNIFORM_BUFFER,null)}}var s=null;class o extends n.default{constructor(e,t){super(e,t),this._program=null,this.reservedUniforms={},this.userUniforms={},this.shaderSource=null,this.flags=[],this.attributes={}}destroy(e=!1){if(e||(this._ref--,!(this._ref>0))){if(this.ready){const e=this._manager.gl;for(var t=0,r=this.reservedUniforms.length;t<r;t++)this.reservedUniforms[t].destroy();this.reservedUniforms=null,delete this.reservedUniforms;for(t=0,r=this.userUniforms.length;t<r;t++)this.userUniforms[t].destroy();var i;this.userUniforms=null,delete this.userUniforms,this.shaderSource=null,delete this.shaderSource,this.attributes=null,delete this.attributes,e.deleteProgram(this._program),delete this._program,(i=e.getError())!==e.NO_ERROR&&console.log("GL error in shader.destroy(): "+i)}this._manager&&this._manager.deleteShader(this.name),super.destroy()}}createFromSource(e,t,r){this._manager.gl;if(!this.ready){this.flags=r?r.slice(0):[];var i=this._preprocess(e,r),n=this._preprocess(t,r);this._compile(i,n)}}_preprocess(e,t){var r,n,a,s,o,l,d=[!0],u=!0,c=e.split("\n"),h=[];for(r=0,a=c.length;r<a;r++){var m=c[r];if(""!==m)if("#"===m[0]&&"v"!==m[1]){if("i"===m[1]&&"f"===m[2]){u=!0;var f=m.substr(4).replace(/^\s+|\s+$/g,"");if(o=null,-1!==f.indexOf("||"))for(u=!1,n=0,s=(o=f.split("||")).length;n<s;n++){var p=o[n].replace(/^\s+|\s+$/g,"");l=!1,"!"===p[0]&&(l=!0,p=p.substring(1)),-1!==i.default.indexOf(t,p)&&(u=!l)}else if(-1!==f.indexOf("&&")){for(u=!0,n=0,s=(o=f.split("&&")).length;n<s;n++)if("!"===(p=o[n].replace(/^\s+|\s+$/g,""))[0]){if(p=p.substring(1),-1!==i.default.indexOf(t,p)){u=!1;break}}else if(-1===i.default.indexOf(t,p)){u=!1;break}}else l=!1,"!"===f[0]&&(l=!0,f=f.substring(1)),u=-1!==i.default.indexOf(t,f)?!l:l;d.push(u)}else"e"===m[1]&&"l"===m[2]&&"s"===m[3]&&"e"===m[4]?d[d.length-1]=!d[d.length-1]:"e"===m[1]&&"n"===m[2]&&"d"===m[3]&&"i"===m[4]&&"f"===m[5]&&d.pop();for(u=!0,n=0,s=d.length;n<s&&(u=d[n]&&u);++n);}else u&&h.push(m)}return h.join("\n")}createFromShaderSource(e,t){const r=this._manager.gl;this.ready||(t=t||[],r.isWebGL2&&-1===t.indexOf("WEBGL2")&&t.push("WEBGL2"),this.shaderSource=e,this.shaderSource.ready?this.createFromSource(e.vsSource,e.fsSource,t):console.warn(name+"'s source is not ready"))}_compile(e,t){const r=this._manager.gl;if(!this.ready){this.ready=!1,this._program&&r.deleteProgram(this._program),this._program=r.createProgram();var i=r.createShader(r.VERTEX_SHADER),n=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(i,e),r.compileShader(i),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(i,r.COMPILE_STATUS)){var s="failed to compile vertex shader "+this.name+"\n\n"+r.getShaderInfoLog(i);return console.log(e),console.error(s),r.deleteProgram(this._program),void r.deleteShader(i)}if(!r.getShaderParameter(n,r.COMPILE_STATUS)){s="failed to compile fragment shader "+this.name+"\n\n"+r.getShaderInfoLog(n);return console.log(t),console.error(s),r.deleteProgram(this._program),void r.deleteShader(n)}if(r.attachShader(this._program,i),r.attachShader(this._program,n),r.bindAttribLocation(this._program,0,"m_aPosition"),r.bindAttribLocation(this._program,1,"m_aNormal0"),r.bindAttribLocation(this._program,2,"m_aNormal1"),r.bindAttribLocation(this._program,3,"m_aNormal2"),r.bindAttribLocation(this._program,4,"m_aTexCoord"),r.bindAttribLocation(this._program,5,"m_aColor"),r.bindAttribLocation(this._program,6,"m_aMaterial"),r.bindAttribLocation(this._program,7,"m_aTangent"),r.bindAttribLocation(this._program,8,"m_aJoint0"),r.bindAttribLocation(this._program,9,"m_aWeight0"),r.bindAttribLocation(this._program,10,"m_aModelMatrix"),r.linkProgram(this._program),r.deleteShader(i),r.deleteShader(n),r.getError()===r.NO_ERROR){if(!r.getProgramParameter(this._program,r.LINK_STATUS)){const e=r.getProgramInfoLog(this._program);return console.log("%s linking error:\n"+e,this.name),void r.deleteProgram(this._program)}this.ready=!0;var o,l=r.getProgramParameter(this._program,r.ACTIVE_ATTRIBUTES);for(o=0;o<l;++o){var d=r.getActiveAttrib(this._program,o);this.attributes[d.name]=o}var u=r.getProgramParameter(this._program,r.ACTIVE_UNIFORMS);for(o=0;o<u;++o){let e=r.getActiveUniform(this._program,o),t=r.getUniformLocation(this._program,e.name),i=new a(t);if("m"===e.name[0]&&"_"===e.name[1]){if(null===t&&r.isWebGL2)continue;this.reservedUniforms[e.name]=i}else this.userUniforms[e.name]=i;switch(e.type){case r.FLOAT:e.size>1?i.upload=i.UniformUpload1fv:i.upload=i.UniformUpload1f;break;case r.FLOAT_VEC2:i.upload=i.UniformUpload2f;break;case r.FLOAT_VEC3:i.upload=i.UniformUpload3f;break;case r.FLOAT_VEC4:i.upload=i.UniformUpload4f;break;case r.BOOL:i.upload=i.UniformUpload1b;break;case r.INT:case r.SAMPLER_2D:case r.SAMPLER_CUBE:i.upload=i.UniformUpload1i;break;case r.INT_VEC2:case r.BOOL_VEC2:i.upload=i.UniformUpload2i;break;case r.INT_VEC3:case r.BOOL_VEC3:i.upload=i.UniformUpload3i;break;case r.INT_VEC4:case r.BOOL_VEC4:i.upload=i.UniformUpload4i;break;case r.FLOAT_MAT4:i.upload=i.UniformUploadMat4;break;case r.FLOAT_MAT3:i.upload=i.UniformUploadMat3;break;default:console.error("unsupported shader uniform type for "+e.name)}}if(r.isWebGL2){let e=r.getProgramParameter(this._program,r.ACTIVE_UNIFORM_BLOCKS);for(let t=0;t<e;t++){var c=r.getActiveUniformBlockName(this._program,t);let e;"m"===c[0]&&"_"===c[1]?((e=new a(t)).initialize(c,this._program,r),e.upload=e.UniformBlockUpload,c=c.replace(/m_b/,"m_u"),this.reservedUniforms[c]=e):((e=new a(t)).initialize(c,this._program,r),e.upload=e.UniformBlockUpload,this.userUniforms[c]=e)}}}else r.deleteProgram(this._program)}}use(){this.ready?this._manager.gl.useProgram(this._program):console.error("shader "+this.name+" is not ready.")}}},"./02resource/Texture.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./02resource/Resource.ts"),n=r("./02resource/DDS.ts"),a=r("./03scene/model/m3d_load_misc.js");class s extends i.default{constructor(e,t){super(e,t);const r=t.gl;this._texture=null,this._internalFormat=r.RGBA,this._format=r.RGBA,this._type=r.UNSIGNED_BYTE,this._wrap=r.CLAMP_TO_EDGE,this._filter=r.LINEAR,this._mipmap=!1,this._rbo=!1,this._target=r.TEXTURE_2D,this._samples=1,this._is3d=!1,this.width=1,this.height=1,this.depth=1,this.bytes=0,this.url=null}useTexture3d(){this._is3d=!0}destroy(e=!1){if(e||(this._ref--,!(this._ref>0))){if(this.ready){const e=this._manager.gl;var t;this._rbo?e.deleteRenderbuffer(this._texture):e.deleteTexture(this._texture),this._texture=null,delete this._texture,(t=e.getError())!==e.NO_ERROR&&console.log("GL error in texture.destroy(): "+t)}this._manager&&this._manager.deleteTexture(this.name),super.destroy()}}_create(e){const t=this._manager.gl;this._texture=t.createTexture();var r=t.NEAREST;this._filter!==t.LINEAR_MIPMAP_NEAREST&&this._filter!==t.NEAREST_MIPMAP_LINEAR&&this._filter!==t.LINEAR_MIPMAP_LINEAR&&this._filter!==t.LINEAR||(r=t.LINEAR),t.activeTexture(t.TEXTURE0+7),t.bindTexture(t.TEXTURE_2D,this._texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this._filter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this._wrap),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this._wrap),e?t.texImage2D(t.TEXTURE_2D,0,this._format,this._format,this._type,e):t.texImage2D(t.TEXTURE_2D,0,this._internalFormat,this.width,this.height,0,this._format,this._type,null),this._mipmap&&t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)}updateImage(e,t,r,i,n){this.ready=!1,this.createFromImage(e,t,r,i,n)}createFromImage(e,t,r,i,n){const a=this._manager.gl;this.ready||(this._format=t,this._type=r,this.width=e.width,this.height=e.height,this._filter=i,this._wrap=n,this._filter!==a.LINEAR_MIPMAP_NEAREST&&this._filter!==a.NEAREST_MIPMAP_LINEAR&&this._filter!==a.LINEAR_MIPMAP_LINEAR&&this._filter!==a.NEAREST_MIPMAP_NEAREST||(this._mipmap=!0),this._create(e),a.getError()===a.NO_ERROR?this.ready=!0:a.deleteTexture(this._texture))}createFromCanvas(e,t,r,i,n){const a=this._manager.gl;if(!this.ready){this._format=t,this._type=r,this.width=e.width,this.height=e.height,this._filter=i,this._wrap=n,this._filter!==a.LINEAR_MIPMAP_NEAREST&&this._filter!==a.NEAREST_MIPMAP_LINEAR&&this._filter!==a.LINEAR_MIPMAP_LINEAR&&this._filter!==a.NEAREST_MIPMAP_NEAREST||(this._mipmap=!0),this._texture=a.createTexture();var s=a.NEAREST;this._filter!==a.LINEAR_MIPMAP_NEAREST&&this._filter!==a.NEAREST_MIPMAP_LINEAR&&this._filter!==a.LINEAR_MIPMAP_LINEAR&&this._filter!==a.LINEAR||(s=a.LINEAR),a.activeTexture(a.TEXTURE0+7),a.bindTexture(a.TEXTURE_2D,this._texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,this._filter),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,this._wrap),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,this._wrap),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),a.texImage2D(a.TEXTURE_2D,0,this._format,this._format,this._type,e),this._mipmap&&a.generateMipmap(a.TEXTURE_2D),a.bindTexture(a.TEXTURE_2D,null),a.getError()===a.NO_ERROR?this.ready=!0:a.deleteTexture(this._texture)}}createFromImages(e,t,r,i,n){const a=this._manager.gl;if(!this.ready){this._target=a.TEXTURE_CUBE_MAP,this._format=t,this._type=r,this.width=e[0].width,this.height=e[0].height,this._filter=i,this._wrap=n,this._filter!==a.LINEAR_MIPMAP_NEAREST&&this._filter!==a.NEAREST_MIPMAP_LINEAR&&this._filter!==a.LINEAR_MIPMAP_LINEAR&&this._filter!==a.NEAREST_MIPMAP_NEAREST||(this._mipmap=!0),this._texture=a.createTexture();var s=a.NEAREST;this._filter!==a.LINEAR_MIPMAP_NEAREST&&this._filter!==a.NEAREST_MIPMAP_LINEAR&&this._filter!==a.LINEAR_MIPMAP_LINEAR&&this._filter!==a.LINEAR||(s=a.LINEAR),a.activeTexture(a.TEXTURE0+7),a.bindTexture(a.TEXTURE_CUBE_MAP,this._texture),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,this._filter),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,s),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,this._wrap),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,this._wrap),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._format,this._format,this._type,e[0]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._format,this._format,this._type,e[1]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._format,this._format,this._type,e[2]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._format,this._format,this._type,e[3]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._format,this._format,this._type,e[4]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._format,this._format,this._type,e[5]),this._mipmap&&a.generateMipmap(a.TEXTURE_CUBE_MAP),a.bindTexture(a.TEXTURE_CUBE_MAP,null),a.getError()===a.NO_ERROR?this.ready=!0:a.deleteTexture(this._texture)}}createFromDDS(e,t){a.default.OpenFile1(e,"arraybuffer",Promise).downloadFile().then(e=>{let r=n.DDSTools.GetDDSInfo(e.data);this.width=r.width,this.height=r.height;let i=r.isRGB||r.isLuminance||r.mipmapCount>1;const a=this._manager.gl;this._texture=a.createTexture(),r.isCube?(this._target=a.TEXTURE_CUBE_MAP,this._filter=a.LINEAR_MIPMAP_LINEAR):(this._target=a.TEXTURE_2D,this._filter=a.LINEAR);var s=a.LINEAR;this._wrap=a.CLAMP_TO_EDGE,a.activeTexture(a.TEXTURE0+7),a.bindTexture(this._target,this._texture),a.texParameteri(this._target,a.TEXTURE_MIN_FILTER,this._filter),a.texParameteri(this._target,a.TEXTURE_MAG_FILTER,s),a.texParameteri(this._target,a.TEXTURE_WRAP_S,this._wrap),a.texParameteri(this._target,a.TEXTURE_WRAP_T,this._wrap),n.DDSTools.UploadDDSLevels(a,this,e.data,r,i,6,-1),a.bindTexture(a.TEXTURE_CUBE_MAP,null),r.isFourCC||1!==r.mipmapCount||this.generateCubeMapMipMap(),a.getError()===a.NO_ERROR?this.ready=!0:a.deleteTexture(this._texture),t&&t()})}createFromFiles(e,t,r,i,n){if(6===e.length){var a=[],s=0;e.forEach((o,l)=>{var d=new Image;d.crossOrigin="anonymous",a.push(d),d.onload=(()=>{++s===e.length&&(this.createFromImages(a,t,this._manager.gl.UNSIGNED_BYTE,r,i),n&&n(this))}),d.src=o})}else console.warn("file length should be 6.")}createFromFile(e,t,r,i,n){if(!this.ready){var a=new Image;a.crossOrigin="anonymous",a.onload=(()=>{this.createFromImage(a,t,this._manager.gl.UNSIGNED_BYTE,r,i),null!==n&&n(this)}),a.src=e}}create(e,t,r,i,n,a,s){const o=this._manager.gl;if(!this.ready){r=r||o.RGBA;var l=o.UNSIGNED_BYTE;this.width=e,this.height=t,this.depth,this._filter=i||o.LINEAR,this._wrap=n||o.CLAMP_TO_EDGE;var d=r;if(o.isWebGL2&&(this._samples=a||1),r===o.RGB32F||r===o.RGBA32F||r===o.R32F){if(!o.floatTextureExtension&&!o.isWebGL2)return void console.error("Unsupported texture format for texture "+this.name);l=o.FLOAT,r=r===o.RGB32F?o.RGB:r===o.RGBA32F?o.RGBA:o.RED}else if(r===o.RGB16F||r===o.RGBA16F||r===o.R16F)l=o.HALF_FLOAT,r=r===o.RGB16F?o.RGB:r===o.RGBA16F?o.RGBA:o.RED;else if(r===o.RGBA8||r===o.RGBA)l=o.UNSIGNED_BYTE,r=o.RGBA;else if(r===o.RGB8||r===o.RGB)l=o.UNSIGNED_BYTE,r=o.RGB;else if(r===o.R8)l=o.UNSIGNED_BYTE,r=o.isWebGL2?o.RED:o.ALPHA;else if(r===o.DEPTH_COMPONENT16||r===o.DEPTH_COMPONENT24||r===o.DEPTH_COMPONENT32||r===o.DEPTH_COMPONENT){if(!o.depthTextureExtension&&!o.isWebGL2)return void console.error("Unsupported texture format for texture "+this.name);l=o.UNSIGNED_INT,r===o.DEPTH_COMPONENT16?l=o.UNSIGNED_SHORT:r!==o.DEPTH_COMPONENT24&&r!==o.DEPTH_COMPONENT32||(l=o.UNSIGNED_INT),r=o.DEPTH_COMPONENT}else if(r===o.DEPTH24_STENCIL8||r===o.DEPTH_STENCIL)l=o.isWebGL2?o.UNSIGNED_INT_24_8:o.depthTextureExtension.UNSIGNED_INT_24_8_WEBGL,r=o.DEPTH_STENCIL;else{if(r!==o.ALPHA&&r!==o.LUMINANCE_ALPHA&&r!==o.LUMINANCE)return void console.error("Unsupported texture format for texture "+this.name);l=o.UNSIGNED_BYTE}this._format=r,this._internalFormat=o.isWebGL2?d:r,this._type=l;var u=o.NEAREST;if(this._filter!==o.LINEAR_MIPMAP_NEAREST&&this._filter!==o.NEAREST_MIPMAP_LINEAR&&this._filter!==o.LINEAR_MIPMAP_LINEAR&&this._filter!==o.LINEAR||(u=o.LINEAR),o.isWebGL2)if(a>1){if(this._texture=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,this._texture),o.renderbufferStorageMultisample(o.RENDERBUFFER,this._samples,this._internalFormat,this.width,this.height),o.getError()!==o.NO_ERROR)return void o.deleteRenderbuffer(this._texture);this._rbo=!0}else this._texture=o.createTexture(),o.activeTexture(o.TEXTURE0+7),this._is3d?(o.bindTexture(o.TEXTURE_3D,this._texture),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_MIN_FILTER,this._filter),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_MAG_FILTER,u),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_WRAP_S,this._wrap),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_WRAP_T,this._wrap),o.texStorage2D(o.TEXTURE_3D,1,this._internalFormat,this.width,this.height,this.depth)):(o.bindTexture(o.TEXTURE_2D,this._texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this._filter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,u),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,this._wrap),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,this._wrap),o.texStorage2D(o.TEXTURE_2D,1,this._internalFormat,this.width,this.height));else if(this._format!==o.DEPTH24_STENCIL8||o.depthTextureExtension)this._texture=o.createTexture(),o.activeTexture(o.TEXTURE0+7),o.bindTexture(o.TEXTURE_2D,this._texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this._filter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,u),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,this._wrap),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,this._wrap),o.texImage2D(o.TEXTURE_2D,0,this._internalFormat,this.width,this.height,0,this._internalFormat,this._type,null);else{if(this._texture=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,this._texture),o.renderbufferStorage(o.RENDERBUFFER,this._internalFormat,e,t),o.getError()!==o.NO_ERROR)return void o.deleteRenderbuffer(this._texture);this._rbo=!0}o.getError()===o.NO_ERROR?this.ready=!0:o.deleteTexture(this._texture)}}update(e){const t=this._manager.gl;t.activeTexture(t.TEXTURE0+7),t.bindTexture(t.TEXTURE_2D,this._texture),this._format===t.LUMINANCE&&t.pixelStorei(t.UNPACK_ALIGNMENT,1),t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,this._format,this._type,e),this._format===t.LUMINANCE&&t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.getError()===t.NO_ERROR?this.ready=!0:t.deleteTexture(this._texture)}copy(){const e=this._manager.gl;if(!this._rbo){this.ready=!1;var t=this.width,r=this.height;e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,this._texture),e.copyTexSubImage2D(e.TEXTURE_2D,0,0,0,0,0,t,r),e.getError()===e.NO_ERROR&&(this.ready=!0),e.bindTexture(e.TEXTURE_2D,null)}}resize(e,t){const r=this._manager.gl;if(this.ready&&(this.width!==e||this.height!==t)){if(e>4096&&(e=4096),t>4096&&(t=4096),this.width=e,this.height=t,-1!==this.name.search(/-[0-9]+x[0-9]+-/)){let e=this.name.split("-"),t=e[0]+"-"+this.width+"x"+this.height+"-"+e[2];this._manager.renameTexture(this.name,t),this.name=t}this.ready=!1,this._rbo?(r.bindRenderbuffer(r.RENDERBUFFER,this._texture),this._samples<=1?r.renderbufferStorage(r.RENDERBUFFER,this._internalFormat,e,t):r.renderbufferStorageMultisample(r.RENDERBUFFER,this._samples,this._internalFormat,this.width,this.height),r.getError()===r.NO_ERROR?this.ready=!0:r.deleteRenderbuffer(this._texture),r.bindRenderbuffer(r.RENDERBUFFER,null)):(r.deleteTexture(this._texture),this._create(null),r.getError()===r.NO_ERROR?this.ready=!0:r.deleteTexture(this._texture))}}generateMipmap(){const e=this._manager.gl;!this.ready||this._rbo||this._mipmap||(this._mipmap=!0,e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,this._texture),e.generateMipmap(e.TEXTURE_2D),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.bindTexture(e.TEXTURE_2D,null))}generateCubeMapMipMap(){const e=this._manager.gl;!this.ready||this._rbo||this._mipmap||(this._mipmap=!0,e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_CUBE_MAP,this._texture),e.generateMipmap(e.TEXTURE_CUBE_MAP),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.bindTexture(e.TEXTURE_CUBE_MAP,null))}use(e){const t=this._manager.gl;this.ready&&!this._rbo?(t.activeTexture(t.TEXTURE0+e),t.bindTexture(this._target,this._texture)):console.warn("texture "+this.name+" is either not ready or not bindable.")}isFloating(){const e=this._manager.gl;return this._type===e.FLOAT||this._type===e.isWebGL2?e.UNSIGNED_INT_24_8:e.depthTextureExtension.UNSIGNED_INT_24_8_WEBGL}isMultisamples(){return this._samples>1}hasAlpha(){const e=this._manager.gl;return this._format===e.RGBA||this._format===e.RGBA32F||this._format===e.RGBA16F||this._format===e.RGBA8}getSize(){const e=this._manager.gl;if(!this.ready)return 0;var t=this.width*this.height;switch(this._format){case e.RG:t*=2;break;case e.RGB:t*=3;break;case e.RGBA:t*=4}switch(this._type){case e.FLOAT:case e.isWebGL2?e.UNSIGNED_INT_24_8:e.depthTextureExtension.UNSIGNED_INT_24_8_WEBGL:t*=4;break;case e.DEPTH_COMPONENT16:t*=2}return this.bytes=t,this.bytes}discard(){const e=this._manager.gl;this.ready&&(this._rbo?e.deleteRenderbuffer(this._texture):e.deleteTexture(this._texture),this._texture=null,this.ready=!1)}getFilter(){return this._filter}getWrap(){return this._wrap}restore(){const e=this._manager.gl;this.ready||(this._rbo?this.create(this.width,this.height,this._internalFormat,this._filter,this._wrap,this._samples):this._create(null),e.getError()===e.NO_ERROR?this.ready=!0:e.deleteTexture(this._texture))}}},"./02resource/m3d_geometric_shape.js":function(e,t,r){"use strict";r.r(t);var i=r("./01wrapper/glenum.ts"),n=r("./02resource/MeshAttributes.ts"),a=r("./glMatrix.js");t.default=function(){function e(){this.vertices=null,this.indices=null,this.attributes=null,this.indexType=null,this.primitive=null}return e.prototype.transform=function(e){if(this.attributes)for(var t=this.attributes.values[0].stride/4,r=this.attributes.hasNormal,i=[0,0,0,0],n=[0,0,0],s=0,o=this.vertices.length;s<o;s+=t)n[0]=this.vertices[s],n[1]=this.vertices[s+1],n[2]=this.vertices[s+2],a.vec3.transformMat4(i,n,e),this.vertices[s]=i[0],this.vertices[s+1]=i[1],this.vertices[s+2]=i[2],r&&(n[0]=this.vertices[s+3],n[1]=this.vertices[s+4],n[2]=this.vertices[s+5],n[3]=0,a.vec4.transformMat4(i,n,e),a.vec3.normalize(i,i),this.vertices[s+3]=i[0],this.vertices[s+4]=i[1],this.vertices[s+5]=i[2])},e.prototype.rotate=function(e,t,r){var i=a.mat4.create(),n=a.mat4.create();a.mat4.rotateZ(i,n,r),a.mat4.rotateY(n,i,t),a.mat4.rotateX(i,n,e),this.transform(i)},e.prototype.translate=function(e,t,r){var i=a.mat4.create();a.mat4.fromTranslation(i,[e,t,r]),this.transform(i)},e.prototype.scale=function(e,t,r){var i=a.mat4.create();a.mat4.fromScaling(i,[e,t,r]),this.transform(i)},e.prototype.merge=function(e,t){if(e.attributes.values[0].stride===t.attributes.values[0].stride){var r,n,a=new Float32Array(e.vertices.length+t.vertices.length);for(r=0;r<e.vertices.length;r++)a[r]=e.vertices[r];for(r=0,n=e.vertices.length;r<t.vertices.length;r++,n++)a[n]=t.vertices[r];var s=new Uint16Array(e.indices.length+t.indices.length);for(r=0;r<e.indices.length;r++)s[r]=e.indices[r];var o=e.vertices.length/(e.attributes.values[0].stride/4);for(r=0,n=e.indices.length;r<t.indices.length;r++,n++)s[n]=t.indices[r]+o;this.vertices=a,this.indices=s,this.attributes=e.attributes,this.indexType=i.gl.UNSIGNED_SHORT}},e.prototype.createWiredCube=function(e=1){var t=new Float32Array(24),r=new Uint8Array(24);t[0]=-e,t[1]=-e,t[2]=-e,t[3]=e,t[4]=-e,t[5]=-e,t[6]=e,t[7]=e,t[8]=-e,t[9]=-e,t[10]=e,t[11]=-e,t[12]=-e,t[13]=-e,t[14]=e,t[15]=e,t[16]=-e,t[17]=e,t[18]=e,t[19]=e,t[20]=e,t[21]=-e,t[22]=e,t[23]=e,r[0]=0,r[1]=1,r[2]=1,r[3]=2,r[4]=2,r[5]=3,r[6]=3,r[7]=0,r[8]=0,r[9]=4,r[10]=1,r[11]=5,r[12]=2,r[13]=6,r[14]=3,r[15]=7,r[16]=4,r[17]=5,r[18]=5,r[19]=6,r[20]=6,r[21]=7,r[22]=7,r[23]=4,this.vertices=t,this.indices=r,this.indexType=i.gl.UNSIGNED_BYTE,this.primitive=i.gl.LINES,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT)},e.prototype.createWiredCubeField=function(e,t){var r=new ArrayBuffer(96*e*t),a=new Float32Array(r,0,24*e*t),s=e*t*8;if(s<256)var o=new Uint8Array(24*e*t);else if(s<65536)o=new Uint16Array(24*e*t);else o=new Uint32Array(24*e*t);for(var l=0,d=0,u=0,c=1/e,h=1/t,m=0;m<e;m++)for(var f=0;f<t;f++){for(var p=c*(m+.5)*2-1,v=h*(f+.5)*2-1,_=0;_<8;_++)a[l]=p,a[l+1]=v,a[l+2]=0,l+=3;o[d+0]=0+u,o[d+1]=1+u,o[d+2]=1+u,o[d+3]=2+u,o[d+4]=2+u,o[d+5]=3+u,o[d+6]=0+u,o[d+7]=3+u,o[d+8]=4+u,o[d+9]=5+u,o[d+10]=5+u,o[d+11]=6+u,o[d+12]=6+u,o[d+13]=7+u,o[d+14]=4+u,o[d+15]=7+u,o[d+16]=0+u,o[d+17]=4+u,o[d+18]=1+u,o[d+19]=5+u,o[d+20]=2+u,o[d+21]=6+u,o[d+22]=3+u,o[d+23]=7+u,u+=8,d+=24}this.vertices=new Uint8Array(r),this.indices=o,this.primitive=i.gl.LINES,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT),this.indexType=u<256?i.gl.UNSIGNED_BYTE:u<65536?i.gl.UNSIGNED_SHORT:i.gl.UNSIGNED_INT},e.prototype.createSolidCubeField=function(e,t){var r=new ArrayBuffer(576*e*t),a=new Float32Array(r,0,144*e*t),s=e*t*24;if(s<256)var o=new Uint8Array(36*e*t);else if(s<65536)o=new Uint16Array(36*e*t);else o=new Uint32Array(36*e*t);for(var l=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],d=0,u=0,c=0,h=1/e,m=1/t,f=0;f<e;f++)for(var p=0;p<t;p++)for(var v=h*(f+.5)*2-1,_=m*(p+.5)*2-1,g=0;g<6;g++){for(var b=0;b<4;b++)a[d+0]=v,a[d+1]=_,a[d+2]=0,a[d+3]=l[g][0],a[d+4]=l[g][1],a[d+5]=l[g][2],d+=6;g%2==0?(o[u+0]=0+c,o[u+1]=2+c,o[u+2]=1+c,o[u+3]=1+c,o[u+4]=2+c,o[u+5]=3+c):(o[u+0]=0+c,o[u+1]=1+c,o[u+2]=2+c,o[u+3]=2+c,o[u+4]=1+c,o[u+5]=3+c),c+=4,u+=6}this.vertices=new Uint8Array(r),this.indices=o,this.primitive=i.gl.TRIANGLES,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT,i.gl.FLOAT),this.indexType=c<256?i.gl.UNSIGNED_BYTE:c<65536?i.gl.UNSIGNED_SHORT:i.gl.UNSIGNED_INT},e.prototype.createGrid=function(e,t){for(var r=new Float32Array((e+1)*(t+1)*5),a=new Uint32Array(6*e*t),s=0,o=0;o<e+1;o++)for(var l=o/e,d=2*(l-.5),u=0;u<t+1;u++){var c=u/t,h=2*(c-.5);r[0+s]=d,r[1+s]=h,r[2+s]=0,r[3+s]=l,r[4+s]=c,s+=5}var m=0,f=t+1;for(o=1;o<e+1;o++)for(u=0;u<t;u++){var p=[(o-1)*f+u,(o-1)*f+1+u,o*f+u,o*f+1+u];a[0+m]=p[0],a[1+m]=p[1],a[2+m]=p[2],a[3+m]=p[2],a[4+m]=p[1],a[5+m]=p[3],m+=6}this.vertices=r,this.indices=a,this.primitive=i.gl.TRIANGLES,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT,null,i.gl.FLOAT),this.indexType=i.gl.UNSIGNED_INT},e.prototype.createSolidCube=function(e=1){var t,r,a=new Float32Array(144),s=new Uint8Array(36);r=0,a[(t=0)+0]=-e,a[t+1]=-e,a[t+2]=-e,a[t+3]=-1,a[t+4]=0,a[t+5]=0,a[t+6]=-e,a[t+7]=e,a[t+8]=-e,a[t+9]=-1,a[t+10]=0,a[t+11]=0,a[t+12]=-e,a[t+13]=-e,a[t+14]=e,a[t+15]=-1,a[t+16]=0,a[t+17]=0,a[t+18]=-e,a[t+19]=e,a[t+20]=e,a[t+21]=-1,a[t+22]=0,a[t+23]=0,s[r+0]=0,s[r+1]=2,s[r+2]=1,s[r+3]=1,s[r+4]=2,s[r+5]=3,r+=6,a[(t+=24)+0]=e,a[t+1]=-e,a[t+2]=-e,a[t+3]=1,a[t+4]=0,a[t+5]=0,a[t+6]=e,a[t+7]=e,a[t+8]=-e,a[t+9]=1,a[t+10]=0,a[t+11]=0,a[t+12]=e,a[t+13]=-e,a[t+14]=e,a[t+15]=1,a[t+16]=0,a[t+17]=0,a[t+18]=e,a[t+19]=e,a[t+20]=e,a[t+21]=1,a[t+22]=0,a[t+23]=0,s[r+0]=4,s[r+1]=5,s[r+2]=6,s[r+3]=5,s[r+4]=7,s[r+5]=6,r+=6,a[(t+=24)+0]=-e,a[t+1]=-e,a[t+2]=-e,a[t+3]=0,a[t+4]=-1,a[t+5]=0,a[t+6]=e,a[t+7]=-e,a[t+8]=-e,a[t+9]=0,a[t+10]=-1,a[t+11]=0,a[t+12]=-e,a[t+13]=-e,a[t+14]=e,a[t+15]=0,a[t+16]=-1,a[t+17]=0,a[t+18]=e,a[t+19]=-e,a[t+20]=e,a[t+21]=0,a[t+22]=-1,a[t+23]=0,s[r+0]=8,s[r+1]=9,s[r+2]=11,s[r+3]=11,s[r+4]=10,s[r+5]=8,r+=6,a[(t+=24)+0]=-e,a[t+1]=e,a[t+2]=-e,a[t+3]=0,a[t+4]=1,a[t+5]=0,a[t+6]=e,a[t+7]=e,a[t+8]=-e,a[t+9]=0,a[t+10]=1,a[t+11]=0,a[t+12]=-e,a[t+13]=e,a[t+14]=e,a[t+15]=0,a[t+16]=1,a[t+17]=0,a[t+18]=e,a[t+19]=e,a[t+20]=e,a[t+21]=0,a[t+22]=1,a[t+23]=0,s[r+0]=12,s[r+1]=14,s[r+2]=13,s[r+3]=13,s[r+4]=14,s[r+5]=15,r+=6,a[(t+=24)+0]=-e,a[t+1]=-e,a[t+2]=-e,a[t+3]=0,a[t+4]=0,a[t+5]=-1,a[t+6]=e,a[t+7]=-e,a[t+8]=-e,a[t+9]=0,a[t+10]=0,a[t+11]=-1,a[t+12]=-e,a[t+13]=e,a[t+14]=-e,a[t+15]=0,a[t+16]=0,a[t+17]=-1,a[t+18]=e,a[t+19]=e,a[t+20]=-e,a[t+21]=0,a[t+22]=0,a[t+23]=-1,s[r+0]=16,s[r+1]=19,s[r+2]=17,s[r+3]=19,s[r+4]=16,s[r+5]=18,r+=6,a[(t+=24)+0]=-e,a[t+1]=-e,a[t+2]=e,a[t+3]=0,a[t+4]=0,a[t+5]=1,a[t+6]=e,a[t+7]=-e,a[t+8]=e,a[t+9]=0,a[t+10]=0,a[t+11]=1,a[t+12]=-e,a[t+13]=e,a[t+14]=e,a[t+15]=0,a[t+16]=0,a[t+17]=1,a[t+18]=e,a[t+19]=e,a[t+20]=e,a[t+21]=0,a[t+22]=0,a[t+23]=1,s[r+0]=20,s[r+1]=21,s[r+2]=23,s[r+3]=23,s[r+4]=22,s[r+5]=20,this.vertices=a,this.indices=s,this.primitive=i.gl.TRIANGLES,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT,i.gl.FLOAT),this.indexType=i.gl.UNSIGNED_BYTE},e.prototype.createTextGrid=function(e){var t,r=4*e.length,a=new Float32Array(5*r);r<256?(t=new Uint8Array(6*e.length),this.indexType=i.gl.UNSIGNED_BYTE):r<65536?(t=new Uint16Array(6*e.length),this.indexType=i.gl.UNSIGNED_SHORT):(t=new Uint32Array(6*e.length),this.indexType=i.gl.UNSIGNED_INT);var s=0,o=0,l=0,d=0;e.forEach(function(e){d+=e.size}),d/=2,e.forEach(function(e,r){a[0+s]=-d+l-e.xoffset,a[1+s]=0,a[2+s]=e.yoffset-.5,a[3+s]=e.x1,a[4+s]=e.y2,a[0+(s+=5)]=-d+e.width+l-e.xoffset,a[1+s]=0,a[2+s]=e.yoffset-.5,a[3+s]=e.x2,a[4+s]=e.y2,a[0+(s+=5)]=-d+e.width+l-e.xoffset,a[1+s]=0,a[2+s]=-e.height+e.yoffset-.5,a[3+s]=e.x2,a[4+s]=e.y1,a[0+(s+=5)]=-d+l-e.xoffset,a[1+s]=0,a[2+s]=-e.height+e.yoffset-.5,a[3+s]=e.x1,a[4+s]=e.y1,s+=5,l+=e.size,t[0+o]=0+4*r,t[1+o]=2+4*r,t[2+o]=1+4*r,t[3+o]=0+4*r,t[4+o]=3+4*r,t[5+o]=2+4*r,o+=6}),this.vertices=a,this.indices=t,this.primitive=i.gl.TRIANGLES,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT,null,i.gl.FLOAT,null)},e.prototype.createQuad=function(e,t,r,a){var s=12,o=3;e&&(s+=8,o+=2),t&&(s+=12,o+=3),a&&(s+=16,o+=4);var l=new Float32Array(s),d=new Uint8Array(6),u=0;if(r?(l[0+u]=1,l[1+u]=0,l[2+u]=1,l[0+(u+=o)]=-1,l[1+u]=0,l[2+u]=1,l[0+(u+=o)]=-1,l[1+u]=0,l[2+u]=-1,l[0+(u+=o)]=1,l[1+u]=0,l[2+u]=-1):(l[0+u]=-1,l[1+u]=-1,l[2+u]=0,l[0+(u+=o)]=1,l[1+u]=-1,l[2+u]=0,l[0+(u+=o)]=1,l[1+u]=1,l[2+u]=0,l[0+(u+=o)]=-1,l[1+u]=1,l[2+u]=0),u=0,t){var c=[0,0,0];r?c[1]=1:c[2]=1;for(var h=0;h<4;h++)l[3+u]=c[0],l[4+u]=c[1],l[5+u]=c[2],u+=o}if(u=0,e){var m=o-2;r?(l[m+u]=1,l[m+1+u]=0,l[m+(u+=o)]=0,l[m+1+u]=0,l[m+(u+=o)]=0,l[m+1+u]=1,l[m+(u+=o)]=1,l[m+1+u]=1):(l[m+u]=0,l[m+1+u]=0,l[m+(u+=o)]=1,l[m+1+u]=0,l[m+(u+=o)]=1,l[m+1+u]=1,l[m+(u+=o)]=0,l[m+1+u]=1)}d[0]=0,d[1]=1,d[2]=2,d[3]=2,d[4]=3,d[5]=0,this.vertices=l,this.indices=d,this.primitive=i.gl.TRIANGLES,this.attributes=new n.default;var f=null,p=null,v=null;t&&(f=i.gl.FLOAT),e&&(p=i.gl.FLOAT),a&&(v=i.gl.FLOAT),this.attributes.builtin(i.gl.FLOAT,f,p,v),this.indexType=i.gl.UNSIGNED_BYTE},e.prototype.createPoint=function(){var e=new Float32Array(10),t=new Uint16Array(1);e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,t[0]=0,this.vertices=e,this.indices=t,this.primitive=i.gl.POINTS,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT,null,null,null),this.indexType=i.gl.UNSIGNED_SHORT},e.prototype.createSphere=function(e,t){for(var r=new Float32Array((e+1)*(t+1)*8),s=new Uint16Array(6*e*(t+1)),o=new Float32Array(3),l=Math.PI/e,d=2*Math.PI/t,u=0,c=0,h=0,m=0;m<=e;++m)for(var f=Math.sin(m*l),p=Math.cos(m*l),v=0;v<=t;++v){var _=f*Math.cos(v*d),g=f*Math.sin(v*d);r[h++]=_,r[h++]=g,r[h++]=p,o[0]=_,o[1]=g,o[2]=p,a.vec3.normalize(o,o),r[h++]=o[0],r[h++]=o[1],r[h++]=o[2],r[h++]=v/t,r[h++]=m/e,m!==e&&(s[u++]=c+t+1,s[u++]=c,s[u++]=c+t,s[u++]=c+t+1,s[u++]=c+1,s[u++]=c,c++)}this.vertices=r,this.indices=s,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT,i.gl.FLOAT,i.gl.FLOAT),this.primitive=i.gl.TRIANGLES,this.indexType=i.gl.UNSIGNED_SHORT},e.prototype.createLine=function(){var e=new Float32Array(6),t=new Uint8Array(2);e[0]=-.5,e[1]=0,e[2]=0,e[3]=.5,e[4]=0,e[5]=0,t[0]=0,t[1]=1,this.vertices=e,this.indices=t,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT),this.attributes.primitive=i.gl.LINES,this.primitive=i.gl.LINES,this.indexType=i.gl.UNSIGNED_BYTE},e.prototype.createLineStrip=function(){var e=new Float32Array(6),t=new Uint8Array(2);e[0]=-.5,e[1]=0,e[2]=0,e[3]=.5,e[4]=0,e[5]=0,t[0]=0,t[1]=1,this.vertices=e,this.indices=t,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT),this.attributes.primitive=i.gl.LINE_STRIP,this.primitive=i.gl.LINE_STRIP,this.indexType=i.gl.UNSIGNED_BYTE},e.prototype.createArc=function(e,t,r,a){for(var s=new Float32Array(3*(2*a+2)),o=new Uint16Array(2*a*3),l=r/a,d=0,u=[0,0,0],c=0;c<a+1;c++)u[0]=e*Math.sin(d),u[1]=e*Math.cos(d),s[6*c+0]=(e-t)*Math.sin(d),s[6*c+1]=(e-t)*Math.cos(d),s[6*c+2]=0,s[6*c+3]=(e+t)*Math.sin(d),s[6*c+4]=(e+t)*Math.cos(d),s[6*c+5]=0,d+=l;for(c=0;c<a;c++)o[6*c+0]=2*c+0,o[6*c+1]=2*c+1,o[6*c+2]=2*c+3,o[6*c+3]=2*c+0,o[6*c+4]=2*c+3,o[6*c+5]=2*c+2;this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT),this.primitive=i.gl.TRIANGLES,this.indexType=i.gl.UNSIGNED_SHORT,this.vertices=s,this.indices=o},e.prototype.createTorus=function(e,t,r,s){var o,l,d=2*Math.PI,u=new Float32Array(s*r*8),c=new Uint16Array(s*r*2*3),h=0,m=[0,0],f=[0,0,0],p=[0,0,0];for(l=0;l<s;l++)for(o=0;o<r;o++){var v=o/r*d,_=l/s*d;m[0]=e*Math.cos(v),m[1]=e*Math.sin(v),f[0]=(e+t*Math.cos(_))*Math.cos(v),f[1]=(e+t*Math.cos(_))*Math.sin(v),f[2]=t*Math.sin(_),a.vec3.subtract(p,f,m),a.vec3.normalize(p,p),u[h+0]=f[0],u[h+1]=f[1],u[h+2]=f[2],u[h+3]=p[0],u[h+4]=p[1],u[h+5]=p[2],u[h+6]=o/e,u[h+7]=l/t,h+=8}for(h=0,l=0;l<s;l++)for(o=0;o<r;o++){var g=(o+1)%r,b=(l+1)%s,y=r*l+o,x=r*l+g,w=r*b+o,E=r*b+g;c[h]=y,c[h+1]=w,c[h+2]=x,c[h+3]=w,c[h+4]=E,c[h+5]=x,h+=6}this.vertices=u,this.indices=c,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT,i.gl.FLOAT,i.gl.FLOAT),this.primitive=i.gl.TRIANGLES,this.indexType=i.gl.UNSIGNED_SHORT},e.prototype.createCone=function(e,t,r){var s,o=2*Math.PI,l=new Float32Array(6*r*3+6),d=new Uint16Array(9*r),u=0,c=[0,0,0],h=e*t*t/(e*e+t*t),m=e*e*t/(e*e+t*t);for(s=0;s<r;s++){var f=s/r*o,p=Math.cos(f),v=Math.sin(f);l[u]=e*p,l[u+1]=e*v,l[u+2]=0,c[0]=h*p,c[1]=h*v,c[2]=m,a.vec3.normalize(c,c),l[u+3]=c[0],l[u+4]=c[1],l[u+5]=c[2],l[u+=6]=0,l[u+1]=0,l[u+2]=t,l[u+3]=c[0],l[u+4]=c[1],l[u+5]=c[2],l[u+=6]=0,l[u+1]=0,l[u+2]=t,l[u+3]=0,l[u+4]=0,l[u+5]=-1,u+=6}for(l[u+0]=0,l[u+1]=0,l[u+2]=0,u=0,s=0;s<r;s++){var _=(s+1)%r;d[u]=3*s+1,d[u+1]=3*s,d[u+2]=3*_,d[u+3]=3*_,d[u+4]=3*_+1,d[u+5]=3*s+1,u+=6}for(s=0;s<r;s++){_=(s+1)%r;d[u]=3*r,d[u+1]=3*_+2,d[u+2]=3*s+2,u+=3}this.vertices=l,this.indices=d,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT,i.gl.FLOAT),this.primitive=i.gl.TRIANGLES,this.indexType=i.gl.UNSIGNED_SHORT},e.prototype.createCylinder=function(e,t,r){var a,s,o=2*Math.PI,l=new Float32Array(6*r*4+6),d=new Uint16Array(12*r),u=0;for(a=0;a<r;a++){var c=a/r*o,h=Math.cos(c),m=Math.sin(c);l[u]=e*h,l[u+1]=e*m,l[u+2]=0,l[u+3]=h,l[u+4]=m,l[u+5]=0,l[u+=6]=e*h,l[u+1]=e*m,l[u+2]=t,l[u+3]=h,l[u+4]=m,l[u+5]=0,l[u+=6]=e*h,l[u+1]=e*m,l[u+2]=0,l[u+3]=0,l[u+4]=0,l[u+5]=-1,l[u+=6]=e*h,l[u+1]=e*m,l[u+2]=t,l[u+3]=0,l[u+4]=0,l[u+5]=1,u+=6}for(l[u+0]=0,l[u+1]=0,l[u+2]=0,l[u+3]=0,l[u+4]=0,l[u+5]=t,u=0,a=0;a<r;a++)s=(a+1)%r,d[u]=4*a+1,d[u+1]=4*a,d[u+2]=4*s,d[u+3]=4*s,d[u+4]=4*s+1,d[u+5]=4*a+1,u+=6;for(a=0;a<r;a++)s=(a+1)%r,d[u]=4*r,d[u+1]=4*s+2,d[u+2]=4*a+2,d[u]=4*r+1,d[u+1]=4*s+3,d[u+2]=4*a+3,u+=6;this.vertices=l,this.indices=d,this.attributes=new n.default,this.attributes.builtin(i.gl.FLOAT,i.gl.FLOAT),this.primitive=i.gl.TRIANGLES,this.indexType=i.gl.UNSIGNED_SHORT},e.prototype.createArrow=function(t,r){var n=new e,a=new e;a.createCone(t,.1*r,8),n.createCylinder(.6*t,.9*r,8),a.translate(0,0,.9*r);var s=new e;s.merge(n,a),this.vertices=s.vertices,this.indices=s.indices,this.attributes=s.attributes,this.indexType=s.indexType,this.primitive=i.gl.TRIANGLES},e}()},"./02resource/m3d_shader_chunks.js":function(e,t,r){"use strict";r.r(t),t.default={"blit.fs":"uniform sampler2D m_uBlitTexture;\r\n#if MOBILE\r\nuniform sampler2D m_uBlitDepthTexture;\r\n#endif\r\nuniform vec2 m_uInvResolution;\r\n\r\n#if WEBGL2\r\n\r\nin vec2 m_vTexCoord;\r\nout vec4 out_color;\r\n\r\n#else \r\n\r\nvarying vec2 m_vTexCoord;\r\n\r\n#endif\r\n\r\n#include <uniform.inc>\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution);\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution);\r\n#endif\r\nvoid main() \r\n{ \r\n#if WEBGL2\r\n\r\n#if MOBILE\r\n out_color = shade(m_uBlitTexture, m_uBlitDepthTexture, m_vTexCoord, m_uInvResolution);\r\n#else\r\n out_color = shade(m_uBlitTexture, m_vTexCoord, m_uInvResolution);\r\n#endif\r\n\r\n#else\r\n\r\n#if MOBILE\r\n gl_FragColor = shade(m_uBlitTexture, m_uBlitDepthTexture, m_vTexCoord, m_uInvResolution);\r\n#else\r\n gl_FragColor = shade(m_uBlitTexture, m_vTexCoord, m_uInvResolution);\r\n#endif\r\n\r\n#endif\r\n}\r\n","blit.vs":"#if WEBGL2\r\n\r\nin vec3 m_aPosition;\r\nin vec2 m_aTexCoord;\r\nout vec2 m_vTexCoord;\r\n\r\n#else\r\n\r\nattribute vec3 m_aPosition;\r\nattribute vec2 m_aTexCoord;\r\nvarying vec2 m_vTexCoord;\r\n\r\n#endif\r\n\r\nvoid main() \r\n{ \r\n#if MODEL_TRANSFORM\r\n gl_Position = m_uPerNode.modelMatrix * vec4(m_aPosition.xy, 0.999999, 1.0); \r\n#else\r\n gl_Position = vec4(m_aPosition.xy, 0.999999, 1.0); \r\n#endif\r\n m_vTexCoord = m_aTexCoord;\r\n}\r\n\r\n","blit_accumulate.inc":"uniform sampler2D uTexture0;\r\nuniform float uFrameCount;\r\n\r\nfloat random( vec2 p )\r\n{\r\n return fract(sin(dot(p.xy, vec2(12.9898, 78.233))) * (43758.5453 + uFrameCount * 1231.3));\r\n}\r\n \r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 accum = sampleTexture2D(tex, uv);\r\n vec4 sampleColor = sampleTexture2D(uTexture0, uv); \r\n vec4 result = (sampleColor + (uFrameCount - 1.0) * accum) / uFrameCount;\r\n float dither = 1.0/255.0 * (random(uv - 0.5) - 0.5);\r\n result += vec4(dither,dither, dither, 0.0);\r\n\r\n return result;\r\n}\r\n\r\n","blit_contour.inc":"vec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{ \r\n vec2 coordCenter = uv; \r\n vec2 coordUp = uv + vec2(0.0, -invResolution.y); \r\n vec2 coordDown = uv + vec2(0.0, invResolution.y); \r\n vec2 coordLeft = uv + vec2(-invResolution.x, 0.0); \r\n vec2 coordRight = uv + vec2(invResolution.x, 0.0); \r\n vec2 coordUpLeft = uv + vec2(-invResolution.x, -invResolution.y); \r\n vec2 coordDownLeft = uv + vec2(-invResolution.x, invResolution.y); \r\n vec2 coordUpRight = uv + vec2(-invResolution.x, invResolution.y); \r\n vec2 coordDownRight = uv + vec2(invResolution.x, invResolution.y); \r\n float contour = 0.0; \r\n\r\n float d = sampleTexture2D(tex, coordCenter).r;\r\n if(d < 1.0 &&\r\n (sampleTexture2D(tex, coordUp).r > 0.5 || \r\n sampleTexture2D(tex, coordDown).r > 0.5 || \r\n sampleTexture2D(tex, coordLeft).r > 0.5 || \r\n sampleTexture2D(tex, coordRight).r > 0.5 || \r\n sampleTexture2D(tex, coordUpLeft).r > 0.5 || \r\n sampleTexture2D(tex, coordDownLeft).r > 0.5 || \r\n sampleTexture2D(tex, coordUpRight).r > 0.5 || \r\n sampleTexture2D(tex, coordDownRight).r > 0.5)) \r\n {\r\n contour = 1.0; \r\n }\r\n return vec4(contour); \r\n} \r\n","blit_contour_overlay.inc":"uniform vec4 uColor;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 scene = sampleTexture2D(tex, uv);\r\n vec2 coord00 = uv + vec2(-invResolution.x * 2.0, -invResolution.y * 2.0);\r\n vec2 coord01 = uv + vec2(-invResolution.x * 2.0, -invResolution.y);\r\n vec2 coord02 = uv + vec2(-invResolution.x * 2.0, 0.0);\r\n vec2 coord03 = uv + vec2(-invResolution.x * 2.0, invResolution.y);\r\n vec2 coord04 = uv + vec2(-invResolution.x * 2.0, invResolution.y * 2.0);\r\n\r\n vec2 coord10 = uv + vec2(-invResolution.x, -invResolution.y * 2.0);\r\n vec2 coord11 = uv + vec2(-invResolution.x, -invResolution.y);\r\n vec2 coord12 = uv + vec2(-invResolution.x, 0.0);\r\n vec2 coord13 = uv + vec2(-invResolution.x, invResolution.y);\r\n vec2 coord14 = uv + vec2(-invResolution.x, invResolution.y * 2.0);\r\n\r\n vec2 coord20 = uv + vec2(0.0, -invResolution.y * 2.0);\r\n vec2 coord21 = uv + vec2(0.0, -invResolution.y);\r\n vec2 coord22 = uv + vec2(0.0, 0.0);\r\n vec2 coord23 = uv + vec2(0.0, invResolution.y);\r\n vec2 coord24 = uv + vec2(0.0, invResolution.y * 2.0);\r\n vec2 coord30 = uv + vec2(invResolution.x, -invResolution.y * 2.0);\r\n vec2 coord31 = uv + vec2(invResolution.x, -invResolution.y);\r\n vec2 coord32 = uv + vec2(invResolution.x, 0.0);\r\n vec2 coord33 = uv + vec2(invResolution.x, invResolution.y);\r\n vec2 coord34 = uv + vec2(invResolution.x, invResolution.y * 2.0);\r\n vec2 coord40 = uv + vec2(invResolution.x * 2.0, -invResolution.y * 2.0);\r\n vec2 coord41 = uv + vec2(invResolution.x * 2.0, -invResolution.y);\r\n vec2 coord42 = uv + vec2(invResolution.x * 2.0, 0.0);\r\n vec2 coord43 = uv + vec2(invResolution.x * 2.0, invResolution.y);\r\n vec2 coord44 = uv + vec2(invResolution.x * 2.0, invResolution.y * 2.0);\r\n\r\n vec4 contour = sampleTexture2D(tex, coord00) * 0.0090 +\r\n sampleTexture2D(tex, coord01) * 0.0399 +\r\n sampleTexture2D(tex, coord02) * 0.0657 +\r\n sampleTexture2D(tex, coord03) * 0.0399 +\r\n sampleTexture2D(tex, coord04) * 0.0090 +\r\n sampleTexture2D(tex, coord10) * 0.0399 +\r\n sampleTexture2D(tex, coord11) * 0.1788 +\r\n sampleTexture2D(tex, coord12) * 0.2949 +\r\n sampleTexture2D(tex, coord13) * 0.1788 +\r\n sampleTexture2D(tex, coord14) * 0.0399 +\r\n sampleTexture2D(tex, coord20) * 0.0657 +\r\n sampleTexture2D(tex, coord21) * 0.2949 +\r\n sampleTexture2D(tex, coord22) * 0.4863 +\r\n sampleTexture2D(tex, coord23) * 0.2949 +\r\n sampleTexture2D(tex, coord24) * 0.0657 +\r\n sampleTexture2D(tex, coord30) * 0.0399 +\r\n sampleTexture2D(tex, coord31) * 0.1788 +\r\n sampleTexture2D(tex, coord32) * 0.2949 +\r\n sampleTexture2D(tex, coord33) * 0.1788 +\r\n sampleTexture2D(tex, coord34) * 0.0399 +\r\n sampleTexture2D(tex, coord40) * 0.0090 +\r\n sampleTexture2D(tex, coord41) * 0.0399 +\r\n sampleTexture2D(tex, coord42) * 0.0657 +\r\n sampleTexture2D(tex, coord43) * 0.0399 +\r\n sampleTexture2D(tex, coord44) * 0.0090;\r\n float a = min(1.0, contour.a);\r\n return uColor * a + scene * (1.0 - a);\r\n} \r\n\r\n","blit_direct.fs":"uniform vec3 uColor;\r\n\r\n#if WEBGL2\r\nout vec4 out_color;\r\n#endif\r\n\r\nvoid main() \r\n{ \r\n#if WEBGL2\r\n out_color = vec4(uColor, 1);\r\n#else\r\n gl_FragColor = vec4(uColor, 1);\r\n#endif\r\n}\r\n","blit_dof.inc":"uniform bool useDepth;\r\nuniform sampler2D m_uBlitDepthTexture;\r\nuniform float maxblur;\r\nuniform float aperture;\r\nuniform vec2 nearFar;\r\nuniform float focus;\r\n\r\nconst float UnpackDownscale = 255. / 256.; const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\r\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\r\n\r\nfloat unpackRGBAToDepth( const in vec4 v ) {\r\n return dot( v, UnpackFactors );\r\n}\r\n\r\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\r\n return ( near * far ) / ( ( far - near ) * invClipZ - far );\r\n}\r\n\r\nfloat getViewZ( const in float depth ) {\r\n\treturn perspectiveDepthToViewZ( depth, nearFar.x, nearFar.y );\r\n}\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec2 dofblur;\r\n vec2 aspectcorrect = vec2(1.0, invResolution.y / invResolution.x);\r\n if (useDepth) \r\n {\r\n float viewZ = getViewZ(unpackRGBAToDepth(sampleTexture2D(m_uBlitDepthTexture, uv)));\r\n float factor = focus + viewZ;\r\n dofblur = vec2(clamp(factor * aperture, -maxblur, maxblur));\r\n }\r\n else \r\n {\r\n dofblur = vec2(clamp(sampleTexture2D(m_uBlitDepthTexture, vec2(uv.x, 1.0 - uv.y)).a * aperture, -maxblur, maxblur));\r\n }\r\n vec2 dofblur9 = dofblur * 0.9;\r\n vec2 dofblur7 = dofblur * 0.7;\r\n vec2 dofblur4 = dofblur * 0.4;\r\n vec4 col = vec4( 0.0 );\r\n col += sampleTexture2D(tex, uv);\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, 0.4 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.15, 0.37 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, 0.29 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.37, 0.15 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.40, 0.0 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.37, -0.15 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, -0.29 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, -0.4 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.15, 0.37 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, 0.29 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.37, 0.15 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.4, 0.0 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.15, -0.37 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.15, 0.37 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.37, 0.15 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.15, 0.37 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.37, 0.15 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, 0.29 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.40, 0.0 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, -0.4 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, 0.29 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.4, 0.0 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, 0.4 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, 0.29 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.4, 0.0 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, -0.4 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, 0.29 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.4, 0.0 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, 0.4 ) * aspectcorrect ) * dofblur4 );\r\n col = col / 41.0;\r\n col.a = 1.0;\r\n return col;\r\n}\r\n","blit_fog.inc":"uniform vec4 uColor;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 color = sampleTexture2D(tex, uv);\r\n float depth = uv.y;\r\n\r\n return mix(color, uColor, depth);\r\n}\r\n","blit_glow.inc":"uniform float intensity;\r\nuniform float offset;\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n vec4 color = sampleTexture2D(tex, uv);\r\n color.a = abs(offset - color.a);\r\n return color * intensity * 2.0;\r\n}\r\n","blit_glow_blur.inc":"uniform vec2 direction;\r\nuniform float radius;\r\nuniform float weights[7];\r\n\r\nfloat getLuminance(vec3 color)\r\n{\r\n return dot(color, vec3(0.2126, 0.7152, 0.0722));\r\n}\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n\r\n\tvec2 texelStep = invResolution * direction * radius;\r\n\tvec2 start = uv - 3.0 * texelStep;\r\n\r\n\tvec4 baseColor = vec4(0., 0., 0., 0.);\r\n\tvec2 texelOffset = vec2(0., 0.);\r\n\r\n\tfor (int i = 0; i < 7; i++)\r\n\t{\r\n\t\t\t\tvec4 texel = sampleTexture2D(tex, start + texelOffset);\r\n\t\tbaseColor.a += texel.a * weights[i];\r\n\r\n\t\t\t\tfloat luminance = getLuminance(baseColor.rgb);\r\n\t\tfloat luminanceTexel = getLuminance(texel.rgb);\r\n\t\tfloat choice = step(luminanceTexel, luminance);\r\n\t\tbaseColor.rgb = choice * baseColor.rgb + (1.0 - choice) * texel.rgb;\r\n\r\n\t\ttexelOffset += texelStep;\r\n\t}\r\n\r\n\treturn baseColor;\r\n}\r\n","blit_gradient.inc":"uniform vec3 uColor;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n \r\n \r\n \r\n vec4 t = sampleTexture2D(tex, uv);\r\n return vec4(uColor, 1.0 - t.r);\r\n}\r\n","blit_metaball.inc":"uniform vec4 uColor;\r\nuniform vec4 uContourColor;\r\nuniform float uContourWidth;\r\nconst float uThreshold = 0.3;\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n float contourThreshold = uThreshold * uContourWidth;\r\n float alpha = sampleTexture2D(tex, uv).r;\r\n\r\n vec4 ret;\r\n \r\n if (alpha < uThreshold) {\r\n\t discard;\r\n }\r\n\r\n#if CONTOUR\r\n if (alpha < contourThreshold) {\r\n ret = uContourColor;\r\n } else {\r\n#endif\r\n ret = uColor;\r\n#if CONTOUR\r\n }\r\n#endif\r\n\r\n return ret;\r\n}\r\n","blit_oit.inc":"uniform sampler2D uTexture1;\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 rgbAlphaAdd = sampleTexture2D(m_uBlitTexture, uv);\r\n \r\n float alphaMulti = sampleTexture2D(uTexture1, uv).r; \r\n\r\n vec4 ret = vec4(rgbAlphaAdd.rgb / clamp(alphaMulti, 1e-4, 5e4), rgbAlphaAdd.a);\r\n\r\n return ret;\r\n}\r\n","blit_overlay.inc":"uniform sampler2D m_uForeground;\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n vec4 ret = sampleTexture2D(m_uForeground, uv);\r\n return ret;\r\n}\r\n","blit_shadow.inc":"const float g0 = 0.0751; const float g1 = 0.1238; const float g2 = 0.0751; \r\nconst float g3 = 0.1238; const float g4 = 0.2042; const float g5 = 0.1238; \r\nconst float g6 = 0.0751; const float g7 = 0.1238; const float g8 = 0.0751; \r\nconst float C = 85.0;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{ \r\n float tmp = 0.0;\r\n vec2 coord; \r\n\r\n float pixelSize = invResolution.x;\r\n\r\n coord = uv + vec2(-pixelSize, -pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g0;\r\n\r\n coord = uv + vec2(0.0, -pixelSize); \r\n \r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g1;\r\n \r\n coord = uv + vec2(pixelSize, -pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g2;\r\n\r\n coord = uv + vec2(-pixelSize, 0.0); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g3; \r\n\r\n coord = uv; \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g4;\r\n \r\n coord = uv + vec2(pixelSize, 0.0 ); \r\n \r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g5;\r\n\r\n coord = uv + vec2(-pixelSize, pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g6;\r\n \r\n coord = uv + vec2(0.0, pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g7;\r\n \r\n coord = uv + vec2(pixelSize, pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g8;\r\n\r\n return vec4(tmp); \r\n} \r\n\r\n","blit_simple.inc":"#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n return sampleTexture2D(tex, uv);\r\n}\r\n","blit_sketch.inc":"uniform float uThreshold; \r\nuniform float uContrast; \r\nuniform vec3 uNearAxis; \r\nuniform bool uIsPerspective; \r\n\r\n#if MOBILE\r\nuniform vec2 uNearFar;\r\n\r\nvoid getNormalPosition(in sampler2D tex, in sampler2D tex2, vec2 coord, out vec3 position, out vec3 normal) \r\n{\r\n vec2 uv = coord * 0.5 + vec2(0.5); \r\n vec4 n = sampleTexture2D(tex, uv); \r\n\r\n normal = normalize(n.xyz * 2.0 - 1.0); \r\n vec4 p = sampleTexture2D(tex2, uv);\r\n float depth = p.x * 2.0 -1.0;\r\n \r\n if (uIsPerspective) \r\n {\r\n position.z = -2.0 * uNearFar.x * uNearFar.y / (uNearFar.x + uNearFar.y - depth * (uNearFar.y - uNearFar.x));\r\n position.xy = uNearAxis.xy * coord.xy * position.z / uNearAxis.z; \r\n } \r\n else \r\n {\r\n position.xy = uNearAxis.xy * coord.xy;\r\n position.z = 0.5 * (depth * (uNearFar.y - uNearFar.x) + uNearFar.x + uNearFar.y);\r\n }\r\n} \r\n#else\r\nvoid getNormalPosition(in sampler2D tex, vec2 coord, out vec3 position, out vec3 normal) \r\n{\r\n vec2 uv = coord * 0.5 + vec2(0.5); \r\n vec4 p = sampleTexture2D(tex, uv); \r\n\r\n normal = normalize(p.xyz); \r\n position.z = p.w; \r\n if (uIsPerspective) \r\n { \r\n position.xy = uNearAxis.xy * coord.xy * p.w / uNearAxis.z; \r\n } \r\n else \r\n {\r\n position.xy = uNearAxis.xy * coord.xy;\r\n }\r\n}\r\n#endif\r\n\r\nfloat planeDistance(vec3 posA, vec3 norA, vec3 posB, vec3 norB) \r\n{ \r\n vec3 posDelta = normalize(posB - posA); \r\n float planeDist = max(abs(dot(posDelta, norA)), abs(dot(posDelta, norB))); \r\n float normalDist = max(1.0 - dot(norA, norB), 0.0); \r\n \r\n return max(planeDist, normalDist);\r\n} \r\n\r\nuniform vec3 uColor;\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else \r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n vec2 vFragCoord = uv * 2.0 - vec2(1.0);\r\n vec2 coordCenter = vFragCoord.xy ; \r\n vec2 coordUp = vFragCoord - vec2(0.0, 2.0 * invResolution.y); \r\n vec2 coordDown = vFragCoord + vec2(0.0, 2.0 * invResolution.y); \r\n vec2 coordLeft = vFragCoord - vec2(2.0 * invResolution.x, 0.0); \r\n vec2 coordRight = vFragCoord + vec2(2.0 * invResolution.x, 0.0); \r\n vec3 posUp, norUp; \r\n vec3 posDown, norDown; \r\n vec3 posLeft, norLeft; \r\n vec3 posRight, norRight; \r\n#if MOBILE\r\n getNormalPosition(tex, tex2, coordUp, posUp, norUp); \r\n getNormalPosition(tex, tex2, coordDown, posDown, norDown); \r\n getNormalPosition(tex, tex2, coordLeft, posLeft, norLeft); \r\n getNormalPosition(tex, tex2, coordRight, posRight, norRight); \r\n#else \r\n getNormalPosition(tex, coordUp, posUp, norUp); \r\n getNormalPosition(tex, coordDown, posDown, norDown); \r\n getNormalPosition(tex, coordLeft, posLeft, norLeft); \r\n getNormalPosition(tex, coordRight, posRight, norRight);\r\n#endif\r\n vec2 planeDist = vec2(planeDistance(posLeft, norLeft, posRight, norRight), \r\n planeDistance(posUp, norUp, posDown, norDown)); \r\n float edge = length(planeDist); \r\n float sketch = step(edge, uThreshold); \r\n sketch = clamp(uContrast * (1.0 - sketch), 0.0, 1.0); \r\n \r\n return vec4(uColor, sketch);\r\n}\r\n","blit_solid.inc":"uniform vec3 uColor;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n return vec4(uColor, 1);\r\n}\r\n","blit_ssao.inc":"uniform vec3 uNearAxis;\r\nuniform vec2 uTexTransform;\r\nuniform vec2 SAMPLES[16];\r\nuniform float uRadius;\r\nuniform bool uIsPerspective;\r\n\r\nvec4 getNormalAndDepth(sampler2D tex, vec2 fragCoord)\r\n{\r\n vec2 texcoord = fragCoord * 0.5 + vec2(0.5);\r\n texcoord.x = texcoord.x * uTexTransform.x + uTexTransform.y;\r\n return sampleTexture2D(tex, texcoord);\r\n}\r\n\r\nvec3 getEyePosition(vec2 fragCoord, float depth)\r\n{\r\n vec3 eyeDirection = uNearAxis * vec3(fragCoord, 1.0);\r\n vec3 eyePosition;\r\n eyePosition.z = depth;\r\n if (uIsPerspective) \r\n {\r\n eyePosition.xy = eyeDirection.xy * depth / eyeDirection.z;\r\n } \r\n else \r\n {\r\n eyePosition.xy = eyeDirection.xy;\r\n }\r\n return eyePosition; \r\n}\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n float ao = 0.0;\r\n float radius = uRadius;\r\n float radius2 = radius * radius;\r\n const float bias = 0.0001;\r\n const float epsilon = 0.0001;\r\n vec2 vFragCoord = uv * 2.0 - vec2(1.0);\r\n vec4 p = getNormalAndDepth(tex, vFragCoord);\r\n vec3 eyePosition = getEyePosition(vFragCoord, p.w);\r\n vec3 normal = p.xyz;\r\n for (int i = 0; i < 16; i++)\r\n {\r\n vec2 d = SAMPLES[i] - vec2(0.5);\r\n vec2 sample = vec2(vFragCoord + d * radius / eyePosition.z);\r\n float depth = getNormalAndDepth(tex, sample).w;\r\n vec3 samplePosition = getEyePosition(sample, depth);\r\n vec3 v_i = samplePosition - eyePosition;\r\n float v_v = dot(v_i, v_i);\r\n float f = max(radius2 - v_v, 0.0) / radius2;\r\n ao += f * f * f * max(0.0,(dot(v_i, normal) + eyePosition.z * bias)/(v_v + epsilon));\r\n }\r\n float occ = 1.0 - ao / (4.0 * 16.0);\r\n occ = clamp(pow(occ, 2.04), 0.0, 1.0);\r\n return vec4(occ);\r\n}\r\n\r\n","blit_ssao2.inc":"uniform vec3 uNearAxis; \r\nuniform vec2 uTexTransform; \r\nuniform float uRadius; \r\nuniform bool uIsPerspective; \r\nuniform float uFrameCount; \r\nuniform vec4 uTexSizeAndInv; \r\nuniform vec2 SAMPLES[8]; \r\n\r\n#if MOBILE\r\nuniform vec2 uNearFar;\r\n\r\nvec4 getNormalAndDepth(in sampler2D tex, in sampler2D tex2, vec2 fragCoord) \r\n{\r\n vec2 texcoord = fragCoord * 0.5 + vec2(0.5);\r\n texcoord.x = texcoord.x * uTexTransform.x + uTexTransform.y;\r\n \r\n vec4 ret = sampleTexture2D(tex, texcoord); \r\n ret.xyz = normalize(ret.xyz * 2.0 - 1.0); \r\n \r\n vec4 p = sampleTexture2D(tex2, texcoord);\r\n float depth = p.x * 2.0 -1.0;\r\n if (uIsPerspective) \r\n {\r\n ret.w = -2.0 * uNearFar.x * uNearFar.y / (uNearFar.x + uNearFar.y - depth * (uNearFar.y - uNearFar.x));\r\n } \r\n else \r\n {\r\n ret.w = 0.5 * (depth * (uNearFar.y - uNearFar.x) + uNearFar.x + uNearFar.y);\r\n }\r\n return ret;\r\n} \r\n#else\r\nvec4 getNormalAndDepth(in sampler2D tex, vec2 fragCoord) \r\n{\r\n vec2 texcoord = fragCoord * 0.5 + vec2(0.5);\r\n texcoord.x = texcoord.x * uTexTransform.x + uTexTransform.y;\r\n \r\n return sampleTexture2D(tex, texcoord); \r\n} \r\n#endif\r\n\r\n\r\nvec3 getEyePosition(vec2 fragCoord, float depth) \r\n{\r\n vec3 eyeDirection = uNearAxis * vec3(fragCoord, 1.0); \r\n vec3 eyePosition; \r\n eyePosition.z = depth; \r\n if (uIsPerspective) \r\n { \r\n eyePosition.xy = eyeDirection.xy * depth / eyeDirection.z; \r\n } \r\n else \r\n {\r\n eyePosition.xy = eyeDirection.xy; \r\n } \r\n return eyePosition; \r\n} \r\n\r\nvec3 getScreenPosition(vec3 eyePos) \r\n{ \r\n if (uIsPerspective)\r\n {\r\n return vec3(eyePos.xy * uNearAxis.z / uNearAxis.xy / eyePos.z, eyePos.z); \r\n }\r\n else\r\n {\r\n return vec3(eyePos.xy / uNearAxis.xy, eyePos.z); \r\n }\r\n} \r\n\r\n#if MOBILE\r\nvec3 getOffsetEyePosition(in sampler2D tex, in sampler2D tex2, vec3 viewPos, vec2 offset) \r\n#else\r\nvec3 getOffsetEyePosition(in sampler2D tex, vec3 viewPos, vec2 offset) \r\n#endif\r\n{ \r\n vec2 scnPos = getScreenPosition(viewPos).xy; \r\n vec2 scnOffset = getScreenPosition(vec3(offset, viewPos.z)).xy; \r\n vec2 pixOffset = scnOffset * uTexSizeAndInv.xy * 0.5;\r\n if(length(pixOffset) > 2.0) \r\n {\r\n scnOffset = (floor(pixOffset + 0.5) ) * uTexSizeAndInv.zw * 2.0;\r\n }\r\n#if MOBILE\r\nfloat sampDepth = getNormalAndDepth(tex, tex2, scnPos + scnOffset).w; \r\n#else\r\nfloat sampDepth = getNormalAndDepth(tex, scnPos + scnOffset).w; \r\n#endif\r\n return getEyePosition(scnPos + scnOffset, sampDepth); \r\n} \r\n\r\nvec3 computeMultiBounceColor(float x, vec3 albedo) \r\n{ \r\n vec3 a = 2.0404 * albedo - 0.3324; \r\n vec3 b = -4.7951 * albedo + 0.6417; \r\n vec3 c = 2.7552 * albedo + 0.6903; \r\n return max( vec3(x,x,x), ( ( x * a + b ) * x + c ) * x ); \r\n} \r\n\r\nfloat random(vec2 p) \r\n{ \r\n return fract(sin(dot(p.xy, vec2(12.9898, 78.233))) * (43758.5453 + (uFrameCount) * 1231.3));\r\n} \r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else \r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{ \r\n float maxScreenRadius = 0.4; float falloffDist = 0.0; float randScale = 0.4; const float aoStrength = 1.1; const float PI = 3.1415926535898; \r\n const float HalfPI = 1.570796326794895; \r\n\r\n vec2 vFragCoord = uv * 2.0 - vec2(1.0);\r\n#if MOBILE\r\n vec4 p = getNormalAndDepth(tex, tex2, vFragCoord); \r\n#else\r\n vec4 p = getNormalAndDepth(tex, vFragCoord); \r\n#endif\r\n vec3 eyePosition = getEyePosition(vFragCoord, p.w); \r\n vec3 normal = p.xyz; \r\n float xx = p.w;\r\n if (length(normal) < 0.95) {\r\n return vec4(1.0);\r\n }\r\n\r\n vec2 projScrRadius = getEyePosition(vec2(1.0, 1.0) * maxScreenRadius, p.w).xy; \r\n vec3 viewDir = vec3(0.0, 0.0, 1.0);\r\n\r\n float radiusScale = 1.0 + randScale * (random(vFragCoord * 0.5 - 0.5) - 0.5); \r\n float radius = radiusScale * min(uRadius, min(projScrRadius.x, projScrRadius.y)); \r\n\r\n if (uIsPerspective) {\r\n viewDir = normalize(-uNearAxis * vec3(vFragCoord, 1.0)); \r\n } \r\n\r\n vec3 sliceTan = normalize(vec3(SAMPLES[7], 0.0));\r\n vec3 sliceNorm = normalize(cross(viewDir, sliceTan)); \r\n vec3 normalSliceProj = normal - dot(normal, sliceNorm) * sliceNorm; \r\n vec3 normalSliceDir = normalize(normalSliceProj); \r\n float thetaN = acos(dot(normalSliceDir, viewDir)) * sign(dot(cross(sliceNorm, viewDir), normalSliceDir)); \r\n\r\n float horizon1 = thetaN + HalfPI;\r\n for (int i = 0; i < 8; ++i) \r\n { \r\n vec2 p = SAMPLES[i];\r\n#if MOBILE\r\nvec3 offsetPosition = getOffsetEyePosition(tex, tex2, eyePosition, p * radius); \r\n#else\r\nvec3 offsetPosition = getOffsetEyePosition(tex, eyePosition, p * radius); \r\n#endif\r\n vec3 v_i = offsetPosition - eyePosition; \r\n float h1 = min(acos(dot(normalize(v_i), viewDir)), HalfPI + thetaN); \r\n float weight = 1.0 - clamp((length(v_i) / radius - falloffDist), 0.0, 1.0); \r\n horizon1 = mix(horizon1, min(horizon1, h1), weight); \r\n } \r\n\r\n float horizon2 = -thetaN + HalfPI;\r\n for(int i = 0; i < 8; ++i) \r\n { \r\n vec2 p = -SAMPLES[i]; \r\n#if MOBILE\r\nvec3 offsetPosition = getOffsetEyePosition(tex, tex2, eyePosition, p * radius); \r\n#else\r\nvec3 offsetPosition = getOffsetEyePosition(tex, eyePosition, p * radius); \r\n#endif\r\n vec3 v_i = offsetPosition - eyePosition; \r\n float h2 = min(acos(dot(normalize(v_i), viewDir)), HalfPI - thetaN); \r\n float weight = 1.0 - clamp((length(v_i) / radius - falloffDist), 0.0, 1.0); \r\n horizon2 = mix(horizon2, min(horizon2, h2), weight); \r\n } \r\n\r\n \r\n float occ = 1.0 - (cos(horizon1) + cos(horizon2)) * 0.5 * aoStrength; \r\n vec3 ao = computeMultiBounceColor(occ, vec3(1.0,1.0,1.0));\r\n\r\n return vec4(ao, 1.0); \r\n}\r\n","blit_transparent.inc":"uniform vec4 uColor;\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else \r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n float x = uColor.a;\r\n return uColor;\r\n}\r\n","blit_vr_wrap.inc":"uniform vec2 uLeftCenterOffset; \r\nuniform vec2 uRightCenterOffset; \r\nuniform vec4 uWarpScaleParam; \r\nuniform vec3 uHmdWarpParam; \r\nuniform bool uCalibration;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 res;\r\n if(m_vTexCoord.x <= 0.5){ \r\n vec2 coord = vec2(m_vTexCoord.x * 2.0, m_vTexCoord.y); \r\n vec2 offset = (coord.xy - uLeftCenterOffset) * uWarpScaleParam.xy;\r\n float dist2 = offset.x * offset.x + offset.y * offset.y;\r\n \r\n vec2 offsetWarp = offset * (uHmdWarpParam.x + uHmdWarpParam.y * dist2 + uHmdWarpParam.z * dist2 * dist2);\r\n vec2 sampLoc = uLeftCenterOffset + offsetWarp * uWarpScaleParam.zw;\r\n \r\n if(all(equal(clamp(sampLoc, 0.0, 1.0), sampLoc)))\r\n res = sampleTexture2D(tex, vec2(sampLoc.x * 0.5, sampLoc.y)); \r\n else\r\n res = vec4(0.0);\r\n \r\n if (uCalibration) {\r\n if(res.w > 0.0 && (mod(sampLoc.x - uLeftCenterOffset.x, 0.1) < 0.002 || mod(sampLoc.y, 0.1) < 0.002))\r\n res = vec4(0.0,0.0,1.0,1.0);\r\n \r\n if(length(coord.xy - uLeftCenterOffset) < 0.01) \r\n res = vec4(0.0, 0.0, 0.0, 1.0);\r\n }\r\n } else { \r\n vec2 coord = vec2((m_vTexCoord.x - 0.5) * 2.0, m_vTexCoord.y); \r\n vec2 offset = (coord.xy - uRightCenterOffset) * uWarpScaleParam.xy;\r\n float dist2 = offset.x * offset.x + offset.y * offset.y;\r\n vec2 offsetWarp = offset * (uHmdWarpParam.x + \r\n uHmdWarpParam.y * dist2 + uHmdWarpParam.z * dist2 * dist2);\r\n vec2 sampLoc = uRightCenterOffset + offsetWarp * uWarpScaleParam.zw;\r\n if(all(equal(clamp(sampLoc, 0.0, 1.0), sampLoc)))\r\n res = sampleTexture2D(tex, vec2(sampLoc.x* 0.5 + 0.5, sampLoc.y));\r\n else\r\n res = vec4(0.0, 0.0, 0.0, 1.0);\r\n\r\n if (uCalibration) {\r\n if(res.w > 0.0 && (mod(sampLoc.x - uRightCenterOffset.x, 0.1) < 0.002 || mod(sampLoc.y, 0.1) < 0.002))\r\n res = vec4(0.0,0.0,1.0,1.0);\r\n if(length(coord.xy - uRightCenterOffset) < 0.01)\r\n res = vec4(1.0,0.0,0.0,1.0);\r\n }\r\n\r\n }\r\n return res;\r\n}\r\n","clipping.inc":"#if CLIPPING\r\n if (dot(m_vVertex.xyz, m_uGlobal.clipPlanes[0].xyz) > m_uGlobal.clipPlanes[0].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[1].xyz) > m_uGlobal.clipPlanes[1].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[2].xyz) > m_uGlobal.clipPlanes[2].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[3].xyz) > m_uGlobal.clipPlanes[3].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[4].xyz) > m_uGlobal.clipPlanes[4].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[5].xyz) > m_uGlobal.clipPlanes[5].w) {\r\n discard;\r\n }\r\n#endif","depth_main.fs":"#include <globalvars.inc>\r\n\r\n#if ENCODE_DEPTH\r\nvec4 encodeDepth(float depth)\r\n{\r\n const vec4 bitShift = vec4(255.0*255.0*255.0, 255.0*255.0, 255.0, 1.0);\r\n const vec4 bitMask = vec4(0.0, 1.0/255.0, 1.0/255.0, 1.0/255.0);\r\n vec4 res = fract(depth * bitShift); \r\n res -= res.xxyz * bitMask; \r\n return res;\r\n}\r\n#endif\r\n\r\n#if WEBGL2\r\n out vec4 out_color;\r\n#endif\r\n\r\n#if ALPHATEST\r\n uniform sampler2D m_uDiffuseTexture;\r\n#endif\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n#if ALPHATEST\r\n vec4 texel = sampleTexture2D(m_uDiffuseTexture, m_vTexCoord.xy);\r\n if (texel.a < 0.15)\r\n {\r\n discard;\r\n }\r\n#endif\r\n\r\n#if ENCODE_DEPTH\r\n vec4 o = encodeDepth(gl_FragCoord.z); \r\n#else\r\n vec4 o = gl_FragCoord.zzzz;\r\n#endif\r\n\r\n#if WEBGL2\r\n out_color = o;\r\n#else\r\n gl_FragColor = o;\r\n#endif\r\n}\r\n","gamma.inc":"float linearTosRGB1(const in float c, const in float gamma)\r\n{\r\n float v = 0.0;\r\n if (c < 0.0031308) \r\n {\r\n if ( c > 0.0) \r\n {\r\n v = c * 12.92;\r\n }\r\n } \r\n else \r\n {\r\n v = 1.055 * pow(c, 1.0 / gamma) - 0.055;\r\n }\r\n return v;\r\n}\r\n\r\nvec3 linearTosRGB(const in vec3 rgb, const in float gamma)\r\n{\r\n vec3 ret;\r\n ret.r = linearTosRGB1(rgb.r, gamma);\r\n ret.g = linearTosRGB1(rgb.g, gamma);\r\n ret.b = linearTosRGB1(rgb.b, gamma);\r\n return ret;\r\n}\r\n\r\nfloat sRGBToLinear1(const in float c, const in float gamma)\r\n{\r\n float v = 0.0;\r\n if (c < 0.04045)\r\n {\r\n if (c >= 0.0)\r\n {\r\n v = c * ( 1.0 / 12.92);\r\n }\r\n } \r\n else \r\n {\r\n v = pow((c + 0.055) * (1.0 / 1.055), gamma);\r\n }\r\n return v;\r\n}\r\n\r\nvec3 sRGBToLinear(const in vec3 srgb, const in float gamma)\r\n{\r\n vec3 ret;\r\n ret.r = sRGBToLinear1(srgb.r, gamma);\r\n ret.g = sRGBToLinear1(srgb.g, gamma);\r\n ret.b = sRGBToLinear1(srgb.b, gamma);\r\n\r\n return ret;\r\n}\r\n","globalvars.inc":"#if CLIPPING\r\nstruct GlobalStruct\r\n{\r\n vec4 clipPlanes[6];\r\n};\r\nuniform GlobalStruct m_uGlobal;\r\n#endif\r\n","lights.inc":"struct SunLightStruct\r\n{\r\n mat4 diffuseMatrix[3];\r\n float intensity;\r\n vec3 direction;\r\n mat4 shadowMatrix0;\r\n mat4 shadowMatrix1;\r\n};\r\nuniform SunLightStruct m_uSunLight;\r\nuniform sampler2D m_uSunLightProbe;\r\n\r\nstruct PointLightStruct\r\n{\r\n vec3 color;\r\n vec3 position;\r\n float radius;\r\n};\r\n\r\nstruct DirectionalLightStruct\r\n{\r\n vec3 color;\r\n vec3 direction;\r\n};\r\n\r\nstruct SpotLightStruct\r\n{\r\n vec3 color;\r\n vec3 position;\r\n vec3 direction;\r\n float cutoff;\r\n float radius;\r\n};\r\n\r\n#if POINT_LIGHT0\r\nuniform PointLightStruct m_uPointLight0;\r\n#endif\r\n#if POINT_LIGHT1\r\nuniform PointLightStruct m_uPointLight1;\r\n#endif\r\n#if POINT_LIGHT2\r\nuniform PointLightStruct m_uPointLight2;\r\n#endif\r\n\r\n#if DIRECTIONAL_LIGHT0\r\nuniform DirectionalLightStruct m_uDirectionalLight0;\r\n#endif\r\n#if DIRECTIONAL_LIGHT1\r\nuniform DirectionalLightStruct m_uDirectionalLight1;\r\n#endif\r\n#if DIRECTIONAL_LIGHT2\r\nuniform DirectionalLightStruct m_uDirectionalLight2;\r\n#endif\r\n\r\n#if SPOT_LIGHT0\r\nuniform SpotLightStruct m_uSpotLight0;\r\n#endif\r\n#if SPOT_LIGHT1\r\nuniform SpotLightStruct m_uSpotLight1;\r\n#endif\r\n#if SPOT_LIGHT2\r\nuniform SpotLightStruct m_uSpotLight2;\r\n#endif\r\n","main.fs":"#if WEBGL2\r\nin vec3 m_vVertex;\r\nin vec3 m_vNormal;\r\nin vec3 m_vTexCoord;\r\nin vec4 m_vColor;\r\nflat in vec4 m_vId;\r\nin float m_vDepth;\r\nin float m_vColorIndex;\r\n#else \r\n\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\n#include <uniform.inc>\r\n\r\n\r\n\r\n\r\n","main.vs":"#if WEBGL2\r\nlayout (location = 0) in vec3 m_aPosition;\r\n\r\n#if COMPRESSION\r\nlayout (location = 1) in float m_aNormal0;\r\n#else\r\nlayout (location = 1) in vec3 m_aNormal0;\r\n#endif\r\n\r\nlayout (location = 2) in float m_aNormal1;\r\nlayout (location = 3) in float m_aNormal2;\r\nlayout (location = 4) in vec2 m_aTexCoord;\r\nlayout (location = 5) in vec4 m_aColor;\r\nlayout (location = 6) in float m_aMaterial;\r\nlayout (location = 7) in vec3 m_aTangent;\r\nlayout (location = 8) in vec4 m_aJoint0;\r\nlayout (location = 9) in vec4 m_aWeight0;\r\n\r\n#if INSTANCING\r\nlayout (location = 10) in mat4 m_aModelMatrix;\r\n#endif\r\n\r\n\r\n\r\n#else\r\nattribute vec3 m_aPosition;\r\n\r\n#if COMPRESSION\r\nattribute float m_aNormal0;\r\n#else\r\nattribute vec3 m_aNormal0;\r\n#endif\r\n\r\nattribute float m_aNormal1;\r\nattribute float m_aNormal2;\r\nattribute vec2 m_aTexCoord;\r\nattribute vec4 m_aColor;\r\nattribute float m_aMaterial;\r\nattribute vec3 m_aTangent;\r\nattribute vec4 m_aJoint0;\r\nattribute vec4 m_aWeight0;\r\n#if INSTANCING\r\nattribute mat4 m_aModelMatrix;\r\n#endif\r\n\r\n\r\n#endif\r\n\r\n","mark_main.fs":"#include <globalvars.inc>\r\n\r\nout vec4 out_color;\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n \r\n out_color = m_vId;\r\n}","material_animating_ribbon.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nuniform sampler2D m_uPlatteTexture;\r\nuniform float m_uTime;\r\nuniform float m_uSpeed;\r\n\r\nconst vec3 dielectricColor = vec3(0.04); \r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness)\r\n{\r\n vec4 texel = sampleTexture2D(m_uPlatteTexture, m_vTexCoord.xy + m_uTime * vec2(0.001 * m_uSpeed, 0.0));\r\n transparent = texel.a;\r\n diffuse = texel.rgb;\r\n specular = dielectricColor;\r\n}\r\n","material_barchart.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nconst vec3 dielectricColor = vec3(1.0); \r\n#if ALPHATEST\r\n uniform sampler2D m_uDiffuseTexture;\r\n#endif\r\n\r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness)\r\n{\r\n diffuse = m_vColor.xyz;\r\n specular = dielectricColor;\r\n transparent = 1.0;\r\n}\r\n","material_color.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nconst vec3 dielectricColor = vec3(0.04); \r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness)\r\n{\r\n vec3 albedo = m_vColor.rgb;\r\n\r\n transparent = m_vColor.a * m_uMaterial.values[3];\r\n \r\n#if GAMMA\r\n albedo = sRGBToLinear(albedo, 2.2); \r\n#endif\r\n\r\n diffuse = albedo;\r\n specular = dielectricColor;\r\n}\r\n\r\n","material_dummy.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness)\r\n{\r\n transparent = 0.5;\r\n return;\r\n}\r\n","material_heatmap.inc":"const vec3 dielectricColor = vec3(1.0);\r\n\r\nuniform sampler2D m_uData;\r\nuniform sampler2D m_uPlatte;\r\n#if ENABLE_FOREGROUND\r\nuniform sampler2D m_uForeground;\r\n#endif\r\n\r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness)\r\n{\r\n float intensity = sampleTexture2D(m_uData, m_vTexCoord.xy).x;\r\n diffuse = sampleTexture2D(m_uPlatte, vec2(intensity, 0.0)).rgb;\r\n#if ENABLE_FOREGROUND\r\n vec4 foregroundColor = sampleTexture2D(m_uForeground, m_vTexCoord.xy);\r\n diffuse = foregroundColor.rgb * foregroundColor.a + diffuse * (1.0 - foregroundColor.a);\r\n#endif\r\n specular = dielectricColor;\r\n#if DISABLE_BLEND\r\n transparent = 1.0;\r\n#else\r\n transparent = intensity * 100.0; \r\n#endif\r\n}\r\n","material_heightmap.inc":"const vec3 dielectricColor = vec3(1.0);\r\n\r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness)\r\n{\r\n diffuse = m_vColor.xyz;\r\n specular = dielectricColor;\r\n transparent = 1.0;\r\n}\r\n","material_pbr.inc":"#if HAS_BASECOLORMAP\r\nuniform sampler2D m_uBaseColorTexture;\r\n#endif\r\n\r\n#if HAS_METALROUGHNESSMAP\r\nuniform sampler2D m_uMetallicRoughnessTexture;\r\n#endif\r\n\r\n#if HAS_NORMALMAP\r\nuniform sampler2D m_uNormalTexture;\r\n#endif\r\n\r\n#if HAS_EMISSIVEMAP\r\nuniform sampler2D m_uEmissiveTexture;\r\n#endif\r\n\r\n#if HAS_OCCLUSIONMAP\r\n uniform sampler2D m_uOcclusionTexture;\r\n#endif\r\n\r\nstruct MaterialStruct\r\n{\r\n float values[10]; \r\n};\r\n\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nvoid parseMaterial(out vec4 baseColor, out vec3 normal, out vec2 metallicRoughness, out vec3 emissiveColor, out float occlusion)\r\n{\r\n baseColor = vec4(m_uMaterial.values[0], m_uMaterial.values[1], m_uMaterial.values[2], m_uMaterial.values[3]); \r\n#if HAS_BASECOLORMAP\r\n baseColor *= sampleTexture2D(m_uBaseColorTexture, m_vTexCoord.xy);\r\n#endif\r\n\r\n metallicRoughness = vec2(m_uMaterial.values[5], m_uMaterial.values[4]);\r\n#if HAS_METALROUGHNESSMAP\r\n metallicRoughness *= sampleTexture2D(m_uMetallicRoughnessTexture, m_vTexCoord.xy).bg;\r\n#endif\r\n\r\n#if HAS_NORMALMAP\r\n normal = sampleTexture2D(m_uNormalTexture, m_vTexCoord.xy).xyz * 2.0 - vec3(1.0);\r\n#else \r\n normal = m_vNormal;\r\n#endif\r\n\r\n emissiveColor = vec3(m_uMaterial.values[6], m_uMaterial.values[7], m_uMaterial.values[8]);\r\n#if HAS_EMISSIVEMAP\r\n emissiveColor *= sampleTexture2D(m_uEmissiveTexture, m_vTexCoord.xy).xyz;\r\n#endif\r\n\r\n#if HAS_OCCLUSIONMAP\r\n occlusion = sampleTexture2D(m_uOcclusionTexture, m_vTexCoord.xy).r;\r\n#endif\r\n}\r\n\r\n","material_skybox.inc":"#if EQUIRECTANGLE || WALLPAPER\r\nuniform sampler2D m_uSkyTexture;\r\n#else \r\nuniform samplerCube m_uSkyTexture;\r\n#endif \r\n\r\nuniform float m_uTransparency;\r\n\r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness)\r\n{\r\n#if EQUIRECTANGLE || WALLPAPER \r\n diffuse = sampleTexture2D(m_uSkyTexture, m_vTexCoord.xy).xyz; \r\n#endif\r\n#if CUBEMAP\r\n diffuse = sampleTexture3D(m_uSkyTexture, normalize(m_vTexCoord.xyz)).xyz; \r\n#endif \r\n\r\n#if GAMMA\r\n diffuse = sRGBToLinear(diffuse, 2.2); \r\n#endif\r\n transparent = m_uTransparency;\r\n}\r\n","material_solid.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nconst vec3 dielectricColor = vec3(0.04); \r\n#if ALPHATEST\r\n uniform sampler2D m_uDiffuseTexture;\r\n#endif\r\n\r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness)\r\n{\r\n vec3 albedo = vec3(m_uMaterial.values[0], m_uMaterial.values[1], m_uMaterial.values[2]);\r\n transparent = m_uMaterial.values[3];\r\n\r\n#if ALPHATEST\r\n vec4 texel = sampleTexture2D(m_uDiffuseTexture, m_vTexCoord.xy);\r\n float alphatest = texel.a * transparent;\r\n\r\n if (alphatest < 0.15)\r\n {\r\n discard;\r\n }\r\n#endif\r\n \r\n#if GAMMA\r\n albedo = sRGBToLinear(albedo, 2.2); \r\n#endif\r\n \r\n diffuse = albedo;\r\n specular = dielectricColor;\r\n}\r\n\r\n","material_texture.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nuniform sampler2D m_uDiffuseTexture;\r\n\r\n#if SECOND_TEXTURE\r\nuniform sampler2D m_uDiffuseTexture2;\r\n#endif\r\n\r\nconst vec3 dielectricColor = vec3(0.04); \r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness)\r\n{\r\n vec4 texel = sampleTexture2D(m_uDiffuseTexture, m_vTexCoord.xy);\r\n#if SECOND_TEXTURE\r\n vec4 texel2 = sampleTexture2D(m_uDiffuseTexture2, m_vTexCoord.xy);\r\n#endif\r\n\r\n transparent = texel.a * m_uMaterial.values[3];\r\n#if SECOND_TEXTURE\r\n transparent = transparent * (1.0 - texel2.a) + texel2.a;\r\n#endif\r\n\r\n#if ALPHATEST\r\n if (transparent < 0.15) \r\n {\r\n discard;\r\n }\r\n#endif\r\n\r\n vec3 albedo = texel.rgb * vec3(m_uMaterial.values[0], m_uMaterial.values[1], m_uMaterial.values[2]);\r\n#if SECOND_TEXTURE \r\n albedo = albedo * texel.a * m_uMaterial.values[3];\r\n albedo = albedo * (1.0 - texel2.a) + texel2.rgb * texel2.a;\r\n#endif\r\n\r\n#if GAMMA\r\n albedo = sRGBToLinear(albedo, 2.2); \r\n#endif\r\n\r\n diffuse = albedo;\r\n specular = dielectricColor;\r\n\r\n}\r\n\r\n","modelo_dark.fs":"#include <globalvars.inc>\r\n#include <gamma.inc>\r\n#include <lights.inc>\r\n#include <shadow.inc>\r\n\r\n#if WEBGL2\r\nlayout(location=0) out vec4 out_color;\r\n#endif\r\n\r\nstruct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n vec3 N = normalize(m_vNormal);\r\n vec3 V = normalize(m_vVertex * m_uPerFrame.cameraPosition.w - m_uPerFrame.cameraPosition.xyz);\r\n vec3 P = m_vVertex;\r\n\r\n#if DOUBLESIDED \r\n N *= -sign(dot(N, V));\r\n#endif\r\n\r\n vec3 diffuse; \r\n float transparent;\r\n vec3 specular;\r\n\r\n diffuse = vec3(m_uMaterial.values[0], m_uMaterial.values[1], m_uMaterial.values[2]);\r\n transparent = m_uMaterial.values[3];\r\n\r\n\r\n float diffuseTerm = dot(vec4(N, 1), m_uSunLight.diffuseMatrix[0] * vec4(N, 1));\r\n \r\n float nv = max(dot(N, -V), 0.0);\r\n float vl = max(dot(V, m_uSunLight.direction), 0.0);\r\n diffuseTerm = diffuseTerm + (nv * (1.0 - vl)) * 0.8;\r\n \r\n vec3 color = m_uSunLight.intensity * vec3(0.5, 0.497, 0.49) * (diffuse * diffuseTerm) + diffuse * 0.5;\r\n \r\n float specularTerm = 0.0;\r\n float nh;\r\n \r\n#if SPECULAR\r\n vec3 H = -normalize(m_uSunLight.direction + V);\r\n nh = max(dot(vec3(0.0, 0.0, N.z), H), 0.0); specularTerm = pow(nh, 10.0); \r\n color += m_uSunLight.intensity * vec3(10.0) * specularTerm;\r\n#endif\r\n\r\n transparent = max(specularTerm, transparent);\r\n\r\n#if SHADOW\r\n color *= shadow(P, N, m_uSunLight.direction);\r\n#endif\r\n \r\n#if WEBGL2\r\n out_color = vec4(color, transparent);\r\n#else\r\n gl_FragColor = vec4(color, transparent); \r\n#endif\r\n \r\n}\r\n\r\n","modelo_main.fs":"#include <globalvars.inc>\r\n#include <gamma.inc>\r\n#include <lights.inc>\r\n#include <shadow.inc>\r\n\r\nvoid parseMaterial(out vec3 diffuse, out vec3 specular, out float transparent, out float roughness);\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor); \r\n\r\n#if WEBGL2\r\nlayout(location=0) out vec4 out_color;\r\nlayout(location=1) out vec4 out_color1; \r\n#endif\r\n\r\n#if USE_PLATTE\r\nuniform sampler2D m_uPlatteTexture;\r\n#endif\r\n\r\n#if TONE_MAPPING\r\n\r\n#include <tone_mapping.inc>\r\n\r\n#endif\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n vec3 N = normalize(m_vNormal);\r\n vec3 V = normalize(m_vVertex * m_uPerFrame.cameraPosition.w - m_uPerFrame.cameraPosition.xyz);\r\n vec3 P = m_vVertex;\r\n\r\n#if DOUBLESIDED \r\n N *= -sign(dot(N, V));\r\n#endif\r\n\r\n vec3 diffuse; \r\n float transparent;\r\n vec3 specular;\r\n float roughness;\r\n#if USE_PLATTE\r\n if (m_vColorIndex < 0.495)\r\n {\r\n vec4 platteColor = sampleTexture2D(m_uPlatteTexture, vec2(m_vColorIndex, 0));\r\n diffuse = platteColor.xyz;\r\n transparent = platteColor.w;\r\n }\r\n else\r\n {\r\n parseMaterial(diffuse, specular, transparent, roughness); \r\n }\r\n#else\r\n parseMaterial(diffuse, specular, transparent, roughness);\r\n#endif\r\n\r\n#if !WEBGL2\r\n vec4 out_color1;\r\n#endif\r\n vec3 color = shade(diffuse, specular, roughness, transparent, P, N, V, out_color1); \r\n\r\n#if TONE_MAPPING\r\n color.rgb = toneMapping(color.rgb);\r\n#endif\r\n\r\n#if GAMMA\r\n color = linearTosRGB(color, 2.2);\r\n#endif\r\n\r\n#if WEBGL2\r\n out_color = vec4(color, transparent);\r\n#else\r\n gl_FragColor = vec4(color, transparent); \r\n#endif\r\n \r\n}\r\n","modelo_main.vs":"#if WEBGL2\r\nout vec3 m_vVertex;\r\nout vec3 m_vNormal;\r\nout vec3 m_vTexCoord;\r\nout vec4 m_vColor;\r\nflat out vec4 m_vId;\r\nout float m_vDepth;\r\nout float m_vColorIndex;\r\n#else\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition);\r\n\r\nvoid main()\r\n{\r\n vec4 position = vec4(m_aPosition, 1.0);\r\n#if COMPRESSION\r\nvec4 normal = vec4(m_aNormal0, m_aNormal1, m_aNormal2, 0.0);\r\n#else\r\nvec4 normal = vec4(m_aNormal0, 0.0);\r\n#endif\r\n vec3 uv = vec3(m_aTexCoord, 1.0);\r\n\r\n vec4 worldPosition;\r\n\r\n transform(position, normal, uv, worldPosition);\r\n\r\n#if VISIBILITY\r\n position.z -= step(0.5, m_aMaterial) * position.w * 10000.0;\r\n#endif\r\n\r\n#if USE_PLATTE\r\n m_vColorIndex = m_aMaterial; \r\n#endif\r\n\r\n#include <varying.inc>\r\n\r\n gl_Position = position;\r\n\r\n gl_PointSize = 4.0;\r\n}\r\n\r\n","modelo_ribbon.vs":"#if WEBGL2\r\nout vec3 m_vVertex;\r\nout vec3 m_vNormal;\r\nout vec3 m_vTexCoord;\r\nout vec4 m_vColor;\r\nflat out vec4 m_vId;\r\nout float m_vDepth;\r\nout float m_vColorIndex;\r\n#else\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\nuniform vec4 uTexSizeAndInv;\r\nuniform float m_uWidth;\r\nvec2 project(vec4 device)\r\n{\r\n vec3 devicePos = device.xyz / device.w;\r\n vec2 clipPos = (devicePos * 0.5 + 0.5).xy;\r\n return clipPos * uTexSizeAndInv.xy;\r\n}\r\n\r\nvec4 unproject(vec2 screen, float z, float w) \r\n{\r\n vec2 clipPos = screen * uTexSizeAndInv.zw;\r\n vec2 devicePos = clipPos * 2.0 - 1.0;\r\n return vec4(devicePos * w, z, w);\r\n}\r\n\r\nconst float PI = 3.14159;\r\nvoid main()\r\n{\r\n vec2 sLast = project(m_uPerFrame.vpMatrix * vec4(m_aNormal0.xyz, 1.0));\r\n vec2 sNext = project(m_uPerFrame.vpMatrix * vec4(m_aColor.xyz, 1.0));\r\n vec4 dCurrent = m_uPerFrame.vpMatrix * vec4(m_aPosition.xyz, 1.0);\r\n vec2 sCurrent = project(dCurrent);\r\n\r\n vec2 normal1 = (sLast - sCurrent);\r\n vec2 normal2 = (sCurrent - sNext);\r\n vec2 normal = normalize(normal1 + normal2);\r\n float off = m_aColor.w;\r\n \r\n vec2 dir = vec2(normal.y, -normal.x) * off;\r\n vec2 pos = sCurrent + dir * m_uWidth;\r\n\r\n vec4 worldPosition = vec4(m_aPosition.xyz, 1.0);\r\n\r\n vec3 uv = vec3(m_aTexCoord.x, (off + 1.0) * 0.5, 1.0);\r\n\r\n#include <varying.inc>\r\n\r\n gl_Position = unproject(pos, dCurrent.z, dCurrent.w);\r\n}\r\n\r\n","normaldepth_main.fs":"#include <globalvars.inc>\r\n\r\n#if WEBGL2\r\n out vec4 out_color;\r\n#endif\r\n\r\n#if ALPHATEST\r\n uniform sampler2D m_uDiffuseTexture;\r\n#endif\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n#if ALPHATEST\r\n vec4 texel = sampleTexture2D(m_uDiffuseTexture, m_vTexCoord.xy);\r\n if (texel.a < 0.15)\r\n {\r\n discard;\r\n }\r\n#endif\r\n\r\n vec4 normal = vec4(m_vNormal, 0.0);\r\n\r\n#if !WORLDSPACE_NORMAL\r\n normal = m_uPerFrame.viewMatrix * normal;\r\n#endif\r\n\r\n#if DOUBLESIDED\r\n \r\n#if WORLDSPACE_NORMAL\r\n vec4 eyeNormal = m_uPerFrame.viewMatrix * normal;\r\n#else\r\n vec4 eyeNormal = normal;\r\n#endif\r\n\r\n vec4 eyeDir = m_uPerFrame.viewMatrix * vec4(m_vVertex, 1.0);\r\n normal *= -sign(dot(eyeNormal.xyz, eyeDir.xyz));\r\n\r\n#endif\r\n \r\n vec3 n = normalize(normal.xyz);\r\n\r\n#if ENCODE_NORMAL\r\n n = (n + vec3(1.0)) * 0.5;\r\n#endif\r\n\r\n#if WEBGL2\r\n out_color = vec4(n, m_vDepth); \r\n#else\r\n gl_FragColor = vec4(n, m_vDepth);\r\n#endif\r\n \r\n}\r\n","pbr.fs":"#if WEBGL2\r\nin vec3 m_vVertex;\r\nin vec3 m_vNormal;\r\nin vec3 m_vTexCoord;\r\nin mat3 m_vTBN;\r\nin vec4 m_vColor;\r\nflat in vec4 m_vId;\r\nin float m_vDepth;\r\nin float m_vColorIndex;\r\n#else \r\n\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying mat3 m_vTBN;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\n#include <uniform.inc>\r\n\r\n\r\n\r\n\r\n","pbr_main.fs":"#include <globalvars.inc>\r\n#include <gamma.inc>\r\n#include <lights.inc>\r\n#include <shadow.inc>\r\n\r\nvoid parseMaterial(out vec4 baseColor, out vec3 normal, out vec2 metallicRoughness, out vec3 emissiveColor, out float occlusion);\r\n\r\nvec4 shade(in vec4 baseColor, in vec3 normal, in vec3 V, in vec2 metallicRoughness, in vec3 emissiveColor, in float occlusion); \r\n\r\n#if WEBGL2\r\nlayout(location=0) out vec4 out_color;\r\nlayout(location=1) out vec4 out_color1; \r\n#endif\r\n\r\n#if USE_PLATTE\r\nuniform sampler2D m_uPlatteTexture;\r\n#endif\r\n\r\n#if TONE_MAPPING \r\n\r\n#include <tone_mapping.inc>\r\n\r\n#endif \r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n vec3 N = normalize(m_vNormal);\r\n vec3 V = normalize(m_vVertex - m_uPerFrame.cameraPosition.xyz);\r\n vec3 P = m_vVertex;\r\n\r\n#if DOUBLESIDED \r\n N *= -sign(dot(N, V));\r\n#endif\r\n\r\n vec4 baseColor; \r\n vec3 normal;\r\n vec2 metallicRoughness;\r\n vec3 emissiveColor;\r\n float occlusion;\r\n#if USE_PLATTE\r\n if (m_vColorIndex < 0.495)\r\n {\r\n vec4 platteColor = sampleTexture2D(m_uPlatteTexture, vec2(m_vColorIndex, 0));\r\n baseColor = platteColor;\r\n }\r\n else\r\n {\r\n parseMaterial(baseColor, normal, metallicRoughness, emissiveColor, occlusion);\r\n }\r\n#else\r\n parseMaterial(baseColor, normal, metallicRoughness, emissiveColor, occlusion);\r\n#endif\r\n vec4 color = shade(baseColor, normal, V, metallicRoughness, emissiveColor, occlusion);\r\n\r\n#if TONE_MAPPING\r\n color.rgb = toneMapping(color.rgb);\r\n#endif\r\n#if GAMMA\r\n color.xyz = linearTosRGB(color.xyz, 2.2);\r\n#endif\r\n\r\n#if WEBGL2\r\n out_color = color;\r\n#else\r\n gl_FragColor = color; \r\n#endif\r\n \r\n}\r\n","pbr_main.vs":"#if WEBGL2\r\nout vec3 m_vVertex;\r\nout vec3 m_vNormal;\r\nout vec3 m_vTexCoord;\r\nout mat3 m_vTBN;\r\nout vec4 m_vColor;\r\nflat out vec4 m_vId;\r\nout float m_vDepth;\r\nout float m_vColorIndex;\r\n#else\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying mat3 m_vTBN;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition);\r\n\r\nvoid main()\r\n{\r\n vec4 position = vec4(m_aPosition, 1.0);\r\n#if COMPRESSION\r\n vec4 normal = vec4(m_aNormal0, m_aNormal1, m_aNormal2);\r\n#else\r\n vec4 normal = vec4(m_aNormal0, 0.0);\r\n#endif\r\n vec3 uv = vec3(m_aTexCoord, 1.0);\r\n\r\n vec4 worldPosition;\r\n\r\n transform(position, normal, uv, worldPosition);\r\n\r\n#if VISIBILITY\r\n position.z -= step(0.5, m_aMaterial) * position.w * 10000.0;\r\n#endif\r\n\r\n#if HAS_TANGENT\r\n vec3 tangent = (m_uPerNode.modelMatrix * vec4(m_aTangent, 0.0)).xyz;\r\n vec3 biTangent = normalize(cross(normal.xyz, tangent));\r\n m_vTBN = mat3(normalize(tangent), biTangent, normal.xyz);\r\n#endif\r\n\r\n#if USE_PLATTE\r\n m_vColorIndex = m_aMaterial; \r\n#endif\r\n\r\n#include <varying.inc>\r\n\r\n gl_Position = position;\r\n\r\n gl_PointSize = 4.0;\r\n}\r\n\r\n","shade_adhoc.inc":"\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n#if BASE\r\n vec3 color = diffuse;\r\n#else\r\n float diffuseTerm = dot(vec4(N, 1), m_uSunLight.diffuseMatrix[0] * vec4(N, 1));\r\n \r\n float nv = max(dot(N, -V), 0.0);\r\n float vl = max(dot(V, m_uSunLight.direction), 0.0);\r\n diffuseTerm = diffuseTerm + (nv * (1.0 - vl)) * 0.8;\r\n \r\n vec3 color = m_uSunLight.intensity * vec3(0.5, 0.497, 0.49) * (diffuse * diffuseTerm) + diffuse * 0.5;\r\n \r\n float specularTerm = 0.0;\r\n float nh;\r\n \r\n#if SPECULAR\r\n vec3 H = -normalize(m_uSunLight.direction + V);\r\n nh = max(dot(vec3(0.0, 0.0, N.z), H), 0.0);\r\n specularTerm = pow(nh, 20.0); \r\n color += m_uSunLight.intensity * vec3(0.5) * specularTerm;\r\n#endif\r\n\r\n#if SHADOW\r\n color *= shadow(P, N, m_uSunLight.direction);\r\n#endif\r\n\r\n#endif\r\n return color;\r\n}\r\n\r\n\r\n","shade_color_multi_layer.inc":"uniform sampler2D m_uPlatteTexture;\r\nuniform sampler2D m_uDensityTexture;\r\nuniform vec2 m_uInvResolution;\r\nuniform float m_uAlphaCorrection;\r\nuniform mat4 m_uInvTransform;\r\nuniform float m_uLayers;\r\nuniform vec2 m_uGridSize;\r\nuniform float m_uSampleNumber;\r\nuniform float m_uInstanceFilter;\r\nconst float STEP = 1.73205081 / 256.0;\r\n\r\nvec4 getColor(float intensity) {\r\n vec2 _uv = vec2(intensity, 0);\r\n vec4 color = sampleTexture2D(m_uPlatteTexture, _uv);\r\n float alpha = 1.0;\r\n return vec4(color.r, color.g, color.b, alpha); \r\n}\r\n\r\nfloat sampleAs3DTexture( vec3 texCoord ) {\r\n texCoord += vec3(0.5); float z = clamp(texCoord.z, 0.0, 0.99);\r\n float sliceNumber = floor(z * m_uLayers);\r\n\r\n float top = min(m_uSampleNumber + sliceNumber + 1.0, m_uLayers - 1.0);\r\n float bottom = max(sliceNumber - m_uSampleNumber, 0.0);\r\n float totalSamples = 0.0;\r\n\r\n texCoord.y = 1.0 - texCoord.y;\r\n texCoord.xy /= m_uGridSize;\r\n float intensity = 0.0;\r\n float heightLength = 0.0;\r\n int i;\r\n for (i = int(bottom); i <= int(top); i++)\r\n {\r\n vec2 texCoordSlice = texCoord.xy;\r\n texCoordSlice.x += mod(float(i), m_uGridSize.x) / m_uGridSize.x;\r\n texCoordSlice.y += floor(float(i) / m_uGridSize.x) / m_uGridSize.y;\r\n float tempIntensity = sampleTexture2D(m_uDensityTexture, texCoordSlice).x;\r\n intensity += tempIntensity;\r\n heightLength += 1.0;\r\n }\r\n intensity /= max(heightLength,1.0);\r\n\treturn intensity;\r\n}\r\n\r\n vec2 boxIntersection(vec3 orig, vec3 dir) \r\n{\r\n\tconst vec3 box_min = vec3( - 0.5 );\r\n\tconst vec3 box_max = vec3( 0.5 );\r\n\tvec3 inv_dir = 1.0 / dir;\r\n\tvec3 tmin_tmp = ( box_min - orig ) * inv_dir;\r\n vec3 tmax_tmp = ( box_max - orig ) * inv_dir;\r\n\tvec3 tmin = min( tmin_tmp, tmax_tmp );\r\n\tvec3 tmax = max( tmin_tmp, tmax_tmp );\r\n\tfloat t0 = max( tmin.x, max( tmin.y, tmin.z ) );\r\n\tfloat t1 = min( tmax.x, min( tmax.y, tmax.z ) );\r\n\treturn vec2( t0, t1 );\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n vec2 texc = vec2(gl_FragCoord.x * m_uInvResolution.x,\r\n gl_FragCoord.y * m_uInvResolution.y);\r\n\r\n vec3 frontPos = (m_uInvTransform * vec4(P.x, P.y, P.z, 1.0)).xyz;\r\n vec3 cameraPos = (m_uInvTransform * vec4(m_uPerFrame.cameraPosition.xyz, 1.0)).xyz;\r\n vec3 rayDir = normalize((m_uInvTransform * vec4(V.xyz, 0.0)).xyz);\r\n vec3 backPos = frontPos;\r\n vec2 bounds = boxIntersection(cameraPos, rayDir);\r\n if ( bounds.x > bounds.y ) discard;\r\n bounds.x = max( bounds.x, 0.0 );\r\n vec3 p = cameraPos + bounds.x * rayDir;\r\n vec3 inc = 1.0 / abs( rayDir );\r\n float delta = min( inc.x, min( inc.y, inc.z ) );\r\n\tdelta /= 100.0;\r\n\r\n vec4 accumulatedColor = vec4(0.0);\r\n vec4 tempColor = vec4(0.0);\r\n float d = 0.0;\r\n float widthLength = 0.0;\r\n for ( float t = bounds.x; t < bounds.y; t += delta ) {\r\n\t\td += sampleAs3DTexture( p );\r\n p += rayDir * delta;\r\n widthLength += 1.0;\r\n }\r\n d /= widthLength;\r\n if ( d > m_uInstanceFilter ) {\r\n accumulatedColor = getColor(d);\r\n\t\t accumulatedColor.a = 1.0;\r\n transparent = 1.0;\r\n }else{\r\n\t\t accumulatedColor.a = 0.0;\r\n transparent = 0.0;\r\n }\r\n return accumulatedColor.xyz;\r\n}\r\n","shade_glass.inc":"\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n#if BASE\r\n vec3 color = diffuse;\r\n#else\r\n vec3 color = diffuse * m_uSunLight.intensity;\r\n \r\n#if SPECULAR\r\n vec3 H = -normalize(m_uSunLight.direction + V);\r\n float nh = max(dot(N, H), 0.0);\r\n color += vec3(pow(nh, roughness));\r\n#endif\r\n#endif\r\n return color;\r\n}\r\n","shade_glyph.inc":"uniform sampler2D m_uFontBitmap;\r\nuniform vec2 m_uTextureSize;\r\nuniform vec3 m_uColor;\r\n\r\nfloat bilinear(vec2 frac2, vec4 v)\r\n{\r\n vec2 cc = mix(v.xz, v.yw, frac2.x);\r\n return mix(cc.x, cc.y, frac2.y);\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n \r\n vec2 coord = m_vTexCoord.xy * m_uTextureSize;\r\n vec2 p = floor(coord - vec2(0.5)) + vec2(0.5);\r\n vec2 f = coord - p;\r\n vec2 p0 = p / m_uTextureSize;\r\n vec2 pixel = 1.0 / m_uTextureSize;\r\n\r\n vec4 c;\r\n c.x = sampleTexture2D(m_uFontBitmap, p0).x;\r\n c.y = sampleTexture2D(m_uFontBitmap, p0 + vec2(pixel.x, 0)).x;\r\n c.z = sampleTexture2D(m_uFontBitmap, p0 + vec2(0, pixel.y)).x;\r\n c.w = sampleTexture2D(m_uFontBitmap, p0 + vec2(pixel.x, pixel.y)).x;\r\n\r\n float value = bilinear(f, c);\r\n\r\n transparent = step(0.45, value);\r\n if (transparent < 0.5) {\r\n discard;\r\n }\r\n return m_uColor;\r\n}\r\n","shade_oit.inc":"\r\nfloat weight(float z, float a) {\r\n return pow(a, 1.0) * clamp(0.03 / (1e-5 + pow(abs(z) / 200.0, 4.0)), 1e-2, 3e3);\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n#if BASE\r\n vec3 color = diffuse;\r\n#else\r\n float diffuseTerm = dot(vec4(N, 1), m_uSunLight.diffuseMatrix[0] * vec4(N, 1));\r\n \r\n float nv = max(dot(N, -V), 0.0);\r\n float vl = max(dot(V, m_uSunLight.direction), 0.0);\r\n diffuseTerm = diffuseTerm + (nv * (1.0 - vl)) * 0.8;\r\n \r\n vec3 color = m_uSunLight.intensity * vec3(0.5, 0.497, 0.49) * (diffuse * diffuseTerm) + diffuse * 0.5;\r\n \r\n float specularTerm = 0.0;\r\n float nh;\r\n\r\n#if SPECULAR\r\n vec3 H = -normalize(m_uSunLight.direction + V);\r\n nh = max(dot(N, H), 0.0);\r\n specularTerm = pow(nh, 100.0); \r\n color += m_uSunLight.intensity * vec3(0.5, 0.497, 0.49) * specularTerm;\r\n#endif\r\n\r\n float w = weight(m_vDepth, transparent);\r\n color = diffuse * w * transparent;\r\n secondColor = vec4(vec3(transparent * w), 1.0);\r\n\r\n#endif\r\n return color;\r\n}\r\n","shade_pbr.inc":"uniform sampler2D m_uBrdfLut;\r\nuniform samplerCube m_uDiffuseEnvMap;\r\nuniform samplerCube m_uSpecularEnvMap;\r\nuniform float m_uTotalLod;\r\nconst float M_PI = 3.1416926;\r\nvec3 specularReflection(vec3 reflectance0, vec3 reflectance90, float VdotH)\r\n{\r\n return reflectance0 + (reflectance90 - reflectance0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\r\n}\r\n\r\n\r\nfloat geometricOcclusion(float NdotL, float NdotV, float alphaRoughness)\r\n{\r\n float r = alphaRoughness;\r\n\r\n float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\r\n float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\r\n return attenuationL * attenuationV;\r\n}\r\n\r\nfloat microfacetDistribution(float alphaRoughness, float NdotH)\r\n{\r\n float roughnessSq = alphaRoughness * alphaRoughness;\r\n float f = (NdotH * roughnessSq - NdotH) * NdotH + 1.0;\r\n return roughnessSq / (M_PI * f * f);\r\n}\r\n\r\nvec3 diffuse(vec3 diffuseColor)\r\n{\r\n return diffuseColor / M_PI;\r\n}\r\n\r\nvec3 getIBLContribution(float perceptualRoughness, vec3 n, float NdotV, vec3 diffuseColor, vec3 specularColor, vec3 reflection)\r\n{\r\n \r\n vec3 brdf = sampleTexture2D(m_uBrdfLut, vec2(NdotV, 1.0 - perceptualRoughness)).rgb;\r\n brdf = pow(brdf,vec3(2.2));\r\n \r\n#if DIFFUSE_EVN_MAP\r\n vec3 diffuseLight = sampleTexture3D(m_uDiffuseEnvMap, vec3(n.x, n.z, -n.y)).rgb;\r\n#else\r\n vec3 diffuseLight = vec3(1.0);\r\n\r\n#if SPECULAR_ENV_MAP\r\n float lod = (perceptualRoughness * m_uTotalLod);\r\n vec3 specularLight = sampleTexture3D(m_uSpecularEnvMap, vec3(-reflection.x, -reflection.z, reflection.y), lod).rgb;\r\n#else\r\n vec3 specularLight = vec3(1.0);\r\n#endif\r\n\r\n vec3 diffuse = diffuseLight * diffuseColor;\r\n vec3 specular = specularLight * (specularColor * brdf.x + brdf.y);\r\n\r\n return diffuse + specular;\r\n}\r\n\r\nvec4 shade(in vec4 baseColor, in vec3 normal, in vec3 V, in vec2 metallicRoughness, in vec3 emissiveColor, in float occlusion)\r\n{\r\n#if BASE\r\n vec3 color = baseColor;\r\n#else\r\n float roughness = clamp(metallicRoughness.y, 0.04, 1.0);\r\n float metallic = clamp(metallicRoughness.x, 0.0, 1.0);\r\n\r\n#if HAS_NORMALMAP\r\n\r\n#if HAS_TANGENT\r\n vec3 worldNormal = normalize(m_vTBN * normal);\r\n#else\r\n vec3 pos_dx = dFdx(m_vVertex);\r\n vec3 pos_dy = dFdy(m_vVertex);\r\n vec3 tex_dx = dFdx(m_vTexCoord);\r\n vec3 tex_dy = dFdy(m_vTexCoord);\r\n vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\r\n t = normalize(t - m_vNormal * dot(m_vNormal, t));\r\n vec3 b = normalize(cross(m_vNormal, t));\r\n mat3 tbn = mat3(t, b, m_vNormal);\r\n vec3 worldNormal = normalize(tbn * normal);\r\n#endif\r\n\r\n#else\r\n vec3 worldNormal = normalize(m_vNormal);\r\n#endif\r\n\r\n vec3 l = normalize(m_uSunLight.direction); vec3 h = normalize(l + V); vec3 reflection = -normalize(reflect(V, worldNormal));\r\n\r\n float NdotL = clamp(dot(worldNormal, l), 0.001, 1.0);\r\n float NdotV = abs(dot(worldNormal, V)) + 0.001;\r\n float NdotH = clamp(dot(worldNormal, h), 0.0, 1.0);\r\n float LdotH = clamp(dot(l, h), 0.0, 1.0);\r\n float VdotH = clamp(dot(V, h), 0.0, 1.0);\r\n\r\n vec3 f0 = vec3(0.04);\r\n vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\r\n diffuseColor *= 1.0 - metallic;\r\n vec3 specularColor = mix(f0, baseColor.rgb, metallic);\r\n float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\r\n\r\n float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\r\n vec3 specularEnvironmentR0 = specularColor.rgb;\r\n vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\r\n\r\n float alphaRoughness = roughness * roughness;\r\n vec3 F = specularReflection(specularEnvironmentR0, specularEnvironmentR90, VdotH);\r\n float G = geometricOcclusion(NdotL, NdotV, alphaRoughness);\r\n float D = microfacetDistribution(alphaRoughness, NdotH);\r\n vec3 diffuseContrib = (1.0 - F) * diffuse(diffuseColor);\r\n vec3 specContrib = max(vec3(0.0), F * G * D / (4.0 * NdotL * NdotV));\r\n vec3 color = NdotL * (diffuseContrib + specContrib);\r\n\r\n diffuseColor *= m_uSunLight.intensity;\r\n specularColor *= m_uSunLight.intensity;\r\n color += m_uMaterial.values[9] * getIBLContribution(roughness, worldNormal, NdotV, diffuseColor, specularColor, reflection);\r\n\r\n#if SHADOW\r\n color *= shadow(m_vVertex, normal, m_uSunLight.direction);\r\n#endif\r\n\r\n#if HAS_EMISSIVEMAP\r\n color += emissiveColor;\r\n#endif\r\n\r\n#if HAS_OCCLUSIONMAP\r\n color *= occlusion;\r\n#endif\r\n#endif\r\n return vec4(color, baseColor.a);\r\n}\r\n","shade_pbs.inc":"","shade_plain.inc":"vec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n return diffuse;\r\n}\r\n","shade_volume.inc":"uniform sampler2D m_uGradientTexture;\r\nuniform sampler2D m_uPlatteTexture;\r\nuniform sampler2D m_uDensityTexture;\r\nuniform vec2 m_uInvResolution;\r\nuniform float m_uAlphaCorrection;\r\nuniform mat4 m_uInvTransform;\r\n\r\nconst float STEP = 1.73205081 / 256.0;\r\n\r\nvec4 getColor(float density) \r\n{\r\n density = min(0.26, density) / 0.26;\r\n vec4 color = sampleTexture2D(m_uPlatteTexture, vec2(density, 0.0));\r\n\r\n float alpha = max(density, 0.02);\r\n \r\n return vec4(color.rgb, alpha); \r\n}\r\n\r\nvec4 sampleDensity(vec3 position) \r\n{\r\n \r\n \r\n \r\n \r\n \r\n vec3 xyz = position + vec3(0.5);\r\n \r\n float density = sampleTexture2D(m_uDensityTexture, xyz.xy).x;\r\n \r\n vec4 res = getColor(density);\r\n\r\n \r\n res.w *= 2.0 * (xyz.z * xyz.z * xyz.z) - 3.0 * (xyz.z * xyz.z) + 1.0; \r\n return res;\r\n}\r\n\r\n vec2 boxIntersection(vec3 ro, vec3 rd) \r\n{\r\n vec3 m = 1.0 / rd; vec3 n = m * ro; vec3 k = abs(m) * 0.5;\r\n \r\n vec3 t1 = -n - k;\r\n vec3 t2 = -n + k;\r\n\r\n float tN = max(max(t1.x, t1.y), t1.z);\r\n float tF = min(min(t2.x, t2.y), t2.z);\r\n \r\n if( tN > tF || tF < 0.0) return vec2(-1.0); \r\n return vec2(tN, tF);\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n vec3 frontPos = (m_uInvTransform * vec4(P.x, P.y, P.z, 1.0)).xyz;\r\n vec3 cameraPos = (m_uInvTransform * vec4(m_uPerFrame.cameraPosition.xyz, 1.0)).xyz;\r\n vec3 rayDir = normalize((m_uInvTransform * vec4(V.xyz, 0.0)).xyz);\r\n vec3 backPos = frontPos;\r\n vec2 t = boxIntersection(cameraPos, rayDir);\r\n if (t.x > -1.0 && t.y > -1.0)\r\n {\r\n backPos = cameraPos + rayDir * t.y;\r\n }\r\n \r\n float rayLength = length(backPos - frontPos);\r\n\r\n int steps = int(max(1.0, floor(rayLength / STEP)));\r\n \r\n float delta = rayLength / float(steps);\r\n \r\n vec3 deltaDirection = rayDir * delta;\r\n \r\n vec3 currentPosition = frontPos;\r\n \r\n vec4 accumulatedColor = vec4(0.0);\r\n \r\n float accumulatedAlpha = 0.0;\r\n \r\n vec4 colorSample;\r\n float alphaSample;\r\n \r\n#if WEBGL2\r\n for (int i = 0; i < steps; i++)\r\n {\r\n#else\r\n for (int i = 0; i < 256; i++) \r\n {\r\n if (i >= steps) \r\n {\r\n break;\r\n }\r\n#endif\r\n colorSample = sampleDensity(currentPosition);\r\n \r\n alphaSample = colorSample.a * m_uAlphaCorrection;\r\n \r\n alphaSample *= (1.0 - accumulatedAlpha);\r\n \r\n accumulatedColor += colorSample * alphaSample;\r\n \r\n accumulatedAlpha += alphaSample;\r\n \r\n currentPosition += deltaDirection;\r\n }\r\n \r\n transparent = accumulatedAlpha;\r\n \r\n return accumulatedColor.xyz;\r\n}\r\n","shade_volume_multi_layer.inc":"uniform sampler2D m_uDensityTexture;\r\nuniform sampler2D m_uPlatteTexture;\r\nuniform vec2 m_uInvResolution;\r\nuniform float m_uAlphaCorrection;\r\nuniform mat4 m_uInvTransform;\r\nuniform float m_uLayers;\r\nuniform vec2 m_uGridSize;\r\nuniform float m_uSampleNumber;\r\nconst float STEP = 1.73205081 / 256.0;\r\n\r\nvec4 getColor(float intensity) {\r\n intensity = min(0.26, intensity) / 0.26;\r\n vec2 _uv = vec2(intensity, 0);\r\n vec4 color = sampleTexture2D(m_uPlatteTexture, _uv);\r\n float alpha = intensity;\r\n if (alpha < 0.03)\r\n {\r\n alpha = 0.02;\r\n }\r\n\r\n return vec4(color.r, color.g, color.b, alpha); \r\n}\r\n\r\nvec4 sampleAs3DTexture(vec3 texCoord) {\r\n texCoord += vec3(0.5);\r\n vec4 heightSlice1;\r\n vec4 heightSlice2;\r\n vec4 colorSlice1;\r\n vec4 colorSlice2;\r\n vec2 texCoordSlice1;\r\n vec2 texCoordSlice2;\r\n\r\n float z = clamp(texCoord.z, 0.0, 0.99);\r\n\r\n float sliceNumber = floor(z * m_uLayers);\r\n\r\n float top = min(m_uSampleNumber + sliceNumber + 1.0, m_uLayers - 1.0);\r\n float bottom = max(sliceNumber - m_uSampleNumber, 0.0);\r\n\r\n float totalSamples = 0.0;\r\n\r\n texCoord.y = 1.0 - texCoord.y;\r\n texCoord.xy /= m_uGridSize;\r\n\r\n float intensity = 0.0;\r\n float sampleWeight;\r\n int i;\r\n#if WEBGL2\r\n for (i = int(bottom); i <= int(top); i++)\r\n {\r\n#else\r\n for (int j = 0; j < 256; j++)\r\n {\r\n i = int(bottom) + j;\r\n if (i > int(top))\r\n {\r\n break;\r\n }\r\n#endif\r\n vec2 texCoordSlice = texCoord.xy;\r\n texCoordSlice.x += (mod(float(i), m_uGridSize.x) / m_uGridSize.x);\r\n texCoordSlice.y += floor(float(i) / m_uGridSize.x) / m_uGridSize.y;\r\n\r\n float tempIntensity = sampleTexture2D(m_uDensityTexture, texCoordSlice).x;\r\n sampleWeight = (m_uSampleNumber + 1.0) - abs(z * m_uLayers - (float(i)));\r\n intensity += sampleWeight * tempIntensity;\r\n totalSamples += sampleWeight;\r\n }\r\n\r\n if (totalSamples != 0.0)\r\n {\r\n intensity /= totalSamples; \r\n } \r\n\r\n return getColor(intensity);\r\n}\r\n\r\n\r\n vec2 boxIntersection(vec3 ro, vec3 rd) \r\n{\r\n vec3 m = 1.0 / rd; vec3 n = m * ro; vec3 k = abs(m) * 0.5;\r\n \r\n vec3 t1 = -n - k;\r\n vec3 t2 = -n + k;\r\n\r\n float tN = max(max(t1.x, t1.y), t1.z);\r\n float tF = min(min(t2.x, t2.y), t2.z);\r\n \r\n if( tN > tF || tF < 0.0) return vec2(-1.0); \r\n return vec2(tN, tF);\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n vec2 texc = vec2(gl_FragCoord.x * m_uInvResolution.x,\r\n gl_FragCoord.y * m_uInvResolution.y);\r\n\r\n vec3 frontPos = (m_uInvTransform * vec4(P.x, P.y, P.z, 1.0)).xyz;\r\n vec3 cameraPos = (m_uInvTransform * vec4(m_uPerFrame.cameraPosition.xyz, 1.0)).xyz;\r\n vec3 rayDir = normalize((m_uInvTransform * vec4(V.xyz, 0.0)).xyz);\r\n vec3 backPos = frontPos;\r\n vec2 t = boxIntersection(cameraPos, rayDir);\r\n \r\n if (t.x > -1.0 && t.y > -1.0)\r\n {\r\n backPos = cameraPos + rayDir * t.y;\r\n }\r\n\r\n float rayLength = length(backPos - frontPos);\r\n\r\n int steps = int(max(1.0, floor(rayLength / STEP)));\r\n\r\n float delta = rayLength / float(steps);\r\n\r\n vec3 deltaDirection = rayDir * delta;\r\n\r\n vec3 currentPosition = frontPos;\r\n\r\n vec4 accumulatedColor = vec4(0.0);\r\n\r\n float accumulatedAlpha = 0.0;\r\n\r\n vec4 colorSample;\r\n float alphaSample;\r\n\r\n \r\n#if WEBGL2\r\n for (int i = 0; i < steps; i++)\r\n {\r\n#else\r\n for (int i = 0; i < 256; i++) \r\n {\r\n if (i >= steps)\r\n {\r\n break;\r\n }\r\n#endif\r\n colorSample = sampleAs3DTexture(currentPosition);\r\n\r\n alphaSample = colorSample.a * m_uAlphaCorrection;\r\n\r\n alphaSample *= (1.0 - accumulatedAlpha);\r\n\r\n accumulatedColor += colorSample * alphaSample;\r\n\r\n accumulatedAlpha += alphaSample;\r\n\r\n currentPosition += deltaDirection;\r\n }\r\n\r\n transparent = accumulatedAlpha;\r\n\r\n return accumulatedColor.xyz;\r\n}\r\n","shadow.inc":"#if SHADOW\r\nuniform sampler2D m_uShadowTexture0;\r\nuniform sampler2D m_uShadowTexture1;\r\n#if MOBILE\r\n\r\nfloat shadow(vec3 P, vec3 N, vec3 L)\r\n{\r\n mat4 matrix = m_uSunLight.shadowMatrix0;\r\n \r\n float backside = min(1.0, max(0.0, dot(N, -L) * 10.0));\r\n vec4 v = matrix * vec4(P, 1);\r\n vec3 t = (v.xyz / v.w + vec3(1.0)) * 0.5;\r\n\r\n vec2 coord = t.xy;\r\n float fz = sampleTexture2D(m_uShadowTexture0, coord).x;\r\n float fd = exp(85.0 * (fz - t.z));\r\n float lit = min(fd, 1.0) * backside; return lit * 0.2 + 0.8; }\r\n\r\n#else\r\n\r\nuniform float m_uShadowFine;\r\nuniform float m_uShadowSize;\r\nuniform float m_uShadowSplit;\r\n\r\nfloat bilinear(vec2 frac2, vec4 v)\r\n{\r\n vec2 cc = mix(v.xz, v.yw, frac2.x);\r\n return mix(cc.x, cc.y, frac2.y);\r\n}\r\n\r\nfloat pcf2x(float depth, vec2 coord, in float shadowMapSize, in sampler2D shadowTexture, in float isFineShadow)\r\n{\r\n coord = coord * shadowMapSize;\r\n vec2 p = floor(coord - vec2(0.5)) + vec2(0.5);\r\n vec2 f = coord - p;\r\n vec2 p0 = p / shadowMapSize;\r\n float pixel = 1.0 / shadowMapSize;\r\n \r\n vec4 c;\r\n c.x = sampleTexture2D(shadowTexture, p0).x;\r\n c.y = sampleTexture2D(shadowTexture, p0 + vec2(pixel, 0)).x;\r\n c.z = sampleTexture2D(shadowTexture, p0 + vec2(0, pixel)).x;\r\n c.w = sampleTexture2D(shadowTexture, p0 + vec2(pixel, pixel)).x;\r\n \r\n if (isFineShadow > 0.5) {\r\n c = exp(300.0 * c + vec4(-300.0 * depth));\r\n return bilinear(f, c);\r\n } \r\n \r\n float z = bilinear(f, c);\r\n return z * exp(-85.0 * depth);\r\n}\r\n\r\nfloat shadow1(vec3 P, vec3 N, vec3 L, sampler2D shadowTexture, mat4 shadowMatrix)\r\n{\r\n vec4 v = shadowMatrix * vec4(P, 1);\r\n vec3 t = (v.xyz / v.w + vec3(1.0)) * 0.5;\r\n float fd = pcf2x(t.z, t.xy, m_uShadowSize, shadowTexture, m_uShadowFine);\r\n \r\n float backside = min(1.0, max(0.0, dot(N, -L) * 10.0));\r\n float lit = min(fd, 1.0) * backside; return lit * 0.2 + 0.8; }\r\n\r\n\r\nfloat shadow(vec3 P, vec3 N, vec3 L)\r\n{\r\n if (gl_FragCoord.z < m_uShadowSplit) {\r\n return shadow1(P, N, L, m_uShadowTexture0, m_uSunLight.shadowMatrix0);\r\n } else {\r\n return shadow1(P, N, L, m_uShadowTexture1, m_uSunLight.shadowMatrix1);\r\n }\r\n}\r\n\r\n#endif\r\n\r\n#endif\r\n","tone_mapping.inc":"uniform float uExposure;\r\n\r\nfloat getLuminance(vec3 c)\r\n{\r\n return dot(c, vec3(0.22, 0.707, 0.071));\r\n}\r\n\r\nvec3 toneMapping(vec3 color) \r\n{\r\n float lum = getLuminance(color);\r\n float lumTm = lum * uExposure;\r\n float scale = lumTm / (1.0 + lumTm);\r\n\r\n return color * scale / lum;\r\n}\r\n","transform_barchart.inc":"uniform sampler2D m_uData;\r\nuniform ivec2 m_uRes;\r\nuniform float m_uThickness;\r\nuniform sampler2D m_uPlatte;\r\n \r\nconst vec2 offsets[4] = vec2[](vec2(-1, -1), vec2(1, -1), vec2(-1, 1), vec2(1, 1));\r\nconst int columns[6] = int[](0, 0, 1, 1, 2, 2);\r\nconst float signs[6] = float[](-1.0, 1.0, -1.0, 1.0, -1.0, 1.0);\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n float height = textureLod(m_uData, (position.xy + 1.0) * 0.5, 0.0).r;\r\n \r\n float xSize = m_uThickness / float(m_uRes.x); float ySize = m_uThickness / float(m_uRes.y);\r\n int vertexId = gl_VertexID % 24;\r\n\r\n int faceIndex = vertexId / 4;\r\n int vertIndex = vertexId % 4;\r\n\r\n int c0 = columns[faceIndex];\r\n int c1 = (c0 + 1) % 3;\r\n int c2 = (c0 + 2) % 3;\r\n\r\n float stretch[3];\r\n stretch[c0] = signs[faceIndex];\r\n stretch[c1] = offsets[vertIndex][0];\r\n stretch[c2] = offsets[vertIndex][1];\r\n\r\n position.x += stretch[0] * xSize;\r\n position.y += stretch[1] * ySize;\r\n position.z += (stretch[2] + 1.0) * 0.5 * height;\r\n\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n normal = m_uPerNode.modelMatrix * normal;\r\n#endif\r\n\r\n m_vColor = textureLod(m_uPlatte, vec2(height, 0.0), 0.0);\r\n\r\n worldPosition = position;\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_barchart_wireframe.inc":"uniform sampler2D m_uData;\r\nuniform ivec2 m_uRes;\r\nuniform float m_uThickness;\r\n \r\nconst vec2 offsets[4] = vec2[](vec2(1, -1), vec2(1, 1), vec2(-1, 1), vec2(-1, -1));\r\nconst float signs[2] = float[](0.0, 1.0);\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n float height = textureLod(m_uData, (position.xy + 1.0) * 0.5, 0.0).r;\r\n \r\n float xSize = m_uThickness / float(m_uRes.x); float ySize = m_uThickness / float(m_uRes.y);\r\n int vertexId = gl_VertexID % 8;\r\n\r\n int heightIndex = vertexId / 4;\r\n int vertIndex = vertexId % 4;\r\n\r\n float stretch[3];\r\n stretch[0] = offsets[vertIndex][0];\r\n stretch[1] = offsets[vertIndex][1];\r\n stretch[2] = signs[heightIndex];\r\n\r\n position.x += 1.005 * stretch[0] * xSize; position.y += 1.005 * stretch[1] * ySize;\r\n position.z += 1.005 * stretch[2] * height;\r\n\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n normal = m_uPerNode.modelMatrix * normal;\r\n#endif\r\n\r\n worldPosition = position;\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_heightmap.inc":"uniform sampler2D m_uData;\r\nuniform sampler2D m_uPlatte;\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if WEBGL2\r\n float height = texture(m_uData, uv.xy).x;\r\n#else\r\n float height = texture2DLod(m_uData, uv.xy, 0.0).a;\r\n#endif\r\n position.z = height;\r\n\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n normal = m_uPerNode.modelMatrix * normal;\r\n#endif\r\n\r\n#if WEBGL2\r\n m_vColor = textureLod(m_uPlatte, vec2(height, 0.0), 0.0);\r\n#else\r\n m_vColor = texture2DLod(m_uPlatte, vec2(height, 0.0), 0.0);\r\n#endif\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_mark.inc":"\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n#endif\r\n \r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_nonormal.inc":"\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if MODEL_TRANSFORM\r\n#if INSTANCING\r\n position = m_aModelMatrix * position;\r\n#else\r\n position = m_uPerNode.modelMatrix * position;\r\n#endif\r\n#endif\r\n\r\n worldPosition = position;\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_simple.inc":"#if HAS_SKIN\r\n#if WEBGL2\r\nuniform m_bJointMatrix\r\n{\r\n mat4 matrix[128];\r\n} m_uJointMatrix;\r\n#else\r\nuniform sampler2D m_uTransformTexture;\r\n\r\nmat4 transpose(in mat4 inMatrix) {\r\n highp vec4 i0 = inMatrix[0];\r\n highp vec4 i1 = inMatrix[1];\r\n highp vec4 i2 = inMatrix[2];\r\n highp vec4 i3 = inMatrix[3];\r\n\r\n highp mat4 outMatrix = mat4(\r\n vec4(i0.x, i1.x, i2.x, i3.x),\r\n vec4(i0.y, i1.y, i2.y, i3.y),\r\n vec4(i0.z, i1.z, i2.z, i3.z),\r\n vec4(i0.w, i1.w, i2.w, i3.w)\r\n );\r\n\r\n return outMatrix;\r\n}\r\n\r\nmat4 inverse(mat4 m) {\r\n float\r\n a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\r\n a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\r\n a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\r\n a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\r\n\r\n b00 = a00 * a11 - a01 * a10,\r\n b01 = a00 * a12 - a02 * a10,\r\n b02 = a00 * a13 - a03 * a10,\r\n b03 = a01 * a12 - a02 * a11,\r\n b04 = a01 * a13 - a03 * a11,\r\n b05 = a02 * a13 - a03 * a12,\r\n b06 = a20 * a31 - a21 * a30,\r\n b07 = a20 * a32 - a22 * a30,\r\n b08 = a20 * a33 - a23 * a30,\r\n b09 = a21 * a32 - a22 * a31,\r\n b10 = a21 * a33 - a23 * a31,\r\n b11 = a22 * a33 - a23 * a32,\r\n\r\n det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n return mat4(\r\n a11 * b11 - a12 * b10 + a13 * b09,\r\n a02 * b10 - a01 * b11 - a03 * b09,\r\n a31 * b05 - a32 * b04 + a33 * b03,\r\n a22 * b04 - a21 * b05 - a23 * b03,\r\n a12 * b08 - a10 * b11 - a13 * b07,\r\n a00 * b11 - a02 * b08 + a03 * b07,\r\n a32 * b02 - a30 * b05 - a33 * b01,\r\n a20 * b05 - a22 * b02 + a23 * b01,\r\n a10 * b10 - a11 * b08 + a13 * b06,\r\n a01 * b08 - a00 * b10 - a03 * b06,\r\n a30 * b04 - a31 * b02 + a33 * b00,\r\n a21 * b02 - a20 * b04 - a23 * b00,\r\n a11 * b07 - a10 * b09 - a12 * b06,\r\n a00 * b09 - a01 * b07 + a02 * b06,\r\n a31 * b01 - a30 * b03 - a32 * b00,\r\n a20 * b03 - a21 * b01 + a22 * b00) / det;\r\n}\r\n#endif\r\n#endif\r\n\r\n#if HAS_SKIN\r\nmat4 getJointMatrix(in vec4 indices) {\r\n#if WEBGL2\r\n return m_aWeight0.x * m_uJointMatrix.matrix[int(indices.x)] +\r\n m_aWeight0.y * m_uJointMatrix.matrix[int(indices.y)] +\r\n m_aWeight0.z * m_uJointMatrix.matrix[int(indices.z)] +\r\n m_aWeight0.w * m_uJointMatrix.matrix[int(indices.w)];\r\n#else\r\n vec4 col1, col2, col3, col4;\r\n col1 = texture2DLod(m_uTransformTexture, vec2((indices.x * 4.0 ) / 511.0, 0.0), 0.0);\r\n col2 = texture2DLod(m_uTransformTexture, vec2((indices.x * 4.0 + 1.0) / 511.0, 0.0), 0.0);\r\n col3 = texture2DLod(m_uTransformTexture, vec2((indices.x * 4.0 + 2.0) / 511.0, 0.0), 0.0);\r\n col4 = texture2DLod(m_uTransformTexture, vec2((indices.x * 4.0 + 3.0) / 511.0, 0.0), 0.0);\r\n mat4 matrix1 = mat4(col1, col2, col3, col4); \r\n col1 = texture2DLod(m_uTransformTexture, vec2((indices.y * 4.0 ) / 511.0, 0.0), 0.0);\r\n col2 = texture2DLod(m_uTransformTexture, vec2((indices.y * 4.0 + 1.0) / 511.0, 0.0), 0.0);\r\n col3 = texture2DLod(m_uTransformTexture, vec2((indices.y * 4.0 + 2.0) / 511.0, 0.0), 0.0);\r\n col4 = texture2DLod(m_uTransformTexture, vec2((indices.y * 4.0 + 3.0) / 511.0, 0.0), 0.0);\r\n mat4 matrix2 = mat4(col1, col2, col3, col4);\r\n col1 = texture2DLod(m_uTransformTexture, vec2((indices.z * 4.0 ) / 511.0, 0.0), 0.0);\r\n col2 = texture2DLod(m_uTransformTexture, vec2((indices.z * 4.0 + 1.0) / 511.0, 0.0), 0.0);\r\n col3 = texture2DLod(m_uTransformTexture, vec2((indices.z * 4.0 + 2.0) / 511.0, 0.0), 0.0);\r\n col4 = texture2DLod(m_uTransformTexture, vec2((indices.z * 4.0 + 3.0) / 511.0, 0.0), 0.0);\r\n mat4 matrix3 = mat4(col1, col2, col3, col4);\r\n col1 = texture2DLod(m_uTransformTexture, vec2((indices.w * 4.0 ) / 511.0, 0.0), 0.0);\r\n col2 = texture2DLod(m_uTransformTexture, vec2((indices.w * 4.0 + 1.0) / 511.0, 0.0), 0.0);\r\n col3 = texture2DLod(m_uTransformTexture, vec2((indices.w * 4.0 + 2.0) / 511.0, 0.0), 0.0);\r\n col4 = texture2DLod(m_uTransformTexture, vec2((indices.w * 4.0 + 3.0) / 511.0, 0.0), 0.0);\r\n mat4 matrix4 = mat4(col1, col2, col3, col4);\r\n return m_aWeight0.x * matrix1 + \r\n m_aWeight0.y * matrix2 + \r\n m_aWeight0.z * matrix3 + \r\n m_aWeight0.w * matrix4;\r\n#endif\r\n}\r\n#endif\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if HAS_SKIN\r\n mat4 jointMatrix = getJointMatrix(m_aJoint0);\r\n#endif\r\n\r\n#if MODEL_TRANSFORM\r\n#if INSTANCING\r\n position = m_aModelMatrix * position;\r\n normal = (m_aModelMatrix * normal);\r\n#else\r\n\r\n#if HAS_SKIN\r\n normal = m_uPerNode.normalMatrix * vec4(normalize(transpose(inverse(jointMatrix)) * normal).xyz, 0.0);\r\n position = m_uPerNode.modelMatrix * jointMatrix * position;\r\n#else\r\n position = m_uPerNode.modelMatrix * position;\r\n normal = m_uPerNode.normalMatrix * vec4(normalize(normal.xyz), 0.0);\r\n#endif\r\n#endif\r\n#endif\r\n\r\n worldPosition = position;\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_skybox.inc":"\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if EQUIRECTANGLE\r\n uv = vec3(1.0 - uv.x, uv.y, 1.0);\r\n#endif\r\n#if WALLPAPER\r\n uv = vec3(uv.x, 1.0 - uv.y, 1.0);\r\n#endif\r\n#if CUBEMAP\r\n#if FLIP\r\n uv = vec3(position.x, -position.z, -position.y);\r\n#else\r\n uv = vec3(position.x, position.z, -position.y);\r\n#endif\r\n#endif\r\n\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n#endif\r\n#if EQUIRECTANGLE || CUBEMAP\r\n position = m_uPerFrame.vpMatrix * vec4(position.xyz, 0.0);\r\n#endif\r\n\r\n position = position.xyww; \r\n}\r\n\r\n\r\n","uniform.inc":"#if WEBGL2\r\nvec4 sampleTexture2D(sampler2D tex, vec2 coord)\r\n{\r\n return texture(tex, coord);\r\n}\r\n\r\nvec4 sampleTexture2D(samplerCube tex, vec3 coord, float LOD) \r\n{\r\n return textureLod(tex, coord, LOD);\r\n}\r\n#else\r\nvec4 sampleTexture2D(sampler2D tex, vec2 coord)\r\n{\r\n return texture2D(tex, coord);\r\n}\r\n\r\nvec4 sampleTexture2D(samplerCube tex, vec3 coord, float LOD) \r\n{\r\n return textureCube(tex, coord);\r\n}\r\n#endif\r\n\r\n#if WEBGL2\r\nvec4 sampleTexture3D(samplerCube tex, vec3 coord)\r\n{\r\n return texture(tex, coord);\r\n}\r\n\r\nvec4 sampleTexture3D(samplerCube tex, vec3 coord, float LOD) \r\n{\r\n return textureLod(tex, coord, LOD);\r\n}\r\n\r\n#else\r\nvec4 sampleTexture3D(samplerCube tex, vec3 coord)\r\n{\r\n return textureCube(tex, coord);\r\n}\r\n\r\nvec4 sampleTexture3D(samplerCube tex, vec3 coord, float LOD) \r\n{\r\n return textureCube(tex, coord);\r\n}\r\n#endif\r\n\r\n"}},"./02resource/m3d_shader_library.js":function(e,t,r){"use strict";r.r(t);var i,n=r("./02resource/m3d_shader_source.js");t.default=((i={}).pbr=new n.default("pbr",["main.vs","pbr_main.vs","transform_simple.inc"],["pbr.fs","pbr_main.fs","material_pbr.inc","shade_pbr.inc"],{highPrecision:!0,vpMatrix:!0,position:!0,normal:!0,modelMatrix:!0,uv:!0}),i["animating-stripe"]=new n.default("animating-stripe",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_animating_ribbon.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,uv:!0}),i["animating-ribbon"]=new n.default("animating-ribbon",["main.vs","modelo_ribbon.vs"],["main.fs","modelo_main.fs","material_animating_ribbon.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,uv:!0}),i.heightmap=new n.default("heightmap",["main.vs","modelo_main.vs","transform_heightmap.inc"],["main.fs","modelo_main.fs","material_heightmap.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),i.heatmap=new n.default("heatmap",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_heatmap.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!1,uv:!0}),i.volume=new n.default("volume",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_dummy.inc","shade_volume.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),i.volume_multi_layer=new n.default("volume_multi_layer",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_dummy.inc","shade_volume_multi_layer.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),i.color_multi_layer=new n.default("color_multi_layer",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_dummy.inc","shade_color_multi_layer.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),i.barchart_wireframe=new n.default("barchart_wireframe",["main.vs","modelo_main.vs","transform_barchart_wireframe.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!1,uv:!1}),i.barchart=new n.default("barchart",["main.vs","modelo_main.vs","transform_barchart.inc"],["main.fs","modelo_main.fs","material_barchart.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),i.blit=new n.default("blit","blit.vs",["blit.fs","blit_simple.inc"],{highPrecision:!0,position:!0,modelMatrix:!0,uv:!0}),i.blit_dof=new n.default("blit_dof","blit.vs",["blit.fs","blit_dof.inc"],{highPrecision:!0,position:!0,modelMatrix:!0,uv:!0}),i.blit_multiply=new n.default("blit","blit.vs",["blit.fs","blit_multiply.inc"],{highPrecision:!0,position:!0,modelMatrix:!0,uv:!0}),i.blit_glow=new n.default("blit_glow","blit.vs",["blit.fs","blit_glow.inc"],{highPrecision:!0,position:!0,modelMatrix:!0,uv:!0}),i.accumulate=new n.default("accumulate","blit.vs",["blit.fs","blit_accumulate.inc"],{highPrecision:!0,position:!0,uv:!0}),i.normaldepth=new n.default("normaldepth",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","normaldepth_main.fs"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,normal:!0,depth:!0,uv:!0}),i.depth=new n.default("depth",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","depth_main.fs"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,depth:!0,uv:!0}),i.solid=new n.default("solid",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_adhoc.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),i.dark=new n.default("dark",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_dark.fs"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),i.mark=new n.default("mark",["main.vs","modelo_main.vs","transform_mark.inc"],["main.fs","mark_main.fs"],{highPrecision:!0,modelMatrix:!0,vpMatrix:!0,vertexid:!0}),i.color=new n.default("color",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_color.inc","shade_adhoc.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,color:!0}),i.texture=new n.default("texture",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_texture.inc","shade_adhoc.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),i.glass=new n.default("glass",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_glass.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0}),i.plain=new n.default("plain",["main.vs","modelo_main.vs","transform_nonormal.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0}),i.plain_texture=new n.default("plain_texture",["main.vs","modelo_main.vs","transform_nonormal.inc"],["main.fs","modelo_main.fs","material_texture.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,uv:!0}),i.df_text=new n.default("df_text",["main.vs","modelo_main.vs","transform_nonormal.inc"],["main.fs","modelo_main.fs","material_dummy.inc","shade_glyph.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,uv:!0}),i.constant=new n.default("constant",["main.vs","modelo_main.vs","transform_nonormal.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0}),i.constant2d=new n.default("constant2d","blit.vs","blit_direct.fs",{highPrecision:!0,position:!0}),i.skybox=new n.default("skybox",["main.vs","modelo_main.vs","transform_skybox.inc"],["main.fs","modelo_main.fs","material_skybox.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,uv:!0}),i.woit_accum_texture=new n.default("woit_accum_texture",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_texture.inc","shade_oit.inc"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,normal:!0,depth:!0,uv:!0}),i.woit_accum_solid=new n.default("woit_accum_solid",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_oit.inc"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,normal:!0,depth:!0}),i.woit_accum_color=new n.default("woit_accum_color",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_color.inc","shade_oit.inc"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,normal:!0,depth:!0}),i.woit_reveal=new n.default("woit_reveal","blit.vs",["blit.fs","blit_oit.inc"],{highPrecision:!0,modelMatrix:!0,position:!0}),i.ssao=new n.default("ssao","blit.vs",["blit.fs","blit_ssao2.inc"],{highPrecision:!0}),i.shadowsmooth=new n.default("shadowsmooth","blit.vs",["blit.fs","blit_shadow.inc"],{highPrecision:!0,position:!0,uv:!0}),i.sketch=new n.default("sketch","blit.vs",["blit.fs","blit_sketch.inc"],{highPrecision:!0,position:!0,uv:!0}),i.contour=new n.default("contour","blit.vs",["blit.fs","blit_contour.inc"],{highPrecision:!0,position:!0,uv:!0}),i.contouroverlay=new n.default("contouroverlay","blit.vs",["blit.fs","blit_contour_overlay.inc"],{highPrecision:!0,position:!0,uv:!0}),i.vr_wrap=new n.default("vr_wrap","blit.vs",["blit.fs","blit_vr_wrap.inc"],{highPrecision:!0,position:!0,uv:!0}),i.gradient=new n.default("gradient","blit.vs",["blit.fs","blit_gradient.inc"],{highPrecision:!0,position:!0,uv:!0}),i.glow=new n.default("glow","blit.vs",["blit.fs","blit_glow.inc"],{highPrecision:!0,position:!0,uv:!0}),i.glow_blur=new n.default("glow_blur","blit.vs",["blit.fs","blit_glow_blur.inc"],{highPrecision:!0,position:!0,uv:!0}),i.fog=new n.default("fog","blit.vs",["blit.fs","blit_fog.inc"],{highPrecision:!0,position:!0,uv:!0}),i.metaball=new n.default("metaball","blit.vs",["blit.fs","blit_metaball.inc"],{highPrecision:!0,position:!0,uv:!0}),i.overlay=new n.default("overlay","blit.vs",["blit.fs","blit_overlay.inc"],{highPrecision:!0,position:!0,uv:!0}),i.background=new n.default("background","blit.vs",["blit.fs","blit_transparent.inc"],{highPrecision:!0,position:!0,uv:!0}),i)},"./02resource/m3d_shader_source.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/m3d_utils.ts"),n=r("./02resource/m3d_shader_chunks.js");t.default=function(){function e(e,t,r,a){this.name=e,this.vsSource=null,this.fsSource=null,this.ready=!1;var s,o,l="";if(i.default.isArray(t))for(s=0,o=t.length;s<o;++s)n.default[t[s]]?l+=n.default[t[s]]:l+=t[s];else n.default[t]?l+=n.default[t]:l+=t;var d="";if(i.default.isArray(r))for(s=0,o=r.length;s<o;++s)n.default[r[s]]?d+=n.default[r[s]]:d+=r[s];else n.default[r]?d+=n.default[r]:d+=r;this._precompile(l,d,a)}return e.prototype.destroy=function(){this.ready&&(this.vsSource=null,this.fsSource=null,this.ready=!1)},e.prototype._precompile=function(e,t,r){if(!this.ready){try{this.vsSource=this._dissolve(e,!0,r),this.fsSource=this._dissolve(t,!1,r)}catch(e){return void console.warn(e)}this.ready=!0}},e.prototype._dissolve=function(e,t,r){var i="";i+="#if WEBGL2 \n#version 300 es \n#endif \n",r.highPrecision?i+="precision highp float;\nprecision highp sampler2D;\n":i+="precision mediump float;\nprecision mediump sampler2D;\n",t?((r.viewMatrix||r.vpMatrix||r.projectionMatrix||r.mvpMatrix)&&(i+="#if WEBGL2 \nuniform m_bPerFrame { \n    mat4 viewMatrix;\n    mat4 vpMatrix;\n    vec4 cameraPosition;\n} m_uPerFrame; \n#else \nstruct PerFrameStruct {\n",r.viewMatrix&&(i+="    mat4 viewMatrix;\n"),r.vpMatrix&&(i+="    mat4 vpMatrix;\n"),i+="    vec4 cameraPosition;\n};\nuniform PerFrameStruct m_uPerFrame; \n#endif \n"),r.modelMatrix&&(i+="#if WEBGL2 && MODEL_TRANSFORM\nuniform m_bPerNode { \n    mat4 modelMatrix;\n    mat4 normalMatrix;\n} m_uPerNode; \n#endif\n#if !WEBGL2 && MODEL_TRANSFORM\nstruct PerNodeStruct {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\nuniform PerNodeStruct m_uPerNode;\n#endif\n"),r.vertexid&&(i+="uniform int m_uBaseVertexOffset; \n")):(r.viewMatrix||r.vpMatrix||r.projectionMatrix||r.mvpMatrix)&&(i+="#if WEBGL2 \nuniform m_bPerFrame { \n    mat4 viewMatrix;\n    mat4 vpMatrix;\n    vec4 cameraPosition;\n} m_uPerFrame; \n#else \nstruct PerFrameStruct {\n",r.viewMatrix&&(i+="    mat4 viewMatrix;\n"),r.vpMatrix&&(i+="    mat4 vpMatrix;\n"),i+="    vec4 cameraPosition;\n};\nuniform PerFrameStruct m_uPerFrame; \n#endif \n");for(var a="",s=e.split("\n"),o=/<([\w\d\.]+)>/g,l=0,d=s.length;l<d;l++){var u=s[l];if(u.match(/#include/g)){var c=u.match(o);if(!c)throw new Error("Can not resolve #include <"+h+">");var h=c[0].substring(1,c[0].length-1);"varying.inc"===h?(t&&r.normal&&(a+="    m_vNormal = normal.xyz; \n"),t&&r.position&&(a+="    m_vVertex = worldPosition.xyz; \n"),t&&r.uv&&(a+="    m_vTexCoord = uv; \n"),t&&r.vertexid&&(a+="    int objectID = gl_VertexID + m_uBaseVertexOffset; \n",a+="    m_vId = vec4( \n",a+="    float(objectID & 0xFF) / 255.0,  \n",a+="    float((objectID >> 8) & 0xFF) / 255.0,  \n",a+="    float((objectID >> 16) & 0xFF) / 255.0,  \n",a+="    float((objectID >> 24) & 0xFF) / 255.0); \n"),t&&r.color&&(a+="    m_vColor = m_aColor; \n"),t&&r.material&&(a+="    m_vMaterial = m_aMaterial;\n"),t&&r.depth&&(a+="m_vDepth = (m_uPerFrame.viewMatrix * worldPosition).z;\n")):a+=n.default[h]}else a+=u+"\n"}return o=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,i+(a=a.replace(o,function(e,t,r,i){var n="";for(l=parseInt(t);l<parseInt(r);l++)n+=i.replace(/\[i\]/g,"["+l+"]");return n}))},e}()},"./03scene/Background.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./03scene/drawables/Skybox.ts");class n{constructor(e){this._resourceManager=e,this.color=new Float32Array([1,1,1,1]),this.mode=i.SkyBoxMode.SKYBOX_SOLIDCOLOR,this.skybox=null}destroy(){null!==this.skybox&&this.skybox.destroy(),this.skybox=null,delete this.skybox,this.color=null,delete this.color}setColor(e){this.color[0]=e[0],this.color[1]=e[1],this.color[2]=e[2],this.color[3]=e[3]}setImages(e){this.skybox||(this.skybox=new i.default(this._resourceManager)),this.skybox.setImage(e)}setMode(e){e!==i.SkyBoxMode.SKYBOX_SOLIDCOLOR?(this.skybox||(this.skybox=new i.default(this._resourceManager)),this.skybox.setMode(e),this.skybox.visible=!0):this.skybox&&(this.skybox.visible=!1),this.mode=e}}},"./03scene/Entity.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./00utility/m3d_math.js"),n=r("./glMatrix.js");class a{constructor(e,t,r){this.materialDrawablesMap=new Map,this.drawables=[],this.name=e,this.bbox=null,this.faces=1,this.hasContours=!1,this._matrix=n.mat4.create(),this._invertMatrix=n.mat4.create(),this._drawableMatrx=n.mat4.create(),this.initMatrix=null,this._resourceManager=t,this._materialManager=r,this._rotate_matrix=new Float32Array(16),this._rotate_point=new Float32Array(3),this.skeletons=[]}initlize(){this._matrix=n.mat4.create(),this.initMatrix=n.mat4.create(),this.updateBBox(),this.initMatrix[12]=this._matrix[12]=.5*(this.bbox[0]+this.bbox[3]),this.initMatrix[13]=this._matrix[13]=.5*(this.bbox[1]+this.bbox[4]),this.initMatrix[14]=this._matrix[14]=.5*(this.bbox[2]+this.bbox[5])}destroy(){this.drawables.forEach(e=>{e.destroy()}),this.drawables=null,delete this.drawables,this.materialDrawablesMap=null,delete this.materialDrawablesMap,this.bbox=null,delete this.bbox,this.name=null,delete this.name,this.faces=null,delete this.faces,this.hasContours=null,delete this.hasContours,this._resourceManager=null,delete this._resourceManager,this._materialManager=null,delete this._materialManager,this.skeletons=null,delete this.skeletons}addDrawable(e){this.materialDrawablesMap.has(e.material.name)?this.materialDrawablesMap.get(e.material.name).push(e):this.materialDrawablesMap.set(e.material.name,[e]),this.drawables.push(e)}updateBBox(){this.bbox=i.default.aabb.create(),this.drawables.forEach(e=>{e.visible&&i.default.aabb.union(this.bbox,e.bbox,this.bbox)})}translate(e,t,r){this.drawables.forEach(i=>{i.translate(e,t,r)}),i.default.aabb.move(this.bbox,this.bbox,[e,t,r])}rotate(e,t,r){n.mat4.fromRotation(this._rotate_matrix,e,t),n.vec3.transformMat4(this._rotate_point,r,this._rotate_matrix),this._rotate_matrix[12]=r[0]-this._rotate_point[0],this._rotate_matrix[13]=r[1]-this._rotate_point[1],this._rotate_matrix[14]=r[2]-this._rotate_point[2],n.mat4.multiply(this._matrix,this._rotate_matrix,this._matrix),this.drawables.forEach(e=>{e.multiply(this._rotate_matrix)}),this.updateBBox()}getRotate(){let e=this._rotate_matrix,t=[];return t[0]=Math.atan2(e[9],e[10]),t[1]=Math.atan2(-e[8],Math.sqrt(e[9]*e[9]+e[10]*e[10])),t[2]=Math.atan2(e[4],e[0]),t}setTranslation(e,t,r){this._matrix[12]=e,this._matrix[13]=t,this._matrix[14]=r,this.drawables.forEach(i=>{i.setTranslation(e,t,r)}),i.default.aabb.moveTo(this.bbox,this.bbox,[e,t,r])}getTranslation(){return[this._matrix[12],this._matrix[13],this._matrix[14]]}setScaling(e,t,r){n.mat4.scale(this._matrix,this._matrix,[e,t,r]),i.default.aabb.invalidate(this.bbox),this.drawables.forEach(n=>{n.setScaling(e,t,r),i.default.aabb.union(this.bbox,this.bbox,n.bbox)})}getScaling(){let e=n.vec3.create();var t=[this._matrix[0],this._matrix[1],this._matrix[2]],r=[this._matrix[4],this._matrix[5],this._matrix[6]],i=[this._matrix[8],this._matrix[9],this._matrix[10]];return e[0]=Math.sqrt(n.vec3.dot(t,t)),e[1]=Math.sqrt(n.vec3.dot(r,r)),e[2]=Math.sqrt(n.vec3.dot(i,i)),e}getTransformMatrix(){return this._matrix}getTransformArray(){n.mat4.invert(this._invertMatrix,this.initMatrix),n.mat4.multiply(this._drawableMatrx,this._matrix,this._invertMatrix);let e=[];for(let t=0;t<this._drawableMatrx.length;t++)e[t]=this._drawableMatrx[t];return e}setTransformMatrix(e){n.mat4.copy(this._matrix,e),n.mat4.invert(this._invertMatrix,this.initMatrix),n.mat4.multiply(this._drawableMatrx,this._matrix,this._invertMatrix),this.drawables.forEach(e=>{e.setTransformMatrix(this._drawableMatrx)})}}},"./03scene/GLTFLoader.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return B});var i=r("./glMatrix.js"),n=r("./node_modules/axios/index.js"),a=r.n(n),s=r("./02resource/MeshAttributes.ts"),o=r("./02resource/m3d_shader_library.js"),l=r("./03scene/drawables/Drawable.ts"),d=r("./03scene/animations/skeletonAnimation/Skeleton.ts"),u=r("./03scene/animations/skeletonAnimation/Joint.ts"),c=r("./03scene/animations/skeletonAnimation/Animation.ts"),h=r("./03scene/animations/skeletonAnimation/KeyFrame.ts"),m=r("./03scene/animations/skeletonAnimation/JointTransform.ts");const f="data:image/png;base64,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",p=100;var v={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};class _{constructor(e,t,r){e=e||i.vec3.fromValues(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),t=t||i.vec3.fromValues(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),void 0===r||!0===r?(this.min=i.vec3.clone(e),this.max=i.vec3.clone(t)):(this.min=e,this.max=t),this.transform=i.mat4.create()}updateBoundingBox(e){i.vec3.min(this.min,this.min,e.min),i.vec3.max(this.max,this.max,e.max)}calculateTransform(){this.transform[0]=this.max[0]-this.min[0],this.transform[5]=this.max[1]-this.min[1],this.transform[10]=this.max[2]-this.min[2],this.transform[12]=this.min[0],this.transform[13]=this.min[1],this.transform[14]=this.min[2]}static getAABBFromOBB(e,t){var r=i.vec3.create(),n=i.vec3.create(),a=i.vec3.create(),s=i.vec3.create(),o=i.vec3.create();i.vec3.set(r,t[0],t[1],t[2]),i.vec3.set(n,t[4],t[5],t[6]),i.vec3.set(a,t[8],t[9],t[10]);var l=i.vec3.fromValues(t[12],t[13],t[14]),d=i.vec3.clone(l);i.vec3.scale(s,r,e.min[0]),i.vec3.scale(o,r,e.max[0]),i.vec3.min(r,s,o),i.vec3.add(l,l,r),i.vec3.max(r,s,o),i.vec3.add(d,d,r),i.vec3.scale(s,n,e.min[1]),i.vec3.scale(o,n,e.max[1]),i.vec3.min(n,s,o),i.vec3.add(l,l,n),i.vec3.max(n,s,o),i.vec3.add(d,d,n),i.vec3.scale(s,a,e.min[2]),i.vec3.scale(o,a,e.max[2]),i.vec3.min(a,s,o),i.vec3.add(l,l,a),i.vec3.max(a,s,o),i.vec3.add(d,d,a);var u=new _(l,d,!1);return u.calculateTransform(),u}}class g{constructor(e,t){this.bufferView=t,this.componentType=e.componentType,this.byteOffset=void 0!==e.byteOffset?e.byteOffset:0,this.byteStride=t.byteStride,this.normalized=void 0!==e.normalized&&e.normalized,this.count=e.count,this.type=e.type,this.size=v[this.type],this.min=e.min,this.max=e.max}_arrayBuffer2TypedArray(e,t,r,i){switch(i){case 5122:return new Int16Array(e,t,r);case 5123:return new Uint16Array(e,t,r);case 5124:return new Int32Array(e,t,r);case 5125:return new Uint32Array(e,t,r);case 5126:return new Float32Array(e,t,r);default:return null}}getAccessorData(){return this._arrayBuffer2TypedArray(this.bufferView.data,this.byteOffset,this.count*v[this.type],this.componentType)}}class b{constructor(e,t){this.byteLength=e.byteLength,this.byteOffset=void 0!==e.byteOffset?e.byteOffset:0,this.byteStride=void 0!==e.byteStride?e.byteStride:0,this.target=void 0!==e.target?e.target:null,this.data=t.slice(this.byteOffset,this.byteOffset+this.byteLength),this._glBuffer=null}getBuffer(e,t){return this._glBuffer||(this._glBuffer=e.createBuffer(),e.bindBuffer(t,this._glBuffer),e.bufferData(t,this.data,e.STATIC_DRAW),e.bindBuffer(t,null)),this._glBuffer}}class y{constructor(e,t,r){if(this.name=void 0!==t.name?t.name:null,this.nodeID=r,this.camera=void 0!==t.camera?t.camera:null,this.matrix=i.mat4.create(),t.hasOwnProperty("matrix")){for(var n=0;n<16;++n)this.matrix[n]=t.matrix[n];this.translation=i.vec3.create(),i.mat4.getTranslation(this.translation,this.matrix),this.rotation=i.quat.create(),i.mat4.getRotation(this.rotation,this.matrix),this.scale=i.vec3.create(),i.mat4.getScaling(this.scale,this.matrix)}else this.getTransformMatrixFromTRS(t.translation,t.rotation,t.scale);this.children=t.children||[],this.mesh=void 0!==t.mesh?e.model.meshes[t.mesh]:null,this.skin=void 0!==t.skin?t.skin:null,this.inverseBindMatrix=null,this.weights=void 0!==t.weights?t.weights:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.aabb=null,this.bvh=new _}traverse(e,t){t(this,e);for(var r=0,i=this.children.length;r<i;r++)this.children[r].traverse(this,t)}traversePostOrder(e,t){for(var r=0,i=this.children.length;r<i;r++)this.children[r].traversePostOrder(this,t);t(this,e)}traverseTwoExecFun(e,t,r){t(this,e);for(var i=0,n=this.children.length;i<n;i++)this.children[i].traverseTwoExecFun(this,t,r);r(this,e)}getTransformMatrixFromTRS(e,t,r){this.translation=void 0!==e?i.vec3.fromValues(e[0],e[1],e[2]):i.vec3.fromValues(0,0,0),this.rotation=void 0!==t?i.vec4.fromValues(t[0],t[1],t[2],t[3]):i.vec4.fromValues(0,0,0,1),this.scale=void 0!==r?i.vec3.fromValues(r[0],r[1],r[2]):i.vec3.fromValues(1,1,1),this.updateMatrixFromTRS()}updateMatrixFromTRS(){i.mat4.fromScaling(this.matrix,this.scale);i.mat4.create();let e=i.mat4.create();i.mat4.fromQuat(e,this.rotation),i.mat4.multiply(this.matrix,e,this.matrix),this.matrix[12]=this.translation[0],this.matrix[13]=this.translation[1],this.matrix[14]=this.translation[2]}}class x{constructor(e,t,r){var i,n;this.meshID=r,this.name=void 0!==t.name?t.name:null,this.primitives=[],this.boundingBox=null;for(var a=0,s=t.primitives.length;a<s;++a)i=t.primitives[a],n=new w(e.model,i,a),this.primitives.push(n),n.boundingBox&&(this.boundingBox||(this.boundingBox=new _),this.boundingBox.updateBoundingBox(n.boundingBox));this.boundingBox&&this.boundingBox.calculateTransform(),this.weights=void 0!==t.weights?t.weights:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null}}class w{constructor(e,t,r){var n;for(n in this.index=r,this.attributes=t.attributes,this.indices=void 0!==t.indices?t.indices:null,null!==this.indices?(this.indicesComponentType=e.json.accessors[this.indices].componentType,this.indicesLength=e.json.accessors[this.indices].count,this.indicesOffset=e.json.accessors[this.indices].byteOffset||0):(this.drawArraysCount=e.json.accessors[this.attributes.POSITION].count,this.drawArraysOffset=e.json.accessors[this.attributes.POSITION].byteOffset||0),this.attributes)this.attributes[n]=e.accessors[this.attributes[n]];if(this.material=void 0!==t.material?e.materials[t.material]:null,this.mode=void 0!==t.mode?t.mode:4,this.targets=t.targets,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.vertexArray=null,this.vertexBuffer=null,this.indexBuffer=null,this.shader=null,this.boundingBox=null,void 0!==this.attributes.POSITION){var a=this.attributes.POSITION;a.max&&"VEC3"===a.type&&(this.boundingBox=new _(i.vec3.fromValues(a.min[0],a.min[1],a.min[2]),i.vec3.fromValues(a.max[0],a.max[1],a.max[2]),!1),this.boundingBox.calculateTransform())}}}class E{constructor(e,t){this.name=void 0!==t.name?t.name:null,this.sampler=void 0!==t.sampler?e.model.samplers[t.sampler]:null,this.source=void 0!==t.source?e.model.images[t.source]:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.texture=null}createTexture(e){this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.source),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null)}}class M{constructor(e){this.name=void 0!==e.name?e.name:null,this.magFilter=void 0!==e.magFilter?e.magFilter:null,this.minFilter=void 0!==e.minFilter?e.minFilter:null,this.wrapS=void 0!==e.wrapS?e.wrapS:10497,this.wrapT=void 0!==e.wrapT?e.wrapT:10497,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null,this.sampler=null}createSampler(e){this.sampler=e.createSampler(),this.minFilter?e.samplerParameteri(this.sampler,e.TEXTURE_MIN_FILTER,this.minFilter):e.samplerParameteri(this.sampler,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_LINEAR),this.magFilter?e.samplerParameteri(this.sampler,e.TEXTURE_MAG_FILTER,this.magFilter):e.samplerParameteri(this.sampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.sampler,e.TEXTURE_WRAP_S,this.wrapS),e.samplerParameteri(this.sampler,e.TEXTURE_WRAP_T,this.wrapT)}}class A{constructor(e){this.index=e.index,this.texCoord=void 0!==e.texCoord?e.texCoord:0,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}class T{constructor(e){this.baseColorFactor=void 0!==e.baseColorFactor?e.baseColorFactor:[1,1,1,1],this.baseColorTexture=void 0!==e.baseColorTexture?new A(e.baseColorTexture):null,this.metallicFactor=void 0!==e.metallicFactor?e.metallicFactor:1,this.roughnessFactor=void 0!==e.roughnessFactor?e.roughnessFactor:1,this.metallicRoughnessTexture=void 0!==e.metallicRoughnessTexture?new A(e.metallicRoughnessTexture):null,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}class S{constructor(e){this.index=e.index,this.texCoord=void 0!==e.texCoord?e.texCoord:0,this.scale=void 0!==e.scale?e.scale:1,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}class k{constructor(e){this.index=e.index,this.texCoord=void 0!==e.texCoord?e.texCoord:0,this.strength=void 0!==e.strength?e.strength:1,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}class D{constructor(e){this.name=void 0!==e.name?e.name:null,this.pbrMetallicRoughness=void 0!==e.pbrMetallicRoughness?new T(e.pbrMetallicRoughness):new T({baseColorFactor:[1,1,1,1],metallicFactor:1,metallicRoughnessTexture:1}),this.normalTexture=void 0!==e.normalTexture?new S(e.normalTexture):null,this.occlusionTexture=void 0!==e.occlusionTexture?new k(e.occlusionTexture):null,this.emissiveTexture=void 0!==e.emissiveTexture?new A(e.emissiveTexture):null,this.emissiveFactor=void 0!==e.emissiveFactor?e.emissiveFactor:[0,0,0],this.alphaMode=void 0!==e.alphaMode?e.alphaMode:"OPAQUE",this.alphaCutoff=void 0!==e.alphaCutoff?e.alphaCutoff:.5,this.doubleSided=e.doubleSided||!1,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}class I{constructor(e,t,r){var n,a,s;for(this.mySkeleton=null,this.name=void 0!==t.name?t.name:null,this.skinID=r,this.joints=new Array(t.joints.length),n=0,s=this.joints.length;n<s;n++)this.joints[n]=e.nodes[t.joints[n]];if(this.skeleton=void 0!==t.skeleton?e.nodes[t.skeleton]:null,this.inverseBindMatrices=void 0!==t.inverseBindMatrices?e.accessors[t.inverseBindMatrices]:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.inverseBindMatrices)for(this.inverseBindMatricesData=this.inverseBindMatrices.getAccessorData(),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(16*p),n=0,a=0,s=this.inverseBindMatricesData.length;n<s;n+=16,a++)this.joints[a].inverseBindMatrix=i.mat4.fromValues(this.inverseBindMatricesData[n],this.inverseBindMatricesData[n+1],this.inverseBindMatricesData[n+2],this.inverseBindMatricesData[n+3],this.inverseBindMatricesData[n+4],this.inverseBindMatricesData[n+5],this.inverseBindMatricesData[n+6],this.inverseBindMatricesData[n+7],this.inverseBindMatricesData[n+8],this.inverseBindMatricesData[n+9],this.inverseBindMatricesData[n+10],this.inverseBindMatricesData[n+11],this.inverseBindMatricesData[n+12],this.inverseBindMatricesData[n+13],this.inverseBindMatricesData[n+14],this.inverseBindMatricesData[n+15])}}class N{constructor(e,t){this.name=void 0!==t.name?t.name:null,this.nodes=new Array(t.nodes.length);for(var r=0,i=t.nodes.length;r<i;r++)this.nodes[r]=e.nodes[t.nodes[r]];this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.boundingBox=null}}class P{constructor(e){this.nodeID=void 0!==e.node?e.node:null,this.path=e.path,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}class O{constructor(e,t){this.sampler=t.samplers[e.sampler],this.target=new P(e.target),this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}class R{constructor(e,t){this.input=e.accessors[t.input],this.output=e.accessors[t.output],this.inputTypedArray=this.input.getAccessorData(),this.outputTypedArray=this.output.getAccessorData(),this.interpolation=void 0!==t.interpolation?t.interpolation:"LINEAR",this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.curIdx=0,this.curValue=i.vec4.create(),this.endT=this.inputTypedArray[this.inputTypedArray.length-1],this.inputMax=this.endT-this.inputTypedArray[0]}}class F{constructor(e,t){var r,i;for(this.name=void 0!==t.name?t.name:null,this.samplers=[],r=0,i=t.samplers.length;r<i;r++)this.samplers[r]=new R(e,t.samplers[r]);for(this.channels=[],r=0,i=t.channels.length;r<i;r++)this.channels[r]=new O(t.channels[r],this);this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null}}class C{constructor(e){this.json=e,this.defaultScene=void 0!==e.scene?e.scene:0,this.version=Number(e.asset.version),e.accessors&&(this.accessors=new Array(e.accessors.length)),e.bufferViews&&(this.bufferViews=new Array(e.bufferViews.length)),e.scenes&&(this.scenes=new Array(e.scenes.length)),e.nodes&&(this.nodes=new Array(e.nodes.length)),e.meshes&&(this.meshes=new Array(e.meshes.length)),e.materials&&(this.materials=new Array(e.materials.length)),e.textures&&(this.textures=new Array(e.textures.length)),e.samplers&&(this.samplers=new Array(e.samplers.length)),e.images&&(this.images=new Array(e.images.length)),e.skins&&(this.skins=new Array(e.skins.length)),e.animations&&(this.animations=new Array(e.animations.length)),e.cameras&&(this.cameras=new Array(e.cameras.length)),this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}class B{constructor(e,t,r){this._buffers=[],this._gltfModel=e,this._resourceManager=t,this._materialManager=r}_parse(){var e,t,r,n,a,s,o;if(this.model.bufferViews)for(e=0,t=this.model.bufferViews.length;e<t;e++)this.model.bufferViews[e]=new b(this.model.json.bufferViews[e],this._buffers[this.model.json.bufferViews[e].buffer]);if(this.model.accessors)for(e=0,t=this.model.accessors.length;e<t;e++)this.model.accessors[e]=new g(this.model.json.accessors[e],this.model.bufferViews[this.model.json.accessors[e].bufferView]);if(this.model.materials)for(e=0,t=this.model.materials.length;e<t;e++)this.model.materials[e]=new D(this.model.json.materials[e]);if(this.model.samplers)for(e=0,t=this.model.samplers.length;e<t;e++)this.model.samplers[e]=new M(this.model.json.samplers[e]);if(this.model.textures)for(e=0,t=this.model.textures.length;e<t;e++)this.model.textures[e]=new E(this,this.model.json.textures[e]);for(e=0,t=this.model.meshes.length;e<t;e++)this.model.meshes[e]=new x(this,this.model.json.meshes[e],e);for(e=0,t=this.model.nodes.length;e<t;e++)this.model.nodes[e]=new y(this,this.model.json.nodes[e],e);for(e=0,t=this.model.nodes.length;e<t;e++)for(r=0,n=(s=this.model.nodes[e]).children.length;r<n;r++)s.children[r]=this.model.nodes[s.children[r]];var l,d=new Array(this.model.nodes.length);for(e=0,t=d.length;e<t;e++)d[e]=i.mat4.create();function u(e,t){var r=d[e.nodeID];if(null!==t)i.mat4.mul(r,d[t.nodeID],e.matrix);else{let t=[1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1];i.mat4.mul(r,t,e.matrix)}e.matrixWorld=i.mat4.clone(r),e.matrixParent=i.mat4.clone(null!==t?d[t.nodeID]:i.mat4.create())}function c(e,t){var r,n=d[e.nodeID];r=null!==t?t.bvh:a.boundingBox,e.mesh&&(o=e.mesh).boundingBox&&(e.aabb=_.getAABBFromOBB(o.boundingBox,n),0===e.children.length&&(i.vec3.copy(e.bvh.min,e.aabb.min),i.vec3.copy(e.bvh.max,e.aabb.max))),i.vec3.min(r.min,r.min,e.bvh.min),i.vec3.max(r.max,r.max,e.bvh.max)}for(e=0,t=this.model.scenes.length;e<t;e++){for((a=this.model.scenes[e]=new N(this.model,this.model.json.scenes[e])).boundingBox=new _,r=0,n=a.nodes.length;r<n;r++)(s=a.nodes[r]).traverseTwoExecFun(null,u,c);a.boundingBox.calculateTransform()}for(r=0,n=this.model.nodes.length;r<n;r++)null!==(s=this.model.nodes[r]).bvh&&s.bvh.calculateTransform();if(this.model.animations)for(e=0,t=this.model.animations.length;e<t;e++)this.model.animations[e]=new F(this.model,this.model.json.animations[e]);if(this.model.json.skins)for(e=0,t=this.model.skins.length;e<t;e++)for(this.model.skins[e]=new I(this.model,this.model.json.skins[e],e),r=0,n=(l=this.model.skins[e].joints).length;r<n;r++)l[r].jointID=r;for(e=0,t=this.model.nodes.length;e<t;e++)null!==(s=this.model.nodes[e]).skin&&"number"==typeof s.skin&&(s.skin=this.model.skins[s.skin])}_createTexture(e){let t=this.model.textures[e.index],r=this._modelUrl+"-"+e.index;if(this._resourceManager.hasTexture(r))return this._resourceManager.getTexture(r);{let e=this._resourceManager.getTexture(r),i=t.source,n=this._resourceManager.gl,a=n.LINEAR,s=n.REPEAT;return t.sampler&&t.sampler.minFilter&&(a=t.sampler.minFilter),t.sampler&&t.sampler.wrapS&&(s=t.sampler.wrapS),e.createFromImage(i,-1===i.src.indexOf(".png")?n.RGB:n.RGBA,n.UNSIGNED_BYTE,a,s),e}}_createShader(e,t){let r=[];r.push("MODEL_TRANSFORM");let i=e.material;i&&(i.pbrMetallicRoughness.baseColorTexture&&r.push("HAS_BASECOLORMAP"),i.pbrMetallicRoughness.metallicRoughnessTexture&&r.push("HAS_METALROUGHNESSMAP"),i.normalTexture&&r.push("HAS_NORMALMAP"),i.occlusionTexture&&r.push("HAS_OCCLUSIONMAP"),i.emissiveTexture&&r.push("HAS_EMISSIVEMAP"),t&&r.push("HAS_SKIN")),void 0!==e.attributes.TANGENT&&r.push("HAS_TANGENT");var n=this._resourceManager.getShader("pbr",r);if(!n.ready){var a=o.default.pbr;if(n.createFromShaderSource(a,r),!n.ready)throw"modelo3d error at creating shader 'pbr'!"}return n}_createMaterial(e,t){let r=this._resourceManager.gl,i=e.material,n=this._materialManager.createMaterialPbr(this._modelUrl+"-"+e.material.name);var a;if(n.attachShader(t,this._resourceManager),n.setBaseColor(i.pbrMetallicRoughness.baseColorFactor),n.setMetallic(i.pbrMetallicRoughness.metallicFactor),n.setRoughness(i.pbrMetallicRoughness.roughnessFactor),n.setEmissive(i.emissiveFactor),this._resourceManager.hasTexture("modelo-brdf-lut")?a=this._resourceManager.getTexture("modelo-brdf-lut"):(a=this._resourceManager.getTexture("modelo-brdf-lut")).createFromFile(f,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,()=>{}),n.setBrdfLut(a),i.pbrMetallicRoughness.baseColorTexture){let e=i.pbrMetallicRoughness.baseColorTexture,t=this._createTexture(e);n.setBaseColorTexture(t)}if(i.normalTexture){let e=i.normalTexture,t=this._createTexture(e);n.setNormalTexture(t)}if(i.pbrMetallicRoughness.metallicRoughnessTexture){let e=i.pbrMetallicRoughness.metallicRoughnessTexture,t=this._createTexture(e);n.setMetallicRoughnessTexture(t)}if(i.emissiveTexture){let e=i.emissiveTexture,t=this._createTexture(e);n.setEmissiveTexture(t)}if(i.occlusionTexture){let e=i.occlusionTexture,t=this._createTexture(e);n.setOcclusionTexture(t)}return n}_createMesh(e){let t=this._resourceManager.gl,r=new s.default,i=[];var n=e.attributes.POSITION;r.add("m_aPosition",0,n.componentType,n.normalized,n.size,n.byteStride,n.byteOffset),i.push(n.bufferView.getBuffer(t,t.ARRAY_BUFFER)),void 0!==e.attributes.NORMAL&&(n=e.attributes.NORMAL,r.add("m_aNormal",1,n.componentType,n.normalized,n.size,n.byteStride,n.byteOffset),i.push(n.bufferView.getBuffer(t,t.ARRAY_BUFFER))),void 0!==e.attributes.TEXCOORD_0&&(n=e.attributes.TEXCOORD_0,r.add("m_aTexCoord",4,n.componentType,n.normalized,n.size,n.byteStride,n.byteOffset),i.push(n.bufferView.getBuffer(t,t.ARRAY_BUFFER))),void 0!==e.attributes.TANGENT&&(n=e.attributes.TANGENT,r.add("m_aTangent",7,n.componentType,n.normalized,n.size,n.byteStride,n.byteOffset),i.push(n.bufferView.getBuffer(t,t.ARRAY_BUFFER))),void 0!==e.attributes.JOINTS_0&&(n=e.attributes.JOINTS_0,r.add("m_aJoint0",8,n.componentType,n.normalized,n.size,n.byteStride,n.byteOffset),i.push(n.bufferView.getBuffer(t,t.ARRAY_BUFFER))),void 0!==e.attributes.WEIGHTS_0&&(n=e.attributes.WEIGHTS_0,r.add("m_aWeight0",9,n.componentType,n.normalized,n.size,n.byteStride,n.byteOffset),i.push(n.bufferView.getBuffer(t,t.ARRAY_BUFFER)));let a=this._resourceManager.getMesh(this._modelUrl+e.index),o=(n=this.model.accessors[e.indices]).bufferView.getBuffer(t,t.ELEMENT_ARRAY_BUFFER);return a.createFromBufferObject(i,o,r,e.mode,e.indicesComponentType,e.indicesLength,n.byteOffset),a}_createDrawable(e,t,r,i,n){let a=t.boundingBox,s=new l.default(r,i,n,null,new Float32Array([a.min[0],a.min[1],a.min[2],a.max[0],a.max[1],a.max[2]]));return s.transform.set(e.matrixWorld),this._gltfModel.addDrawable(s),s}_traverseNode(e){if(e.mesh&&e.mesh.primitives.forEach(t=>{let r=this._createMesh(t),i=this._createShader(t,!!e.skin),n=this._createMaterial(t,i),a=this._createDrawable(e,t,r,i,n);e.skin&&(a.skeleton=e.skin.mySkeleton)}),e.children.length>0)for(let t=0;t<e.children.length;t++)this._traverseNode(e.children[t])}_buildSkeleton(e,t,r){t.children.forEach(t=>{let i=r.get(t.nodeID.toString());e.addChild(i),this._buildSkeleton(i,t,r)})}_setupScene(){this.model.skins&&this.model.skins.length>0&&(this.model.skins.forEach(e=>{let t=new Map,r=new u.default(this._modelUrl+e.skeleton.nodeID.toString(),e.skeleton.inverseBindMatrix?e.skeleton.inverseBindMatrix:i.mat4.create(),e.skeleton.matrixWorld);t.set(r.getName(),r);let n=new d.default(r,this._resourceManager);n.setRootMatrix(e.skeleton.matrixParent),e.joints.forEach(e=>{let r=t.get(e.nodeID.toString());r||(r=new u.default(e.nodeID.toString(),e.inverseBindMatrix,e.matrixWorld),t.set(r.getName(),r)),n.addJoint(r)}),this._buildSkeleton(r,e.skeleton,t),this._gltfModel.skeletons.push(n),e.mySkeleton=n}),this.model.animations.forEach((e,t)=>{let r=new Map,i=0,n=new Set;e.channels.forEach(e=>{let t=e.sampler,a=m.INTERPOLATION.LINEAR;switch(t.interpolation){case"LINEAR":a=m.INTERPOLATION.LINEAR;break;case"STEP":a=m.INTERPOLATION.STEP;break;case"CATMULLROMSPLINE":a=m.INTERPOLATION.CATMULLROMSPLINE;break;case"CUBICSPLINE":a=m.INTERPOLATION.CUBICSPLINE}let s=0;for(let o=0;o<t.inputTypedArray.length;o++){let l=t.inputTypedArray[o];l>i&&(i=l);let d=r.get(l);d||(d=new h.default(l),r.set(l,d));let u=d.getJointKeyFrames(),c=t.output.size,f=[];for(let e=0;e<c;e++)f[e]=t.outputTypedArray[s+e];let p=e.target.nodeID.toString();n.has(p)||n.add(p);let v=u.get(p);switch(v||(v=new m.default,u.set(p,v)),v.setInterpolationMethod(a),e.target.path){case"translation":v.setTranslation(f);break;case"rotation":v.setRotation(f);break;case"scale":v.setScale(f)}s+=c}});let a=Array.from(r.values());a.sort((e,t)=>e.getTimeStamp()-t.getTimeStamp()),a.forEach(e=>{e.getJointKeyFrames().forEach((e,t)=>{let r=parseInt(t),i=this.model.nodes[r];null===e.getTranslation()&&e.setTranslation(i.translation),null===e.getRotation()&&e.setRotation(i.rotation),null===e.getScale()&&e.setScale(i.scale)})}),a[0].getJointKeyFrames().forEach((e,t)=>{for(var r=1;r<a.length;r++)a[r].getJointKeyFrames().has(t)||a[r].getJointKeyFrames().set(t,e)});let s=new c.default(t.toString(),i,a);n.forEach(e=>{for(var t=0;t<this._gltfModel.skeletons.length;t++){var r=this._gltfModel.skeletons[t];if(-1!==r.joints.findIndex(t=>t.getName()===e)){r.addAnimation(s);break}}})})),this.model.scenes.forEach(e=>{e.nodes.forEach(e=>{this._traverseNode(e)})});let e=this.model.scenes[0].boundingBox;this._gltfModel.bbox=new Float32Array([e.min[0],e.min[1],e.min[2],e.max[0],e.max[1],e.max[2]])}load(e,t){this._modelUrl=e,this._baseUrl=this._getBaseUrl(e),a.a.get(e,{responseType:"json"}).then(e=>{let r=e.data;this.model=new C(r);let i=[];r.images&&i.push(this._loadImages(r.images)),r.buffers&&i.push(this._loadArraybuffer(r.buffers)),Promise.all(i).then(()=>{this._parse(),this._setupScene(),t()})})}_loadImages(e){return new Promise((t,r)=>{let i=e.length;for(var n=0;n<e.length;n++){let a=new Image;a.src=this._baseUrl+e[n].uri,a.onload=(()=>{0===--i&&t()}),a.onerror=(()=>{console.error("failed to load image: "+a.src),r()}),this.model.images[n]=a}})}_loadArraybuffer(e){return new Promise((t,r)=>{let i=[];for(var n=0;n<e.length;n++){let t=e[n].uri;if("data:application/octet-stream;base64,"===t.substring(0,37)){let e=t.substring(37),r=this.base64toArrayBuffer(e);this._buffers[n]=r.buffer}else{let t=this._baseUrl+e[n].uri,r=a.a.get(t,{responseType:"arraybuffer"});i.push(r)}}Promise.all(i).then(e=>{e.forEach((e,t)=>{this._buffers[t]=e.data}),t()})})}_getBaseUrl(e){var t="",r=e.lastIndexOf("/");return-1!==r&&(t=e.substring(0,r+1)),t}base64toArrayBuffer(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(t),i=new Uint8Array(r.length);for(let e=0;e<r.length;++e)i[e]=r.charCodeAt(e);return i}}},"./03scene/MaterialManager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/MaterialAdhoc.ts"),n=r("./03scene/materials/MaterialPbr.ts");class a{constructor(e){this._materials={},this._customColors={},this._customColorCount=0,this._buffer=new Uint8Array(1024),this._resourceManager=e;const t=e.gl;this.texture=e.getTexture("texturemanager"),this.texture.create(256,1,t.RGBA8,t.NEAREST,t.CLAMP_TO_EDGE),this.texture.use(3)}destroy(){for(var e in this._materials)this._materials[e].destroy();this._materials=null,delete this._materials,this.texture=null,delete this.texture,this._buffer=null,delete this._buffer}createMaterialPbr(e){return this._materials[e]?this._materials[e]:(this._materials[e]=new n.default(e,this._resourceManager),this._materials[e])}createMaterialAdhoc(e){return this._materials[e]?this._materials[e]:(this._materials[e]=new i.default(e,this._resourceManager),this._materials[e])}addCustomColor(e){var t=e.toString();return this._customColors[t]||(this._customColors[t]={index:this._customColorCount,color:e},this._customColorCount++),this._customColors[t].index}getMaterial(e){return this._materials[e]}upload(){for(var e in this._customColors){var t=4*this._customColors[e].index;this._buffer[t]=Math.floor(255*this._customColors[e].color[0]),this._buffer[t+1]=Math.floor(255*this._customColors[e].color[1]),this._buffer[t+2]=Math.floor(255*this._customColors[e].color[2]),this._buffer[t+3]=Math.floor(255*this._customColors[e].color[3])}this.texture.update(this._buffer)}getAllMaterials(){return this._materials}}},"./03scene/Scene.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return c});var i=r("./00utility/m3d_math.js"),n=r("./03scene/m3d_light.js"),a=r("./03scene/m3d_scene_clip.js"),s=r("./03scene/Background.ts"),o=r("./03scene/model/Element.ts"),l=r("./03scene/materials/MaterialAdhoc.ts"),d=r("./03scene/materials/MaterialPbr.ts"),u=new Float32Array([1e10,1e10,1e10,-1e10,-1e10,-1e10]);class c{constructor(e,t){this._exposure=1,this._lights=[],this.models={},this.pawns={},this.text3Ds=[],this.background=new s.default(e),this.materialManager=t,this.bbox=i.default.aabb.create(),this.scale=1,this.radius=1.732,this._lights[0]=new n.default,this.clipping=new a.default(this)}destroy(){this.background&&this.background.destroy(),this.background=null,delete this.background;for(let e in this.models)this.models[e].destroy();this.models=null,delete this.models;for(let e in this.pawns)this.pawns[e].destroy();this.pawns=null,delete this.pawns,this.bbox=null,this._lights=null,this.clipping=null}updateBBox(e){let t;if(e)i.default.aabb.union(this.bbox,this.bbox,e),t=this.bbox;else{t=i.default.aabb.create();for(let e in this.models){let r=this.models[e];r.updateBBox(),i.default.aabb.union(t,t,r.bbox)}for(let e in this.pawns){let r=this.pawns[e];r.updateBBox(),i.default.aabb.union(t,t,r.bbox)}}this.setBBox(t)}setLightingIntensity(e){this._lights[0].setIntensity(e)}setSpecularShinness(e){this._lights[0].setSpecularShinness(e)}setLightingLatitude(e){this._lights[0].setLatitude(e)}setLightingLongitude(e){this._lights[0].setLongitude(e)}setMainLight(e){this._lights[0]=e}getMainLight(){return this._lights[0]}setBBox(e){this.bbox=i.default.aabb.createFromArray(e),i.default.aabb.expand(this.bbox);var t=i.default.aabb.size(this.bbox);this.scale=.5*Math.max(t.width,Math.max(t.height,t.depth)),this.radius=.5*i.default.aabb.length(this.bbox),this.clipping.initialize(this.bbox)}setElementsVisibility(e,t,r){null==r&&(r=t);let i=[];for(let t=0,r=e.length;t<r;t++){var n=e[t];const r=n.split("+")[0],a=this.models[r].tree.elements[n];if(!a)continue;let s=a.getNodes();i.push(...s)}let a=new Set;for(var s=0;s<i.length;s++){var o=i[s];o.drawable.mesh.isLine()?o.visible=r:o.visible=t,a.add(o.drawable)}a.forEach(e=>{e.updateVisibility()})}isElementVisible(e){const t=e.split("+")[0],r=this.models[t].tree.elements[e];return!!r&&r.getNodes()[0].visible}getElementBBox(e){const t=e.split("+")[0],r=this.models[t].tree.elements[e];return r?r.bbox:u}getElementMaterials(e){const t=e.split("+")[0],r=this.models[t].tree.elements[e];if(r){let e=new Set;return r.getNodes().forEach(t=>{e.has(t.drawable.material)||e.add(t.drawable.material)}),Array.from(e)}}getElementMaterialNames(e){const t=e.split("+")[0],r=this.models[t].tree.elements[e];if(r){let e=new Set;return r.getNodes().forEach(t=>{t.drawable.mesh.isLine()||e.has(t.drawable.material.name)||e.add(t.drawable.material.name)}),Array.from(e)}}getPawnMaterialNames(e){let t=new Set;return e.drawables.forEach(e=>{e.mesh.isLine()||t.has(e.material.name)||t.add(e.material.name)}),Array.from(t)}getMaterialType(e){let t=this.materialManager.getMaterial(e);if(t)return t instanceof l.default?"MaterialAdhoc":t instanceof d.default?"MaterialPbr":void 0;console.warn("no material named "+e+" found!")}getModelMaterialNames(){let e={};for(var t in this.models)e[t]=[],this.models[t].materialDrawablesMap.forEach((r,i)=>{for(var n=!1,a=0;a<r.length;a++)if(r[a].mesh.isLine()){n=!0;break}n||e[t].push(i)});return e}getDrawablesByMaterialName(e){for(var t in this.models)return this.models[t].materialDrawablesMap.has(e)?this.models[t].materialDrawablesMap.get(e):[]}getElementNamesByMaterialName(e){let t=[];for(var r in this.models)if(this.models[r].materialDrawablesMap.has(e))return this.models[r].materialDrawablesMap.get(e).forEach(e=>{e.mesh.isLine()||e.nodes.forEach(e=>{var i=e.getElement(),n=r+"+"+i.getDocument().id+"/"+i.id;t.push(n)})}),t;return console.warn("no material named "+e+"was found!"),null}getMaterialParameter(e,t){let r=this.materialManager.getMaterial(e);switch(t){case"color":if(r instanceof l.default)return r.getDiffuse();if(r instanceof d.default)return r.getBaseColor();break;case"colorTexture":var i=null;return r instanceof l.default?i=r.getDiffuseTexture():r instanceof d.default&&(i=r.getBaseColorTexture()),i?i.url:null;case"opacity":if(r instanceof l.default||r instanceof d.default)return r.getTransparent();break;case"roughness":if(r instanceof d.default)return r.getRoughness();break;case"metallic":if(r instanceof d.default)return r.getMetallic()}console.warn("parameter name "+t+" does not exist in material: "+e)}setMaterialParameter(e,t,r){let i=this.materialManager.getMaterial(e);switch(t){case"color":i instanceof l.default?i.setDiffuse(r):i instanceof d.default?i.setBaseColor(r):console.warn("material "+e+" should be MaterialAhoc or MaterialPbr!");break;case"opacity":i instanceof l.default||i instanceof d.default?i.setTransparent(r):console.warn("material "+e+" should be MaterialAhoc or MaterialPbr!");break;case"colorTexture":for(var n=this.getDrawablesByMaterialName(i.name),a=0;a<n.length;a++)if(!n[a].mesh.attributes.hasUV)return void console.warn("A drawable using this material doesn't has uv coord.");for(a=0;a<n.length;a++)n[a].recompileShader("HAS_BASECOLORMAP",!0);null===r&&(r=i.originTextureUrl),i instanceof l.default?i.setDiffuseTexture(r):i instanceof d.default?i.setBaseColorTexture(r):console.warn("material "+e+" should be MaterialAhoc or MaterialPbr!");break;case"roughness":i instanceof d.default?i.setRoughness(r):console.warn("material "+e+" should be MaterialPbr!");break;case"metallic":i instanceof d.default?i.setMetallic(r):console.warn("material "+e+" should be MaterialPbr!");break;case"metallicRoughnessTexture":for(n=this.getDrawablesByMaterialName(i.name),a=0;a<n.length;a++)if(!n[a].mesh.attributes.hasUV)return void console.warn("A drawable using this material doesn't has uv coord.");for(a=0;a<n.length;a++)n[a].recompileShader("HAS_METALROUGHNESSMAP",!0);i instanceof d.default?i.setMetallicRoughnessTexture(r):console.warn("material "+e+" should be MaterialPbr");break;case"emissiveTexture":for(n=this.getDrawablesByMaterialName(i.name),a=0;a<n.length;a++)if(!n[a].mesh.attributes.hasUV)return void console.warn("A drawable using this material doesn't has uv coord.");for(a=0;a<n.length;a++)n[a].recompileShader("HAS_EMISSIVEMAP",!0);i instanceof d.default?i.setEmissiveTexture(r):console.warn("material "+e+" should be MaterialPbr");break;case"normalTexture":for(n=this.getDrawablesByMaterialName(i.name),a=0;a<n.length;a++)if(!n[a].mesh.attributes.hasUV)return void console.warn("A drawable using this material doesn't has uv coord.");for(a=0;a<n.length;a++)n[a].recompileShader("HAS_NORMALMAP",!0);i instanceof d.default?i.setNormalTexture(r):console.warn("material "+e+" should be MaterialPbr");break;case"reflectionIntensity":i instanceof d.default?i.setReflectIntensity(r):console.warn("Material type is not MaterialPbr;")}}getElementsBBox(e){var t=this,r=i.default.aabb.createFromArray([1/0,1/0,1/0,-1/0,-1/0,-1/0]);return e.forEach(function(e){const n=e.split("+")[0],a=t.models[n];if(a){const t=a.tree.elements[e];t&&i.default.aabb.union(r,r,t.bbox)}}),r}getElements(e=o.ElementType.ANY,t=!1){let r=[];for(let i in this.models){const n=this.models[i];for(let i in n.tree.elements){const a=n.tree.elements[i];e===o.ElementType.ANY?r.push(a):a.etype!==e||t?a.etype!==e&&t&&r.push(a):r.push(a)}}return r}getElementsNames(e=o.ElementType.ANY,t=!1){let r=[];for(let i in this.models){const n=this.models[i];for(let i in n.tree.elements){const a=n.tree.elements[i];e===o.ElementType.ANY?r.push(i):a.etype!==e||t?a.etype!==e&&t&&r.push(i):r.push(i)}}return r}setElementsColor(e,t){let r=new Set,i=new Map,n=null;for(let t=0,a=e.length;t<a;t++){let a=e[t];const s=a.split("+")[0];let o=this.models[s].tree.elements[a];if(o){let e=o.getNodes();e.forEach(e=>{r.add(e)}),e.forEach(e=>{i.has(e.drawable)?(n=i.get(e.drawable)).has(a)||n.add(a):i.set(e.drawable,new Set([a]))})}}t?i.forEach((e,i)=>{let n=1;if(null!==t[3]&&void 0!==t[3]&&(t[3]<.99&&!i.material.transparent?e.forEach(e=>{console.warn("Can not set opaque elements to transparent: "+e)}):n=t[3]),1===i.nodes.length){let e=i.material.clone();e.setDiffuse(t),e.setTransparent(n),i.originalMaterial||(i.originalMaterial=i.material),i.material=e}else{var a=this.materialManager.addCustomColor([t[0],t[1],t[2],n]);if(a>126)return void console.warn("color count out of index");this.materialManager.upload();for(var s=0;s<i.nodes.length;s++){var o=i.nodes[s];r.has(o)&&(o.platteIndex=(128&o.platteIndex)+a)}i.updateColor()}}):i.forEach((e,t)=>{if(1!==t.nodes.length){for(var r=0;r<t.nodes.length;r++){var i=t.nodes[r];i.platteIndex=127+(128&i.platteIndex)}t.updateColor()}else t.originalMaterial&&(t.material=t.originalMaterial)})}setModelVisibility(e,t,r){null==r&&(r=t);let i=this.models[e];i?this.setElementsVisibility(Object.keys(i.tree.elements),t,r):console.warn("no model named "+i+" is found.")}addPawn(e){this.pawns[e.name]=e,this.updateBBox(e.bbox)}addModel(e){this.models[e.name]?console.error("can not load same model twice: "+e.name+"!"):(this.models[e.name]=e,this.updateBBox(e.bbox))}removePawn(e){this.pawns.hasOwnProperty(e.name)&&delete this.pawns[e.name]}addText3D(e){this.text3Ds.push(e),this.updateBBox()}removeText3D(e){let t=this.text3Ds.indexOf(e);-1!==t?(this.text3Ds.splice(t,1),this.updateBBox()):console.warn("text3D is not found!")}needRenderDoubleSided(){let e=2;for(let t in this.models)e&=this.models[t].faces;for(let t in this.pawns)e&=this.pawns[t].faces;return this._needRenderDoubleSided=e<1||e<=1&&this.clipping.isEnabled(),this._needRenderDoubleSided}setRenderDoubleSided(e){this._needRenderDoubleSided=e}hasContours(){for(let e in this.models)if(this.models[e].hasContours)return!0;return!1}setReflectionMap(e){if(e)for(var t in this.models){this.models[t].drawables.forEach(t=>{t.mesh.isLine()||(t.recompileShader("SPECULAR_ENV_MAP",!0),t.material.setSpecularEnvMap(e))})}else for(var t in this.models){this.models[t].drawables.forEach(e=>{e.mesh.isLine()||e.recompileShader("SPECULAR_ENV_MAP",!1)})}}setToneMappingEnabled(e){for(var t in this.models){this.models[t].drawables.forEach(t=>{t.recompileShader("TONE_MAPPING",e),t.material.parameters.uExposure.value=this._exposure})}this.background&&this.background.skybox&&(this.background.skybox.recompileShader("TONE_MAPPING",e),this.background.skybox.material.parameters.uExposure.value=this._exposure)}setToneMappingExposure(e){for(var t in this._exposure=e,this.models){this.models[t].drawables.forEach(e=>{e.material.parameters.uExposure&&(e.material.parameters.uExposure.value=this._exposure)})}this.background&&this.background.skybox&&this.background.skybox.material.parameters.uExposure&&(this.background.skybox.material.parameters.uExposure.value=this._exposure)}}},"./03scene/animations/skeletonAnimation/Animation.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(e,t,r){this._name=e,this._keyFrames=r,this._length=t,this._speed=.0167}getSpeed(){return this._speed}setSpeed(e){this._speed=e}getName(){return this._name}getLength(){return this._length}getKeyFrames(){return this._keyFrames}}},"./03scene/animations/skeletonAnimation/Animator.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./glMatrix.js"),n=r("./03scene/animations/skeletonAnimation/JointTransform.ts");class a{constructor(e){this._skeleton=e,this._animationTime=0}doAnimation(e){this._animationTime=0,this._currentAnimation=e}update(){if(null==this._currentAnimation)return;this._increaseAnimationTime();let e=this._calculateCurrentAnimationPose();this._applyPoseToJoints(e,this._skeleton.getRoot(),this._skeleton._rootMatrix)}_increaseAnimationTime(){this._animationTime+=this._currentAnimation.getSpeed(),this._animationTime>this._currentAnimation.getLength()&&(this._animationTime%=this._currentAnimation.getLength())}_calculateCurrentAnimationPose(){let e=this._getPreviousAndNextFrames(),t=this._calculateProgression(e[0],e[1]);return this._interpolatePoses(e[0],e[1],t)}_applyPoseToJoints(e,t,r){let n=e.get(t.getName());n||(n=i.mat4.create());let a=i.mat4.create();i.mat4.multiply(a,r,n),t.children.forEach(t=>{this._applyPoseToJoints(e,t,a)}),i.mat4.multiply(a,a,t.getInverseBindTransform()),t.setAnimationTransform(a)}_getPreviousAndNextFrames(){let e=this._currentAnimation.getKeyFrames(),t=e[0],r=e[0];for(let i=1;i<e.length&&!((r=e[i]).getTimeStamp()>this._animationTime);i++)t=e[i];return[t,r]}_calculateProgression(e,t){let r=t.getTimeStamp()-e.getTimeStamp();return(this._animationTime-e.getTimeStamp())/r}_interpolatePoses(e,t,r){let i=new Map;const a=e.getJointKeyFrames(),s=t.getJointKeyFrames();return a.forEach((e,t)=>{let a,o=s.get(t);a=e.getInterpolationMethod()==n.INTERPOLATION.STEP?e:n.default.interpolate(e,o,r),i.set(t,a.getLocalTransform())}),i}}},"./03scene/animations/skeletonAnimation/Joint.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./glMatrix.js");class n{constructor(e,t,r){this._name=e,this._inverseBindMatrix=t,this.children=[],this._animatedTransform=i.mat4.create(),this._matrixWorld=r}getName(){return this._name}addChild(e){this.children.push(e)}getAnimatedTransform(){return this._animatedTransform}setAnimationTransform(e){i.mat4.copy(this._animatedTransform,e)}getInverseBindTransform(){return this._inverseBindMatrix}}},"./03scene/animations/skeletonAnimation/JointTransform.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"INTERPOLATION",function(){return i}),r.d(t,"default",function(){return a});var i,n=r("./glMatrix.js");!function(e){e[e.LINEAR=0]="LINEAR",e[e.STEP=1]="STEP",e[e.CATMULLROMSPLINE=2]="CATMULLROMSPLINE",e[e.CUBICSPLINE=3]="CUBICSPLINE"}(i||(i={}));class a{constructor(e,t,r){this._position=e||null,this._rotation=t||null,this._scale=r||null,this._interpolationMethod=i.LINEAR,this._matrix=n.mat4.create()}getInterpolationMethod(){return this._interpolationMethod}setTranslation(e){this._position=e}getTranslation(){return this._position}setRotation(e){this._rotation=e}getRotation(){return this._rotation}setScale(e){this._scale=e}getScale(){return this._scale}setInterpolationMethod(e){this._interpolationMethod=e}static interpolate(e,t,r){let i=new a(n.vec3.create(),n.quat.create(),n.vec3.fromValues(1,1,1));return n.vec3.lerp(i._position,e._position,t._position,r),n.quat.slerp(i._rotation,e._rotation,t._rotation,r),n.vec3.lerp(i._scale,e._scale,t._scale,r),i}getLocalTransform(){n.mat4.fromScaling(this._matrix,this._scale);let e=n.mat4.create();return n.mat4.fromQuat(e,this._rotation),n.mat4.multiply(this._matrix,e,this._matrix),this._matrix[12]=this._position[0],this._matrix[13]=this._position[1],this._matrix[14]=this._position[2],this._matrix}}},"./03scene/animations/skeletonAnimation/KeyFrame.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(e){this._timeStamp=e,this._pose=new Map}getTimeStamp(){return this._timeStamp}getJointKeyFrames(){return this._pose}}},"./03scene/animations/skeletonAnimation/Skeleton.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/animations/skeletonAnimation/Animator.ts"),n=r("./glMatrix.js");class a{constructor(e,t){this._lastFrame=-1,this._animator=new i.default(this),this._rootJoint=e,this.joints=[],this._animations=[],t.gl.isWebGL2?this._transformTexture=null:(this._transformTexture=t.getTexture("skeleton-transform-"+e.getName()),t.gl.floatTextureExtension||console.warn("skeleton animation not supported in webgl1.0 without float texture extension!"),this._transformTexture.create(512,1,t.gl.RGBA32F,t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._transformTexture.use(4),this.gl=t.gl)}use(e){let t=e.getGL();if(this._transformTexture){this._transformTexture.update(this._jointMatrices),e.reservedUniforms.m_uTransformTexture.upload(4,this.gl)}else{let r=e.reservedUniforms.m_uJointMatrix;r&&r.upload(this._jointMatrices,t)}}updateJointMatrices(){return this._jointMatrices||(this._transformTexture?this._jointMatrices=new Float32Array(2048):this._jointMatrices=new Float32Array(16*this.joints.length)),this.joints.forEach((e,t)=>{let r=e.getAnimatedTransform();this._jointMatrices.set(r,16*t)}),this._jointMatrices}setRootMatrix(e){this._rootMatrix=n.mat4.clone(e)}addJoint(e){this.joints.push(e)}getRoot(){return this._rootJoint}addAnimation(e){this._animations.push(e)}getAnimations(){return this._animations}doAnimation(e){this._animator.doAnimation(e)}update(){this._animator.update(),this.updateJointMatrices()}}},"./03scene/camera/m3d_base_camera.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/Environment.ts"),n=(r("./00utility/m3d_math.js"),r("./glMatrix.js"));t.default=function(){function e(e){if(arguments.length<1)throw new Error("BaseCamera requires viewport.");this._at=[0,0,0],this._theta=Math.PI,this._phi=0,this._distance=15,this._firstPerson=!1,this._fov=46,this._invTanFov=1/Math.tan(.00872665*this._fov),this._znear=.1,this._zfar=1e3,this._perspective=!0,this._twoPointsPerpective=!1,this._yVanishFactor=1,this._height=1,this.viewport=n.vec4.create(),this.viewMatrix=n.mat4.create(),this.projectMatrix=n.mat4.create(),this.vpMatrix=n.mat4.create(),this.eye=new Float32Array([15,0,0,1]),this.viewport[0]=e[0],this.viewport[1]=e[1],this.viewport[2]=e[2],this.viewport[3]=e[3],e[3]<1&&(e[3]=1),this._aspect=e[2]/e[3],n.mat4.perspective(this.projectMatrix,this._fov*Math.PI/180,this._aspect,this._znear,this._zfar),n.mat4.identity(this.viewMatrix),this.uniformBlock=new Float32Array(36)}e.prototype.destroy=function(){this.viewport=null,delete this.viewport,this.viewMatrix=null,delete this.viewMatrix,this.projectMatrix=null,delete this.projectMatrix,this.vpMatrix=null,delete this.vpMatrix,this._at=null,delete this._at,this.eye=null,delete this.eye},e.prototype.update=function(){var t,r,i=Math.sin(this._phi),a=Math.cos(this._phi),s=Math.sin(this._theta),o=Math.cos(this._theta),l=this.viewMatrix;l[2]=a*o,l[6]=a*s,this._yVanishFactor=i,this._firstPerson&&(l[2]=-l[2],l[6]=-l[6],this._yVanishFactor=-this._yVanishFactor),Math.abs(this._phi)>=.499999*Math.PI?(l[0]=o*this._yVanishFactor,l[4]=s*this._yVanishFactor,l[8]=-s*l[6]-o*l[2]):(l[0]=-l[6],l[4]=l[2],l[8]=0),(t=e.prototype._length.call(this,l[0],l[4],l[8]))>0&&(r=1/t,l[0]*=r,l[4]*=r,l[8]*=r),l[1]=-this._yVanishFactor*l[4],l[5]=this._yVanishFactor*l[0],l[9]=l[2]*l[4]-l[6]*l[0],(t=e.prototype._length.call(this,l[1],l[5],l[9]))>0&&(r=1/t,l[1]*=r,l[5]*=r,l[9]*=r),this._twoPointsPerpective?(l[8]=0,l[9]=1,l[10]=0,l[11]=0):l[10]=this._yVanishFactor,this._firstPerson?(this._at[0]=this.eye[0]-l[2]*this._distance,this._at[1]=this.eye[1]-l[6]*this._distance,this._at[2]=this.eye[2]-this._yVanishFactor*this._distance):(this.eye[0]=this._at[0]+l[2]*this._distance,this.eye[1]=this._at[1]+l[6]*this._distance,this.eye[2]=this._at[2]+this._yVanishFactor*this._distance),l[12]=-(l[0]*this.eye[0]+l[4]*this.eye[1]+l[8]*this.eye[2]),l[13]=-(l[1]*this.eye[0]+l[5]*this.eye[1]+l[9]*this.eye[2]),l[14]=-(l[2]*this.eye[0]+l[6]*this.eye[1]+this._yVanishFactor*this.eye[2]),n.mat4.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},e.prototype.cull=function(){return!1},e.prototype.setViewport=function(e){var t=e[2],r=e[3];if((t>8192||r>8192)&&(t>=r?(r=Math.floor(8192*r/t),t=8192):(t=Math.floor(8192*t/r),r=8192)),r<1&&(r=1),e[0]!==this.viewport[0]||e[1]!==this.viewport[1]||t!==this.viewport[2]||r!==this.viewport[3]){if(this.viewport[0]=e[0],this.viewport[1]=e[1],this.viewport[2]=t,this.viewport[3]=r,r<1&&(r=1),this._aspect=t/r,this._perspective)this.projectMatrix[0]=this._invTanFov/this._aspect,this.projectMatrix[5]=this._invTanFov;else{var i=this._height*this._aspect,a=this._height;this.projectMatrix[0]=1/i,this.projectMatrix[5]=1/a}n.mat4.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)}},e.prototype.isPerspective=function(){return this._perspective},e.prototype.setPerspective=function(e){if(this._perspective!==e){if(this._perspective=e,this._perspective)this.projectMatrix[1]=this.projectMatrix[2]=this.projectMatrix[3]=this.projectMatrix[4]=this.projectMatrix[6]=this.projectMatrix[7]=this.projectMatrix[8]=this.projectMatrix[9]=this.projectMatrix[12]=this.projectMatrix[13]=this.projectMatrix[15]=0,this.projectMatrix[11]=-1,this.projectMatrix[0]=this._invTanFov/this._aspect,this.projectMatrix[5]=this._invTanFov;else{this.projectMatrix[1]=this.projectMatrix[2]=this.projectMatrix[3]=this.projectMatrix[4]=this.projectMatrix[6]=this.projectMatrix[7]=this.projectMatrix[8]=this.projectMatrix[9]=this.projectMatrix[11]=0,this.projectMatrix[12]=0,this.projectMatrix[13]=0,this.projectMatrix[15]=1;var t=this._height*this._aspect,r=this._height;this.projectMatrix[0]=1/t,this.projectMatrix[5]=1/r}n.mat4.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)}},e.prototype._setFov=function(e){this._fov!==e&&(this._fov=e,this._invTanFov=1/Math.tan(.00872665*this._fov),this._perspective&&(this.projectMatrix[0]=this._invTanFov/this._aspect,this.projectMatrix[5]=this._invTanFov))},e.prototype._setHeight=function(e){if(this._height!==e&&(this._height=e,!this._perspective)){var t=this._height*this._aspect,r=this._height;this.projectMatrix[0]=1/t,this.projectMatrix[5]=1/r}},e.prototype._updateProjection=function(e,t){var r;this._znear=e||this._znear,this._zfar=t||this._zfar,this._perspective?(r=1/(this._znear-this._zfar),this.projectMatrix[10]=(this._zfar+this._znear)*r,this.projectMatrix[14]=2*this._zfar*this._znear*r):(r=1/(this._znear-this._zfar),this.projectMatrix[10]=2*r,this.projectMatrix[14]=(this._znear+this._zfar)*r),n.mat4.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},e.prototype.reset=function(){this._firstPerson=!1,this._theta=Math.PI,this._phi=0,this._distance=15,this._fov=46,this._invTanFov=1/Math.tan(.00872665*this._fov),this._perspective=!0,n.mat4.perspective(this.projectMatrix,this._fov*Math.PI/180,this._aspect,this._znear,this._zfar),this._at[0]=0,this._at[1]=0,this._at[2]=0,this.eye[0]=-this._distance,this.eye[1]=0,this.eye[2]=0},e.prototype.resetDefaultCam=function(){if(this._defaultCameraInfo.height&&!this._defaultCameraInfo.fov)return console.warn("Reset camera info can't be ortho."),!1;this._firstPerson=!1;var e=this._defaultCameraInfo.phi;e>=.49999*Math.PI&&(e=.49999*Math.PI),e<=-.49999*Math.PI&&(e=-.49999*Math.PI);var t=this._defaultCameraInfo.theta;(t%=2*Math.PI)>Math.PI?t-=2*Math.PI:t<-Math.PI&&(t+=2*Math.PI),this._theta=t,this._phi=e,this._distance=this._defaultCameraInfo.distance,this._fov=this._defaultCameraInfo.fov,this._invTanFov=1/Math.tan(.00872665*this._fov),this._perspective=!0,this._at=this._defaultCameraInfo.at;var r=Math.sin(this._phi),i=Math.cos(this._phi),n=Math.sin(this._theta),a=Math.cos(this._theta);this.eye[0]=this._at[0]+i*a*this._distance,this.eye[1]=this._at[1]+i*n*this._distance,this.eye[2]=this._at[2]+r*this._distance,this._updateProjection();if(this._defaultCameraInfo.theta-this._targetTheta<1e-4&&this._defaultCameraInfo.phi-this._targetPhi<1e-4&&this._defaultCameraInfo.distance-this._targetDistance<1e-4){var s=this._defaultCameraInfo.at[0]-this._targetAt[0],o=this._defaultCameraInfo.at[1]-this._targetAt[1],l=this._defaultCameraInfo.at[2]-this._targetAt[2];Math.sqrt(s*s+o*o+l*l)<=1e-4&&(this._distance+=3*1e-4)}return!0},e.prototype.unproject=function(e,t,r){var n=[0,0,0],a=[0,0,0];e=Math.floor(e*i.Environment.devicePixelRatio),t=Math.floor(t*i.Environment.devicePixelRatio);var s,o=this.viewport[2]-this.viewport[0],l=this.viewport[3]-this.viewport[1];s=void 0!==r?r:this._znear;var d,u,c=e/o*2-1,h=(l-1-t)/l*2-1;return this._perspective?(d=c*s/this.projectMatrix[0],u=h*s/this.projectMatrix[5]):(d=(c-this.projectMatrix[12])/this.projectMatrix[0],u=(h-this.projectMatrix[13])/this.projectMatrix[5]),n[0]=this.eye[0]-this.viewMatrix[2]*s,n[1]=this.eye[1]-this.viewMatrix[6]*s,n[2]=this.eye[2]-this.viewMatrix[10]*s,a[0]=n[0]+d*this.viewMatrix[0]+u*this.viewMatrix[1],a[1]=n[1]+d*this.viewMatrix[4]+u*this.viewMatrix[5],a[2]=n[2]+d*this.viewMatrix[8]+u*this.viewMatrix[9],a},e.prototype.project=function(e,t){var r=n.vec4.fromValues();null!=t?n.vec3.transformMat4(r,e,t):(r[0]=e[0],r[1]=e[1],r[2]=e[2]),r[3]=1;var a=n.vec4.fromValues();n.vec4.transformMat4(a,r,this.vpMatrix),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];var s=this.viewport[3]-this.viewport[1],o=(a[0]+1)/2*this.viewport[2]+this.viewport[0],l=(a[1]+1)/2*s;return[o/=i.Environment.devicePixelRatio,l=(s-1-l)/i.Environment.devicePixelRatio,Math.sign(r[3])]},e.prototype.setFirstPerson=function(e){this._firstPerson!==e&&(this._theta=Math.PI+this._theta,this._phi=-this._phi,this._firstPerson=e)},e.prototype._length=function(e,t,r){return Math.sqrt(e*e+t*t+r*r)};var t=new Float32Array([0,0,0,0]);e.prototype.getViewDirection=function(){return t[0]=-this.viewMatrix[2],t[1]=-this.viewMatrix[6],t[2]=-this.viewMatrix[10],t},e.prototype.jitter=function(e,t){this._perspective?(this.projectMatrix[8]+=2*e,this.projectMatrix[9]+=2*t):(this.projectMatrix[12]+=2*e,this.projectMatrix[13]+=2*t),n.mat4.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},e.prototype.getNearPlaneSize=function(){if(this._perspective){var e=Math.tan(.017453293*this._fov*.5)*this._znear;return[e*this._aspect,e,-this._znear]}return[1/this.projectMatrix[0],1/this.projectMatrix[5],1]},e.prototype.getFarPlaneSize=function(){if(this._perspective){var e=Math.tan(.017453293*this._fov*.5)*this._zfar;return[e*this._aspect,e,-this._zfar]}return[1/this.projectMatrix[0],1/this.projectMatrix[5],1]},e.prototype.transformPerspectiveToOrthogonal=function(){if(this._perspective){var e=this.getFarPlaneSize();this.setPerspective(!1),this._setHeight(e[1]),this._distance+=3e-4}},e.prototype.shootRay=function(e,t,r,i){var a=this.unproject(e,t);this._perspective?(r[0]=this.eye[0],r[1]=this.eye[1],r[2]=this.eye[2],i[0]=a[0]-r[0],i[1]=a[1]-r[1],i[2]=a[2]-r[2]):(r[0]=a[0],r[1]=a[1],r[2]=a[2],i[0]=-this.viewMatrix[2],i[1]=-this.viewMatrix[6],i[2]=-this.viewMatrix[10]),n.vec3.normalize(i,i)},e.prototype.transformOrthogonalToPerspective=function(){this._perspective||(this.setPerspective(!0),this._distance+=15e-5)},e.prototype.copy=function(e){this._at[0]=e._at[0],this._at[1]=e._at[1],this._at[2]=e._at[2],this._theta=e._theta,this._phi=e._phi,this._distance=e._distance,this._firstPerson=e._firstPerson,this._fov=e._fov,this._invTanFov=e._invTanFov,this._znear=e._znear,this._zfar=e._zfar,this._aspect=e._aspect,this._perspective=e._perspective,this._height=e._height,n.vec4.copy(this.viewport,e.viewport),n.mat4.copy(this.viewMatrix,e.viewMatrix),n.mat4.copy(this.projectMatrix,e.projectMatrix),n.mat4.copy(this.vpMatrix,e.vpMatrix),n.vec4.copy(this.eye,e.eye)};var r=new Array(5);return e.prototype.split=function(e,t){for(var i=this._znear,a=this._zfar,s=i,o=.1*(a-i),l=1;l<e;l++){var d=l/e,u=.5*(i*Math.pow(a/i,d)+i+Math.pow(a-i,d))+o;(c=t[l-1]).copy(this),c._updateProjection(s,u),n.mat4.multiply(c.vpMatrix,c.projectMatrix,c.viewMatrix),s=u,r[l-1]=u}var c;return(c=t[e-1]).copy(this),c._updateProjection(s,a),n.mat4.multiply(c.vpMatrix,c.projectMatrix,c.viewMatrix),r},e.prototype.enabledTwoPointsPerspective=function(t){t&&this.setPerspective(!0),this._twoPointsPerpective=t,e.prototype.update.call(this)},e}()},"./03scene/camera/m3d_camera_animator.js":function(e,t,r){"use strict";r.r(t),t.default=function(){function e(e){this.name=e,this._camera=null,this._saved=null}return e.prototype.destroy=function(){this._camera=null,delete this._camera},e.prototype.attach=function(e,t){this._camera=e,(null==this._saved||t)&&(this._saved=this._camera.animator,this._camera.animator=this)},e.prototype.detach=function(e){this._camera.animator=this._saved,this._saved=null,this._camera=null},e.prototype.update=function(){},e.prototype._onStart=function(){},e.prototype._onEnd=function(){},e}()},"./03scene/camera/m3d_camera_animator_morphing.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/m3d_math.js"),n=r("./03scene/camera/m3d_camera_animator.js"),a=r("./03scene/camera/m3d_base_camera.js");t.default=function(){function e(e){n.default.apply(this,["morphing"]),this._speed=0,this._eventEmitter=e}return e.prototype=Object.create(n.default.prototype),e.prototype.constructor=e,e.prototype.update=function(){var e=this._camera;return Math.abs(e._targetFov-e._fov)<Math.abs(this._speed)?(a.default.prototype._setFov.apply(e,[e._targetFov]),a.default.prototype.update.apply(e,arguments),e._cull.update(),this.detach(),this._eventEmitter&&this._eventEmitter.emit("Tour360-MorphingOver"),!1):(a.default.prototype._setFov.apply(e,[e._fov+this._speed]),a.default.prototype.update.apply(e,arguments),e._cull.update(),!0)},e.prototype.start=function(e,t,r,n){var a=this._camera;e&&(a._phi=a._targetPhi=e),t&&(a._theta=a._targetTheta=t),null!=r&&(r=i.default.clamp(r,1,170),a._fov=r),n&&(a._targetFov=n),this._fovDiff=a._targetFov-a._fov,this._speed=(a._targetFov-a._fov)/50},e.prototype.getProgress=function(){var e=this._camera;return(e._targetFov-e._fov)/this._fovDiff},e}()},"./03scene/camera/m3d_camera_animator_navigate.js":function(e,t,r){"use strict";r.r(t);var i=r("./03scene/camera/m3d_base_camera.js"),n=r("./03scene/camera/m3d_camera_animator.js"),a=r("./glMatrix.js");t.default=function(){function e(){n.default.apply(this,["navigate"])}return e.prototype=Object.create(n.default.prototype),e.prototype.constructor=e,e.prototype.update=function(){var e=this._camera;e.eye[0]+=.15*(e._targetEye[0]-e.eye[0]),e.eye[1]+=.15*(e._targetEye[1]-e.eye[1]),e.eye[2]+=.15*(e._targetEye[2]-e.eye[2]),e._at[0]+=.15*(e._targetAt[0]-e._at[0]),e._at[1]+=.15*(e._targetAt[1]-e._at[1]),e._at[2]+=.15*(e._targetAt[2]-e._at[2]),e._distance=a.vec3.distance(e.eye,e._at),a.mat4.lookAt(e.viewMatrix,e.eye,e._at,[0,0,1]);var t=e._targetFov-e._fov;return i.default.prototype._setFov.apply(e,[e._fov+.15*t]),e._updateProjection(),a.mat4.multiply(e.vpMatrix,e.projectMatrix,e.viewMatrix),e._cull.update(),!0},e.prototype.stop=function(e){var t=this._camera;if(!e){if(!t)return;var r=a.vec3.distance(t.eye,t._targetEye)>.001||a.vec3.distance(t._at,t._targetAt)>.001||Math.abs(t._targetFov-t._fov)>.001,i=this;if(r)return void window.setTimeout(function(){i.stop()},100)}t._distance=t._targetDistance;var n=t.eye[0]-t._at[0],s=t.eye[1]-t._at[1],o=t.eye[2]-t._at[2];t._targetPhi=t._phi=Math.asin(Math.min(o/t._targetDistance,1)),t._targetPhi>=.49999*Math.PI&&(t._targetPhi=.49999*Math.PI),t._targetPhi<=-.49999*Math.PI&&(t._targetPhi=-.49999*Math.PI),t._targetTheta=t._theta=Math.atan2(s,n),t._firstPerson&&(t._targetPhi=t._phi=-t._targetPhi,t._targetTheta=t._theta=t._targetTheta+Math.PI),this.detach()},e.prototype.start=function(e,t,r,i,n){var a=this._camera,s=t[0]-e[0],o=t[1]-e[1],l=t[2]-e[2],d=Math.sqrt(s*s+o*o+l*l);if(d>1e-6?(a._targetAt[0]=t[0],a._targetAt[1]=t[1],a._targetAt[2]=t[2]):(s=a._targetAt[0]-e[0],o=a._targetAt[1]-e[1],l=a._targetAt[2]-e[2],d=Math.sqrt(s*s+o*o+l*l)),a._targetEye[0]=e[0],a._targetEye[1]=e[1],a._targetEye[2]=e[2],r&&(a._targetTheta=r),i&&(a._targetPhi=i),n&&a.setTargetFov(n),a._targetDistance=d,d<.001*a._scene.radius){var u=.001*a._scene.radius/d;a._targetDistance=.001*a._scene.radius,a._targetAt[0]=u*s+a._targetEye[0],a._targetAt[1]=u*o+a._targetEye[1],a._targetAt[2]=u*l+a._targetEye[2]}},e}()},"./03scene/camera/m3d_camera_animator_normal.js":function(e,t,r){"use strict";r.r(t);var i=r("./03scene/camera/m3d_base_camera.js"),n=r("./03scene/camera/m3d_camera_animator.js");t.default=function(){function e(){n.default.apply(this,["normal"]),this._updateThreshold=1e-4,this._acceleration=.15}return e.prototype=Object.create(n.default.prototype),e.prototype.constructor=e,e.prototype.update=function(){var e,t=this._camera,r=t._targetDistance-t._distance,n=t._targetTheta-t._theta,a=t._targetPhi-t._phi,s=t._targetFov-t._fov,o=0;if(!t._firstPerson){var l=t._targetAt[0]-t._at[0],d=t._targetAt[1]-t._at[1],u=t._targetAt[2]-t._at[2];t._at[0]+=l*this._acceleration,t._at[1]+=d*this._acceleration,t._at[2]+=u*this._acceleration,o=Math.abs(l)+Math.abs(d)+Math.abs(u)}var c=Math.abs(n)+Math.abs(a)>1e-4,h=Math.abs(r)+o>this._updateThreshold,m=Math.abs(s)>1e-4;return(e=c||h||m)&&(t._distance+=r*this._acceleration,t._theta+=n*this._acceleration,t._phi+=a*this._acceleration,t._phi>=.499999*Math.PI&&(t._phi=.499999*Math.PI),t._phi<=-.499999*Math.PI&&(t._phi=-.499999*Math.PI),i.default.prototype._setFov.apply(t,[t._fov+s*this._acceleration]),i.default.prototype.update.apply(t,arguments),t._scene&&t._updateProjection(),t._cull.update()),e},e}()},"./03scene/camera/m3d_camera_animator_panorama.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/m3d_interpolator.js"),n=r("./03scene/camera/m3d_camera_animator.js"),a=r("./glMatrix.js");t.default=function(){function e(e){n.default.apply(this,["panorama"]),this._srcAt=a.vec3.create(),this._dstAt=a.vec3.create(),this._srcTheta=0,this._dstTheta=0,this._srcPhi=0,this._dstPhi=0,this._curTheta=0,this._curPhi=0,this._eventEmitter=e,this._startTime=0,this._duration=0,this._speed=15}return e.prototype=Object.create(n.default.prototype),e.prototype.constructor=e,e.prototype.update=function(){var e=(new Date).getTime()-this._startTime;if(e>=this._duration)return e>3*this._duration?(this.stop(),this._eventEmitter&&this._eventEmitter.emit("Tour360-TransitionOver")):this._updateCamera(this._dstTheta,this._dstPhi)||(this.stop(),this._eventEmitter&&this._eventEmitter.emit("Tour360-TransitionOver")),!0;var t=e/this._duration;return this._curPhi=i.default.linear.scalar(this._srcPhi,this._dstPhi,t),this._curTheta=i.default.linear.scalar(this._srcTheta,this._dstTheta,t),this._updateCamera(this._curTheta,this._curPhi)},e.prototype.stop=function(){var e=this._camera;e._targetDistance=e._distance;var t=e.eye[0]-e._at[0],r=e.eye[1]-e._at[1],i=e.eye[2]-e._at[2];e._targetPhi=e._phi=Math.asin(Math.min(i/e._targetDistance,1)),e._targetPhi>=.49999*Math.PI&&(e._targetPhi=.49999*Math.PI),e._targetPhi<=-.49999*Math.PI&&(e._targetPhi=-.49999*Math.PI),e._targetTheta=e._theta=Math.atan2(r,t),e._firstPerson&&(e._targetPhi=e._phi=-e._targetPhi,e._targetTheta=e._theta=e._targetTheta+Math.PI),this.detach()},e.prototype.start=function(e){var t=this._camera;a.vec3.normalize(t._at,t._at),a.vec3.scale(t._at,t._at,15);var r=Math.atan2(t._at[1],t._at[0]);r<0&&(r+=2*Math.PI),t._targetTheta=t._theta=r,a.vec3.copy(this._srcAt,t._at);var i=a.vec3.clone(e);a.vec3.normalize(i,i),a.vec3.scale(i,i,15),a.vec3.copy(this._dstAt,i),this._srcTheta=t._theta,this._srcPhi=t._phi,this._dstTheta=Math.atan2(i[1],i[0]),this._dstTheta<0&&(this._dstTheta+=2*Math.PI);var n,s,o=this._dstTheta-this._srcTheta;Math.abs(o)>Math.PI&&(this._dstTheta-=2*Math.PI*Math.sign(o)),this._dstPhi=Math.asin(Math.min(i[2]/15,1)),this._dstPhi>=.49999*Math.PI&&(this._dstPhi=.49999*Math.PI),this._dstPhi<=-.49999*Math.PI&&(this._dstPhi=-.49999*Math.PI),n=Math.abs(this._srcTheta-this._dstTheta),s=Math.abs(this._srcPhi-this._dstPhi),n=Math.ceil(n/Math.PI*90),s=Math.ceil(s/Math.PI*90);var l=Math.max(n,s);return this._duration=l*this._speed,this._startTime=(new Date).getTime(),!0},e.prototype._updateCamera=function(e,t){var r=this._camera,i=Math.sin(t),n=Math.cos(t),s=Math.sin(e),o=Math.cos(e);r._targetAt[0]=n*o*r._distance,r._targetAt[1]=n*s*r._distance,r._targetAt[2]=i*r._distance,r._targetTheta=e,r._targetPhi=t;r._targetTheta,r._theta,r._targetPhi,r._phi;var l=r._targetEye[0]-r.eye[0],d=r._targetEye[1]-r.eye[1],u=r._targetEye[2]-r.eye[2],c=r._targetAt[0]-r._at[0],h=r._targetAt[1]-r._at[1],m=r._targetAt[2]-r._at[2],f=Math.abs(l)+Math.abs(d)+Math.abs(u)+Math.abs(c)+Math.abs(h)+Math.abs(m)>1e-4;return r.eye[0]+=.15*l,r.eye[1]+=.15*d,r.eye[2]+=.15*u,r._at[0]+=.15*c,r._at[1]+=.15*h,r._at[2]+=.15*m,r._distance=a.vec3.distance(r.eye,r._at),a.mat4.lookAt(r.viewMatrix,r.eye,r._at,[0,0,1]),a.mat4.multiply(r.vpMatrix,r.projectMatrix,r.viewMatrix),f},e.prototype.setTransitionSpeed=function(e){this._speed=e},e}()},"./03scene/camera/m3d_camera_animator_transition.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/Environment.ts"),n=r("./00utility/m3d_interpolator.js"),a=r("./03scene/camera/m3d_camera_animator.js"),s=r("./03scene/camera/m3d_base_camera.js"),o=r("./glMatrix.js");t.default=function(){function e(e){a.default.apply(this,["transition"]),this._srcAt=o.vec3.create(),this._srcEye=o.vec3.create(),this._dstAt=o.vec3.create(),this._dstEye=o.vec3.create(),this._curAt=o.vec3.create(),this._curEye=o.vec3.create(),this._eventEmitter=e,this._srcTheta=0,this._dstTheta=0,this._srcPhi=0,this._dstPhi=0,this._curTheta=0,this._curPhi=0,this._srcDistance=0,this._dstDistance=0,this._startTime=0,this._duration=0,this._speed=15,this._isPano=!1}return e.prototype=Object.create(a.default.prototype),e.prototype.constructor=e,e.prototype.update=function(){var e=(new Date).getTime()-this._startTime;if(e>=this._duration)return e>3*this._duration?(this._eventEmitter&&(this._eventEmitter.emit("Comment-TransitionOver"),this._eventEmitter.emit("Camera-TransitionOver")),this.stop()):this._updateCamera(this._dstEye,this._dstAt,this._dstTheta,this._dstPhi)||(this._eventEmitter&&(this._eventEmitter.emit("Comment-TransitionOver"),this._eventEmitter.emit("Camera-TransitionOver")),this.stop()),!0;var t=e/this._duration;return t=Math.sin(t*Math.PI-Math.PI/2)/2+.5,n.default.linear.vec3(this._curAt,this._srcAt,this._dstAt,t),n.default.linear.vec3(this._curEye,this._srcEye,this._dstEye,t),this._curPhi=n.default.linear.scalar(this._srcPhi,this._dstPhi,t),this._curTheta=n.default.linear.scalar(this._srcTheta,this._dstTheta,t),o.vec3.distance(this._curEye,this._curAt)>.001&&this._updateCamera(this._curEye,this._curAt,this._curTheta,this._curPhi)},e.prototype.stop=function(){var e=this._camera;e._targetDistance=e._distance;var t=e.eye[0]-e._at[0],r=e.eye[1]-e._at[1],i=e.eye[2]-e._at[2];e._targetPhi=e._phi=Math.asin(Math.min(i/e._targetDistance,1)),e._targetPhi>=.49999*Math.PI&&(e._targetPhi=.49999*Math.PI),e._targetPhi<=-.49999*Math.PI&&(e._targetPhi=-.49999*Math.PI),e._targetTheta=e._theta=Math.atan2(r,t),e._firstPerson&&(e._targetPhi=e._phi=-e._targetPhi,e._targetTheta=e._theta=e._targetTheta+Math.PI),this.detach()},e.prototype.start=function(e,t,r){var i=this._camera;return t&&i.restore(e),this._setStartPoint(i._at,i.eye,i._distance,e.at,i._theta,i._phi),t||i.restore(e),this._setEndPoint(i._targetDistance,i._targetTheta,i._targetPhi,i._firstPerson,i._scene?i._scene.radius:100,r),o.vec3.copy(i._at,this._srcAt),o.vec3.copy(i.eye,this._srcEye),t?(this._updateCamera(this._dstEye,this._dstAt,this._dstTheta,this._dstPhi),!0):(this._startTime=(new Date).getTime(),this._updateCamera(this._srcEye,this._srcAt,this._srcTheta,this._srcPhi),!0)},e.prototype.startPano=function(e){var t,r,i=this._camera;this._isPano=!0,o.vec3.normalize(e,e),o.vec3.scale(e,e,15),o.vec3.copy(this._srcAt,i._at),o.vec3.copy(this._srcEye,i.eye),this._srcDistance=o.vec3.distance(i.eye,i._at),o.vec3.copy(this._dstAt,e),this._srcTheta=i._theta,this._srcPhi=i._phi,this._dstDistance=o.vec3.distance(i.eye,e),this._dstTheta=i._theta,this._dstPhi=i._phi,o.vec3.copy(this._dstEye,i.eye),t=o.vec3.distance(this._srcAt,this._dstAt),r=Math.abs(this._srcDistance-this._dstDistance);t=Math.ceil(t/100*450),r=Math.ceil(r/100*450);var n=Math.max(t,r);return n=Math.min(Math.max(n,1),266),this._duration=n*this._speed,this._startTime=(new Date).getTime(),this._updateCamera(this._srcEye,this._srcAt,this._srcTheta,this._srcPhi),!0},e.prototype._setStartPoint=function(e,t,r,i,n,a){o.vec3.copy(this._srcAt,e),o.vec3.copy(this._srcEye,t),this._srcDistance=r,o.vec3.copy(this._dstAt,i),this._srcTheta=n,this._srcPhi=a},e.prototype._setEndPoint=function(e,t,r,n,a,s){var l,d,u;this._dstDistance=e,this._dstTheta=t,this._dstPhi=r;var c,h,m,f,p,v=Math.sin(this._dstPhi),_=Math.cos(this._dstPhi),g=Math.sin(this._dstTheta);l=_*Math.cos(this._dstTheta),d=_*g,u=v,n&&(l=-l,d=-d,u=-u),this._dstEye[0]=this._dstAt[0]+l*this._dstDistance,this._dstEye[1]=this._dstAt[1]+d*this._dstDistance,this._dstEye[2]=this._dstAt[2]+u*this._dstDistance,c=o.vec3.distance(this._srcAt,this._dstAt),h=o.vec3.distance(this._srcEye,this._dstEye),m=Math.abs(this._srcDistance-this._dstDistance),f=Math.abs(this._srcTheta-this._dstTheta),p=Math.abs(this._srcPhi-this._dstPhi);var b=i.Environment.isMobile?300:450,y=s||266;c=Math.ceil(c/a*b),h=Math.ceil(h/a*b),m=Math.ceil(m/a*b),f=Math.ceil(f/Math.PI*90),p=Math.ceil(p/Math.PI*90);var x=Math.max(m,Math.max(c,h));x=Math.max(x,Math.max(f,p)),x=Math.min(Math.max(x,1),y),this._duration=x*this._speed},e.prototype._updateCamera=function(e,t,r,i){var n=this._camera;n._targetAt[0]=t[0],n._targetAt[1]=t[1],n._targetAt[2]=t[2],n._targetEye[0]=e[0],n._targetEye[1]=e[1],n._targetEye[2]=e[2],r&&(n._targetTheta=r),i&&(n._targetPhi=i);var a=n._targetAt[0]-n._targetEye[0],l=n._targetAt[1]-n._targetEye[1],d=n._targetAt[2]-n._targetEye[2],u=Math.sqrt(a*a+l*l+d*d);n._targetDistance=u;var c=n._scene?n._scene.radius:100;if(u<.001*c){var h=.001*c/u;n._targetDistance=.001*c,n._targetAt[0]=h*a+n._targetEye[0],n._targetAt[1]=h*l+n._targetEye[1],n._targetAt[2]=h*d+n._targetEye[2]}var m=n._targetFov-n._fov,f=n._targetTheta-n._theta,p=n._targetPhi-n._phi,v=n._targetEye[0]-n.eye[0],_=n._targetEye[1]-n.eye[1],g=n._targetEye[2]-n.eye[2],b=n._targetAt[0]-n._at[0],y=n._targetAt[1]-n._at[1],x=n._targetAt[2]-n._at[2],w=!1;Math.abs(1-Math.abs(n._targetPhi/(.49999*Math.PI)))<1e-4&&(w=!0);var E=Math.abs(f)+Math.abs(p)>1e-4,M=Math.abs(v)+Math.abs(_)+Math.abs(g)+Math.abs(b)+Math.abs(y)+Math.abs(x)>(w?6e-7:1e-4),A=Math.abs(m)>1e-4,T=E||M||A;return n.eye[0]+=.15*v,n.eye[1]+=.15*_,n.eye[2]+=.15*g,n._at[0]+=.15*b,n._at[1]+=.15*y,n._at[2]+=.15*x,n._distance=o.vec3.distance(n.eye,n._at),o.mat4.lookAt(n.viewMatrix,n.eye,n._at,[0,0,1]),s.default.prototype._setFov.apply(n,[n._fov+.15*m]),n._scene&&n._updateProjection(),o.mat4.multiply(n.vpMatrix,n.projectMatrix,n.viewMatrix),n._cull.update(),T},e.prototype.setTransitionSpeed=function(e){this._speed=e},e}()},"./03scene/camera/m3d_scene_camera.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/m3d_math.js"),n=r("./03scene/culling/m3d_cull.js"),a=r("./03scene/camera/m3d_base_camera.js"),s=r("./03scene/camera/m3d_camera_animator_normal.js"),o=r("./glMatrix.js");t.default=function(){o.vec3.create(),o.vec3.create();function e(e,t){a.default.apply(this,[t]),this._scene=e,this._targetAt=[0,0,0],this._targetEye=[0,0,0],this._targetFov=46,this._targetTheta=-Math.PI/4,this._targetPhi=Math.PI/18,this._targetDistance=15,this._initDistance=15,this._maxZoomOffset=.6,this._minZoomOffset=.15,this.animator=new s.default,this.animator.attach(this),this._cull=new n.default(this),this.updated=!0,this._prevUpdated=this.updated,this._updateStopListeners=[],this._minPitchAngle=-.499999*Math.PI,this._maxPitchAngle=.499999*Math.PI,this._maxTargetDistanceRatio=1/0,this._minTargetDistanceRatio=-1/0,this._minZnearRatio=.001,this._defaultCameraInfo=null}return e.prototype=Object.create(a.default.prototype),e.prototype.constructor=e,e.prototype.destroy=function(){this._cull.destroy(),this._cull=null,delete this._cull,this.animator.destroy(),this.animator=null,delete this.animator,this._targetAt=null,delete this._targetAt,this._targetEye=null,delete this._targetEye,this._updateStopListeners=null,delete this._updateStopListeners,a.default.prototype.destroy(this,arguments)},e.prototype.setDefaultCam=function(e){this._defaultCameraInfo=e},e.prototype.setMinPitchAngle=function(e){e=Math.max(e,-.499999*Math.PI),this._minPitchAngle=e},e.prototype.setMaxPitchAngle=function(e){e=Math.min(e,.499999*Math.PI),this._maxPitchAngle=e},e.prototype.setMaxTargetDistanceRatio=function(e){this._maxTargetDistanceRatio=e},e.prototype.setMinTargetDistanceRatio=function(e){this._minTargetDistanceRatio=e},e.prototype.setMinZnearRatio=function(e){this._minZnearRatio=e},e.prototype.setViewport=function(e){a.default.prototype.setViewport.call(this,e);for(var t=0;t<this._updateStopListeners.length;t++)this._updateStopListeners[t](this)},e.prototype.update=function(){if(this._prevUpdated=this.updated,this.updated=this.animator.update(),this._prevUpdated&&!this.updated)for(var e=0;e<this._updateStopListeners.length;e++)this._updateStopListeners[e](this);return this.updated},e.prototype.addUpdateStopListener=function(e){this._updateStopListeners.push(e)},e.prototype.removeUpdateStopListener=function(e){var t=this._updateStopListeners.indexOf(e);t>=0&&this._updateStopListeners.splice(t,1)},e.prototype.rotate=function(e,t){this._firstPerson&&(t=-t),this._targetTheta-=.006*e,this._targetPhi+=.006*t,this._targetPhi>=this._maxPitchAngle&&(this._targetPhi=this._maxPitchAngle),this._targetPhi<=this._minPitchAngle&&(this._targetPhi=this._minPitchAngle)},e.prototype.setCullingEnabled=function(e){this._cull.setEnabled(e),e&&this._cull.update()},e.prototype.setBimCullingEnabled=function(e){this._cull.setBimCullingEnabled(e),this.isBimCullingEnabled()&&this._cull.update()},e.prototype.isBimCullingEnabled=function(){return this._cull.isBimCullingEnabled()},e.prototype.setTargetFov=function(e){this._targetFov=e,this._targetFov>=179.9&&(this._targetFov=179.9),this._targetFov<=.1&&(this._targetFov=.1)},e.prototype.getTargetFov=function(){return this._targetFov},e.prototype.zoom=function(e,t,r){if(this._perspective){var i=Math.abs(e*this._targetDistance*.35);if(i=(e>0?1:-1)*Math.min(Math.max(i,this._minZoomOffset),this._maxZoomOffset),this._targetDistance<i){var n=this.getViewDirection();this._targetAt[0]+=n[0]*i,this._targetAt[1]+=n[1]*i,this._targetAt[2]+=n[2]*i}else this._targetDistance-=i,this._targetDistance>this._scene.radius*this._maxTargetDistanceRatio&&(this._targetDistance=this._scene.radius*this._maxTargetDistanceRatio),this._targetDistance<this._scene.radius*this._minTargetDistanceRatio&&(this._targetDistance=this._scene.radius*this._minTargetDistanceRatio)}else{var s=this._height*Math.max(1-.1*e*.35,1e-5);if(void 0!==t&&void 0!==r){var l=t/this.viewport[2],d=(this.viewport[3]-1-r)/this.viewport[3],u=-(this.projectMatrix[12]+1)/this.projectMatrix[0],c=-(this.projectMatrix[13]+1)/this.projectMatrix[5],h=u+2*this._height*this._aspect*l;c=c+2*this._height*d-2*d*s;var m=(u=h-l*s*2*this._aspect)+2*s*this._aspect,f=c+2*s;this._height=s,o.mat4.ortho(this.projectMatrix,u,m,c,f,this._znear,this._zfar)}else a.default.prototype._setHeight.call(this,s);this._targetDistance-=e>0?15e-5:-15e-5}},e.prototype.pan=function(e,t){var r=.001*this._targetDistance;this._targetAt[0]+=-e*this.viewMatrix[0]*r+t*this.viewMatrix[1]*r,this._targetAt[1]+=-e*this.viewMatrix[4]*r+t*this.viewMatrix[5]*r,this._targetAt[2]+=-e*this.viewMatrix[8]*r+t*this.viewMatrix[9]*r},e.prototype.forward=function(e,t){t||((t=this.getViewDirection())[2]=0);var r=t[0]*e*this._scene.radius,i=t[1]*e*this._scene.radius,n=t[2]*e*this._scene.radius;this._targetAt[0]+=r,this._targetAt[1]+=i,this._targetAt[2]+=n,this.eye[0]+=r,this.eye[1]+=i,this.eye[2]+=n},e.prototype._updateProjection=function(){var e=i.default.aabb.center(this._scene.bbox),t=this.viewMatrix[2]*e[0]+this.viewMatrix[6]*e[1]+this.viewMatrix[10]*e[2]+this.viewMatrix[14],r=-(t+this._scene.radius),n=-(t-this._scene.radius);this._perspective&&r<this._minZnearRatio*this._scene.radius&&(r=this._minZnearRatio*this._scene.radius),a.default.prototype._updateProjection.call(this,r,n)},e.prototype.reset=function(e,t){this.animator.stop&&this.animator.stop(),this.animator=new s.default,this.animator.attach(this),t?(this._targetAt=t.at,this._at[0]=this._targetAt[0],this._at[1]=this._targetAt[1],this._at[2]=this._targetAt[2],this._distance=this._targetDistance=t.distance,this.setTargetFov(t.fov),this.rotateTo(t.phi,t.theta),this._fov=this._targetFov,this._phi=this._targetPhi,this._theta=this._targetTheta,this._distance+=3*1e-4,this._initDistance=this._targetDistance,this._maxZoomOffset=.025*this._targetDistance,this._minZoomOffset=.0025*this._targetDistance,this.update()):(this._scene.clipping.isEnabled()?o.vec3.copy(this._targetAt,this._scene.clipping.getCenter()):this._targetAt=i.default.aabb.center(this._scene.bbox),this._targetDistance=this._getViewDistance(),this._initDistance=this._targetDistance,this._maxZoomOffset=.025*this._targetDistance,this._minZoomOffset=.0025*this._targetDistance,e&&(this._defaultCameraInfo&&a.default.prototype.resetDefaultCam.apply(this,arguments)||(this.rotateTo(Math.PI/18,-Math.PI/4),a.default.prototype.reset.apply(this,arguments),o.vec3.copy(this._at,this._targetAt))))},e.prototype.rotateTo=function(e,t){var r=t-this._theta;(r%=2*Math.PI)>Math.PI?r-=2*Math.PI:r<-Math.PI&&(r+=2*Math.PI),this._targetTheta=this._theta+r,this._targetPhi=e},e.prototype.lookTo=function(e,t){if(this._targetAt[0]=e[0],this._targetAt[1]=e[1],this._targetAt[2]=e[2],t)if(this._perspective)this._targetDistance=t/Math.sin(this._fov*Math.PI/360);else{var r=1.5*t;a.default.prototype._setHeight.call(this,r)}else{var i=this._targetAt[0]-this.eye[0],n=this._targetAt[1]-this.eye[1],s=this._targetAt[2]-this.eye[2];this._distance=Math.sqrt(i*i+n*n+s*s),this._targetDistance=Math.min(.35*this._scene.radius,this._distance)}},e.prototype.zoomTo=function(e,t,r){this._distance=e,this._targetDistance=t||e,r&&o.vec3.copy(this._targetAt,r)},e.prototype.zoomBy=function(e){if(!this._perspective){var t=this._height*e;a.default.prototype._setHeight.call(this,t),this._targetDistance-=e<1?15e-5:-15e-5}},e.prototype.dump=function(){var e,t;return this._firstPerson?(e=-this._targetPhi,t=this._targetTheta-Math.PI):(e=this._targetPhi,t=this._targetTheta),this._perspective?{fov:this._fov,distance:this._targetDistance,phi:e,theta:t,at:[this._at[0],this._at[1],this._at[2]]}:{height:this._height,distance:this._targetDistance,phi:e,theta:t,at:[this._at[0],this._at[1],this._at[2]]}},e.prototype.restore=function(e){var t=e.height?1.2*this._scene.radius:e.distance;Math.abs(t-this._targetDistance),Math.max(t,this._targetDistance);if(this._distance=this._targetDistance=t,e.phi>=.49999*Math.PI&&(e.phi=.49999*Math.PI),e.phi<=-.49999*Math.PI&&(e.phi=-.49999*Math.PI),this._firstPerson){Math.abs(-e.phi-this._targetPhi),this._phi=this._targetPhi=-e.phi;var r,i,n,s=e.theta+Math.PI-this._theta;(s%=2*Math.PI)>Math.PI?s-=2*Math.PI:s<-Math.PI&&(s+=2*Math.PI),Math.abs(this._theta+s-this._targetTheta),this._targetTheta=this._theta+s,this._theta=this._targetTheta;var o=Math.sin(this._targetPhi),l=Math.cos(this._targetPhi),d=Math.sin(this._targetTheta);r=l*Math.cos(this._targetTheta),i=l*d,n=o,this.eye[0]=e.at[0]-r*this._targetDistance,this.eye[1]=e.at[1]-i*this._targetDistance,this.eye[2]=e.at[2]-n*this._targetDistance}else{Math.abs(e.phi-this._targetPhi),this._phi=this._targetPhi=e.phi;s=e.theta-this._theta;(s%=2*Math.PI)>Math.PI?s-=2*Math.PI:s<-Math.PI&&(s+=2*Math.PI),Math.abs(this._theta+s-this._targetTheta),this._targetTheta=this._theta+s,this._theta=this._targetTheta}this._at[0]=this._targetAt[0]=e.at[0],this._at[1]=this._targetAt[1]=e.at[1],this._at[2]=this._targetAt[2]=e.at[2],e.height?(a.default.prototype._setHeight.call(this,e.height),a.default.prototype.setPerspective.call(this,!1)):a.default.prototype.setPerspective.call(this,!0),this._scene&&this._updateProjection(),a.default.prototype.update.apply(this,arguments),this._cull.update()},e.prototype.cull=function(e,t){return this._cull.isCulled(e,t)},e.prototype.setFirstPerson=function(e){this._firstPerson!==e&&(this._targetTheta=Math.PI+this._targetTheta,this._targetPhi=-this._targetPhi),e||(this._targetAt[0]=this._at[0],this._targetAt[1]=this._at[1],this._targetAt[2]=this._at[2],this._at[0]-=1e-6,this._at[1]-=1e-6,this._at[2]-=1e-6),a.default.prototype.setFirstPerson.apply(this,arguments)},e.prototype.isFirstPerson=function(){return this._firstPerson},e.prototype.isPerspective=function(){return this._perspective},e.prototype._getViewDistance=function(){var e=-Number.MAX_VALUE,t=1/Math.sin(.00872665*this._fov),r=t/Math.cos(.00872665*this._fov),i=Math.tan(.00872665*this._fov),n=this.getTargetViewDirection(),a=o.vec3.create(),s=o.vec3.create();let l=(e,l)=>{o.vec3.subtract(a,l.bsphere,this._targetAt);var d=o.vec3.dot(a,n);o.vec3.scaleAndAdd(s,this._targetAt,n,d);var u=o.vec3.distance(s,l.bsphere),c=l.bsphere[3],h=d+(u*r+c*t-u*i),m=1.05*Math.max(c,h);return Math.max(e,m)};for(var d in this._scene.models){const t=this._scene.models[d];if(t.visible)for(var u=0,c=t.drawables.length;u<c;u++)e=l(e,t.drawables[u])}for(var h in this._scene.pawns){const t=this._scene.pawns[h];for(u=0,c=t.drawables.length;u<c;u++)e=l(e,t.drawables[u])}if(this._scene.clipping.isEnabled()){var m=(f=this._scene.clipping.getRadius())*t;e=Math.min(e,1.05*Math.max(f,m))}if(e<0){var f;m=(f=this._scene.radius)*t;e=1.05*Math.max(f,m)}return e},e.prototype.getTargetViewDirection=function(){var e=Math.sin(this._targetPhi),t=Math.cos(this._targetPhi),r=Math.sin(this._targetTheta),i=Math.cos(this._targetTheta),n=o.vec3.create();return n[0]=-t*i,n[1]=-t*r,n[2]=-e,this._firstPerson&&(n[0]=-n[0],n[1]=-n[1],n[2]=-n[2]),n},e.prototype.setZoomMinMax=function(e){this._maxZoomOffset=.025*this._initDistance*e},e}()},"./03scene/camera/m3d_shadow_camera.js":function(e,t,r){"use strict";r.r(t);var i=r("./03scene/culling/m3d_cull.js"),n=r("./00utility/m3d_math.js"),a=r("./03scene/camera/m3d_base_camera.js"),s=r("./glMatrix.js");t.default=function(){function e(e,t){a.default.apply(this,[t]),this._scene=e,this._cull=new i.default(this),this._perspective=!1,s.mat4.ortho(this.projectMatrix,-1,1,-1,1,-100,100),s.mat4.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)}return e.prototype=Object.create(a.default.prototype),e.prototype.constructor=e,e.prototype.createFromLight=function(e,t,r){this._at=n.default.aabb.center(t),this._distance=n.default.aabb.length(t),this.eye=[],this.eye[0]=-e[0]*this._distance+this._at[0],this.eye[1]=-e[1]*this._distance+this._at[1],this.eye[2]=-e[2]*this._distance+this._at[2],r?s.mat4.lookAt(this.viewMatrix,this.eye,this._at,r):s.mat4.lookAt(this.viewMatrix,this.eye,this._at,[0,0,1]);var i=.505*this._distance,a=i,o=i;this._znear=this._distance-1.02*i,this._zfar=this._distance+1.02*i,this._height=o,this._aspect=1,this._perspective=!1,s.mat4.ortho(this.projectMatrix,-a,a,-o,o,this._znear,this._zfar),s.mat4.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},e.prototype.createFromLightTight=function(e,t,r){var i,a=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],o=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],l=s.vec3.create();for(i=0;i<r.length;i++)s.vec3.min(a,a,r[i]),s.vec3.max(o,o,r[i]);var d=n.default.aabb.create(a,o),u=n.default.aabb.points(d);s.vec3.lerp(this._at,a,o,.5),this._distance=n.default.aabb.length(t);var c=.505*this._distance;for(this.eye=[],this.eye[0]=-e[0]*this._distance+this._at[0],this.eye[1]=-e[1]*this._distance+this._at[1],this.eye[2]=-e[2]*this._distance+this._at[2],s.mat4.lookAt(this.viewMatrix,this.eye,this._at,[0,0,1]),a=[Number.MAX_VALUE,Number.MAX_VALUE],o=[-Number.MAX_VALUE,-Number.MAX_VALUE],i=0;i<u.length;i++)null!==u[i]&&(l[0]=this.viewMatrix[0]*u[i][0]+this.viewMatrix[4]*u[i][1]+this.viewMatrix[8]*u[i][2]+this.viewMatrix[12],l[1]=this.viewMatrix[1]*u[i][0]+this.viewMatrix[5]*u[i][1]+this.viewMatrix[9]*u[i][2]+this.viewMatrix[13],s.vec2.min(a,a,l),s.vec2.max(o,o,l));this._znear=this._distance-1.02*c,this._zfar=this._distance+1.02*c,this._aspect=1,this._perspective=!1,s.mat4.ortho(this.projectMatrix,a[0],o[0],a[1],o[1],this._znear,this._zfar),s.mat4.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},e.prototype.setCullingEnabled=function(e){this._cull.setEnabled(e),e&&this._cull.update()},e.prototype.setBimCullingEnabled=function(e){this._cull.setBimCullingEnabled(this._scene.isBimCullingNeeded&&e),this.isBimCullingEnabled()&&this._cull.update()},e.prototype.isBimCullingEnabled=function(){return this._scene.isBimCullingNeeded&&this._cull.isBimCullingEnabled()},e.prototype.cull=function(e,t){return this._cull.isCulled(e,t)},e}()},"./03scene/culling/m3d_bim_cull.js":function(e,t,r){"use strict";r.r(t),t.default=function(){function e(e){this._camera=e,this.enabled=!1}return e.prototype.update=function(){},e.prototype.isCulled=function(e,t){return!!this.enabled&&(e.hidables>0&&(t[1]=e.nodes[e.hidables].indicesOffset/e.mesh.indexSize),0===e.hidables)},e}()},"./03scene/culling/m3d_clip_cull.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/m3d_math.js");t.default=function(){function e(e){this._camera=e,this._scene=e._scene}return e.prototype.isCulled=function(e){if(!this._scene.clipping.isEnabled())return!1;var t=this._scene.clipping.get();return!!i.default.outside.aabb_aabb(e.bbox,t)},e}()},"./03scene/culling/m3d_cull.js":function(e,t,r){"use strict";r.r(t);var i=r("./03scene/culling/m3d_clip_cull.js"),n=r("./03scene/culling/m3d_zeroarea_cull.js"),a=r("./03scene/culling/m3d_frustum_cull.js"),s=r("./03scene/culling/m3d_bim_cull.js");t.default=function(){function e(e){this._clippingCull=new i.default(e),this._frustumCull=new a.default(e),this._zeroAreaCull=new n.default(e,this._frustumCull),this._bimCull=new s.default(e),this._enabled=!1}return e.prototype.destroy=function(){this._clippingCull=null,delete this._clippingCull,this._frustumCull=null,delete this._frustumCull,this._bimCull=null,delete this._bimCull,this._zeroAreaCull=null,delete this._zeroAreaCull},e.prototype.setEnabled=function(e){this._enabled=e},e.prototype.isCulled=function(e,t){return!!this._enabled&&!!(this._clippingCull.isCulled(e)||this._frustumCull.isCulled(e)||this._bimCull.isCulled(e,t)||this._zeroAreaCull.isCulled(e))},e.prototype.update=function(){this._enabled&&(this._frustumCull.update(),this._zeroAreaCull.update(),this._bimCull.update())},e.prototype.setBimCullingEnabled=function(e){this._bimCull.enabled=e},e.prototype.isBimCullingEnabled=function(){return this._bimCull.enabled},e}()},"./03scene/culling/m3d_frustum_cull.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/m3d_math.js");t.default=function(){function e(e){this._camera=e,this._scene=e._scene,this._frustum=i.default.frustum.createFromMatrix(e.vpMatrix),this._contain=!1,this._p=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],this._t=[0,0,0,0,0,0]}return e.prototype.isCulled=function(e){if(this._contain)return!1;var t=this._frustum,r=e.bbox;return r[this._p[0][0]]*t[0][0]+r[this._p[0][1]]*t[0][1]+r[this._p[0][2]]*t[0][2]>this._t[0]||r[this._p[1][0]]*t[1][0]+r[this._p[1][1]]*t[1][1]+r[this._p[1][2]]*t[1][2]>this._t[1]||r[this._p[2][0]]*t[2][0]+r[this._p[2][1]]*t[2][1]+r[this._p[2][2]]*t[2][2]>this._t[2]||r[this._p[3][0]]*t[3][0]+r[this._p[3][1]]*t[3][1]+r[this._p[3][2]]*t[3][2]>this._t[3]||r[this._p[4][0]]*t[4][0]+r[this._p[4][1]]*t[4][1]+r[this._p[4][2]]*t[4][2]>this._t[4]||r[this._p[5][0]]*t[5][0]+r[this._p[5][1]]*t[5][1]+r[this._p[5][2]]*t[5][2]>this._t[5]},e.prototype.update=function(){this._frustum=i.default.frustum.createFromMatrix(this._camera.vpMatrix);for(var e=0;e<6;e++)this._p[e][0]=this._frustum[e][0]>0?0:3,this._p[e][1]=this._frustum[e][1]>0?1:4,this._p[e][2]=this._frustum[e][2]>0?2:5,this._t[e]=-this._frustum[e][3];this._contain=i.default.inside.aabb_frustum(this._scene.bbox,this._frustum)},e}()},"./03scene/culling/m3d_zeroarea_cull.js":function(e,t,r){"use strict";r.r(t);r("./00utility/m3d_math.js");var i=r("./glMatrix.js");t.default=function(){function e(e){this._camera=e,this._scene=e._scene,this._threshold=new Float32Array(1)}e.prototype.update=function(e,t){var r=2/e,i=2/t;this._threshold=4*Math.min(r,i)};var t=[];t[0]=[0,0,0,0],t[1]=[0,0,0,0],t[2]=[0,0,0,0],t[3]=[0,0,0,0],t[4]=[0,0,0,0],t[5]=[0,0,0,0];var r=new Float32Array(3);return e.prototype.isCulled=function(e){if(!this._camera.isPerspective())return!1;var t=function(e,t){var n=e[3],a=t.projectMatrix[5];return i.vec3.subtract(r,e,t.eye),n*a/-(r[0]*t.viewMatrix[2]+r[1]*t.viewMatrix[6]+r[2]*t.viewMatrix[10])}(e.bsphere,this._camera);if(t>0&&t<this._threshold)return!0;if(e.meshRadius){var n=this._camera.projectMatrix[5];if(e.meshRadius*n/this._camera._distance<this._threshold)return!0}return!1},e}()},"./03scene/drawables/Billboard.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./03scene/drawables/Drawable.ts"),n=r("./03scene/drawables/BillboardTransform.ts"),a=r("./00utility/m3d_math.js");class s extends i.default{constructor(e,t,r,i,s){super(e,t,r,i,s),this.faceCamera=!0,this.transform=new n.default(i),this.bbox=a.default.aabb.createFromSphere(this.bsphere),this._center=a.default.aabb.center(this.bbox)}destroy(){this._center=null,delete this._center,super.destroy()}isShadowCaster(){return!0}update(e){this.transform.update(e,this._center)}setTranslation(e,t,r){super.setTranslation(e,t,r),this._center=a.default.aabb.center(this.bbox)}translate(e,t,r){super.translate(e,t,r),this._center=a.default.aabb.center(this.bbox)}clone(){var e=new s(this.mesh,this.shader,this.material.clone(this.material.name+"-cloned"),this.transform.matrix,this.bbox);return e.faceCamera=this.faceCamera,e.bsphere=this.bsphere,e.distance=this.distance,e.nodes=this.nodes,e.hidables=this.hidables,e.originalMaterial=this.originalMaterial,e._center=this._center,e}}},"./03scene/drawables/BillboardTransform.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/drawables/Transform.ts"),n=r("./glMatrix.js");n.vec3.fromValues(0,0,0),n.mat4.create();class a extends i.default{constructor(e){super(e),this._up=n.vec3.create(),this._forward=n.vec3.create(),this._right=n.vec3.create(),this._translate=n.vec3.create(),this._transformMatrix=n.mat4.create(),this.matrix&&(n.mat4.copy(this._transformMatrix,this.matrix),n.mat4.copy(this.matrix,this.matrix))}setTranslation(e,t,r){n.mat4.copy(this.matrix,this._transformMatrix),super.setTranslation(e,t,r),n.mat4.copy(this._transformMatrix,this.matrix)}setScaling(e,t,r){n.mat4.copy(this.matrix,this._transformMatrix),super.setScaling(e,t,r),n.mat4.copy(this._transformMatrix,this.matrix)}setFaceCameraZ(e){this._faceCameraZ=e}update(e,t){this._up=n.vec3.create(),this._forward=n.vec3.create(),this._right=n.vec3.create(),this._faceCameraZ?(this._forward[0]=e._at[0]-e.eye[0],this._forward[1]=e._at[1]-e.eye[1],this._forward[2]=e._at[2]-e.eye[2]):(this._forward[0]=t[0]-e.eye[0],this._forward[1]=t[1]-e.eye[1],this._forward[2]=0),n.vec3.normalize(this._forward,this._forward),this._up[2]=1,n.vec3.cross(this._right,this._forward,this._up),n.vec3.normalize(this._right,this._right),n.vec3.cross(this._up,this._right,this._forward),n.vec3.normalize(this._up,this._up);var r=n.mat4.create();r[0]=this._right[0],r[1]=this._right[1],r[2]=this._right[2],r[3]=0,r[4]=this._forward[0],r[5]=this._forward[1],r[6]=this._forward[2],r[7]=0,r[8]=this._up[0],r[9]=this._up[1],r[10]=this._up[2],r[11]=0,this._translate=n.vec3.create(),this._translate[0]=this._transformMatrix[12],this._translate[1]=this._transformMatrix[13],this._translate[2]=this._transformMatrix[14],this._transformMatrix[12]=this._transformMatrix[13]=this._transformMatrix[14]=0,n.mat4.multiply(this.matrix,r,this._transformMatrix),this.matrix[12]=this._translate[0],this.matrix[13]=this._translate[1],this.matrix[14]=this._translate[2],this._transformMatrix[12]=this._translate[0],this._transformMatrix[13]=this._translate[1],this._transformMatrix[14]=this._translate[2],this._updateMatrixBuffer()}}},"./03scene/drawables/Drawable.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./00utility/m3d_math.js"),n=r("./03scene/drawables/Transform.ts"),a=r("./glMatrix.js");class s{constructor(e,t,r,s,o){if(this.mesh=e,this.material=r,this.shader=t,this.transform=new n.default(s),this.worldTransform=new n.default(s),this._parent=null,this._dirty=!1,this.faceCamera=!1,this.visible=!0,this.bbox=null,this.bsphere=null,this.distance=0,this.nodes=[],this.hidables=-1,this.originalMaterial=null,this.material){var l=this.material.attachShader(this.shader,this.mesh.getManager());this.shader=this.shader||l}if(o){this.bbox=i.default.aabb.createFromArray(o),this.bsphere=i.default.sphere.createFromAABB(this.bbox);var d=a.mat4.create();a.mat4.invert(d,this.transform.matrix),this._originBBox=i.default.aabb.create(),i.default.aabb.transform(this._originBBox,this.bbox,d)}}destroy(){this.transform.destroy(),this.transform=null,delete this.transform,this.worldTransform.destroy(),this.worldTransform=null,delete this.worldTransform,this.bbox=null,delete this.bbox,this.bsphere=null,delete this.bsphere,this.mesh=null,delete this.mesh,this.material=null,delete this.material,this.originalMaterial=null,delete this.originalMaterial,this.nodes=null,delete this.nodes}isShadowCaster(){return(!this.material.transparent||this.material.parameters.hasOwnProperty("uMaterialDiffuseTexture"))&&this.mesh.isTriangle()}setShader(e){this.shader!==e&&(this.shader=e,this.material.attachShader(e))}setParent(e){this._parent=e}setTranslation(e,t,r){this.transform.setTranslation(e,t,r),this.updateBBox(),this.recompileShader("MODEL_TRANSFORM",!this.transform.identity)}translate(e,t,r){this.transform.translate(e,t,r),this.bbox[0]+=e,this.bbox[1]+=t,this.bbox[2]+=r,this.bbox[3]+=e,this.bbox[4]+=t,this.bbox[5]+=r,this.bsphere[0]+=e,this.bsphere[1]+=t,this.bsphere[2]+=r,this.recompileShader("MODEL_TRANSFORM",!this.transform.identity)}setScaling(e,t,r){let i=this.transform.getScaling();this.transform.setScaling(e,t,r);let n=.5*(this.bbox[3]+this.bbox[0]),a=.5*(this.bbox[4]+this.bbox[1]),s=.5*(this.bbox[5]+this.bbox[2]),o=e/i[0]*(this.bbox[3]-this.bbox[0])*.5,l=t/i[1]*(this.bbox[4]-this.bbox[1])*.5,d=r/i[2]*(this.bbox[5]-this.bbox[2])*.5;this.bbox[0]=n-o,this.bbox[1]=a-l,this.bbox[2]=s-d,this.bbox[3]=n+o,this.bbox[4]=a+l,this.bbox[5]=s+d,this.bsphere[3]=Math.sqrt(o*o+l*l+d*d)}multiply(e){a.vec3.transformMat4(this.bsphere,this.bsphere,e),this.transform.multiply(e),this.updateBBox(),this.recompileShader("MODEL_TRANSFORM",!this.transform.identity)}setTransformMatrix(e){this.transform.setTransform(e),this.updateBBox(),this.recompileShader("MODEL_TRANSFORM",!this.transform.identity)}recompileShader(e,t){var r,i=this.shader.flags.lastIndexOf(e),n=!1;if(t?-1===i&&(r=this.shader.flags.concat(e),n=!0):-1!==i&&((r=this.shader.flags.slice(0)).splice(i,1),n=!0),n){var a=this.shader.shaderSource.name,s=this.shader.getManager().getShader(a,r);if(!s.ready&&(s.createFromShaderSource(this.shader.shaderSource,r),!s.ready))throw new Error("Failed to create shader '"+a+"'!");this.shader=s,this.material.attachShader(this.shader)}}updateVisibility(){if(1!==this.nodes.length){for(var e=this.mesh.attributes.values[0].stride,t=0,r=0,i=0,n=this.nodes.length;i<n;i++){r+=(o=this.nodes[i]).verticesCount*e,t+=o.verticesCount}var a=0,s=new Uint8Array(t);for(i=0,n=this.nodes.length;i<n;i++){var o;(o=this.nodes[i]).visible?o.platteIndex&=127:o.platteIndex|=128,s.fill(o.platteIndex,a,a+o.verticesCount),a+=o.verticesCount}this.mesh.vbSubData(r,s);var l=0;for(i=0,n=this.nodes.length;i<n;i++)this.nodes[i].visible&&l++;if(0===l||this.nodes.length===l)return this.visible=l===this.nodes.length,void this.recompileShader("VISIBILITY",!1);this.visible=!0,-1==this.shader.flags.lastIndexOf("VISIBILITY")&&this.recompileShader("VISIBILITY",!0)}else this.visible=this.nodes[0].visible}updateColor(){for(var e=!1,t=0,r=this.nodes.length;t<r;t++)if(127!=(127&this.nodes[t].platteIndex)){e=!0;break}var i=this.shader.flags.lastIndexOf("USE_PLATTE");if(-1==i&&e)this.recompileShader("USE_PLATTE",!0);else if(-1!=i&&!e)return void this.recompileShader("USE_PLATTE",!1);var n=this.mesh.attributes.values[0].stride,a=0,s=0;for(t=0,r=this.nodes.length;t<r;t++){s+=(d=this.nodes[t]).verticesCount*n,a+=d.verticesCount}var o=0,l=new Uint8Array(a);for(t=0,r=this.nodes.length;t<r;t++){var d=this.nodes[t];l.fill(d.platteIndex,o,o+d.verticesCount),o+=d.verticesCount}this.mesh.vbSubData(s,l)}updateTransformMatrix(){this._dirty&&this.worldTransform.multiply(this._parent)}render(e,t,r){this.transform.use(e,t),this.skeleton&&this.skeleton.use(t),this.mesh.renderSub(r[0],r[1])}updateBBox(){i.default.aabb.transform(this.bbox,this._originBBox,this.transform.matrix),this.bsphere=i.default.sphere.createFromAABB(this.bbox)}clone(){var e=new s(this.mesh,this.shader,this.material.clone(this.material.name+"-cloned"),a.mat4.create(),this.bbox);return e.faceCamera=this.faceCamera,e.bsphere=this.bsphere,e.distance=this.distance,e.nodes=this.nodes,e.hidables=this.hidables,e.originalMaterial=this.originalMaterial,e}}},"./03scene/drawables/Gizmo.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/materials/MaterialAdhoc.ts"),a=r("./03scene/drawables/Drawable.ts");class s extends a.default{constructor(e,t,r){super(e,null,null,null,r),this.name=null;let a=t.getShader("gizmo",["MODEL_TRANSFORM"]);a.ready||a.createFromShaderSource(i.default.constant,["MODEL_TRANSFORM"]);let s=new n.default(name,t);s.attachShader(a,t),this.shader=a,this.material=s}setColor(e){this.material.setDiffuse(e)}setTransparent(e){this.material.setTransparent(e)}}},"./03scene/drawables/Gizmo2D.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/materials/MaterialBlit.ts"),a=r("./03scene/drawables/Drawable.ts");class s extends a.default{constructor(e,t){super(e,null,null,null,null),this._resourceManager=t;let r=t.getShader("gizmo2d",[]);r.ready||r.createFromShaderSource(i.default.constant2d,[]);let a=new n.default(name);a.attachShader(r,this._resourceManager),this.shader=r,this.material=a,this._textured=!1}destroy(){this._textured=null,delete this._textured,this._resourceManager=null,delete this._resourceManager,super.destroy()}setColor(e){this._textured&&(this.shader=this._resourceManager.getShader("gizmo2d",[]),this.shader.ready||this.shader.createFromShaderSource(i.default.constant2d,[]),this.material.attachShader(this.shader),this._textured=!1),this.material.parameters.uColor.value=e}setTransparent(e){console.warn("not supported yet."),this._textured&&(this.shader=this._resourceManager.getShader("gizmo2d",[]),this.shader.ready||this.shader.createFromShaderSource(i.default.constant2d,[]),this.material.attachShader(this.shader),this._textured=!1)}setTexture(e){this._textured||(this.shader=this._resourceManager.getShader("blit",["MODEL_TRANSFORM"]),this.shader.ready||this.shader.createFromShaderSource(i.default.blit,["MODEL_TRANSFORM"]),this.material.attachShader(this.shader),this._textured=!0),this.material.setTexture(e)}}},"./03scene/drawables/Skybox.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"SkyBoxMode",function(){return i}),r.d(t,"default",function(){return m});var i,n=r("./00utility/m3d_utils.ts"),a=r("./02resource/m3d_shader_library.js"),s=r("./03scene/materials/MaterialSkyBox.ts"),o=r("./03scene/camera/m3d_base_camera.js"),l=r("./03scene/drawables/Drawable.ts"),d=r("./glMatrix.js"),u=r("./01wrapper/glenum.ts");!function(e){e[e.SKYBOX_SOLIDCOLOR=0]="SKYBOX_SOLIDCOLOR",e[e.SKYBOX_WALLPAPER=1]="SKYBOX_WALLPAPER",e[e.SKYBOX_EQUIRECTANGLE=2]="SKYBOX_EQUIRECTANGLE",e[e.SKYBOX_CUBEMAP=3]="SKYBOX_CUBEMAP",e[e.SKYBOX_WALLPAPER_TILED=4]="SKYBOX_WALLPAPER_TILED"}(i||(i={}));const c=64,h=128;class m extends l.default{constructor(e){super(null,null,null,null,null),this._resourceManager=e,this._mode=-1,this._flipY=!1,this.camera=new o.default([0,0,1,1]);for(var t=0,r="model-skybox-texture-"+t;this._resourceManager.hasTexture(r);)r="model-skybox-texture-"+ ++t;this._texture=this._resourceManager.getTexture(r),this.material=new s.default(r),this.setMode(i.SKYBOX_EQUIRECTANGLE)}destroy(){this._texture&&this._texture.destroy(),delete this._texture,this.camera.destroy(),delete this.camera,this._resourceManager=null,delete this._resourceManager,this._flipY=null,delete this._flipY,super.destroy()}update(e){if(this._mode===i.SKYBOX_WALLPAPER_TILED&&this.visible){var t=this.camera.viewport[3]-this.camera.viewport[1],r=this._texture.height/this._texture.width*(n/t),n=this.camera.viewport[2]-this.camera.viewport[0];this.transform.setScaling(1,r,1),this.transform.setTranslation(0,1-r,1)}else d.mat4.copy(this.camera.viewMatrix,e),this.camera.viewMatrix[12]=0,this.camera.viewMatrix[13]=0,this.camera.viewMatrix[14]=0,d.mat4.multiply(this.camera.vpMatrix,this.camera.projectMatrix,e)}resize(e,t){this.camera.setViewport([0,0,e,t])}_updateMaterial(){this.visible=this._texture.ready,this.visible?this.material.setTexture(this._texture):console.warn("skybox sees a corrupted image.")}setImage(e){if(e){if(this._texture&&this._texture.ready){this._texture.destroy();for(var t=0,r="model-skybox-texture-"+t;this._resourceManager.hasTexture(r);)r="model-skybox-texture-"+ ++t;this._texture=this._resourceManager.getTexture(r)}if(e&&n.default.isArray(e))e[0]instanceof HTMLImageElement?(this._texture.createFromImages(e,u.gl.RGB,u.gl.UNSIGNED_BYTE,u.gl.LINEAR,u.gl.CLAMP_TO_EDGE),this._updateMaterial()):this._texture.createFromFiles(e,u.gl.RGB,u.gl.LINEAR,u.gl.CLAMP_TO_EDGE,()=>{this._updateMaterial()}),this.visible=this._texture.ready,this.visible?this.material.setTexture(this._texture):console.warn("skybox sees a corrupted image.");else if(e instanceof HTMLImageElement)this._texture.createFromImage(e,u.gl.RGB,u.gl.UNSIGNED_BYTE,u.gl.LINEAR,u.gl.CLAMP_TO_EDGE),this._updateMaterial(),this.visible=this._texture.ready,this.visible?this.material.setTexture(this._texture):console.warn("skybox sees a corrupted image.");else{var i=e.split(".");"dds"==i[i.length-1].toLocaleLowerCase()&&this._texture.createFromDDS(e,()=>{this._updateMaterial(),this.visible=this._texture.ready,this.visible?this.material.setTexture(this._texture):console.warn("skybox sees a corrupted image.")})}}else this.visible=!1}getMode(){return this._mode}setMode(e){if(this._mode!==e){this._mode=e;var t=a.default.skybox;if(this._mode===i.SKYBOX_WALLPAPER)this.mesh=this._resourceManager.getMesh("quad"),this.mesh.ready||this.mesh.createQuad(),this.shader=this._resourceManager.getShader("skybox",["WALLPAPER"]),this.shader.ready||this.shader.createFromShaderSource(t,["WALLPAPER"]),this.transform.reset();else if(this._mode===i.SKYBOX_WALLPAPER_TILED)this.mesh=this._resourceManager.getMesh("quad"),this.mesh.ready||this.mesh.createQuad(),this.shader=this._resourceManager.getShader("skybox",["WALLPAPER","MODEL_TRANSFORM"]),this.shader.ready||this.shader.createFromShaderSource(t,["WALLPAPER","MODEL_TRANSFORM"]),this.transform.reset();else if(this._mode===i.SKYBOX_EQUIRECTANGLE)this.mesh=this._resourceManager.getMesh("sphere-"+c+"-"+h),this.mesh.ready||this.mesh.createSphere(c,h),this.shader=this._resourceManager.getShader("skybox",["EQUIRECTANGLE"]),this.shader.ready||this.shader.createFromShaderSource(t,["EQUIRECTANGLE"]);else if(this._mode===i.SKYBOX_CUBEMAP){this.mesh=this._resourceManager.getMesh("sphere-"+c+"-"+h),this.mesh.ready||this.mesh.createSphere(c,i.SKYBOX_CUBEMAP);var r=["CUBEMAP"];this._flipY&&r.push("FLIP"),this.shader=this._resourceManager.getShader("skybox",r),this.shader.ready||this.shader.createFromShaderSource(t,r)}this.material.attachShader(this.shader),this.material.setTexture(this._texture),this.material.setTransparency(1)}}setTransparency(e){this.material.setTransparency(e)}setFlipYEnabled(e){this._flipY=e,this._mode=-1,this.setMode(i.SKYBOX_CUBEMAP)}getTexture(){return this._texture}}},"./03scene/drawables/Transform.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./glMatrix.js"),n=[0,0,0];class a{constructor(e){this._default=null,this._buffer=null,this.identity=!0,this.normalMatrix=null,e?(this.identity=!1,this.matrix=i.mat4.clone(e)):this.matrix=i.mat4.create(),this._default=this.matrix,this._buffer=new Float32Array(32),this._updateMatrixBuffer()}destroy(){this._buffer=null,delete this._buffer,this._default=null,delete this._default,this.matrix=null,delete this.matrix,this.identity=null,delete this.identity}_updateMatrixBuffer(){this.identity?this.normalMatrix=i.mat4.create():(this.normalMatrix=i.mat4.create(),i.mat4.invert(this.normalMatrix,this.matrix),i.mat4.transpose(this.normalMatrix,this.normalMatrix));for(var e=0;e<16;e++)this._buffer[e]=this.matrix[e];for(e=0;e<16;e++)this._buffer[e+16]=this.normalMatrix[e]}use(e,t){var r=null;let i=t.getGL();i.isWebGL2?(r=t.reservedUniforms.m_uPerNode)&&r.upload(this._buffer,i):((r=t.reservedUniforms["m_uPerNode.modelMatrix"])&&r.upload(this.matrix,i),(r=t.reservedUniforms["m_uPerNode.normalMatrix"])&&r.upload(this.normalMatrix,i))}setRotation(e,t){this._default===this.matrix&&(this._default=i.mat4.clone(this.matrix)),this.identity=!1;var r=[this.matrix[12],this.matrix[13],this.matrix[14]],n=this.getScaling();i.mat4.identity(this.matrix),this.setScaling(n[0],n[1],n[2]);var a=i.mat4.create(),s=i.quat.create();i.quat.setAxisAngle(s,[e[0],e[1],e[2]],t),i.mat4.fromQuat(a,s),this.multiply(a),this.matrix[12]=r[0],this.matrix[13]=r[1],this.matrix[14]=r[2],this._updateMatrixBuffer()}setRotationByQuat(e){this._default===this.matrix&&(this._default=i.mat4.clone(this.matrix)),this.identity=!1;var t=[this.matrix[12],this.matrix[13],this.matrix[14]],r=this.getScaling();i.mat4.identity(this.matrix),this.setScaling(r[0],r[1],r[2]);var n=i.mat4.create();i.mat4.fromQuat(n,e),this.multiply(n),this.matrix[12]=t[0],this.matrix[13]=t[1],this.matrix[14]=t[2],this._updateMatrixBuffer()}translate(e,t,r){this._default===this.matrix&&(this._default=i.mat4.clone(this.matrix)),this.identity=!1,this.matrix[12]+=e,this.matrix[13]+=t,this.matrix[14]+=r,this._updateMatrixBuffer()}setTranslation(e,t,r){this._default===this.matrix&&(this._default=i.mat4.clone(this.matrix)),this.identity=!1,this.matrix[12]=this._default[12]+e,this.matrix[13]=this._default[13]+t,this.matrix[14]=this._default[14]+r,this._updateMatrixBuffer()}setScaling(e,t,r){this.identity=!1;var n=[this.matrix[0],this.matrix[1],this.matrix[2]],a=[this.matrix[4],this.matrix[5],this.matrix[6]],s=[this.matrix[8],this.matrix[9],this.matrix[10]],o=e/Math.sqrt(i.vec3.dot(n,n)),l=t/Math.sqrt(i.vec3.dot(a,a)),d=r/Math.sqrt(i.vec3.dot(s,s));this.matrix[0]*=o,this.matrix[1]*=o,this.matrix[2]*=o,this.matrix[4]*=l,this.matrix[5]*=l,this.matrix[6]*=l,this.matrix[8]*=d,this.matrix[9]*=d,this.matrix[10]*=d,this._updateMatrixBuffer()}getScaling(){var e=[this.matrix[0],this.matrix[1],this.matrix[2]],t=[this.matrix[4],this.matrix[5],this.matrix[6]],r=[this.matrix[8],this.matrix[9],this.matrix[10]];return n[0]=Math.sqrt(i.vec3.dot(e,e)),n[1]=Math.sqrt(i.vec3.dot(t,t)),n[2]=Math.sqrt(i.vec3.dot(r,r)),n}set(e){this._default===this.matrix&&(this._default=i.mat4.clone(this.matrix)),e?(this.identity=!1,i.mat4.copy(this.matrix,e)):i.mat4.identity(this.matrix),this._updateMatrixBuffer()}setTransform(e){this._default===this.matrix&&(this._default=i.mat4.clone(this.matrix)),e?(this.identity=!1,i.mat4.multiply(this.matrix,e,this._default)):i.mat4.identity(this.matrix),this._updateMatrixBuffer()}reset(){i.mat4.copy(this.matrix,this._default),this.identity=Math.abs(this.matrix[0]-1)<1e-5&&Math.abs(this.matrix[5]-1)<1e-5&&Math.abs(this.matrix[10]-1)<1e-5&&Math.abs(this.matrix[12])<1e-5&&Math.abs(this.matrix[13])<1e-5&&Math.abs(this.matrix[14])<1e-5,this._updateMatrixBuffer()}getInverted(e){i.mat4.invert(e,this.matrix)}multiply(e){this._default===this.matrix&&(this._default=i.mat4.clone(this.matrix)),this.identity?i.mat4.copy(this.matrix,e):i.mat4.multiply(this.matrix,e,this.matrix),this.identity=Math.abs(this.matrix[0]-1)<1e-5&&Math.abs(this.matrix[5]-1)<1e-5&&Math.abs(this.matrix[10]-1)<1e-5&&Math.abs(this.matrix[12])<1e-5&&Math.abs(this.matrix[13])<1e-5&&Math.abs(this.matrix[14])<1e-5,this._updateMatrixBuffer()}multiplyMatrices(e,t){i.mat4.multiply(this.matrix,e,t),this.identity=Math.abs(this.matrix[0]-1)<1e-5&&Math.abs(this.matrix[5]-1)<1e-5&&Math.abs(this.matrix[10]-1)<1e-5&&Math.abs(this.matrix[12])<1e-5&&Math.abs(this.matrix[13])<1e-5&&Math.abs(this.matrix[14])<1e-5,this._updateMatrixBuffer()}}},"./03scene/m3d_light.js":function(e,t,r){"use strict";r.r(t);var i=r("./glMatrix.js");t.default=function(){function e(){this._initialDirection=i.vec3.clone([.81961,-.28627,-.49804]),this._latitude=Math.asin(-this._initialDirection[2]),this._longitude=Math.atan2(-this._initialDirection[1],-this._initialDirection[0]),this._constantEnvmapMatrix=null,this._initialEnvmapMatrix=null,this.direction=i.vec3.clone(this._initialDirection),this.intensity=1.05,this.shinness=100,this.envmapMatrix=i.mat4.create();var e=i.mat4.clone([1.586253,-.725169,.70441,-2.30068,-.725169,-1.586253,-.359456,1.623691,.70441,-.359456,-.237555,-.893975,-2.30068,1.623691,-.893975,6.141995]),t=i.mat4.clone([1.329145,-.730669,.591031,-2.126058,-.730669,-1.329145,-.403495,1.890295,.591031,-.403495,-.159067,-.888839,-2.126058,1.890295,-.888839,6.193693]),r=i.mat4.clone([.870924,-.654664,.433506,-1.748137,-.654664,-.870924,-.440849,2.254821,.433506,-.440849,-.109753,-.848042,-1.748137,2.254821,-.848042,6.301804]);i.mat4.multiplyScalar(e,e,.0299),i.mat4.multiplyScalar(t,t,.0587),i.mat4.multiplyScalar(r,r,.0114),i.mat4.add(this.envmapMatrix,e,t),i.mat4.add(this.envmapMatrix,this.envmapMatrix,r),this._constantEnvmapMatrix=i.mat4.clone(this.envmapMatrix),this._initialEnvmapMatrix=i.mat4.clone(this.envmapMatrix),this._initialDirection=i.vec3.clone([.81961,-.49804,.28627]),this._initialEnvmapMatrix=i.mat4.clone(this._constantEnvmapMatrix),this._setFlipYZ(!1),this.setLatitude(.45),this.setLongitude(3.14)}return e.prototype._setFlipYZ=function(e){if(this._flipYZ=e,e)this._initialDirection=i.vec3.clone([.81961,-.49804,.28627]),this._initialEnvmapMatrix=i.mat4.clone(this._constantEnvmapMatrix);else{this._initialDirection=i.vec3.clone([.81961,-.28627,-.49804]);var t=i.mat4.clone([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),r=i.mat4.create();i.mat4.transpose(r,t);var n=i.mat4.create();i.mat4.multiply(this._initialEnvmapMatrix,i.mat4.multiply(n,r,this._constantEnvmapMatrix),t)}},e.prototype.setIntensity=function(e){this.intensity=e},e.prototype.getIntensity=function(){return this.intensity},e.prototype.setSpecularShinness=function(e){this.shinness=e},e.prototype.getIntensity=function(){return this.intensity},e.prototype.setLatitude=function(e){this._latitude=e;var t=Math.cos(this._latitude);this.direction[0]=-t*Math.cos(this._longitude),this.direction[1]=-t*Math.sin(this._longitude),this.direction[2]=-Math.sin(this._latitude),this._updateEnvmapMatrix()},e.prototype.setLongitude=function(e){this._longitude=e;var t=Math.cos(this._latitude);this.direction[0]=-t*Math.cos(this._longitude),this.direction[1]=-t*Math.sin(this._longitude),this.direction[2]=-Math.sin(this._latitude),this._updateEnvmapMatrix()},e.prototype.getLongitude=function(){return this._longitude},e.prototype.getLatitude=function(){return this._latitude},e.prototype._updateEnvmapMatrix=function(){var e=i.quat.create(),t=i.vec3.create();i.vec3.cross(t,this.direction,this._initialDirection),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1+i.vec3.dot(this.direction,this._initialDirection),i.quat.normalize(e,e);var r=i.mat4.create();i.mat4.fromQuat(r,e);var n=i.mat4.create();i.mat4.transpose(n,r);var a=i.mat4.create();i.mat4.multiply(this.envmapMatrix,i.mat4.multiply(a,n,this._initialEnvmapMatrix),r)},e}()},"./03scene/m3d_scene_clip.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/m3d_math.js"),n=r("./glMatrix.js");t.default=function(){function e(e){this._enabled=!1,this._bbox=i.default.aabb.createFromArray([-1,-1,-1,1,1,1]),this._clip=i.default.aabb.createFromArray([0,0,0,0,0,0]),this._points=[],this._planes=[]}return e.prototype.initialize=function(e){this._enabled||(this._bbox=i.default.aabb.createFromArray(e),this._bbox[0]-=2e-5,this._bbox[1]-=2e-5,this._bbox[2]-=2e-5,this._bbox[3]+=2e-5,this._bbox[4]+=2e-5,this._bbox[5]+=2e-5,this.reset())},e.prototype.reset=function(){this._enabled=!1;var e=i.default.aabb.min(this._bbox),t=i.default.aabb.max(this._bbox);this._clip=i.default.aabb.create(e,t),this._points=i.default.aabb.points(this._clip),this._planes=i.default.aabb.planes(this._clip)},e.prototype.getCenter=function(){return i.default.aabb.center(this._clip)},e.prototype.getRadius=function(){return.5*i.default.aabb.length(this._clip)},e.prototype.get=function(){return this._clip},e.prototype.getBBox=function(){return this._bbox},e.prototype.getClippingPlanes=function(e){if(e){var t=[];return t.push(n.vec4.clone(this._planes[0])),t.push(n.vec4.clone(this._planes[1])),t.push(n.vec4.clone(this._planes[2])),t.push(n.vec4.clone(this._planes[3])),t.push(n.vec4.clone(this._planes[4])),t.push(n.vec4.clone(this._planes[5])),t}return this._planes},e.prototype.getClippingPoints=function(e){if(e){var t=[];return t.push(n.vec3.clone(this._points[0])),t.push(n.vec3.clone(this._points[1])),t.push(n.vec3.clone(this._points[2])),t.push(n.vec3.clone(this._points[3])),t.push(n.vec3.clone(this._points[4])),t.push(n.vec3.clone(this._points[5])),t.push(n.vec3.clone(this._points[6])),t.push(n.vec3.clone(this._points[7])),t}return this._points},e.prototype.getMin=function(){return i.default.aabb.min(this._clip)},e.prototype.getMax=function(){return i.default.aabb.max(this._clip)},e.prototype.update=function(e){for(var t=0;t<e.length;t++)n.vec3.copy(this._points[t],e[t]);i.default.aabb.createFromPoints(this._clip,e),n.vec4.copy(this._planes[0],i.default.plane.create(e[0],e[4],e[7])),n.vec4.copy(this._planes[1],i.default.plane.create(e[1],e[2],e[6])),n.vec4.copy(this._planes[2],i.default.plane.create(e[0],e[1],e[5])),n.vec4.copy(this._planes[3],i.default.plane.create(e[2],e[3],e[7])),n.vec4.copy(this._planes[4],i.default.plane.create(e[0],e[3],e[2])),n.vec4.copy(this._planes[5],i.default.plane.create(e[4],e[5],e[6]))},e.prototype.set=function(e,t){this._enabled=!0,"number"==typeof t[0]?(this._clip=i.default.aabb.create(e,t),this._points=i.default.aabb.points(this._clip),this._planes=i.default.aabb.planes(this._clip)):this.update(t)},e.prototype.isEnabled=function(){return this._enabled},e.prototype.setEnabled=function(e){this._enabled=e},e}()},"./03scene/materials/Material.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./03scene/materials/MaterialParameter.ts");class n{constructor(e){this.name=e,this.transparent=!1,this.hasMask=!1,this.hasTexture=!1,this.parameters={},this.reservedParameters={}}destroy(){this.name=null,delete this.name,this.parameters=null,delete this.parameters,this.reservedParameters=null,delete this.reservedParameters}attachShader(e,t){if(e&&e.ready){for(let t in e.userUniforms)if(!this.parameters.hasOwnProperty(t))if(this.parameters[t]=new i.default,t.match(/uTexture\d/)){this.hasTexture=!0;var r=parseInt(t.substr(8));if(r>2){console.error("can't support >3 user textures. See shader '"+e.name+"'");continue}this.parameters[t].texUnit=r,this.parameters[t].upload=this.parameters[t].uploadTexture}else this.parameters[t].upload=this.parameters[t].uploadValue;var n;for(n in this.parameters)e.userUniforms[n]||delete this.parameters[n];for(n in this.reservedParameters)e.reservedUniforms[n]||delete this.reservedParameters[n];return e}}use(e){var t;for(t in this.reservedParameters)this.reservedParameters[t].upload(e.reservedUniforms[t],e.getGL());for(t in this.parameters)this.parameters[t].upload(e.userUniforms[t],e.getGL())}absorb(e){var t;for(t in this.reservedParameters)this.reservedParameters[t].value=e.reservedParameters[t].value,this.reservedParameters[t].texUnit=e.reservedParameters[t].texUnit;for(t in this.parameters)this.parameters[t].value=e.parameters[t].value,this.parameters[t].texUnit=e.parameters[t].texUnit}}},"./03scene/materials/MaterialAdhoc.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return l});var i=r("./02resource/Texture.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/materials/Material.ts"),s=r("./03scene/materials/MaterialParameter.ts"),o=[1,0,1,.5,100,0,0,0];class l extends a.default{constructor(e,t){super(e),this._resourceManager=t,this._reservedParameters2={},this._materialParameters=null}destroy(){this._reservedParameters2=null,delete this._reservedParameters2,this._materialParameters=null,delete this._materialParameters,super.destroy()}attachShader(e,t){if(!e&&!t)return null;if(!e){if(!(e=t.getShader("solid",[])).ready){var r=n.default.solid;if(e.createFromShaderSource(r,["MODEL_TRANSFORM"]),!e.ready)throw"modelo3d error at creating shader 'solid'!"}}if(!e||!e.ready)return null;for(var i in super.attachShader(e,t),e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uDiffuseTexture"===i?(this.reservedParameters[i]=new s.default,this.hasTexture=!0,this.reservedParameters[i].texUnit=5,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uDiffuseTexture2"===i?(this.reservedParameters[i]=new s.default,this.hasTexture=!0,this.reservedParameters[i].texUnit=6,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):i.indexOf("m_uMaterial")>=0&&(this.reservedParameters[i]=new s.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue,this._materialParameters=new Float32Array(o),this.reservedParameters[i].value=this._materialParameters));return e}equal(e){return this._materialParameters[0]===e[0]&&this._materialParameters[0]===e[0]&&this._materialParameters[2]===e[2]&&this._materialParameters[3]===e[3]}hash(){var e="",t=this._materialParameters;return e=e+t[0].toString()+t[1].toString()+t[2].toString()+t[3].toString()}setDiffuse(e){var t=this._materialParameters;t[0]=e[0],t[1]=e[1],t[2]=e[2]}setTransparent(e){this._materialParameters[3]=e,this.transparent=e<.99}setDiffuseTexture(e){if(this.reservedParameters.m_uDiffuseTexture)if(e instanceof i.default)this.reservedParameters.m_uDiffuseTexture.value=e;else{var t=this.reservedParameters.m_uDiffuseTexture.value,r=t.getFilter(),n=t.getWrap(),a=this._resourceManager.gl.RGB;if(e instanceof HTMLImageElement){let t=new i.default("texture-"+e.src,this._resourceManager);"png"===(s=e.src.split("."))[s.length-1]&&(a=this._resourceManager.gl.RGBA),t.createFromImage(e,a,this._resourceManager.gl.UNSIGNED_BYTE,r,n),this.reservedParameters.m_uDiffuseTexture.value=t}else{let t=new i.default("texture-"+e,this._resourceManager);var s;a=this._resourceManager.gl.RGB;"png"===(s=e.split("."))[s.length-1]&&(a=this._resourceManager.gl.RGBA),t.createFromFile(e,a,r,n,()=>{this.reservedParameters.m_uDiffuseTexture.value=t})}}else console.warn("can not set texture for "+this.name)}setSecondDiffuseTexture(e){this.reservedParameters.m_uDiffuseTexture2.value=e}getDiffuse(){return this._materialParameters}getTransparent(){return this._materialParameters[3]}getShininess(){return this._materialParameters[4]}getDiffuseTexture(){return this.reservedParameters.m_uDiffuseTexture?this.reservedParameters.m_uDiffuseTexture.value:null}absorb(e){if(e.hasMask){var t=this.reservedParameters.m_uDiffuseTexture,r=e.reservedParameters.m_uDiffuseTexture;t&&r&&(t.value=r.value)}e.transparent&&this.transparent&&this.getTransparent()<0&&this.setTransparent(e.getTransparent())}clone(e){var t=new l(e,this._resourceManager);if(this.reservedParameters){for(var r in this.reservedParameters)r.indexOf("m_uMaterial")>=0?(t.reservedParameters[r]=new s.default,t.reservedParameters[r].upload=this.reservedParameters[r].upload,t._materialParameters=new Float32Array(this.reservedParameters[r].value),t.reservedParameters[r].value=t._materialParameters):t.reservedParameters[r]=this.reservedParameters[r];t.transparent=this.transparent}return t}}},"./03scene/materials/MaterialAnimatingRibbon.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/MaterialAdhoc.ts"),n=r("./03scene/materials/MaterialParameter.ts");class a extends i.default{constructor(e,t){super(e,t)}attachShader(e,t){const r=super.attachShader(e,t);if(!r)return null;for(var i in e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uPlatteTexture"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=5,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uTime"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uSpeed"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uWidth"===i&&(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue));return r}setPlatteTexture(e){this.reservedParameters.m_uPlatteTexture.value=e}setTime(e){this.reservedParameters.m_uTime.value=e}setSpeed(e){this.reservedParameters.m_uSpeed.value=e}setWidth(e){this.reservedParameters.m_uWidth.value=e}}},"./03scene/materials/MaterialBarChart.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/MaterialAdhoc.ts"),n=r("./03scene/materials/MaterialParameter.ts");class a extends i.default{constructor(e,t){super(e,t)}attachShader(e,t){const r=super.attachShader(e,t);if(!r)return null;for(var i in e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uPlatte"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=5,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uData"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=6,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uRes"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uThickness"===i&&(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue));return r}setPlatteTexture(e){this.reservedParameters.m_uPlatte.value=e}setDataTexture(e){this.reservedParameters.m_uData.value=e}setResolution(e){this.reservedParameters.m_uRes.value=e}setThickness(e){this.reservedParameters.m_uThickness.value=.5*e}}},"./03scene/materials/MaterialBlit.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/MaterialParameter.ts"),n=r("./03scene/materials/Material.ts");class a extends n.default{constructor(e){super(e)}attachShader(e,t){if(!e||!e.ready)return e;for(var r in super.attachShader(e,t),e.reservedUniforms)this.reservedParameters.hasOwnProperty(r)||("m_uBlitTexture"===r?(this.reservedParameters[r]=new i.default,this.hasTexture=!0,this.reservedParameters[r].texUnit=4,this.reservedParameters[r].upload=this.reservedParameters[r].uploadTexture):"m_uBlitDepthTexture"===r?(this.reservedParameters[r]=new i.default,this.hasTexture=!0,this.reservedParameters[r].texUnit=6,this.reservedParameters[r].upload=this.reservedParameters[r].uploadTexture):"m_uInvResolution"===r?(this.reservedParameters[r]=new i.default,this.reservedParameters[r].upload=this.reservedParameters[r].uploadValue,this.reservedParameters[r].value=[1,1]):"m_uForeground"===r&&(this.reservedParameters[r]=new i.default,this.reservedParameters[r].texUnit=5,this.reservedParameters[r].upload=this.reservedParameters[r].uploadTexture));return e}setTexture(e){this.reservedParameters.m_uBlitTexture.value=e}setForegroundTexture(e){this.reservedParameters.m_uForeground.value=e}setDepthTexture(e){this.reservedParameters.m_uBlitDepthTexture.value=e}setInvResolution(e){this.reservedParameters.m_uInvResolution&&(this.reservedParameters.m_uInvResolution.value=e)}}},"./03scene/materials/MaterialColor.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./02resource/Texture.ts"),n=r("./03scene/materials/MaterialAdhoc.ts"),a=r("./03scene/materials/MaterialParameter.ts");class s extends n.default{constructor(e,t){super(e,t)}attachShader(e,t){const r=super.attachShader(e,t);if(!r)return null;for(var i in e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uInvTransform"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uPlatteTexture"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].texUnit=6,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uGradientTexture"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].texUnit=8,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uDensityTexture"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].texUnit=9,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uMaskTexture"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].texUnit=10,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uAlphaCorrection"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uLayers"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uInstanceFilter"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uGridSize"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uSampleNumber"===i?(this.reservedParameters[i]=new a.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uDiffuseTexture"===i&&(this.reservedParameters[i]=new a.default,this.hasTexture=!0,this.reservedParameters[i].texUnit=5,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture));return r}setDiffuseTexture(e){if(this.reservedParameters.m_uDiffuseTexture)if(e instanceof i.default)this.reservedParameters.m_uDiffuseTexture.value=e;else{var t=this.reservedParameters.m_uDiffuseTexture.value,r=t.getFilter(),n=t.getWrap(),a=this._resourceManager.gl.RGB;if(e instanceof HTMLImageElement){let t=new i.default("texture-"+e.src,this._resourceManager);"png"===(s=e.src.split("."))[s.length-1]&&(a=this._resourceManager.gl.RGBA),t.createFromImage(e,a,this._resourceManager.gl.UNSIGNED_BYTE,r,n),this.reservedParameters.m_uDiffuseTexture.value=t}else{let t=new i.default("texture-"+e,this._resourceManager);var s;a=this._resourceManager.gl.RGB;"png"===(s=e.split("."))[s.length-1]&&(a=this._resourceManager.gl.RGBA),t.createFromFile(e,a,r,n,()=>{this.reservedParameters.m_uDiffuseTexture.value=t})}}else console.warn("can not set texture for "+this.name)}setPlatteTexture(e){this.reservedParameters.m_uPlatteTexture&&(this.reservedParameters.m_uPlatteTexture.value=e)}setGradientTexture(e){this.reservedParameters.m_uGradientTexture&&(this.reservedParameters.m_uGradientTexture.value=e)}setDataTexture(e){this.reservedParameters.m_uDensityTexture&&(this.reservedParameters.m_uDensityTexture.value=e)}setAlphaCorrection(e){this.reservedParameters.m_uAlphaCorrection&&(this.reservedParameters.m_uAlphaCorrection.value=e)}setInvTransform(e){this.reservedParameters.m_uInvTransform&&(this.reservedParameters.m_uInvTransform.value=e)}setLayers(e){this.reservedParameters.m_uLayers&&(this.reservedParameters.m_uLayers.value=e)}setinstanceFilter(e){this.reservedParameters.m_uInstanceFilter&&(this.reservedParameters.m_uInstanceFilter.value=e)}setGridSize(e){this.reservedParameters.m_uGridSize&&(this.reservedParameters.m_uGridSize.value=e)}setSampleNumber(e){this.reservedParameters.m_uSampleNumber&&(this.reservedParameters.m_uSampleNumber.value=e)}}},"./03scene/materials/MaterialHeatMap.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/MaterialHeightMap.ts"),n=r("./03scene/materials/MaterialParameter.ts");class a extends i.default{constructor(e,t){super(e,t)}attachShader(e,t){const r=super.attachShader(e,t);if(!e)return null;for(var i in e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uPlatte"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=5,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uData"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=6,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uForeground"===i&&(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=7,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture));return r}setForegroundImage(e){this.reservedParameters.m_uForeground.value=e}}},"./03scene/materials/MaterialHeightMap.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/MaterialAdhoc.ts"),n=r("./03scene/materials/MaterialParameter.ts");class a extends i.default{constructor(e,t){super(e,t)}attachShader(e,t){const r=super.attachShader(e,t);if(!e)return null;for(var i in e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uPlatte"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=5,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uData"===i&&(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=6,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture));return r}setPlatteTexture(e){this.reservedParameters.m_uPlatte.value=e}setDataTexture(e){this.reservedParameters.m_uData.value=e}}},"./03scene/materials/MaterialParameter.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(){this.upload=null,this.value=null,this.texUnit=-1}uploadTexture(e,t){this.value&&this.value.use(this.texUnit),e&&e.upload(this.texUnit,t)}uploadValue(e,t){e.upload(this.value,t)}}},"./03scene/materials/MaterialPbr.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return l});var i=r("./02resource/Texture.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/materials/Material.ts"),s=r("./03scene/materials/MaterialParameter.ts"),o=[1,0,1,1,.8,1,0,0,0,1];class l extends a.default{constructor(e,t){super(e),this._reservedParameters2={},this._materialParameters=null,this._resourceManager=t}destroy(){this._reservedParameters2=null,delete this._reservedParameters2,this._materialParameters=null,delete this._materialParameters,super.destroy()}attachShader(e,t){if(!e&&!t)return null;if(!e){if(!(e=t.getShader("solid",[])).ready){var r=n.default.solid;if(e.createFromShaderSource(r,["MODEL_TRANSFORM"]),!e.ready)throw"modelo3d error at creating shader 'solid'!"}}if(!e||!e.ready)return null;for(var i in super.attachShader(e,t),e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uSpecularEnvMap"===i?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].texUnit=4,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uBrdfLut"===i?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].texUnit=5,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uBaseColorTexture"===i?(this.reservedParameters[i]=new s.default,this.hasTexture=!0,this.reservedParameters[i].texUnit=8,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):i.indexOf("m_uMaterial")>=0?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue,this._materialParameters=new Float32Array(o),this.reservedParameters[i].value=this._materialParameters):"m_uNormalTexture"===i?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].texUnit=9,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uMetallicRoughnessTexture"===i?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].texUnit=10,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uEmissiveTexture"===i?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].texUnit=11,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uOcclusionTexture"===i?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].texUnit=12,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uDiffuseEnvMap"===i?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].texUnit=13,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uTransformTexture"===i?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].texUnit=14,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uTotalLod"===i?(this.reservedParameters[i]=new s.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uReflectIntensity"===i&&(this.reservedParameters[i]=new s.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue));return e}equal(e){return this._materialParameters[0]===e[0]&&this._materialParameters[0]===e[0]&&this._materialParameters[2]===e[2]&&this._materialParameters[3]===e[3]}hash(){var e="",t=this._materialParameters;return e=e+t[0].toString()+t[1].toString()+t[2].toString()+t[3].toString()}getBaseColor(){return[this._materialParameters[0],this._materialParameters[1],this._materialParameters[2],this._materialParameters[3]]}setBaseColor(e){var t=this._materialParameters;t[0]=e[0],t[1]=e[1],t[2]=e[2],void 0!==e[3]&&(t[3]=e[3])}setEmissive(e){var t=this._materialParameters;t[6]=e[0],t[7]=e[1],t[8]=e[2]}setTransparent(e){this._materialParameters[3]=e,this.transparent=e<.99}getTransparent(){return this._materialParameters[3]}getRoughness(){return this._materialParameters[4]}setRoughness(e){this._materialParameters[4]=e}getMetallic(){return this._materialParameters[5]}setMetallic(e){this._materialParameters[5]=e}_reCreateTexture(e,t,r){var n=this.reservedParameters[t].value,a=n.getFilter(),s=n.getWrap(),o=this._resourceManager.gl.RGB;if(e instanceof HTMLImageElement){let t=new i.default("texture-"+e.src,this._resourceManager);return"png"===(l=e.src.split("."))[l.length-1]&&(o=this._resourceManager.gl.RGBA),n.destroy(),t.createFromImage(e,o,this._resourceManager.gl.UNSIGNED_BYTE,a,s),t}{let t=new i.default("texture-"+e,this._resourceManager);var l;o=this._resourceManager.gl.RGB;"png"===(l=e.split("."))[l.length-1]&&(o=this._resourceManager.gl.RGBA),t.createFromFile(e,o,a,s,()=>{n.destroy(),r(t)})}}getBaseColorTexture(){return this.reservedParameters.m_uBaseColorTexture?this.reservedParameters.m_uBaseColorTexture.value:null}setBaseColorTexture(e){this.reservedParameters.m_uBaseColorTexture?e instanceof i.default?this.reservedParameters.m_uBaseColorTexture.value=e:this._reCreateTexture(e,"m_uBaseColorTexture",e=>{this.reservedParameters.m_uBaseColorTexture.value=e}):console.warn("can not set texture for "+this.name)}setNormalTexture(e){this.reservedParameters.m_uNormalTexture||console.warn("can not set normal texture for "+this.name),e instanceof i.default?this.reservedParameters.m_uNormalTexture.value=e:(e=this._reCreateTexture(e,"m_uNormalTexture",e=>{this.reservedParameters.m_uNormalTexture.value=e}),this.reservedParameters.m_uNormalTexture.value=e)}setEmissiveTexture(e){this.reservedParameters.m_uEmissiveTexture||console.warn("can not set emissive texture for "+this.name),e instanceof i.default?this.reservedParameters.m_uEmissiveTexture.value=e:(e=this._reCreateTexture(e,"m_uEmissiveTexture",e=>{this.reservedParameters.m_uEmissiveTexture.value=e}),this.reservedParameters.m_uEmissiveTexture.value=e)}setOcclusionTexture(e){this.reservedParameters.m_uOcclusionTexture||console.warn("can not set occlusion texture for "+this.name),e instanceof i.default?this.reservedParameters.m_uOcclusionTexture.value=e:(e=this._reCreateTexture(e,"m_uOcclusionTexture",e=>{this.reservedParameters.m_uOcclusionTexture.value=e}),this.reservedParameters.m_uOcclusionTexture.value=e)}setMetallicRoughnessTexture(e){this.reservedParameters.m_uMetallicRoughnessTexture||console.warn("can not set metallic roughness texture for "+this.name),e instanceof i.default?this.reservedParameters.m_uMetallicRoughnessTexture.value=e:(e=this._reCreateTexture(e,"m_uMetallicRoughnessTexture",e=>{this.reservedParameters.m_uMetallicRoughnessTexture.value=e}),this.reservedParameters.m_uMetallicRoughnessTexture.value=e)}setBrdfLut(e){this.reservedParameters.m_uBrdfLut.value=e}setEnvironmentMap(e){this.reservedParameters.m_uEnvironmentMap.value=e}setSpecularEnvMap(e){this.reservedParameters.m_uSpecularEnvMap.value=e;var t=Math.floor(Math.log2(Math.max(e.width,e.height)))+1;this.reservedParameters.m_uTotalLod.value=t}setReflectIntensity(e){e<0?console.error("intensity should be greater than 0"):this.reservedParameters.m_uSpecularEnvMap&&this.reservedParameters.m_uSpecularEnvMap.value&&(this._materialParameters[9]=e)}clone(e){var t=new l(e,this._resourceManager);if(this.reservedParameters){for(var r in this.reservedParameters)r.indexOf("m_uMaterial")>=0?(t.reservedParameters[r]=new s.default,t.reservedParameters[r].upload=this.reservedParameters[r].upload,t._materialParameters=new Float32Array(this.reservedParameters[r].value),t.reservedParameters[r].value=t._materialParameters):t.reservedParameters[r]=this.reservedParameters[r];t.transparent=this.transparent}return t}}},"./03scene/materials/MaterialSkyBox.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/Material.ts"),n=r("./03scene/materials/MaterialParameter.ts");class a extends i.default{constructor(e){super(e)}attachShader(e,t){if(e&&e.ready){for(let t in e.userUniforms)if(!this.parameters.hasOwnProperty(t))if(this.parameters[t]=new n.default,t.match(/uTexture\d/)){this.hasTexture=!0;var r=parseInt(t.substr(8));if(r>2){console.error("can't support >3 user textures. See shader '"+e.name+"'");continue}this.parameters[t].texUnit=r,this.parameters[t].upload=this.parameters[t].uploadTexture}else this.parameters[t].upload=this.parameters[t].uploadValue;for(var i in e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uSkyTexture"===i&&(this.reservedParameters[i]=new n.default,this.hasTexture=!0,this.reservedParameters[i].texUnit=4,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture),"m_uTransparency"===i&&(this.reservedParameters[i]=new n.default,this.reservedParameters[i].value=1,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue));for(var a in this.reservedParameters)e.reservedUniforms[a]||delete this.reservedParameters[a];return e}}setTexture(e){this.reservedParameters.m_uSkyTexture.value=e}texture(){return this.reservedParameters.m_uSkyTexture.value}setTransparency(e){this.reservedParameters.m_uTransparency.value=e}}},"./03scene/materials/MaterialText.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/MaterialAdhoc.ts"),n=r("./03scene/materials/MaterialParameter.ts");class a extends i.default{constructor(e,t){super(e,t)}attachShader(e,t){const r=super.attachShader(e,t);if(!r)return null;for(var i in e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uFontBitmap"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=6,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uTextureSize"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uColor"===i&&(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue));return r}setFontBitmap(e){this.reservedParameters.m_uFontBitmap&&(this.reservedParameters.m_uFontBitmap.value=e),this.reservedParameters.m_uTextureSize&&(this.reservedParameters.m_uTextureSize.value=[e.width,e.height])}setColor(e){this.reservedParameters.m_uColor&&(this.reservedParameters.m_uColor.value=e)}}},"./03scene/materials/MaterialVolume.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/MaterialAdhoc.ts"),n=r("./03scene/materials/MaterialParameter.ts");class a extends i.default{constructor(e,t){super(e,t)}attachShader(e,t){const r=super.attachShader(e,t);if(!r)return null;for(var i in e.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uInvTransform"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uPlatteTexture"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=6,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uGradientTexture"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=8,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uDensityTexture"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=9,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uMaskTexture"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].texUnit=10,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uAlphaCorrection"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uLayers"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uGridSize"===i?(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue):"m_uSampleNumber"===i&&(this.reservedParameters[i]=new n.default,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue));return r}setPlatteTexture(e){this.reservedParameters.m_uPlatteTexture&&(this.reservedParameters.m_uPlatteTexture.value=e)}setGradientTexture(e){this.reservedParameters.m_uGradientTexture&&(this.reservedParameters.m_uGradientTexture.value=e)}setDataTexture(e){this.reservedParameters.m_uDensityTexture&&(this.reservedParameters.m_uDensityTexture.value=e)}setAlphaCorrection(e){this.reservedParameters.m_uAlphaCorrection&&(this.reservedParameters.m_uAlphaCorrection.value=e)}setInvTransform(e){this.reservedParameters.m_uInvTransform&&(this.reservedParameters.m_uInvTransform.value=e)}setLayers(e){this.reservedParameters.m_uLayers&&(this.reservedParameters.m_uLayers.value=e)}setGridSize(e){this.reservedParameters.m_uGridSize&&(this.reservedParameters.m_uGridSize.value=e)}setSampleNumber(e){this.reservedParameters.m_uSampleNumber&&(this.reservedParameters.m_uSampleNumber.value=e)}}},"./03scene/model/Element.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"ElementType",function(){return i}),r.d(t,"default",function(){return a});var i,n=r("./00utility/m3d_math.js");!function(e){e[e.ROOT=0]="ROOT",e[e.INSTANCE=1]="INSTANCE",e[e.GROUP=2]="GROUP",e[e.ELEMENT=3]="ELEMENT",e[e.NODE=4]="NODE",e[e.LINK=5]="LINK",e[e.ROOM=6]="ROOM",e[e.AREA=7]="AREA",e[e.ANY=-1]="ANY"}(i||(i={}));class a{constructor(e,t,r){this.etype=e,this.id=t,this.father=null,this.children=[],this.bbox=n.default.aabb.create(),this.model=r,this.guid=""}getNodes(){var e=[];let t=[];for(var r=0,i=this.children.length;r<i;++r){var n=this.children[r];n.hasOwnProperty("children")?t.push(n):e.push(n)}for(;t.length>0;){let r=t.pop();for(let i=0,n=r.children.length;i<n;++i){let n=r.children[i];n.hasOwnProperty("children")?t.push(n):e.push(n)}}return e}getDocument(){let e=this.father;for(;null!==e&&e.etype!==i.LINK;)e=e.father;return e.etype===i.LINK?e:null}}},"./03scene/model/Model.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./03scene/model/ModelTree.ts"),n=r("./03scene/model/ModelLoader.ts"),a=r("./03scene/Entity.ts"),s=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};class o extends a.default{constructor(e,t,r,n,a=!1,s){super(e,r,n),this.isMatrixIdentity=!0,this.usePbr=!1,this.tree=new i.default(this),this.source="",this._matrix=t;for(var o=0;o<this._matrix.length;o++)if(0===o||5===o||10===o||15===o){if(Math.abs(this._matrix[o]-1)>1e-6){this.isMatrixIdentity=!1;break}}else if(Math.abs(this._matrix[o])>1e-6){this.isMatrixIdentity=!1;break}this.usePbr=a,this.local=s}destroy(){this.tree.destroy(),this.tree=null,delete this.tree,this.source=null,delete this.source,super.destroy()}load(e,t,r,i){return s(this,void 0,void 0,function*(){return new n.default(this,this._resourceManager,this._materialManager).load(t,r,i)})}}},"./03scene/model/ModelLoader.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return h});var i=r("./00utility/m3d_math.js"),n=r("./03scene/model/Node.ts"),a=r("./03scene/model/m3d_load_misc.js"),s=r("./03scene/model/ModelLoaderMesh.ts"),o=r("./03scene/model/ModelLoaderBin.ts"),l=r("./03scene/model/ModelLoaderTree.ts"),d=r("./01wrapper/glenum.ts"),u=r("./99api/utils/model/downloader.ts"),c=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};class h{constructor(e,t,r){this._model=e,this._resourceManager=t,this._materialManager=r,this._binLoader=null,this._filePromises=null,this._modelJson=null,this._sceneJson=null,this._progressTracker=null}destroy(){this._model=null,delete this._model,this._resourceManager=null,delete this._resourceManager,this._binLoader.destroy(),this._binLoader=null,delete this._binLoader,this._filePromises=null,delete this._filePromises,this._filePromises=null,delete this._filePromises,this._sceneJson=null,delete this._sceneJson,this._modelJson=null,delete this._modelJson,this._progressTracker=null,delete this._progressTracker}load(e,t,r){return c(this,void 0,void 0,function*(){return this._generatePromises(this._model.name,t,r,e).then(t=>(this._filePromises=t,t["scene.json"].onProgress(t=>{e(t.loaded/t.total*.05)}),t["scene.json"].downloadFile())).then(e=>{"string"==typeof e.data?this._sceneJson=JSON.parse(e.data):this._sceneJson=e.data;var t=this._sceneJson.version.split(".");if(1e4*parseInt(t[0])+100*parseInt(t[1])+parseInt(t[2])<3e4)return Promise.reject(new Error("Unsupported model format."));console.time(`Loading "${this._model.name}" takes `)}).then(()=>this._load(t=>{e(.05+.95*t)})).then(()=>{console.timeEnd(`Loading "${this._model.name}" takes `),e(1)})})}_load(e){return this._filePromises["model.json"].downloadFile().then(t=>{this._modelJson=t.data,this._progressTracker=new a.default.ProgressTracker(e);for(var r=0,i=this._sceneJson.textures.length;r<i;r++)this._progressTracker.totalDownload+=this._sceneJson.textures[r].byteLength;for(r=0,i=this._modelJson.buffers.length;r<i;r++)this._progressTracker.totalDownload+=this._modelJson.buffers[r].byteLength;this._progressTracker.totalDownload+=this._modelJson["model.bin"].byteLength,this._progressTracker.totalDownload+=this._modelJson["modelgraph.bin"].byteLength,this._modelJson["uuid.bin"]&&(this._progressTracker.totalDownload+=this._modelJson["uuid.bin"].byteLength);this._progressTracker.getSingleFileProgress();return this._filePromises["scene.bin"].downloadFile()}).then(e=>{const t=e.data;var r=this._progressTracker.getSingleFileProgress();return this._filePromises["model.bin"].onProgress(e=>{r(e.loaded)}),this._filePromises["model.bin"].downloadFile().then(e=>{const r=e.data;this._binLoader=new o.default(this._sceneJson,t,this._modelJson,r)})}).then(()=>{this._model.bbox=i.default.aabb.createFromArray(this._modelJson["model.bin"].bbox),this._model.isMatrixIdentity||i.default.aabb.transform(this._model.bbox,this._model.bbox,this._model.getTransformMatrix());let e=this._model.tree;const t=this._modelJson["model.bin"].nodes;e.createNodes(t);for(let r=0;r<t;r++){e.nodes[r]=new n.default(r);const t=this._binLoader.readNodeBBox(r);let a=new Float32Array(e.nodeBBoxes.buffer,24*r,6);i.default.aabb.copy(a,t)}if(this._sceneJson.source){var r=this._sceneJson.source.split("/"),a=[];if(r.forEach(e=>{a.push(...e.split("."))}),this._model.faces=1,r.length>0)-1!==a.indexOf("skp")&&(this._model.faces=2,this._model.hasContours=!0),-1!==a.indexOf("rvt")&&(this._model.hasContours=!0);else switch(a[a.length-1]){case"skp":this._model.faces=2,this._model.hasContours=!0;break;case"rfa":case"rvt":this._model.faces=1,this._model.hasContours=!0;break;case"vgx":case"stl":case"max":this._model.faces=1;break;case"obj":case"3dm":case"nwd":this._model.faces=0;break;default:this._model.faces=1}this._model.source=a[a.length-1]}return this._loadTextures()}).then(()=>{return new s.default(this._resourceManager,this._materialManager,this._model).load(this._filePromises,this._sceneJson,this._modelJson,this._binLoader,this._progressTracker)}).then(()=>this._model.initlize()).then(()=>{return new l.default(this._model).load(this._filePromises,this._progressTracker)})}_loadTextures(){return c(this,void 0,void 0,function*(){if(0===this._sceneJson.textures.length)return Promise.resolve("ok");for(var e=new Array(this._sceneJson.samplers.length),t=0,r=this._sceneJson.samplers.length;t<r;t++){e[t]={filter:d.gl.LINEAR_MIPMAP_LINEAR,wrap:d.gl.REPEAT};var i=this._binLoader.readSampler(t);1===i[0]?e[t].filter=1===i[2]?d.gl.LINEAR_MIPMAP_LINEAR:d.gl.LINEAR:e[t].filter=1===i[2]?d.gl.NEAREST_MIPMAP_NEAREST:d.gl.NEAREST,e[t].wrap=1===i[1]?d.gl.REPEAT:d.gl.CLAMP_TO_EDGE}let n={};Object.keys(this._filePromises).forEach(e=>{var t=e.toLowerCase();n[t]=this._filePromises[e]});let a=t=>{let r=this._sceneJson.textures[t].name.toLowerCase(),i=this._model.name+"-"+r;return n[r].downloadFile().then(n=>{var a=this._binLoader.readTexture(t),s=e[a[1]],o=this._resourceManager.getTexture(i);o.url=n.src;var l=this._resourceManager.gl,d=4===a[0]?l.RGBA:l.RGB;if(o.updateImage(n,d,l.UNSIGNED_BYTE,s.filter,s.wrap),!o.ready)return Promise.reject("modelo3d loader errors at creating texture '"+r+"'.")})};var s=a(0);for(t=1,r=this._sceneJson.textures.length;t<r;t++)s=(e=>s.then(()=>a(e)))(t);return s})}_generatePromisesLocal(e,t){return c(this,void 0,void 0,function*(){let r={};const i=e||"./localmodel",n=i+"/scene.json";return r["scene.json"]=a.default.OpenFile1(n,"json",Promise),r["scene.json"].downloadFile(e=>{t(e.loaded/e.total*.05)}).then(e=>{const t=e.data;let n;for(let e=0,s=t.textures.length;e<s;e++){const s=t.textures[e].name;n=i+"/"+s,r[s]=a.default.OpenImage(n,Promise)}return n=i+"/scene.bin",r["scene.bin"]=a.default.OpenFile1(n,"arraybuffer",Promise),n=i+"/model.bin",r["model.bin"]=a.default.OpenFile1(n,"arraybuffer",Promise),n=i+"/modelgraph.bin",r["modelgraph.bin"]=a.default.OpenFile1(n,"arraybuffer",Promise),n=i+"/uuid.bin",r["uuid.bin"]=a.default.OpenFile1(n,"arraybuffer",Promise),n=i+"/model.json",r["model.json"]=a.default.OpenFile1(n,"json",Promise),r["model.json"].downloadFile()}).then(e=>{for(let t=0,n=e.data.buffers.length;t<n;t++){const e=i+"/mesh"+t+".bin";r["mesh"+t+".bin"]=a.default.OpenFile1(e,"arraybuffer",Promise)}return Promise.resolve(r)})})}_generatePromises(e,t,r,i){return c(this,void 0,void 0,function*(){return r instanceof Array?Object(u.generatePromises)(e,r):t?this._generatePromisesLocal(r,i):Object(u.generatePromises)(e)})}}},"./03scene/model/ModelLoaderBin.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});const i=4,n=4,a=1;class s{constructor(e,t,r,i){this._sceneJson=e,this._sceneBin=t,this._modelJson=r,this._modelBin=i,this._samplersLocation=0,this._texturesLocation=0,this._materialsLocation=0,this._attributesLocation=0,this._meshesLocation=0,this._nodesLocation=0,this._initialize(e,t,r,i)}destroy(){this._sceneBin=null,this._sceneJson=null,this._modelBin=null,this._modelJson=null,delete this._sceneBin,delete this._sceneJson,delete this._modelBin,delete this._modelJson,this._samplersLocation=null,this._texturesLocation=null,this._materialsLocation=null,this._attributesLocation=null,delete this._samplersLocation,delete this._texturesLocation,delete this._materialsLocation,delete this._attributesLocation,this._meshesLocation=null,this._nodesLocation=null,delete this._meshesLocation,delete this._nodesLocation}_initialize(e,t,r,n){var s=0;e.samplers.length>0&&(this._samplersLocation=s,s+=e.samplers.length*(4*a)),e.textures.length>0&&(this._texturesLocation=s,s+=e.textures.length*(4*a)),e.materials.length>0&&(this._materialsLocation=s,s+=e.materials.length*(16*a)),e.attributes.length>0&&(this._attributesLocation=s),this._meshesLocation=8;var o=new Uint32Array(n,0,2);this._nodesLocation=o[0]*(5*i)+8}readSampler(e){return new Uint8Array(this._sceneBin,this._samplersLocation+e*a*4,4)}readTexture(e){return new Uint8Array(this._sceneBin,this._texturesLocation+e*a*4,4)}readMaterial(e){return new Uint8Array(this._sceneBin,this._materialsLocation+e*a*16,16)}readAttribute(e){return new Int8Array(this._sceneBin,this._attributesLocation+e*a*8,8)}readMesh(e){return new Uint32Array(this._modelBin,this._meshesLocation+e*i*5,5)}readNodeData(e){return new Uint32Array(this._modelBin,this._nodesLocation+e*i*21,3)}readNodeBBox(e){return new Float32Array(this._modelBin,this._nodesLocation+(21*e+3)*n,6)}readNodeTransform(e){return new Float32Array(this._modelBin,this._nodesLocation+(21*e+9)*n,12)}}},"./03scene/model/ModelLoaderMesh.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return b});var i=r("./00utility/Config.ts"),n=r("./02resource/MeshAttributes.ts"),a=r("./02resource/m3d_shader_library.js"),s=r("./03scene/drawables/Drawable.ts"),o=r("./03scene/model/Node.ts"),l=r("./03scene/model/ModelLoaderMeshSync.js"),d=r("./01wrapper/glenum.ts"),u=r("./00utility/Environment.ts"),c=r("./03scene/materials/MaterialAdhoc.ts"),h=r("./glMatrix.js"),m=r("./00utility/m3d_math.js"),f=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const p="data:image/png;base64,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";let v=[1,1,1];const _=9;var g=new Float32Array(16);class b{constructor(e,t,r){this._resourceManager=e,this._materialManager=t,this._model=r,this._attributes=null,this._sceneJson=null,this._modelJson=null,this._binLoader=null,this._meshBinLoader=null}destroy(){this._resourceManager=null,delete this._resourceManager,this._model=null,delete this._model,this._sceneJson=null,delete this._sceneJson,this._modelJson=null,delete this._modelJson,this._binLoader=null,delete this._binLoader,this._meshBinLoader=null,delete this._meshBinLoader,this._attributes=null,delete this._attributes}load(e,t,r,i,a){return f(this,void 0,void 0,function*(){this._sceneJson=t,this._modelJson=r,this._binLoader=i;for(var s=new Array(t.attributes.length),o=[d.gl.POINTS,d.gl.LINES,d.gl.LINES,d.gl.LINES,d.gl.TRIANGLES],u=[d.gl.BYTE,d.gl.UNSIGNED_BYTE,d.gl.SHORT,d.gl.UNSIGNED_SHORT,d.gl.INT,d.gl.UNSIGNED_INT,0,d.gl.FLOAT,0],c=0,h=t.attributes.length;c<h;c++){s[c]=new n.default;this._sceneJson.attributes[c];var m=this._binLoader.readAttribute(c);s[c].primitive=o[m[0]];var f=m[1]>=0?u[m[1]]:null,p=m[2]>=0?u[m[2]]:null,v=m[3]>=0?u[m[3]]:null;s[c].builtin(d.gl.FLOAT,f,p,v)}this._attributes=s,this._meshBinLoader=new l.default(this._resourceManager,t,this._binLoader,r,this._attributes,this._model);let _=this._loadMesh(0,e["mesh0.bin"],a);for(c=1,h=r.buffers.length;c<h;c++)_=(t=>_.then(()=>{let r="mesh"+t.toString()+".bin";return this._loadMesh(t,e[r],a)}))(c);return _})}_loadMesh(e,t,r){return f(this,void 0,void 0,function*(){let i=r.getSingleFileProgress();return t.onProgress(e=>{i(e.loaded)}),t.downloadFile().then(t=>{this._meshBinLoader.load(e,t.data,(e,t,r,i,n,a)=>{var s=this._createShaderObject(e);if(s){var o=this._createMaterialObject(e,s);if(o){var l=this._createMeshObject(e,i,n,t,r);if(!l)throw new Error("Not enough video memory.");this._createDrawableObject(e,l,s,o,a)}}})})})}_createShaderObject(e){var t=this._binLoader.readMaterial(65535&e[2]),r=this._attributes[e[8]>>8&255],n=255!==t[4],s="solid";r.primitive===d.gl.LINES?s="plain":r.hasColor?s="color":n&&(s="texture"),this._model.usePbr&&r.primitive!==d.gl.LINES&&(s="pbr");let o=[];805306368&e[2]&&o.push("INSTANCING"),1073741824&e[2]||o.push("MODEL_TRANSFORM");const l=t[3]<250&&!n;if(this._model.faces<1&&!l&&o.push("DOUBLESIDED"),u.Environment.isMobile&&o.push("MOBILE"),n){var c=t[5]<<8|t[4];this._binLoader.readTexture(c)[2]&&o.push("ALPHATEST"),o.push("HAS_BASECOLORMAP")}i.Config.compressNormals&&o.push("COMPRESSION"),this._model.isMatrixIdentity||o.push("MODEL_TRANSFORM");var h=this._resourceManager.getShader(s,o);if(!h.ready){var m=a.default[s];if(h.createFromShaderSource(m,o),!h.ready)throw"modelo3d error at creating shader '"+s+"'!"}return h}_createMeshObject(e,t,r,n,a){let s=null;if(!(s=this._resourceManager.getMesh(e[1]>=0?this._model.name+"/"+e[1].toString():this._model.name+"/-"+e[0].toString())).ready){var o=[d.gl.UNSIGNED_BYTE,d.gl.UNSIGNED_BYTE,d.gl.UNSIGNED_SHORT,d.gl.UNSIGNED_SHORT,d.gl.UNSIGNED_INT],l=e[8]>>8&255,u=this._attributes[l];u=u.clone(),i.Config.compressNormals&&u.compress();for(var c=t.byteLength/(u.values[0].stride+(e[3]>=0?1:0)),h=0,m=u.values.length;h<m;h++)u.values[h].offset+=t.byteOffset;if(e[3]>=0){u.add("m_aMaterial",6,d.gl.UNSIGNED_BYTE,!0,1);var f=u.values[u.values.length-1];f.index=6,f.offset=u.values[0].offset+c*u.values[0].stride,f.stride=1}s.createShared(u.primitive,u,t,r,o[255&e[8]],n,a)}return s}_createDrawableObject(e,t,r,i,n){this._attributes[e[8]>>8&255];var a,l=null;0==(1073741824&e[2])?(a=this._binLoader.readNodeTransform(e[0]),g[0]=a[0],g[1]=a[1],g[2]=a[2],g[3]=0,g[4]=a[3],g[5]=a[4],g[6]=a[5],g[7]=0,g[8]=a[6],g[9]=a[7],g[10]=a[8],g[11]=0,g[12]=a[9],g[13]=a[10],g[14]=a[11],g[15]=1,l=g,this._model.isMatrixIdentity||h.mat4.multiply(l,this._model.getTransformMatrix(),l)):this._model.isMatrixIdentity||(l=this._model.getTransformMatrix());var d=this._binLoader.readNodeBBox(e[0]);this._model.isMatrixIdentity||m.default.aabb.transform(d,d,this._model.getTransformMatrix());var u=new s.default(t,r,i,l,d);u.visible=!0,this._model.addDrawable(u);for(var c=o.NodeType.STRUCTURE,f=e[0],p=0;f>=0;){let r=this._model.tree.nodes[f];const i=n[f*_+2]>>24&15;u.nodes.push(r),r.region=i,r.drawable=u,805306368&n[f*_+2]?(r.indicesOffset=1,r.indicesCount=1):(r.indicesOffset=n[f*_+6],r.indicesCount=n[f*_+7]),0===r.indicesOffset&&0===r.indicesCount&&(r.indicesCount=e[5]/t.indexSize),r.verticesCount=n[f*_+4],c!==i&&(c=i,i>=o.NodeType.STRUCTURE_INTERIOR&&u.hidables<0&&(u.hidables=p)),f=n[f*_+3],p++}return 805306368&e[2]&&(u.hidables=(e[2]>>24&15)>=o.NodeType.STRUCTURE_INTERIOR?0:-1),u}_createMaterialObject(e,t){var r=this._sceneJson.materials[65535&e[2]],i=this._attributes[e[8]>>8&255].primitive===d.gl.LINES;i&&(r="mxLine-"+r),!i&&this._model.usePbr&&(r="mxPbr-"+r);var n=this._materialManager.getMaterial(this._model.name+r);if(!n){var a,s=this._binLoader.readMaterial(65535&e[2]);if((n=!i&&this._model.usePbr?this._materialManager.createMaterialPbr(this._model.name+r):this._materialManager.createMaterialAdhoc(this._model.name+r)).attachShader(t,this._resourceManager),v[0]=s[0]/255,v[1]=s[1]/255,v[2]=s[2]/255,n instanceof c.default)n.setDiffuse(v);else n.setBaseColor(v),this._resourceManager.hasTexture("modelo-brdf-lut")?a=this._resourceManager.getTexture("modelo-brdf-lut"):(a=this._resourceManager.getTexture("modelo-brdf-lut")).createFromFile(p,d.gl.RGBA,d.gl.LINEAR,d.gl.CLAMP_TO_EDGE,()=>{}),n.setBrdfLut(a);if(n.setTransparent(s[3]/255),n.getTransparent()<.98&&(n.transparent=!0),255!==s[4]){var o=s[5]<<8|s[4],l=this._model.name+"-"+this._sceneJson.textures[o].name.toLowerCase(),u=this._binLoader.readTexture(o);4===u[0]?1===u[2]?(n.hasMask=!0,n.transparent=!1):n.transparent=!0:n.transparent=!1;var h=this._resourceManager.getTexture(l);n instanceof c.default?(n.setDiffuseTexture(h),n.originTextureUrl=h.url):n.setBaseColorTexture(h)}}return n}}},"./03scene/model/ModelLoaderMeshSync.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/Config.ts"),n=r("./00utility/Environment.ts"),a=r("./01wrapper/glenum.ts");r("./03scene/model/Node.ts");t.default=function(){function e(e,t,r,i,n,a){this._resourceManager=e,this._sceneJson=t,this._modelBin=r,this._modelJson=i,this._attributesData=n,this._maxVertexNumber=65536,this._meshes=0,this._nodesInfo=null,this._buffersNodes=[],this._verticesBinary=null,this._indicesBinary=null,this._model=a,this._initialize()}e.prototype.destroy=function(){this._attributesData=null,delete this._attributesData,this._sceneJson=null,delete this._sceneJson,this._modelBin=null,delete this._modelBin,this._nodesInfo=null,delete this._nodesInfo,this._buffersNodes=null,delete this._buffersNodes,this._verticesBinary=null,delete this._verticesBinary,this._indicesBinary=null,delete this._indicesBinary,this._model=null,delete this._model};e.prototype._initialize=function(){if(null===this._nodesInfo){for(var e=this._modelJson["model.bin"].nodes,t=this._modelJson.buffers.length,r=0,i=0;i<t;i++)r+=this._modelJson.buffers[i].byteLength,this._meshes+=this._modelJson.buffers[i].meshes;if(r>1024*n.Environment.gpuMemory*1024)throw new Error("No enough GPU memory to load this model: "+r);this._nodesInfo=new Int32Array(9*e),this._buffersNodes=new Array(t);for(i=0;i<t;i++)this._buffersNodes[i]=[];for(i=0;i<e;i++){var a=new Int32Array(this._nodesInfo.buffer,9*i*4,9),s=this._modelBin.readNodeData(i);a[0]=i,a[1]=s[1],a[2]=65535&s[0],a[2]|=2147483648,a[2]|=s[2]>>30&1?1073741824:0,a[2]|=(s[2]>>25&15)<<24,a[3]=-1;var o=this._modelBin.readMesh(a[1]);a[4]=o[2],a[5]=o[4],a[8]=65535&o[0];var l=o[0]>>16;this._buffersNodes[l].push(i)}i=0;for(var d=t;i<d;i++)this._groupNodesByMaterial(this._buffersNodes[i]);this._createMerges(new Uint32Array(t),1024*n.Environment.gpuMemory*1024);var u=0,c=0;for(i=0,d=this._buffersNodes.length;i<d;++i){for(var h,m,f=this._buffersNodes[i],p=0,v=0,_=f.length;v<_;v++){if(2147483648&(a=new Int32Array(this._nodesInfo.buffer,4*f[v]*9,9))[2])if(a[3]>=0){var g=this._attributesData[a[8]>>8&255];p=(p+=a[4]+a[5]-a[7]+a[4]/g.values[0].stride)+3&-4}else p=(p+=a[7])+3&-4}u<(h=p+this._modelJson.buffers[i].byteLength)&&(u=h),c<(m=p+this._modelJson.buffers[i].byteLength)&&(c=m)}this._verticesBinary=new ArrayBuffer(u),this._indicesBinary=new ArrayBuffer(c)}},e.prototype._groupNodesByMaterial=function(e){if(!(e.length<=1)){var t=this;e.sort(function(e,r){var i=9*e,n=9*r,a=65535&t._nodesInfo[i+2],s=65535&t._nodesInfo[n+2];return a!==s?a-s:(t._nodesInfo[i+8]>>8&255)-(t._nodesInfo[n+8]>>8&255)});for(var r=9*e[0],i=65535&this._nodesInfo[r+2],n=this._nodesInfo[r+8]>>8&255,a=[e[0]],s=1,o=e.length;s<o;++s){r=9*e[s];var l=65535&this._nodesInfo[r+2],d=this._nodesInfo[r+8]>>8&255;(255&this._nodesInfo[r+8])>2||l!==i||d!==n?(this._splitNodesGroup(a),a=[e[s]],i=l,n=d):a.push(e[s])}this._splitNodesGroup(a)}},e.prototype._splitNodesGroup=function(e){if(e.length>1){var t=e[0],r=t,i=t,n=9*t;this._nodesInfo[n+2]|=2147483648;for(var a=this._nodesInfo[n+4],s=this._nodesInfo[n+8]>>8&255,o=this._attributesData[s].values[0].stride*this._maxVertexNumber,l=1,d=e.length;l<d;++l){t=e[l];var u=this._nodesInfo[9*t+4];a+u>o?(this._nodesInfo[9*t+2]|=2147483648,i=t,a=u):(this._nodesInfo[9*t+2]&=2147483647,this._nodesInfo[9*r+3]=t,this._nodesInfo[9*i+6]++,a+=u),r=t}}},e.prototype._computeMergeInfo=function(e,t){var r=9*e,i=this._nodesInfo[r+8]>>8&255,n=255&this._nodesInfo[r+8],a=this._attributesData[i].values[0].stride,s=0,o=this._nodesInfo[r+4],l=this._nodesInfo[r+5],d=this._nodesInfo[r+1];t[d]||(t[d]=1,s+=o+l);for(var u=o,c=l/n,h=this._nodesInfo[r+3];h>=0;)r=9*h,o=this._nodesInfo[r+4],l=this._nodesInfo[r+5],n=255&this._nodesInfo[r+8],t[d=this._nodesInfo[r+1]]||(t[d]=1,s+=o+l),u+=o,c+=l/n,h=this._nodesInfo[r+3];var m=u/a;n=1,m>65536?n=4:m>256&&(n=2);r=9*e;this._nodesInfo[r+4]=u,this._nodesInfo[r+5]=c*n,this._nodesInfo[r+7]=s,this._nodesInfo[r+8]=4294967040&this._nodesInfo[r+8]|n},e.prototype._deleteMergeInfo=function(e,t){var r=e,i=new Int32Array(this._nodesInfo.buffer,9*r*4,9),n=9*r,a=this._modelBin.readMesh(i[1]);for(this._nodesInfo[n+4]=a[2],this._nodesInfo[n+5]=a[4],this._nodesInfo[n+6]=0,this._nodesInfo[n+8]=a[0];r>=0;){n=9*r;var s=this._nodesInfo[n+3];this._nodesInfo[n+2]|=2147483648,this._nodesInfo[n+3]=-1,r=s}},e.prototype._createMerges=function(e,t){for(var r=[],i=0,n=1073741824,a=new Uint8Array(this._meshes),s=new Uint8Array(this._meshes),o=0,l=this._buffersNodes.length;o<l;o++)for(var d=this._buffersNodes[o],u=e[o],c=d.length;u<c;++u){var h=d[u],m=9*h;if(2147483648&this._nodesInfo[m+2]){if(this._nodesInfo[m+3]>=0){this._computeMergeInfo(h,a);var f=this._nodesInfo[m+4]+this._nodesInfo[m+5]-this._nodesInfo[m+7],p=this._nodesInfo[m+4]+this._nodesInfo[m+5];f<13e4?t-=p:(n>f&&(n=f),t-=this._nodesInfo[m+7],r.push(h),i+=f)}else{const e=this._nodesInfo[m+1];s[e]||(a[e]?this._nodesInfo[m+7]=this._nodesInfo[m+4]+this._nodesInfo[m+5]:a[e]=1,t-=this._nodesInfo[m+4]+this._nodesInfo[m+5],s[e]=1)}if(t<0)throw console.log("No enough GPU memory to load this model."),new Error("No enough GPU memory to load this model.")}}if(t<i){var v=r.length,_=Math.ceil(t/n),g=new Uint32Array((v+1)*(_+1));for(o=1;o<=v;o++){var b=Math.floor((this._nodesInfo[9*r[o-1]+4]+this._nodesInfo[9*r[o-1]+5]-this._nodesInfo[9*r[o-1]+7])/n),y=this._nodesInfo[9*r[o-1]+6];for(u=1;u<=_;u++){var x=o*(_+1)+u,w=(o-1)*(_+1)+u;if(u<b)g[x]=g[w];else{var E=(o-1)*(_+1)+u-b;g[w]>g[E]+y?g[x]=g[w]:g[x]=g[E]+y}}}for(var M=new Uint8Array(r.length),A=v,T=_;A>0;){b=Math.floor((this._nodesInfo[9*r[A-1]+4]+this._nodesInfo[9*r[A-1]+5]-this._nodesInfo[9*r[A-1]+7])/n),y=this._nodesInfo[9*r[A-1]+6];g[A*(_+1)+T]===g[(A-1)*(_+1)+T]?A--:T-b>=0&&g[A*(_+1)+T]===g[(A-1)*(_+1)+T-b]+y&&(M[A-1]=1,A--,T-=b)}var S=new Uint8Array(this._meshes);for(o=0,l=M.length;o<l;o++)M[o]||this._deleteMergeInfo(r[o],S)}},e.prototype.load=function(e,t,r){var n=this._buffersNodes[e],s=this._resourceManager.getBuffer(this._model.name+"-vmesh"+e+".bin"),o=this._resourceManager.getBuffer(this._model.name+"-imesh"+e+".bin");s.create(a.gl.ARRAY_BUFFER,new Uint8Array(1)),o.create(a.gl.ELEMENT_ARRAY_BUFFER,new Uint8Array(1)),this._verticesOffset=0,this._indicesOffset=0;for(var l=0,d=n.length;l<d;++l){var u=n[l],c=new Int32Array(this._nodesInfo.buffer,4*u*9,9);if(2147483648&c[2]){var f=null,p=null;if(c[3]<0){var v=this._modelBin.readMesh(c[1]);if(this._resourceManager.hasMesh(c[1]>=0?this._model.name+"/"+c[1].toString():this._model.name+"/"+-c[0].toString()))r(c,s,o,null,null,this._nodesInfo);else{var _=this._attributesData[c[8]>>8&255],g=(v[0],v[2]/4),b=v[2]/_.values[0].stride;i.Config.compressNormals&&_.hasNormal&&(g-=v[2]/_.values[0].stride),f=new Float32Array(this._verticesBinary,this._verticesOffset,g),p=new Uint8Array(this._indicesBinary,this._indicesOffset,v[4]),m(f,new Float32Array(t,v[1],v[2]/4),_,i.Config.compressNormals),h(p,new Uint8Array(t,v[3],v[4]),v[4],0),c[4]=b,c[7]=v[4]/(255&v[0]),this._verticesOffset+=4*g,this._indicesOffset+=v[4],this._verticesOffset=this._verticesOffset+3&-4,this._indicesOffset=this._indicesOffset+3&-4,r(c,s,o,f,p,this._nodesInfo)}}else{var y=this._verticesOffset,x=this._indicesOffset,w={verticesBinary:this._verticesBinary,indicesBinary:this._indicesBinary,verticesOffset:this._verticesOffset,indicesOffset:this._indicesOffset};c=this._populateMergedNode(c,t,w),this._verticesOffset=w.verticesOffset,this._indicesOffset=w.indicesOffset;var E=this._verticesOffset-y,M=this._indicesOffset-x;this._verticesOffset=this._verticesOffset+3&-4,this._indicesOffset=this._indicesOffset+3&-4,r(c,s,o,f=new Uint8Array(this._verticesBinary,y,E),p=new Uint8Array(this._indicesBinary,x,M),this._nodesInfo)}}}s.update(new Uint8Array(this._verticesBinary,0,this._verticesOffset)),o.update(new Uint8Array(this._indicesBinary,0,this._indicesOffset))};var t=new Float32Array([0,0,0]),r=new Float32Array([0,0,0]),s=new Float32Array(3),o=new Float32Array(3);function l(e){return Math.abs(e[1])<1e-6&&Math.abs(e[2])<1e-6&&Math.abs(e[3])<1e-6&&Math.abs(e[5])<1e-6&&Math.abs(e[6])<1e-6&&Math.abs(e[7])<1e-6}function d(e,t,r,i,n){var a,s=t.byteLength/r.values[0].stride|0,o=(0|r.values[0].stride)>>2|0,l=(0|o)*(0|s)|0;if(4===r.primitive)if(n){var d=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),u=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);for(a=0;a<s;a++){var c=a*o;e[h=a*(o-1)]=t[c]+i[0],e[h+1]=t[c+1]+i[1],e[h+2]=t[c+2]+i[2],c<<=2,d[h<<=2]=u[c+12],d[h+4]=u[c+13],d[h+8]=u[c+14]}if(r.values.length>2)if(4===r.values[2].index)for(a=0;a<s;a++){c=6*a+4;e[h=5*a+3]=t[c],e[h+1]=t[c+1]}else for(a=0;a<s;a++){var h;c=5*a+4;e[h=4*a+3]=t[c]}}else{for(a=0;a<l;a+=o)e[a]=t[a]+i[0],e[a+1]=t[a+1]+i[1],e[a+2]=t[a+2]+i[2],e[a+3]=t[a+3];if(r.values.length>2)if(4===r.values[2].index)for(a=4;a<l;a+=o)e[a]=t[a],e[a+1]=t[a+1];else for(a=4;a<l;a+=o)e[a]=t[a]}else for(a=0;a<l;a+=3)e[a]=t[a]+i[0],e[a+1]=t[a+1]+i[1],e[a+2]=t[a+2]+i[2]}function u(e,t,r,i,n,a){var l,d=t.byteLength/r.values[0].stride|0,u=(0|r.values[0].stride)>>2|0,c=(0|u)*(0|d)|0;if(4===r.primitive){var h=new Int8Array(e.buffer,e.byteOffset,e.byteLength),m=new Int8Array(t.buffer,t.byteOffset,t.byteLength);if(i[0]===i[1]&&i[1]===i[2])if(a)for(l=0;l<d;l++){var f=l*u;e[w=l*(u-1)]=t[f]*i[0]+n[0],e[w+1]=t[f+1]*i[1]+n[1],e[w+2]=t[f+2]*i[2]+n[2],f<<=2,h[w<<=2]=m[f+12],h[w+4]=m[f+13],h[w+8]=m[f+14]}else for(l=0;l<c;l+=u)e[l]=t[l]*i[0]+n[0],e[l+1]=t[l+1]*i[1]+n[1],e[l+2]=t[l+2]*i[2]+n[2],e[l+3]=t[l+3];else{var p=s,v=o;if(v[0]=1/i[0],v[1]=1/i[1],v[2]=1/i[2],a)for(l=0;l<d;l++){f=l*u;e[w=l*(u-1)]=t[f]*i[0]+n[0],e[w+1]=t[f+1]*i[1]+n[1],e[w+2]=t[f+2]*i[2]+n[2],w<<=2;var _=m[(f<<=2)+12],g=m[f+13],b=m[f+14];p[0]=_*v[0],p[1]=g*v[1],p[2]=b*v[2];var y=127/Math.sqrt(p[0]*p[0]+p[1]*p[1]+p[2]*p[2]);x=l<<2,h[w]=p[0]*y,h[w+4]=p[1]*y,h[w+8]=p[2]*y}else for(l=0;l<c;l+=u){e[l]=t[l]*i[0]+n[0],e[l+1]=t[l+1]*i[1]+n[1],e[l+2]=t[l+2]*i[2]+n[2];var x=12+(l<<2);_=m[x],g=m[x+1],b=m[x+2];p[0]=_*v[0],p[1]=g*v[1],p[2]=b*v[2];y=127/Math.sqrt(p[0]*p[0]+p[1]*p[1]+p[2]*p[2]);h[x]=p[0]*y,h[x+1]=p[1]*y,h[x+2]=p[2]*y}}if(r.values.length>2)if(a)if(4===r.values[2].index)for(l=0;l<d;l++){f=6*l+4;e[w=5*l+3]=t[f],e[w+1]=t[f+1]}else for(l=0;l<d;l++){var w;f=5*l+4;e[w=4*l+3]=t[f]}else if(4===r.values[2].index)for(l=4;l<c;l+=u)e[l]=t[l],e[l+1]=t[l+1];else for(l=4;l<c;l+=u)e[l]=t[l]}else for(l=0;l<c;l+=3)e[l]=t[l]*i[0]+n[0],e[l+1]=t[l+1]*i[1]+n[1],e[l+2]=t[l+2]*i[2]+n[2]}function c(e,t,r,i,n){var a,o=t.byteLength/r.values[0].stride|0,l=(0|r.values[0].stride)>>2|0,d=(0|l)*(0|o)|0,u=i[0],c=i[1],h=i[2],m=i[3],f=i[4],p=i[5],v=i[6],_=i[7],g=i[8],b=i[9],y=i[10],x=i[11];if(4===r.primitive){var w=s,E=new Int8Array(t.buffer,t.byteOffset,4*d),M=new Int8Array(e.buffer,e.byteOffset,e.byteLength);if(n){for(a=0;a<o;a++){var A=a*(l-1),T=u*(F=t[O=a*l])+m*(C=t[O+1])+v*(B=t[O+2])+b,S=c*F+f*C+_*B+y,k=h*F+p*C+g*B+x;e[A]=T,e[A+1]=S,e[A+2]=k,A<<=2;var D=E[(O<<=2)+12],I=E[O+13],N=E[O+14];w[0]=u*D+m*I+v*N,w[1]=c*D+f*I+_*N,w[2]=h*D+p*I+g*N;var P=127/Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]);M[A]=w[0]*P,M[A+4]=w[1]*P,M[A+8]=w[2]*P}if(r.values.length>2)if(4===r.values[2].index)for(a=0;a<o;a++){var O=6*a+4;e[A=5*a+3]=t[O],e[A+1]=t[O+1]}else for(a=0;a<o;a++){O=5*a+4;e[A=4*a+3]=t[O]}}else{for(a=0;a<d;a+=l){T=u*(F=t[a])+m*(C=t[a+1])+v*(B=t[a+2])+b,S=c*F+f*C+_*B+y,k=h*F+p*C+g*B+x;e[a]=T,e[a+1]=S,e[a+2]=k;var R=12+(a<<2);D=E[R],I=E[R+1],N=E[R+2];w[0]=u*D+m*I+v*N,w[1]=c*D+f*I+_*N,w[2]=h*D+p*I+g*N;P=127/Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]);M[R]=w[0]*P,M[R+1]=w[1]*P,M[R+2]=w[2]*P}if(r.values.length>2)if(4===r.values[2].index)for(a=4;a<d;a+=l)e[a]=t[a],e[a+1]=t[a+1];else for(a=4;a<d;a+=l)e[a]=t[a]}}else for(a=0;a<d;a+=3){var F,C,B;T=u*(F=t[a])+m*(C=t[a+1])+v*(B=t[a+2])+b,S=c*F+f*C+_*B+y,k=h*F+p*C+g*B+x;e[a]=T,e[a+1]=S,e[a+2]=k}}function h(e,t,r,i){for(var n=0;n<r;n++)e[n]=t[n]+(0|i)}function m(e,t,r,i){var n=t.byteLength/r.values[0].stride|0,a=(0|r.values[0].stride)>>2|0,s=(0|a)*(0|n)|0;if(4===r.primitive&&i){for(var o=new Int8Array(t.buffer,t.byteOffset,t.byteLength),l=new Int8Array(e.buffer,e.byteOffset,e.byteLength),d=0,u=0;u<s;u+=a,d+=a-1){e[d]=t[u],e[d+1]=t[u+1],e[d+2]=t[u+2];var c=d<<2,h=u<<2;l[c]=o[h+12],l[c+4]=o[h+13],l[c+8]=o[h+14]}if(r.values.length>2)if(4===r.values[2].index)for(d=3,u=4;u<s;d+=5,u+=6)e[d]=t[u],e[d+1]=t[u+1];else for(d=3,u=4;u<s;d+=4,u+=5)e[d]=t[u]}else e.set(t,0,s)}return e.prototype._populateMergedNode=function(e,n,a){for(var s=this._attributesData[e[8]>>8&255],o=a.indicesOffset,f=e[8],p=this._modelBin.readNodeBBox(e[0]),v=255&e[8],_=[],g=e[0];g>=0;)_.push(g),g=this._nodesInfo[9*g+3];var b=this;_.sort(function(e,t){return(b._nodesInfo[9*e+2]>>24&15)-(b._nodesInfo[9*t+2]>>24&15)});for(var y,x,w,E=0,M=0,A=_.length;M<A;M++){var T=new Int32Array(this._nodesInfo.buffer,36*_[M],9),S=this._modelBin.readNodeTransform(T[0]),k=this._modelBin.readNodeBBox(T[0]),D=this._modelBin.readMesh(T[1]),I=new Float32Array(n,D[1],D[2]/4),N=D[2]/4;i.Config.compressNormals&&s.hasNormal&&(N-=D[2]/s.values[0].stride);var P=new Float32Array(a.verticesBinary,a.verticesOffset,N);0==(1073741824&T[2])?(w=S,Math.abs(w[0]-1)<1e-6&&Math.abs(w[1])<1e-6&&Math.abs(w[2])<1e-6&&Math.abs(w[3])<1e-6&&Math.abs(w[4]-1)<1e-6&&Math.abs(w[5])<1e-6&&Math.abs(w[6])<1e-6&&Math.abs(w[7])<1e-6&&Math.abs(w[8]-1)<1e-6?(t[0]=S[9],t[1]=S[10],t[2]=S[11],d(P,I,s,t,i.Config.compressNormals)):l(S)?(t[0]=S[9],t[1]=S[10],t[2]=S[11],r[0]=S[0],r[1]=S[4],r[2]=S[8],u(P,I,s,r,t,i.Config.compressNormals)):c(P,I,s,S,i.Config.compressNormals)):m(P,I,s,i.Config.compressNormals),a.verticesOffset+=4*N,x=k,(y=p)[0]=Math.min(y[0],x[0]),y[1]=Math.min(y[1],x[1]),y[2]=Math.min(y[2],x[2]),y[3]=Math.max(y[3],x[3]),y[4]=Math.max(y[4],x[4]),y[5]=Math.max(y[5],x[5]);var O=null,R=null,F=0;switch(255&D[0]){case 4:F=D[4]/4,R=new Uint32Array(n,D[3],F);break;case 2:F=D[4]/2,R=new Uint16Array(n,D[3],F);break;default:F=D[4],R=new Uint8Array(n,D[3],F)}switch(v){case 4:O=new Uint32Array(a.indicesBinary,a.indicesOffset,F);break;case 2:O=new Uint16Array(a.indicesBinary,a.indicesOffset,F);break;default:O=new Uint8Array(a.indicesBinary,a.indicesOffset,F)}h(O,R,F,E),T[6]=a.indicesOffset-o,T[7]=F,T[4]=D[2]/s.values[0].stride,E+=T[4],a.indicesOffset+=F*v}new Uint8Array(a.verticesBinary,a.verticesOffset,E).fill(0),a.verticesOffset+=E;for(M=0,A=_.length-1;M<A;M++){var C=_[M];this._nodesInfo[9*C+3]=_[M+1]}C=_[M];this._nodesInfo[9*C+3]=-1,e=new Int32Array(this._nodesInfo.buffer,9*_[0]*4,9);var B=this._modelBin.readNodeBBox(e[0]);return B[0]=p[0],B[1]=p[1],B[2]=p[2],B[3]=p[3],B[4]=p[4],B[5]=p[5],e[8]=f,e[1]=-1,e[2]|=1073741824,e},e}()},"./03scene/model/ModelLoaderTree.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./00utility/m3d_math.js"),n=r("./03scene/model/Element.ts"),a=new Float32Array(6);class s{constructor(e){this._model=e}destroy(){this._model=null,delete this._model}load(e,t){var r=t.getSingleFileProgress();return e["uuid.bin"]?(e["modelgraph.bin"].onProgress(e=>{r(e.loaded)}),e["modelgraph.bin"].downloadFile().then(r=>{var i=r.data,n=t.getSingleFileProgress();return e["uuid.bin"].onProgress(e=>{n(e.loaded)}),e["uuid.bin"].downloadFile().then(e=>{this._parse(i,e.data)})})):(e["modelgraph.bin"].onProgress(e=>{r(e.loaded)}),e["modelgraph.bin"].downloadFile().then(e=>{this._parse(e.data,null)}))}_parse(e,t){var r=this._model.tree,i=new n.default(n.ElementType.ROOT,-1,this._model);r.root=i;var a,s,o,l=e.byteLength,d=0,u=[];u.push(i);for(var c=0;d<e.byteLength;){var h=new Uint8Array(e,d,9);for(a=h[3]<<24|h[2]<<16|h[1]<<8|h[0],s=h[7]<<24|h[6]<<16|h[5]<<8|h[4],o=h[8];u.length>0&&u[u.length-1].id!==s;)u.pop();if(0===u.length)return console.log("father of "+a+" is wrong"),Promise.reject("error");var m=u[u.length-1];if(o===n.ElementType.NODE){let e=r.nodes[a];e.father=m,m.children.push(e)}else{o===n.ElementType.LINK&&(c=a);var f=this._model.name+"+"+c+"/"+a,p=new n.default(o,a,this._model);if(o!==n.ElementType.ELEMENT&&o!==n.ElementType.ROOM&&o!==n.ElementType.AREA||(r.elements[f]=p,r.elementsNum++),t&&o===n.ElementType.ELEMENT){const e=new Uint8Array(t,d/9*16,16);p.guid+=e[3]<16?"0"+e[3].toString(16):e[3].toString(16),p.guid+=e[2]<16?"0"+e[2].toString(16):e[2].toString(16),p.guid+=e[1]<16?"0"+e[1].toString(16):e[1].toString(16),p.guid+=e[0]<16?"0"+e[0].toString(16):e[0].toString(16),p.guid+="-",p.guid+=e[5]<16?"0"+e[5].toString(16):e[5].toString(16),p.guid+=e[4]<16?"0"+e[4].toString(16):e[4].toString(16),p.guid+="-",p.guid+=e[7]<16?"0"+e[7].toString(16):e[7].toString(16),p.guid+=e[6]<16?"0"+e[6].toString(16):e[6].toString(16),p.guid+="-",p.guid+=e[8]<16?"0"+e[8].toString(16):e[8].toString(16),p.guid+=e[9]<16?"0"+e[9].toString(16):e[9].toString(16),p.guid+="-",p.guid+=e[10]<16?"0"+e[10].toString(16):e[10].toString(16),p.guid+=e[11]<16?"0"+e[11].toString(16):e[11].toString(16),p.guid+=e[12]<16?"0"+e[12].toString(16):e[12].toString(16),p.guid+=e[13]<16?"0"+e[13].toString(16):e[13].toString(16),p.guid+=e[14]<16?"0"+e[14].toString(16):e[14].toString(16),p.guid+=e[15]<16?"0"+e[15].toString(16):e[15].toString(16),r.guidElementMap[p.guid]=f}p.father=m,m.children.push(p),u.push(p)}d+=9}var v=0;for(l=i.children.length;v<l;v++)this._computeBBox(i.children[v])}_printTree(e,t){for(var r="",i=0;i<e;i++)r+=" ";if(t.hasOwnProperty("id"))r+="n id="+t.id,console.log(r);else{r+=["root","i","g","e","n","l"][t.type]+" name="+t.name,console.log(r);i=0;for(var n=t.children.length;i<n;i++)this._printTree(e+1,t.children[i])}}_computeBBox(e){for(let t=0,r=e.children.length;t<r;t++){let r,n=e.children[t];n.hasOwnProperty("region")?(this._model.tree.getNodeBBox(n.id,a),r=a):(this._computeBBox(n),r=n.bbox),i.default.aabb.union(e.bbox,e.bbox,r)}}}},"./03scene/model/ModelTree.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(e){this.nodes=[],this.nodeBBoxes=null,this.root=null,this.elements={},this.elementsNum=0,this.model=e,this.guidElementMap={}}destroy(){this.nodes=null,delete this.nodes,this.elements=null,delete this.elements,this.nodeBBoxes=null,delete this.nodeBBoxes,this.root=null,delete this.root,this.guidElementMap=null,delete this.guidElementMap}createNodes(e){this.nodes=new Array(e),this.nodeBBoxes=new Float32Array(6*e)}getNodeBBox(e,t){var r=6*e;t[0]=this.nodeBBoxes[r],t[1]=this.nodeBBoxes[r+1],t[2]=this.nodeBBoxes[r+2],t[3]=this.nodeBBoxes[r+3],t[4]=this.nodeBBoxes[r+4],t[5]=this.nodeBBoxes[r+5]}getElementPaths(e){var t=[];for(var r in e){var i=this.getElementPath(e[r]);i&&t.push(i)}return t}getElementPath(e){let t={elementId:0,docId:0,modelId:""};t.elementId=e.id;const r=e.getDocument();return r?(t.docId=r.id,t.modelId=this.model.name,t):(console.warn("element '"+t.elementId+"' doesn't belong to any doc"),null)}getElementPathString(e){const t=e.getDocument();return t?this.model.name+"+"+t.id+"/"+e.id:(console.warn("element '"+e.id+"' doesn't belong to any doc"),"")}}},"./03scene/model/Node.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"NodeType",function(){return i}),r.d(t,"default",function(){return a});var i,n=r("./03scene/model/Element.ts");!function(e){e[e.STRUCTURE=0]="STRUCTURE",e[e.STRUCTURE_INTERIOR=4]="STRUCTURE_INTERIOR",e[e.INTERIOR=8]="INTERIOR",e[e.MEP=12]="MEP",e[e.LANDSCAPE=15]="LANDSCAPE"}(i||(i={}));class a{constructor(e){this.id=e,this.region=i.STRUCTURE,this.father=null,this.indicesOffset=0,this.indicesCount=0,this.verticesCount=0,this.drawable=null,this.visible=!0,this.platteIndex=127}getInstance(){let e=this.father;for(;e.etype!==n.ElementType.INSTANCE&&null!==(e=e.father););return e}getGroup(){let e=this.father;for(;e.etype!==n.ElementType.GROUP&&null!==(e=e.father););return e}getElement(){let e=this.father;for(;e.etype!==n.ElementType.ELEMENT&&e.etype!==n.ElementType.ROOM&&e.etype!==n.ElementType.AREA&&null!==(e=e.father););return e}getComponent(){let e=this.father;for(;e.etype!==n.ElementType.GROUP&&e.etype!==n.ElementType.INSTANCE&&null!==(e=e.father););return e}}},"./03scene/model/m3d_load_misc.js":function(e,t,r){"use strict";r.r(t),t.default=function(){var e={};const t=new URL(window.location.href).searchParams.get("filePath");return e.OpenImage=function(e,t){return{downloadFile:function(){var r=e;return new t(function(e,t){var i=new XMLHttpRequest;i.onload=function(){var t=URL.createObjectURL(this.response),r=new Image;r.setAttribute("crossorigin","anonymous"),r.onload=function(){e(r),URL.revokeObjectURL(t)},r.src=t},i.open("GET",r,!0),i.responseType="blob",i.send()})}}},e.OpenFile1=function(e,r,i){return{downloadFile:function(n){return new i(function(i,a){let s=new XMLHttpRequest;s.open("GET",(t||"")+e,!0),s||a("CORS not supported"),s.responseType=r,s.onerror=(e=>{a(e)}),s.setRequestHeader("Accept","*/*"),s.onload=(()=>{200===s.status||206===s.status?i({data:s.response}):a("fail to retrieve "+e+" http status error:"+s.status)}),s.onprogress=(e=>{n&&n(e)}),s.send()})},onProgress:function(){}}},e.ProgressTracker=function(e){this._onProgress=e,this._currentDownload=0,this.totalDownload=0},e.ProgressTracker.prototype.onProgress=function(e){this._currentDownload+=e,this._onProgress(Math.max(Math.min(this._currentDownload/this.totalDownload,1),0))},e.ProgressTracker.prototype.getSingleFileProgress=function(){var e=0,t=this;return function(r){var i=r-e;e=r,t.onProgress(i)}},e.MakeIndividualOnProgress=function(e){var t=0;return function(r){var i=r-t;t=r,e.onprogress(i)}},e}()},"./03scene/pawn/Pawn.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return m});var i=r("./00utility/m3d_utils.ts"),n=r("./00utility/m3d_math.js"),a=r("./02resource/m3d_shader_library.js"),s=r("./02resource/Texture.ts"),o=r("./03scene/drawables/Drawable.ts"),l=r("./03scene/materials/MaterialAdhoc.ts"),d=r("./03scene/pawn/PawnLoader.ts"),u=r("./03scene/Entity.ts"),c=r("./03scene/GLTFLoader.ts"),h=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};class m extends u.default{constructor(e,t,r){super(e,t,r)}destroy(){super.destroy()}load(e){return h(this,void 0,void 0,function*(){if(this.drawables.length>0)return void console.error("Can't re-initialize pawn.");let t=new d.default(this,e,this._resourceManager,this._materialManager);return t.load().then(()=>{t.drawables.forEach(e=>{this.addDrawable(e)}),t.destroy()}).catch(e=>{console.warn(e)})})}createSolidCube(e=[.5,.5,.5]){let t=this._resourceManager.getShader(this.name,["MODEL_TRANSFORM"]);t.ready||t.createFromShaderSource(a.default.solid,["MODEL_TRANSFORM"]);let r=this._materialManager.createMaterialAdhoc("pawn-material-"+this.name);r.attachShader(t,this._resourceManager),r.setDiffuse(e),r.setTransparent(1);let i=this._resourceManager.getMesh(this.name);i.createSolidCube(),this.addDrawable(new o.default(i,t,r,null,new Float32Array([-1,-1,-1,1,1,1]))),(t=this._resourceManager.getShader(this.name,["MODEL_TRANSFORM"])).ready||t.createFromShaderSource(a.default.plain,["MODEL_TRANSFORM"]),(r=this._materialManager.createMaterialAdhoc(this.name+"_line")).attachShader(t,this._resourceManager),r.setDiffuse([0,0,0]),r.setTransparent(1),(i=this._resourceManager.getMesh("pawn-material-"+this.name+"_line")).createWiredCube();let s=new Float32Array([-1,-1,-1,1,1,1]);n.default.aabb.scale(s,s,1.01);let l=new o.default(i,t,r,null,s);l.transform.setScaling(1.01,1.01,1.01),this.addDrawable(l),this.bbox?n.default.aabb.union(this.bbox,this.bbox,s):this.bbox=s}createTexturedQuad(e){i.default.isArray(e)||(e=[e]);let t=["MODEL_TRANSFORM"];e.length>1&&t.push("SECOND_TEXTURE");let r=this._resourceManager.getShader(this.name,t);r.ready||r.createFromShaderSource(a.default.plain_texture,t);let d=Array(e.length);for(let t=0;t<e.length;t++){const r=e[t];if(r instanceof s.default)d[t]=e[t];else{d[t]=this._resourceManager.getTexture(this.name+"_"+t);const e=this._resourceManager.gl;var u=r.src.split(".");"png"!==u[u.length-1]&&"svg"!==u[u.length-1]?d[t].createFromImage(r,e.RGB,e.UNSIGNED_BYTE,e.LINEAR,e.CLAMP_TO_EDGE):d[t].createFromImage(r,e.RGBA,e.UNSIGNED_BYTE,e.LINEAR,e.CLAMP_TO_EDGE)}}let c=new l.default("pawn-material-"+this.name,this._resourceManager);c.attachShader(r,this._resourceManager),c.setDiffuse([1,1,1]),c.setTransparent(1),d[0]&&(c.setDiffuseTexture(d[0]),d[0].hasAlpha()&&(c.transparent=!0)),d[1]&&(c.setSecondDiffuseTexture(d[1]),d[1].hasAlpha()&&(c.transparent=!0));let h=this._resourceManager.getMesh(this.name);h.createQuad(!0,!0);let m=new Float32Array([-1,-1,0,1,1,0]);this.addDrawable(new o.default(h,r,c,null,m)),this.bbox?n.default.aabb.union(this.bbox,this.bbox,m):this.bbox=m}loadGltfModel(e){let t=new c.default(this,this._resourceManager,this._materialManager);return new Promise((r,i)=>{t.load(e,()=>{r()})})}getSkeletons(){return this.skeletons}setDiffuseColor(e){this.drawables.forEach(t=>{t.material.setDiffuse(e)})}setOpacity(e){this.drawables.forEach(t=>{t.material.setTransparent(e)})}clone(e){let t=new m(e,this._resourceManager,this._materialManager);return this.drawables.forEach(e=>{t.addDrawable(e.clone())}),t.bbox=n.default.aabb.create(),n.default.aabb.copy(t.bbox,this.bbox),t.faces=this.faces,t.hasContours=this.hasContours,t}}},"./03scene/pawn/PawnBillboard.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return d});var i=r("./00utility/m3d_math.js"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/pawn/Pawn.ts"),s=r("./03scene/pawn/PawnLoader.ts"),o=r("./03scene/drawables/Billboard.ts"),l=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};class d extends a.default{constructor(e,t,r){super(e,t,r)}destroy(){super.destroy()}setFaceCameraZ(e){this.drawables.forEach(t=>{t.transform.setFaceCameraZ(e)})}load(e){return l(this,void 0,void 0,function*(){if(this.drawables.length>0)return void console.error("Can't re-initialize pawn.");let t=new s.default(this,e,this._resourceManager,this._materialManager,!0);return t.load().then(()=>{t.drawables.forEach(e=>{this.addDrawable(e)}),t.destroy()}).catch(e=>{console.warn(e)})})}createSolidQuad(e=[.5,.5,.5]){let t=this._resourceManager.getShader(this.name,["MODEL_TRANSFORM"]);t.ready||t.createFromShaderSource(n.default.plain,["MODEL_TRANSFORM"]);let r=this._materialManager.createMaterialAdhoc("pawn-billboard-material-"+this.name);r.attachShader(t,this._resourceManager),r.setDiffuse(e);let a=this._resourceManager.getMesh(this.name);a.createQuad(!0,!0,!0),this.addDrawable(new o.default(a,t,r,null,new Float32Array([-1,0,-1,1,0,1])));let s=new Float32Array([-1,0,-1,1,0,1]);i.default.aabb.scale(s,s,1.01),this.bbox?i.default.aabb.union(this.bbox,this.bbox,s):this.bbox=s}createTexturedQuad(e){let t=this._resourceManager.getShader(this.name,["MODEL_TRANSFORM"]);t.ready||t.createFromShaderSource(n.default.plain_texture,["MODEL_TRANSFORM"]);let r=this._resourceManager.getTexture(this.name);const a=this._resourceManager.gl;let s=e.src.split(".");"png"!==s[s.length-1]&&"svg"!==s[s.length-1]?r.createFromImage(e,a.RGB,a.UNSIGNED_BYTE,a.LINEAR,a.CLAMP_TO_EDGE):r.createFromImage(e,a.RGBA,a.UNSIGNED_BYTE,a.LINEAR,a.CLAMP_TO_EDGE);let l=this._materialManager.createMaterialAdhoc("pawn-billboard-material-"+this.name);l.attachShader(t,this._resourceManager),l.setDiffuseTexture(r),l.setDiffuse([1,1,1]),r.hasAlpha()&&(l.transparent=!0);let d=this._resourceManager.getMesh(this.name);d.createQuad(!0,!0,!0),this.addDrawable(new o.default(d,t,l,null,new Float32Array([-1,0,-1,1,0,1])));let u=new Float32Array([-1,0,-1,1,0,1]);i.default.aabb.scale(u,u,1.01),this.bbox?i.default.aabb.union(this.bbox,this.bbox,u):this.bbox=u}}},"./03scene/pawn/PawnLoader.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return m});var i=r("./01wrapper/glenum.ts"),n=r("./00utility/Environment.ts"),a=r("./02resource/MeshAttributes.ts"),s=r("./03scene/drawables/Drawable.ts"),o=r("./03scene/drawables/Billboard.ts"),l=r("./03scene/model/ModelLoaderBin.ts"),d=r("./99api/utils/model/downloader.ts"),u=r("./02resource/m3d_shader_library.js"),c=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})},h=new Float32Array(16);class m{constructor(e,t,r,i,n=!1){this._pawn=e,this._modelId=t,this._resourceManager=r,this._materialManager=i,this._billboard=n,this._sceneJson=null,this._modelJson=null,this._binLoader=null,this.drawables=[]}destroy(){this._pawn=null,delete this._pawn,this._modelId=null,delete this._modelId,this._resourceManager=null,delete this._resourceManager,this._materialManager=null,delete this._materialManager,this._sceneJson=null,delete this._sceneJson,this._modelJson=null,delete this._modelJson,this._binLoader.destroy(),this._binLoader=null,delete this._binLoader,this.drawables=null,delete this.drawables}load(){return c(this,void 0,void 0,function*(){return Object(d.generatePromises)(this._modelId).then(e=>e["scene.json"].downloadFile().then(t=>{let r;if(r="string"==typeof t.data?JSON.parse(t.data):t.data,this._sceneJson=r,r.source){const e=this._sceneJson.source.split(".");switch(e[e.length-1]){case"skp":this._pawn.faces=2,this._pawn.hasContours=!0;break;case"rfa":case"rvt":this._pawn.faces=1,this._pawn.hasContours=!0;break;case"vgx":case"stl":case"max":this._pawn.faces=1;break;case"obj":case"3dm":case"nwd":this._pawn.faces=0;break;default:this._pawn.faces=1}}return this._load(e,r)}))})}_load(e,t){return c(this,void 0,void 0,function*(){return this._sceneJson=t,e["model.json"].downloadFile().then(r=>(this._modelJson=r.data,this._pawn.bbox=new Float32Array(this._modelJson["model.bin"].bbox),e["scene.bin"].downloadFile().then(r=>{let i=r.data;return e["model.bin"].downloadFile().then(r=>{let n=r.data;return this._binLoader=new l.default(t,i,this._modelJson,n),this._loadTextures(e).then(()=>this._loadMeshes(e))})})))})}_loadTextures(e){return c(this,void 0,void 0,function*(){if(0===this._sceneJson.textures.length)return Promise.resolve("ok");for(var t=new Array(this._sceneJson.samplers.length),r=0,n=this._sceneJson.samplers.length;r<n;r++){t[r]={filter:i.gl.LINEAR_MIPMAP_LINEAR,wrap:i.gl.REPEAT};var a=this._binLoader.readSampler(r);1===a[0]?t[r].filter=1===a[2]?i.gl.LINEAR_MIPMAP_LINEAR:i.gl.LINEAR:t[r].filter=1===a[2]?i.gl.NEAREST_MIPMAP_NEAREST:i.gl.NEAREST,t[r].wrap=1===a[1]?i.gl.REPEAT:i.gl.CLAMP_TO_EDGE}let s={};Object.keys(e).forEach(function(t){var r=t.toLowerCase();s[r]=e[t]});let o=e=>{var r=this._sceneJson.textures[e].name,n=r.toLowerCase();return s[n].downloadFile().then(n=>{var a=this._binLoader.readTexture(e),s=t[a[1]],o=this._resourceManager.getTexture(r),l=4===a[0]?i.gl.RGBA:i.gl.RGB;if(o.updateImage(n,l,i.gl.UNSIGNED_BYTE,s.filter,s.wrap),!o.ready)return Promise.reject("modelo3d loader errors at creating texture object '"+r+"'.")})};var l=o(0);for(r=1,n=this._sceneJson.textures.length;r<n;r++)l=function(e){return l.then(function(){return o(e)})}(r);return l})}_loadMeshes(e){return c(this,void 0,void 0,function*(){var t=new Array(this._sceneJson.attributes.length),r=[i.gl.POINTS,i.gl.LINES,i.gl.LINES,i.gl.LINES,i.gl.TRIANGLES],s=[i.gl.BYTE,i.gl.UNSIGNED_BYTE,i.gl.SHORT,i.gl.UNSIGNED_SHORT,i.gl.INT,i.gl.UNSIGNED_INT,0,i.gl.FLOAT,0];for(let e=0,n=this._sceneJson.attributes.length;e<n;e++){t[e]=new a.default;this._sceneJson.attributes[e];var o=this._binLoader.readAttribute(e);t[e].primitive=r[o[0]];var l=o[1]>=0?s[o[1]]:null,d=o[2]>=0?s[o[2]]:null,u=o[3]>=0?s[o[3]]:null;t[e].builtin(i.gl.FLOAT,l,d,u)}for(var c=this._modelJson["model.bin"].nodes,h=this._modelJson.buffers.length,m=0,f=0;f<h;f++)m+=this._modelJson.buffers[f].byteLength;if(m>1024*n.Environment.gpuMemory*1024)throw new Error("No enough GPU memory to load this model: "+m);let p=new Array(h);for(let e=0;e<h;e++)p[e]=[];for(f=0;f<c;f++){const e=this._binLoader.readNodeData(f);var v=this._binLoader.readMesh(e[1])[0]>>16;p[v].push(f)}let _=0,g=0;for(let e=0,t=p.length;e<t;++e){for(var b=p[e],y=0,x=0,w=0,E=b.length;w<E;w++){const e=this._binLoader.readNodeData(b[w]),t=this._binLoader.readMesh(e[1]);let r=t[2],i=t[4];y+=r=r+3&-4,x+=i=i+3&-4}_<y&&(_=y),g<x&&(g=x)}let M=new ArrayBuffer(_),A=new ArrayBuffer(g),T=this._loadMesh(0,e["mesh0.bin"],p,M,A,t);for(let r=1,i=this._modelJson.buffers.length;r<i;r++)T=(r=>T.then(()=>{var i="mesh"+r.toString()+".bin";return this._loadMesh(r,e[i],p,M,A,t)}))(r);return T})}_loadMesh(e,t,r,n,a,s){return t.downloadFile().then(t=>{const o=t.data;let l=r[e],d=this._resourceManager.getBuffer(this._modelId+"vmesh"+e+".bin"),u=this._resourceManager.getBuffer(this._modelId+"imesh"+e+".bin"),c=!1;d.ready||u.ready||(d.create(i.gl.ARRAY_BUFFER,new Uint8Array(1)),u.create(i.gl.ELEMENT_ARRAY_BUFFER,new Uint8Array(1)),c=!0);let h=0,m=0;for(var f=0,p=l.length;f<p;++f){var v=l[f],_=this._binLoader.readNodeData(v),g=this._binLoader.readMesh(_[1]);const e=g[0]>>8&255,t=s[e];let r=null;if(this._resourceManager.hasMesh(this._modelId+_[1]))r=this._createDrawable(v,_,g,t,d,u,null,null);else{let e=new Uint8Array(n,h,g[2]),i=new Uint8Array(a,m,g[4]);var b=new Uint8Array(o,g[1],g[2]);e.set(b);var y=new Uint8Array(o,g[3],g[4]);i.set(y),h=(h+=g[2])+3&-4,m=(m+=g[4])+3&-4,r=this._createDrawable(v,_,g,t,d,u,e,i)}this.drawables.push(r)}c&&(d.update(new Uint8Array(n,0,h)),u.update(new Uint8Array(a,0,m)))})}_createDrawable(e,t,r,i,n,a,l,d){const u=255&r[0];var c,m=this._createShaderObject(t,i);if(m){var f=this._createMaterialObject(t,m,i);if(f){var p=this._createMeshObject(t[1],i,u,l,d,n,a);if(p){var v=null;0==(1073741824&t[2])&&(c=this._binLoader.readNodeTransform(e),h[0]=c[0],h[1]=c[1],h[2]=c[2],h[3]=0,h[4]=c[3],h[5]=c[4],h[6]=c[5],h[7]=0,h[8]=c[6],h[9]=c[7],h[10]=c[8],h[11]=0,h[12]=c[9],h[13]=c[10],h[14]=c[11],h[15]=1,v=h);var _=this._binLoader.readNodeBBox(e);let r;return(r=this._billboard?new o.default(p,m,f,v,_):new s.default(p,m,f,v,_)).visible=!0,r}throw new Error("No enough GPU memory for new meshes.")}}}_createMeshObject(e,t,r,n,a,s,o){var l=this._resourceManager.getMesh(this._modelId+e);if(!l.ready){var d=[i.gl.UNSIGNED_BYTE,i.gl.UNSIGNED_BYTE,i.gl.UNSIGNED_SHORT,i.gl.UNSIGNED_SHORT,i.gl.UNSIGNED_INT];let e=t.clone();for(var u=0,c=t.values.length;u<c;u++)e.values[u].offset+=n.byteOffset;l.createShared(e.primitive,e,n,a,d[r],s,o)}return l}_createMaterialObject(e,t,r){var n=this._sceneJson.materials[65535&e[0]];r.primitive===i.gl.LINES&&(n="mxLine-"+n);var a=this._materialManager.getMaterial(this._modelId+n);if(!a){var s=this._binLoader.readMaterial(65535&e[0]);(a=this._materialManager.createMaterialAdhoc(this._modelId+n)).attachShader(t);var o=[0,0,0];if(o[0]=s[0]/255,o[1]=s[1]/255,o[2]=s[2]/255,a.setDiffuse(o),a.setTransparent(s[3]/255),255!==s[4]){var l=s[5]<<8|s[4],d=this._modelId+this._sceneJson.textures[l].name,u=this._binLoader.readTexture(l);4===u[0]?1===u[2]?(a.hasMask=!0,a.transparent=!1):a.transparent=!0:a.transparent?a.transparent=!0:a.transparent=!1;var c=this._resourceManager.getTexture(d);a.setDiffuseTexture(c)}}return a}_createShaderObject(e,t){const r=this._binLoader.readMaterial(65535&e[0]),n=255!==r[4];let a="solid";t.primitive===i.gl.LINES?a="plain":t.hasColor?a="color":n&&(a="texture");var s=[];if(e[2]>>30&1&&!this._billboard||s.push("MODEL_TRANSFORM"),n){var o=r[5]<<8|r[4];this._binLoader.readTexture(o)[2]&&s.push("ALPHATEST")}var l=this._resourceManager.getShader(a,s);if(!l.ready){var d=u.default[a];if(l.createFromShaderSource(d,s),!l.ready)throw"modelo3d error at creating shader '"+a+"'!"}return l}}},"./03scene/text/Text3D.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return l});var i=r("./00utility/m3d_math.js"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/drawables/Drawable.ts"),s=r("./03scene/materials/MaterialText.ts"),o=r("./03scene/Entity.ts");class l extends o.default{constructor(e,t,r){super(e,t,r),this._content=""}destroy(){super.destroy()}setContent(e){if(e!==this._content){this._content=e;var t=this._resourceManager.getBitmapFont().getGlyphs(e);if(this.drawables[0]&&this.drawables[0].mesh.ready)this.drawables[0].mesh.destroy(),this.drawables[0].mesh=this._resourceManager.getMesh("text3d-"+e),this.drawables[0].mesh.ready||this.drawables[0].mesh.createTextGrid(t);else{let r=this._resourceManager.getMesh("text3d-"+e);r.ready||r.createTextGrid(t);let a=this._resourceManager.getShader("text3d-"+this.name,["MODEL_TRANSFORM"]);a.ready||a.createFromShaderSource(n.default.df_text,["MODEL_TRANSFORM"]);let o=new s.default("text3d-material-"+this.name,this._resourceManager);o.attachShader(a,this._resourceManager),o.setFontBitmap(this._resourceManager.getBitmapFont().getTexture()),o.setColor([0,0,0]),o.transparent=!0;let l=new Float32Array([-1,-1,0,1,1,0]);this.addDrawable(this._createDrawable(r,a,o,l)),this.bbox?i.default.aabb.union(this.bbox,this.bbox,l):this.bbox=l}}}setColor(e){this.drawables.forEach(t=>{t.material.setColor(e)})}_createDrawable(e,t,r,i){return new a.default(e,t,r,null,i)}}},"./03scene/text/Text3DBillboard.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/text/Text3D.ts"),n=r("./03scene/drawables/Billboard.ts");class a extends i.default{constructor(e,t,r){super(e,t,r)}destroy(){super.destroy()}_createDrawable(e,t,r,i){return new n.default(e,t,r,null,i)}setFaceCameraZ(e){this.drawables.forEach(t=>{t.transform.setFaceCameraZ(e)})}}},"./04renderer/m3d_samples.js":function(e,t,r){"use strict";var i;r.r(t),t.default=(i={_2X2:[.375,.125,.875,.375,.125,.625,.625,.875],_4X2:[9/16,5/16,7/16,.6875,.8125,9/16,5/16,3/16,3/16,.8125,1/16,7/16,.6875,.9375,.9375,1/16],_4X4:[9/16,9/16,.125,.75,.75,7/16,.5,1/16,.8125,.6875,1/16,0,.6875,3/16,5/16,.625,.375,.875,.25,.125,0,.5,.875,.9375,3/16,.375,.9375,.25,7/16,5/16,.625,.8125],_4x4_2D:[.524814,.56488,.74661,.664308,.694092,.462367,.623577,.267783,.340815,.790118,.247202,.532242,.36916,.311385,.825046,.312099,.72246,.905,.27684,.092381,.72246,.905,.943712,.7082,.019365,.400172,.03138,.65182,.995488,.433175,.637063,.021535,.412268,.984494],_8x8_2D:[.501506,.536596,.479138,.43034,.397053,.487056,.591406,.449082,.497369,.644404,.381063,.588818,.636382,.583616,.52319,.33336,.37642,.379573,.713274,.461703,.283159,.497054,.590899,.697271,.670374,.344963,.385952,.705203,.424452,.277044,.764748,.543555,.603993,.250593,.494041,.772178,.258782,.641709,.246434,.369532,.755129,.628899,.309775,.274196,.706395,.722131,.512554,.195892,.790205,.3784,.61636,.797562,.29905,.751101,.174923,.45043,.698505,.236127,.381569,.18237,.161473,.556691,.848478,.467565,.555191,.851308,.378558,.839659,.791231,.280491,.8164,.702177,.875051,.595993,.645256,.140087,.187367,.259117,.48844,.895837,.7087,.838936,.194892,.757962,.126029,.354896,.25983,.168335,.447763,.0934675,.266928,.837262,.551968,.0880472,.118845,.673752,.76843,.163361,.062746,.469565,.62316,.924319,.916225,.344364,.330463,.0834606,.819568,.817768,.050363,.590149,.912991,.727568,.87403,.207755,.97926,.489109,.400768,.969595,.289428,.936614,.030082,.356932,.514659,.992979,.177672,.877666,.632581,.0178981],_8x8_3D:[.93678,.207818,-.281522,.155734,-.528496,-.834529,.318403,.287368,.903349,.217197,-.610563,.761602,.439011,.210822,.873397,.977207,.053257,.205501,.641795,.546048,.538453,.348168,-.458926,-.817414,.170284,-.774256,-.609534,.160135,.980561,.113387,.106271,.295349,.949461,-.914237,-.074791,.398217,-.77951,-.543208,-.311912,.027064,-.908468,.417077,-.10138,-.994828,.006289,-.883905,-.028965,-.466769,.895093,-.435134,.097299,.1881,.388757,-.901935,.865264,.331237,.376298,-.208541,.948524,-.238356,.061496,.888755,.454239,-.572418,.589289,.570154,-.605071,-.187697,-.773731,-.888205,.306047,.342678,.772958,-.048692,.632586,-.119578,.653396,.747513,-.669006,.120272,.733461,-.299117,-.139439,.943973,.435083,.612268,-.660175,-.646608,-.352291,.676601,.823632,-.163268,-.543115,-.443489,-.863253,.241063,.514024,-.264126,.816098,-.909153,.333005,-.250099,.960448,-.226223,-.162368,.805614,.592417,.005408,.082866,-.252741,.963979,-.979375,-.166776,-.114065,.405677,-.833005,.376204,-.832468,.551533,.052997,-.066544,-.159122,-.985014,.65867,-.609037,-.441846,-.099674,-.912569,-.396589,-.603554,.671968,-.429164,.323987,.045308,-.944976,-.315941,.138344,-.938638,.554968,.829633,-.060986,-.244659,.560061,-.791501,.379228,.719356,.581991,.699318,-.522353,.487956,-.879993,-.450901,.149331,.621998,-.062407,-.780528,-.513325,.858183,-.004391,-.612452,-.645248,.456681,.350088,-.913147,-.208811,-.494057,-.596705,-.632338,-.23826,-.632492,.737011,.729728,.460782,-.505151,.625231,-.779835,.030709,-.377751,.867056,.324836,-.035872,.799911,-.599045,.263772,.905962,-.331144,-.517616,-.829878,-.208271,-.640118,.321235,-.697894],_8x8_2D_LIST:[]},function(){function e(e,t){for(var r=0,i=1/e,n=t;n>0;n=Math.floor(n/e))r+=i*(n%e),i/=e;return r}for(var t=0;t<64;++t){var r=e(2,t)*Math.PI,n=e(3,t);i._8x8_2D_LIST[t]=[];for(var a=Math.cos(r),s=Math.sin(r),o=0;o<8;++o){var l=(o+n+.125*Math.random())/8;i._8x8_2D_LIST[t][2*o]=a*l,i._8x8_2D_LIST[t][2*o+1]=s*l}}}(),i)},"./04renderer/pipeline/Blit.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/materials/MaterialBlit.ts"),n=r("./02resource/m3d_shader_library.js");class a{constructor(e,t=null,r=!1){this._resourceManager=e,t||(t=n.default.blit),this._shader=e.getShader(t.name,[]),this._shader.ready||this._shader.createFromShaderSource(t,r?["MOBILE"]:[]),this.ready=this._shader.ready,this.ready?(this._material=new i.default(t.name),this._material.attachShader(this._shader)):this._material=null}destroy(){this.ready&&(this._material.destroy(),this._material=null,delete this._material,this._shader.destroy(),this._shader=null,delete this._shader,this.ready=!1),this._resourceManager=null,delete this._resourceManager}setTexture(e){this._material.setTexture(e)}setForegroundTexture(e){this._material.setForegroundTexture(e)}setDepthTexture(e){this._material.setDepthTexture(e)}setParameter(e,t){this._material.parameters[e].value=t}render(e,t,r=!1,i=!1){if(this.ready&&t.ready){const c=this._shader.getGL();var n=t.getOption("depthMask");t.setOption("depthMask",!1);var a=i?c.GREATER:c.ALWAYS,s=t.getOption("depthFunc");t.setOption("depthFunc",a);var o=t.getOption("blend");t.setOption("blend",r||!1);var l=[1/t.getWidth(),1/t.getHeight()];this._material.setInvResolution(l),t.always=!0,e.drawScreen(t,this._shader,this._material),t.setOption("depthMask",n),t.setOption("depthFunc",s),t.setOption("blend",o),e.renderState.blend(t.getOption("blend")),e.renderState.depthTest(t.getOption("depthTest"),t.getOption("clearDepth"),t.getOption("depthFunc")),e.renderState.depthMask(t.getOption("depthMask"));var d=this._material.parameters;for(var u in d)d[u].texUnit>=0&&(c.activeTexture(c.TEXTURE0+d[u].texUnit),c.bindTexture(c.TEXTURE_2D,null))}}recompile(e,t){let r=this._shader;const i=r.flags.lastIndexOf(e);let n,a=!1;if(t?-1===i&&(n=r.flags.concat(e),a=!0):-1!==i&&((n=r.flags.slice(0)).splice(i,1),a=!0),a){const e=r.shaderSource.name,t=this._resourceManager.getShader(e,n);if(!t.ready&&(t.createFromShaderSource(r.shaderSource,n),!t.ready))throw new Error("Failed to create shader '"+e+"'!");this._shader=t,this._material.attachShader(this._shader)}}}},"./04renderer/pipeline/RenderPass.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(e,t,r,i){this.queue=t.getQueue(i),this._renderQueueManager=t,this._resourceManager=e,this._overridedMaterial=null,this._overridedShaders=[null,null,null],this._needSort=r,this._cullFace=e.gl.CCW,this._visible=!0}destroy(){this._overridedShaders=null,delete this._overridedShaders,this._overridedMaterial=null,delete this._overridedMaterial,this._resourceManager=null,delete this._resourceManager,this._renderQueueManager=null,delete this._renderQueueManager}setCullFace(e){this._cullFace=e}getCullFace(){return this._cullFace}getVisibility(){return this._visible}setVisibility(e){this._visible=e}render(e,t,r,i,n,a){this._visible&&this.queue.isValid()&&(this._needSort&&this.queue.sort(r),t.drawDrawables(e,this.queue.drawables,r,this._overridedShaders,this._overridedMaterial,n,a,i,null,this._cullFace))}setOverridedMaterial(e){this._overridedMaterial=e,this._overridedMaterial&&this._overridedShaders[0]&&this._overridedMaterial.attachShader(this._overridedShaders[0])}getOverridedMaterial(){return this._overridedMaterial}getOverridedShaders(){return this._overridedShaders}setOverridedShader(e){if(this._overridedShaders[0]=e,this._overridedMaterial&&this._overridedShaders[0]&&this._overridedMaterial.attachShader(this._overridedShaders[0]),e){var t=e.flags.concat("MODEL_TRANSFORM"),r=this._resourceManager.getShader(e.shaderSource.name,t);r.ready||r.createFromShaderSource(e.shaderSource,t),this._overridedShaders[1]=r;var i=t.concat("INSTANCING"),n=this._resourceManager.getShader(e.shaderSource.name,i);n.ready||n.createFromShaderSource(e.shaderSource,i),this._overridedShaders[2]=n}}recompileOverridedShader(e,t){for(var r=0;r<this._overridedShaders.length;r++){let i=this._overridedShaders[r];if(!i)continue;const n=i.flags.lastIndexOf(e);let a,s=!1;if(t?-1===n&&(a=i.flags.concat(e),s=!0):-1!==n&&((a=i.flags.slice(0)).splice(n,1),s=!0),s){const e=i.shaderSource.name,t=this._resourceManager.getShader(e,a);if(!t.ready&&(t.createFromShaderSource(i.shaderSource,a),!t.ready))throw new Error("Failed to create shader '"+e+"'!");this._overridedShaders[r]=t}}}addDrawable(e){return this.queue.addDrawable(e)}removeDrawable(e){return this.queue.removeDrawable(e)}createQueue(e,t){return this.queue.create(e,t)}optimize(){this.queue.optimize()}}},"./04renderer/pipeline/RenderPassEdgeMap.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./04renderer/pipeline/RenderPass.ts");class n extends i.default{constructor(e,t){super(e,t,!1,{line:!0})}render(e,t,r,i,n,a){if(this.queue.isValid()){if(null!==this._overridedMaterial&&this._overridedMaterial.transparent){var s=e.getOption("blend");e.setOption("blend",!0),e.always=!0}t.drawLinesWithVertexIds(e,this.queue.drawables,r,this._overridedShaders,this._overridedMaterial,n),null!==this._overridedMaterial&&this._overridedMaterial.transparent&&(e.setOption("blend",s),e.always=!0)}}}},"./04renderer/pipeline/RenderPassNode.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./04renderer/pipeline/RenderPass.ts");class n{constructor(e){this.drawable=e.drawable,this.indexSize=this.drawable.mesh.indexSize,this.indicesOffset=e.indicesOffset,this.indicesCount=e.indicesCount,this.modelNode=e}destroy(){this.drawable=null,delete this.drawable,this.modelNode=null,delete this.modelNode}}class a extends i.default{constructor(e,t){super(e,t,!1,{}),this._lineColor=[0,0,0],this._queue=[]}destroy(){for(let e=0;e<this._queue.length;++e)this._queue[e].destroy();this._queue=null,delete this._queue,super.destroy()}clone(){let e=new a(this._resourceManager,this._renderQueueManager);e._queue=new Array(this._queue.length);for(let t=0;t<this._queue.length;t++)e._queue[t]=new n(this._queue[t].modelNode),e._queue[t].indicesCount=this._queue[t].indicesCount;return e._lineColor=this._lineColor.slice(0),e}render(e,t,r,i,n,a){if(0!==this._queue.length){if(null!==this._overridedMaterial&&this._overridedMaterial.transparent){var s=e.getOption("blend");e.setOption("blend",!0),e.always=!0}t.drawElements(e,this._queue,r,n,a,i,this._cullFace,this._overridedShaders,this._overridedMaterial),null!==this._overridedMaterial&&this._overridedMaterial.transparent&&(e.setOption("blend",s),e.always=!0)}}setLineColor(e){this._lineColor=e}isValid(){return this._queue.length>0}getNodes(){return this._queue}removeNodes(e){e.forEach(e=>{let t=this._queue.findIndex(function(t){return t.modelNode===e});-1!==t&&this._queue.splice(t,1)})}setNodes(e){let t="";for(let e=0;e<this._queue.length;++e){const r=this._queue[e].drawable;t!==r.name&&r.mesh.isLine()&&(r.material.setDiffuse(this._lineColor),t=r.name),this._queue[e].destroy()}if(this._queue=[],!e)return;e.sort(function(e,t){let r=0;return 0!==(r=e.drawable.nodes[0].id-t.drawable.nodes[0].id)?r:e.indicesOffset-t.indicesOffset});let r=null;for(let t=0,i=e.length;t<i;t++){const i=e[t],a=e[t].drawable;if(r!==a)a.mesh.isLine()&&a.material.setDiffuse([.96,.32,.14]),this._queue.push(new n(i)),r=a;else{const e=this._queue[this._queue.length-1];a.transform.count>1?e.indicesOffset+1===i.indicesOffset?e.indicesCount+=1:this._queue.push(new n(i)):e.indicesOffset+e.indicesCount*e.indexSize===i.indicesOffset?e.indicesCount+=i.indicesCount:this._queue.push(new n(i))}}}}},"./04renderer/pipeline/RenderPassTransparent.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./04renderer/pipeline/RenderPass.ts"),n=r("./04renderer/rendereffects/OIT.ts");class a extends i.default{constructor(e,t,r){super(e,t,!0,r),this._oitEnabled=!1,this._oit=null}destroy(){this._oitEnabled=null,delete this._oitEnabled,this._oit&&(this._oit.destroy(),this._oit=null,delete this._oit),super.destroy()}setOITEnabled(e){this._oitEnabled=e,this._oitEnabled&&!this._oit&&(this._oit=new n.default(this._resourceManager,this._renderQueueManager),this.queue.drawables.forEach(e=>{this._oit.addDrawable(e)}))}resize(e,t){this._oit&&this._oit.resize(e,t)}setOverridedMaterial(e){super.setOverridedMaterial(e),this._oit&&this._oit.setOverridedMaterial(e)}setOverridedShader(e){if(null!==e){if(this._overridedMaterial){var t=this._overridedMaterial;this._overridedMaterial=this._overridedMaterial.clone("overridedMaterial")}super.setOverridedShader(e),t&&(this._overridedMaterial=t)}else super.setOverridedShader(e)}addDrawable(e){return this._oit&&this._oit.addDrawable(e),super.addDrawable(e)}removeDrawable(e){return this._oit&&this._oit.removeDrawable(e),super.removeDrawable(e)}createQueue(e,t){this._oit&&this._oit.createQueue(e,t),super.createQueue(e,t)}render(e,t,r,i,n,a){if(this._oitEnabled)this._oit.render(e,t,r,i,n,a);else{const s=this._resourceManager.gl;e.setOption("blend",!0),e.always=!0,e.setOption("blendFunc",[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA]),this._overridedMaterial&&this._overridedMaterial.transparent,super.render(e,t,r,i,n,a),e.setOption("blend",!1),e.always=!0}}}},"./04renderer/pipeline/RenderQueue.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./glMatrix.js");class n{constructor(e,t){this.name=e,this.drawables=[],this._lastUpdated=-1.01,this._setSelector(t)}destroy(){this.drawables=null,delete this.drawables}removeDrawables(){this.drawables=[]}removeDrawable(e){for(let t=this.drawables.length-1;t>=0;t--)if(this.drawables[t]===e)return this.drawables.splice(t,1),!0;return!1}addDrawable(e){return!(!e.visible||!this._selector(e)||-1!=this.drawables.indexOf(e))&&(this.drawables.push(e),!0)}create(e,t){if(!(this._lastUpdated>=t)){for(var r in this.drawables=[],e.models)for(var i=e.models[r],n=0,a=i.drawables.length;n<a;n++)this.addDrawable(i.drawables[n]);if(null!=e.terrain)for(var s=e.terrain,o=0,l=s.tiles.length;o<l;o++)this.addDrawable(s.tiles[o].drawable);this._lastUpdated=t,this.optimize()}}isValid(){return this.drawables.length>0}optimize(){0!==this.drawables.length&&this.drawables.sort(function(e,t){return e.shader.name.localeCompare(t.shader.name)})}update(e){for(var t=0,r=this.drawables.length;t<r;++t)this.drawables[t].update(e)}_setSelector(e){this._selector=function(t){return!e||(void 0===e.line||e.line===t.mesh.isLine())&&((void 0===e.texture||e.texture===t.material.hasTexture)&&((void 0===e.color||e.color===t.mesh.attributes.hasColor)&&((void 0===e.mask||e.mask===t.material.hasMask)&&((void 0===e.transparent||e.transparent===t.material.transparent)&&(void 0===e.shadowCaster||e.shadowCaster===t.isShadowCaster())))))}}sort(e){if(this.isValid()){for(var t=e.getViewDirection(),r=i.vec3.fromValues(),n=0,a=this.drawables.length;n<a;++n){var s=this.drawables[n];i.vec3.subtract(r,s.bsphere,e.eye),s.distance=i.vec3.dot(r,t)}this.drawables.sort(function(e,t){return t.distance-e.distance})}}copy(e,t){if(this.name!==e.name&&!(this._lastUpdated>=t&&t>0)){this.drawables=[];for(let t=0;t<e.drawables.length;t++){const r=e.drawables[t];this._selector(r)&&this.drawables.push(r)}t>0&&(this._lastUpdated=t)}}}},"./04renderer/pipeline/RenderQueueManager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./04renderer/pipeline/RenderQueue.ts");class n{constructor(){this._queues=new Map}destroy(){this._queues.clear(),this._queues=null,delete this._queues}getQueue(e){var t="";return e?(t+=void 0===e.line?"":e.line?"_Line_":"_Not_Line_",t+=void 0===e.texture?"":e.texture?"_Texture_":"_Not_Texture_",t+=void 0===e.color?"":e.color?"_Color_":"_Not_Color_",t+=void 0===e.mask?"":e.mask?"_Mask_":"_Not_Mask_",t+=void 0===e.transparent?"":e.transparent?"_Transparent_":"_Not_Transparent_",t+=void 0===e.shadowCaster?"":e.shadowCaster?"_ShadowCaster_":"_Not_ShadowCaster_",t+=void 0===e.uniqueId?"":e.uniqueId):t="default",this._queues.has(t)||this._queues.set(t,new i.default(t,e)),this._queues.get(t)}}},"./04renderer/pipeline/RenderScene.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return c});var i=r("./00utility/Environment.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./04renderer/rendereffects/RenderEffectLibrary.ts"),s=r("./04renderer/pipeline/RenderQueueManager.ts"),o=r("./04renderer/pipeline/RenderTarget.ts"),l=r("./04renderer/pipeline/RenderPass.ts"),d=r("./04renderer/pipeline/RenderPassTransparent.ts"),u=r("./04renderer/pipeline/RenderPassNode.ts");class c{constructor(e,t,r,i,n){this._scene=e,this._camera=t,this._resourceManager=r,this._renderer=i,this.previous=null,this._effects={},this._sortedEffects=[],this._visualizes=[],this._renderQueueManager=new s.default,this._opaques=new l.default(r,this._renderQueueManager,!1,{line:!1,transparent:!1,mask:!1}),this._maskeds=new l.default(r,this._renderQueueManager,!1,{line:!1,transparent:!1,mask:!0}),this._transparents=new d.default(r,this._renderQueueManager,{line:!1,transparent:!0}),this._lines=new l.default(r,this._renderQueueManager,!1,{line:!0}),this._nodes=new u.default(r,this._renderQueueManager),this._renderPassAll=new d.default(r,this._renderQueueManager,{line:!1}),this._skeletons=[],this._flags={doubleSided:!1,clipping:!1,line:!1,oit:!1,overridedMaterial:!1};const a=this._resourceManager.gl;a.isWebGL2?(this._renderTarget=new o.default("pipeline",this._resourceManager,t.viewport[2],t.viewport[3],{stencilTest:!!n,samples:a.wbSamples,depthFunc:a.LEQUAL,colorFilter:a.NEAREST,colorFormat:a.wbFormat,colorBuffer:0,depthBuffer:0,depthFilter:a.NEAREST}),this._renderTarget.ready||(console.warn("Can't create multisamples render buffer for 'pipeline' and use single-sample render buffer now."),this._renderTarget=new o.default("pipeline",this._resourceManager,t.viewport[2],t.viewport[3],{stencilTest:!!n,samples:1,depthFunc:a.LEQUAL,colorFilter:a.NEAREST,colorFormat:a.wbFormat,colorBuffer:0,depthBuffer:0,depthFilter:a.NEAREST}))):this._renderTarget=new o.default("default",this._resourceManager,t.viewport[2],t.viewport[3],{stencilTest:!!n,depthFunc:a.LEQUAL,colorFilter:a.NEAREST,colorFormat:a.wbFormat,colorBuffer:0,depthBuffer:0,depthFilter:a.NEAREST})}destroy(){this._scene=null,delete this._scene,this._camera=null,delete this._camera,this._resourceManager=null,delete this._resourceManager,this._renderer=null,delete this._renderer;for(let e in this._effects)this._effects[e].destroy();this._effects=null,delete this._effects,this._sortedEffects=null,delete this._sortedEffects,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._opaques.destroy(),this._opaques=null,delete this._opaques,this._maskeds.destroy(),this._maskeds=null,delete this._maskeds,this._transparents.destroy(),this._transparents=null,delete this._transparents,this._lines.destroy(),this._lines=null,delete this._lines,this._nodes.destroy(),this._nodes=null,delete this._nodes,this._flags=null,delete this._flags,this.previous=null,delete this.previous,this._renderQueueManager.destroy(),this._renderQueueManager=null,delete this._renderQueueManager}draw(e=!1){return!1}drawHD(){}resize(e,t){for(var r in this._effects)this._effects[r].resize(e,t);this._scene.background.skybox&&this._scene.background.skybox.resize(e,t),this._transparents.resize(e,t),this._visualizes.forEach(r=>{r.resize(e,t)})}addEffect(e){if(this._effects.hasOwnProperty(e))return;const t=new a.default[e](this);if(!t.doesSupportMobile(i.Environment.isMobile))return t.destroy(),void console.warn(`Effect ${e} is not supported on mobile!`);this._effects[t.name]=t;let r=this._sortedEffects.length;for(var n=0,s=this._sortedEffects.length;n<s;n++)if(this._sortedEffects[n].priority<t.priority){r=n;break}this._sortedEffects.length===r?this._sortedEffects.push(t):this._sortedEffects.splice(r,0,t),t.onSceneChanged()}removeEffect(e){if(!this._effects.hasOwnProperty(e))return;const t=this._effects[e],r=this._sortedEffects.indexOf(t);this._sortedEffects.splice(r,1),t.destroy(),delete this._effects[e]}getEffect(e){return this._effects.hasOwnProperty(e)?this._effects[e]:(console.warn(`Effect '${e}' does not exist!`),null)}isEffectEnabled(e){return!(!this._effects.hasOwnProperty(e)&&!this._effects[e].isEnabled)}setEffectEnabled(e,t){this._effects.hasOwnProperty(e)||this.addEffect(e),this._effects[e].setEnabled(t)}addVisualize(e){return i.Environment.isMobile&&!e.doesSupportMobile(i.Environment.isMobile)?(e.destroy(),void console.warn(`Visualize ${name} is not supported on mobile!`)):this._resourceManager.gl.isWebGL2||e.doesSupportWebGL1()?void this._visualizes.push(e):(e.destroy(),void console.warn(`Visualize ${name} is not supported in webgl 1.0 context!`))}removeVisualize(e){let t=this._visualizes.indexOf(e);-1!==t&&this._visualizes.splice(t,1)}getVisualize(e,t){let r=0;for(let i=0;i<this._visualizes.length;i++)if(-1!==this._visualizes[i].name.indexOf(e)){if(t===r)return this._visualizes[i];r++}return null}getVisualizes(e){let t=[];for(let r=0;r<this._visualizes.length;r++)-1!==this._visualizes[r].name.indexOf(e)&&t.push(this._visualizes[r]);return t}getAllVisualizes(){return this._visualizes}setOverridedMaterials(e){if(this._overridedMaterials=e,e){const t=this._resourceManager.gl,r=this._resourceManager.getTexture("white");r.ready||(r.create(1,1,t.RGBA8,t.NEAREST,t.CLAMP_TO_EDGE),r.update(new Uint8Array([255,255,255,255])));let i=this._resourceManager.getShader("texture",[]);if(!i.ready){const e=n.default.texture;i.createFromShaderSource(e,[])}if(Object.keys(e).length<=4){this._lines.setOverridedMaterial(e.lines);let t=e.opaques;t&&!t.hasTexture&&(t.attachShader(i),t.setDiffuseTexture(r)),this._opaques.setOverridedMaterial(t),(t=e.transparents)&&!t.hasTexture?(t.attachShader(i),t.setDiffuseTexture(r),this._transparents.setOverridedMaterial(t)):this._transparents.setOverridedMaterial(e.opaques),this._maskeds.setOverridedMaterial(e.maskeds)}else e.hasTexture||(e.attachShader(i),e.setDiffuseTexture(r)),this._flags.overridedMaterial=!0,this._renderPassAll.setOverridedMaterial(e),this._renderPassAll.createQueue(this._scene,performance.now()),this._lines.setOverridedMaterial(e),this._maskeds.setOverridedMaterial(e),this._opaques.setOverridedMaterial(e),this._transparents.setOverridedMaterial(e)}else this._lines.setOverridedMaterial(null),this._opaques.setOverridedMaterial(null),this._transparents.setOverridedMaterial(null),this._maskeds.setOverridedMaterial(null),this._renderPassAll.setOverridedMaterial(null),this._renderPassAll.createQueue(this._scene,performance.now()),this._flags.overridedMaterial=!1}getOverridedMaterials(){return this._overridedMaterials}setOverridedShaders(e){this._overridedShader=e,this._renderPassAll.setOverridedShader(e),this._lines.setOverridedShader(e),this._opaques.setOverridedShader(e),this._transparents.setOverridedShader(e),this._maskeds.setOverridedShader(e)}getOverridedShader(){return this._overridedShader}renderElements(e,t=!1){if(e){let r=[];for(let i=0,n=e.length;i<n;i++){const n=e[i],a=n.split("+")[0];let s=this._scene.models[a].tree.elements[n];if(s)s.getNodes().forEach(e=>{!t&&e.drawable.mesh.isLine()||r.push(e)});else console.warn("Element: +"+n+" can not be found!")}this._nodes.setNodes(r)}else this._nodes.setNodes(null)}onOpacityChanged(e){if(0!==e.length){var t=e[0].material.getTransparent()<.99;e.forEach(e=>{t?(this._opaques.removeDrawable(e),this._transparents.addDrawable(e)):(this._opaques.addDrawable(e),this._transparents.removeDrawable(e))})}}onSceneChanged(e){for(var t in this._effects)this._effects[t].onSceneChanged(e);if(this._lines.createQueue(this._scene,e),this._opaques.createQueue(this._scene,e),this._maskeds.createQueue(this._scene,e),this._transparents.createQueue(this._scene,e),this._renderPassAll.createQueue(this._scene,e),this._scene.needRenderDoubleSided())this._opaques.setCullFace(!1),this._maskeds.setCullFace(!1),this._transparents.setCullFace(!1);else{const e=this._resourceManager.gl;this._opaques.setCullFace(e.CCW),this._maskeds.setCullFace(e.CCW),this._transparents.setCullFace(e.CCW)}}setDoubleFaceEnabled(e){if(this._scene.setRenderDoubleSided(e),e)this._opaques.setCullFace(!1),this._maskeds.setCullFace(!1),this._transparents.setCullFace(!1);else{const e=this._resourceManager.gl;this._opaques.setCullFace(e.CCW),this._maskeds.setCullFace(e.CCW),this._transparents.setCullFace(e.CCW)}}optimize(){if(this._lines.optimize(),this._opaques.optimize(),this._maskeds.optimize(),this._transparents.optimize(),this._scene.needRenderDoubleSided())this._opaques.setCullFace(!1),this._maskeds.setCullFace(!1),this._transparents.setCullFace(!1);else{const e=this._resourceManager.gl;this._opaques.setCullFace(e.CCW),this._maskeds.setCullFace(e.CCW),this._transparents.setCullFace(e.CCW)}}_recompileShaders(e,t){for(var r in this._effects)this._effects[r].recompileShader(e,t);for(let r in this._scene.models)this._scene.models[r].drawables.forEach(r=>{r.visible&&r.recompileShader(e,t)});this._opaques.recompileOverridedShader(e,t),this._lines.recompileOverridedShader(e,t),this._transparents.recompileOverridedShader(e,t),this._maskeds.recompileOverridedShader(e,t),this._renderPassAll.recompileOverridedShader(e,t),this._renderer.invalidate()}refreshRendering(e=1){}getScene(){return this._scene}getRenderQueueManager(){return this._renderQueueManager}getResourceManager(){return this._resourceManager}getCamera(){return this._camera}getRenderer(){return this._renderer}getRenderTarget(){return this._renderTarget}isLineRendering(e){return this._flags.line}setLineRendering(e){this._flags.line=e}addDrawable(e){for(var t in this._opaques.addDrawable(e)||this._maskeds.addDrawable(e)||this._lines.addDrawable(e)||this._transparents.addDrawable(e),this._renderPassAll.addDrawable(e),this._effects)this._effects[t].addDrawable(e)}getSkeletons(){return this._skeletons}addSkeleton(e){this._skeletons.push(e)}removeSkeleton(e){var t=this._skeletons.indexOf(e);-1!==t&&this._skeletons.splice(t,1)}removeDrawable(e){for(var t in this._opaques.removeDrawable(e)||this._maskeds.removeDrawable(e)||this._lines.removeDrawable(e)||this._transparents.removeDrawable(e),this._effects)this._effects[t].removeDrawable(e)}getOpaques(){return this._opaques}getMaskeds(){return this._maskeds}getLines(){return this._lines}getTransparents(){return this._transparents}setNodesLineColor(e){this._nodes.setLineColor(e)}setOITEnabled(e){this._transparents.setOITEnabled(e)}isOITEnabled(){return this._flags.oit}}},"./04renderer/pipeline/RenderSceneExploded.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./03scene/camera/m3d_scene_camera.js"),n=r("./04renderer/pipeline/RenderScenePR.ts"),a=r("./04renderer/pipeline/RenderPassNode.ts"),s=r("./glMatrix.js");class o extends n.default{constructor(e,t,r,i,n){super(e,r,i,n),this._nodesBatch=[],this._nodesBatchTransparent=[],this._cameraBatch=[],this._translations=null,this._animationBeginAt=0,this._animationDuration=0,this._animationDirection=1,this._animationCurrent=0,this._animationDone=null,this._overridedMaterials=null,this._overridedShader=null;var a=t.getOverridedMaterials();if(a)if(Object.keys(a).length<=4)for(var s in this._overridedMaterials={},a)this._overridedMaterials[s]=a[s].clone(s+"explodedView");else this._overridedMaterials=a.clone(a.name+"explodedView");for(var s in t.getAllVisualizes().forEach(e=>{this._visualizes.push(e)}),t.getSkeletons().forEach(e=>{this.addSkeleton(e)}),e.pawns)e.pawns[s].drawables.forEach(e=>{this.addDrawable(e)});for(var o in e.text3Ds.forEach(e=>{e.drawables.forEach(e=>{this.addDrawable(e)})}),this._overridedShader=t.getOverridedShader()||null,this._flags={},t._flags)this._flags[o]=t._flags[o]}destroy(){for(let e=0;e<this._nodesBatch.length;e++)this._nodesBatch[e].destroy(),this._nodesBatchTransparent[e].destroy(),this._cameraBatch[e].destroy();this._nodesBatch=null,delete this._nodesBatch,this._nodesBatchTransparent=null,delete this._nodesBatchTransparent,this._cameraBatch=null,delete this._cameraBatch,this._translations=null,delete this._translations,this._animationDone=null,delete this._animationDone,super.destroy()}renderElements(e,t=!1){super.renderElements(e,t);let r=new i.default(this._scene,this._camera.viewport);this._cameraBatch.push(r);var n=this._nodes.clone(),s=new a.default(this._resourceManager,this._renderQueueManager),o=new a.default(this._resourceManager,this._renderQueueManager);s.setOverridedShader(this._overridedShader),s.setOverridedMaterial(this._overridedMaterials),o.setOverridedShader(this._overridedShader),o.setOverridedMaterial(this._overridedMaterials),n.getNodes().forEach(e=>{e.drawable.material.getTransparent()<.99?o._queue.push(e):s._queue.push(e)}),this._nodesBatch.push(s),this._nodesBatchTransparent.push(o)}_drawFrame(e){const t=this._resourceManager.gl;this._renderer.clear(e,t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const r=this._scene.clipping,i=this._scene.getMainLight();for(var n=0;n<this._skeletons.length;n++)this._skeletons[n].update();let a=[0,0,0];this._animationCurrent=Date.now()-this._animationBeginAt;let o=Math.min(this._animationCurrent/this._animationDuration,1);this._animationDirection<0&&(o=1-o);let l=s.mat4.create();for(let t=0;t<this._nodesBatch.length;t++)a[0]=this._translations[t][0]*o,a[1]=this._translations[t][1]*o,a[2]=this._translations[t][2]*o,l=s.mat4.fromTranslation(l,a),s.mat4.multiply(this._cameraBatch[t].viewMatrix,this._camera.viewMatrix,l),s.mat4.multiply(this._cameraBatch[t].vpMatrix,this._camera.projectMatrix,this._cameraBatch[t].viewMatrix),s.vec3.subtract(this._cameraBatch[t].eye,this._camera.eye,a),this._renderer.invalidate(),this._nodesBatch[t].render(e,this._renderer,this._cameraBatch[t],this._shadow,r,i);this._opaques.render(e,this._renderer,this._camera,this._shadow,r,i),this._maskeds.render(e,this._renderer,this._camera,this._shadow,r,i),this._flags.line&&this._lines.render(e,this._renderer,this._camera,this._shadow,r,i),e.always=!0,this._drawVisualize(e),this._transparents.render(e,this._renderer,this._camera,this._shadow,r,i);for(let t=0;t<this._nodesBatch.length;t++)e.always=!0,e.setOption("blend",!0),this._nodesBatchTransparent[t].render(e,this._renderer,this._cameraBatch[t],this._shadow,r,i),e.always=!0,e.setOption("blend",!1);this._scene.background.skybox&&this._scene.background.skybox.visible&&(this._scene.background.skybox.update(this._camera.viewMatrix),this._renderer.drawSkybox(e,this._scene.background.skybox,this._camera)),(o<=0&&this._animationDirection<0||o>=1&&this._animationDirection>0)&&(this._prEnabled=!0,this._animationDone&&this._animationDone())}renderElementsTranslations(e){this._translations=e}enter(e){this._animationBeginAt=Date.now(),this._animationCurrent=0,this._animationDuration=e,this._animationDirection=1,this._prEnabled=!1,this._flags.specular&&(this._nodesBatch.forEach(e=>{e.recompileOverridedShader("SPECULAR",!0)}),this._nodesBatchTransparent.forEach(e=>{e.recompileOverridedShader("SPECULAR",!0)}),this._renderer.invalidate())}quit(e){this._animationBeginAt=Date.now(),this._animationCurrent=0,this._animationDirection=-1,this._animationDone=e,this._prEnabled=!1}}},"./04renderer/pipeline/RenderSceneForward.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./03scene/drawables/Skybox.ts"),n=r("./04renderer/shadow/ShadowController.ts"),a=r("./04renderer/pipeline/RenderScene.ts");class s extends a.default{constructor(e,t,r,i,n){super(e,t,r,i,n),this._flags={doubleSided:!1,clipping:!1,shadow:!1,specular:!1,line:!1,base:!1},this._shadow=null}destroy(){this._shadow&&(this._shadow.destroy(),this._shadow=null,delete this._shadow),super.destroy()}draw(e=!1){const t=this._resourceManager.gl;return this._scene.background.mode===i.SkyBoxMode.SKYBOX_SOLIDCOLOR&&this._renderTarget.setClearColor(this._scene.background.color),this._scissor&&(t.enable(t.SCISSOR_TEST),t.scissor(this._camera.viewport[0],this._camera.viewport[1],this._camera.viewport[2],this._camera.viewport[3])),this._drawFrame(this._renderTarget),this._scissor&&t.disable(t.SCISSOR_TEST),!0}drawHD(){this.draw(!0),this._renderer.present(this._renderTarget.getFramebuffer())}_drawFrame(e){const t=this._resourceManager.gl;this._renderer.clear(e,t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const r=this._scene.clipping,i=this._scene.getMainLight();for(var n=0;n<this._skeletons.length;n++)this._skeletons[n].update();this._scene.background.skybox&&this._scene.background.skybox.visible&&(this._scene.background.skybox.update(this._camera.viewMatrix),this._renderer.drawSkybox(e,this._scene.background.skybox,this._camera)),this._flags.line&&this._lines.render(e,this._renderer,this._camera,this._shadow,r,i),this._flags.overridedMaterial?(this._renderPassAll.render(e,this._renderer,this._camera,this._shadow,r,i),this._drawVisualize(e)):(this._opaques.render(e,this._renderer,this._camera,this._shadow,r,i),this._maskeds.render(e,this._renderer,this._camera,this._shadow,r,i),this._drawVisualize(e),this._transparents.render(e,this._renderer,this._camera,this._shadow,r,i)),this._nodes.isValid()&&(e.always=!0,this._nodes.render(e,this._renderer,this._camera,this._shadow,r,i),e.always=!0),this._drawEffects(e)}_drawEffects(e){for(let t=0;t<this._sortedEffects.length;t++)this._sortedEffects[t].draw(e,-1)}_drawVisualize(e){const t=this._scene.clipping,r=this._scene.getMainLight();e.setOption("blend",!0),e.always=!0;for(let i=0;i<this._visualizes.length;i++)this._visualizes[i].draw(this._renderer,this._camera,t,r,this._shadow,e);e.setOption("blend",!1),e.always=!0}resize(e,t){super.resize(e,t),this._renderTarget.resize(e,t)}isLineRendering(e){return this._flags.line}setLineRendering(e){this._flags.line=e}setBaseRenderingEnabled(e){this._flags.base!==e&&(this._flags.base=e,this._recompileShaders("BASE",e))}setShadowEnabled(e){this._flags.shadow!==e&&(this._flags.shadow=e,this._flags.shadow&&null===this._shadow&&(this._shadow=new n.default(this),this._shadow.onSceneChanged(-1)),this._shadow.setEnabled(e),this.updateShadow(),this._recompileShaders("SHADOW",e),this._recompileShaders("SHADOW_PARTITION",e))}updateShadow(e=!1){this._shadow&&(this._flags.shadow||e)&&(this._shadow.draw(null),this._renderer.renderState.invalidateShadow())}isShadowEnabled(){return this._flags.shadow}setClippingEnabled(e){if(this._flags.clipping!==e)for(var t in this._flags.clipping=e,this._recompileShaders("CLIPPING",e),this._shadow&&(this._shadow.recompileShader("CLIPPING",e),this._shadow.draw(null)),this._effects)this._effects[t].recompileShader("CLIPPING",e)}isClippingEnabled(){return this._flags.clipping}onSceneChanged(e){super.onSceneChanged(e),this._shadow.onSceneChanged(e),this._flags.doubleSided=this._scene.needRenderDoubleSided()}setSpecularEnabled(e){this._flags.specular=e,this._recompileShaders("SPECULAR",e)}refreshRendering(e=1){}setScissorEnabled(e){this._scissor=e}}},"./04renderer/pipeline/RenderScenePR.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/drawables/Skybox.ts"),a=r("./04renderer/pipeline/RenderTarget.ts"),s=r("./04renderer/m3d_samples.js"),o=r("./04renderer/pipeline/Blit.ts"),l=r("./04renderer/pipeline/RenderSceneForward.ts"),d=r("./glMatrix.js");class u extends l.default{constructor(e,t,r,n,s){super(e,t,r,n,s),this._prFrame=-1,this._prSkipFrames=4,this._PR_MAX_FRAMES=16,this._prEnabled=!0,this._needUpdate=0,this._flags={progressive:!1,doubleSided:!1,clipping:!1,shadow:!1,specular:!1,line:!1,smartCulling:!1};const l=this._resourceManager.gl;this._prRenderTargets=[new a.default("pipeline-pr",this._resourceManager,t.viewport[2],t.viewport[3],{depthFunc:l.LEQUAL,colorFilter:l.NEAREST,colorFormat:l.RGBA8,depthBuffer:0,stencilTest:!!s}),new a.default("pipeline-pr1",this._resourceManager,t.viewport[2],t.viewport[3],{depthTest:!1,colorFilter:l.NEAREST,colorFormat:l.RGBA8,depthBuffer:0,stencilTest:!!s}),new a.default("pipeline-pr2",this._resourceManager,t.viewport[2],t.viewport[3],{depthTest:!1,colorFilter:l.NEAREST,colorFormat:l.RGBA8,depthBuffer:0,stencilTest:!!s})],this._prBlit=new o.default(this._resourceManager,i.default.accumulate),l.isWebGL2||(this._blit=new o.default(this._resourceManager))}destroy(){this._prRenderTargets[0].destroy(),this._prRenderTargets[1].destroy(),this._prRenderTargets[2].destroy(),this._prRenderTargets=null,delete this._prRenderTargets,this._prBlit.destroy(),this._prBlit=null,delete this._prBlit,this._resourceManager.gl.isWebGL2||(this._blit.destroy(),this._blit=null,delete this._blit),super.destroy()}draw(e=!1){if(!(e=e||!this._prEnabled)&&this._flags.progressive&&0===this._needUpdate)return!1;if(this._scene.background.mode===n.SkyBoxMode.SKYBOX_SOLIDCOLOR&&(this._renderTarget.setClearColor(this._scene.background.color),this._prRenderTargets[0].setClearColor(this._scene.background.color)),!e&&this._flags.progressive){for(;this._prFrame<=this._prSkipFrames;)this._drawFrameProgressively(),this._prFrame++;this._drawFrameProgressively(),this._prFrame++,this._prFrame<=this._PR_MAX_FRAMES&&(this._needUpdate+=1)}else this._drawFrame(this._renderTarget);return e||(this._needUpdate-=1,this._needUpdate<0&&this._onAnimationEnd()),!0}drawHD(){for(this._scene.background.mode===n.SkyBoxMode.SKYBOX_SOLIDCOLOR&&this._prRenderTargets[0].setClearColor(this._scene.background.color),this._prFrame=1;this._prFrame<=this._PR_MAX_FRAMES;)this._drawFrameProgressively(),this._prFrame++;this._renderer.present(this._prRenderTargets[1+this._prFrame%2].getFramebuffer()),this._prFrame=-1}_drawEffects(e){for(let t=0;t<this._sortedEffects.length;t++)this._sortedEffects[t].draw(e,this._prFrame)}resize(e,t){super.resize(e,t),this._prRenderTargets[0].resize(e,t),this._prRenderTargets[1].resize(e,t),this._prRenderTargets[2].resize(e,t)}_drawFrameProgressively(){const e=this._camera;var t=s.default._4X4[2*(this._prFrame-1)]-.5,r=s.default._4X4[2*(this._prFrame-1)+1]-.5;this._flags.shadow&&(this._shadow.draw(this._prFrame),this._renderer.renderState.invalidateShadow());const i=t/this._camera.viewport[2],n=r/this._camera.viewport[3];e.jitter(i,n),d.mat4.multiply(e.vpMatrix,e.projectMatrix,e.viewMatrix);const a=this._resourceManager.gl;this._drawFrame(this._prRenderTargets[0]),e.jitter(-i,-n),this._renderer.renderState.viewport(e.viewport),this._prBlit.setTexture(this._prRenderTargets[1+this._prFrame%2].getColorBuffer()),this._prBlit.setParameter("uTexture0",this._prRenderTargets[0].getColorBuffer()),this._prBlit.setParameter("uFrameCount",this._prFrame),this._prBlit.render(this._renderer,this._prRenderTargets[2-this._prFrame%2]),a.isWebGL2||16!==this._prFrame||(this._blit.setTexture(this._prRenderTargets[1+this._prFrame%2].getColorBuffer()),this._blit.render(this._renderer,this._renderTarget))}isProgressiveRenderingEnabled(){return this._prEnabled}setProgressiveRenderingEnabled(e){this._prEnabled=e}setProgressiveRenderingLatency(e){this._prSkipFrames>=this._PR_MAX_FRAMES&&(this._prSkipFrames=15),this._prSkipFrames<0&&(this._prSkipFrames=4)}_onAnimationStart(){this._camera.setBimCullingEnabled(this._flags.smartCulling),this._flags.shadow&&(this._shadow.draw(),this._renderer.renderState.invalidateShadow())}_onAnimationEnd(){if(this._flags.progressive)this._needUpdate=0;else{if(this._needUpdate+=1.01,this._needUpdate>1&&(this._needUpdate=.9999),this._prFrame<=0&&this._camera.isBimCullingEnabled())return this._camera.setBimCullingEnabled(!1),void this._renderer.invalidate();this._prFrame=1,this._flags.progressive=!0,this._renderer.clear(this._prRenderTargets[1],this._resourceManager.gl.COLOR_BUFFER_BIT),this._renderer.clear(this._prRenderTargets[2],this._resourceManager.gl.COLOR_BUFFER_BIT),this._flags.shadow&&this._renderer.renderState.invalidateShadow()}}setSmartCullingEnabled(e){this._flags.smartCulling=e}isSmartCullingEnabled(){return this._flags.smartCulling}getRenderTarget(){return this._prFrame>this._PR_MAX_FRAMES?this._prRenderTargets[1+this._prFrame%2]:this._renderTarget}refreshRendering(e=1){this._flags.progressive&&(this._flags.progressive=!1,this._onAnimationStart(),this._prFrame=-1),this._needUpdate+=1.01*e,this._needUpdate>20.01&&(this._needUpdate=20.01)}}},"./04renderer/pipeline/RenderTarget.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(e,t,r,i,n){this.ready=!1,this.always=!1,this._name=e,this._options=n||{},this._framebuffer=null;const a=t.gl;if(this._options.hasOwnProperty("clearColor")||(this._options.clearColor=new Float32Array([1,1,1,0])),this._options.hasOwnProperty("colorMask")||(this._options.colorMask=new Int32Array([1,1,1,1])),this._options.hasOwnProperty("depthTest")||(this._options.depthTest=!0),this._options.hasOwnProperty("depthMask")||(this._options.depthMask=!0),this._options.hasOwnProperty("clearDepth")||(this._options.clearDepth=1),this._options.hasOwnProperty("depthFunc")||(this._options.depthFunc=a.LESS),this._options.hasOwnProperty("blend")||(this._options.blend=!1),this._options.hasOwnProperty("blendFunc")||(this._options.blendFunc=[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA]),this._options.hasOwnProperty("stencilTest")||(this._options.stencilTest=!1),this._options.hasOwnProperty("stencilOp")||(this._options.stencilOp=[a.KEEP,a.KEEP,a.REPLACE]),this._options.hasOwnProperty("stencilFunc")||(this._options.stencilFunc=[a.ALWAYS,0,-1]),this._options.hasOwnProperty("samples")||(this._options.samples=1),this._options.hasOwnProperty("depthFilter")||(this._options.depthFilter=a.NEAREST),this._framebuffer=t.getFramebuffer(this._name),this._framebuffer.ready)this._framebuffer.resize(r,i);else{var s=-1;n.hasOwnProperty("colorBuffer")&&(s=n.colorBuffer);var o=-1;n.hasOwnProperty("depthBuffer")&&(o=n.depthBuffer);var l,d=n.colorFormat||a.RGBA8,u=n.depthFormat||(a.isWebGL2?a.DEPTH_COMPONENT24:a.DEPTH_COMPONENT);this._options.stencilTest&&(u=a.isWebGL2?a.DEPTH24_STENCIL8:a.DEPTH_STENCIL),l=-1===s?e+"-cbuf":"c"+s.toString()+"-"+r.toString()+"x"+i.toString()+"-"+d+"x"+this._options.samples;var c=t.getTexture(l);if(!c.ready&&(c.create(r,i,d,this._options.colorFilter,this._options.colorWrap,this._options.samples),!c.ready))return c.destroy(),void(this.ready=!1);var h=[c];if(this._options.colorBuffers&&this._options.colorBuffers.length>0)for(var m=0,f=this._options.colorBuffers.length;m<f;m++){let n=this._options.colorBuffers[m];n.colorFormat=n.colorFormat||a.RGBA8,n.samples=n.samples||1,l=null==n.index?e+"-cbuf":"c"+n.index.toString()+"-"+r.toString()+"x"+i.toString()+"-"+n.colorFormat+"x"+n.samples;let s=t.getTexture(l);if(!s.ready&&(s.create(r,i,n.colorFormat,n.colorFilter,n.colorWrap,n.samples),!s.ready))return s.destroy(),void(this.ready=!1);h.push(s)}l=-1===o?e+"-dbuf":"d"+o.toString()+"-"+r.toString()+"x"+i.toString()+"-"+u+"x"+this._options.samples;var p=t.getTexture(l);if(!p.ready&&(p.create(r,i,u,this._options.depthFilter,this._options.depthWrap,this._options.samples),!p.ready))return p.destroy(),void(this.ready=!1);this._framebuffer.create(h,p)}this.ready=this._framebuffer.ready}destroy(){this._name=null,delete this._name,this._framebuffer.destroy(),this._framebuffer=null,delete this._framebuffer,this._options=null,delete this._options}render(e){this.ready?(e.useFramebuffer(this._framebuffer),e.blend(this._options.blend),this._options.blend&&e.blendFunc(this._options.blendFunc),e.clearColor(this._options.clearColor),e.colorMask(this._options.colorMask),e.depthTest(this._options.depthTest,this._options.clearDepth,this._options.depthFunc),e.depthMask(this._options.depthMask),e.stencilTest(this._options.stencilTest,this._options.stencilFunc,this._options.stencilOp,this._options.stencilMask)):console.log("render target '"+this._name+"' is not ready.")}resize(e,t){this.ready?(this.ready=!1,this._framebuffer.resize(e,t),this.ready=this._framebuffer.ready):console.log("render target '"+this._name+"' is not ready.")}setClearColor(e){this.ready?(this._options.clearColor[0]=e[0],this._options.clearColor[1]=e[1],this._options.clearColor[2]=e[2],this._options.clearColor[3]=e[3]):console.log("render target "+this._name+" is not ready.")}getOption(e){return this._options[e]}setOption(e,t){this._options[e]=t}getColorBuffer(e){return this._framebuffer.getColorBuffer(e)}getDepthBuffer(){return this._framebuffer.getDepthBuffer()}getWidth(){return this._framebuffer.getWidth()}getHeight(){return this._framebuffer.getHeight()}getFramebuffer(){return this._framebuffer}getName(){return this._name}}},"./04renderer/pipeline/m3d_renderer.js":function(e,t,r){"use strict";r.r(t);var i=r("./04renderer/pipeline/m3d_renderstate.js");t.default=function(){function e(e){this.renderState=new i.default(e.gl),this._resourceManager=e,this._renderTarget=null,this._quadMesh=null,this._quadMesh=e.getMesh("quad"),this._quadMesh.createQuad()}e.prototype.destroy=function(){this.renderState=null};var t=[0,0];return e.prototype.drawDrawables=function(e,r,i,n,a,s,o,l,d,u){if(0===r.length)return 0;(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));const c=this._resourceManager.gl;if(u?(c.enable(c.CULL_FACE),c.frontFace(u)):c.disable(c.CULL_FACE),this.renderState.viewport(i.viewport),n&&null!==n[0])for(var h=0,m=r.length;h<m;h++){if((p=r[h]).visible&&(t[0]=0,t[1]=p.mesh.length,!i.cull(p,t))){p.faceCamera&&p.update(i);var f=null;f=p.transform.identity?n[0]:n[1],this.renderState.useShader(f,i,s,o,l,null,null),a?(a.absorb(p.material),a.use(f)):p.material.use(f),this.renderState.useMesh(p.mesh),p.render(i,f,t)}}else for(h=0,m=r.length;h<m;h++){var p;(p=r[h]).visible&&(t[0]=0,t[1]=p.mesh.length,i.cull(p,t)||(p.faceCamera&&p.update(i),this.renderState.useShader(p.shader,i,s,o,l,d),a?(a.absorb(p.material),a.use(p.shader)):p.material.use(p.shader),this.renderState.useMesh(p.mesh),p.render(i,p.shader,t)))}},e.prototype.drawLinesWithVertexIds=function(e,r,i,n,a,s){if(0===r.length)return 0;(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1)),this.renderState.viewport(i.viewport);for(var o=0,l=0,d=r.length;l<d;l++){var u=r[l];t[0]=0,t[1]=u.mesh.length;var c=null;c=u.transform.identity?n[0]:n[1],this.renderState.useShader(c,i,s,null,null,null,o),a.absorb(u.material),a.use(c),this.renderState.useMesh(u.mesh),u.render(i,c,t),o+=u.mesh.length}},e.prototype.drawDrawable=function(e,t,r,i,n,a,s,o){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));const l=this._resourceManager.gl;s?(l.enable(l.CULL_FACE),l.frontFace(s)):l.disable(l.CULL_FACE),this.renderState.viewport(r.viewport),this.renderState.useShader(t.shader,r,i,n,a),t.material.use(t.shader),t.transform.use(r,t.shader),this.renderState.useMesh(t.mesh),o?t.mesh.renderSub(o[0],o[1]):t.mesh.render()},e.prototype.drawElements=function(e,r,i,n,a,s,o,l,d){if(0===r.length)return;(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));const u=this._resourceManager.gl;if(o?(u.enable(u.CULL_FACE),u.frontFace(o)):u.disable(u.CULL_FACE),this.renderState.viewport(i.viewport),l&&null!==l[0])for(var c=0,h=r.length;c<h;c++){if((p=(f=r[c]).drawable).visible){p.billboard&&p.update(i);var m=null;m=p.transform.identity?l[0]:l[1],this.renderState.useShader(m,i,n,a,s),d.absorb(p.material),d.use(m),this.renderState.useMesh(p.mesh),t[0]=f.indicesOffset,t[1]=f.indicesCount,p.render(i,m,t)}}else for(c=0,h=r.length;c<h;c++){var f,p;(p=(f=r[c]).drawable).visible&&(p.billboard&&p.update(i),this.renderState.useShader(p.shader,i,n,a,s),d?(d.absorb(p.material),d.use(p.shader)):p.material.use(p.shader),this.renderState.useMesh(p.mesh),t[0]=f.indicesOffset,t[1]=f.indicesCount,p.render(i,p.shader,t))}},e.prototype.drawGizmo=function(e,t,r,i){this.drawDrawable(e,t,r,null,null,null,i)},e.prototype.drawScreen=function(e,t,r){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));const i=this._resourceManager.gl;i.disable(i.CULL_FACE),this.renderState.useShader(t),r.use(t),this.renderState.useMesh(this._quadMesh),this._quadMesh.render()},e.prototype.drawDrawablesCustom=function(e,r,i,n,a,s,o,l){if(0===r.length)return;(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));const d=this._resourceManager.gl;o?d.disable(d.CULL_FACE):(d.enable(d.CULL_FACE),d.frontFace(d.CCW)),this.renderState.viewport(i.viewport);for(var u=0,c=r.length;u<c;u++){var h=r[u];if(h.visible&&!i.cull(h,t)){t[0]=0,t[1]=h.mesh.length;var m=null;m=h.transform.identity?n[0]:n[1],this.renderState.useShader(m,i,s),l(u,a),a.use(m),this.renderState.useMesh(h.mesh),h.render(i,m,t)}}},e.prototype.drawNodesCustom=function(e,r,i,n,a,s,o,l){if(0===r.length)return;(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));const d=this._resourceManager.gl;o?d.disable(d.CULL_FACE):(d.enable(d.CULL_FACE),d.frontFace(d.CCW)),this.renderState.viewport(i.viewport),r.sort(function(e,t){return e.drawable.name<t.drawable.name});for(var u=0,c=r.length;u<c;u++){var h=r[u],m=h.drawable;m.billboard&&m.update(i);var f=null;f=m.transform.identity?n[0]:n[1],this.renderState.useShader(f,i,s),l(u,a),a.use(f),this.renderState.useMesh(m.mesh),t[0]=h.indicesOffset,t[1]=h.indicesCount,m.render(i,f,t)}},e.prototype.drawSkybox=function(e,t,r){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));const i=this._resourceManager.gl;i.disable(i.CULL_FACE),this.renderState.viewport(r.viewport),this.renderState.useShader(t.shader,r),t.material.use(t.shader),t.transform.use(r,t.shader),this.renderState.useMesh(t.mesh),t.mesh.render()},e.prototype.beginFrame=function(){this.renderState.invalidateStates()},e.prototype.endFrame=function(){this.renderState.dirtyBits=0},e.prototype.invalidate=function(){this._renderTarget=null,this.renderState.dirtyBits=i.default.ALL_DIRTY_BIT},e.prototype.clear=function(e,t){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1)),this._resourceManager.gl.clear(t)},e.prototype.restore=function(){},e.prototype.discard=function(){},e.prototype.present=function(e){const t=this._resourceManager.gl;t.isWebGL2&&this._resourceManager.getFramebuffer("default").copy(e,t.COLOR_BUFFER_BIT)},e}()},"./04renderer/pipeline/m3d_renderstate.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/Environment.ts");t.default=function(){new Float32Array(36);function e(e){this.dirtyBits=-1,this._framebuffer=null,this._mesh=null,this._shader=null,this._clearColor=new Float32Array([1,1,1,0]),this._colorMask=new Int32Array([1,1,1,1]),this._depthTest=!0,this._clearDepth=1,this._depthFunc=e.LESS,this._viewport=new Int32Array([0,0,1,1]),this._planesArray=new Float32Array(24),this._blend=!1,this._stencilTest=!1,this._stencilOp=[e.KEEP,e.KEEP,e.REPLACE],this._stencilFunc=[e.ALWAYS,0,-1],this._stencilMask=!1,this._blendFunc=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],this._gl=e,e.enable(e.CULL_FACE),e.frontFace(e.CCW),e.lineWidth(1),e.clearColor(this._clearColor[0],this._clearColor[1],this._clearColor[2],this._clearColor[3]),e.colorMask(this._colorMask[0],this._colorMask[1],this._colorMask[2],this._colorMask[3]),e.clearStencil(0),this._depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.clearDepth(this._clearDepth),e.depthFunc(this._depthFunc),this._blend?e.enable(e.BLEND):e.disable(e.BLEND),e.blendFuncSeparate(this._blendFunc[0],this._blendFunc[1],this._blendFunc[2],this._blendFunc[3]),this._stencilTest?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.stencilMask(this._stencilMask),e.stencilFunc(this._stencilFunc[0],this._stencilFunc[1],this._stencilFunc[2]),e.stencilOp(this._stencilOp[0],this._stencilOp[1],this._stencilOp[2]),e.viewport(this._viewport[0],this._viewport[1],this._viewport[2],this._viewport[3])}return e.CLIP_DIRTY_BIT=1,e.LIGHT_DIRTY_BIT=2,e.SHADOW_DIRTY_BIT=4,e.RESERVED_BIT=8,e.PLATTE_DIRTY_BIT=16,e.OTHER_DIRTY_BIT=32,e.ALL_DIRTY_BIT=e.CLIP_DIRTY_BIT|e.LIGHT_DIRTY_BIT|e.SHADOW_DIRTY_BIT|e.RESERVED_BIT|e.PLATTE_DIRTY_BIT|e.OTHER_DIRTY_BIT,e.prototype.useShader=function(t,r,i,n,a,s,o){if(t!==this._shader||this.dirtyBits){if(null!==t){const s=this._gl;var l;if(t!==this._shader&&t.use(),t===this._shader||!a||this.dirtyBits&e.SHADOW_DIRTY_BIT||(this.dirtyBits|=e.SHADOW_DIRTY_BIT),this.dirtyBits&&(this.dirtyBits&e.CLIP_DIRTY_BIT&&this._syncGlobalUniforms(t.reservedUniforms,i),this.dirtyBits&e.LIGHT_DIRTY_BIT&&this._syncLightUniforms(t.reservedUniforms,n,a),this.dirtyBits&e.SHADOW_DIRTY_BIT&&(this._syncShadowUniforms(t.reservedUniforms,a),this.dirtyBits&=~e.SHADOW_DIRTY_BIT),this.dirtyBits&e.PLATTE_DIRTY_BIT&&this._syncPlatteUniforms(t.reservedUniforms)),s.isWebGL2){if(l=t.reservedUniforms.m_uPerFrame){if(r.uniformBlock.set(r.viewMatrix,0),r.uniformBlock.set(r.vpMatrix,16),r.isPerspective())r.uniformBlock[32]=r.eye[0],r.uniformBlock[33]=r.eye[1],r.uniformBlock[34]=r.eye[2],r.uniformBlock[35]=1;else{var d=r.getViewDirection();r.uniformBlock[32]=-d[0],r.uniformBlock[33]=-d[1],r.uniformBlock[34]=-d[2],r.uniformBlock[35]=0}l.upload(r.uniformBlock,s)}(l=t.reservedUniforms.m_uBaseVertexOffset)&&l.upload(o,s)}else if((l=t.reservedUniforms["m_uPerFrame.vpMatrix"])&&l.upload(r.vpMatrix,s),(l=t.reservedUniforms["m_uPerFrame.viewMatrix"])&&l.upload(r.viewMatrix,s),l=t.reservedUniforms["m_uPerFrame.cameraPosition"]){var u;if(r.isPerspective())u=r.eye;else(d=r.getViewDirection())[0]=-d[0],d[1]=-d[1],d[2]=-d[2],u=d;l.upload(u,s)}}this._shader=t}},e.prototype.useFramebuffer=function(e){this._framebuffer!==e&&(this._framebuffer=e,this._framebuffer.use())},e.prototype.useMesh=function(e){this._mesh!==e&&(this._mesh=e,this._mesh.use())},e.prototype.clearColor=function(e){e[0]===this._clearColor[0]&&e[1]===this._clearColor[1]&&e[2]===this._clearColor[2]&&e[3]===this._clearColor[3]||(this._clearColor[0]=e[0],this._clearColor[1]=e[1],this._clearColor[2]=e[2],this._clearColor[3]=e[3],this._gl.clearColor(this._clearColor[0],this._clearColor[1],this._clearColor[2],this._clearColor[3]))},e.prototype.colorMask=function(e){e[0]===this._colorMask[0]&&e[1]===this._colorMask[1]&&e[2]===this._colorMask[2]&&e[3]===this._colorMask[3]||(this._colorMask[0]=e[0],this._colorMask[1]=e[1],this._colorMask[2]=e[2],this._colorMask[3]=e[3],this._gl.colorMask(this._colorMask[0],this._colorMask[1],this._colorMask[2],this._colorMask[3]))},e.prototype.depthTest=function(e,t,r){const i=this._gl;this._depthTest!==e&&(this._depthTest=e,this._depthTest?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST)),this._clearDepth!==t&&(this._clearDepth=t,i.clearDepth(this._clearDepth)),this._depthFunc!==r&&(this._depthFunc=r,i.depthFunc(this._depthFunc))},e.prototype.depthMask=function(e){this._depthMask!==e&&(this._depthMask=e,this._gl.depthMask(this._depthMask))},e.prototype.viewport=function(e){e[0]===this._viewport[0]&&e[1]===this._viewport[1]&&e[2]===this._viewport[2]&&e[3]===this._viewport[3]||(this._viewport[0]=e[0],this._viewport[1]=e[1],this._viewport[2]=e[2],this._viewport[3]=e[3],this._gl.viewport(this._viewport[0],this._viewport[1],this._viewport[2],this._viewport[3]))},e.prototype.blendFunc=function(e){this._blendFunc[0]==e[0]&&this._blendFunc[1]==e[1]&&this._blendFunc[2]==e[2]&&this._blendFunc[3]==e[3]||(this._blendFunc[0]=e[0],this._blendFunc[1]=e[1],this._blendFunc[2]=e[2],this._blendFunc[3]=e[3],this._gl.blendFuncSeparate(this._blendFunc[0],this._blendFunc[1],this._blendFunc[2],this._blendFunc[3]))},e.prototype.blend=function(e){const t=this._gl;this._blend!==e&&(this._blend=e,this._blend?this._gl.enable(t.BLEND):this._gl.disable(t.BLEND))},e.prototype.stencilTest=function(e,t,r,i){const n=this._gl;this._stencil!==e&&(this._stencil=e,this._stencil?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST)),this._stencilFunc[0]===t[0]&&this._stencilFunc[1]===t[1]&&this._stencilFunc[2]===t[2]||(this._stencilFunc[0]=t[0],this._stencilFunc[1]=t[1],this._stencilFunc[2]=t[2],n.stencilFunc(t[0],t[1],t[2])),this._stencilOp[0]===r[0]&&this._stencilOp[1]===r[1]&&this._stencilOp[2]===r[2]||(this._stencilOp[0]=r[0],this._stencilOp[1]=r[1],this._stencilOp[2]=r[2],n.stencilOp(r[0],r[1],r[2])),this._stencilMask!==i&&(this._stencilMask=i,n.stencilMask(this._stencilMask))},e.prototype.invalidateStates=function(){this._mesh=null,this._framebuffer=null,this._shader=null},e.prototype.invalidateShadow=function(){this.dirtyBits|=e.SHADOW_DIRTY_BIT},e.prototype.invalidateLight=function(){this.dirtyBits|=e.LIGHT_DIRTY_BIT},e.prototype.invalidateClip=function(){this.dirtyBits|=e.CLIP_DIRTY_BIT},e.prototype.invalidatePlatte=function(){this.dirtyBits|=e.PLATTE_DIRTY_BIT},e.prototype.invalidateOther=function(){this.dirtyBits|=e.OTHER_DIRTY_BIT},e.prototype._syncGlobalUniforms=function(e,t){var r;if(t&&(r=e["m_uGlobal.clipPlanes[0]"])){var i=t.getClippingPlanes();this._planesArray[0]=i[0][0],this._planesArray[1]=i[0][1],this._planesArray[2]=i[0][2],this._planesArray[3]=-i[0][3],this._planesArray[4]=i[1][0],this._planesArray[5]=i[1][1],this._planesArray[6]=i[1][2],this._planesArray[7]=-i[1][3],this._planesArray[8]=i[2][0],this._planesArray[9]=i[2][1],this._planesArray[10]=i[2][2],this._planesArray[11]=-i[2][3],this._planesArray[12]=i[3][0],this._planesArray[13]=i[3][1],this._planesArray[14]=i[3][2],this._planesArray[15]=-i[3][3],this._planesArray[16]=i[4][0],this._planesArray[17]=i[4][1],this._planesArray[18]=i[4][2],this._planesArray[19]=-i[4][3],this._planesArray[20]=i[5][0],this._planesArray[21]=i[5][1],this._planesArray[22]=i[5][2],this._planesArray[23]=-i[5][3],r.upload(this._planesArray,this._gl)}},e.prototype._syncLightUniforms=function(e,t){var r;t&&((r=e["m_uSunLight.intensity"])&&r.upload(t.intensity,this._gl),(r=e["m_uSunLight.diffuseMatrix[0]"])&&r.upload(t.envmapMatrix,this._gl),(r=e["m_uSunLight.direction"])&&r.upload(t.direction,this._gl))},e.prototype._syncShadowUniforms=function(e,t){if(t){var r=e.m_uShadowSize;r&&(r.upload(t.size,this._gl),i.Environment.isMobile||((r=e.m_uShadowFine).upload(t.fine?1:0,this._gl),(r=e.m_uShadowSplit).upload(t.shadowSplit,this._gl)));for(var n=0,a=t.shadowMaps.length;n<a;n++)(r=e["m_uShadowTexture"+n])&&(r.upload(6+n,this._gl),t.shadowMaps[n].use(6+n,this._gl)),(r=e["m_uSunLight.shadowMatrix"+n])&&r.upload(t.shadowMatrices[n],this._gl)}},e.prototype._syncPlatteUniforms=function(e){var t=e.m_uPlatteTexture;t&&t.upload(3,this._gl)},e}()},"./04renderer/rendereffects/Blur.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./02resource/m3d_shader_library.js"),n=r("./02resource/m3d_shader_source.js"),a=r("./04renderer/pipeline/Blit.ts");class s{constructor(e,t,r){this.ready=!1,this.result=null;var s="blurx-"+t,o="blury-"+t;if(!i.default[s]||!i.default[o]){var l,d=[],u=0;for(l=-t;l<=t;++l){var c=l/t*1.5,h=Math.exp(-c*c*r);d.push(h),u+=h}for(l=0;l<2*t+1;++l)d[l]/=u}const m=e.gl;if(!i.default[s]){var f="vec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\n{\n    vec4 value = vec4(0);\n    float kernel["+(2*t+1)+"];\n";for(let e=0;e<2*t+1;++e)f+="   kernel["+e+"] = "+d[e]+";\n";f+="    for (int i = -"+t+"; i <= "+t+"; i++)\n",m.isWebGL2?f+="        value += texture(tex, (gl_FragCoord.xy + vec2(float(i), 0.0)) * invResolution) * kernel[i + "+t+"];\n":f+="        value += texture2D(tex, (gl_FragCoord.xy + vec2(float(i), 0.0)) * invResolution) * kernel[i + "+t+"];\n",f+="    return value;\n}\n",i.default[s]=new n.default(s,"blit.vs",["blit.fs",f],{highPrecision:!0,position:!0,uv:!0})}if(!i.default[o]){var p="vec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\n{\n    vec4 value = vec4(0);\n    float kernel["+(2*t+1)+"];\n";for(let e=0;e<2*t+1;++e)p+="   kernel["+e+"] = "+d[e]+";\n";p+="    for (int i = -"+t+"; i <= "+t+"; i++)\n",m.isWebGL2?p+="        value += texture(tex, (gl_FragCoord.xy + vec2(0.0, float(i))) * invResolution) * kernel[i + "+t+"];\n":p+="        value += texture2D(tex, (gl_FragCoord.xy + vec2(0.0, float(i))) * invResolution) * kernel[i + "+t+"];\n",p+="    return value;\n} ",i.default[o]=new n.default(o,"blit.vs",["blit.fs",p],{highPrecision:!0,position:!0,uv:!0})}this._blitx=new a.default(e,i.default[s]),this._blity=new a.default(e,i.default[o]),this.ready=this._blitx.ready&&this._blity.ready}destroy(){this.ready&&(this._blitx.destroy(),this._blitx=null,delete this._blitx,this._blity.destroy(),this._blity=null,delete this._blity,this.ready=!1)}smooth(e,t,r,i){if(!this.ready)return console.error("'blur' is not ready."),null;e.getWidth()==t.getWidth()&&e.getHeight()==t.getHeight()||console.error("'blur' requires two render targets in the same size.");const n=[e,t];var a,s=0;for(a=0;a<i;++a)this._blitx.setTexture(n[s].getColorBuffer()),this._blitx.render(r,n[1-s]),s=1-s,this._blity.setTexture(n[s].getColorBuffer()),this._blity.render(r,n[1-s]),s=1-s;return this.result=n[s].getColorBuffer(),this.result}}},"./04renderer/rendereffects/DOF.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./04renderer/rendereffects/RenderEffect.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./04renderer/pipeline/Blit.ts"),s=r("./04renderer/pipeline/RenderTarget.ts"),o=r("./00utility/Environment.ts"),l=r("./04renderer/pipeline/RenderPass.ts"),d=r("./03scene/materials/MaterialAdhoc.ts");class u extends i.RenderEffect{constructor(e){super("DepthOfField",i.RenderEffectPriorityEnum.LOW,e),this._opaques=new l.default(e.getResourceManager(),e.getRenderQueueManager(),!1,{line:!1,transparent:!1,mask:!1,uniqueId:"DepthOfField"}),this._transparents=new l.default(e.getResourceManager(),e.getRenderQueueManager(),!1,{line:!1,transparent:!0,uniqueId:"DepthOfField"}),this._useDepth=!1;let t=[];const r=this._renderScene.getScene();let a;if(r.clipping.isEnabled()&&t.push("CLIPPING"),r.needRenderDoubleSided()&&t.push("DOUBLESIDED"),r.compressed&&t.push("COMPRESSION"),t.push("ENCODE_DEPTH"),t.push("VISIBILITY"),!(a=e.getResourceManager().getShader("depth",t)).ready){var s=n.default.depth;a.createFromShaderSource(s,t)}this._opaques.setOverridedShader(a),this._transparents.setOverridedShader(a);var o=new d.default("dof-depth",e.getResourceManager());this._opaques.setOverridedMaterial(o),this._transparents.setOverridedMaterial(o)}destroy(){this._blit.destroy(),this._blit=null,delete this._blit,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,super.destroy()}_initialize(){let e=this._renderScene.getResourceManager(),t=e.gl;this._blit=new a.default(e,n.default.blit_dof,o.Environment.isMobile),this._blit.setParameter("maxblur",1),this._blit.setParameter("aperture",1e-5),this._blit.setParameter("focus",5e3);let r=this._renderScene.getCamera();return t.isWebGL2?(o.Environment.isMobile?this._renderTarget=new s.default("DepthOfField-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:3}):this._renderTarget=new s.default("DepthOfField-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],colorFilter:t.NEAREST,colorBuffer:3}),this._blit.ready&&this._renderTarget.ready):(this._colorBuffer=this._renderScene.getResourceManager().getTexture("DOF-color-buffer"),this._colorBuffer.create(r.viewport[2],r.viewport[3],t.wbFormat,t.NEAREST,t.CLAMP_TO_EDGE),this._blit.ready&&this._colorBuffer.ready)}resize(e,t){this._ready&&(this._ready=!1,this._renderScene.getResourceManager().gl.isWebGL2?(this._renderTarget.resize(e,t),this._ready=this._renderTarget.ready):(this._colorBuffer.resize(e,t),this._ready=this._colorBuffer.ready),this._renderTarget2&&this._renderTarget2.ready&&(this._renderTarget2.resize(e,t),this._ready=this._ready&&this._renderTarget2.ready))}doesSupportMobile(e){return!0}onSceneChanged(e){if(!this._ready)return;this._opaques.queue.removeDrawables(),this._transparents.queue.removeDrawables();let t=this._renderScene.getScene();for(var r in t.models){t.models[r].drawables.forEach(e=>{this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)})}const i=this._renderScene.getOpaques();this._opaques.setCullFace(i.getCullFace());const n=this._renderScene.getTransparents();this._transparents.setCullFace(n.getCullFace())}setParameter(e,t){switch(e){case"depth":var r=this._renderScene.getResourceManager().getTexture("dof-depth"),i=this._renderScene.getResourceManager().gl,n=t.split("."),a=i.RGB;"png"===n[n.length-1]&&(a=i.RGBA),r.createFromFile(t,a,i.NEAREST,i.CLAMP_TO_EDGE,()=>{}),this._blit.setDepthTexture(r);break;case"useDepth":if(this._useDepth=t,!this._renderTarget2&&t){i=this._renderScene.getResourceManager().gl;let e=this._renderScene.getCamera();this._renderTarget2=new s.default("dof-depth",this._renderScene.getResourceManager(),e.viewport[2],e.viewport[3],{clearColor:[0,0,0,1],colorFormat:i.RGBA8,colorFilter:i.NEAREST,colorBuffer:4})}if(this._blit.setParameter("useDepth",t),t)this._blit.setDepthTexture(this._renderTarget2.getColorBuffer());else(r=this._renderScene.getResourceManager().getTexture("dof-depth"))&&r.ready&&this._blit.setDepthTexture(r);break;case"aperture":this._blit.setParameter("aperture",t);break;case"focus":this._blit.setParameter("focus",t)}}addDrawable(e){this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)}removeDrawable(e){this._opaques.queue.removeDrawable(e)||this._transparents.queue.removeDrawable(e)}addCustomDrawable(e){this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)}removeCustomDrawable(e){this._opaques.queue.removeDrawable(e)||this._transparents.queue.addDrawable(e)}draw(e,t=-1){if(!this._enabled||!this._ready)return;const r=this._renderScene.getCamera(),i=this._renderScene.getRenderer(),n=this._renderScene.getScene().getMainLight(),a=this._renderScene.getScene().clipping;let s=this._renderScene.getResourceManager().gl;this._useDepth&&(i.clear(this._renderTarget2,s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),this._opaques.render(this._renderTarget2,i,r,null,a,n),this._transparents.render(this._renderTarget2,i,r,null,a,n)),this._blit.setParameter("nearFar",[r._znear,r._zfar]),s.isWebGL2?(this._renderTarget.getFramebuffer().copy(e.getFramebuffer(),s.COLOR_BUFFER_BIT),this._blit.setTexture(this._renderTarget.getColorBuffer())):(this._colorBuffer.copy(),this._blit.setTexture(this._colorBuffer)),this._blit.render(i,e)}}},"./04renderer/rendereffects/Glow.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return c});var i=r("./04renderer/rendereffects/RenderEffect.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./04renderer/pipeline/Blit.ts"),s=r("./04renderer/pipeline/RenderTarget.ts"),o=r("./00utility/Environment.ts"),l=r("./04renderer/rendereffects/Blur.ts"),d=r("./04renderer/pipeline/RenderPass.ts"),u=r("./04renderer/pipeline/RenderPassTransparent.ts");class c extends i.RenderEffect{constructor(e){super("Glow",i.RenderEffectPriorityEnum.NORMAL,e),this._radius=32,this._intensity=.5;let t=[];const r=this._renderScene.getScene();if(r.clipping.isEnabled()&&t.push("CLIPPING"),r.needRenderDoubleSided()&&t.push("DOUBLESIDED"),r.compressed&&t.push("COMPRESSION"),o.Environment.isMobile&&t.push("ENCODE_NORMAL"),t.push("VISIBILITY"),this._shader=e.getResourceManager().getShader("plain",t),!this._shader.ready){var a=n.default.plain;this._shader.createFromShaderSource(a,t)}this._blur=new l.default(e.getResourceManager(),this._radius,3),this._renderPasses=new Map,this._opaques=new d.default(e.getResourceManager(),e.getRenderQueueManager(),!1,{line:!1,transparent:!1,mask:!1,uniqueId:"glow"}),this._transparents=new u.default(e.getResourceManager(),e.getRenderQueueManager(),{line:!1,transparent:!0,uniqueId:"glow"})}destroy(){this._blit.destroy(),this._blit=null,delete this._blit,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._renderTarget2.destroy(),this._renderTarget2=null,delete this._renderTarget2,super.destroy()}_initialize(){let e=this._renderScene.getResourceManager(),t=e.gl;if(!t.isWebGL2)return console.warn("Glow effect needs webGL2.0 support!"),this._ready=!1,!1;this._blit=new a.default(e,n.default.blit_glow,o.Environment.isMobile),this._blit.setParameter("offset",0);let r=this._renderScene.getCamera();return o.Environment.isMobile?(this._renderTarget=new s.default("glow-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],depthFunc:t.LEQUAL,colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:0,depthBuffer:0,depthFilter:t.NEAREST,depthTest:!0}),this._renderTarget2=new s.default("glow-blur-rt",e,r.viewport[2],r.viewport[3],{clearColor:[1,1,1,0],colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:2})):(this._renderTarget=new s.default("glow-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],depthFunc:t.LEQUAL,colorFilter:t.NEAREST,colorBuffer:1,depthBuffer:0,depthFilter:t.NEAREST,depthTest:!0}),this._renderTarget2=new s.default("glow-blur-rt",e,r.viewport[2],r.viewport[3],{clearColor:[1,1,1,0],colorFilter:t.NEAREST,colorBuffer:2})),this._blit.ready&&this._renderTarget.ready&&this._renderTarget2}resize(e,t){this._ready&&(this._ready=!1,this._renderTarget.resize(e,t),this._renderTarget2.resize(e,t),this._ready=this._renderTarget.ready&&this._renderTarget2.ready)}doesSupportMobile(e){return!0}doesSupportWebGL1(){return!1}onSceneChanged(e){this._ready}setParameter(e,t){switch(e){case"intensity":this._intensity=t,this._blit.setParameter("intensity",t)}}addCustomDrawable(e){this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)}removeCustomDrawable(e){this._opaques.queue.removeDrawable(e)||this._transparents.queue.addDrawable(e)}addPawn(e){e.drawables.forEach(e=>{this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)})}removePawn(e){e.drawables.forEach(e=>{this._opaques.queue.removeDrawable(e)||this._transparents.queue.removeDrawable(e)})}draw(e,t=-1){if(!this._enabled||!this._ready)return;const r=this._renderScene.getCamera(),i=this._renderScene.getRenderer(),n=this._renderScene.getScene().getMainLight(),a=this._renderScene.getScene().clipping;this.resize(r.viewport[2],r.viewport[3]);let s=this._renderScene.getResourceManager().gl;t<0&&!e.getOption("stencilTest")&&this._renderTarget.getFramebuffer().copy(e.getFramebuffer(),s.DEPTH_BUFFER_BIT),this._renderScene.getRenderer().clear(this._renderTarget,s.COLOR_BUFFER_BIT),s.enable(s.POLYGON_OFFSET_FILL),s.polygonOffset(-1,-1),this._renderPasses.forEach(e=>{e.renderPass.render(this._renderTarget,i,r,null,a,n)}),this._opaques.render(this._renderTarget,i,r,null,a,n),this._transparents.render(this._renderTarget,i,r,null,a,n),s.disable(s.POLYGON_OFFSET_FILL);let o=this._blur.smooth(this._renderTarget,this._renderTarget2,i,1);this._blit.setTexture(o);let l=this._renderTarget.getOption("blendFunc");e.setOption("blendFunc",[s.ONE,s.ONE,s.ONE,s.ONE]),this._blit.render(i,e,!0),e.setOption("blendFunc",l)}}},"./04renderer/rendereffects/GlowBlur.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./02resource/m3d_shader_library.js"),n=r("./04renderer/pipeline/Blit.ts"),a=r("./00utility/Environment.ts");class s{constructor(e,t){this.ready=!1,this.result=null,this._blitx=new n.default(e,i.default.glow_blur,a.Environment.isMobile),this._blitx.setParameter("radius",t),this._blitx.setParameter("direction",[1,0]),this._blitx.setParameter("weights[0]",[.05,.1,.2,.3,.2,.1,.05]),this._blity=new n.default(e,i.default.glow_blur,a.Environment.isMobile),this._blity.setParameter("radius",t),this._blity.setParameter("direction",[0,1]),this._blity.setParameter("weights[0]",[.05,.1,.2,.3,.2,.1,.05]),this.ready=this._blitx.ready&&this._blity.ready}destroy(){this.ready&&(this._blitx.destroy(),this._blitx=null,delete this._blitx,this._blity.destroy(),this._blity=null,delete this._blity,this.ready=!1)}setRadius(e){this._blitx.setParameter("radius",e),this._blity.setParameter("radius",e)}smooth(e,t,r){return this.ready?(e.getWidth()==t.getWidth()&&e.getHeight()==t.getHeight()||console.error("'blur' requires two render targets in the same size."),this._blitx.setTexture(e.getColorBuffer()),this._blitx.render(r,t),this._blity.setTexture(t.getColorBuffer()),this._blity.render(r,e),this.result=e.getColorBuffer(),this.result):(console.error("'blur' is not ready."),null)}}},"./04renderer/rendereffects/Highlight.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return c});var i=r("./04renderer/rendereffects/RenderEffect.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./04renderer/pipeline/Blit.ts"),s=r("./04renderer/pipeline/RenderTarget.ts"),o=r("./00utility/Environment.ts"),l=r("./04renderer/rendereffects/GlowBlur.ts"),d=r("./04renderer/pipeline/RenderPass.ts"),u=r("./04renderer/pipeline/RenderPassTransparent.ts");class c extends i.RenderEffect{constructor(e){super("Highlight",i.RenderEffectPriorityEnum.NORMAL,e),this._radius=2,this._intensity=.5,this._innerGlow=!1,this._outerGlow=!0;let t=[];const r=this._renderScene.getScene();if(r.clipping.isEnabled()&&t.push("CLIPPING"),r.needRenderDoubleSided()&&t.push("DOUBLESIDED"),r.compressed&&t.push("COMPRESSION"),o.Environment.isMobile&&t.push("MOBILE"),t.push("VISIBILITY"),this._shader=e.getResourceManager().getShader("plain",t),!this._shader.ready){var a=n.default.plain;this._shader.createFromShaderSource(a,t)}this._blur=new l.default(e.getResourceManager(),this._radius),this._renderPasses=new Map,this._opaques=new d.default(e.getResourceManager(),e.getRenderQueueManager(),!1,{line:!1,transparent:!1,mask:!1,uniqueId:"highlight"}),this._transparents=new u.default(e.getResourceManager(),e.getRenderQueueManager(),{line:!1,transparent:!0,uniqueId:"highlight"})}destroy(){this._blit.destroy(),this._blit=null,delete this._blit,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._renderTarget2.destroy(),this._renderTarget2=null,delete this._renderTarget2,super.destroy()}_initialize(){let e=this._renderScene.getResourceManager(),t=e.gl;this._blit=new a.default(e,n.default.blit_glow,o.Environment.isMobile);let r=this._renderScene.getCamera();return o.Environment.isMobile?(this._renderTarget=new s.default("highlight-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],depthFunc:t.LEQUAL,colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:0,depthBuffer:0,depthFilter:t.NEAREST,depthTest:!0,stencilTest:!0}),this._renderTarget2=new s.default("highlight-blur-rt",e,r.viewport[2],r.viewport[3],{clearColor:[1,1,1,0],colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:2})):(this._renderTarget=new s.default("highlight-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],depthFunc:t.LEQUAL,colorFilter:t.NEAREST,colorBuffer:1,depthBuffer:0,depthFilter:t.NEAREST,depthTest:!0,stencilTest:!0}),this._renderTarget2=new s.default("highlight-blur-rt",e,r.viewport[2],r.viewport[3],{clearColor:[1,1,1,0],colorFilter:t.NEAREST,colorBuffer:2})),this._blit.setParameter("intensity",this._intensity),this._blit.ready&&this._renderTarget.ready&&this._renderTarget2}resize(e,t){this._ready&&(this._ready=!1,this._renderTarget.resize(e,t),this._renderTarget2.resize(e,t),this._ready=this._renderTarget.ready&&this._renderTarget2.ready)}doesSupportMobile(e){return!0}onSceneChanged(e){this._ready}setParameter(e,t){switch(e){case"intensity":this._intensity=t,this._blit.setParameter("intensity",this._intensity);break;case"radius":this._radius=t,this._blur.setRadius(this._radius);break;case"innerGlow":this._innerGlow=!0}}addCustomDrawable(e){this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)}removeCustomDrawable(e){this._opaques.queue.removeDrawable(e)||this._transparents.queue.addDrawable(e)}draw(e,t=-1){if(!this._enabled||!this._ready)return;const r=this._renderScene.getCamera(),i=this._renderScene.getRenderer(),n=this._renderScene.getScene().getMainLight(),a=this._renderScene.getScene().clipping;this.resize(r.viewport[2],r.viewport[3]);let s=this._renderScene.getResourceManager().gl;this._renderScene.getRenderer().clear(this._renderTarget,s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT|s.STENCIL_BUFFER_BIT);let o=e.getOption("stencilFunc"),l=e.getOption("stencilOp"),d=e.getOption("colorMask");e.setOption("colorMask",[!1,!1,!1,!1]),e.setOption("stencilFunc",[s.ALWAYS,1,255]),e.setOption("stencilOp",[s.KEEP,s.KEEP,s.REPLACE]),e.setOption("depthTest",!1),e.setOption("stencilMask",!0),e.always=!0,i.clear(e,s.STENCIL_BUFFER_BIT),this._renderPasses.forEach(t=>{t.renderPass.render(this._renderTarget,i,r,null,a,n),t.renderPass.render(e,i,r,null,a,n)}),this._opaques.render(this._renderTarget,i,r,null,a,n),this._transparents.render(this._renderTarget,i,r,null,a,n),this._opaques.render(e,i,r,null,a,n),this._transparents.render(e,i,r,null,a,n);let u=this._blur.smooth(this._renderTarget,this._renderTarget2,i);this._blit.setTexture(u),e.setOption("colorMask",d),e.setOption("depthTest",!0),this._outerGlow&&(this._blit.setParameter("offset",0),e.setOption("stencilFunc",[s.NOTEQUAL,1,255]),this._blit.render(i,e,!0)),this._innerGlow&&(this._blit.setParameter("offset",1),e.setOption("stencilFunc",[s.EQUAL,1,255]),this._blit.render(i,e,!0)),e.setOption("stencilFunc",o),e.setOption("stencilOp",l),e.setOption("stencilMask",!1),e.always=!0}}},"./04renderer/rendereffects/OIT.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./02resource/m3d_shader_library.js"),n=r("./04renderer/pipeline/RenderTarget.ts"),a=r("./04renderer/pipeline/Blit.ts");class s{constructor(e,t){this._resourceManager=e,this._renderQueueManager=t;const r=this._resourceManager.gl;r.isWebGL2||r.drawBuffers?(this._renderTarget=new n.default("woit-accum",e,1,1,{colorFormat:r.RGBA16F,colorBuffer:1,colorBuffers:[{colorFormat:r.R16F,index:2}],blend:!0,depthMask:!0,depthBuffer:0,depthTest:!0,depthFunc:r.LEQUAL,clearColor:[0,0,0,1]}),this._renderQueueSolid=this._renderQueueManager.getQueue({texture:!1,color:!1,line:!1,uniqueId:"OIT"}),this._renderQueueTexture=this._renderQueueManager.getQueue({texture:!0,color:!1,line:!1,uniqueId:"OIT"}),this._renderQueueColor=this._renderQueueManager.getQueue({texture:!1,color:!0,line:!1,uniqueId:"OIT"}),this._blit=new a.default(e,i.default.woit_reveal),this._shadersSolid=new Array(3),this._shadersTexture=new Array(3),this._shadersColor=new Array(3),this._recompileShader(e,["MRT_OIT"]),this._overridedMaterial=null):console.warn("OIT is not supported in WebGL1.0 context")}destroy(){this._blit.destroy(),this._blit=null,delete this._blit,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget;for(let e=0;e<this._shadersSolid.length;e++)this._shadersSolid[e].destroy();this._shadersSolid=null,delete this._shadersSolid;for(let e=0;e<this._shadersTexture.length;e++)this._shadersTexture[e].destroy();this._shadersTexture=null,delete this._shadersTexture;for(let e=0;e<this._shadersColor.length;e++)this._shadersColor[e].destroy();this._shadersColor=null,delete this._shadersColor}_recompileShader(e,t){var r={woit_accum_solid:this._shadersSolid,woit_accum_texture:this._shadersTexture,woit_accum_color:this._shadersColor};for(var n in r){r[n][0]=e.getShader(n,t),r[n][0].ready||r[n][0].createFromShaderSource(i.default[n],t);const a=r[n][0];let s=a.flags.concat("MODEL_TRANSFORM"),o=this._resourceManager.getShader(a.shaderSource.name,s);o.ready||o.createFromShaderSource(a.shaderSource,s),r[n][1]=o;let l=s.concat("INSTANCING"),d=this._resourceManager.getShader(a.shaderSource.name,l);d.ready||d.createFromShaderSource(a.shaderSource,l),r[n][2]=d}}resize(e,t){this._renderTarget.resize(e,t)}addDrawable(e){return!(e.material.getTransparent()>.99&&(null===this._overridedMaterial||this._overridedMaterial.getTransparent()>.99))&&(this._renderQueueSolid.addDrawable(e)||this._renderQueueTexture.addDrawable(e)||this._renderQueueColor.addDrawable(e))}removeDrawable(e){return this._renderQueueSolid.removeDrawable(e)||this._renderQueueTexture.removeDrawable(e)||this._renderQueueColor.removeDrawable(e)}createQueue(e,t){this._renderQueueSolid.create(e,t),this._renderQueueTexture.create(e,t),this._renderQueueColor.create(e,t)}setOverridedMaterial(e){this._overridedMaterial=null!==e?e:null}render(e,t,r,i,n,a){const s=this._resourceManager.gl;this.resize(r.viewport[2],r.viewport[3]),t.renderState.invalidateLight(),this._renderTarget.setOption("depthMask",!0),t.clear(this._renderTarget,s.COLOR_BUFFER_BIT),this._renderTarget.setOption("blendFunc",[s.ONE,s.ONE,s.ZERO,s.ONE_MINUS_SRC_ALPHA]),this._renderTarget.setOption("blend",!0),this._renderTarget.setOption("depthMask",!1),this._renderTarget.always=!0,this._renderTarget.render(t.renderState),s.clearBufferfv(s.COLOR,1,new Float32Array([0,0,0,1])),this._renderTarget.getFramebuffer().copy(e.getFramebuffer(),s.DEPTH_BUFFER_BIT),t.drawDrawables(this._renderTarget,this._renderQueueSolid.drawables,r,this._shadersSolid,this._overridedMaterial,n,a,i,null),t.drawDrawables(this._renderTarget,this._renderQueueTexture.drawables,r,this._shadersTexture,this._overridedMaterial,n,a,i,null),t.drawDrawables(this._renderTarget,this._renderQueueColor.drawables,r,this._shadersColor,this._overridedMaterial,n,a,i,null),e.setOption("blendFunc",[s.ONE_MINUS_SRC_ALPHA,s.SRC_ALPHA,s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA]),this._blit.setTexture(this._renderTarget.getColorBuffer(0)),this._blit.setParameter("uTexture1",this._renderTarget.getColorBuffer(1)),this._blit.render(t,e,!0)}}},"./04renderer/rendereffects/RenderEffect.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"RenderEffectPriorityEnum",function(){return i}),r.d(t,"RenderEffect",function(){return a});var i,n=r("./04renderer/pipeline/RenderPassNode.ts");!function(e){e[e.LOW=0]="LOW",e[e.NORMAL=1]="NORMAL",e[e.HIGH=2]="HIGH",e[e.VERY_HIGH=3]="VERY_HIGH"}(i||(i={}));class a{constructor(e,t,r){this.name=e,this.priority=t,this._renderScene=r,this._enabled=!1,this._ready=!1,this._ready=this._initialize(),this._ready||console.warn(`RenderEffect ${e} initialized failed!`),this._renderPasses=new Map}destroy(){this._renderScene=null,delete this._renderScene,delete this._renderPasses,this._renderPasses=null,this._shader&&(this._shader.destroy(),delete this._shader,this._shader=null),this._ready=!1}setEnabled(e){this._ready&&(this._enabled=e)}doesSupportMobile(e){return!0}doesSupportWebGL1(){return!0}isEnabled(){return this._enabled}resize(e,t){}draw(e,t=-1){}_initialize(){return!0}setParameter(e,t){}getParameter(e){}onSceneChanged(e){}recompileShader(e,t){}_getELementNodes(e){let t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r],n=i.split("+")[0];let a=this._renderScene.getScene().models[n].tree.elements[i];if(a)a.getNodes().forEach(e=>{e.drawable.mesh.isLine()||t.push(e)});else console.warn("Element: +"+i+" can not be found!")}return t}addElements(e,t){let r=t.emissiveColor||[1,1,1];if(e){let t=this._getELementNodes(e),i="emissive"+r,a=this._renderScene.getScene().materialManager.createMaterialAdhoc(i);if(a.attachShader(this._shader,this._renderScene.getResourceManager()),a.setDiffuse(r),a.setTransparent(1),this._renderPasses.has(i)){let e=this._renderPasses.get(i),r=e.renderPass,n=e.nodes;t.forEach(e=>{n.has(e)||n.add(e)}),r.setNodes([...n.keys()])}else{let e=new n.default(this._renderScene.getResourceManager(),this._renderScene.getRenderQueueManager());e.setOverridedShader(this._shader),e.setOverridedMaterial(a),e.setNodes(t),this._renderPasses.set(i,{renderPass:e,nodes:new Set(t)})}}}removeElements(e){let t=this._getELementNodes(e),r=[];this._renderPasses.forEach((e,i)=>{e.renderPass.removeNodes(t),t.forEach(t=>{e.nodes.has(t)&&e.nodes.delete(t)}),0===e.renderPass.getNodes().length&&r.push(i)}),r.forEach(e=>{this._renderPasses.delete(e)})}addDrawable(e){}removeDrawable(e){}addCustomDrawable(e){}removeCustomDrawable(e){}addPawn(e){}removePawn(e){}}},"./04renderer/rendereffects/RenderEffectLibrary.ts":function(e,t,r){"use strict";r.r(t);var i=r("./04renderer/rendereffects/Sketch.ts"),n=r("./04renderer/rendereffects/SSAO_DAM.ts"),a=r("./04renderer/rendereffects/Glow.ts"),s=r("./04renderer/rendereffects/Highlight.ts"),o=r("./04renderer/rendereffects/DOF.ts");let l={Sketch:i.default,SSAO:n.default,Glow:a.default,Highlight:s.default,DepthOfField:o.default};t.default=l},"./04renderer/rendereffects/SSAO_DAM.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return c});var i=r("./00utility/Environment.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./04renderer/pipeline/Blit.ts"),s=r("./04renderer/rendereffects/Blur.ts"),o=r("./04renderer/m3d_samples.js"),l=r("./04renderer/rendereffects/RenderEffect.ts"),d=r("./04renderer/pipeline/RenderPass.ts"),u=r("./04renderer/pipeline/RenderTarget.ts");class c extends l.RenderEffect{constructor(e){super("SSAO",l.RenderEffectPriorityEnum.HIGH,e)}_initialize(){super._initialize(),this._radius=4;const e=this._renderScene.getResourceManager(),t=e.gl;if(i.Environment.isMobile?this._rt0=new u.default("ssao-rt0",e,1,1,{depthTest:!0,colorFormat:t.RGBA8,clearColor:[0,0,1,-1e10],colorBuffer:2,colorFilter:t.NEAREST,depthFormat:t.DEPTH24_STENCIL8,depthBuffer:1}):this._rt0=new u.default("ssao-rt0",e,1,1,{depthTest:!0,colorFormat:t.RGBA32F,clearColor:[0,0,1,0],colorFilter:t.NEAREST,depthBuffer:0}),this._rt1=new u.default("ssao-rt1",e,1,1,{colorFormat:t.RGBA8,colorFilter:t.LINEAR,colorBuffer:0,depthBuffer:0,depthTest:!1}),this._rt2=new u.default("ssao-rt2",e,1,1,{colorFormat:t.RGBA8,colorFilter:t.LINEAR,colorBuffer:1,depthBuffer:0,depthTest:!1}),!this._rt0.ready||!this._rt1.ready||!this._rt2.ready)return!1;this._opaques=new d.default(e,this._renderScene.getRenderQueueManager(),!1,{mask:!1,transparent:!1,line:!1,uniqueId:"ssao"}),this._maskeds=new d.default(e,this._renderScene.getRenderQueueManager(),!1,{mask:!0,uniqueId:"ssao"}),this._transparents=null,this._hasTransparents=!1;let r=["VISIBILITY"];const o=this._renderScene.getScene();o.clipping.isEnabled()&&r.push("CLIPPING"),o.needRenderDoubleSided()&&r.push("DOUBLESIDED"),o.compressed&&r.push("COMPRESSION"),i.Environment.isMobile&&r.push("ENCODE_NORMAL");const l=e.getShader("normaldepth",r);if(!l.ready){var c=n.default.normaldepth;l.createFromShaderSource(c,r)}this._opaques.setOverridedShader(l),r.push("ALPHATEST");const h=e.getShader("normaldepth",r);if(!h.ready){c=n.default.normaldepth;h.createFromShaderSource(c,r)}return this._maskeds.setOverridedShader(h),this._opaques.setOverridedMaterial(o.materialManager.createMaterialAdhoc("ssao")),this._maskeds.setOverridedMaterial(o.materialManager.createMaterialAdhoc("ssao")),this._blur=new s.default(e,1,.8),this._blit=new a.default(e,n.default.ssao,i.Environment.isMobile),this._blit.setTexture(this._rt0.getColorBuffer()),this._bitblit=new a.default(e),this._blur.ready}doesSupportMobile(e){return!0}destroy(){this._ready&&(this._rt0.destroy(),this._rt0=null,delete this._rt0,this._rt1.destroy(),this._rt1=null,delete this._rt1,this._rt2.destroy(),this._rt2=null,delete this._rt2,this._blur.destroy(),this._blur=null,delete this._blur,this._blit.destroy(),this._blit=null,delete this._blit,this._maskeds.destroy(),this._maskeds=null,delete this._maskeds,this._transparents&&(this._transparents.destroy(),this._transparents=null,delete this._transparents),this._opaques.destroy(),this._opaques=null,delete this._opaques),super.destroy()}recompileShader(e,t){this._ready&&(this._opaques.recompileOverridedShader(e,t),this._maskeds.recompileOverridedShader(e,t),this._hasTransparents&&this._transparents.recompileOverridedShader(e,t))}resize(e,t){this._ready&&(this._ready=!1,this._rt0.resize(e,t),this._rt1.resize(e,t),this._rt2.resize(e,t),this._ready=this._rt0.ready&&this._rt1.ready&&this._rt2.ready,this._ready||(this._ready=!0,this.destroy()))}draw(e,t=-1){if(!this._ready||!this._enabled)return;if(!t||t<1)return;t-=1;const r=this._renderScene.getRenderer(),n=this._renderScene.getScene().getMainLight(),a=this._renderScene.getScene().clipping,s=this._renderScene.getCamera(),l=this._renderScene.getResourceManager().gl;this.resize(s.viewport[2],s.viewport[3]),r.clear(this._rt0,l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),this._opaques.render(this._rt0,r,s,null,a,n),this._maskeds.render(this._rt0,r,s,null,a,n),this._hasTransparents&&this._transparents.render(this._rt0,r,s,null,a,n),this._blit.setParameter("uNearAxis",s.getNearPlaneSize()),this._blit.setParameter("uIsPerspective",s.isPerspective()),this._blit.setParameter("uTexTransform",[1,0]),this._blit.setParameter("uRadius",this._radius),this._blit.setParameter("uTexSizeAndInv",[this._rt0.getWidth(),this._rt0.getHeight(),1/this._rt0.getWidth(),1/this._rt0.getHeight()]),i.Environment.isMobile&&(this._blit.setParameter("uNearFar",[s._znear,s._zfar]),this._blit.setDepthTexture(this._rt0.getDepthBuffer())),this._blit.setParameter("uFrameCount",t),this._blit.setParameter("SAMPLES[0]",o.default._8x8_2D_LIST[t]),r.renderState.viewport([0,0,this._rt1.getWidth(),this._rt1.getHeight()]),this._blit.render(r,this._rt1);var d=this._blur.smooth(this._rt1,this._rt2,r,1);this._bitblit.setTexture(d),l.blendFuncSeparate(l.ZERO,l.SRC_COLOR,l.ZERO,l.ONE),r.renderState.viewport([0,0,e.getWidth(),e.getHeight()]),this._bitblit.render(r,e,!0,!0),l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA)}onSceneChanged(e){if(!this._ready)return;const t=this._renderScene.getOpaques(),r=this._renderScene.getMaskeds();if(this._opaques.queue.copy(t.queue,e),this._maskeds.queue.copy(r.queue,e),this._opaques.setCullFace(t.getCullFace()),this._maskeds.setCullFace(r.getCullFace()),this._hasTransparents){const t=this._renderScene.getTransparents();this._transparents.queue.copy(t.queue,e),this._transparents.setCullFace(t.getCullFace())}}setParameter(e,t){switch(e){case"radius":this._radius=t;break;case"transparents":if(this._hasTransparents=t,this._hasTransparents&&!this._transparents){this._transparents=new d.default(this._renderScene.getResourceManager(),this._renderScene.getRenderQueueManager(),!1,{transparent:!0,mask:!1});const e=this._opaques.getOverridedShaders();this._transparents.setOverridedShader(e[0]),this._transparents.setOverridedMaterial(this._opaques.getOverridedMaterial());const t=this._renderScene.getTransparents();this._transparents.queue.copy(t.queue,-1),this._transparents.setCullFace(t.getCullFace())}}}addDrawable(e){this._opaques.queue.addDrawable(e)||this._maskeds.queue.addDrawable(e),this._hasTransparents&&this._transparents.queue.addDrawable(e)}removeDrawable(e){this._opaques.queue.removeDrawable(e)||this._maskeds.queue.removeDrawable(e)||this._transparents.queue.removeDrawable(e)}}},"./04renderer/rendereffects/Sketch.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return d});var i=r("./00utility/Environment.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./04renderer/rendereffects/RenderEffect.ts"),s=r("./04renderer/pipeline/RenderPass.ts"),o=r("./04renderer/pipeline/RenderTarget.ts"),l=r("./04renderer/pipeline/Blit.ts");class d extends a.RenderEffect{constructor(e){super("Sketch",a.RenderEffectPriorityEnum.NORMAL,e)}_initialize(){super._initialize();const e=this._renderScene.getResourceManager();this._color=[0,0,0],this._surfaceColor=[1,1,1,1],this._blit=new l.default(e,n.default.sketch,i.Environment.isMobile);const t=this._renderScene.getScene().materialManager;this._material=t.createMaterialAdhoc("sketch-surface"),this.setParameter("contrast",30),this.setParameter("detail",2),this.setParameter("colored",!1),this.setParameter("color",[0,0,0]),this.setParameter("surfaceColor",[1,1,1,1]);const r=e.gl;let a=this._renderScene.getCamera();if(i.Environment.isMobile?this._renderTarget=new o.default("sketch-position",e,a.viewport[2],a.viewport[3],{depthTest:!0,depthFunc:r.LEQUAL,colorFormat:r.RGBA8,clearColor:[.5,.5,1,0],colorFilter:r.NEAREST,depthFormat:r.DEPTH_COMPONENT24,colorBuffer:0,depthBuffer:0}):this._renderTarget=new o.default("sketch-position",e,a.viewport[2],a.viewport[3],{depthTest:!0,colorFormat:r.RGBA32F,clearColor:[0,0,1,0],colorFilter:r.NEAREST,colorBuffer:0,depthBuffer:0}),!this._renderTarget.ready)return this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._blit.destroy(),this._blit=null,delete this._blit,!1;this._opaques=new s.default(e,this._renderScene.getRenderQueueManager(),!1,{transparent:!1,mask:!1,line:!1,uniqueId:"sketch"}),this._maskeds=new s.default(e,this._renderScene.getRenderQueueManager(),!1,{mask:!0,uniqueId:"sketch"}),this._transparents=null,this._hasTransparents=!1;let d=[];const u=this._renderScene.getScene();let c;if(u.clipping.isEnabled()&&d.push("CLIPPING"),u.needRenderDoubleSided()&&d.push("DOUBLESIDED"),u.compressed&&d.push("COMPRESSION"),i.Environment.isMobile&&d.push("ENCODE_NORMAL"),d.push("VISIBILITY"),!(c=e.getShader("normaldepth",d)).ready){var h=n.default.normaldepth;c.createFromShaderSource(h,d)}if(this._opaques.setOverridedShader(c),d.push("ALPHATEST"),!(c=e.getShader("normaldepth",d)).ready){h=n.default.normaldepth;c.createFromShaderSource(h,d)}return this._maskeds.setOverridedShader(c),this._opaques.setOverridedMaterial(t.createMaterialAdhoc("sketch")),this._maskeds.setOverridedMaterial(t.createMaterialAdhoc("sketch")),!0}doesSupportMobile(e){return!0}destroy(){this._ready&&(this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._blit.destroy(),this._blit=null,delete this._blit,this._opaques.destroy(),this._opaques=null,delete this._opaques,this._maskeds.destroy(),this._maskeds=null,delete this._maskeds,this._transparents&&(this._transparents.destroy(),this._transparents=null,delete this._transparents),this._material.destroy(),this._material=null,delete this._material,this._surfaceColor=null,delete this._surfaceColor,this._color=null,delete this._color),super.destroy()}resize(e,t){this._ready&&(this._ready=!1,this._renderTarget.resize(e,t),this._ready=this._renderTarget.ready,this._ready||(this._ready=!0,this.destroy()))}setParameter(e,t){switch(e){case"detail":const i=Math.min(Math.max(t,0),99.9)/100;this._threshold=.55*Math.sqrt(1-i*i),this._blit.setParameter("uThreshold",this._threshold),this._detailout=t;break;case"contrast":this._contrast=Math.min(Math.max(t,0),100),this._contrast=this._contrast/100,this._blit.setParameter("uContrast",this._contrast),this._contrastout=t;break;case"colored":this._colored=t,this._colored?this._renderScene.setOverridedMaterials(null):(this._renderScene.setOverridedMaterials(this._material),this._material.setDiffuse(this._surfaceColor),this._material.setTransparent(this._surfaceColor[3]));break;case"color":this._color[0]=t[0],this._color[1]=t[1],this._color[2]=t[2],this._blit.setParameter("uColor",this._color);break;case"surfaceColor":this._surfaceColor[0]=t[0],this._surfaceColor[1]=t[1],this._surfaceColor[2]=t[2],this._surfaceColor[3]=t[3],this._material.setDiffuse(this._surfaceColor),this._material.setTransparent(this._surfaceColor[3]);break;case"transparents":if(this._hasTransparents=t,this._hasTransparents&&!this._transparents){this._transparents=new s.default(this._renderScene.getResourceManager(),this._renderScene.getRenderQueueManager(),!1,{transparent:!0,mask:!1,uniqueId:"sketch"});let e=this._renderScene.getScene();for(var r in e.models){e.models[r].drawables.forEach(e=>{this._transparents.queue.addDrawable(e)})}const t=this._renderScene.getTransparents();this._transparents.setCullFace(t.getCullFace());const i=this._opaques.getOverridedShaders();this._transparents.setOverridedShader(i[0]),this._transparents.setOverridedMaterial(this._opaques.getOverridedMaterial())}}}getParameter(e){switch(e){case"detail":return this._detailout;case"contrast":return this._contrastout;case"colored":return this._colored;case"color":return this._color;case"surfaceColor":return this._surfaceColor}}draw(e,t=-1){if(!this._ready||!this._enabled)return;const r=this._renderScene.getCamera(),n=this._renderScene.getRenderer(),a=this._renderScene.getScene().getMainLight(),s=this._renderScene.getScene().clipping;this.resize(r.viewport[2],r.viewport[3]);const o=this._renderScene.getResourceManager().gl;n.clear(this._renderTarget,o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),this._opaques.render(this._renderTarget,n,r,null,s,a),this._maskeds.render(this._renderTarget,n,r,null,s,a),this._hasTransparents&&this._transparents.render(this._renderTarget,n,r,null,s,a),this._blit.setParameter("uNearAxis",r.getNearPlaneSize()),this._blit.setParameter("uIsPerspective",r.isPerspective()),this._blit.setTexture(this._renderTarget.getColorBuffer()),i.Environment.isMobile&&(this._blit.setParameter("uNearFar",[r._znear,r._zfar]),this._blit.setDepthTexture(this._renderTarget.getDepthBuffer())),n.renderState.viewport([0,0,e.getWidth(),e.getHeight()]),this._blit.render(n,e,!0)}onSceneChanged(e){if(!this._ready)return;this._opaques.queue.removeDrawables(),this._maskeds.queue.removeDrawables(),this._hasTransparents&&this._transparents.queue.removeDrawables();let t=this._renderScene.getScene();for(var r in t.models){t.models[r].drawables.forEach(e=>{this._opaques.queue.addDrawable(e)||this._maskeds.queue.addDrawable(e),this._hasTransparents&&this._transparents.queue.addDrawable(e)})}const i=this._renderScene.getOpaques(),n=this._renderScene.getMaskeds();if(this._opaques.setCullFace(i.getCullFace()),this._maskeds.setCullFace(n.getCullFace()),this._hasTransparents){const e=this._renderScene.getTransparents();this._transparents.setCullFace(e.getCullFace())}}recompileShader(e,t){this._ready&&(this._opaques.recompileOverridedShader(e,t),this._maskeds.recompileOverridedShader(e,t),this._hasTransparents&&this._transparents.recompileOverridedShader(e,t))}setEnabled(e){super.setEnabled(e),this._ready&&(this._enabled?this._renderScene.setOverridedMaterials(this._material):this._renderScene.setOverridedMaterials(null))}addDrawable(e){this._opaques.queue.addDrawable(e)||this._maskeds.queue.addDrawable(e),this._hasTransparents&&this._transparents.queue.addDrawable(e)}removeDrawable(e){this._opaques.queue.removeDrawable(e)||this._maskeds.queue.removeDrawable(e)||this._transparents&&this._transparents.queue.removeDrawable(e)}}},"./04renderer/shadow/Shadow.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./03scene/camera/m3d_shadow_camera.js"),n=r("./04renderer/pipeline/RenderPass.ts"),a=r("./02resource/m3d_shader_library.js");class s{constructor(e){this._renderScene=e;const t=this._renderScene.getCamera(),r=t.viewport[2],s=t.viewport[3];this.smSize=r<512&&s<512?1024:2048;const o=this._renderScene.getScene(),l=this._renderScene.getResourceManager();this._opaques=new n.default(l,this._renderScene.getRenderQueueManager(),!1,{shadowCaster:!0,mask:!1}),this._maskeds=new n.default(l,this._renderScene.getRenderQueueManager(),!1,{shadowCaster:!0,mask:!0});let d=["VISIBILITY","ONLY_DEPTH"];o.clipping.isEnabled()&&d.push("CLIPPING"),o.compressed&&d.push("COMPRESSION");const u=l.getShader("normaldepth",d);if(!u.ready){const e=a.default.normaldepth;u.createFromShaderSource(e,d)}this._opaques.setOverridedShader(u),d.push("ALPHATEST");const c=l.getShader("normaldepth",d);if(!c.ready){const e=a.default.normaldepth;c.createFromShaderSource(e,d)}this._maskeds.setOverridedShader(c),this._opaques.setOverridedMaterial(o.materialManager.createMaterialAdhoc("shadow")),this._maskeds.setOverridedMaterial(o.materialManager.createMaterialAdhoc("shadow")),this._lightCamera=new i.default(this._renderScene.getScene(),[0,0,this.smSize,this.smSize]),this._lightCamera.setCullingEnabled(!0),this._renderTargets=[],this.shadowMaps=[],this.shadowMatrices=[],this.shadowSplit=1e4,this._ready=!0}destroy(){this._opaques.destroy(),this._opaques=null,delete this._opaques,this._maskeds.destroy(),this._maskeds=null,delete this._maskeds,this._lightCamera.destroy(),this._lightCamera=null,delete this._lightCamera,this._renderScene=null,delete this._renderScene;for(let e=0;e<this._renderTargets.length;e++)this._renderTargets[e].destroy();this._renderTargets=null,delete this._renderTargets,this.shadowMatrices=null,delete this.shadowMatrices,this.shadowMaps=null,delete this.shadowMaps}recompileShader(e,t){this._opaques.recompileOverridedShader(e,t),this._maskeds.recompileOverridedShader(e,t)}doesSupportMobile(e){return!0}draw(e=-1){this._ready}onSceneChanged(e){if(!this._ready)return;const t=this._renderScene.getOpaques(),r=this._renderScene.getMaskeds();this._opaques.queue.copy(t.queue,e),this._maskeds.queue.copy(r.queue,e),this._opaques.setCullFace(t.getCullFace()),this._maskeds.setCullFace(r.getCullFace())}addDrawable(e){this._opaques.queue.addDrawable(e)||this._maskeds.queue.addDrawable(e)}removeDrawable(e){this._opaques.queue.removeDrawable(e)||this._maskeds.queue.removeDrawable(e)}}},"./04renderer/shadow/ShadowCSM.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./03scene/camera/m3d_shadow_camera.js"),n=r("./03scene/camera/m3d_base_camera.js"),a=r("./04renderer/pipeline/RenderTarget.ts"),s=r("./04renderer/shadow/Shadow.ts"),o=r("./04renderer/m3d_samples.js"),l=r("./04renderer/shadow/ShadowHelper.ts"),d=r("./glMatrix.js");class u extends s.default{constructor(e){if(super(e),!this._ready)return;this._partitions=2,this.smSize=this.smSize/this._partitions;const t=this._renderScene.getResourceManager();this.shadowMaps=new Array(this._partitions),this.shadowMatrices=new Array(this._partitions),this._renderTargets=new Array(this._partitions),this._lightCameras=new Array(this._partitions),this._sceneCameras=new Array(this._partitions);const r=t.gl,s=[0,0,this.smSize,this.smSize];for(let o=0;o<this._partitions;o++)this._renderTargets[o]=new a.default("shadowcsm-depth"+o,t,this.smSize,this.smSize,{colorMask:[0,0,0,0],colorFormat:r.R8,colorBuffer:0,depthFilter:r.NEAREST,depthFormat:r.DEPTH_COMPONENT24,depthBuffer:o}),this.shadowMaps[o]=this._renderTargets[o].getDepthBuffer(),this.shadowMatrices[o]=d.mat4.create(),this._ready=this._ready&&this._renderTargets[o].ready,this._lightCameras[o]=new i.default(e.getScene(),s),this._sceneCameras[o]=new n.default(s)}destroy(){this._lightCameras=null,delete this._lightCameras,this._sceneCameras=null,delete this._sceneCameras,super.destroy()}draw(e=-1){if(!this._ready)return;if(1===e){const e=this._renderScene.getCamera(),r=this._renderScene.getScene(),i=e.split(this._partitions,this._sceneCameras);for(var t=0;t<this._partitions;t++)Object(l.ComputeShadowCameraTight)(r,this._sceneCameras[t],this._lightCameras[t]),this._lightCameras[t].setViewport([0,0,this.smSize,this.smSize]);this.shadowSplit=.5*(-e.projectMatrix[10]+e.projectMatrix[14]/i[0]+1),this._renderScene.getRenderer().renderState.invalidateClip()}e-=1;let r=o.default._4x4_2D[2*e]-.5,i=o.default._4x4_2D[2*e+1]-.5;const n=this._renderScene.getRenderer(),a=this._renderScene.getScene().getMainLight(),s=this._renderScene.getScene().clipping,u=this._renderScene.getResourceManager().gl;for(t=0;t<this._partitions;t++)this._lightCameras[t].jitter(r/this.smSize,i/this.smSize),n.renderState.invalidateOther(),n.clear(this._renderTargets[t],u.DEPTH_BUFFER_BIT),this._opaques.render(this._renderTargets[t],n,this._lightCameras[t],null,s,a),this._maskeds.render(this._renderTargets[t],n,this._lightCameras[t],null,s,a),d.mat4.copy(this.shadowMatrices[t],this._lightCameras[t].vpMatrix),this._lightCameras[t].jitter(-r/this.smSize,-i/this.smSize)}}},"./04renderer/shadow/ShadowController.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./04renderer/shadow/ShadowESM.ts"),n=r("./04renderer/shadow/ShadowCSM.ts"),a=r("./00utility/Environment.ts");class s{constructor(e){this.fine=!1,this._enabled=!1,this._coarseShadow=new i.default(e),a.Environment.isMobile||(this._fineShadow=new n.default(e)),this.size=this._coarseShadow.smSize,this.shadowSplit=this._coarseShadow.shadowSplit}destroy(){this.shadowMaps=null,delete this.shadowMaps,this.shadowMatrices=null,delete this.shadowMatrices,a.Environment.isMobile||(this._fineShadow.destroy(),this._fineShadow=null,delete this._fineShadow),this._coarseShadow.destroy(),this._coarseShadow=null,delete this._coarseShadow}recompileShader(e,t){a.Environment.isMobile||this._fineShadow.recompileShader(e,t),this._coarseShadow.recompileShader(e,t)}onSceneChanged(e){a.Environment.isMobile||this._fineShadow.onSceneChanged(e),this._coarseShadow.onSceneChanged(e)}draw(e=-1){this._enabled&&(this.fine=e>0&&!a.Environment.isMobile,this.fine?(this._fineShadow.draw(e),this.shadowMaps=this._fineShadow.shadowMaps,this.shadowMatrices=this._fineShadow.shadowMatrices,this.size=this._fineShadow.smSize,this.shadowSplit=this._fineShadow.shadowSplit):(this._coarseShadow.draw(e),this.shadowMaps=this._coarseShadow.shadowMaps,this.shadowMatrices=this._coarseShadow.shadowMatrices,this.size=this._coarseShadow.smSize,this.shadowSplit=this._coarseShadow.shadowSplit))}setEnabled(e){this._enabled=e}addDrawalbe(e){this._fineShadow&&this._fineShadow.addDrawable(e),this._coarseShadow.addDrawable(e)}removeDrawable(e){this._fineShadow&&this._fineShadow.removeDrawable(e),this._coarseShadow.removeDrawable(e)}}},"./04renderer/shadow/ShadowESM.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./00utility/Environment.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./04renderer/pipeline/RenderTarget.ts"),s=r("./04renderer/pipeline/Blit.ts"),o=r("./04renderer/shadow/Shadow.ts"),l=r("./04renderer/shadow/ShadowHelper.ts"),d=r("./glMatrix.js");class u extends o.default{constructor(e){if(super(e),!this._ready)return;this.shadowMatrices.push(d.mat4.create());const t=this._renderScene.getResourceManager(),r=t.gl;this._renderTargets.push(new a.default("shadowesm-depth",t,this.smSize,this.smSize,{colorMask:[0,0,0,0],colorFormat:r.isWebGL2?r.R8:r.RGB,colorBuffer:0,depthFilter:r.NEAREST,depthFormat:r.DEPTH_COMPONENT24,depthBuffer:0})),i.Environment.isMobile?(this.shadowMaps.push(this._renderTargets[0].getDepthBuffer()),this._ready=this._renderTargets[0].ready):(this._renderTargets.push(new a.default("shadowesm-smooth",t,this.smSize,this.smSize,{colorFormat:r.isWebGL2?r.R32F:"firefox"===i.Environment.browserName?r.RGBA32F:r.RGB32F,colorFilter:r.NEAREST,depthTest:!1,depthBufer:0})),this._blit=new s.default(t,n.default.shadowsmooth),this._blit.setTexture(this._renderTargets[0].getDepthBuffer()),this.shadowMaps.push(this._renderTargets[1].getColorBuffer()),this._ready=this._blit.ready&&this._renderTargets[0].ready&&this._renderTargets[1].ready)}destroy(){this._blit.destroy(),this._blit=null,delete this._blit,super.destroy()}draw(e=-1){if(!this._ready)return;const t=this._renderScene.getScene();Object(l.ComputeShadowCamera)(t,this._lightCamera),d.mat4.copy(this.shadowMatrices[0],this._lightCamera.vpMatrix),this._lightCamera.setBimCullingEnabled(this._renderScene.getCamera().isBimCullingEnabled());const r=this._renderScene.getRenderer(),n=this._renderScene.getScene().getMainLight(),a=this._renderScene.getScene().clipping,s=this._renderScene.getResourceManager().gl;r.renderState.invalidateClip(),r.clear(this._renderTargets[0],s.DEPTH_BUFFER_BIT),this._opaques.render(this._renderTargets[0],r,this._lightCamera,null,a,n),this._maskeds.render(this._renderTargets[0],r,this._lightCamera,null,a,n),i.Environment.isMobile||this._blit.render(r,this._renderTargets[1])}}},"./04renderer/shadow/ShadowHelper.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"ComputeShadowCameraTight",function(){return a}),r.d(t,"ComputeShadowCamera",function(){return s});var i=r("./00utility/m3d_math.js"),n=r("./glMatrix.js");function a(e,t,r){let a=i.default.frustum.createFromMatrix(t.vpMatrix),s=i.default.intersect.aabb_frustum(e.clipping.get(),a),o=n.vec3.create();n.vec3.copy(o,e.getMainLight().direction);Math.min(.005+e.radius/t._distance*.01,.01);let l=n.vec3.create();Math.abs(o[0])>Math.abs(o[2])?n.vec3.set(l,-o[1],o[0],0):n.vec3.set(l,0,-o[2],o[1]),n.vec3.normalize(l,l);let d=n.vec3.create();n.vec3.cross(d,o,l),n.vec3.normalize(d,d),n.vec3.normalize(o,o),r.createFromLightTight(o,e.clipping.get(),s),r._cull.update()}function s(e,t){t.createFromLight(e.getMainLight().direction,e.clipping.get()),t._cull.update()}},"./04renderer/visualize/AnimatingRibbon.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"Ribbon",function(){return d}),r.d(t,"default",function(){return u});var i=r("./02resource/Texture.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/drawables/Drawable.ts"),s=r("./04renderer/visualize/Visualize.ts"),o=r("./03scene/materials/MaterialAnimatingRibbon.ts"),l=r("./glMatrix.js");class d{constructor(e,t,r,i,n,a){this._mesh=e.getMesh("ribbon-"+t),this._mesh.createQuad(!0,!0,!1,!0),this._resourceManager=e,this._points=r,this._width=i,this._unitLength=n,this._speed=a,this.update()}setWidth(e){this._width=e}setPoints(e){this._points=e}setUnitLength(e){this._unitLength=e}setSpeed(e){this._speed=e}update(){let e=2*this._points.length*12,t=new Float32Array(e),r=null;r=e/3>65536?new Uint32Array(6*(this._points.length-1)):new Uint16Array(6*(this._points.length-1));let i=0,s=0;for(var d=0;d<this._points.length;d++){let e=this._points[d],r=this._points[Math.max(0,d-1)],n=this._points[Math.min(this._points.length-1,d+1)],a=[(i+=l.vec3.distance(e,r))/this._unitLength,0];t[s+0]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=r[0],t[s+4]=r[1],t[s+5]=r[2],t[s+6]=a[0],t[s+7]=a[1],t[s+8]=n[0],t[s+9]=n[1],t[s+10]=n[2],t[s+11]=1,t[(s+=12)+0]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=r[0],t[s+4]=r[1],t[s+5]=r[2],t[s+6]=a[0],t[s+7]=a[1],t[s+8]=n[0],t[s+9]=n[1],t[s+10]=n[2],t[s+11]=-1,s+=12}let u=0;for(d=1;d<this._points.length;d++)r[u+0]=2*(d-1),r[u+1]=2*(d-1)+1,r[u+2]=2*(d-1)+2,r[u+3]=2*(d-1)+2,r[u+4]=2*(d-1)+1,r[u+5]=2*(d-1)+3,u+=6;let c=this._resourceManager.gl;this._mesh.update(t,r,r instanceof Uint32Array?c.UNSIGNED_INT:c.UNSIGNED_SHORT);let h=this._resourceManager.getShader("animating-ribbon",["MODEL_TRANSFORM"]);if(!h.ready){var m=n.default["animating-ribbon"];if(h.createFromShaderSource(m,["MODEL_TRANSFORM"]),!h.ready)throw new Error("Error at creating shader 'animating-ribbon'!")}this.material=new o.default("ribbon-"+this.id,this._resourceManager),this.material.attachShader(h,this._resourceManager),this.material.setSpeed(this._speed),this.material.setWidth(this._width),this.drawable=new a.default(this._mesh,h,this.material,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]))}}class u extends s.default{constructor(e){super("AnimatingRibbon",e),this._milliSeconds=0,this._width=4,this._unitLength=10,this._speed=1,this._ribbons=[],this._platteTexture=null,this._resourceManager=e.getResourceManager(),this._lastDate=new Date}destroy(){this._resourceManager=null,delete this._resourceManager,super.destroy()}doesSupportMobile(e){return!0}_initialize(){return!0}setParameter(e,t){let r=!1;switch(e){case"width":this._width=t/2,this._ribbons.forEach(e=>{e.material.setWidth(this._width)});break;case"paletteTexture":case"platteTexture":if(t instanceof i.default)this._platteTexture=t;else{this._platteTexture=this._resourceManager.getTexture(this.name+"-animatingRibbon-platte");let e=this._resourceManager.gl,r=e.RGB,i=t.split(".");"png"===i[i.length-1]&&(r=e.RGBA),this._platteTexture.createFromFile(t,r,e.LINEAR,e.REPEAT,()=>{})}this._ribbons.forEach(e=>{e.material.setPlatteTexture(this._platteTexture)});break;case"speed":this._speed=t,this._ribbons.forEach(e=>{e.material.setSpeed(this._speed)});break;case"unitLength":case"unitLenght":this._unitLength=t,r=!0}r&&this._updateGeometry()}resize(e,t){this._ribbons.forEach(r=>{r.material.parameters.uTexSizeAndInv.value=[e,t,1/e,1/t]})}addRibbon(e){if(e.length<2)return void console.warn("points length must be greater than 1!");let t=new d(this._resourceManager,this.name+this._ribbons.length,e,this._width,this._unitLength,this._speed),r=this._renderScene.getRenderTarget();t.material.parameters.uTexSizeAndInv.value=[r.getWidth(),r.getHeight(),1/r.getWidth(),1/r.getHeight()],this._platteTexture&&t.material.setPlatteTexture(this._platteTexture),this._ribbons.push(t),this._drawables.push(t.drawable),this._renderScene.addEffect("Glow");let i=this._renderScene.getEffect("Glow");return i.addCustomDrawable(t.drawable),i.setEnabled(!0),t}removeRibbon(e){var t=this._ribbons.findIndex(t=>t===e);if(-1===t)return console.warn("can not find ribbon."),void console.warn(e);if(this._ribbons.splice(t,1),-1===(t=this._drawables.findIndex(t=>e.drawable===t)))return void console.warn("no drawable attached to this ribbon found.");let r=this._renderScene.getEffect("Glow");r&&r.removeCustomDrawable(e.drawable),e.drawable.destroy(),this._drawables.splice(t,1)}_updateGeometry(){this._ribbons.forEach(e=>{e.setWidth(this._width),e.setUnitLength(this._unitLength),e.update()})}draw(e,t,r,i,n,a,s=-1){if(!this._enabled)return;if(!this._platteTexture.ready)return void console.warn("cannot visualize animation ribbon without a platte texture!");let o=new Date;this._milliSeconds+=o.getTime()-this._lastDate.getTime(),this._milliSeconds>36e5&&(this._milliSeconds=0),this._lastDate=o,this._ribbons.forEach(e=>{e.material.setTime(this._milliSeconds)}),e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,null)}}},"./04renderer/visualize/AnimatingStripe.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"Stripe",function(){return d}),r.d(t,"default",function(){return u});var i=r("./02resource/Texture.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/drawables/Drawable.ts"),s=r("./04renderer/visualize/Visualize.ts"),o=r("./03scene/materials/MaterialAnimatingRibbon.ts"),l=r("./glMatrix.js");class d{constructor(e,t,r,i,n,a,s=[0,0,1]){this._mesh=e.getMesh("stripe-"+t),this._mesh.createQuad(!0),this._resourceManager=e,this._points=r,this._width=i,this._unitLength=n,this._speed=a,this._normal=s,this.update()}setWidth(e){this._width=e}setPoints(e){this._points=e}setUnitLength(e){this._unitLength=e}setSpeed(e){this._speed=e}update(){let e=2*this._points.length*5,t=new Float32Array(e),r=null;r=e/3>65536?new Uint32Array(6*(this._points.length-1)):new Uint16Array(6*(this._points.length-1));let i=0,s=0,d=l.vec3.create();l.vec3.sub(d,this._points[1],this._points[0]);let u=l.vec3.create(),c=l.vec3.create();for(var h=0;h<this._points.length;h++){let e=this._points[h],r=this._points[Math.max(0,h-1)],n=(i+=l.vec3.distance(e,r))/this._unitLength;l.vec3.cross(u,d,this._normal),l.vec3.normalize(u,u),l.vec3.scaleAndAdd(c,this._points[h],u,.5*this._width),t[s+0]=c[0],t[s+1]=c[1],t[s+2]=c[2],t[s+3]=n,t[s+4]=0,l.vec3.scaleAndAdd(c,this._points[h],u,.5*-this._width),t[s+5]=c[0],t[s+6]=c[1],t[s+7]=c[2],t[s+8]=n,t[s+9]=1,h<this._points.length-2?(l.vec3.sub(c,this._points[h+1],this._points[h]),l.vec3.normalize(c,c),l.vec3.sub(d,this._points[h+2],this._points[h+1]),l.vec3.normalize(d,d),l.vec3.add(d,d,c)):this._points[h+1]&&l.vec3.sub(d,this._points[h+1],this._points[h]),s+=10}let m=0;for(h=0;h<this._points.length-1;h++)r[m+0]=2*h,r[m+1]=2*h+2,r[m+2]=2*h+1,r[m+3]=2*h+1,r[m+4]=2*h+2,r[m+5]=2*h+3,m+=6;let f=this._resourceManager.gl;this._mesh.update(t,r,r instanceof Uint16Array?f.UNSIGNED_SHORT:f.UNSIGNED_INT);let p=this._resourceManager.getShader("animating-stripe",["MODEL_TRANSFORM"]);if(!p.ready){var v=n.default["animating-stripe"];if(p.createFromShaderSource(v,["MODEL_TRANSFORM"]),!p.ready)throw new Error("Error at creating shader 'animating-stripe'!")}this.material=new o.default("stripe-"+this.id,this._resourceManager),this.material.attachShader(p,this._resourceManager),this.material.setSpeed(this._speed),this.drawable=new a.default(this._mesh,p,this.material,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]))}}class u extends s.default{constructor(e){super("AnimatingStripe",e),this._milliSeconds=0,this._width=4,this._unitLength=10,this._speed=1,this._stripes=[],this._platteTexture=null,this._resourceManager=e.getResourceManager(),this._lastDate=new Date}destroy(){this._resourceManager=null,delete this._resourceManager,super.destroy()}doesSupportMobile(e){return!0}_initialize(){return!0}setParameter(e,t){let r=!1;switch(e){case"width":this._width=t;break;case"paletteTexture":case"platteTexture":if(t instanceof i.default)this._platteTexture=t;else{this._platteTexture=this._resourceManager.getTexture(this.name+"-animatingStripe-platte");let e=this._resourceManager.gl,r=e.RGB,i=t.split(".");"png"===i[i.length-1]&&(r=e.RGBA),this._platteTexture.createFromFile(t,r,e.LINEAR,e.REPEAT,()=>{})}this._stripes.forEach(e=>{e.material.setPlatteTexture(this._platteTexture)});break;case"speed":this._speed=t,this._stripes.forEach(e=>{e.material.setSpeed(this._speed)});break;case"unitLength":case"unitLenght":this._unitLength=t,r=!0}r&&this._updateGeometry()}resize(e,t){}addStripe(e){if(e.length<2)return void console.warn("points length must be greater than 1!");let t=new d(this._resourceManager,this.name+this._stripes.length,e,this._width,this._unitLength,this._speed);this._platteTexture&&t.material.setPlatteTexture(this._platteTexture),this._stripes.push(t),this._drawables.push(t.drawable),this._renderScene.addEffect("Glow");let r=this._renderScene.getEffect("Glow");return r.addCustomDrawable(t.drawable),r.setEnabled(!0),t}removeStripe(e){var t=this._stripes.findIndex(t=>t===e);if(-1===t)return console.warn("can not find stripe."),void console.warn(e);if(this._stripes.splice(t,1),-1===(t=this._drawables.findIndex(t=>e.drawable===t)))return void console.warn("no drawable attached to this stripe found.");let r=this._renderScene.getEffect("Glow");r&&r.removeCustomDrawable(e.drawable),e.drawable.destroy(),this._drawables.splice(t,1)}_updateGeometry(){this._stripes.forEach(e=>{e.setWidth(this._width),e.setUnitLength(this._unitLength),e.update()})}draw(e,t,r,i,n,a,s=-1){if(!this._enabled)return;if(!this._platteTexture.ready)return void console.warn("cannot visualize animation stripe without a platte texture!");let o=new Date;this._milliSeconds+=o.getTime()-this._lastDate.getTime(),this._milliSeconds>36e5&&(this._milliSeconds=0),this._lastDate=o,this._stripes.forEach(e=>{e.material.setTime(this._milliSeconds)}),e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,null)}}},"./04renderer/visualize/BarChart.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/drawables/Drawable.ts"),a=r("./03scene/materials/MaterialBarChart.ts"),s=r("./04renderer/visualize/Visualize.ts");class o extends s.default{constructor(e){super("BarChart",e),this._resourceManager=e.getResourceManager(),this._xres=32,this._yres=32,this._thickness=1,this._showLines=!0,this._lineColor=[.2,.2,.2],this._dataTexture=null,this._platteTexture=this._resourceManager.getTexture(this.name+"-barchart-platte")}destroy(){this._resourceManager=null,delete this._resourceManager,this._xres=null,delete this._xres,this._yres=null,delete this._yres,this._thickness=null,delete this._thickness,this._showLines=null,delete this._showLines,this._lineColor=null,delete this._lineColor,this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,super.destroy()}_initialize(){return!!this._resourceManager.gl.isWebGL2||(console.warn("BarChart is not supported in webgl1.0 context!"),!1)}setParameter(e,t){let r=!1,i=this._resourceManager.gl;switch(e){case"xres":this._xres=t,r=!0;break;case"yres":this._yres=t,r=!0;break;case"thickness":this._thickness=2*t;break;case"showLines":this._showLines=t;break;case"lineColor":this._lineColor=t;break;case"dataTexture":this._dataTexture=t;break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,null)}r&&this._updateGeometry()}_updateGeometry(){if(this._resourceManager.hasMesh(this.name+"-barchart")){this._resourceManager.getMesh(this.name+"-barchart").destroy(!0)}let e=this._resourceManager.getMesh(this.name+"-barchart");if(e.createSolidCubeField(this._xres,this._yres),this._resourceManager.hasMesh(this.name+"-barchart-wireframe")){this._resourceManager.getMesh(this.name+"-barchart-wireframe").destroy(!0)}let t=this._resourceManager.getMesh(this.name+"-barchart-wireframe");if(t.createWiredCubeField(this._xres,this._yres),this._drawables.length<1){let s="barchart",o=this._resourceManager.getShader(s,["MODEL_TRANSFORM"]);if(!o.ready){var r=i.default[s];if(o.createFromShaderSource(r,["MODEL_TRANSFORM"]),!o.ready)throw new Error("Error at creating shader '"+s+"'!")}s="barchart_wireframe";let l=this._resourceManager.getShader(s,["MODEL_TRANSFORM"]);if(!l.ready){r=i.default[s];if(l.createFromShaderSource(r,["MODEL_TRANSFORM"]),!l.ready)throw new Error("Error at create shader '"+s+"'!")}let d=new a.default("barchart",this._resourceManager);d.attachShader(o,this._resourceManager);let u=new n.default(e,o,d,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(u);let c=new a.default("barchart-wireframe",this._resourceManager);c.attachShader(l,this._resourceManager),u=new n.default(t,l,c,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),this._drawables.push(u),this.setPosition(this._position),this.setScaling(this._scale)}else this._drawables[0].mesh=e,this._drawables[1].mesh=t}draw(e,t,r,i,n,a,s=-1){if(!this._enabled)return;if(!this._platteTexture.ready||!this._dataTexture.ready)return void console.warn("cannot visualize 3D bar field without field data!");let o=this._drawables[0].material;o.setPlatteTexture(this._platteTexture),o.setDataTexture(this._dataTexture),o.setThickness(this._thickness),o.setResolution([this._xres,this._yres]),this._showLines?(this._drawables[1].visible=!0,(o=this._drawables[1].material).setDiffuse(this._lineColor),o.setTransparent(1),o.setDataTexture(this._dataTexture),o.setThickness(this._thickness),o.setResolution([this._xres,this._yres])):this._drawables[1].visible=!1;let l=this._resourceManager.gl;e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,l.CCW)}doesSupportWebGL1(){return!1}}},"./04renderer/visualize/HeatMap.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/drawables/Drawable.ts"),a=r("./03scene/materials/MaterialHeatMap.ts"),s=r("./04renderer/visualize/Visualize.ts");class o extends s.default{constructor(e){super("heatmap",e),this._resourceManager=e.getResourceManager(),this._dataTexture=this._resourceManager.getTexture(this.name+"-heatmap-density"),this._platteTexture=this._resourceManager.getTexture(this.name+"-heatmap-platte"),this._foregroundTexture=this._resourceManager.getTexture(this.name+"-heatmap-foreground"),this._width=1024,this._height=1024,this._gridSize=32,this._needUpdate=!0,this._showGridLine=!1,this._showPoints=!1,this._enableBlend=!0,this._enableForeground=!1,this._resourceManager.gl.isWebGL2?this._imageData=new Float32Array(this._width*this._height):this._imageData=new Uint8Array(this._width*this._height)}destroy(){this._dataTexture.destroy(),this._dataTexture=null,delete this._dataTexture,this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,this._foregroundTexture.destroy(),this._foregroundTexture=null,delete this._foregroundTexture,this._points=null,delete this._points,this._resourceManager=null,delete this._resourceManager,super.destroy()}setParameter(e,t){let r=this._resourceManager.gl;switch(e){case"points":this._points=t;break;case"width":this._width=t;break;case"height":this._height=t;break;case"gridSize":this._gridSize=t;break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,null);break;case"blend":this._enableBlend=t;break;case"foregroundImage":this._enableForeground=!0,this._foregroundTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,null)}this._needUpdate=!0}_cubic(e,t,r,i,n){const a=.5;return(-a*e+1.5*t+(a-2)*r+a*i)*n*n*n+(1*e+(a-3)*t+2*r-a*i)*n*n+(-a*e+a*r)*n+t}_sampleImage(e,t,r,i,n){return i<0&&(i=0),n<0&&(n=0),i>=t&&(i=t-1),n>=r&&(n=r-1),e[i+t*n]}_linear(e,t,r){return e*(1-r)+t*r}_bilinear(e,t,r,i,n){let a=Math.max(e*r-.5,0),s=Math.floor(a),o=a-s,l=Math.max(t*i-.5,0),d=Math.floor(l),u=l-d,c=this._sampleImage(n,r,i,s,d),h=this._sampleImage(n,r,i,s+1,d),m=this._sampleImage(n,r,i,s,d+1),f=this._sampleImage(n,r,i,s+1,d+1),p=this._linear(c,h,o),v=this._linear(m,f,o);return this._linear(p,v,u)}_bicubic(e,t,r,i,n){let a=Math.max(e*r-.5,0),s=Math.floor(a),o=a-s,l=Math.max(t*i-.5,0),d=Math.floor(l),u=l-d,c=this._sampleImage(n,r,i,s-1,d-1),h=this._sampleImage(n,r,i,s+0,d-1),m=this._sampleImage(n,r,i,s+1,d-1),f=this._sampleImage(n,r,i,s+2,d-1),p=this._sampleImage(n,r,i,s-1,d+0),v=this._sampleImage(n,r,i,s+0,d+0),_=this._sampleImage(n,r,i,s+1,d+0),g=this._sampleImage(n,r,i,s+2,d+0),b=this._sampleImage(n,r,i,s-1,d+1),y=this._sampleImage(n,r,i,s+0,d+1),x=this._sampleImage(n,r,i,s+1,d+1),w=this._sampleImage(n,r,i,s+2,d+1),E=this._sampleImage(n,r,i,s-1,d+2),M=this._sampleImage(n,r,i,s+0,d+2),A=this._sampleImage(n,r,i,s+1,d+2),T=this._sampleImage(n,r,i,s+2,d+2),S=this._cubic(c,h,m,f,o),k=this._cubic(p,v,_,g,o),D=this._cubic(b,y,x,w,o),I=this._cubic(E,M,A,T,o);return this._cubic(S,k,D,I,u)}_updateImage(){if(!this._points)return;const e=this._width/this._gridSize,t=this._height/this._gridSize;let r=new Float32Array(e*t),s=1e-6;for(let i=0;i<this._points.length;i++){const n=this._points[i],a=Math.floor(n.x*e),o=Math.floor(n.y*t);let l=r[o*e+a];l+=n.number,r[o*e+a]=l,s<l&&(s=l)}for(let i=0;i<this._height;i++)for(let n=0;n<this._width;n++){let a=this._bicubic((n+.5)/this._width,(i+.5)/this._height,e,t,r);a<0&&(a=0),this._resourceManager.gl.isWebGL2?this._imageData[i*this._width+n]=a/s:this._imageData[i*this._width+n]=255*a/s}if(this._showGridLine){for(let e=1;e<t;e++){const t=e*this._gridSize-1,r=e*this._gridSize+1;for(let e=t;e<=r;e++)for(let t=0;t<this._width;t++)this._imageData[e*this._width+t]=1,this._resourceManager.gl.isWebGL2||(this._imageData[e*this._width+t]*=255)}for(let t=1;t<e;t++){const e=t*this._gridSize-1,r=t*this._gridSize+1;for(let t=e;t<=r;t++)for(let e=0;e<this._height;e++)this._resourceManager.gl.isWebGL2?this._imageData[e*this._width+t]=1:this._imageData[e*this._width+t]=255}}if(this._showPoints)for(let e=0;e<this._points.length;e++){const t=this._points[e],r=Math.floor(t.x*this._width),i=Math.floor(t.y*this._height);for(let e=r-1;e<=r+1;e++)for(let t=i-1;t<=i+1;t++)this._resourceManager.gl.isWebGL2?this._imageData[t*this._width+e]=1:this._imageData[t*this._width+e]=255}const o=this._resourceManager.gl;this._dataTexture.ready||(o.isWebGL2?this._dataTexture.create(this._width,this._height,o.R32F,o.LINEAR,o.CLAMP_TO_EDGE):this._dataTexture.create(this._width,this._height,o.ALPHA,o.LINEAR,o.CLAMP_TO_EDGE)),this._dataTexture.resize(this._width,this._height),this._dataTexture.update(this._imageData);let l=["MODEL_TRANSFORM"];this._enableBlend||l.push("DISABLE_BLEND"),this._enableForeground&&l.push("ENABLE_FOREGROUND");let d=this._resourceManager.getShader("heatmap",l);if(!d.ready){var u=i.default.heatmap;if(d.createFromShaderSource(u,l),!d.ready)throw new Error("Error at creating shader 'heatmap'!")}if(this._drawables.length<1){let e=this._resourceManager.getMesh("heatmap");e.ready||e.createQuad(!0);let t=new a.default("HeatMap",this._resourceManager);t.attachShader(d,this._resourceManager);let r=new n.default(e,d,t,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(r),this.setPosition(this._position),this.setScaling(this._scale)}}getTexture(){return this._needUpdate&&(this._updateImage(),this._needUpdate=!1),this._dataTexture}getImageData(){if(this._needUpdate&&(this._updateImage(),this._needUpdate=!0),this._imageData instanceof Float32Array)return this._imageData;{let t=new Float32Array(this._imageData.length);for(var e=0;e<this._imageData.length;e++)t[e]=this._imageData[e]/255;return t}}draw(e,t,r,i,n,a,s=-1){if(!this._enabled)return;if(this.getTexture(),!this._platteTexture.ready||!this._dataTexture.ready)return void console.warn("cannot visualize heatmap without necessary data!");let o=this._drawables[0].material;o.setPlatteTexture(this._platteTexture),o.setDataTexture(this._dataTexture),this._enableForeground&&o.setForegroundImage(this._foregroundTexture),e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,!1)}}},"./04renderer/visualize/HeightMap.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/drawables/Drawable.ts"),a=r("./03scene/materials/MaterialHeightMap.ts"),s=r("./04renderer/visualize/Visualize.ts");class o extends s.default{constructor(e){super("HeightMap",e),this._xres=1024,this._yres=1024,this._resourceManager=e.getResourceManager(),this._dataTexture=null,this._platteTexture=this._resourceManager.getTexture(this.name+"-HeightMap-platte")}destroy(){this._resourceManager=null,delete this._resourceManager,delete this._xres,delete this._yres,this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,super.destroy()}_initialize(){return!0}setParameter(e,t){let r=!1,i=this._resourceManager.gl;switch(e){case"xres":this._xres=t,r=!0;break;case"yres":this._yres=t,r=!0;break;case"dataTexture":this._dataTexture=t;break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,null)}r&&this._updateGeometry()}_updateGeometry(){let e=this._resourceManager.getMesh("HeightMap");if(e.ready&&(e.destroy(),e=this._resourceManager.getMesh("HeightMap")),e.createGrid(this._xres,this._yres),this._drawables.length<1){let r="heightmap",s=this._resourceManager.getShader(r,["MODEL_TRANSFORM"]);if(!s.ready){var t=i.default[r];if(s.createFromShaderSource(t,["MODEL_TRANSFORM"]),!s.ready)throw new Error("Error at creating shader '"+r+"'!")}let o=new a.default("HeightMap",this._resourceManager);o.attachShader(s,this._resourceManager);let l=new n.default(e,s,o,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(l),this.setPosition(this._position),this.setScaling(this._scale)}else this._drawables[0].mesh=e}draw(e,t,r,i,n,a,s=-1){if(!this._enabled)return;if(!this._platteTexture.ready||!this._dataTexture.ready)return void console.warn("cannot visualize height map without necessary data!");let o=this._drawables[0].material;o.setPlatteTexture(this._platteTexture),o.setDataTexture(this._dataTexture);this._resourceManager.gl;e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,!1)}}},"./04renderer/visualize/MetaBall.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./00utility/Environment.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/drawables/Gizmo2D.ts"),s=r("./03scene/camera/m3d_base_camera.js"),o=r("./04renderer/pipeline/RenderTarget.ts"),l=r("./04renderer/visualize/Visualize.ts"),d=r("./04renderer/pipeline/Blit.ts");class u extends l.default{constructor(e){super("metaball",e),this._resourceManager=e.getResourceManager(),this._width=1024,this._height=1024,this._showPoints=!0,this._showContour=!1,this._color=[1,0,0,1],this._contourWidth=1.75,this._contourColor=[1,1,0,1],this._backgroundColor=[1,1,1,1],this._radius=64,this._ballTexture=this._resourceManager.getTexture(this.name+"-metaball-ball"),this._foregroundTexture=this._resourceManager.getTexture(this.name+"-metaball-foreground"),this._enableForeground=!1,this._updateBallImage(),this._point=null,this._ball=null,this._needUpdate=!0,this._blit=new d.default(this._resourceManager,n.default.metaball,i.Environment.isMobile),this._blitForeground=new d.default(this._resourceManager,n.default.overlay,i.Environment.isMobile),this._blitBackground=new d.default(this._resourceManager,n.default.background,i.Environment.isMobile);const t=this._resourceManager.gl;this._camera=new s.default([0,0,this._width,this._height]),this._renderTarget1=new o.default("metaball1",this._resourceManager,this._width,this._height,{depthTest:!1,blend:!0,depthFunc:t.LEQUAL,colorFormat:t.RGBA8,clearColor:[0,0,0,0],colorFilter:t.LINEAR,depthFormat:t.DEPTH_COMPONENT24,colorBuffer:0,depthBuffer:0}),this._renderTarget2=new o.default("metaball2"+Math.random(),this._resourceManager,this._width,this._height,{depthTest:!1,depthFunc:t.LEQUAL,colorFormat:t.RGBA8,clearColor:[0,0,0,0],colorFilter:t.LINEAR,depthFormat:t.DEPTH_COMPONENT24,depthBuffer:0}),this._dataTexture=this._renderTarget2.getColorBuffer(),this._enableForeground=!1,this._needUpdate=!0}destroy(){this._dataTexture.destroy(),this._dataTexture=null,delete this._dataTexture,this._ballTexture.destroy(),this._ballTexture=null,delete this._ballTexture,this._foregroundTexture.destroy(),this._foregroundTexture=null,delete this._foregroundTexture,this._renderTarget1.destroy(),this._renderTarget1=null,delete this._renderTarget1,this._renderTarget2.destroy(),this._renderTarget2=null,delete this._renderTarget2,this._points=null,delete this._points,this._color=null,delete this._color,this._contourColor=null,delete this._contourColor,this._backgroundColor=null,delete this._backgroundColor,this._resourceManager=null,delete this._resourceManager,this._point.destroy(),this._point=null,delete this._point,this._ball.destroy(),this._ball=null,delete this._ball,this._blit.destroy(),this._blit=null,delete this._blit,super.destroy()}setParameter(e,t){switch(e){case"points":this._points=t;break;case"colors":this._colors=t;break;case"width":this._width=t;break;case"height":this._height=t;break;case"contourColor":this._contourColor=t;break;case"contourWidth":this._contourWidth=1+t;break;case"backgroundColor":this._backgroundColor=t;break;case"color":this._color=t;break;case"radius":this._radius=t;break;case"contour":this._showContour!==t&&(this._showContour=t,this._blit.recompile("CONTOUR",this._showContour));break;case"foregroundImage":var r=this._resourceManager.gl;this._enableForeground=!0,this._foregroundTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,()=>{this._updateImage()})}this._needUpdate=!0}_updateBallImage(){const e=2*this._radius+1,t=1/this._radius,r=this._resourceManager.gl;let i=null;r.isWebGL2?(i=new Float32Array(e*e),this._ballTexture.create(e,e,r.R32F,r.LINEAR,r.CLAMP_TO_EDGE)):(i=new Uint8Array(e*e),this._ballTexture.create(e,e,r.LUMINANCE,r.LINEAR,r.CLAMP_TO_EDGE)),this._ballTexture.resize(e,e);for(let n=0;n<this._radius;n++)for(let a=0;a<this._radius;a++){let s,o,l=Math.sqrt(Math.max(1-Math.sqrt(n*n+a*a)*t,0));o=this._radius+a,i[(s=this._radius+n)*e+o]=l*(r.isWebGL2?1:255),o=this._radius-a,i[(s=this._radius+n)*e+o]=l*(r.isWebGL2?1:255),o=this._radius+a,i[(s=this._radius-n)*e+o]=l*(r.isWebGL2?1:255),o=this._radius-a,i[(s=this._radius-n)*e+o]=l*(r.isWebGL2?1:255)}this._ballTexture.update(i)}_updateImage(){if(!this._points)return;if(!this._ball||!this._point){let e=this._resourceManager.getMesh("metaball-quad");e.ready||e.createQuad(),this._ball=new a.default(e,this._resourceManager),this._ball.setTexture(this._ballTexture),this._ball.transform.setScaling(this._radius/this._width,this._radius/this._height,1),(e=this._resourceManager.getMesh("point")).ready||e.createPoint(),this._point=new a.default(e,this._resourceManager),this._point.setColor([1,1,1])}this._renderTarget1.resize(this._width,this._height),this._renderTarget2.resize(this._width,this._height),this._camera.setViewport([0,0,this._width,this._height]);const e=this._resourceManager.gl,t=this._renderScene.getRenderer();if(t.renderState.invalidateStates(),t.clear(this._renderTarget2,e.COLOR_BUFFER_BIT),t.renderState.viewport([0,0,this._width,this._height]),this._blitBackground.setParameter("uColor",this._backgroundColor),this._blitBackground.render(t,this._renderTarget2),this._colors)for(let r=0;r<this._colors.length;r++){t.clear(this._renderTarget1,e.COLOR_BUFFER_BIT),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE);for(let e=0;e<this._points.length;e++){if(this._points[e].colorIndex!==r)continue;let i=2*this._points[e].x-1,n=2*this._points[e].y-1;this._ball.transform.setTranslation(i,n,0),t.drawDrawable(this._renderTarget1,this._ball,this._camera,null,null,null,null,null)}e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),this._blit.setTexture(this._renderTarget1.getColorBuffer()),this._blit.setParameter("uColor",this._colors[r].color),this._showContour&&(this._blit.setParameter("uContourColor",this._colors[r].contourColor),this._blit.setParameter("uContourWidth",this._contourWidth)),this._blit.render(t,this._renderTarget2,!0)}else{t.clear(this._renderTarget1,e.COLOR_BUFFER_BIT),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE);for(let e=0;e<this._points.length;e++){let r=2*this._points[e].x-1,i=2*this._points[e].y-1;this._ball.transform.setTranslation(r,i,0),t.drawDrawable(this._renderTarget1,this._ball,this._camera,null,null,null,null,null)}e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),this._blit.setTexture(this._renderTarget1.getColorBuffer()),this._blit.setParameter("uColor",this._color),this._showContour&&(this._blit.setParameter("uContourColor",this._contourColor),this._blit.setParameter("uContourWidth",this._contourWidth)),this._blit.render(t,this._renderTarget2)}this._enableForeground&&(this._blitForeground.setForegroundTexture(this._foregroundTexture),this._renderTarget2.setOption("blendFunc",[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA]),this._blitForeground.render(t,this._renderTarget2,!0)),this._dataTexture=this._renderTarget2.getColorBuffer()}getTexture(){return this._needUpdate&&(this._updateImage(),this._needUpdate=!1),this._dataTexture}}},"./04renderer/visualize/MultiLayerColor.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return c});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/drawables/Drawable.ts"),a=r("./03scene/materials/MaterialColor.ts"),s=r("./04renderer/pipeline/RenderTarget.ts"),o=r("./04renderer/visualize/Visualize.ts"),l=r("./glMatrix.js"),d=r("./04renderer/pipeline/Blit.ts"),u=r("./00utility/Environment.ts");class c extends o.default{constructor(e){super("MultiLayerColor",e),this._resourceManager=e.getResourceManager(),this._dataTexture=null,this._platteTexture=this._resourceManager.getTexture(this.name+"-volume-platte"),this._maskTexture=null,this._layers=33,this._sampleNumber=1,this._gridSize=[8,8],this._blit=new d.default(this._resourceManager,i.default.blit_simple,u.Environment.isMobile),this._instanceFilter=0;let t=this._resourceManager.gl;this._renderTarget=new s.default(this.name+"-volume-data-texture",this._resourceManager,1024,1024,{clearColor:[0,0,0,0],colorFormat:t.RGBA8,colorFilter:t.LINEAR})}destroy(){this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,this._resourceManager=null,delete this._resourceManager,super.destroy()}_updateDataTexture(){if(this._dataTexture&&this._dataTexture.ready&&(this._blit.setTexture(this._dataTexture),this._renderScene.getRenderer().renderState.viewport([0,0,this._renderTarget.getWidth(),this._renderTarget.getHeight()]),this._blit.render(this._renderScene.getRenderer(),this._renderTarget,!1)),this._maskTexture&&this._maskTexture.ready){let e=this._resourceManager.gl;this._blit.setTexture(this._maskTexture);let t=this._renderTarget.getOption("blendFunc");this._renderTarget.setOption("blendFunc",[e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA]),this._renderScene.getRenderer().renderState.viewport([0,0,this._renderTarget.getWidth(),this._renderTarget.getHeight()]),this._blit.render(this._renderScene.getRenderer(),this._renderTarget,!0),this._renderTarget.setOption("blendFunc",t),this._renderTarget.always=!0}this._drawables.forEach(e=>{e.material.setDataTexture(this._renderTarget.getColorBuffer())})}setParameter(e,t){const r=this._resourceManager.gl;switch(e){case"sampleNumber":this._sampleNumber=t;break;case"gridSize":this._gridSize=t,this._renderTarget.resize(1024,1024/this._gridSize[0]*this._gridSize[1]);break;case"maskImage":if(this._maskTexture=this._resourceManager.getTexture(this.name+"-mask"),this._maskTexture.ready){console.warn("Can not set maskImage multiple times.");break}this._maskTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,()=>{this._updateDataTexture()});break;case"dataImage":this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-color"),this._dataTexture.ready&&(this._dataTexture.destroy(!0),this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-color")),this._dataTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,()=>{this._updateDataTexture()});break;case"data":let n=t.data;if(this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-color"),!this._dataTexture.ready)if(r.isWebGL2)this._dataTexture.create(t.width,t.height,r.R32F,r.LINEAR,r.CLAMP_TO_EDGE,null,t.depth);else if(this._dataTexture.create(t.width,t.height,r.LUMINANCE,r.LINEAR,r.CLAMP_TO_EDGE,null,t.depth),!(n instanceof Uint8Array)){n=new Uint8Array(t.data.length);for(var i=0;i<t.data.length;i++)n[i]=255*t.data[i]}this._dataTexture.update(n),this._updateDataTexture();break;case"dataTexture":this._dataTexture=t,this._updateDataTexture();break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,null),this._drawables.forEach(e=>{e.material.setPlatteTexture(this._platteTexture)});break;case"layers":this._layers=t,this._drawables.forEach(e=>{e.material.setLayers(this._layers)});case"instanceFilter":this._instanceFilter=t,this._drawables.forEach(e=>{e.material.setinstanceFilter(this._instanceFilter)})}}getVolumeTexture(){return this._renderTarget.getColorBuffer()}_updateInvTransform(e){var t=l.mat4.create();l.mat4.invert(t,e.transform.matrix),e.material.setInvTransform(t)}setPosition(e){super.setPosition(e),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}setScaling(e){super.setScaling(e),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}setRotation(e,t){super.setRotation(e,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}setRotationByQuat(e){super.setRotationByQuat(e),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}draw(e,t,r,s,o,l,d=-1){if(this._enabled)if(this._platteTexture.ready&&this._renderTarget.getColorBuffer().ready){if(0===this._drawables.length){let e=this._resourceManager.getMesh("volume-multi-layer");e.createSolidCube(.5);let t="color_multi_layer",r=["MODEL_TRANSFORM"];this._maskTexture&&r.push("HAS_MASK");let s=this._resourceManager.getShader(t,r);if(!s.ready){var u=i.default[t];if(s.createFromShaderSource(u,r),!s.ready)throw new Error("Error at creating shader '"+t+"'!")}let o=new a.default("volume-multi-layer",this._resourceManager);o.attachShader(s,this._resourceManager),o.setPlatteTexture(this._platteTexture),o.setAlphaCorrection(.09),o.setLayers(this._layers),o.setinstanceFilter(this._instanceFilter),o.setSampleNumber(this._sampleNumber);let l=new n.default(e,s,o,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(l),this.setRotationByQuat(this._quaternion),this.setPosition(this._position),this.setScaling(this._scale),this._updateDataTexture()}this._drawables.forEach(e=>{e.material.setGridSize(this._gridSize)}),e.drawDrawables(l,this._drawables,t,null,null,r,s,o)}else console.warn(`The resources of ${this.name} are not ready!`)}}},"./04renderer/visualize/MultiLayerVolume.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return c});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/drawables/Drawable.ts"),a=r("./03scene/materials/MaterialVolume.ts"),s=r("./04renderer/pipeline/RenderTarget.ts"),o=r("./04renderer/visualize/Visualize.ts"),l=r("./glMatrix.js"),d=r("./04renderer/pipeline/Blit.ts"),u=r("./00utility/Environment.ts");class c extends o.default{constructor(e){super("MultiLayerVolume",e),this._resourceManager=e.getResourceManager(),this._dataTexture=null,this._platteTexture=this._resourceManager.getTexture(this.name+"-volume-platte"),this._maskTexture=null,this._layers=33,this._sampleNumber=1,this._gridSize=[8,8],this._blit=new d.default(this._resourceManager,i.default.blit_simple,u.Environment.isMobile);let t=this._resourceManager.gl;this._renderTarget=new s.default(this.name+"-volume-data-texture",this._resourceManager,1024,1024,{clearColor:[0,0,0,0],colorFormat:t.RGBA8,colorFilter:t.LINEAR})}destroy(){this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,this._resourceManager=null,delete this._resourceManager,super.destroy()}_updateDataTexture(){if(this._dataTexture&&this._dataTexture.ready&&(this._blit.setTexture(this._dataTexture),this._renderScene.getRenderer().renderState.viewport([0,0,this._renderTarget.getWidth(),this._renderTarget.getHeight()]),this._blit.render(this._renderScene.getRenderer(),this._renderTarget,!1)),this._maskTexture&&this._maskTexture.ready){let e=this._resourceManager.gl;this._blit.setTexture(this._maskTexture);let t=this._renderTarget.getOption("blendFunc");this._renderTarget.setOption("blendFunc",[e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA]),this._renderScene.getRenderer().renderState.viewport([0,0,this._renderTarget.getWidth(),this._renderTarget.getHeight()]),this._blit.render(this._renderScene.getRenderer(),this._renderTarget,!0),this._renderTarget.setOption("blendFunc",t),this._renderTarget.always=!0}this._drawables.forEach(e=>{e.material.setDataTexture(this._renderTarget.getColorBuffer())})}setParameter(e,t){const r=this._resourceManager.gl;switch(e){case"sampleNumber":this._sampleNumber=t;break;case"gridSize":this._gridSize=t,this._renderTarget.resize(1024,1024/this._gridSize[0]*this._gridSize[1]);break;case"maskImage":if(this._maskTexture=this._resourceManager.getTexture(this.name+"-mask"),this._maskTexture.ready){console.warn("Can not set maskImage multiple times.");break}this._maskTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,()=>{this._updateDataTexture()});break;case"dataImage":this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-volume"),this._dataTexture.ready&&(this._dataTexture.destroy(!0),this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-volume")),this._dataTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,()=>{this._updateDataTexture()});break;case"data":this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-volume");let n=t.data;if(!this._dataTexture.ready)if(r.isWebGL2)this._dataTexture.create(t.width,t.height,r.R32F,r.LINEAR,r.CLAMP_TO_EDGE);else if(this._dataTexture.create(t.width,t.height,r.LUMINANCE,r.LINEAR,r.CLAMP_TO_EDGE),!(n instanceof Uint8Array)){n=new Uint8Array(t.data.length);for(var i=0;i<t.data.length;i++)n[i]=255*t.data[i]}this._dataTexture.update(n),this._updateDataTexture();break;case"dataTexture":this._dataTexture=t,this._updateDataTexture();break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,null),this._drawables.forEach(e=>{e.material.setPlatteTexture(this._platteTexture)});break;case"layers":this._layers=t,this._drawables.forEach(e=>{e.material.setLayers(this._layers)})}}getVolumeTexture(){return this._renderTarget.getColorBuffer()}_updateInvTransform(e){var t=l.mat4.create();l.mat4.invert(t,e.transform.matrix),e.material.setInvTransform(t)}setPosition(e){super.setPosition(e),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}setScaling(e){super.setScaling(e),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}setRotation(e,t){super.setRotation(e,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}setRotationByQuat(e){super.setRotationByQuat(e),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}draw(e,t,r,s,o,l,d=-1){if(this._enabled)if(this._platteTexture.ready&&this._renderTarget.getColorBuffer().ready){if(0===this._drawables.length){let e=this._resourceManager.getMesh("volume-multi-layer");e.createSolidCube(.5);let t="volume_multi_layer",r=["MODEL_TRANSFORM"];this._maskTexture&&r.push("HAS_MASK");let s=this._resourceManager.getShader(t,r);if(!s.ready){var u=i.default[t];if(s.createFromShaderSource(u,r),!s.ready)throw new Error("Error at creating shader '"+t+"'!")}let o=new a.default("volume-multi-layer",this._resourceManager);o.attachShader(s,this._resourceManager),o.setPlatteTexture(this._platteTexture),o.setAlphaCorrection(.09),o.setLayers(this._layers),o.setSampleNumber(this._sampleNumber);let l=new n.default(e,s,o,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(l),this.setRotationByQuat(this._quaternion),this.setPosition(this._position),this.setScaling(this._scale),this._updateDataTexture()}this._drawables.forEach(e=>{e.material.setGridSize(this._gridSize)}),e.drawDrawables(l,this._drawables,t,null,null,r,s,o)}else console.warn(`The resources of ${this.name} are not ready!`)}}},"./04renderer/visualize/Trail.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/drawables/Drawable.ts"),a=r("./04renderer/visualize/Visualize.ts");class s{constructor(e,t,r){let a=t.getMesh("trail-path"+e);a.createLineStrip();let s=t.getShader("plain",["MODEL_TRANSFORM"]);if(!s.ready){var o=i.default.plain;if(s.createFromShaderSource(o,["MODEL_TRANSFORM"]),!s.ready)throw new Error("Error at creating shader 'plain'!")}let l=r.createMaterialAdhoc("trail");l.attachShader(s,t),l.setTransparent(.2),this.drawable=new n.default(a,s,l,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]))}destroy(){this.points=null,delete this.points,this.distances=null,delete this.distances,this.drawable.destroy(),this.drawable=null,delete this.drawable}update(e){this.points=e;let t=this.points.length/3,r=new Uint16Array(t);for(let e=0;e<t;e++)r[e]=e;this.drawable.mesh.update(new Float32Array(this.points),r);let i=0;this.distances=new Array(this.points.length/3);for(let e=0;e<this.points.length-3;e+=3){let t=this.points[e+3]-this.points[e],r=this.points[e+4]-this.points[e+1],n=this.points[e+5]-this.points[e+2],a=Math.sqrt(t*t+r*r+n*n);this.distances[e/3]=i,i+=a}this.distances[this.points.length/3-1]=i}draw(e,t){e%=this.distances[this.distances.length-1];let r=-1;for(let t=0;t<this.distances.length;t++)if(e<this.distances[t]){r=t;break}let i=r-1,n=(e-this.distances[i])/(this.distances[r]-this.distances[i]);return t[0]=this.points[3*i],t[1]=this.points[3*i+1],t[2]=this.points[3*i+2],t[3]=this.points[3*i]*(1-n)+this.points[3*r]*n,t[4]=this.points[3*i+1]*(1-n)+this.points[3*r+1]*n,t[5]=this.points[3*i+2]*(1-n)+this.points[3*r+2]*n,r}}class o extends a.default{constructor(e){super("trail",e),this._resourceManager=e.getResourceManager(),this._start=-1,this._speed=.01;Math.random();let t=this._resourceManager.getShader("plain",["MODEL_TRANSFORM"]);if(!t.ready){var r=i.default.plain;if(t.createFromShaderSource(r,["MODEL_TRANSFORM"]),!t.ready)throw new Error("Error at creating shader 'plain'!")}let a=e.getScene().materialManager.createMaterialAdhoc("trail");a.attachShader(t),a.setTransparent(.2);let s=this._resourceManager.getMesh("trail-growing");s.createLine(),this._current=new n.default(s,t,a,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),this._vertices=new Float32Array(6),this._indices=new Uint16Array(2),this._indices[0]=0,this._indices[1]=1,(s=this._resourceManager.getMesh("trail-tip")).createPoint(),this._tip=new n.default(s,t,a,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),this._paths=[]}destroy(){this._indices=null,delete this._indices,this._vertices=null,delete this._vertices;for(let e=0;e<this._paths.length;e++)this._paths[e].destroy();this._paths=null,delete this._paths,this._tip.destroy(),this._tip=null,delete this._tip,this._current.destroy(),this._current=null,delete this._current}setParameter(e,t){switch(e){case"color":for(let e=0;e<this._paths.length;e++)this._paths[e].drawable.material.setDiffuse(t);this._tip.material.setDiffuse(t),this._current.material.setDiffuse(t);break;case"transparent":for(let e=0;e<this._paths.length;e++)this._paths[e].drawable.material.setTransparent(t);this._tip.material.setTransparent(t),this._current.material.setTransparent(t);break;case"speed":this._speed=t}}addTrail(e){let t=new s(this._paths.length,this._resourceManager,this._renderScene.getScene().materialManager);t.update(e),this._paths.push(t)}draw(e,t,r,i,n,a,s=-1){if(!this._enabled)return;let o=(Date.now()-this._start)*this._speed;for(let s=0;s<this._paths.length;s++){var l=a.getOption("blend");if(a.setOption("blend",!0),a.always=!0,this._animate){let d=this._paths[s].draw(o,this._vertices);e.drawDrawable(a,this._paths[s].drawable,t,r,i,n,!1,[0,d]),this._current.mesh.update(this._vertices,this._indices),e.drawDrawable(a,this._current,t,r,i,n,!1),a.setOption("blend",l);const u=new Float32Array(this._vertices.buffer,12,3),c=new Uint16Array(this._indices.buffer,0,1);this._tip.mesh.update(u,c),e.drawDrawable(a,this._tip,t,r,i,n,!1)}else{e.drawDrawable(a,this._paths[s].drawable,t,r,i,n,!1),a.setOption("blend",l);const o=this._paths[s].points,d=new Float32Array([o[o.length-3],o[o.length-2],o[o.length-1]]),u=new Uint16Array(this._indices.buffer,0,1);this._tip.mesh.update(d,u),e.drawDrawable(a,this._tip,t,r,i,n,!1)}}}setEnabled(e){super.setEnabled(e),this._start=Date.now()}setAnimationEnabled(e){this._animate=e}}},"./04renderer/visualize/Visualize.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./glMatrix.js");class n{constructor(e,t){this.name=e+t.getVisualizes(e).length,this._renderScene=t,this._enabled=!1,this._position=[0,0,0],this._scale=[1,1,1],this._quaternion=i.quat.create(),this._drawables=[]}destroy(){this._renderScene=null,delete this._renderScene,this._position=null,delete this._position,this._scale=null,delete this._scale;for(let e=0;e<this._drawables.length;e++)this._drawables[e].destroy();this._drawables=null,delete this._drawables}setPosition(e){this._position=e;for(let t=0;t<this._drawables.length;t++)this._drawables[t].transform.setTranslation(e[0],e[1],e[2]),this._drawables[t].updateBBox()}setScaling(e){this._scale=e;for(var t=0;t<this._drawables.length;t++)this._drawables[t].transform.setScaling(e[0],e[1],e[2]),this._drawables[t].updateBBox()}setRotation(e,t){i.quat.setAxisAngle(this._quaternion,[e[0],e[1],e[2]],t);for(var r=0;r<this._drawables.length;r++)this._drawables[r].transform.setRotation(e,t),this._drawables[r].updateBBox()}setRotationByQuat(e){this._quaternion=e;for(var t=0;t<this._drawables.length;t++)this._drawables[t].transform.setRotationByQuat(e),this._drawables[t].updateBBox()}setEnabled(e){this._enabled=e}doesSupportMobile(e){return!0}doesSupportWebGL1(){return!0}isEnabled(){return this._enabled}resize(e,t){}draw(e,t,r,i,n,a,s=-1){}setParameter(e,t){}getParameter(e){}getTexture(){return null}}},"./04renderer/visualize/Volume.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return l});var i=r("./02resource/m3d_shader_library.js"),n=r("./03scene/drawables/Drawable.ts"),a=r("./03scene/materials/MaterialVolume.ts"),s=r("./04renderer/visualize/Visualize.ts"),o=r("./glMatrix.js");class l extends s.default{constructor(e){super("volume",e),this._resourceManager=e.getResourceManager(),this._dataTexture=null,this._platteTexture=this._resourceManager.getTexture(this.name+"-volume-platte"),this._gradientTexture=this._resourceManager.getTexture(this.name+"-volume-gradient")}destroy(){this._gradientTexture.destroy(),this._gradientTexture=null,delete this._gradientTexture,this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,this._resourceManager=null,delete this._resourceManager,super.destroy()}setParameter(e,t){const r=this._resourceManager.gl;switch(e){case"data":if(this._dataTexture=this._resourceManager.getTexture(this.name+"-volume"),!this._dataTexture.ready){const e=this._resourceManager.gl;e.isWebGL2?this._dataTexture.create(t.width,t.height,e.R32F,e.LINEAR,e.CLAMP_TO_EDGE):this._dataTexture.create(t.width,t.height,e.LUMINANCE,e.LINEAR,e.CLAMP_TO_EDGE)}let n=t.data;if(!(r.isWebGL2||t.data instanceof Uint8Array)){n=new Uint8Array(t.data.length);for(var i=0;i<t.data.length;i++)n[i]=255*t.data[i]}this._dataTexture.update(n);break;case"dataTexture":this._dataTexture=t;break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,null);break;case"gradientImage":this._gradientTexture.createFromFile(t,r.RGB,r.LINEAR,r.CLAMP_TO_EDGE,null)}}_updateInvTransform(e){var t=o.mat4.create();o.mat4.invert(t,e.transform.matrix),e.material.setInvTransform(t)}setPosition(e){super.setPosition(e),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}setScaling(e){super.setScaling(e),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])}draw(e,t,r,s,o,l,d=-1){if(!this._enabled)return;if(!this._platteTexture.ready||!this._dataTexture.ready||!this._gradientTexture.ready)return void console.warn(`The resources of ${this.name} are not ready!`);if(0===this._drawables.length){const e=.5;let t=this._resourceManager.getMesh("volume");t.createSolidCube(.5);let r="volume",s=this._resourceManager.getShader(r,["MODEL_TRANSFORM"]);if(!s.ready){var u=i.default[r];if(s.createFromShaderSource(u,["MODEL_TRANSFORM"]),!s.ready)throw new Error("Error at creating shader '"+r+"'!")}let o=new a.default("volume",this._resourceManager);o.attachShader(s,this._resourceManager);let l=new n.default(t,s,o,null,new Float32Array([-e,-e,-e,e,e,e]));this._drawables.push(l),this.setPosition(this._position),this.setScaling(this._scale)}let c=this._drawables[0].material;c.setPlatteTexture(this._platteTexture),c.setGradientTexture(this._gradientTexture),c.setDataTexture(this._dataTexture),c.setAlphaCorrection(.03),e.drawDrawables(l,this._drawables,t,null,null,r,s,o)}}},"./07loadsave/Load360.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./09app/Viewer.ts"),n=r("./99api/utils/model/downloader.ts"),a=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};class s{constructor(e,t){this._data=e,this._viewer=t}load(e,t,r,s,o,l){return a(this,void 0,void 0,function*(){console.group("Loading panoramas ");let e=1;for(const t of r){const a=this._data[t];if(a.ready)return;if("cubemaps"!==a.type)throw Error("Unsupported panorama file types!");const o=[];for(let e=0;e<a.imageUrls.length;e++){const r=a.imageUrls[e].split("/"),i={filename:r[r.length-1],url:a.imageUrls[e]};o.push(Object(n.downloadFile)(t,i))}const d=yield Promise.all(o);if(a.images=d.slice(0),a.ready=!0,l(e/r.length,t),s(),this._viewer.state!==i.State.INITIALIZED&&this._viewer.state!==i.State.RENDERING)return;e++}o()})}}},"./08ui/input/Input.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(e,t){this.name=e,this._enabled=!1,this._canvas=t.getCanvas(),this._event=null}destroy(){this._enabled=null,delete this._enabled,this.name=null,delete this.name,this._event=null,delete this._event,this._canvas=null,delete this._canvas}isAvailable(e){return!1}setEnabled(e){this._enabled=e}}},"./08ui/input/Keyboard.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i,n=r("./08ui/input/Input.ts");!function(e){e[e.KEY_PRESSED=0]="KEY_PRESSED",e[e.KEY_DOWN=1]="KEY_DOWN",e[e.KEY_UP=2]="KEY_UP"}(i||(i={}));class a extends n.default{constructor(e){super("keyboard",e),this.status=i.KEY_UP,this._enabled=!0,this._upListeners=[],this._downListeners=[],this.key=0,this._keyDownFn=this._keyDown.bind(this),this._keyUpFn=this._keyUp.bind(this),document.addEventListener("keydown",this._keyDownFn),document.addEventListener("keyup",this._keyUpFn)}destroy(){this._upListeners=null,delete this._upListeners,this._downListeners=null,delete this._downListeners,document.removeEventListener("keydown",this._keyDownFn),document.removeEventListener("keyup",this._keyUpFn),this._keyDownFn=null,delete this._keyDownFn,this._keyUpFn=null,delete this._keyUpFn,super.destroy()}isAvailable(e){return!e}addKeyUpListener(e){this._upListeners.push(e)}addKeyDownListener(e){this._downListeners.push(e)}_keyDown(e){if(this._doesCanvasHaveFocus()){e.preventDefault(),this.status=i.KEY_PRESSED,this.key=e.keyCode;for(var t=this._downListeners.length-1;t>=0&&!this._downListeners[t](this);--t);}}_keyUp(e){if(this._doesCanvasHaveFocus()){e.preventDefault(),this.status=i.KEY_UP,this.key=e.keyCode;for(var t=this._upListeners.length-1;t>=0&&!this._upListeners[t](this);--t);}}_doesCanvasHaveFocus(){if(!this._enabled)return!1;var e=document.activeElement,t=e&&e!==document.body;if(t)return!1;var r="";return void 0!==window.getSelection?r=window.getSelection().toString():void 0!==document.selection&&"Text"===document.selection.type&&(r=document.selection.createRange().text),!r&&!t}}},"./08ui/input/Mouse.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./00utility/Environment.ts"),n=r("./08ui/input/Input.ts");class a extends n.default{constructor(e){super("mouse",e),this.LEFT_BUTTON=0,this.MIDDLE_BUTTON=1,this.RIGHT_BUTTON=2,this._x0=-1,this._y0=-1,this._lastWheelTime=0,this._eventQueue=[],this.x=-1,this.y=-1,this.dx=-1,this.dy=-1,this.pressed=!1,this.moved=!1,this.delta=0,this.button=this.LEFT_BUTTON,this._downListeners=[],this._moveListeners=[],this._upListeners=[],this._wheelListeners=[];let t=0;const r=this;function n(e){return function(n){if((n.relatedTarget||n.toElement||n.currentTarget)===r._canvas)return n.offsetX_norm=void 0===n.offsetX?n.layerX:n.offsetX,n.offsetY_norm=void 0===n.offsetY?n.layerY:n.offsetY,"firefox"===i.Environment.browserName||"edge"===i.Environment.browserName?n.buttonDown=t:n.buttonDown=n.which,e.call(r,n)}}this._canvas.onwheel=n(this._onMouseWheel),this._canvas.onmousemove=n(this._onMouseMove);const a=n(this._onMouseDown);this._canvas.onmousedown=function(e){t=e.which,a(e)};const s=n(this._onMouseUp);this._canvas.onmouseup=function(e){s(e),t=0},this._onMouseLeave=function(e){t=0},document.addEventListener("mouseout",this._onMouseLeave,!1)}destroy(){this._canvas.onmousedown=null,this._canvas.onmouseup=null,this._canvas.onmouseleave=null,this._canvas.ondblclick=null,this._canvas.onwheel=null,this._canvas.onmousemove=null,document.removeEventListener("mouseout",this._onMouseLeave),this._downListeners=null,delete this._downListeners,this._upListeners=null,delete this._upListeners,this._moveListeners=null,delete this._moveListeners,this._wheelListeners=null,delete this._wheelListeners,this._enabled=null,delete this._eventQueue,super.destroy()}addMouseDownListener(e){this._downListeners.push(e)}addMouseMoveListener(e){this._moveListeners.push(e)}addMouseUpListener(e){this._upListeners.push(e)}addMouseWheelListener(e){this._wheelListeners.push(e)}isAvailable(e){return!e}_onMouseDown(e){if(this._enabled){e.preventDefault(),this.pressed=!0;var t=e.offsetX_norm,r=e.offsetY_norm;this.dx=0,this.dy=0,this.x=t,this.y=r,this.moved=!1,this.button=e.button,this._x0=this.x,this._y0=this.y,this._event=e;for(let e=this._downListeners.length-1;e>=0&&!this._downListeners[e](this);--e);}}_onMouseUp(e){if(!this._enabled)return;e.preventDefault(),this.pressed=!1;const t=e.offsetX_norm,r=e.offsetY_norm;this.dx=t-this.x,this.dy=r-this.y,this.x=t,this.y=r,this._event=e,this.button=e.button,(Math.abs(this.x-this._x0)>3||Math.abs(this.y-this._y0)>3)&&(this.moved=!0);for(let e=this._upListeners.length-1;e>=0&&!this._upListeners[e](this);--e);}_onMouseMove(e){if(!this._enabled)return;e.preventDefault();const t=e.offsetX_norm,r=e.offsetY_norm;this.dx=t-this.x,this.dy=r-this.y,this.x=t,this.y=r,this._event=e,(Math.abs(this.x-this._x0)>3||Math.abs(this.y-this._y0)>3)&&(this.moved=!0);for(let e=this._moveListeners.length-1;e>=0&&!this._moveListeners[e](this);--e);}_onMouseWheel(e){if(this._enabled){e.preventDefault();var t=e.deltaY;this.delta=-Math.max(-1,Math.min(1,t)),"firefox"!==i.Environment.browserName&&(this.delta*=Math.min(t*t/2500,1));for(var r=this._wheelListeners.length-1;r>=0&&!this._wheelListeners[r](this);--r);}}getEvent(){return this._event}}},"./08ui/input/Touch.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./08ui/input/Input.ts");class n extends i.default{constructor(e){super("touch",e),this.numCursors=0,this.x0=0,this.y0=0,this.cursors={},this.identifiers=[],this.lastCursor=null,this._startListeners=[],this._moveListeners=[],this._stopListeners=[],this._onTouchStart=this._onTouchStart1.bind(this),this._onTouchMove=this._onTouchMove1.bind(this),this._onTouchStop=this._onTouchStop1.bind(this),this._canvas.addEventListener("touchstart",this._onTouchStart,!1),this._canvas.addEventListener("touchmove",this._onTouchMove,!1),this._canvas.addEventListener("touchend",this._onTouchStop,!1)}destroy(){this._canvas.removeEventListener("touchstart",this._onTouchStart),this._canvas.removeEventListener("touchmove",this._onTouchMove),this._canvas.removeEventListener("touchend",this._onTouchStop),this._startListeners=null,delete this._startListeners,this._moveListeners=null,delete this._moveListeners,this._stopListeners=null,delete this._stopListeners,super.destroy()}cursor(e){return e<this.identifiers.length?this.cursors[this.identifiers[e]]:null}addTouchMoveListener(e){this._moveListeners.push(e)}addTouchStartListener(e){this._startListeners.push(e)}addTouchStopListener(e){this._stopListeners.push(e)}_onTouchStart1(e){e.preventDefault(),this.numCursors=e.touches.length;for(var t=0;t<e.changedTouches.length;++t)this._addCursor(e.changedTouches[t]);for(var r in this.cursors)null!==this.cursors[r]&&r;1===this.numCursors&&(this.lastCursor=this.cursor(0));for(let e=this._startListeners.length-1;e>=0&&!this._startListeners[e](this);--e);}_onTouchMove1(e){e.preventDefault();this.numCursors=e.touches.length;var t=[];for(let r=0;r<e.touches.length;r++)this.cursors[e.touches[r].identifier]||this._addCursor(e.touches[r]),t.push(e.touches[r].identifier);for(let e in this.cursors){const r=Number(e);-1===t.indexOf(r)&&this._removeCursor(r)}for(var r=this._canvas.getBoundingClientRect(),i=0;i<e.changedTouches.length;++i){var n=e.changedTouches[i].pageX-r.left,a=e.changedTouches[i].pageY-r.top,s=e.changedTouches[i].identifier;this.cursors[s].dx=n-this.cursors[s].x,this.cursors[s].dy=a-this.cursors[s].y,this.cursors[s].x=n,this.cursors[s].y=a,this.cursors[s].moved=!0}for(let e=this._moveListeners.length-1;e>=0&&!this._moveListeners[e](this);--e);}_onTouchStop1(e){e.preventDefault();for(let e=this._stopListeners.length-1;e>=0&&!this._stopListeners[e](this);--e);this.numCursors=e.touches.length;for(let r=0;r<e.changedTouches.length;r++){var t=e.changedTouches[r].identifier;this._removeCursor(t)}}isAvailable(e){return!0}_removeCursor(e){var t=this.identifiers.indexOf(e);-1!==t&&this.identifiers.splice(t,1),delete this.cursors[e]}_addCursor(e){var t=this._canvas.getBoundingClientRect(),r=e.identifier,i={x:e.pageX-t.left,y:e.pageY-t.top,dx:0,dy:0,moved:!1};this.cursors[r]=i,this.identifiers.push(r)}}},"./08ui/tool/CameraManipulator.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return l});var i=r("./00utility/Environment.ts"),n=r("./00utility/Config.ts"),a=r("./03scene/camera/m3d_camera_animator_transition.js"),s=r("./08ui/tool/DepthQuery.ts"),o=r("./08ui/tool/Tool.ts");class l extends o.default{constructor(e){super("CameraManipulator",!1,e),this._viewer?this._depthQuery=new s.default(this._scene,this._resourceManager):this._depthQuery=null,this._animator=new a.default,this._restricted=!1,this._clippingEnabled=!!this._scene&&this._scene.clipping.isEnabled(),this._touchPanSpeedScaling=1.86*i.Environment.devicePixelRatio,this._touchZoomSpeedScaling=.0596*Math.sqrt(i.Environment.devicePixelRatio),this._touchRotateSpeedScaling=.44*i.Environment.devicePixelRatio,this._mousePanSpeedScaling=.37,this._mouseZoomSpeedScaling=.278,this._mouseRotateSpeedScaling=.45,this._keyRotateSpeed=12,this._keyPanSpeed=1,this._keyForwardSpeed=.0092,this._isPanorama=!1}destroy(){this._animator.destroy(),this._animator=null,delete this._animator,this._depthQuery&&(this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery),super.destroy()}isAvailable(e){return!0}isSupport3D(){return!0}addInput(e){"mouse"===e.name?(e.addMouseDownListener(this._onMouseDown.bind(this)),e.addMouseMoveListener(this._onMouseMove.bind(this)),e.addMouseUpListener(this._onMouseUp.bind(this)),e.addMouseWheelListener(this._onMouseWheel.bind(this))):"touch"===e.name?(e.addTouchMoveListener(this._onTouchMove.bind(this)),e.addTouchStartListener(this._onTouchStart.bind(this))):"gyrosensor"===e.name||"keyboard"===e.name&&e.addKeyDownListener(this._onKeyDown.bind(this))}_onMouseDown(e){return this._exitTransit(),!1}_onMouseMove(e){if(e.button===e.LEFT_BUTTON&&e.pressed)if(this._isPanorama){this._camera.rotate(-e.dx*this._mouseRotateSpeedScaling,-e.dy*this._mouseRotateSpeedScaling);for(let t=1;t<this._cameras.length;t++)this._cameras[t].rotate(-e.dx*this._mouseRotateSpeedScaling,-e.dy*this._mouseRotateSpeedScaling)}else{this._camera.rotate(e.dx*this._mouseRotateSpeedScaling,e.dy*this._mouseRotateSpeedScaling);for(let t=1;t<this._cameras.length;t++)this._cameras[t].rotate(e.dx*this._mouseRotateSpeedScaling,e.dy*this._mouseRotateSpeedScaling)}else if(e.button===e.MIDDLE_BUTTON&&e.pressed&&!this._restricted){this._camera.zoom(.01*e.dx*i.Environment.devicePixelRatio);for(let t=1;t<this._cameras.length;t++)this._cameras[t].zoom(.01*e.dx*i.Environment.devicePixelRatio)}else if(e.button===e.RIGHT_BUTTON&&e.pressed&&!this._restricted){this._camera.pan(e.dx*this._mousePanSpeedScaling,e.dy*this._mousePanSpeedScaling);for(let t=1;t<this._cameras.length;t++)this._cameras[t].pan(e.dx*this._mousePanSpeedScaling,e.dy*this._mousePanSpeedScaling)}return!1}doesSupportMobile(e){return!1}doesSupport3D(e){return!0}_onMouseUp(e){return!1}_onMouseWheel(e){this._exitTransit();const t=e.delta*this._mouseZoomSpeedScaling;this._camera.zoom(t,e.x*i.Environment.devicePixelRatio,e.y*i.Environment.devicePixelRatio);for(let r=1;r<this._cameras.length;r++)this._cameras[r].zoom(t,e.x*i.Environment.devicePixelRatio,e.y*i.Environment.devicePixelRatio);return!1}_onTouchMove(e){let t,r,i=e.cursor(0);if(this._exitTransit(),1===e.numCursors)i=e.cursor(0),this._camera.rotate(i.dx*this._touchRotateSpeedScaling,i.dy*this._touchRotateSpeedScaling);else if(2===e.numCursors){i=e.cursor(0);var n=e.cursor(1);if(i.dx*n.dx+i.dy*n.dy>0)t=(i.dx+n.dx)*this._touchPanSpeedScaling,r=(i.dy+n.dy)*this._touchPanSpeedScaling,this._camera.pan(t,r);else{var a=i.x-i.dx,s=i.y-i.dy;t=a-(n.x-n.dx),r=s-(n.y-n.dy);var o=Math.sqrt(t*t+r*r);t=i.x-n.x,r=i.y-n.y;var l=Math.sqrt(t*t+r*r)-o,d=Math.sign(l)*this._touchZoomSpeedScaling;this._camera.zoom(d)}}}_onTouchStart(e){}_onKeyDown(e){switch(e.key){case 39:case 68:case 100:this._camera.rotate(this._keyRotateSpeed,0);break;case 38:case 87:case 119:this._restricted||this._camera.forward(this._keyForwardSpeed);break;case 37:case 65:case 97:this._camera.rotate(-this._keyRotateSpeed,0);break;case 40:case 83:case 115:this._restricted||this._camera.forward(-this._keyForwardSpeed)}}_exitTransit(){this._restricted||this._camera.animator instanceof a.default&&this._camera.animator.stop()}setCamera(e,t=0){this._cameras=[];for(let t=0;t<e.length;t++)this._cameras.push(e[t]);this._camera=this._cameras[t]}setTransitionSpeed(e){this._animator.setTransitionSpeed(e)}setInputSensitivity(e){for(let t in e)switch(t){case"touchPan":this._touchPanSpeedScaling=e[t]*i.Environment.devicePixelRatio;break;case"touchZoom":this._touchZoomSpeedScaling=e[t]*Math.sqrt(i.Environment.devicePixelRatio);break;case"touchRotate":this._touchRotateSpeedScaling=e[t]*i.Environment.devicePixelRatio;break;case"mousePan":this._mousePanSpeedScaling=e[t];break;case"mouseZoom":this._mouseZoomSpeedScaling=e[t],this._camera.setZoomMinMax(e[t]);break;case"mouseRotate":this._mouseRotateSpeedScaling=e[t];break;case"keyPan":this._keyPanSpeed=e[t];break;case"keyForward":this._keyForwardSpeed=e[t]}}setPanoramaEnabled(e){this._isPanorama=e}setRestrictedViewEnabled(e){this._restricted=e}isRestrictedViewEnabled(){return this._restricted}recompileShader(e){if(!this._scene)return;e.slice(0);e.push("CLIPPING"),n.Config.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this._depthQuery.recompileShader(this._resourceManager,e)}unproject(e,t){return this._depthQuery.unproject(e,t,this._renderer,this._camera)}}},"./08ui/tool/CameraNavigator.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./03scene/camera/m3d_camera_animator_navigate.js"),n=r("./08ui/tool/Tool.ts"),a=r("./glMatrix.js");class s{constructor(){this.eye=a.vec3.create(),this.at=a.vec3.create(),this.angleDiff=0}}class o extends n.default{constructor(e){super("CameraNavigator",!1,e),this._rotationDuration=100,this._update=(()=>{if(!this._animating)return;this._currentStep++;let e=this._currentStep*this._speed,t=0;for(;t<this._keyPoints.length&&!(this._distances[t]>e);t++);if(t===this._keyPoints.length){let e=this._keyPoints[this._keyPoints.length-1];this._moveTo(e.eye,e.at),this._viewer.getEventEmitter().emit("Camera-Navigation-Over"),this.stop()}else{let r=(e-this._distances[t-1])/(this._distances[t]-this._distances[t-1]);a.vec3.lerp(this._tmpKeypoint.eye,this._keyPoints[t-1].eye,this._keyPoints[t].eye,r),a.vec3.rotateZ(this._tmpKeypoint.at,this._keyPoints[t-1].at,this._keyPoints[t-1].eye,this._keyPoints[t].angleDiff*r),a.vec3.subtract(this._tmpKeypoint.at,this._tmpKeypoint.at,this._keyPoints[t-1].eye),a.vec3.add(this._tmpKeypoint.at,this._tmpKeypoint.at,this._tmpKeypoint.eye),this._moveTo(this._tmpKeypoint.eye,this._tmpKeypoint.at)}}),this._keyPoints=[],this._distances=[],this._speed=.5,this._animator=new i.default,this._animating=!1,this._currentStep=0,this._tmpKeypoint=new s,this._viewer.getEventEmitter().on("before-rendering",this._update)}destroy(){this._keyPoints=null,delete this._keyPoints,this._distances=null,delete this._distances,this._speed=null,delete this._speed,this._animator=null,delete this._animator,this._animating=null,delete this._animating,this._currentStep=null,delete this._currentStep,this._tmpKeypoint=null,delete this._tmpKeypoint,this._viewer.getEventEmitter().remove("before-rendering",this._update),super.destroy()}setRotationDuration(e){this._rotationDuration=e}clearKeyPoints(){this._keyPoints.length=0}_reCalculateKeyPoints(){let e=[];this._distances.length=0;let t=this._keyPoints.length;for(t=1;t<this._keyPoints.length;t++){var r=this._keyPoints[t-1],i=this._keyPoints[t];let o=a.vec3.length(i.eye,r.eye);if(1==t)this._distances.push(0),this._distances.push(o),r.at=a.vec3.clone(i.eye),a.vec3.subtract(i.at,r.at,r.eye),a.vec3.add(i.at,i.at,i.eye),e.push(r),e.push(i);else{var n=new s;n.eye=a.vec3.clone(r.eye),a.vec3.subtract(n.at,i.eye,r.eye),a.vec3.add(n.at,n.eye,n.at),a.vec3.subtract(i.at,n.at,n.eye),a.vec3.add(i.at,i.at,i.eye);let t=a.vec3.create(),l=a.vec3.create();a.vec3.subtract(t,n.at,n.eye),a.vec3.subtract(l,r.at,r.eye),a.vec3.normalize(t,t),a.vec3.normalize(l,l);let d=Math.acos(a.vec3.dot(t,l)),u=a.vec3.create();a.vec2.cross(u,l,t),d=u[2]>=0?d:-d,n.angleDiff=d,this._distances.push(this._distances[this._distances.length-1]+Math.abs(d)*this._rotationDuration),this._distances.push(this._distances[this._distances.length-1]+o),e.push(n),e.push(i)}}this._keyPoints=e}addKeyPoint(e){let t=new s;t.eye=e,this._keyPoints.push(t)}setSpeed(e){this._speed=e}start(){this._keyPoints.length<2||(this._reCalculateKeyPoints(),this._camera.eye=a.vec3.clone(this._keyPoints[0].eye),this._camera._at=a.vec3.clone(this._keyPoints[0].at),this._animating=!0,this._currentStep=0)}stop(){this._animating=!1}resume(){this._animating=!0}_moveTo(e,t){this._animator.attach(this._camera),this._animator.start(e,t),this._animator.stop()}}},"./08ui/tool/Comment.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./00utility/m3d_math.js"),n=r("./00utility/Config.ts"),a=r("./03scene/camera/m3d_camera_animator_transition.js"),s=r("./03scene/camera/m3d_camera_animator_navigate.js"),o=r("./08ui/tool/DepthQuery.ts"),l=r("./08ui/tool/PickQuery.ts"),d=r("./08ui/tool/Tool.ts");class u extends d.default{constructor(e){super("Comment",!1,e),this._pickQuery=new l.default(this._scene,this._resourceManager),this._depthQuery=new o.default(this._scene,this._resourceManager),this._animator=new a.default(e.getEventEmitter()),this._clippingEnabled=this._scene.clipping.isEnabled(),this._comments={}}destroy(){this._pickQuery.destroy(),this._pickQuery=null,delete this._pickQuery,this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery,this._comments=null,delete this._comments}doesSupportMobile(e){return!0}doesSupport3D(e){return!0}_recompileShader(){if(this._scene.clipping.isEnabled()!==this._clippingEnabled){this._clippingEnabled=this._scene.clipping.isEnabled();let e=[];n.Config.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this._pickQuery.recompileShader(this._resourceManager,e),this._depthQuery.recompileShader(this._resourceManager,e)}}activate(e){let t=!1,r=this._scene.clipping.isEnabled(),n=!1;if(e.section){if(n=!0,r){let r=i.default.aabb.create(e.section.min,e.section.max);t=i.default.aabb.isEqual(this._scene.clipping.get(),r)}e.section.min&&e.section.max?this._scene.clipping.set(e.section.min,e.section.max):this._scene.clipping.set(e.section.planes,e.section.points)}else this._scene.clipping.reset(),n=!1;t=t||r!==n,(this._camera.animator instanceof a.default||this._camera.animator instanceof s.default)&&this._camera.animator.stop(!0),this._animator.attach(this._camera),this._animator.start(e.camera,!1)}setTransitionSpeed(e){this._animator.setTransitionSpeed(e)}create(){return{element:"",camera:this._camera.dump(),section:this._scene.clipping.isEnabled()?{planes:this._scene.clipping.getClippingPlanes(!0),points:this._scene.clipping.getClippingPoints(!0)}:null}}render(){this._enabled}setComments(e){for(let t=0;t<e.length;t++)this._comments[e[t].id]=e[t].renderData}addComment(e){this._comments[e.id]=e.renderData}deleteComment(e){delete this._comments[e]}setEnabled(e){if(super.setEnabled(e),this._recompileShader(),!this._enabled){let e={};for(let t=0,r=this._comments.length;t<r;t++){let r={x:-1,y:-1,visible:!1};e[this._comments[t].id]=r}this._viewer.getEventEmitter().emit("Comment-UpdateRenderStatus",e)}}}},"./08ui/tool/DepthQuery.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return d});var i=r("./00utility/Environment.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/camera/m3d_base_camera.js"),s=r("./03scene/materials/Material.ts"),o=r("./04renderer/pipeline/RenderTarget.ts"),l=r("./glMatrix.js");class d{constructor(e,t){this._scene=e,this._renderTarget=null,this._shaders=[null,null,null],this._ready=!1,this._phonyCamera=new a.default([0,0,1,1]),this._pickMatrix=l.mat4.create(),this._material=new s.default("depth-query"),this._gl=t.gl,this.recompileShader(t,[]),this._renderTarget=new o.default("query",t,5,5,{clearColor:[0,0,0,0]}),this._ready=this._renderTarget.ready}destroy(){this._ready&&(this._material.destroy(),this._material=null,delete this._material,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._pickMatrix=null,delete this._pickMatrix,this._phonyCamera=null,delete this._phonyCamera)}_begin(e,t,r,i,n,a){t=r.viewport[3]-1-t,this._pickMatrix[0]=r.viewport[2]/n,this._pickMatrix[5]=r.viewport[3]/a,this._pickMatrix[12]=(r.viewport[2]-2*e)/n,this._pickMatrix[13]=(r.viewport[3]-2*t)/a,l.mat4.multiply(this._phonyCamera.vpMatrix,this._pickMatrix,r.vpMatrix),this._phonyCamera.viewport[0]=r.viewport[0],this._phonyCamera.viewport[1]=r.viewport[1],this._phonyCamera.viewport[2]=n,this._phonyCamera.viewport[3]=a}_end(e,t){const r=this._gl;if(e||t){o=new Uint8Array(e*t*4);r.readPixels(0,0,e,t,r.RGBA,r.UNSIGNED_BYTE,o);for(var i=Number.POSITIVE_INFINITY,n=e*t,a=0;a<n;a+=1)if(0!==o[4*a+0]||0!==o[4*a+1]||0!==o[4*a+2]||0!==o[4*a+3]){var s=o[4*a+0]/255*(1/16581375)+o[4*a+1]/255*(1/65025)+o[4*a+2]/255*(1/255)+o[4*a+3]/255;s<i&&(i=s)}return i===Number.POSITIVE_INFINITY?null:i}var o=new Uint8Array(100);return r.readPixels(2,2,1,1,r.RGBA,r.UNSIGNED_BYTE,o),0===o[0]&&0===o[1]&&0===o[2]&&0===o[3]?null:o[0]/255*(1/16581375)+o[1]/255*(1/65025)+o[2]/255*(1/255)+o[3]/255}unproject(e,t,r,n){if(!this._ready)return null;const a=this._gl;for(var s in e=Math.floor(e*i.Environment.devicePixelRatio),t=Math.floor(t*i.Environment.devicePixelRatio),this._renderTarget.resize(5,5),this._begin(e,t,n,r,5,5),r.clear(this._renderTarget,a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this._scene.clipping.isEnabled()&&r.renderState.invalidateClip(),this._scene.models)r.drawDrawables(this._renderTarget,this._scene.models[s].drawables,this._phonyCamera,this._shaders,this._material,this._scene.clipping,null,null,!this._scene.needRenderDoubleSided()&&a.CCW);this._scene.terrain&&r.drawDrawables(this._renderTarget,this._scene.terrain.drawables,this._phonyCamera,this._shaders,this._material,this._scene.clipping,null,null,!this._scene.needRenderDoubleSided()&&a.CCW);var o=this._end();return null===o?(console.warn("failed to find valid depth value."),null):this._getPosition(e,t,o,n)}getNearest(e,t,r,n,a,s){if(!this._ready)return null;const o=this._gl;e=Math.floor(e*i.Environment.devicePixelRatio),t=Math.floor(t*i.Environment.devicePixelRatio),r=Math.floor(r*i.Environment.devicePixelRatio),n=Math.floor(n*i.Environment.devicePixelRatio);var l=Math.floor((e+r)/2),d=Math.floor((t+n)/2),u=r-e,c=n-t;for(var h in this._renderTarget.resize(u,c),this._begin(l,d,s,a,u,c),a.clear(this._renderTarget,o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),this._scene.clipping.isEnabled()&&a.renderState.invalidateClip(),this._scene.models)a.drawDrawables(this._renderTarget,this._scene.models[h].drawables,this._phonyCamera,this._shaders,this._material,this._scene.clipping,null,null,!this._scene.needRenderDoubleSided()&&o.CCW);this._scene.terrain&&a.drawDrawables(this._renderTarget,this._scene.terrain.drawables,this._phonyCamera,this._shaders,this._material,this._scene.clipping,null,null,!this._scene.needRenderDoubleSided()&&o.CCW);var m=this._end(u,c);return null===m?(console.warn("failed to find valid depth value."),null):this._getPosition(l,d,m,s)}_getPosition(e,t,r,i){var n=i.viewport[2],a=i.viewport[3],s=l.vec4.fromValues(2*(e/n-.5),2*((a-1-t)/a-.5),2*r-1,1),o=l.mat4.create();l.mat4.invert(o,i.vpMatrix);var d=l.vec4.fromValues();return l.vec4.transformMat4(d,s,o),0!==d[3]?(s[0]=d[0]/d[3],s[1]=d[1]/d[3],s[2]=d[2]/d[3],s[3]=1):l.vec4.copy(s,d),s}recompileShader(e,t){let r=t.slice(0);r.push("ENCODE_DEPTH"),this._shaders[0]=e.getShader("depth-query",r),this._shaders[0].ready||this._shaders[0].createFromShaderSource(n.default.depth,r),r.push("MODEL_TRANSFORM"),this._shaders[1]=e.getShader("depth-query",r),this._shaders[1].ready||this._shaders[1].createFromShaderSource(n.default.depth,r),r.push("INSTANCING"),this._shaders[2]=e.getShader("depth-query",r),this._shaders[2].ready||this._shaders[2].createFromShaderSource(n.default.depth,r),this._material.attachShader(this._shaders[0])}}},"./08ui/tool/MagnifyGlass.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return c});var i=r("./00utility/Environment.ts"),n=r("./03scene/drawables/Gizmo2D.ts"),a=r("./03scene/camera/m3d_camera_animator_transition.js"),s=r("./08ui/tool/DepthQuery.ts"),o=r("./08ui/tool/Tool.ts"),l=r("./08ui/tool/assets.ts"),d=r("./glMatrix.js");const u=.01;class c extends o.default{constructor(e){super("MagnifyGlass",!0,e),this._depthQuery=new s.default(this._scene,e.getResourceManager()),this._animator=new a.default,this._renderTarget=this._getRenderTarget({depthTest:!1}),this._lineWidth=1,this._dashLength=1;const t=this._resourceManager.getMesh("magnify");t.createQuad(),this._drawable=new n.default(t,this._resourceManager);const r=e.getResourceManager().gl;this._resourceManager.getTexture("magnify").createFromFile(l.DASH_LINE_TEXTURE_IMAGE,r.RGB,r.LINEAR,r.REPEAT,e=>{this._drawable.setTexture(e),this._dashLength=e.width}),this._vertices=new Float32Array(80),this._indices=new Uint8Array(24);for(var i=0;i<4;++i)this._indices[0+6*i]=0+4*i,this._indices[1+6*i]=1+4*i,this._indices[2+6*i]=2+4*i,this._indices[3+6*i]=2+4*i,this._indices[4+6*i]=3+4*i,this._indices[5+6*i]=0+4*i;this._resetVertices()}destroy(){this._animator.destroy(),this._animator=null,delete this._animator,this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery,this._drawable.destroy(),this._drawable=null,delete this._drawable,this._vertices=null,delete this._vertices,this._indices=null,delete this._indices,super.destroy()}doesSupportMobile(e){return!0}doesSupport3D(e){return!0}setEnabled(e){super.setEnabled(e),this._enabled||(this._startX=0,this._startY=0,this._endX=0,this._endY=0)}render(){this._enabled&&this._renderer.drawDrawable(this._renderTarget,this._drawable,this._camera,null,null,null,!1)}addInput(e){"mouse"===e.name?(e.addMouseDownListener(this._onMouseDown.bind(this)),e.addMouseMoveListener(this._onMouseMove.bind(this)),e.addMouseUpListener(this._onMouseUp.bind(this))):e.name}_onMouseDown(e){return!(!this._enabled||e.button!==e.LEFT_BUTTON)&&(this._startX=e.x,this._startY=e.y,this._endX=this._startX,this._endY=this._startY,!0)}_onMouseMove(e){return!(!this._enabled||e.button!==e.LEFT_BUTTON||!e.pressed)&&(this._endX+=e.dx,this._endY+=e.dy,this._updateVertices(),!0)}_onMouseUp(e){return!(!this._enabled||e.button!==e.LEFT_BUTTON)&&(this._inputStop(),this._viewer.getEventEmitter().emit("MagnifyGlass-Selected"),!0)}_inputStop(){const e=this._renderer,t=this._viewer.getCamera().core,r=t.viewport[2],i=t.viewport[3];if(this._resetVertices(),this._startX>this._endX){var n=this._startX;this._startX=this._endX,this._endX=n}if(this._startY>this._endY){n=this._startY;this._startY=this._endY,this._endY=n}if(this._startX!==this._endX&&this._startY!==this._endY){var a=this._depthQuery.getNearest(this._startX,this._startY,this._endX,this._endY,e,this._camera);if(null!==a){var s=d.vec3.create();d.vec3.subtract(s,a,this._camera.eye);var o=d.vec3.length(s);if(o<u*this._scene.radius)this.setEnabled(!1);else{var l=Math.max(Math.abs(this._endX-this._startX)/r,Math.abs(this._endY-this._startY)/i);if(this._camera.isPerspective()){var c={fov:this._camera._fov,theta:this._camera._theta,phi:this._camera._phi,at:[a[0],a[1],a[2]],distance:l*o};this._animator.attach(this._camera),this._animator.start(c,!1,50)}else this._camera.zoomBy(l);this.setEnabled(!1)}}else this.setEnabled(!1)}else this.setEnabled(!1)}resize(e,t){this._renderTarget.resize(e,t),super.resize(e,t)}setLineWidth(e){this._lineWidth=e}_updateVertices(){var e=this._startX,t=this._endX,r=this._startY,n=this._endY;this._startX>this._endX&&(e=this._endX,t=this._startX),this._startY>this._endY&&(r=this._endY,n=this._startY);const a=this._viewer.getCamera().core.viewport[3];e=Math.floor(e*i.Environment.devicePixelRatio),r=Math.floor(a-1-r*i.Environment.devicePixelRatio);var s=(t=Math.floor(t*i.Environment.devicePixelRatio))-e,o=r-(n=Math.floor(a-1-n*i.Environment.devicePixelRatio)),l=Math.floor(this._lineWidth*i.Environment.devicePixelRatio);this._addQuad(e,r,e+l,n,0,0,o,o,0),this._addQuad(e,r,t,r+l,0,s,s,0,20),this._addQuad(t-l,r,t,n,0,0,o,o,40),this._addQuad(e,n-l,t,n,0,s,s,0,60);const d=this._viewer.getResourceManager().gl;this._drawable.mesh.update(this._vertices,this._indices,d.UNSIGNED_BYTE)}_addQuad(e,t,r,i,n,a,s,o,l){const d=this._viewer.getCamera().core,u=d.viewport[2],c=d.viewport[3];e=e/u*2-1,r=r/u*2-1,t=t/c*2-1,i=i/c*2-1,this._vertices[0+l]=e,this._vertices[1+l]=t,this._vertices[2+l]=0,this._vertices[3+l]=n/this._dashLength,this._vertices[4+l]=.5,this._vertices[5+l]=r,this._vertices[6+l]=t,this._vertices[7+l]=0,this._vertices[8+l]=a/this._dashLength,this._vertices[9+l]=.5,this._vertices[10+l]=r,this._vertices[11+l]=i,this._vertices[12+l]=0,this._vertices[13+l]=s/this._dashLength,this._vertices[14+l]=.5,this._vertices[15+l]=e,this._vertices[16+l]=i,this._vertices[17+l]=0,this._vertices[18+l]=o/this._dashLength,this._vertices[19+l]=.5}_resetVertices(){for(var e=0;e<80;++e)this._vertices[e]=-1e6;const t=this._viewer.getResourceManager().gl;this._drawable.mesh.update(this._vertices,this._indices,t.UNSIGNED_BYTE)}}},"./08ui/tool/Measure.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return d});var i=r("./00utility/Config.ts"),n=r("./08ui/tool/DepthQuery.ts"),a=r("./08ui/tool/Tool.ts"),s=r("./glMatrix.js"),o=r("./99api/utils/measure.ts"),l=r("./00utility/Environment.ts");class d extends a.default{constructor(e,t){super(e,!0,t),this._vertices=[],this._lines=[],this._subLines=[],this._snapCoord=[0,0],this._depthQuery=new n.default(this._scene,this._resourceManager),this._rtLine=this._getRenderTarget({depthTest:!1}),this._clippingEnabled=this._scene.clipping.isEnabled(),this._snappingEnabled=!l.Environment.isMobile,this._snapping=null,this._lineColor=[.969,.398,.238],this._clicks=0,this._finished=!1,this._smartCullingEnabled=!1,this._unit="m",this._scaling=.3048,this._lastEventName="",this._lastEventObject=null,this._lastAnchorUpdates=[];t.getCanvas();this._overlays=Object(o.createOverlays)(),this._mouseAnchor=Object(o.createAnchorPoint)("#f75223"),this._anchorPoints=[Object(o.createAnchorPoint)(),Object(o.createAnchorPoint)(),Object(o.createAnchorPoint)()],this._anchorValues=[Object(o.createAnchorValue)(),Object(o.createAnchorValue)(),Object(o.createAnchorValue)()],this._overlays.appendChild(this._mouseAnchor)}doesSupportMobile(e){return!0}doesSupport3D(e){return!0}destroy(){this._rtLine=null,delete this._rtLine;for(let e=0;e<this._lines.length;e++)this._lines[e].destroy();this._lines=null,delete this._lines;for(let e=0;e<this._subLines.length;e++)this._subLines[e].destroy();this._subLines=null,delete this._subLines,this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery,this._vertices=null,delete this._vertices,this._overlays.remove(),this._overlays=null,delete this._overlays,this._anchorPoints=null,delete this._anchorPoints,this._anchorValues=null,delete this._anchorValues,this._mouseAnchor=null,delete this._mouseAnchor,this._lastEventObject=null,delete this._lastEventObject,this._lastAnchorUpdates=null,delete this._lastAnchorUpdates}resize(e,t){this._rtLine.resize(e,t),this._snapping&&this._snapping.resize(e,t)}_reset(){for(let e=0;e<this._lines.length;e++)this._lines[e]._drawable.mesh.destroy(),this._lines[e].destroy();this._lines=[],this._vertices=[],this._clicks=0,this._finished=!1,this._notifyResult("Measure-Update",{distance:0,x:0,y:0,z:0,angle:0,area:0})}_recompileShader(){if(this._scene.clipping.isEnabled()!==this._clippingEnabled){this._clippingEnabled=this._scene.clipping.isEnabled();let e=[];i.Config.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this._depthQuery.recompileShader(this._resourceManager,e),this._snapping&&this._snapping.recompileShader(this._resourceManager,e)}}_updateMouseAnchor(e){Object(o.updateAnchorPoint)(this._mouseAnchor,e)}_hideMouseAnchor(){Object(o.updateAnchorPoint)(this._mouseAnchor,null)}_updateAnchorPoints(e=[]){if(e.length>this._anchorPoints.length){const e=Object(o.createAnchorPoint)();this._overlays.appendChild(e),this._anchorPoints.push(e)}this._anchorPoints.forEach((t,r)=>{e[r]?Object(o.updateAnchorPoint)(t,{pos:e[r]}):Object(o.updateAnchorPoint)(t,null)})}_hideAnchorPoints(){this._anchorPoints.forEach(e=>{Object(o.updateAnchorPoint)(e,null)})}_updateAnchorValues(e=[]){this._anchorValues.forEach((t,r)=>{e[r]&&Object(o.updateAnchorValue)(t,e[r])});const t=e.filter(e=>!!e.value).map(e=>({value:e.value}));t.length>0&&(this._lastAnchorUpdates=t)}_hideAnchorValues(){this._anchorValues.forEach(e=>{Object(o.updateAnchorValue)(e,null)})}_updateSnapping(){this._snapping&&this._snapping.update(this._renderer,this._scene,this._camera)}_projectLineSegmentToScreen(e,t,r,i){let n=this._camera.getViewDirection(),a=-s.vec3.dot(n,this._camera.eye);s.vec3.copy(r,e),s.vec3.copy(i,t);let o=s.vec3.dot(r,n)+a,l=s.vec3.dot(i,n)+a,d=s.vec3.create();if(o>0||l>0){if(o<0){s.vec3.subtract(d,r,i);let e=(.001-a-s.vec3.dot(i,n))/s.vec3.dot(d,n);s.vec3.scaleAndAdd(r,i,d,e)}if(l<0){s.vec3.subtract(d,i,r);let e=(.001-a-s.vec3.dot(r,n))/s.vec3.dot(d,n);s.vec3.scaleAndAdd(i,r,d,e)}let e=this._camera.project(r);r[0]=e[0],r[1]=e[1];let t=this._camera.project(i);return i[0]=t[0],i[1]=t[1],!0}return!1}setSnappingEnabled(e){e&&l.Environment.isMobile?console.warn("Sanpping is not support on mobile."):this._snappingEnabled=e}setEnabled(e){this._enabled=e,this._enabled?(l.Environment.isMobile?this._snapping=null:this._snapping=this._viewer.getSnapping(),this._camera.addUpdateStopListener(this._updateSnapping.bind(this)),this._recompileShader(),this._camera.setBimCullingEnabled(!1),this._updateSnapping()):(this._camera.removeUpdateStopListener(this._updateSnapping.bind(this)),this._reset()),e?(this._smartCullingEnabled=this._viewer.isSmartCullingEnabled(),this._viewer.setSmartCullingEnabled(!1),this._viewer.getCanvas().insertAdjacentElement("afterend",this._overlays),[...this._anchorPoints,...this._anchorValues].forEach(e=>{this._overlays.appendChild(e)})):(this._viewer.setSmartCullingEnabled(this._smartCullingEnabled),this._overlays.remove(),[...this._anchorPoints,...this._anchorValues].forEach(e=>{e.remove()}))}setLineColor(e){this._lineColor[0]=e[0],this._lineColor[1]=e[1],this._lineColor[2]=e[2]}addInput(e){"mouse"===e.name?(e.addMouseDownListener(this._onMouseDown.bind(this)),e.addMouseWheelListener(this._onMouseWheel.bind(this)),e.addMouseMoveListener(this._onMouseMove.bind(this)),e.addMouseUpListener(this._onMouseUp.bind(this))):"touch"===e.name?(e.addTouchMoveListener(this._onTouchMove.bind(this)),e.addTouchStopListener(this._onTouchStop.bind(this)),e.addTouchStartListener(this._onTouchStart.bind(this))):"keyboard"===e.name&&e.addKeyUpListener(this._onKeyUp.bind(this))}setUnit(e){const t=e!==this._unit;let r=this._scaling;switch(e){case"m":this._unit="m",this._scaling=.3048;break;case"cm":this._unit="cm",this._scaling=30.48;break;case"feet":this._unit="feet",this._scaling=1;break;case"inches":this._unit="inches",this._scaling=12;break;default:console.log('Unsupported length unit! Please use either "feet", "inches", "cm" or "m"')}if(t&&""!==this._lastEventName){const e=this._scaling/r;let t=this._lastEventObject;t.distance&&(t.distance*=e,t.distance=t.distance.toFixed(2)),t.x&&(t.x*=e,t.x=t.x.toFixed(2)),t.y&&(t.y*=e,t.y=t.y.toFixed(2)),t.z&&(t.z*=e,t.z=t.z.toFixed(2)),this._viewer.getEventEmitter().emit(this._lastEventName,t),this._anchorValues.forEach((t,r)=>{if(this._lastAnchorUpdates[r]){const i=this._lastAnchorUpdates[r];i.value&&(i.value*=e,i.value=i.value.toFixed(2)),Object(o.updateAnchorValue)(t,i)}})}}getUnit(){return this._unit}_convertArea(e){return e*(this._scaling*this._scaling)}_convertLength(e){return e*this._scaling}_onKeyUp(e){return!1}_onMouseDown(e){return this._recompileShader(),!1}_onMouseWheel(e){return this._enabled,!1}_onMouseMove(e){return!1}_onMouseUp(e){return!1}_onTouchStart(e){return!1}_onTouchMove(e){return!1}_onTouchStop(e){return!1}_notifyResult(e,t){this._viewer.getEventEmitter().emit(e,t),this._lastEventName=e,this._lastEventObject=t}}},"./08ui/tool/MeasureAngle.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./08ui/tool/m3d_line.js"),n=r("./08ui/tool/Measure.ts"),a=r("./08ui/tool/Snapping.ts"),s=r("./99api/utils/measure.ts"),o=r("./glMatrix.js");let l=[0,0],d=[0,0];class u extends n.default{constructor(e){super("MeasureAngle",e),this._angle=0,this._radians=!1}destory(){super.destroy()}setEnabled(e){super.setEnabled(e)}_onMouseWheel(e){return!!this._enabled&&(this._clicks>0&&3!==this._clicks&&o.vec3.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1)}getAngle(){return this._angle}_onMouseMove(e){if(!this._enabled)return!1;if(super._onMouseMove(e),e.pressed)return this._clicks>0&&3!==this._clicks&&o.vec3.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1;if(e.moved){let t=e.x,r=e.y;if(this._snappingEnabled){if(this._snapCoord[0]=t,this._snapCoord[1]=r,!e.pressed&&!this._camera.updated){const e=this._snapping.snap(this._snapCoord);this._updateMouseAnchor({pos:this._snapCoord,isSnapped:e!==a.SnappingMode.NONE})}t=this._snapCoord[0],r=this._snapCoord[1]}let i=this._camera.unproject(t,r);this._vertices.length>0&&this._clicks<3&&o.vec3.copy(this._vertices[this._vertices.length-1],i)}return this._viewer.invalidate(),!0}_onMouseUp(e){if(!this._enabled||e.moved)return!1;if(super._onMouseUp(e),e.button===e.RIGHT_BUTTON)return this._angle=0,this._reset(),!1;var t=this._clicks;this._clicks=this._clicks%3+1;let r=e.x,i=e.y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);let n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks=t,!1)}_onTouchStop(e){if(!this._enabled||1!==e.numCursors)return!1;if(Math.abs(e.cursor(0).dx)>1e-4||Math.abs(e.cursor(0).dy)>1e-4)return!1;super._onTouchStop(e);var t=this._clicks;this._clicks=this._clicks%3+1;let r=e.cursor(0).x,i=e.cursor(0).y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);let n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks=t,!1)}_updateLines(e,t,r){if(1===this._clicks)this._reset(),this._vertices.push(o.vec3.clone(r)),this._vertices.push(o.vec3.clone(r)),this._lines.push(new i.default("measure-angle-"+this._lines.length,this._resourceManager,this._lineColor,!1)),this._clicks=1,this._viewer.getEventEmitter().emit("Measure-Update",{angle:0});else if(o.vec3.copy(this._vertices[this._vertices.length-1],r),this._vertices.length<3&&(this._vertices.push(o.vec3.clone(r)),this._lines.push(new i.default("measure-angle-"+this._lines.length,this._resourceManager,this._lineColor,!1))),3===this._clicks){let e=o.vec3.create(),t=o.vec3.create();o.vec3.sub(e,this._vertices[0],this._vertices[1]),o.vec3.sub(t,this._vertices[2],this._vertices[1]),this._angle=o.vec3.angle(e,t);const r=this._radians?this._angle:this._angle/Math.PI*180;this._viewer.getEventEmitter().emit("Measure-Update",{angle:r}),this._updateAnchorValues([{value:`${r.toFixed(2)}${this._radians?"":"°"}`,color:"red"}]);let n=o.vec3.length(e),a=o.vec3.length(t),s=Math.min(n,a);o.vec3.lerp(e,this._vertices[1],this._vertices[0],.1*s/n),o.vec3.lerp(t,this._vertices[1],this._vertices[2],.1*s/a),this._vertices.push(t),this._vertices.push(e),this._lines.push(new i.default("measure-angle-"+this._lines.length,this._resourceManager,this._lineColor,!1)),this._lines.push(new i.default("measure-angle-"+this._lines.length,this._resourceManager,this._lineColor,!1))}}render(){if(!this._enabled)return;for(let e=0;e<this._lines.length;e++){let t=this._vertices[e],r=this._vertices[e+1];this._projectLineSegmentToScreen(t,r,l,d)&&(this._lines[e].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[e].render(this._rtLine,this._renderer,this._camera))}let e=[];var t=this._vertices.length-1;3===this._clicks&&(t=3);for(let r=0;r<t;++r)e.push(this._camera.project(this._vertices[r]));this._updateAnchorPoints(e),3===e.length?this._updateAnchorValues([{pos:Object(s.getCenterPoint)(l,d)}]):this._hideAnchorValues()}useRadians(e){if(this._radians!==e){const t=e?this._angle:this._angle/Math.PI*180;this._updateAnchorValues([{value:`${t.toFixed(2)}${this._radians?"":"°"}`,color:"red"}]),this._viewer.getEventEmitter().emit("Measure-Update",{angle:t})}this._radians=e}isRadians(){return this._radians}}},"./08ui/tool/MeasureArea.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./08ui/tool/m3d_line.js"),n=r("./08ui/tool/Measure.ts"),a=r("./08ui/tool/Snapping.ts"),s=r("./glMatrix.js"),o=r("./99api/utils/measure.ts");let l=[0,0],d=[0,0];class u extends n.default{constructor(e){super("MeasureArea",e),this._area=0,this._subLines.push(new i.default("area_subline_0",this._resourceManager,this._lineColor,!0)),this._subLines.push(new i.default("area_subline_1",this._resourceManager,this._lineColor,!0))}setEnabled(e){super.setEnabled(e)}_onKeyUp(e){if(!this._enabled||this._finished)return!1;27!==e.key&&13!==e.key||(this._vertices.pop(),this._finished=!0)}_onMouseWheel(e){return!!this._enabled&&(this._finished||this._clicks>0&&s.vec3.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1)}_onMouseMove(e){if(!this._enabled)return!1;if(super._onMouseMove(e),e.pressed)return this._finished||this._clicks>0&&s.vec3.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1;if(e.moved){let t=e.x,r=e.y;if(this._snapping){if(this._snapCoord[0]=t,this._snapCoord[1]=r,!e.pressed&&!this._camera.updated){const e=this._snapping.snap(this._snapCoord);this._finished?this._hideMouseAnchor():this._updateMouseAnchor({pos:this._snapCoord,isSnapped:e!==a.SnappingMode.NONE})}t=this._snapCoord[0],r=this._snapCoord[1]}let i=this._camera.unproject(t,r);this._vertices.length>0&&!this._finished&&s.vec3.copy(this._vertices[this._vertices.length-1],i)}return!0}_onMouseUp(e){if(!this._enabled||e.moved)return!1;if(super._onMouseUp(e),e.button===e.RIGHT_BUTTON)return this._reset(),!1;this._finished&&this._reset(),this._clicks++;let t=e.x,r=e.y;this._snapping&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snapping&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLines(t,r,i),!0):(this._clicks--,!1)}_onTouchStop(e){if(!this._enabled||1!==e.numCursors)return!1;if(super._onTouchStop(e),Math.abs(e.cursor(0).dx)>1e-4||Math.abs(e.cursor(0).dy)>1e-4)return!1;this._finished&&this._reset(),this._clicks++;let t=e.cursor(0).x,r=e.cursor(0).y;this._snapping&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snapping&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLines(t,r,i),!0):(this._clicks--,!1)}_updateLines(e,t,r){if(1===this._clicks?this._vertices.push(s.vec3.clone(r)):s.vec3.copy(this._vertices[this._vertices.length-1],r),this._vertices.push(s.vec3.clone(r)),this._lines.push(new i.default("measure-area-"+this._lines.length,this._resourceManager,this._lineColor,!1)),this._lines.length>=3){const e=this._lines.length;let t=s.vec3.create(),r=s.vec3.create(),i=s.vec3.create(),n=s.vec3.create(),a=s.vec3.create();s.vec3.sub(t,this._vertices[1],this._vertices[0]),s.vec3.sub(r,this._vertices[2],this._vertices[1]),s.vec3.cross(a,t,r),s.vec3.normalize(a,a);for(let a=0;a<e;a++)s.vec3.sub(t,this._vertices[(a+1)%e],this._vertices[a%e]),s.vec3.sub(r,this._vertices[(a+2)%e],this._vertices[(a+1)%e]),s.vec3.cross(i,t,r),s.vec3.add(n,n,i);this._area=Math.abs(.5*s.vec3.dot(a,n));const o=this._convertArea(this._area);this._notifyResult("Measure-Update",{area:o}),this._updateAnchorValues([{value:o.toFixed(2),color:"red"}])}}render(){if(!this._enabled)return;if(this._clicks<1)return this._hideAnchorPoints(),void this._hideAnchorValues();const e=this._lines.length,t=Math.max(e,2);for(let r=0;r<e;r++){let e=this._vertices[r%t],i=this._vertices[(r+1)%t];this._projectLineSegmentToScreen(e,i,l,d)&&(this._lines[r].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[r].render(this._rtLine,this._renderer,this._camera))}if(this._clicks>1&&!this._finished){let e=this._vertices[this._vertices.length-1],t=this._vertices[0];this._projectLineSegmentToScreen(t,e,l,d)&&(this._subLines[0].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._subLines[0].render(this._rtLine,this._renderer,this._camera)),t=this._vertices[this._vertices.length-2],this._projectLineSegmentToScreen(t,e,l,d)&&(this._subLines[1].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._subLines[1].render(this._rtLine,this._renderer,this._camera))}let r=[0,0,0],i=[];var n=this._finished?this._vertices.length:this._vertices.length-1;for(let e=0;e<this._vertices.length;++e)r[0]+=this._vertices[e][0],r[1]+=this._vertices[e][1],r[2]+=this._vertices[e][2],i.push(this._camera.project(this._vertices[e]));r[0]/=n,r[1]/=n,r[2]/=n,this._updateAnchorPoints(i.slice(0,i.length-1)),this._updateAnchorValues([{pos:this._camera.project(r)}])}setUnit(e){const t=e!==this._unit;let r=this._scaling;switch(e){case"m":this._unit="m",this._scaling=.3048;break;case"cm":this._unit="cm",this._scaling=30.48;break;case"feet":this._unit="feet",this._scaling=1;break;case"inches":this._unit="inches",this._scaling=12;break;default:console.log('Unsupported length unit! Please use either "feet", "inches", "cm" or "m"')}if(t&&""!==this._lastEventName){const e=this._scaling/r;let t=this._lastEventObject;t.area&&(t.area*=e*e,t.area=t.area.toFixed(2)),this._viewer.getEventEmitter().emit(this._lastEventName,t),this._anchorValues.forEach((t,r)=>{if(this._lastAnchorUpdates[r]){const i=this._lastAnchorUpdates[r];i.value&&(i.value*=e*e,i.value=i.value.toFixed(2)),Object(o.updateAnchorValue)(t,i)}})}}}},"./08ui/tool/MeasureLine.ts":function(e,t,r){"use strict";r.r(t);var i=r("./08ui/tool/m3d_line.js"),n=r("./08ui/tool/Measure.ts"),a=r("./08ui/tool/Snapping.ts"),s=r("./99api/utils/measure.ts"),o=r("./glMatrix.js");let l=[0,0],d=[0,0];t.default=class extends n.default{constructor(e){super("MeasureLine",e),this._perimeter=0}destory(){super.destroy()}setEnabled(e){super.setEnabled(e)}getPerimeter(){return this._perimeter}_onMouseWheel(e){return!!this._enabled&&(this._clicks%2==1&&o.vec3.copy(this._vertices[1],this._vertices[0]),this._hideMouseAnchor(),!1)}_onMouseMove(e){if(!this._enabled)return!1;if(super._onMouseMove(e),e.pressed)return this._clicks%2==1&&o.vec3.copy(this._vertices[1],this._vertices[0]),this._hideMouseAnchor(),!1;if(e.moved){let t=e.x,r=e.y;if(this._snappingEnabled){if(this._snapCoord[0]=t,this._snapCoord[1]=r,!e.pressed&&!this._camera.updated){const e=this._snapping.snap(this._snapCoord);this._updateMouseAnchor({pos:this._snapCoord,isSnapped:e!==a.SnappingMode.NONE})}t=this._snapCoord[0],r=this._snapCoord[1]}if(this._clicks%2==1){let e=this._camera.unproject(t,r);this._vertices.length>0&&o.vec3.copy(this._vertices[1],e)}}return!0}_onMouseUp(e){if(!this._enabled||e.moved)return!1;if(super._onMouseUp(e),e.button===e.RIGHT_BUTTON)return this._perimeter=0,this._reset(),!1;this._clicks++;let t=e.x,r=e.y;this._snappingEnabled&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLine(t,r,i),!0):(this._clicks--,!1)}_updateLine(e,t,r){if(this._clicks%2==0){o.vec3.copy(this._vertices[1],r),this._vertices[2][0]=this._vertices[0][0],this._vertices[2][1]=this._vertices[0][1],this._vertices[2][2]=this._vertices[1][2],this._vertices[3][0]=this._vertices[0][0],this._vertices[3][1]=this._vertices[1][1],this._vertices[3][2]=this._vertices[1][2],this._perimeter=o.vec3.distance(this._vertices[0],this._vertices[1]);const e=this._convertLength(this._vertices[1][0]-this._vertices[0][0]),t=this._convertLength(this._vertices[1][1]-this._vertices[0][1]),i=this._convertLength(this._vertices[1][2]-this._vertices[0][2]);this._notifyResult("Measure-Update",{distance:this._convertLength(this._perimeter),x:e,y:t,z:i}),this._updateAnchorValues([{value:e,color:"red"},{value:t,color:"limegreen"},{value:i,color:"blue"}].map(e=>({value:Math.abs(e.value).toFixed(2),color:e.color})))}else{this._vertices=[];for(var n=0;n<4;n++)this._vertices[n]=o.vec3.clone(r);this._lines[0]=new i.default("line_0",this._resourceManager,this._lineColor,!1),this._lines[1]=new i.default("line_1",this._resourceManager,[0,0,1],!0),this._lines[2]=new i.default("line_2",this._resourceManager,[0,1,0],!0),this._lines[3]=new i.default("line_3",this._resourceManager,[1,0,0],!0),this._notifyResult("Measure-Update",{distance:0,x:0,y:0,z:0})}}_onTouchStop(e){if(!this._enabled||1!==e.numCursors)return!1;if(super._onTouchStop(e),Math.abs(e.cursor(0).dx)>1e-4||Math.abs(e.cursor(0).dy)>1e-4)return!1;this._clicks++;let t=e.cursor(0).x,r=e.cursor(0).y;this._snappingEnabled&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLine(t,r,i),!0):(this._clicks--,!1)}render(){if(!this._enabled)return;if(0===this._vertices.length)return this._hideAnchorPoints(),void this._hideAnchorValues();this._projectLineSegmentToScreen(this._vertices[0],this._vertices[1],l,d)&&(this._lines[0].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[0].render(this._rtLine,this._renderer,this._camera)),this._clicks%2==0&&(this._projectLineSegmentToScreen(this._vertices[0],this._vertices[2],l,d)&&(this._lines[1].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[1].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[2],this._vertices[3],l,d)&&(this._lines[2].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[2].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[3],this._vertices[1],l,d)&&(this._lines[3].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[3].render(this._rtLine,this._renderer,this._camera)));let e=[];var t=this._clicks%2==0?this._vertices.length:1;for(let r=0;r<t;++r)e.push(this._camera.project(this._vertices[r]));this._updateAnchorPoints([e[0],e[1]]),4===e.length?this._updateAnchorValues([{pos:Object(s.getCenterPoint)(e[1],e[3])},{pos:Object(s.getCenterPoint)(e[2],e[3])},{pos:Object(s.getCenterPoint)(e[2],e[0])}]):this._hideAnchorValues()}}},"./08ui/tool/MeasureLineFan.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./08ui/tool/m3d_line.js"),n=r("./08ui/tool/Measure.ts"),a=r("./08ui/tool/Snapping.ts"),s=r("./99api/utils/measure.ts"),o=r("./glMatrix.js");let l=[0,0],d=[0,0];class u extends n.default{constructor(e){super("MeasureLineFan",e),this._perimeter=0}destory(){super.destroy()}setEnabled(e){super.setEnabled(e)}getPerimeter(){return this._perimeter}_onKeyUp(e){if(!this._enabled||this._finished)return!1;27!==e.key&&13!==e.key||(o.vec3.copy(this._vertices[2],this._vertices[0]),this._finished=!0)}_onMouseWheel(e){return!!this._enabled&&(this._clicks>0&&o.vec3.copy(this._vertices[2],this._vertices[0]),this._hideMouseAnchor(),!1)}_onMouseMove(e){if(!this._enabled)return!1;if(super._onMouseMove(e),e.pressed)return this._clicks>0&&o.vec3.copy(this._vertices[2],this._vertices[0]),this._hideMouseAnchor(),!1;if(e.moved){let t=e.x,r=e.y;if(this._snappingEnabled){if(this._snapCoord[0]=t,this._snapCoord[1]=r,!e.pressed&&!this._camera.updated){const e=this._snapping.snap(this._snapCoord);this._finished?this._hideMouseAnchor():this._updateMouseAnchor({pos:this._snapCoord,isSnapped:e!==a.SnappingMode.NONE})}t=this._snapCoord[0],r=this._snapCoord[1]}let i=this._camera.unproject(t,r);this._vertices.length>0&&!this._finished&&o.vec3.copy(this._vertices[2],i)}return this._viewer.invalidate(),!0}_onMouseUp(e){if(!this._enabled||e.moved)return!1;if(super._onMouseUp(e),e.button===e.RIGHT_BUTTON)return this._perimeter=0,this._reset(),!1;this._finished&&this._reset(),this._clicks++;let t=e.x,r=e.y;this._snappingEnabled&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLines(t,r,i),!0):(this._clicks--,!1)}_onTouchStop(e){if(!this._enabled||1!==e.numCursors)return!1;if(super._onTouchStop(e),Math.abs(e.cursor(0).dx)>1e-4||Math.abs(e.cursor(0).dy)>1e-4)return!1;this._finished&&this._reset(),this._clicks++;let t=e.cursor(0).x,r=e.cursor(0).y;this._snappingEnabled&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLines(t,r,i),!0):(this._clicks--,!1)}_updateLines(e,t,r){if(1===this._clicks){for(var n=0;n<5;n++)this._vertices.push(o.vec3.clone(r));this._lines[0]=new i.default("measure-linefan-0",this._resourceManager,this._lineColor,!1),this._lines[1]=new i.default("measure-linefan-1",this._resourceManager,this._lineColor,!1),this._lines[2]=new i.default("measure-linefan-x",this._resourceManager,[0,0,1],!0),this._lines[3]=new i.default("measure-linefan-y",this._resourceManager,[0,1,0],!0),this._lines[4]=new i.default("measure-linefan-z",this._resourceManager,[1,0,0],!0)}else{o.vec3.copy(this._vertices[1],r),o.vec3.copy(this._vertices[2],r),this._vertices[3][0]=this._vertices[0][0],this._vertices[3][1]=this._vertices[0][1],this._vertices[3][2]=this._vertices[1][2],this._vertices[4][0]=this._vertices[0][0],this._vertices[4][1]=this._vertices[1][1],this._vertices[4][2]=this._vertices[1][2],this._perimeter=o.vec3.distance(this._vertices[0],this._vertices[1]);this._vertices[1][0],this._vertices[0][0];const e=this._vertices[1][1]-this._vertices[0][1],t=this._vertices[1][2]-this._vertices[0][2],[i,n,a]=[t,e,t].map(e=>this._convertLength(e));this._notifyResult("Measure-Update",{x:i,y:n,z:a,distance:this._convertLength(this._perimeter)}),this._updateAnchorValues([{value:i,color:"red"},{value:n,color:"limegreen"},{value:a,color:"blue"}].map(e=>({value:Math.abs(e.value).toFixed(2),color:e.color})))}}render(){if(!this._enabled)return;if(0===this._vertices.length)return this._hideAnchorPoints(),void this._hideAnchorValues();this._projectLineSegmentToScreen(this._vertices[0],this._vertices[1],l,d)&&(this._lines[0].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[0].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[0],this._vertices[2],l,d)&&(this._lines[1].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[1].render(this._rtLine,this._renderer,this._camera)),this._clicks>1&&(this._projectLineSegmentToScreen(this._vertices[0],this._vertices[3],l,d)&&(this._lines[2].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[2].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[3],this._vertices[4],l,d)&&(this._lines[3].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[3].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[4],this._vertices[1],l,d)&&(this._lines[4].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[4].render(this._rtLine,this._renderer,this._camera)));let e=[];var t=this._clicks>1?this._vertices.length:1;for(let r=0;r<t;++r)2!==r&&e.push(this._camera.project(this._vertices[r]));this._updateAnchorPoints([e[0],e[1]]),4===e.length&&this._updateAnchorValues([{pos:Object(s.getCenterPoint)(e[1],e[3])},{pos:Object(s.getCenterPoint)(e[2],e[3])},{pos:Object(s.getCenterPoint)(e[2],e[0])}])}}},"./08ui/tool/MeasureLineStrip.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./08ui/tool/m3d_line.js"),n=r("./08ui/tool/Measure.ts"),a=r("./08ui/tool/Snapping.ts"),s=r("./99api/utils/measure.ts"),o=r("./glMatrix.js");let l=[0,0],d=[0,0];class u extends n.default{constructor(e){super("MeasureLineStrip",e),this._perimeter=0}destory(){super.destroy()}setEnabled(e){super.setEnabled(e)}getPerimeter(){return this._perimeter}_onKeyUp(e){if(!this._enabled||this._finished)return!1;27!==e.key&&13!==e.key||(this._vertices.pop(),this._lines.pop(),this._finished=!0)}_onMouseWheel(e){return!!this._enabled&&(this._finished||this._clicks>0&&o.vec3.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1)}_onMouseMove(e){if(!this._enabled)return!1;if(super._onMouseMove(e),e.pressed)return this._finished||this._clicks>0&&o.vec3.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1;if(e.moved){let t=e.x,r=e.y;if(this._snappingEnabled){if(this._snapCoord[0]=t,this._snapCoord[1]=r,!e.pressed&&!this._camera.updated){const e=this._snapping.snap(this._snapCoord);this._finished?this._hideMouseAnchor():this._updateMouseAnchor({pos:this._snapCoord,isSnapped:e!==a.SnappingMode.NONE})}t=this._snapCoord[0],r=this._snapCoord[1]}let i=this._camera.unproject(t,r);this._vertices.length>0&&!this._finished&&o.vec3.copy(this._vertices[this._vertices.length-1],i)}return this._viewer.invalidate(),!0}_onMouseUp(e){if(!this._enabled||e.moved)return!1;if(super._onMouseUp(e),e.button===e.RIGHT_BUTTON)return this._perimeter=0,this._reset(),!1;this._finished&&this._reset(),this._clicks++;let t=e.x,r=e.y;this._snappingEnabled&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLines(t,r,i),!0):(this._clicks--,!1)}_onTouchStop(e){if(!this._enabled||1!==e.numCursors)return!1;if(super._onTouchStop(e),Math.abs(e.cursor(0).dx)>1e-4||Math.abs(e.cursor(0).dy)>1e-4)return!1;this._finished&&this._reset(),this._clicks++;let t=e.cursor(0).x,r=e.cursor(0).y;this._snappingEnabled&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLines(t,r,i),!0):(this._clicks--,!1)}_updateLines(e,t,r){if(this._lines.push(new i.default("measure-linestrip-"+this._lines.length,this._resourceManager,this._lineColor,!1)),1===this._clicks)this._vertices.push(o.vec3.clone(r)),this._vertices.push(o.vec3.clone(r));else{o.vec3.copy(this._vertices[this._vertices.length-1],r),this._vertices.push(o.vec3.clone(r)),this._perimeter=0;for(let e=0;e<this._vertices.length-1;e++)this._perimeter+=o.vec3.distance(this._vertices[e],this._vertices[e+1]);const e=this._convertLength(this._perimeter);this._notifyResult("Measure-Update",{distance:e}),this._updateAnchorValues([{value:e.toFixed(2),color:"red"}])}}render(){if(!this._enabled)return;for(let e=0;e<this._lines.length;e++){let t=this._vertices[e],r=this._vertices[e+1];this._projectLineSegmentToScreen(t,r,l,d)&&(this._lines[e].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[e].render(this._rtLine,this._renderer,this._camera))}let e=[];for(let t=0;t<this._vertices.length;++t)e.push(this._camera.project(this._vertices[t]));this._finished||e.pop(),this._updateAnchorPoints(e),e.length>=2?this._updateAnchorValues([{pos:Object(s.getCenterPoint)(e[e.length-2],e[e.length-1])}]):this._hideAnchorValues()}}},"./08ui/tool/MeasureLines.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./08ui/tool/m3d_line.js"),n=r("./08ui/tool/Measure.ts"),a=r("./08ui/tool/Snapping.ts"),s=r("./99api/utils/measure.ts"),o=r("./glMatrix.js");let l=[0,0],d=[0,0];class u extends n.default{constructor(e){super("MeasureLines",e),this._perimeter=0}destory(){super.destroy()}setEnabled(e){super.setEnabled(e)}getPerimeter(){return this._perimeter}_onKeyUp(e){if(!this._enabled||this._finished)return!1;27!==e.key&&13!==e.key||(this._clicks%2==1&&(this._vertices.pop(),this._lines.pop()),this._finished=!0)}_onMouseWheel(e){return!!this._enabled&&(this._finished||this._clicks%2==1&&o.vec3.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1)}_onMouseMove(e){if(!this._enabled)return!1;if(super._onMouseMove(e),e.pressed)return this._finished||this._clicks%2==1&&o.vec3.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1;if(e.moved){let t=e.x,r=e.y;if(this._snappingEnabled){if(this._snapCoord[0]=t,this._snapCoord[1]=r,!e.pressed&&!this._camera.updated){const e=this._snapping.snap(this._snapCoord);this._finished?this._hideMouseAnchor():this._updateMouseAnchor({pos:this._snapCoord,isSnapped:e!==a.SnappingMode.NONE})}t=this._snapCoord[0],r=this._snapCoord[1]}if(this._clicks%2==1){let e=this._camera.unproject(t,r);this._vertices.length>0&&!this._finished&&o.vec3.copy(this._vertices[this._vertices.length-1],e)}}return this._viewer.invalidate(),!0}_onMouseUp(e){if(!this._enabled||e.moved)return!1;if(super._onMouseUp(e),e.button===e.RIGHT_BUTTON)return this._perimeter=0,this._reset(),!1;this._finished&&this._reset(),this._clicks++;let t=e.x,r=e.y;this._snappingEnabled&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLines(t,r,i),!0):(this._clicks--,!1)}_onTouchStop(e){if(!this._enabled||1!==e.numCursors)return!1;if(super._onTouchStop(e),Math.abs(e.cursor(0).dx)>1e-4||Math.abs(e.cursor(0).dy)>1e-4)return!1;this._finished&&this._reset(),this._clicks++;let t=e.cursor(0).x,r=e.cursor(0).y;this._snappingEnabled&&(t=this._snapCoord[0],r=this._snapCoord[1]);let i=this._depthQuery.unproject(t,r,this._renderer,this._camera);return i?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,i),this._updateLines(t,r,i),!0):(this._clicks--,!1)}_updateLines(e,t,r){if(this._clicks%2==0){o.vec3.copy(this._vertices[this._vertices.length-1],r),this._perimeter=0;for(let e=0;e<this._vertices.length;e+=2)this._perimeter+=o.vec3.distance(this._vertices[e],this._vertices[e+1]);const e=this._convertLength(this._perimeter);this._notifyResult("Measure-Update",{distance:e}),this._updateAnchorValues([{value:e.toFixed(2),color:"red"}])}else this._vertices.push(o.vec3.clone(r)),this._vertices.push(o.vec3.clone(r)),this._lines.push(new i.default("measure-lines-"+this._lines.length,this._resourceManager,this._lineColor,!1))}render(){if(!this._enabled)return;for(let e=0;e<this._lines.length;e++){let t=this._vertices[2*e],r=this._vertices[2*e+1];this._projectLineSegmentToScreen(t,r,l,d)&&(this._lines[e].updateVertices(l[0],l[1],d[0],d[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[e].render(this._rtLine,this._renderer,this._camera))}let e=[];for(let t=0;t<this._vertices.length;++t)e.push(this._camera.project(this._vertices[t]));this._finished||this._clicks%2!=1||e.pop(),this._updateAnchorPoints(e),e.length>0&&e.length%2==0?this._updateAnchorValues([{pos:Object(s.getCenterPoint)(e[e.length-2],e[e.length-1])}]):this._hideAnchorValues()}}},"./08ui/tool/PickQuery.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return l});var i=r("./00utility/Environment.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/camera/m3d_base_camera.js"),s=r("./04renderer/pipeline/RenderTarget.ts"),o=r("./glMatrix.js");class l{constructor(e,t){this._scene=e,this._material=null,this._shaders=[null,null,null],this._ready=!1,this._renderTarget=null,this._phonyCamera=new a.default([0,0,1,1]),this._pickMatrix=o.mat4.create(),this._gl=t.gl,this._material=e.materialManager.createMaterialAdhoc("pick-query"),this.recompileShader(t,[]),this._renderTarget=new s.default("query",t,5,5,{clearColor:[0,0,0,0]}),this._ready=this._renderTarget.ready}destroy(){this._ready&&(this._material.destroy(),this._material=null,delete this._material,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget)}_beginRegion(e,t,r,i,n,a){t=n.viewport[3]-1-t,i=n.viewport[3]-1-i;var s=Math.abs(r-e)+1,l=Math.abs(i-t)+1;s==this._renderTarget.getWidth()&&l==this._renderTarget.getHeight()||this._renderTarget.resize(s,l),this._pickMatrix[0]=n.viewport[2]/s,this._pickMatrix[5]=n.viewport[3]/l,this._pickMatrix[12]=(n.viewport[2]-e-r)/s,this._pickMatrix[13]=(n.viewport[3]-t-i)/l,o.mat4.multiply(this._phonyCamera.vpMatrix,this._pickMatrix,n.vpMatrix),this._phonyCamera.viewport[0]=n.viewport[0],this._phonyCamera.viewport[1]=n.viewport[1],this._phonyCamera.viewport[2]=s,this._phonyCamera.viewport[3]=l}_endRegion(e,t){const r=this._gl;var i=[],n=new Uint8Array(e*t*4);r.readPixels(0,0,e,t,r.RGBA,r.UNSIGNED_BYTE,n);for(var a={},s=0;s<t;s+=2)for(var o=0;o<e;o+=2){var l=4*(s*e+o),d=n[l]+256*n[l+1]+256*n[l+2]*256+256*n[l+3]*256*256;d>0&&(a[d-=1]||(i.push(d),a[d]=1))}return i}_changeMaterial(e,t){e+=1;var r=[0,0,0];r[0]=(.49+(255&e))/255,r[1]=(.49+(e>>8&255))/255,r[2]=(.49+(e>>16&255))/255;var i=(.49+(e>>24&255))/255;t.setDiffuse(r),t.setTransparent(i)}pickModel(e,t,r,i){for(var n=0,a=this._scene.models.length;n<a;n++)if(this.pickDrawable(e,t,r,i,this._scene.models[n].drawables))return n;return-1}pickDrawable(e,t,r,n,a){e=Math.floor(e*i.Environment.devicePixelRatio),t=Math.floor(t*i.Environment.devicePixelRatio),this._scene.clipping.isEnabled()&&r.renderState.invalidateClip();const s=this._gl;this._beginRegion(e,t,e,t,n,r),r.clear(this._renderTarget,s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),r.drawDrawablesCustom(this._renderTarget,a,this._phonyCamera,this._shaders,this._material,this._scene.clipping,this._scene.needRenderDoubleSided(),this._changeMaterial);var o=this._endRegion(1,1);return 0===o.length?null:a[o[0]]}pickNodesInsideRegion(e,t,r,n,a,s,o){if(!this._ready)return null;e=Math.floor(e*i.Environment.devicePixelRatio),t=Math.floor(t*i.Environment.devicePixelRatio),r=Math.floor(r*i.Environment.devicePixelRatio),n=Math.floor(n*i.Environment.devicePixelRatio),this._scene.clipping.isEnabled()&&a.renderState.invalidateClip();const l=this._gl;this._beginRegion(e,t,r,n,s,a),a.clear(this._renderTarget,l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),a.drawDrawablesCustom(this._renderTarget,o,this._phonyCamera,this._shaders,this._material,this._scene.clipping,this._scene.needRenderDoubleSided(),this._changeMaterial);var d=this._endRegion(r-e+1,n-t+1),u=[];d.forEach(function(e){o[e].nodes&&o[e].nodes.forEach(function(e){e.visible&&u.push(e)})}),a.clear(this._renderTarget,l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),a.drawNodesCustom(this._renderTarget,u,this._phonyCamera,this._shaders,this._material,this._scene.clipping,this._scene.needRenderDoubleSided(),this._changeMaterial),d=this._endRegion(r-e+1,n-t+1);var c=[];return d.forEach(function(e){c.push(u[e])}),c}recompileShader(e,t){var r=t.slice(0);this._shaders[0]=e.getShader("constant",r),this._shaders[0].ready||this._shaders[0].createFromShaderSource(n.default.constant,r),r.push("MODEL_TRANSFORM"),this._shaders[1]=e.getShader("constant",r),this._shaders[1].ready||this._shaders[1].createFromShaderSource(n.default.constant,r),r.push("INSTANCING"),this._shaders[2]=e.getShader("constant",r),this._shaders[2].ready||this._shaders[2].createFromShaderSource(n.default.constant,r),this._material.attachShader(this._shaders[0]),this._material.setDiffuse(o.vec3.fromValues(0,0,0)),this._material.setTransparent(0)}}},"./08ui/tool/Section.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return v});var i=r("./00utility/m3d_math.js"),n=r("./00utility/Config.ts"),a=r("./00utility/Environment.ts"),s=r("./02resource/MeshAttributes.ts"),o=r("./02resource/m3d_shader_library.js"),l=r("./03scene/drawables/Gizmo.ts"),d=r("./03scene/materials/Material.ts"),u=r("./04renderer/pipeline/RenderTarget.ts"),c=r("./04renderer/pipeline/RenderPass.ts"),h=r("./08ui/tool/Tool.ts"),m=r("./glMatrix.js");class f{constructor(e,t,r,i,n){const a=e.gl;this._gl=a,this.renderTarget=new u.default("section-normal-depth",e,i,n,{colorFormat:a.RGBA32F,clearColor:[0,0,0,0],colorBuffer:0,depthFormat:a.DEPTH24_STENCIL8,depthBuffer:0}),this.buffer=new Float32Array(i*n*4),this.bufferDirty=!0,this.bufferDirtyTime=0,this.normal=m.vec3.create(),this.position=m.vec3.create(),this.nearPlaneSize=null,this.isPerspective=!0,this.inversedViewMatrix=m.mat4.create(),this.renderPass=new c.default(e,t,!1,{line:!1});let s=e.getShader("normaldepth",["WORLDSPACE_NORMAL"]);if(!s.ready){let e=o.default.normaldepth;s.createFromShaderSource(e,["WORLDSPACE_NORMAL"])}this.renderPass.setOverridedShader(s),this.renderPass.setOverridedMaterial(new d.default("section-normal-depth"))}resize(e,t){this.renderTarget.resize(e,t),this.buffer=new Float32Array(e*t*4)}destroy(){this.buffer=null,this.normal=null,this.inversedViewMatrix=null,this.renderTarget.destroy(),this.renderPass.destroy()}render(e,t){const r=this._gl;e.invalidate(),e.clear(this.renderTarget,r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),this.renderPass.render(this.renderTarget,e,t),r.readPixels(0,0,this.renderTarget.getWidth(),this.renderTarget.getHeight(),r.RGBA,r.FLOAT,this.buffer),this.nearPlaneSize=t.getNearPlaneSize(),this.isPerspective=t.isPerspective(),m.mat4.invert(this.inversedViewMatrix,t.viewMatrix)}getNormalDepth(e,t){let r=this.renderTarget.getWidth(),i=this.renderTarget.getHeight(),n=4*(e+(i-t)*r),a=this.buffer[n+3];return 0!==a&&(this.normal[0]=this.buffer[n],this.normal[1]=this.buffer[n+1],this.normal[2]=this.buffer[n+2],!(isNaN(this.normal[0])||isNaN(this.normal[1])||isNaN(this.normal[2]))&&(this.position[2]=a,this.isPerspective?(this.position[0]=2*this.nearPlaneSize[0]*(e/r-.5)*a/this.nearPlaneSize[2],this.position[1]=2*this.nearPlaneSize[1]*((i-1-t)/i-.5)*a/this.nearPlaneSize[2]):(this.position[0]=2*this.nearPlaneSize[0]*(e/r-.5),this.position[1]=2*this.nearPlaneSize[1]*((i-1-t)/i-.5)),m.vec3.transformMat4(this.position,this.position,this.inversedViewMatrix),!0))}}let p=new Uint8Array([0,1,1,2,2,3,3,0,0,4,1,5,2,6,3,7,4,5,5,6,6,7,7,4]);class v extends h.default{constructor(e){super("Section",!0,e),this._cube=null,this._plane=null,this._sensitivity=.005,this._smartCullingEnabled=!1,this._vertices=new Float32Array(24),this._indices=[],this._indices[0]=new Uint16Array([0,4,7,7,3,0]),this._indices[1]=new Uint16Array([0,1,5,5,4,0]),this._indices[2]=new Uint16Array([0,3,2,2,1,0]),this._indices[3]=new Uint16Array([5,1,2,2,6,5]),this._indices[4]=new Uint16Array([6,2,3,3,7,6]),this._indices[5]=new Uint16Array([4,5,6,6,7,4]),this._cubeRT=this._getRenderTarget(),this._planeRT=this._getRenderTarget({depthTest:!1,blend:!0});let t=this._resourceManager.getMesh("wiredcube");t.createWiredCube(),this._cube=new l.default(t,this._resourceManager),this._cube.setColor([.2,.2,.2]),this._cube.setTransparent(1);const r=this._resourceManager.gl;let n=new s.default;n.builtin(r.FLOAT),(t=this._resourceManager.getMesh("cliplane")).create(r.TRIANGLES,n,this._vertices,this._indices[0]),this._plane=new l.default(t,this._resourceManager),this._plane.setColor([.969,.322,.137]),this._plane.setTransparent(.19),this._isPressed=!1,this._planeUpdated=!1,this._gizmoPlaneIndex=null,this._rotate=!1,this._rotateMatrix=m.mat4.create(),this._invertedRotateMatrix=m.mat4.create(),this._bbox=i.default.aabb.create(),this._sectionedBBox=i.default.aabb.create(),this._points=i.default.aabb.points(this._scene.clipping.getBBox());const a=this._viewer.getCamera().core,o=a.viewport[2],d=a.viewport[3];this._normalDepth=new f(this._resourceManager,this._viewer.getRenderScene().getRenderQueueManager(),this._scene,o,d)}destroy(){this._vertices=null,this._indices=null,this._plane.destroy(),this._cube.destroy(),a.Environment.isMobile||this._normalDepth.destroy()}setSectionBox(e){this._sectionedBBox=e,this._updatePoints(),this.updateGeometry(),this._renderer.renderState.invalidateClip(),this._viewer.invalidate()}getModelBox(){return this._bbox}getSectionBox(){return this._sectionedBBox}resize(e,t){this._cubeRT.resize(e,t),this._planeRT.resize(e,t),a.Environment.isMobile||this._normalDepth.resize(e,t)}doesSupportMobile(e){return!0}doesSupport3D(e){return!0}updateGeometry(e){const t=this._resourceManager.gl;this._vertices[0]=this._points[0][0],this._vertices[1]=this._points[0][1],this._vertices[2]=this._points[0][2],this._vertices[3]=this._points[1][0],this._vertices[4]=this._points[1][1],this._vertices[5]=this._points[1][2],this._vertices[6]=this._points[2][0],this._vertices[7]=this._points[2][1],this._vertices[8]=this._points[2][2],this._vertices[9]=this._points[3][0],this._vertices[10]=this._points[3][1],this._vertices[11]=this._points[3][2],this._vertices[12]=this._points[4][0],this._vertices[13]=this._points[4][1],this._vertices[14]=this._points[4][2],this._vertices[15]=this._points[5][0],this._vertices[16]=this._points[5][1],this._vertices[17]=this._points[5][2],this._vertices[18]=this._points[6][0],this._vertices[19]=this._points[6][1],this._vertices[20]=this._points[6][2],this._vertices[21]=this._points[7][0],this._vertices[22]=this._points[7][1],this._vertices[23]=this._points[7][2],this._cube.mesh.update(this._vertices,p,t.UNSIGNED_BYTE),e&&e.renderState.invalidateClip()}render(){if(this._enabled&&this._interactive){const e=this._resourceManager.gl;this._renderer.drawGizmo(this._cubeRT,this._cube,this._camera,e.CCW),this._renderer.clear(this._renderer._renderTarget,e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),null!==this._gizmoPlaneIndex&&this._renderer.drawGizmo(this._planeRT,this._plane,this._camera,e.CCW)}}reset(e){this._rotate=!1,this._updateBBox([0,-1,0]),this._updatePoints(),this.updateGeometry(e),a.Environment.isMobile||(this._normalDepth.bufferDirty=!0),this._viewer.getRenderScene().updateShadow()}setClipRanges(e,t){if(this._scene.clipping.set(e,t),"number"==typeof t[0])this._updateBBox([0,-1,0]);else{this._updateBBox(e[5]);for(let e=0;e<this._points.length;e++)m.vec3.copy(this._points[e],t[e])}for(let e=0;e<this._points.length;e++)m.vec3.transformMat4(this._points[e],this._points[e],this._rotateMatrix);i.default.aabb.createFromPoints(this._sectionedBBox,this._points),this._updatePoints(),this.updateGeometry(),this._gizmoPlaneIndex=null}setEnabled(e){if(this._enabled=e,this._enabled?(this._scene.clipping.initialize(this._scene.bbox),this._updateBBox([0,-1,0]),this._updatePoints(),this.updateGeometry(this._renderer)):this.reset(this._renderer),this._enabled&&this._normalDepth&&!this._normalDepth.renderPass.queue.isValid())for(let e in this._scene.models){this._scene.models[e].drawables.forEach(e=>{this._normalDepth.renderPass.queue.addDrawable(e)})}this._scene.clipping.setEnabled(e),this._viewer.getRenderScene().setClippingEnabled(e),e?(this._smartCullingEnabled=this._viewer.isSmartCullingEnabled(),this._viewer.setSmartCullingEnabled(!1)):this._viewer.setSmartCullingEnabled(this._smartCullingEnabled),e||(this._scene.updateBBox(),this._camera.update());let t=[];this._scene.clipping.isEnabled()&&t.push("CLIPPING"),n.Config.compressNormals&&t.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&t.push("DOUBLESIDED"),this._recompileShader(t)}setRotatable(e){this._rotate=e,e&&(this._gizmoPlaneIndex=null)}isRotatable(){return this._rotate}addInput(e){"mouse"===e.name?(e.addMouseDownListener(this._onMouseDown.bind(this)),e.addMouseWheelListener(this._onMouseWheel.bind(this)),e.addMouseMoveListener(this._onMouseMove.bind(this)),e.addMouseUpListener(this._onMouseUp.bind(this))):"touch"===e.name&&(e.addTouchMoveListener(this._onTouchMove.bind(this)),e.addTouchStartListener(this._onTouchStart.bind(this)))}_onTouchStart(e){if(!this._enabled||!this._interactive||1!==e.numCursors)return!1;let t=e.cursor(0),r=t.x,i=t.y;return this._focusPlane(r,i)}_onTouchMove(e){if(!this._enabled||!this._interactive||1!==e.numCursors)return!1;this._isPressed=!0;let t=e.cursor(0);return this._renderer.renderState.invalidateClip(),this._updatePlane(t.dx)}_onTouchStop(e){return!(!this._enabled||!this._interactive)&&(this._gizmoPlaneIndex=null,this._isPressed=!1,!0)}_onMouseDown(e){return this._enabled&&this._interactive}_onMouseWheel(e){return!!this._enabled&&(this._rotate&&(this._normalDepth.bufferDirty=!0,this._normalDepth.bufferDirtyTime=this._viewer.getElapsedFrames()),!1)}_onMouseMove(e){if(!this._enabled||!this._interactive)return!1;if(this._isPressed=e.pressed,0!==e.getEvent().buttonDown&&e.moved&&this._rotate)return this._normalDepth.bufferDirty=!0,this._normalDepth.bufferDirtyTime=this._viewer.getElapsedFrames(),!1;e.moved&&this._normalDepth.bufferDirty&&!this._camera.updated&&this._normalDepth.bufferDirtyTime<this._viewer.getElapsedFrames()&&(this._normalDepth.render(this._renderer,this._camera),this._normalDepth.bufferDirty=!1);let t=!1;return t=e.pressed?this._updatePlane(e.dx):this._rotate&&!this._normalDepth.bufferDirty?this.updateCube(e,[.5,.5,.5]):this._focusPlane(e.x,e.y),this._renderer.renderState.invalidateClip(),this._viewer.invalidate(),t}_onMouseUp(e){if(!this._enabled||!this._interactive)return!1;if(this._rotate&&!this._normalDepth.bufferDirty){this.updateCube(e,[.2,.2,.2])&&(this._cutByFaceClicked(),this._viewer.getEventEmitter().emit("Section-RotateFacePicked"))}return this._gizmoPlaneIndex=null,this._isPressed=!1,this._renderer.renderState.invalidateClip(),this._viewer.invalidate(),!0}_cutByFaceClicked(){let e=m.vec3.create(),t=m.vec3.create();m.vec3.transformMat4(e,this._normalDepth.normal,this._rotateMatrix),m.vec3.transformMat4(t,t,this._rotateMatrix),m.vec3.sub(e,e,t);let r=i.default.aabb.planes(this._sectionedBBox);for(let t=0;t<6;++t)if(Math.abs(m.vec3.dot(e,r[t])-1)<1e-6){this._gizmoPlaneIndex=t;break}m.vec3.transformMat4(e,this._normalDepth.position,this._rotateMatrix),m.vec3.scaleAndAdd(e,e,r[this._gizmoPlaneIndex],1),this._updatePlane(null,e[2])}updateCube(e,t){let r=this._normalDepth.getNormalDepth(Math.floor(e.x*a.Environment.devicePixelRatio),Math.floor(e.y*a.Environment.devicePixelRatio));return r&&(this._updateBBox(this._normalDepth.normal),this._cube.setColor(t),this.updateGeometry(),this._scene.radius=this._scene.clipping.getRadius(),this._camera._updateProjection()),r}setSensitivity(e){this._sensitivity=e}_updatePlane(e,t){if(null!==this._gizmoPlaneIndex){let r,n,a=this._gizmoPlaneIndex>2?1:0,s=this._gizmoPlaneIndex%3,o=this._gizmoPlaneIndex>2?-1:1,l=2e-5;if(0===a?(n=this._bbox[s]+l,r=this._sectionedBBox[3+s]-l):(n=this._sectionedBBox[s]+l,r=this._bbox[3+s]-l),t)this._sectionedBBox[3*a+s]=i.default.clamp(t,n,r);else{let t=e*this._sensitivity;t*=o*(this._scene.bbox[3+s]-this._scene.bbox[s]),this._sectionedBBox[3*a+s]=i.default.clamp(this._sectionedBBox[3*a+s]+t,n,r)}return this._updatePoints(),this.updateGeometry(),this._plane.mesh.update(this._vertices,this._indices[this._gizmoPlaneIndex]),!0}return!1}_focusPlane(e,t){if(!this._rotate){let r,n,a;this._camera.isPerspective()?(r=m.vec3.create(),m.vec3.copy(r,this._camera.eye),n=this._camera.unproject(e,t)):(r=this._camera.unproject(e,t),n=m.vec3.create(),a=this._camera.getViewDirection(),m.vec3.add(n,r,a)),m.vec3.transformMat4(r,r,this._rotateMatrix),m.vec3.transformMat4(n,n,this._rotateMatrix),(a=[])[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2];let s=i.default.intersect.ray_aabb(r,a,this._sectionedBBox),o=i.default.aabb.planes(this._sectionedBBox);if(null!==s){for(let e=0;e<6;++e)if(Math.abs(m.vec3.dot(s,o[e])+o[e][3])<1e-6)return this._gizmoPlaneIndex!==e&&(this._gizmoPlaneIndex=e,this._plane.mesh.update(this._vertices,this._indices[e]),this._planeUpdated=!0),!0}else this._gizmoPlaneIndex=null}return!1}_updateBBox(e){let t=i.default.aabb.center(this._scene.bbox),r=m.vec3.create();m.vec3.scaleAndAdd(r,t,e,this._scene.radius),Math.abs(e[2])>.9999?m.mat4.lookAt(this._rotateMatrix,r,t,[0,1,0]):m.mat4.lookAt(this._rotateMatrix,r,t,[0,0,1]),m.mat4.invert(this._invertedRotateMatrix,this._rotateMatrix);let a=this._scene.clipping.getBBox();if(n.Config.compressNormals){let e=1e-4;a[0]-=e,a[1]-=e,a[2]-=e,a[3]+=e,a[4]+=e,a[5]+=e}i.default.aabb.points2(a,this._points);for(let e=0,t=this._points.length;e<t;e++)m.vec3.transformMat4(this._points[e],this._points[e],this._rotateMatrix);i.default.aabb.createFromPoints(this._bbox,this._points),i.default.aabb.copy(this._sectionedBBox,this._bbox),this._updatePoints()}_updatePoints(){i.default.aabb.points2(this._sectionedBBox,this._points),m.vec3.transformMat4(this._points[0],this._points[0],this._invertedRotateMatrix),m.vec3.transformMat4(this._points[1],this._points[1],this._invertedRotateMatrix),m.vec3.transformMat4(this._points[2],this._points[2],this._invertedRotateMatrix),m.vec3.transformMat4(this._points[3],this._points[3],this._invertedRotateMatrix),m.vec3.transformMat4(this._points[4],this._points[4],this._invertedRotateMatrix),m.vec3.transformMat4(this._points[5],this._points[5],this._invertedRotateMatrix),m.vec3.transformMat4(this._points[6],this._points[6],this._invertedRotateMatrix),m.vec3.transformMat4(this._points[7],this._points[7],this._invertedRotateMatrix),this._scene.clipping.update(this._points)}_recompileShader(e){e.push("WORLDSPACE_NORMAL"),this._normalDepth&&this._normalDepth.renderPass.recompileOverridedShader(e)}}},"./08ui/tool/SelectElements.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return m});var i=r("./00utility/Environment.ts"),n=r("./00utility/Config.ts"),a=r("./00utility/m3d_math.js"),s=r("./08ui/tool/PickQuery.ts"),o=r("./08ui/tool/DepthQuery.ts"),l=r("./03scene/drawables/Gizmo2D.ts"),d=r("./08ui/tool/Tool.ts"),u=r("./08ui/tool/assets.ts"),c=r("./04renderer/pipeline/RenderQueue.ts"),h=r("./02resource/m3d_shader_library.js");class m extends d.default{constructor(e){super("SelectElement",!0,e),this._dashLength=1,this._lineWidth=1,this._renderScene=e.getRenderScene(),this._multiselect=!1,this._elements={},this._pickQuery=null,this._depthQuery=null,this._regionSelectEnabled=!1,this._interactive=!1,this._closeup=!0,this._highlight=!0,this._bbox=a.default.aabb.create(),this._renderScene=e.getRenderScene(),this._renderTarget=this._getRenderTarget({depthTest:!1}),this._material=this._scene.materialManager.createMaterialAdhoc("select-elements-other"),this._overridedColor=[1,1,1,.4],this._clearselect=!0;let t=[];const r=this._renderScene.getScene();if(r.clipping.isEnabled()&&t.push("CLIPPING"),r.needRenderDoubleSided()&&t.push("DOUBLESIDED"),r.compressed&&t.push("COMPRESSION"),i.Environment.isMobile&&t.push("ENCODE_NORMAL"),t.push("VISIBILITY"),this._shader=this._renderScene.getResourceManager().getShader("solid",t),!this._shader.ready){var n=h.default.solid;this._shader.createFromShaderSource(n,t)}this._smartCullingEnabled=!1,this._startX=-1,this._startY=-1,this._endX=-1,this._endY=-1,this._vertices=new Float32Array(80),this._indices=new Uint8Array(24);for(var s=0;s<4;++s)this._indices[0+6*s]=0+4*s,this._indices[1+6*s]=1+4*s,this._indices[2+6*s]=2+4*s,this._indices[3+6*s]=2+4*s,this._indices[4+6*s]=3+4*s,this._indices[5+6*s]=0+4*s;this._clippingEnabled=this._scene.clipping.isEnabled();const o=this._viewer.getResourceManager().gl,d=this._resourceManager.getMesh("region-select");d.createQuad(),this._drawable=new l.default(d,this._resourceManager),this._drawable.setColor([.969,.398,.238]),this._resourceManager.getTexture("regionSelect").createFromFile(u.DASH_LINE_TEXTURE_IMAGE,o.RGB,o.LINEAR,o.REPEAT,e=>{this._drawable.setTexture(e),this._dashLength=e.width}),this._resetVertices()}destroy(){this._pickQuery&&(this._pickQuery.destroy(),this._pickQuery=null,delete this._pickQuery),this._depthQuery&&(this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery),this._bbox=null,delete this._bbox,this._elements=null,delete this._elements,this._vertices=null,delete this._vertices,this._indices=null,delete this._indices,this._renderScene=null,delete this._renderScene,this._material.destroy(),this._material=null,delete this._material,super.destroy()}doesSupportMobile(e){return!0}doesSupport3D(e){return!0}setSelectionRectangleColor(e){this._drawable.setColor(e),this._drawable.setTransparent(e[3])}setEnabled(e){this._viewer.getMouse();super.setEnabled(e),e&&(null===this._pickQuery&&(this._pickQuery=new s.default(this._scene,this._resourceManager)),null===this._depthQuery&&(this._depthQuery=new o.default(this._scene,this._resourceManager)))}render(){this._enabled&&this._interactive&&(Math.abs(this._endX-this._startX)<2||Math.abs(this._endY-this._startY)<2||this._renderer.drawDrawable(this._renderTarget,this._drawable,this._camera,null,null,null,!1))}addInput(e){"mouse"===e.name?(e.addMouseDownListener(this._onMouseDown.bind(this)),e.addMouseMoveListener(this._onMouseMove.bind(this)),e.addMouseUpListener(this._onMouseUp.bind(this))):"touch"===e.name?(e.addTouchStartListener(this._onTouchStart.bind(this)),e.addTouchMoveListener(this._onTouchMove.bind(this)),e.addTouchStopListener(this._onTouchStop.bind(this))):"keyboard"==e.name&&(e.addKeyDownListener(this._onKeyDown.bind(this)),e.addKeyUpListener(this._onKeyUp.bind(this)))}setRegionSelectEnabled(e){this._regionSelectEnabled!=e&&(this._regionSelectEnabled=e,e?(this._smartCullingEnabled=this._viewer.isSmartCullingEnabled(),this._viewer.setSmartCullingEnabled(!1)):this._viewer.setSmartCullingEnabled(this._smartCullingEnabled),this._interactive=e,this._viewer.invalidate())}setCloseUpEnabled(e){this._closeup=e}setHighlightEnabled(e){this._highlight=e}_onKeyDown(e){return 17==e.key&&this.setMultiselectEnabled(!0),!1}_onKeyUp(e){return 17==e.key&&this.setMultiselectEnabled(!1),!1}_onTouchStart(e){if(!this._enabled||Object.keys(e.cursors).length>1)return!1;if(document.activeElement.blur(),this._startX=e.cursor(0).x,this._startY=e.cursor(0).y,this._endX=this._startX,this._endY=this._startY,this._scene.clipping.isEnabled()&&!this._clippingEnabled){this._clippingEnabled=!0;let e=["VISIBILITY","CLIPPING"];n.Config.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this.recompileShader(e)}else if(!this._scene.clipping.isEnabled()&&!this._clippingEnabled){this._clippingEnabled=!1;let e=["VISIBILITY"];n.Config.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this.recompileShader(e)}return this._regionSelectEnabled&&this._updateVertices(),!1}_onTouchMove(e){return!(!this._enabled||Object.keys(e.cursors).length>1||!this._regionSelectEnabled)&&(!this._regionSelectEnabled||(this._endX+=e.cursor(0).dx,this._endY+=e.cursor(0).dy,this._updateVertices(),!0))}_onTouchStop(e){if(!this._enabled||Object.keys(e.cursors).length>1)return!1;if(this._endX=e.cursor(0).x,this._endY=e.cursor(0).y,Math.abs(e.cursor(0).dx)<=1e-4&&Math.abs(e.cursor(0).dy)<=1e-4)this._select();else if(this._regionSelectEnabled){if(this._startX>this._endX){const e=this._startX;this._startX=this._endX,this._endX=e}if(this._startY>this._endY){const e=this._startY;this._startY=this._endY,this._endY=e}this._selectRegion(),this._resetVertices(),this._viewer.getEventEmitter().emit("SelectElemets-Disabled")}return!0}_onMouseDown(e){if(!this._enabled||e.button!==e.LEFT_BUTTON)return!1;if(document.activeElement.blur(),this._startX=e.x,this._startY=e.y,this._endX=this._startX,this._endY=this._startY,this._scene.clipping.isEnabled()&&!this._clippingEnabled){this._clippingEnabled=!0;let e=["VISIBILITY","CLIPPING"];n.Config.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this.recompileShader(e)}else if(!this._scene.clipping.isEnabled()&&!this._clippingEnabled){this._clippingEnabled=!1;let e=["VISIBILITY"];n.Config.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this.recompileShader(e)}return this._regionSelectEnabled&&this._updateVertices(),!0}_onMouseMove(e){return!!(this._enabled&&e.button===e.LEFT_BUTTON&&e.pressed&&this._regionSelectEnabled)&&(!!this._regionSelectEnabled&&(this._endX+=e.dx,this._endY+=e.dy,this._updateVertices(),!0))}_onMouseUp(e){if(!this._enabled||e.button!==e.LEFT_BUTTON)return!1;if(this._endX=e.x,this._endY=e.y,Math.abs(this._endX-this._startX)<1||Math.abs(this._endY-this._startY)<1)this._select();else if(this._regionSelectEnabled){if(this._startX>this._endX){const e=this._startX;this._startX=this._endX,this._endX=e}if(this._startY>this._endY){const e=this._startY;this._startY=this._endY,this._endY=e}this._selectRegion(),this._resetVertices(),this._viewer.getEventEmitter().emit("onRegionSelectFinished")}return!0}setMultiselectEnabled(e){this._multiselect=e}setClearselectEnabled(e){this._clearselect=e}recompileShader(e){this._enabled&&(this._pickQuery&&this._pickQuery.recompileShader(this._resourceManager,e),this._depthQuery&&this._depthQuery.recompileShader(this._resourceManager,e))}_select(){const e=this._endX,t=this._endY;this._viewer.invalidate();var r=this._pickQuery.pickNodesInsideRegion(e,t,e,t,this._renderer,this._camera,this._getPickables()),i=null,n=null;if(r&&r.length>0&&(n=(i=r[0].getElement()).model.name+"+"+i.getDocument().id+"/"+i.id,this._viewer.getEventEmitter().emit("onPointPicked",[...this._depthQuery.unproject(this._endX,this._endY,this._renderer,this._camera).slice(0,3)])),i)this._multiselect?this._elements[n]?delete this._elements[n]:this._elements[n]=i:(this._elements={},this._elements[n]=i,this._closeup&&this._camera.lookTo(a.default.aabb.center(i.bbox),a.default.aabb.length(i.bbox)/2)),this._highlight&&(this._highlightELements(Object.keys(this._elements)),this._viewer.invalidate());else{if(!this._clearselect)return;this._multiselect||(this._elements={},this._highlight&&(this._viewer.invalidate(),this._highlightELements(null)))}this._viewer.getEventEmitter().emit("onElementSelected",Object.keys(this._elements))}_getPickables(){if(!this._pickables){let e=new c.default("pickQueue",{line:!1});for(let t in this._scene.models)this._scene.models[t].drawables.forEach(t=>{e.addDrawable(t)});this._pickables=e.drawables}return this._pickables}_selectRegion(){let e={};this._viewer.invalidate();var t=this._pickQuery.pickNodesInsideRegion(this._startX,this._startY,this._endX,this._endY,this._renderer,this._camera,this._getPickables());if(null!==t&&t.length>0){t.forEach(t=>{var r=t.getElement(),i=r.model.name+"+"+r.getDocument().id+"/"+r.id;e[i]||(e[i]=r)});var r=a.default.aabb.create();for(let i in e)t=t.concat(e[i].getNodes()),a.default.aabb.union(r,r,e[i].bbox);this._closeup&&this._camera.lookTo(a.default.aabb.center(r),a.default.aabb.length(r)/2),this._elements=e,this._highlight&&this._highlightELements(Object.keys(this._elements))}else this._elements={},this._highlight&&this._highlightELements(null);this._highlight&&this._viewer.invalidate();let i=Object.keys(this._elements);this._viewer.getEventEmitter().emit("onElementSelected",i)}_highlightELements(e){e?(this._renderScene.setOverridedMaterials(this._material),this._renderScene.setOverridedShaders(this._shader),this._material.setDiffuse(this._overridedColor),this._material.setTransparent(this._overridedColor[3]),this._renderScene.renderElements(e,!0)):(this._renderScene.setOverridedMaterials(null),this._renderScene.setOverridedShaders(null),this._renderScene.renderElements(null))}pick(e,t){if(this._enabled){if(!e||e.length<1)return this._elements={},void(this._highlight&&(this._highlightELements(null),this._viewer.invalidate()));for(let t=0,r=e.length;t<r;t++){const r=e[t],i=r.split("+")[0];const n=this._scene.models[i].tree.elements[r];n?this._elements[r]=n:console.warn("Element: "+r+" can not be found!")}if(this._highlight&&(this._highlightELements(e),this._viewer.invalidate()),t){this._bbox=new a.default.aabb.createFromArray([1/0,1/0,1/0,-1/0,-1/0,-1/0]);var r=!1;e.forEach(e=>{const t=e.split("+")[0];const i=this._scene.models[t].tree.elements[e];i&&(a.default.aabb.union(this._bbox,this._bbox,i.bbox),r=!0)}),this._closeup&&r&&this._camera.lookTo(a.default.aabb.center(this._bbox),a.default.aabb.length(this._bbox)/2)}}}_updateVertices(){var e=this._startX,t=this._endX,r=this._startY,n=this._endY;this._startX>this._endX&&(e=this._endX,t=this._startX),this._startY>this._endY&&(r=this._endY,n=this._startY);const a=this._viewer.getCamera().core.viewport[3];e=Math.floor(e*i.Environment.devicePixelRatio),r=Math.floor(a-1-r*i.Environment.devicePixelRatio);var s=(t=Math.floor(t*i.Environment.devicePixelRatio))-e,o=r-(n=Math.floor(a-1-n*i.Environment.devicePixelRatio)),l=Math.floor(this._lineWidth*i.Environment.devicePixelRatio);this._addQuad(e,r,e+l,n,0,0,o,o,0),this._addQuad(e,r,t,r+l,0,s,s,0,20),this._addQuad(t-l,r,t,n,0,0,o,o,40),this._addQuad(e,n-l,t,n,0,s,s,0,60);const d=this._viewer.getResourceManager().gl;this._drawable.mesh.update(this._vertices,this._indices,d.UNSIGNED_BYTE)}_addQuad(e,t,r,i,n,a,s,o,l){const d=this._viewer.getCamera().core.viewport[2],u=this._viewer.getCamera().core.viewport[3];e=e/d*2-1,r=r/d*2-1,t=t/u*2-1,i=i/u*2-1,this._vertices[0+l]=e,this._vertices[1+l]=t,this._vertices[2+l]=0,this._vertices[3+l]=n/this._dashLength,this._vertices[4+l]=.5,this._vertices[5+l]=r,this._vertices[6+l]=t,this._vertices[7+l]=0,this._vertices[8+l]=a/this._dashLength,this._vertices[9+l]=.5,this._vertices[10+l]=r,this._vertices[11+l]=i,this._vertices[12+l]=0,this._vertices[13+l]=s/this._dashLength,this._vertices[14+l]=.5,this._vertices[15+l]=e,this._vertices[16+l]=i,this._vertices[17+l]=0,this._vertices[18+l]=o/this._dashLength,this._vertices[19+l]=.5}_resetVertices(){for(var e=0;e<80;++e)this._vertices[e]=-1e6;this._drawable.mesh.update(this._vertices,this._indices,this._viewer.getResourceManager().gl.UNSIGNED_BYTE)}setLineColor(e){this._renderScene.setNodesLineColor(e)}setOverridedColor(e){this._overridedColor[0]=e[0],this._overridedColor[1]=e[1],this._overridedColor[2]=e[2],void 0!==e[3]&&(this._overridedColor[3]=e[3])}}},"./08ui/tool/SelectModel.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return l});var i=r("./08ui/tool/Snapping.ts"),n=r("./08ui/tool/PickQuery.ts"),a=r("./08ui/tool/Tool.ts"),s=[0,0],o=[0,0,0];class l extends a.default{constructor(e){super("SelectModel",!1,e),this._snapping=null,this._pickQuery=null,this._snapped=-1,this.currentModel=-1,this.currentPosition=new Array(3)}destroy(){this._snapping&&(this._snapping.destroy(),this._snapping=null,delete this._snapping),this._pickQuery&&(this._pickQuery.destroy(),this._pickQuery=null,delete this._pickQuery),this.currentModel=null,delete this.currentModel,this.currentPosition=null,delete this.currentPosition}addInput(e){"mouse"===e.name&&(e.addMouseMoveListener(this._onMouseMove.bind(this)),e.addMouseUpListener(this._onMouseUp.bind(this)))}doesSupportMobile(e){return!e}doesSupport3D(e){return!0}_udpateSnapping(e){this._snapping.update(this._renderer,this._scene,this._camera)}render(){this._enabled&&this._snapping.render(this._renderer,this._camera)}resize(e,t){this._snapping.resize(e,t)}setEnabled(e){super.setEnabled(e),e?(null===this._snapping&&(this._snapping=new i.default(this._scene,this._camera,this._resourceManager,this._viewer.getRenderScene().getRenderQueueManager()),this._snapping.setRenderingEnabled(!0),this._snapping.setSnappingRadius(8)),null===this._pickQuery&&(this._pickQuery=new n.default(this._scene,this._resourceManager)),this._camera.addUpdateStopListener(this._udpateSnapping.bind(this))):this._camera.removeUpdateStopListener(this._udpateSnapping.bind(this)),this._viewer.setSmartCullingEnabled(!e)}_onMouseMove(e){return!!this._enabled&&(e.pressed||this._camera.updated||(s[0]=e.x,s[1]=e.y,this._snapped=this._snapping.snap(s,o),this._snapped>=0&&(this.currentPosition[0]=o[0],this.currentPosition[1]=o[1],this.currentPosition[2]=o[2]),this._viewer.getEventEmitter().emit("SelectModel-SnappedTo",s)),!1)}_onMouseUp(e){return!!this._enabled&&(e.moved||(this.currentModel=-1,s[0]=e.x,s[1]=e.y,this._snapped<0&&(this._snapped=this._snapping.snap(s,o)),this._snapped>=0&&(this.currentModel=this._pickQuery.pickModel(s[0],s[1],this._renderer,this._camera),this._viewer.getEventEmitter().emit("SelectModel-Selected",this.currentModel,o))),!1)}}},"./08ui/tool/Snapping.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"SnappingMode",function(){return i}),r.d(t,"default",function(){return f});var i,n=r("./00utility/Environment.ts"),a=r("./02resource/m3d_shader_library.js"),s=r("./03scene/drawables/Gizmo.ts"),o=r("./03scene/materials/Material.ts"),l=r("./04renderer/pipeline/RenderTarget.ts"),d=r("./04renderer/pipeline/RenderPass.ts"),u=r("./04renderer/pipeline/RenderPassEdgeMap.ts"),c=r("./08ui/tool/SpiralOrder.ts"),h=r("./glMatrix.js");!function(e){e[e.NONE=-1]="NONE",e[e.VERTEX=0]="VERTEX",e[e.EDGE=1]="EDGE",e[e.EDGEMIDPOINT=2]="EDGEMIDPOINT"}(i||(i={}));var m=[0,0,0];class f{constructor(e,t,r,i){const n=r.gl;if(this._gl=n,!n.isWebGL2)return void console.warn("Snapping requires a WebGL 2.0 context");this._rendering=!1,this._camera=t,this._edgeIndex=-1,this._radius=5,this._edgePass=new u.default(r,i),this._notEdgePass=new d.default(r,i,!1,{line:!1});let c=r.getMesh("edge");c.createLine(),this._edge=new s.default(c,r),this._edge.setColor([1,177/255,0]);let h=r.getMesh("snapping-dot");h.ready||h.createSphere(16,32),this._dot=new s.default(h,r),this._dot.setColor([1,177/255,0]),this._dot.transform.matrix[0]=.1,this._dot.transform.matrix[5]=.1,this._dot.transform.matrix[10]=.1;let m=r.getShader("mark",[]);if(!m.ready){let e=a.default.mark;m.createFromShaderSource(e,[])}this._edgePass.setOverridedShader(m),this._edgePass.setOverridedMaterial(new o.default("edgemap")),this._notEdgePass.setCullFace(n.CCW);const f=t.viewport[2],p=t.viewport[3];if(this._rtEdge=new l.default("rtEdge",r,f,p,{depthTest:!0,colorFormat:n.RGBA8,colorFilter:n.NEAREST,depthBuffer:0,colorBuffer:0,clearColor:[1,1,1,1]}),this._rtNotEdge=new l.default("rtNotEdge",r,f,p,{depthTest:!0,colorFormat:n.RGBA8,colorFilter:n.NEAREST,depthBuffer:0,colorBuffer:0,colorMask:[0,0,0,0],clearColor:[1,1,1,1]}),this._rtDefault=new l.default("default",r,f,p,{depthFunc:n.LEQUAL}),!this._edgePass.queue.isValid())for(var v=0,_=e.models.length;v<_;++v){let t=e.models[v].drawables;for(let e=0,r=t.length;e<r;e++)this._edgePass.queue.addDrawable(t[e])}if(!this._notEdgePass.queue.isValid())for(v=0,_=e.models.length;v<_;++v){let t=e.models[v].drawables;for(let e=0,r=t.length;e<r;e++)this._notEdgePass.queue.addDrawable(t[e])}this._edgeBuffer=new Float32Array(6),this.resize(f,p)}destroy(){this._edge.mesh.destroy(),this._edge.destroy(),this._edge=null,delete this._edge,this._dot.destroy(),this._dot=null,delete this._dot,this._edgeBuffer=null,delete this._edgeBuffer,this._edgesBuffer=null,delete this._edgesBuffer,this._rtEdge.destroy(),this._rtEdge=null,delete this._rtEdge,this._rtNotEdge.destroy(),this._rtNotEdge=null,delete this._rtNotEdge,this._rtDefault.destroy(),this._rtDefault=null,delete this._rtDefault,this._edgePass.destroy(),this._edgePass=null,delete this._edgePass,this._notEdgePass.destroy(),this._notEdgePass=null,delete this._notEdgePass}recompileShader(e,t){this._edgePass.recompileOverridedShader(t)}setSnappingRadius(e){this._radius=Math.max(Math.min(e,11),0)}setRenderingEnabled(e){this._rendering=e}resize(e,t){this._rtEdge.resize(e,t),this._edgesBuffer=new Uint8Array(e*t*4)}render(e,t){this._rendering}snap(e,t){let r=this._rtEdge.getWidth(),a=this._rtEdge.getHeight(),s=Math.floor(e[0]*n.Environment.devicePixelRatio),o=Math.floor(a-1-e[1]*n.Environment.devicePixelRatio),l=!1,d=this._edgeIndex;this._edgeIndex=-1;let u=this._radius*this._radius-1;for(let t=0;t<u;t++){let i=s+c.SPIRAL[t][0],d=o+c.SPIRAL[t][1];if(i<1||i>r-1||d<1||d>a-1)continue;let u=4*(i+d*r),h=this._edgesBuffer[u+0],m=this._edgesBuffer[u+1],f=this._edgesBuffer[u+2],p=this._edgesBuffer[u+3];if(255!==h||255!==m||255!==f||255!==p){let t=p<<24|f<<16|m<<8|h;this._edgeIndex=-2&t,l=!0,e[0]=Math.floor(i/n.Environment.devicePixelRatio),e[1]=Math.floor((a-1-d)/n.Environment.devicePixelRatio);break}}if(this._edgeIndex!==d&&l){let e=0;for(let t=0,r=this._edgePass.queue.drawables.length;t<r;t++){let r=this._edgePass.queue.drawables[t],i=r.mesh,n=i.length;if(this._edgeIndex>=e&&this._edgeIndex<e+n){if(i.getVBSubData(12*(this._edgeIndex-e),this._edgeBuffer),!r.transform.identity){const e=r.transform.matrix;h.vec3.transformMat4(this._edgeBuffer,this._edgeBuffer,e),m[0]=this._edgeBuffer[3],m[1]=this._edgeBuffer[4],m[2]=this._edgeBuffer[5],h.vec3.transformMat4(m,m,e),this._edgeBuffer[3]=m[0],this._edgeBuffer[4]=m[1],this._edgeBuffer[5]=m[2]}this._rendering&&this._edge.mesh.update(this._edgeBuffer,new Uint16Array([0,1]));break}e+=n}}return l?(t=t||[0,0,0],this._snapToMidPoint(e,t)?i.EDGEMIDPOINT:this._snapToVertex(e,t)?i.VERTEX:(this._snapToEdge(e,t),i.EDGE)):-1}update(e,t,r){const i=this._gl;e.invalidate(),e.clear(this._rtEdge,i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),this._notEdgePass.render(this._rtNotEdge,e,r),this._edgePass.render(this._rtEdge,e,r),i.readPixels(0,0,this._rtEdge.getWidth(),this._rtEdge.getHeight(),i.RGBA,i.UNSIGNED_BYTE,this._edgesBuffer)}_snapToEdge(e,t){const r=[this._edgeBuffer[0],this._edgeBuffer[1],this._edgeBuffer[2]],i=[this._edgeBuffer[3],this._edgeBuffer[4],this._edgeBuffer[5]],n=this._camera.eye,a=this._camera.unproject(e[0],e[1]);var s=h.vec3.create(),o=h.vec3.create(),l=h.vec3.create(),d=h.vec3.create();h.vec3.sub(s,i,r),h.vec3.sub(o,a,n),h.vec3.sub(l,n,r),h.vec3.cross(l,l,o),h.vec3.cross(d,s,o);const u=h.vec3.dot(l,d)/h.vec3.squaredLength(d);return h.vec3.lerp(t,r,i,u),!0}_snapToMidPoint(e,t){const r=this._camera.project([.5*(this._edgeBuffer[0]+this._edgeBuffer[3]),.5*(this._edgeBuffer[1]+this._edgeBuffer[4]),.5*(this._edgeBuffer[2]+this._edgeBuffer[5])]),i=r[0]-e[0],n=r[1]-e[1];return i*i+n*n<this._radius*this._radius&&(e[0]=r[0],e[1]=r[1],t[0]=.5*(this._edgeBuffer[0]+this._edgeBuffer[3]),t[1]=.5*(this._edgeBuffer[1]+this._edgeBuffer[4]),t[2]=.5*(this._edgeBuffer[2]+this._edgeBuffer[5]),this._rendering&&(this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),!0)}_snapToVertex(e,t){const r=this._camera.project(this._edgeBuffer),i=this._camera.project([this._edgeBuffer[3],this._edgeBuffer[4],this._edgeBuffer[5]]),n=r[0]-e[0],a=r[1]-e[1],s=i[0]-e[0],o=i[1]-e[1],l=n*n+a*a,d=s*s+o*o,u=this._radius*this._radius;return l<u&&l<d?(e[0]=r[0],e[1]=r[1],t[0]=this._edgeBuffer[0],t[1]=this._edgeBuffer[1],t[2]=this._edgeBuffer[2],this._rendering&&(this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),!0):d<u&&d<l&&(e[0]=i[0],e[1]=i[1],t[0]=this._edgeBuffer[3],t[1]=this._edgeBuffer[4],t[2]=this._edgeBuffer[5],this._rendering&&(this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),!0)}}},"./08ui/tool/SnappingApprox.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return _});var i=r("./00utility/Environment.ts"),n=r("./02resource/m3d_shader_library.js"),a=r("./03scene/materials/Material.ts"),s=r("./03scene/drawables/Gizmo.ts"),o=r("./04renderer/pipeline/RenderTarget.ts"),l=r("./04renderer/pipeline/RenderPass.ts"),d=r("./08ui/tool/SpiralOrder.ts"),u=r("./08ui/tool/Snapping.ts"),c=r("./glMatrix.js"),h=[0,0,0],m=[0,0,0],f=[0,0,0],p=[0,0,0],v=[0,0,0];class _{constructor(e,t,r,i){this._normalDepthPass=new l.default(r,i,!1,{line:!1}),this._rendering=!1,this._camera=t;const d=t.viewport[2],u=t.viewport[3],c=r.gl;this._gl=c,this._rtNormalDepth=new o.default(name+"_depth",r,d,u,{colorFormat:c.RGBA32F,colorFilter:c.NEAREST,colorBuffer:0,depthBuffer:0,clearColor:[0,0,0,0]}),this._rtDefault=new o.default("default",r,d,u,{depthFunc:c.LEQUAL});let h=r.getShader("normaldepth",["WORLDSPACE_NORMAL"]);if(!h.ready){let e=n.default.normaldepth;h.createFromShaderSource(e,["WORLDSPACE_NORMAL"])}this._normalDepthPass.setOverridedShader(h),this._normalDepthPass.setOverridedMaterial(new a.default("ruler-position-depth")),this._radius=10,this.resize(d,u);let m=r.getMesh("snapping-dot");if(m.ready||m.createSphere(16,32),this._dot=new s.default(m,r),this._dot.setColor([1,177/255,0]),this._dot.transform.matrix[0]=.1,this._dot.transform.matrix[5]=.1,this._dot.transform.matrix[10]=.1,!this._normalDepthPass.queue.isValid())for(var f=0,p=e.models.length;f<p;++f){let t=e.models[f].drawables;for(let e=0,r=t.length;e<r;e++)this._normalDepthPass.queue.addDrawable(t[e])}}destroy(){this._normalDepthPass.destroy(),this._normalDepthPass=null,delete this._normalDepthPass,this._dot.destroy(),this._dot=null,delete this._dot,this._rtNormalDepth.destroy(),this._rtNormalDepth=null,delete this._rtNormalDepth,this._rtDefault.destroy(),this._rtDefault=null,delete this._rtDefault,this._normalDepthBuffer=null,delete this._normalDepthBuffer}setSnappingRadius(e){this._radius=Math.max(Math.min(e,11),0)}snap(e,t){e[0],e[1];const r=this._rtNormalDepth.getWidth(),n=this._rtNormalDepth.getHeight();let a=Math.floor(e[0]*i.Environment.devicePixelRatio),s=Math.floor(n-1-e[1]*i.Environment.devicePixelRatio);if(t=t||[0,0,0],this._fetchNormal(a,s))for(let o=0;o<this._radius*this._radius-1;o++){let l=a+d.SPIRAL[o][0],c=s+d.SPIRAL[o][1];if(!(l<0||l>r-1||c<0||c>n-1)&&this._detectEdge(l,c))return e[0]=Math.floor(l/i.Environment.devicePixelRatio),e[1]=Math.floor((n-1-c)/i.Environment.devicePixelRatio),this._fetchPosition(l,c,t),this._rendering&&(this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),u.SnappingMode.EDGE}return this._rendering&&(this._fetchPosition(a,s,t),this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),-1}_fetchNormal(e,t,r){let i=4*(e+t*this._rtNormalDepth.getWidth()),n=this._normalDepthBuffer[i],a=this._normalDepthBuffer[i+1],s=this._normalDepthBuffer[i+2];return n*n+a*a+s*s>.01&&(r&&(r[0]=n,r[1]=a,r[2]=s,c.vec3.normalize(r,r)),!0)}_fetchPosition(e,t,r){const n=this._rtNormalDepth.getWidth(),a=this._rtNormalDepth.getHeight();let s=4*(e+t*n),o=this._normalDepthBuffer[s],l=this._normalDepthBuffer[s+1],d=this._normalDepthBuffer[s+2];if(o*o+l*l+d*d<.01)return!1;const u=e/i.Environment.devicePixelRatio,c=(a-1-t)/i.Environment.devicePixelRatio;let h=this._normalDepthBuffer[s+3];const m=this._camera.unproject(u,c,-h);return r[0]=m[0],r[1]=m[1],r[2]=m[2],!0}_detectEdge(e,t){this._fetchNormal(e-1,t,h),this._fetchPosition(e-1,t,f),this._fetchNormal(e+1,t,m),this._fetchPosition(e+1,t,p),c.vec3.subtract(v,f,p),c.vec3.normalize(v,v);let r=Math.max(Math.abs(c.vec3.dot(v,h)),Math.abs(c.vec3.dot(v,m)));this._fetchNormal(e,t-1,h),this._fetchPosition(e,t-1,f),this._fetchNormal(e,t+1,m),this._fetchPosition(e,t+1,p),c.vec3.subtract(v,f,p),c.vec3.normalize(v,v);let i=Math.max(Math.abs(c.vec3.dot(v,h)),Math.abs(c.vec3.dot(v,m)));return r*r+i*i>.25}resize(e,t){this._rtNormalDepth.resize(e,t),this._normalDepthBuffer=new Float32Array(e*t*4)}update(e,t,r){const i=this._gl;e.invalidate(),e.clear(this._rtNormalDepth,i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),this._normalDepthPass.render(this._rtNormalDepth,e,r),i.readPixels(0,0,this._rtNormalDepth.getWidth(),this._rtNormalDepth.getHeight(),i.RGBA,i.FLOAT,this._normalDepthBuffer)}render(e,t){this._rendering&&e.drawGizmo(this._rtDefault,this._dot,t)}setRenderingEdgeEnabled(e){this._rendering=e}}},"./08ui/tool/SpiralOrder.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"SPIRAL",function(){return i});const i=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1],[2,-1],[2,0],[2,1],[2,2],[1,2],[0,2],[-1,2],[-2,2],[-2,1],[-2,0],[-2,-1],[-2,-2],[-1,-2],[0,-2],[1,-2],[2,-2],[3,-2],[3,-1],[3,0],[3,1],[3,2],[3,3],[2,3],[1,3],[0,3],[-1,3],[-2,3],[-3,3],[-3,2],[-3,1],[-3,0],[-3,-1],[-3,-2],[-3,-3],[-2,-3],[-1,-3],[0,-3],[1,-3],[2,-3],[3,-3],[4,-3],[4,-2],[4,-1],[4,0],[4,1],[4,2],[4,3],[4,4],[3,4],[2,4],[1,4],[0,4],[-1,4],[-2,4],[-3,4],[-4,4],[-4,3],[-4,2],[-4,1],[-4,0],[-4,-1],[-4,-2],[-4,-3],[-4,-4],[-3,-4],[-2,-4],[-1,-4],[0,-4],[1,-4],[2,-4],[3,-4],[4,-4],[5,-4],[5,-3],[5,-2],[5,-1],[5,0],[5,1],[5,2],[5,3],[5,4],[5,5],[4,5],[3,5],[2,5],[1,5],[0,5],[-1,5],[-2,5],[-3,5],[-4,5],[-5,5],[-5,4],[-5,3],[-5,2],[-5,1],[-5,0],[-5,-1],[-5,-2],[-5,-3],[-5,-4],[-5,-5],[-4,-5],[-3,-5],[-2,-5],[-1,-5],[0,-5],[1,-5],[2,-5],[3,-5],[4,-5],[5,-5],[6,-5],[6,-4],[6,-3],[6,-2],[6,-1],[6,0],[6,1],[6,2],[6,3],[6,4],[6,5],[6,6],[5,6],[4,6],[3,6],[2,6],[1,6],[0,6],[-1,6],[-2,6],[-3,6],[-4,6],[-5,6],[-6,6],[-6,5],[-6,4],[-6,3],[-6,2],[-6,1],[-6,0],[-6,-1],[-6,-2],[-6,-3],[-6,-4],[-6,-5],[-6,-6],[-5,-6],[-4,-6],[-3,-6],[-2,-6],[-1,-6],[0,-6],[1,-6],[2,-6],[3,-6],[4,-6],[5,-6],[6,-6],[7,-6],[7,-5],[7,-4],[7,-3],[7,-2],[7,-1],[7,0],[7,1],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7],[6,7],[5,7],[4,7],[3,7],[2,7],[1,7],[0,7],[-1,7],[-2,7],[-3,7],[-4,7],[-5,7],[-6,7],[-7,7],[-7,6],[-7,5],[-7,4],[-7,3],[-7,2],[-7,1],[-7,0],[-7,-1],[-7,-2],[-7,-3],[-7,-4],[-7,-5],[-7,-6],[-7,-7],[-6,-7],[-5,-7],[-4,-7],[-3,-7],[-2,-7],[-1,-7],[0,-7],[1,-7],[2,-7],[3,-7],[4,-7],[5,-7],[6,-7],[7,-7],[8,-7],[8,-6],[8,-5],[8,-4],[8,-3],[8,-2],[8,-1],[8,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],[7,8],[6,8],[5,8],[4,8],[3,8],[2,8],[1,8],[0,8],[-1,8],[-2,8],[-3,8],[-4,8],[-5,8],[-6,8],[-7,8],[-8,8],[-8,7],[-8,6],[-8,5],[-8,4],[-8,3],[-8,2],[-8,1],[-8,0],[-8,-1],[-8,-2],[-8,-3],[-8,-4],[-8,-5],[-8,-6],[-8,-7],[-8,-8],[-7,-8],[-6,-8],[-5,-8],[-4,-8],[-3,-8],[-2,-8],[-1,-8],[0,-8],[1,-8],[2,-8],[3,-8],[4,-8],[5,-8],[6,-8],[7,-8],[8,-8],[9,-8],[9,-7],[9,-6],[9,-5],[9,-4],[9,-3],[9,-2],[9,-1],[9,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[9,9],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,9],[-1,9],[-2,9],[-3,9],[-4,9],[-5,9],[-6,9],[-7,9],[-8,9],[-9,9],[-9,8],[-9,7],[-9,6],[-9,5],[-9,4],[-9,3],[-9,2],[-9,1],[-9,0],[-9,-1],[-9,-2],[-9,-3],[-9,-4],[-9,-5],[-9,-6],[-9,-7],[-9,-8],[-9,-9],[-8,-9],[-7,-9],[-6,-9],[-5,-9],[-4,-9],[-3,-9],[-2,-9],[-1,-9],[0,-9],[1,-9],[2,-9],[3,-9],[4,-9],[5,-9],[6,-9],[7,-9],[8,-9],[9,-9],[10,-9],[10,-8],[10,-7],[10,-6],[10,-5],[10,-4],[10,-3],[10,-2],[10,-1],[10,0],[10,1],[10,2],[10,3],[10,4],[10,5],[10,6],[10,7],[10,8],[10,9],[10,10],[9,10],[8,10],[7,10],[6,10],[5,10],[4,10],[3,10],[2,10],[1,10],[0,10],[-1,10],[-2,10],[-3,10],[-4,10],[-5,10],[-6,10],[-7,10],[-8,10],[-9,10],[-10,10],[-10,9],[-10,8],[-10,7],[-10,6],[-10,5],[-10,4],[-10,3],[-10,2],[-10,1],[-10,0],[-10,-1],[-10,-2],[-10,-3],[-10,-4],[-10,-5],[-10,-6],[-10,-7],[-10,-8],[-10,-9],[-10,-10],[-9,-10],[-8,-10],[-7,-10],[-6,-10],[-5,-10],[-4,-10],[-3,-10],[-2,-10],[-1,-10],[0,-10],[1,-10],[2,-10],[3,-10],[4,-10],[5,-10],[6,-10],[7,-10],[8,-10],[9,-10],[10,-10],[11,-10],[11,-9],[11,-8],[11,-7],[11,-6],[11,-5],[11,-4],[11,-3],[11,-2],[11,-1],[11,0],[11,1],[11,2],[11,3],[11,4],[11,5],[11,6],[11,7],[11,8],[11,9],[11,10],[11,11],[10,11],[9,11],[8,11],[7,11],[6,11],[5,11],[4,11],[3,11],[2,11],[1,11],[0,11],[-1,11],[-2,11],[-3,11],[-4,11],[-5,11],[-6,11],[-7,11],[-8,11],[-9,11],[-10,11],[-11,11],[-11,10],[-11,9],[-11,8],[-11,7],[-11,6],[-11,5],[-11,4],[-11,3],[-11,2],[-11,1],[-11,0],[-11,-1],[-11,-2],[-11,-3],[-11,-4],[-11,-5],[-11,-6],[-11,-7],[-11,-8],[-11,-9],[-11,-10],[-11,-11],[-10,-11],[-9,-11],[-8,-11],[-7,-11],[-6,-11],[-5,-11],[-4,-11],[-3,-11],[-2,-11],[-1,-11],[0,-11],[1,-11],[2,-11],[3,-11],[4,-11],[5,-11],[6,-11],[7,-11],[8,-11],[9,-11],[10,-11],[11,-11]]},"./08ui/tool/Tool.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return n});var i=r("./04renderer/pipeline/RenderTarget.ts");class n{constructor(e,t,r){if(this.name=e,this._viewer=r,r){this._scene=r.getScene().core,this._camera=r.getCamera().core,this._cameras=[];for(let e=0;e<r.getCamera().cores.length;e++)this._cameras.push(r.getCamera().cores[e]);this._resourceManager=r.getResourceManager(),this._renderer=r.getRenderer()}else this._scene=null,this._camera=null,this._cameras=[],this._resourceManager=null,this._renderer=null;this._renderable=t,this._renderTargets=[],this._interactive=!0,this._enabled=!1}destroy(){this.name=null,delete this.name,this._viewer=null,delete this._viewer,this._scene=null,delete this._scene,this._camera=null,delete this._camera,this._cameras=null,delete this._cameras,this._renderer=null,delete this._renderer,this._resourceManager=null,delete this._resourceManager;for(let e=0;e<this._renderTargets.length;e++)this._renderTargets[e].destroy();this._renderTargets=null,delete this._renderTargets}doesSupportMobile(e){return!1}doesSupport3D(e){return!1}isEnabled(){return this._enabled}setEnabled(e){this._enabled=e}setInteractive(e){this._interactive=e}isInteractive(){return this._interactive&&this._enabled}addInput(e){}resize(e,t){for(let r=0;r<this._renderTargets.length;r++)this._renderTargets[r].resize(e,t)}render(){}_getRenderTarget(e){if(this._renderable&&this._viewer){const t=this._viewer.getRenderScene().getRenderTarget().getName(),r=this._viewer.getCamera().core,n=r.viewport[2],a=r.viewport[3],s=new i.default(t,this._resourceManager,n,a,e||{});return this._renderTargets.push(s),s}return null}}},"./08ui/tool/TransformGizmo.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./03scene/drawables/Gizmo.ts"),n=r("./08ui/tool/PickQuery.ts"),a=r("./08ui/tool/Tool.ts"),s=r("./08ui/input/Mouse.ts"),o=r("./glMatrix.js"),l=r("./08ui/input/Touch.ts");let d={"axis-x":o.vec4.fromValues(1,0,0,1),"axis-y":o.vec4.fromValues(0,1,0,1),"axis-z":o.vec4.fromValues(0,0,1,1),"rotate-xy":o.vec4.fromValues(0,0,1,1),"rotate-yz":o.vec4.fromValues(1,0,0,1),"rotate-xz":o.vec4.fromValues(0,1,0,1),picked:o.vec4.fromValues(1,1,0,1)};class u extends a.default{constructor(e,t,r=1){if(super("TransformGizmo",!0,e),this._transformMatrix=o.mat4.create(),t){if(this._model=e.getScene().core.models[t],!this._model)return console.warn("No modelId "+t+" is found!"),void this.destroy();this._model.updateBBox(),this._model.isMatrixIdentity&&(this._model.drawables.forEach(e=>{e.recompileShader("MODEL_TRANSFORM",!0)}),e.invalidate()),this._transformMatrix[12]=.5*(this._model.bbox[0]+this._model.bbox[3]),this._transformMatrix[13]=.5*(this._model.bbox[1]+this._model.bbox[4]),this._transformMatrix[14]=.5*(this._model.bbox[2]+this._model.bbox[5])}else console.warn("please use .setModel to add model");this._renderTarget=this._getRenderTarget(),this._picked=null,this._drawables=[],this._scale=.2*r,this._scaleMatrix=o.mat4.create(),this._tempMat=o.mat4.create(),this._planeNormal=o.vec3.create()}setModel(e){if(this._model=this._viewer.getScene().core.models[e],!this._model)return console.warn("No modelId "+e+" is found!"),void this.destroy();this._model.updateBBox();const t=this._model.getTransformMatrix();this._model.isMatrixIdentity&&(this._model.drawables.forEach(e=>{e.recompileShader("MODEL_TRANSFORM",!0)}),this._viewer.invalidate()),o.mat4.copy(this._transformMatrix,t)}destroy(){this._drawables.length>0&&(this._drawables[0].destroy(),this._drawables[1].destroy(),this._drawables[2].destroy(),this._drawables[3].destroy(),this._drawables[4].destroy(),this._drawables[5].destroy()),this._drawables=null,delete this._drawables,this._pickQuery&&(this._pickQuery.destroy(),this._pickQuery=null,delete this._pickQuery),this._model=null,delete this._model}setEnabled(e){this._enabled=e,this._enabled&&0===this._drawables.length&&(this._createGizmo(),this._pickQuery=new n.default(this._scene,this._resourceManager)),this._viewer.invalidate()}_beginRenderGizmo(){o.mat4.copy(this._tempMat,this._camera.vpMatrix);var e=o.vec3.create(),t=o.vec3.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]);o.vec3.subtract(e,this._camera._at,this._camera.eye),o.vec3.normalize(e,e),o.vec3.subtract(t,t,this._camera.eye),this._scaleMatrix[0]=this._scaleMatrix[5]=this._scaleMatrix[10]=o.vec3.dot(e,t),o.mat4.multiply(this._scaleMatrix,this._transformMatrix,this._scaleMatrix),o.mat4.multiply(this._camera.vpMatrix,this._camera.vpMatrix,this._scaleMatrix),this._renderer.clear(this._renderTarget,this._resourceManager.gl.DEPTH_BUFFER_BIT),this._renderer.invalidate()}_endRenderGizmo(){o.mat4.copy(this._camera.vpMatrix,this._tempMat),o.mat4.identity(this._scaleMatrix)}render(){if(this._enabled){this._beginRenderGizmo();for(var e=0;e<this._drawables.length;e++)this._renderer.drawGizmo(this._renderTarget,this._drawables[e],this._camera);this._endRenderGizmo()}}addInput(e){e instanceof s.default?(e.addMouseDownListener(this._onMouseDown.bind(this)),e.addMouseMoveListener(this._onMouseMove.bind(this)),e.addMouseUpListener(this._onMouseUp.bind(this))):e instanceof l.default&&(e.addTouchStartListener(this._onTouchStart.bind(this)),e.addTouchStopListener(this._onTouchStop.bind(this)),e.addTouchMoveListener(this._onTouchMove.bind(this)))}doesSupportMobile(e){return!0}doesSupport3D(e){return!0}_onMouseDown(e){return this._picked&&(this._currentAxisX=o.vec3.fromValues(this._transformMatrix[0],this._transformMatrix[1],this._transformMatrix[2]),this._currentAxisY=o.vec3.fromValues(this._transformMatrix[4],this._transformMatrix[5],this._transformMatrix[6]),this._currentAxisZ=o.vec3.fromValues(this._transformMatrix[8],this._transformMatrix[9],this._transformMatrix[10])),!1}_onMouseUp(e){return this._picked&&(this._viewer.getScene().core.updateBBox(),this._viewer.getEventEmitter().emit("TransformGizmo-End")),!1}_onMouseMove(e){if(!this._enabled)return!1;if(e.pressed){if(this._picked)return this._updateTransform(e),this._scene.updateBBox(),this._viewer.invalidate(),this._viewer.getEventEmitter().emit("TransformGizmo-Move"),!0}else{this._beginRenderGizmo();let t=this._pickQuery.pickDrawable(e.x,e.y,this._renderer,this._camera,this._drawables);this._endRenderGizmo(),t!==this._picked&&(this._picked&&this._picked.setColor(d[this._picked.name]),this._picked=t,this._picked&&this._picked.setColor(d.picked))}return!1}_onTouchStart(e){let t=this._pickQuery.pickDrawable(e.cursor(0).x,e.cursor(0).y,this._renderer,this._camera,this._drawables);return t!==this._picked&&(this._picked&&this._picked.setColor(d[this._picked.name]),this._picked=t,this._picked&&(this._picked.setColor(d.picked),this._picked&&(this._currentAxisX=o.vec3.fromValues(this._transformMatrix[0],this._transformMatrix[1],this._transformMatrix[2]),this._currentAxisY=o.vec3.fromValues(this._transformMatrix[4],this._transformMatrix[5],this._transformMatrix[6]),this._currentAxisZ=o.vec3.fromValues(this._transformMatrix[8],this._transformMatrix[9],this._transformMatrix[10]))),!0)}_onTouchStop(e){return this._picked&&(this._picked.setColor(d[this._picked.name]),this._viewer.getEventEmitter().emit("TransformGizmo-End")),this._picked=null,!0}_onTouchMove(e){return!!this._enabled&&(!(1!==e.numCursors||!this._picked)&&(this._updateTransform(e),this._scene.updateBBox(),this._viewer.invalidate(),this._viewer.getEventEmitter().emit("TransformGizmo-Move"),!0))}_intersectPlane(e,t,r,i){var n=o.vec3.create();o.vec3.sub(n,t,e);var a=(i-o.vec3.dot(e,r))/o.vec3.dot(n,r),s=o.vec3.create();return o.vec3.scaleAndAdd(s,e,n,a),s}_getTranslation(e,t,r,i){var n=o.vec3.create(),a=o.vec2.create(),s=o.vec3.create(),l=o.vec3.create(),d=o.mat4.create();d[12]=this._transformMatrix[12],d[13]=this._transformMatrix[13],d[14]=this._transformMatrix[14];var u=this._camera.project(r,d),c=this._camera.project(l,d);o.vec2.sub(n,e,t);a=o.vec2.fromValues(u[0]-c[0],u[1]-c[1]);o.vec2.normalize(a,a);var h=o.vec2.dot(n,a),m=this._camera._distance/(this._camera.viewport[2]-this._camera.viewport[0]);return o.vec3.scale(s,r,h*m),s}_getRotation(e,t,r,i){t=this._camera.unproject(t[0],t[1]),e=this._camera.unproject(e[0],e[1]);var n=this._intersectPlane(this._camera.eye,e,r,i),a=this._intersectPlane(this._camera.eye,t,r,i),s=o.vec3.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]);if(o.vec3.sub(n,n,s),o.vec3.sub(a,a,s),0===o.vec3.distance(n,a))return 0;var l=Math.acos(o.vec3.dot(n,a)/o.vec3.length(n)/o.vec3.length(a));return o.vec3.cross(n,a,n),l*=Math.sign(o.vec3.dot(n,r))}_updateTransform(e){let t,r,i;i=o.vec3.create();e instanceof s.default?(t=o.vec2.fromValues(e.x,e.y),r=o.vec2.fromValues(e.x-e.dx,e.y-e.dy)):(t=o.vec2.fromValues(e.cursor(0).x,e.cursor(0).y),r=o.vec2.fromValues(e.cursor(0).x-e.cursor(0).dx,e.cursor(0).y-e.cursor(0).dy));var n=[0,0,0],a=0,l=[0,0,1],d=0,u=o.vec3.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]);switch(this._picked.name){case"axis-x":l=this._currentAxisX,d=o.vec3.dot(u,this._currentAxisY)/o.vec3.length(this._currentAxisZ),n=this._getTranslation(t,r,l,d);break;case"axis-y":l=this._currentAxisY,d=o.vec3.dot(u,this._currentAxisX)/o.vec3.length(this._currentAxisZ),n=this._getTranslation(t,r,l,d);break;case"axis-z":l=this._currentAxisZ,d=o.vec3.dot(u,this._currentAxisX)/o.vec3.length(this._currentAxisX),n=this._getTranslation(t,r,l,d);break;case"rotate-xy":l=this._currentAxisZ,d=o.vec3.dot(u,l)/o.vec3.length(l),a=this._getRotation(t,r,l,d);break;case"rotate-yz":l=this._currentAxisX,d=o.vec3.dot(u,l)/o.vec3.length(l),a=this._getRotation(t,r,l,d);break;case"rotate-xz":l=this._currentAxisY,d=o.vec3.dot(u,l)/o.vec3.length(l),a=this._getRotation(t,r,l,d)}var c=o.vec3.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]),h=o.mat4.create();o.mat4.fromRotation(h,a,l);var m=o.vec3.create();o.vec3.transformMat4(m,c,h),h[12]=c[0]-m[0],h[13]=c[1]-m[1],h[14]=c[2]-m[2],o.mat4.multiply(this._transformMatrix,h,this._transformMatrix),this._transformMatrix[12]+=n[0],this._transformMatrix[13]+=n[1],this._transformMatrix[14]+=n[2],this._model.setTransformMatrix(this._transformMatrix);for(var f=0;f<this._cameras.length;f++)this._cameras[f]._updateProjection();let p={x:this._transformMatrix[12]-this._model.initMatrix[12],y:this._transformMatrix[13]-this._model.initMatrix[13],z:this._transformMatrix[14]-this._model.initMatrix[14],type:"translation"},v=[],_={x:(v=o.mat4.getEuler(this._transformMatrix))[0],y:v[1],z:v[2],type:"rotation"};switch(this._picked.name){case"axis-x":case"axis-y":case"axis-z":this._viewer.getEventEmitter().emit("TransformGizmo-Update",p);break;case"rotate-xy":case"rotate-yz":case"rotate-xz":this._viewer.getEventEmitter().emit("TransformGizmo-Update",_)}}_createGizmo(){let e=.05*this._scale,t=this._scale,r=this._resourceManager.getMesh("transformX");r.createArrow(e,t);let n=this._resourceManager.getMesh("rotateXY");n.createArc(.5*this._scale,.05*this._scale,Math.PI/2,100),this._drawables=new Array(6),this._drawables[0]=new i.default(r,this._resourceManager,new Float32Array([0,0,0,2*e,2*e,t])),this._drawables[0].transform.setRotation([0,1,0],Math.PI/2),this._drawables[0].setColor(d["axis-x"]),this._drawables[0].name="axis-x",this._drawables[1]=new i.default(r,this._resourceManager,new Float32Array([0,0,0,2*e,2*e,t])),this._drawables[1].transform.setRotation([1,0,0],-Math.PI/2),this._drawables[1].setColor(d["axis-y"]),this._drawables[1].name="axis-y",this._drawables[2]=new i.default(r,this._resourceManager,new Float32Array([0,0,0,2*e,2*e,t])),this._drawables[2].setColor(d["axis-z"]),this._drawables[2].name="axis-z",this._drawables[3]=new i.default(n,this._resourceManager,new Float32Array([0,0,0,t,t,t])),this._drawables[3].setColor(d["axis-z"]),this._drawables[3].name="rotate-xy",this._drawables[4]=new i.default(n,this._resourceManager,new Float32Array([0,0,0,t,t,t])),this._drawables[4].transform.setRotation([0,1,0],-Math.PI/2),this._drawables[4].setColor(d["axis-x"]),this._drawables[4].name="rotate-yz",this._drawables[5]=new i.default(n,this._resourceManager,new Float32Array([0,0,0,t,t,t])),this._drawables[5].transform.setRotation([1,0,0],Math.PI/2),this._drawables[5].setColor(d["axis-y"]),this._drawables[5].name="rotate-xz"}translate(e,t,r){if(this._model){this._transformMatrix[12]=this._model.initMatrix[12]+e,this._transformMatrix[13]=this._model.initMatrix[13]+t,this._transformMatrix[14]=this._model.initMatrix[14]+r,this._model.setTransformMatrix(this._transformMatrix);for(var i=0;i<this._cameras.length;i++)this._cameras[i]._updateProjection()}}rotate(e,t,r){var i=[this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]],n=o.mat4.create();o.mat4.setFromEuler(n,e,t,r);var a=o.vec3.create();o.vec3.transformMat4(a,i,n),n[12]=i[0]-a[0],n[13]=i[1]-a[1],n[14]=i[2]-a[2];var s=o.mat4.create();s[12]=i[0],s[13]=i[1],s[14]=i[2],o.mat4.multiply(this._transformMatrix,n,s),this._model.setTransformMatrix(this._transformMatrix);for(var l=0;l<this._cameras.length;l++)this._cameras[l]._updateProjection()}getRotation(){let e=o.mat4.create();o.mat4.copy(e,this._transformMatrix);let t=[];return t=o.mat4.getEuler(e)}getTranslation(){let e=[];return e[0]=this._transformMatrix[12]-this._model.initMatrix[12],e[1]=this._transformMatrix[13]-this._model.initMatrix[13],e[2]=this._transformMatrix[14]-this._model.initMatrix[14],e}getTransformMatrix(){let e=o.mat4.create();return o.mat4.copy(e,this._transformMatrix),e}getinitTranslation(){if(!this._model)return void console.warn("please use .setModel to add model");let e=[];return e[0]=this._model.initMatrix[12],e[1]=this._model.initMatrix[13],e[2]=this._model.initMatrix[14],e}getworldMatrix(){let e=o.mat4.create();return o.mat4.copy(e,this._transformMatrix),e}}},"./08ui/tool/assets.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"DASH_LINE_TEXTURE_IMAGE",function(){return i});const i="data:image/png;base64,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"},"./08ui/tool/m3d_line.js":function(e,t,r){"use strict";r.r(t);var i=r("./00utility/Environment.ts"),n=r("./01wrapper/glenum.ts"),a=r("./03scene/drawables/Gizmo2D.ts");t.default=function(){function e(e,t,r,s){this._dashed=s,this._lineWidth=Math.floor(3*i.Environment.devicePixelRatio);var o=t.getMesh("line_mesh_"+e);if(o.createQuad(!1),this._drawable=new a.default(o,t),this._drawable.setColor(r),this._dashed){this._vertices=new Float32Array(240),this._indices=new Uint8Array(120);for(var l=0;l<20;++l)this._indices[0+6*l]=0+4*l,this._indices[1+6*l]=1+4*l,this._indices[2+6*l]=2+4*l,this._indices[3+6*l]=2+4*l,this._indices[4+6*l]=3+4*l,this._indices[5+6*l]=0+4*l}else this._vertices=new Float32Array(12),this._indices=new Uint8Array(6),this._indices[0]=0,this._indices[1]=1,this._indices[2]=2,this._indices[3]=2,this._indices[4]=3,this._indices[5]=0;for(l=0;l<this._vertices.length;++l)this._vertices[l]=-1e6;this._drawable.mesh.update(this._vertices,this._indices,n.gl.UNSIGNED_BYTE)}return e.prototype.render=function(e,t,r){t.drawDrawable(e,this._drawable,r,null,null,null,!1)},e.prototype._addQuad=function(e,t,r,i,n,a,s){var o=r-e,l=i-t,d=Math.atan2(o,l),u=Math.sign(o*l)||1,c=Math.sin(d)*this._lineWidth*.5/s*u,h=Math.cos(d)*this._lineWidth*.5/a*u;e=e/a*2-1,r=r/a*2-1,t=t/s*2-1,i=i/s*2-1,this._vertices[0+n]=e-h,this._vertices[1+n]=t+c,this._vertices[3+n]=e+h,this._vertices[4+n]=t-c,this._vertices[6+n]=r+h,this._vertices[7+n]=i-c,this._vertices[9+n]=r-h,this._vertices[10+n]=i+c,this._vertices[2+n]=0,this._vertices[5+n]=0,this._vertices[8+n]=0,this._vertices[11+n]=0},e.prototype.updateVertices=function(e,t,r,a,s,o){var l=e,d=r,u=t,c=a;l*=i.Environment.devicePixelRatio,u=o-1-u*i.Environment.devicePixelRatio;var h=(d*=i.Environment.devicePixelRatio)-l,m=(c=o-1-c*i.Environment.devicePixelRatio)-u;if(this._dashed)for(var f=0;f<20;f++){var p=l+h/39*2*f,v=u+m/39*2*f,_=p+h/39,g=v+m/39;this._addQuad(p,v,_,g,12*f,s,o)}else this._addQuad(l,u,d,c,0,s,o);this._drawable.mesh.update(this._vertices,this._indices,n.gl.UNSIGNED_BYTE)},e.prototype.setLineWidth=function(e){this._lineWidth=Math.floor(Math.min(e,1)*i.Environment.devicePixelRatio)},e.prototype.destroy=function(){this._drawable.destroy(),this._vertices=null,this._indices=null},e}()},"./09app/Camera.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./03scene/camera/m3d_scene_camera.js"),n=r("./99api/utils/index.ts"),a=r("./08ui/tool/CameraManipulator.ts"),s=r("./03scene/camera/m3d_camera_animator_transition.js");class o{constructor(e){this._viewer=e;const t=[0,0,this._viewer.getCanvas().width,this._viewer.getCanvas().height];this._viewer?this._scene=e.getScene():this._scene=null,this._manipulator=null,this._scene?this.core=new i.default(this._scene.core,t):this.core=new i.default(null,t),this._animator=new s.default(e.getEventEmitter()),this.cores=[],this.cores.push(this.core)}destroy(){this.core=null,delete this.core;for(let e=0;e<this.cores.length;e++)this.cores[e].destroy();this.cores=null,delete this.cores,this._manipulator&&(this._manipulator.destroy(),this._manipulator=null,delete this._manipulator),this._viewer&&(this._viewer=null,delete this._viewer),this._scene=null,delete this._scene}update(){return this.core.update()}setFov(e){this.core.setTargetFov(e),this._viewer&&this._viewer.invalidate()}setFirstPersonViewEnabled(e){this.core.setFirstPerson(e)}isFirstPersonViewEnabled(){return this.core.isFirstPerson()}setRestrictedViewEnabled(e){this.core.setFirstPerson(e),this._manipulator.setRestrictedViewEnabled(e)}isRestrictedViewEnabled(){return this.core.isFirstPerson()&&this._manipulator.isRestrictedViewEnabled()}switchToView(e){const t=[[0,-.5*Math.PI],[0,.5*Math.PI],[0,Math.PI],[0,0],[.49999*Math.PI,.49999*-Math.PI],[-.49999*Math.PI,.49999*-Math.PI]];let r=null;if(e>=n.ViewAngle.FRONT&&e<=n.ViewAngle.BOTTOM){r=t[e];for(var i=0;i<this.cores.length;i++)this.cores[i].reset(!1),this.cores[i].rotateTo(r[0],r[1])}else{for(i=0;i<this.cores.length;i++)this.cores[i].setFirstPerson(!1),this.cores[i].setPerspective(!0);this._viewer.getEventEmitter().emit("orthoViewChanged",!0);for(i=0;i<this.cores.length;i++)this.cores[i].reset(!1);this.core.reset(!1)}}setSensitivity(e){this._manipulator.setInputSensitivity(e)}addInput(e){this._manipulator||(this._manipulator=new a.default(this._viewer)),this._manipulator.addInput(e)}resize(e,t){const r=[0,0,e,t];for(let e=0;e<this.cores.length;e++)this.cores[e].setViewport(r),this.cores[e].update()}transformToPerspective(){for(var e=0;e<this.cores.length;e++)this.cores[e].transformOrthogonalToPerspective();this._viewer&&(this._viewer.invalidate(),this._viewer.getEventEmitter().emit("orthoViewChanged",!1))}transformToOrthogonal(){for(var e=0;e<this.cores.length;e++)this.cores[e].transformPerspectiveToOrthogonal();this._viewer&&(this._viewer.invalidate(),this._viewer.getEventEmitter().emit("orthoViewChanged",!0))}getData(){return this.core.dump()}setData(e,t=!1){t?(this.core.animator instanceof s.default&&this.core.animator.stop(!0),this._animator.attach(this.core),this._animator.start(e,!1)):this.core.restore(e)}switchToWorldView(){for(var e=0;e<this.cores.length;e++)this.cores[e].setFirstPerson(!1),this.cores[e].setPerspective(!0);this._viewer.getEventEmitter().emit("orthoViewChanged",!1);for(e=0;e<this.cores.length;e++)this.cores[e].reset(!1)}project(e,t){return this.core.project(e,t)}unproject(e,t){return this._manipulator.unproject(e,t)}setMinPitchAngle(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMinPitchAngle(e)}setMaxPitchAngle(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMaxPitchAngle(e)}setMaxTargetDistanceRatio(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMaxTargetDistanceRatio(e)}setMinTargetDistanceRatio(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMinTargetDistanceRatio(e)}setNearPlaneDistanceRatio(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMinZnearRatio(e)}}},"./09app/Camera360.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return l});var i=r("./03scene/camera/m3d_scene_camera.js"),n=r("./03scene/camera/m3d_camera_animator_morphing.js"),a=r("./03scene/camera/m3d_camera_animator_panorama.js"),s=r("./09app/Camera.ts"),o=r("./glMatrix.js");class l extends s.default{constructor(e,t){super(e);const r=[0,0,this._viewer.getCanvas().width,this._viewer.getCanvas().height];this.cores.push(new i.default(null,r)),this.cores[0].setFirstPerson(!0),o.vec3.set(this.cores[0].eye,0,0,0),this.cores[1].setFirstPerson(!0),o.vec3.set(this.cores[1].eye,0,0,0),this._fov=78,this._FOV_CHANGE_SPEED=.3,this.cores[0].setTargetFov(this._fov),this.cores[0]._targetPhi=0,this.cores[0]._targetTheta=0,this.cores[1].setTargetFov(this._fov),this.cores[1]._targetPhi=0,this.cores[1]._targetTheta=0,this._animators=new Array(2),this._eventEmitter=t,this._animators[0]=new n.default(this._eventEmitter),this._animators[1]=new n.default(this._eventEmitter),this._transition=new a.default(this._eventEmitter),this._transition.setTransitionSpeed(80)}destroy(){this._animators[0].destroy(),this._animators[1].destroy(),this._animators=null,delete this._animators,super.destroy()}setFov(e){this.cores[0].setTargetFov(e),this.cores[1].setTargetFov(e),this._viewer&&this._viewer.invalidate()}resize(e,t){this.cores[0].setViewport([0,0,e,t]),this.cores[0].update(),this.cores[1].setViewport([0,0,e,t]),this.cores[1].update()}update(){const e=this.cores[0].update(),t=this.cores[1].update();return e||t}addInput(e){if(super.addInput(e),this._manipulator.setCamera(this.cores),this._manipulator.setPanoramaEnabled(!0),"mouse"===e.name){e.addMouseWheelListener(e=>{const t=-e.delta*this._FOV_CHANGE_SPEED;return this._fov+=t,this._fov>180&&(this._fov=179.99999),this._fov<0&&(this._fov=.001),this.cores[0].setTargetFov(this._fov),this.cores[1].setTargetFov(this._fov),!0})}}transit(e,t){const r=this.cores[e],i=this.cores[1-e],n=this._animators[e],a=this._animators[1-e];n.attach(r),n.start(null,null,null,10),a.attach(i),t?(i._targetFov=i._fov=t.fov,i._targetPhi=i._phi=t.phi,i._targetTheta=i._theta=t.theta,a.start(null,null,140,t.fov)):a.start(null,null,140,78),this._manipulator.setCamera(this.cores,1-e)}getCameraInfo(e){return{fov:this.cores[e]._targetFov,phi:this.cores[e]._targetPhi,theta:this.cores[e]._targetTheta,position:o.vec3.clone(this.cores[e]._at)}}moveTo(e,t){const r=new a.default(this._eventEmitter);r.setTransitionSpeed(300),r.attach(this.cores[e]),r.start(t)}}},"./09app/CameraMultiple.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./03scene/camera/m3d_scene_camera.js"),n=r("./08ui/tool/CameraManipulator.ts"),a=r("./09app/Camera.ts");class s extends a.default{constructor(e){super(e),this._horizontal=!0,this._percentage=.5,this._viewports=new Array(2),this._viewports[0]=new Uint32Array(4),this._viewports[1]=new Uint32Array(4),this.cores.push(new i.default(this._scene.cores[1],this._viewports[1])),this._updateViewports()}destroy(){this._viewports=null,delete this._viewports,super.destroy()}setSplitPercentage(e){this._percentage=e,this._updateViewports()}setSplitHorizontal(e){this._horizontal=e,this._updateViewports()}setFov(e){this.cores[0].setTargetFov(e),this.cores[1].setTargetFov(e),this._viewer&&this._viewer.invalidate()}resize(e,t){this._updateViewports(),this.cores[0].setViewport(this._viewports[0]),this.cores[0].update(),this.cores[1].setViewport(this._viewports[1]),this.cores[1].update()}update(){const e=this.cores[0].update(),t=this.cores[1].update();return e||t}addInput(e){super.addInput(e),this._manipulator||(this._manipulator=new n.default(this._viewer)),this._manipulator.setCamera(this.cores),this._manipulator.addInput(e)}transformToPerspective(){this.cores[0].transformOrthogonalToPerspective(),this.cores[1].transformOrthogonalToPerspective(),this._viewer&&this._viewer.invalidate()}transformToOrthogonal(){this.cores[0].transformPerspectiveToOrthogonal(),this.cores[1].transformPerspectiveToOrthogonal(),this._viewer&&this._viewer.invalidate()}_updateViewports(){const e=this._viewer.getCanvas().width,t=this._viewer.getCanvas().height;this._horizontal?(this._viewports[0][0]=0,this._viewports[0][1]=0,this._viewports[0][2]=Math.round(e*this._percentage),this._viewports[0][3]=t,this._viewports[1][0]=this._viewports[0][2],this._viewports[1][1]=0,this._viewports[1][2]=Math.round(e*(1-this._percentage)),this._viewports[1][3]=t):(this._viewports[0][0]=0,this._viewports[0][1]=0,this._viewports[0][2]=e,this._viewports[0][3]=Math.round(t*this._percentage),this._viewports[1][0]=0,this._viewports[1][1]=this._viewports[0][3],this._viewports[1][2]=e,this._viewports[1][3]=Math.round(t*(1-this._percentage))),this.cores[0].setViewport(this._viewports[0]),this.cores[1].setViewport(this._viewports[1])}}},"./09app/EventEmitter.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(){this.events={}}emit(e,...t){const r=Array.prototype.slice.call(arguments,1);this.events[e]&&this.events[e].forEach(e=>e.apply(null,r))}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>{this.events[e]=this.events[e].filter(e=>e!==t)}}remove(e,t){if(this.events[e]){var r=this.events[e].indexOf(t);-1!==r&&this.events[e].splice(r,1)}}clear(){this.events={}}}},"./09app/Scene.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return i});class i{constructor(e){}destroy(){}}},"./09app/Scene3D.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var i=r("./03scene/Scene.ts"),n=r("./03scene/model/Element.ts"),a=r("./09app/Scene.ts"),s=r("./09app/Viewer.ts");class o extends a.default{constructor(e,t){super(e),this.core=new i.default(e.getResourceManager(),t),this.cores=[],this.cores.push(this.core),this._viewer=e}destroy(){for(let e=0;e<this.cores.length;e++)this.cores[e].destroy();this.cores=null,delete this.cores,this.core=null,delete this.core,super.destroy()}setElementsColor(e,t){this.core.setElementsColor(e,t),this._viewer.invalidate()}setElementsVisibility(e,t,r){this.core.setElementsVisibility(e,t,r),this._viewer.invalidate()}isElementVisible(e){return this.core.isElementVisible(e)}getElementsNames(e=n.ElementType.ANY,t=!1){return this.core.getElementsNames(e,t)}getElementsBBox(e){return this.core.getElementsBBox(e)}getElementBBox(e){return this.core.getElementBBox(e)}getElementMaterials(e){return this.core.getElementMaterials(e)}getElementMaterialNames(e){return this.core.getElementMaterialNames(e)}getPawnMaterialNames(e){return this.core.getPawnMaterialNames(e)}getMaterialType(e){return this.core.getMaterialType(e)}getModelMaterialNames(){return this.core.getModelMaterialNames()}getElementNamesByMaterialName(e){return this.core.getElementNamesByMaterialName(e)}getMaterialParameter(e,t){return this.core.getMaterialParameter(e,t)}setMaterialParameter(e,t,r){return this.core.setMaterialParameter(e,t,r)}setModelVisibility(e,t,r){this.core.setModelVisibility(e,t,r),this._viewer.invalidate()}getElementGuid(e){var t=e.split("+")[0],r=this.core.models[t].tree.elements[e];return void 0===r?(console.warn("elementName: "+e+" not found!"),null):r.guid}getElementNameByGuid(e){var t;for(var r in this.core.models)if(t=this.core.models[r].tree.guidElementMap[e])return t;return console.warn("guid: "+e+" not found!"),null}getClippingData(){return this.core.clipping.isEnabled()?{planes:this.core.clipping.getClippingPlanes(!0),points:this.core.clipping.getClippingPoints(!0)}:null}translateModel(e,t,r,i){let n=this.core.models[e];n&&(n.translate(t,r,i),this._viewer.invalidate())}rotateModel(e,t,r,i){let n=this.core.models[e];n&&(n.rotate(t,r,i),this._viewer.invalidate())}addPawn(e,t=!0){this.core.addPawn(e),e.drawables.forEach(e=>{this._viewer._renderScene.addDrawable(e)}),e.skeletons.forEach(e=>{this._viewer._renderScene.addSkeleton(e)}),t&&this._viewer.getCamera().core.reset(!0),this._viewer.state=s.State.RENDERING,this._viewer.invalidate()}removePawn(e){this.core.removePawn(e),e.drawables.forEach(e=>{this._viewer._renderScene.removeDrawable(e)}),e.skeletons.forEach(e=>{this._viewer._renderScene.removeSkeleton(e)}),this._viewer.invalidate()}addText3D(e,t=!0){this.core.addText3D(e),e.drawables.forEach(e=>{this._viewer._renderScene.addDrawable(e)}),t&&this._viewer.getCamera().core.reset(!0),this._viewer.state=s.State.RENDERING,this._viewer.invalidate()}removeText3D(e){this.core.removeText3D(e),e.drawables.forEach(e=>{this._viewer._renderScene.removeDrawable(e)}),this._viewer.invalidate()}addModel(e,t=!0,r){this.core.addModel(e),e.drawables.forEach(e=>{this._viewer._renderScene.addDrawable(e)}),t&&(r?this._viewer.getCamera().core.reset(!0,r):this._viewer.getCamera().core.reset(!0)),this._viewer.invalidate()}removeModel(e){console.error("TBD")}hasContours(){return this.core.hasContours()}addVisualize(e){this._viewer.getRenderScene().addVisualize(e),this._viewer.invalidate()}removeVisualize(e){this._viewer.getRenderScene().removeVisualize(e),this._viewer.invalidate()}getVisualize(e,t=0){return this._viewer.getRenderScene().getVisualize(e,t)}getVisualizes(e){return this._viewer.getRenderScene().getVisualizes(e)}setBackgroundImage(e,t=!1){this.core.background.setImages(e),t&&this.core.setReflectionMap(this.core.background.skybox.getTexture())}setReflectionMap(e){var t=this._viewer.getResourceManager().getTexture("mx-reflection-map");if(!t.ready&&e||(t.destroy(),t=this._viewer.getResourceManager().getTexture("mx-reflection-map")),e){var r=this._viewer.getResourceManager().gl;if("string"==typeof e){var i=e.split(".");if("dds"!==i[i.length-1].toLowerCase())return void console.error("File format of"+e+"is not supported!");t.createFromDDS(e,()=>{this.core.setReflectionMap(t),this._viewer.invalidate()})}else e[0]instanceof HTMLImageElement?(t.createFromImages(e,r.RGB,r.UNSIGNED_BYTE,r.LINEAR,r.CLAMP_TO_EDGE),t.generateCubeMapMipMap(),this.core.setReflectionMap(t),this._viewer.invalidate()):t.createFromFiles(e,r.RGB,r.LINEAR,r.CLAMP_TO_EDGE,()=>{t.generateCubeMapMipMap(),this.core.setReflectionMap(t),this._viewer.invalidate()})}else this.core.setReflectionMap(null)}setToneMappingEnabled(e){this.core.setToneMappingEnabled(e)}setToneMappingExposure(e){this.core.setToneMappingExposure(e)}}},"./09app/Scene3DMultiple.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./03scene/Scene.ts"),n=r("./09app/Scene3D.ts");class a extends n.default{constructor(e){super(e,e.getMaterialManager()),this.cores.push(new i.default(e.getResourceManager(),e.getMaterialManager()))}addPawnViewport(e,t){this.cores[e].addPawn(t),t.drawables.forEach(t=>{this._viewer._renderScenes[e].addDrawable(t)}),this._viewer.invalidate()}addModelViewport(e,t){this.cores[e].addModel(t),t.drawables.forEach(t=>{this._viewer._renderScenes[e].addDrawable(t)}),this._viewer.invalidate()}}},"./09app/Viewer.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"State",function(){return i}),r.d(t,"Viewer",function(){return l});var i,n=r("./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js"),a=r("./00utility/Environment.ts"),s=r("./00utility/m3d_hwinfo.js"),o=r("./09app/EventEmitter.ts");!function(e){e[e.INITIALIZED=-1]="INITIALIZED",e[e.UNINITIALIZED=-2]="UNINITIALIZED",e[e.RENDERING=-3]="RENDERING",e[e.INITIALIZED_PAUSED=-4]="INITIALIZED_PAUSED",e[e.RENDERING_PAUSED=-5]="RENDERING_PAUSED"}(i||(i={}));class l{constructor(e,t={isMobile:!1}){if(this.state=i.UNINITIALIZED,this._canvasId="ModeloCanvas-"+e,this._container=document.getElementById(e),!this._container)throw Error(`The container '${e}' doesn't exist.`);if(0===this._container.clientHeight)throw Error(`The container '${e}' should have height`);if(this._canvas=document.getElementById(this._canvasId),this._canvas)throw Error(`A viewer has already been created in container '${this._canvas.parentElement.id}'. Please call viewer.destroy() first.`);this._canvas=document.createElement("canvas"),this._canvas.id=this._canvasId,this._canvas.style.display="block",this._container.appendChild(this._canvas),this._canvas.oncontextmenu=function(){return!1};const r=this._container.clientWidth,l=this._container.clientHeight;a.Environment.devicePixelRatio=t.devicePixelRatio||window.devicePixelRatio;const d=Math.floor(r*a.Environment.devicePixelRatio),u=Math.floor(l*a.Environment.devicePixelRatio);this._canvas.width=d,this._canvas.height=u,this._canvas.style.width=r+"px",this._canvas.style.height=l+"px";const c=new s.default;a.Environment.littleEndian=c.littleEndian,a.Environment.gpuMemory=Math.round(.5*c.vramSize),a.Environment.browserName=c.browserName,a.Environment.browserVersion=c.browserVersion,a.Environment.isMobile=t.isMobile,this._eventEmitter=new o.default,this._inputs=[],this._tools=[],this._ro=new n.default(e=>{e.forEach(e=>{const{width:t,height:r}=e.contentRect;this.resize(t,r)})}),this._ro.observe(this._container),this.state=i.INITIALIZED}resize(e,t){e=e||1,t=t||1;const r=Math.floor(e*a.Environment.devicePixelRatio),i=Math.floor(t*a.Environment.devicePixelRatio);this._canvas.width=r,this._canvas.height=i,this._canvas.style.width=e+"px",this._canvas.style.height=t+"px"}destroy(){this.state!==i.UNINITIALIZED&&(this._ro.unobserve(this._container),this._ro=null,delete this._ro,this._inputs.forEach(e=>{e.destroy()}),this._inputs=null,delete this._inputs,this._tools.forEach(e=>{e.destroy()}),this._tools=null,delete this._tools,this._eventEmitter=null,delete this._eventEmitter,this.state=i.UNINITIALIZED,this._canvas.remove(),this._canvas=null,delete this._canvas,this._container=null,delete this._container,console.log("%cThe viewer gets destroyed","font-weight:bold;"))}pause(){}resume(){}invalidate(){}addInput(e){if(!e.isAvailable(a.Environment.isMobile))return console.warn(`${e.name} is not supported on current platform.`),-1;for(let t=0;t<this._inputs.length;t++)if(this._inputs[t].name===e.name)return-1;e.setEnabled(!0);const t=this._inputs.length;return this._inputs.push(e),t}removeInput(e){var t=this._inputs[e];e>=0&&e<this._inputs.length&&this._inputs.slice(e,1),t.destroy()}getInput(e){return e>=0&&e<this._inputs.length?this._inputs[e]:null}addTool(e){if(!e.doesSupportMobile(a.Environment.isMobile))return null;for(let t=0;t<this._tools.length;t++)if(this._tools[t].name===e.name)return null;for(let t=0;t<this._inputs.length;t++)e.addInput(this._inputs[t]);return this._tools.push(e),e}getTool(e){for(let t=0;t<this._tools.length;t++)if(this._tools[t].name===e)return this._tools[t];return null}removeTool(e){for(let t=0;t<this._tools.length;t++)if(this._tools[t].name===e){this._tools[t].destroy(),this._tools.splice(t,1);break}}getWidth(){return this._canvas.width}getHeight(){return this._canvas.height}getCanvas(){return this._canvas}getEventEmitter(){return this._eventEmitter}}},"./09app/Viewer360.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return v});var i=r("./03scene/drawables/Skybox.ts"),n=r("./03scene/camera/m3d_camera_animator_morphing.js"),a=r("./04renderer/pipeline/RenderTarget.ts"),s=r("./07loadsave/Load360.ts"),o=r("./09app/Camera360.ts"),l=r("./09app/Viewer.ts"),d=r("./09app/Viewer3D.ts"),u=r("./glMatrix.js"),c=r("./99api/utils/client/index.ts"),h=r("./node_modules/axios/index.js"),m=r.n(h),f=r("./00utility/Environment.ts"),p=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};class v extends d.default{constructor(e,t){super(e,t),this._data={},this._skyboxes=[],this._renderTarget=null,this._viewDirection=u.vec3.create(),this._current=0,this._currentAssetId="",this._camera=new o.default(this,this._eventEmitter),this._renderTarget=new a.default("default",this._resourceManager,this._canvas.width,this._canvas.height,{blend:!0,depthTest:!1}),this._skyboxes[0]=new i.default(this._resourceManager),this._skyboxes[0].setMode(i.SkyBoxMode.SKYBOX_CUBEMAP),this._skyboxes[1]=new i.default(this._resourceManager),this._skyboxes[1].setMode(i.SkyBoxMode.SKYBOX_CUBEMAP)}destroy(){this.state!==l.State.UNINITIALIZED&&(this.pause(),this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._data=null,delete this._data,this._skyboxes[0].destroy(),this._skyboxes[1].destroy(),this._skyboxes=null,delete this._skyboxes,super.destroy())}_detectIndicator(e,t=.607){if(u.vec3.set(this._viewDirection,-e.viewMatrix[2],-e.viewMatrix[6],-e.viewMatrix[10]),!this._data[this._currentAssetId])return;let r=[];for(let i=0;i<this._data[this._currentAssetId].toAssets.length;i++){if(!this._data[this._currentAssetId].ready)continue;let n=this._data[this._currentAssetId].toAssets[i],a=u.vec3.clone(n.position);u.vec3.normalize(a,a);let s=u.vec3.dot(a,this._viewDirection),o=e.project(n.position);"panorama"===n.type?r.push({assetId:n.assetId,name:this._data[n.assetId].name,screenPosition:[o[0],o[1]],visible:!!(s>t&&o[2])}):r.push({annotation:n,screenPosition:[o[0],o[1]],visible:!!(s>t&&o[2])})}this._eventEmitter.emit("updatePanoramaIndicator",r)}switchPanorama(e,t,r=!0){this.state=l.State.INITIALIZED,r&&this._resetScene(t),this._currentAssetId=e,this._skyboxes[this._current].setImage(this._data[this._currentAssetId].images),this.state=l.State.RENDERING}moveTo(e){this._camera.moveTo(this._current,e)}loadPanos(e,t){return p(this,void 0,void 0,function*(){let r,i,n;var a;"object"==typeof(a=t)&&null!==a?(r=t.onProgress,i=t.onIndicatorsUpdate,n=t.resolution):r=t,r||(r=(()=>{})),e.indicators||(e.indicators=[]),e.annotations||(e.annotations=[]);const s=yield Promise.all(e.panoIds.map(e=>Object(c.getAsset)(e)));s.forEach(e=>{if(!e.panoConvertedUrl)throw Error(`asset ${e.id} is not a panorama image`)});const o=yield Promise.all(s.map(e=>m.a.get(e.panoConvertedUrl))),l={};return o.forEach((e,t)=>{let r=[];const i=e.data,a=Object.keys(i);a.forEach(e=>{if(e.startsWith("1024_left")?r.push(1024):e.startsWith("2048_left")?r.push(2048):e.startsWith("4096_left")&&r.push(4096),!r.length)throw Error(`asset ${s[t].id} image urls error`);if(n&&!r.includes(n))throw Error("resolution not valid");n||(n=r[r.length-1]),l[s[t].id]={imageUrls:a.filter(e=>e.startsWith(n+"")).map(e=>i[e]),images:[],name:s[t].name,ready:!1,toAssets:[],type:"cubemaps"}})}),e.indicators.forEach((e,t)=>{l[e.from].toAssets.push({id:"indicator-"+t,type:"panorama",assetId:e.to,camera:e.camera,position:e.position,fromAsset:e.from})}),e.annotations.forEach((e,t)=>{l[e.from].toAssets.push({id:"annotation-"+t,type:"annotation",fromAsset:e.from,position:e.position})}),this.getEventEmitter().on("updatePanoramaIndicator",t=>{i&&i(t.map((t,r)=>t.annotation?{position:t.screenPosition,visible:t.visible,annotation:t.annotation}:{from:e.indicators[r].from,to:t.assetId,camera:e.indicators[r].camera,position:t.screenPosition,visible:t.visible,name:t.name||l[t.assetId].name}))}),new Promise((t,i)=>{this._load360(l,e.panoIds,t,i,r)})})}loadPano(e,t){return p(this,void 0,void 0,function*(){return this.loadPanos({panoIds:[e],indicators:[],annotations:[]},t)})}_load360(e,t,r,i,n){this._data=e,new s.default(this._data,this).load(null,{},t,()=>{const e=t[0];this._data[e].ready&&(this._currentAssetId=t[0],this._skyboxes[0].setImage(this._data[e].images)),this.state=l.State.RENDERING},()=>{this.invalidate(),r()},(e,t)=>{n(e,t)}).catch(function(e){i(e)})}getCameraInfo(){return this._camera.getCameraInfo(this._current)}getCurrentCamera(){return this._camera.cores[this._current]}dumpScreen(e,t){e||t?t||(t=e*this._canvas.height/this._canvas.width):(e=this._canvas.width,t=this._canvas.height);var r=Math.floor(this._canvas.width/f.Environment.devicePixelRatio),i=Math.floor(this._canvas.height/f.Environment.devicePixelRatio),n=Math.floor(e/f.Environment.devicePixelRatio),a=Math.floor(t/f.Environment.devicePixelRatio);n===r&&a===i||this.resize(n,a),this._update(!0);const s=this._canvas.toDataURL("image/jpeg",.75);return n!==r||a!==i?this.resize(r,i):this.invalidate(),s}_resetScene(e){this._camera.transit(this._current,e),this._current=1-this._current}resize(e,t){super.resize(e,t),this._camera.resize(this._canvas.width,this._canvas.height),this._renderTarget.resize(this._canvas.width,this._canvas.height),this.invalidate()}_drawScene(){let e=this._camera;e.cores[this._current].animator instanceof n.default?(this._renderer.drawSkybox(this._renderTarget,this._skyboxes[1-this._current],e.cores[1-this._current]),this._renderer.endFrame(),this._renderer.beginFrame(),this._skyboxes[this._current].setTransparency(1-e.cores[this._current].animator.getProgress())):this._detectIndicator(e.cores[this._current]),this._renderer.drawSkybox(this._renderTarget,this._skyboxes[this._current],e.cores[this._current])}_update(e=!1){this.state===l.State.RENDERING&&(this._camera.update()||e)&&(this._renderer.beginFrame(),this._drawScene(),this._renderer.endFrame())}}},"./09app/Viewer3D.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"defaultGLConfig",function(){return y}),r.d(t,"default",function(){return x});var i=r("./00utility/m3d_math.js"),n=r("./01wrapper/m3d_wgl.release.js"),a=r("./02resource/ResourceManager.ts"),s=r("./03scene/MaterialManager.ts"),o=r("./03scene/model/Model.ts"),l=r("./04renderer/pipeline/m3d_renderer.js"),d=r("./04renderer/pipeline/RenderScenePR.ts"),u=r("./04renderer/pipeline/RenderSceneExploded.ts"),c=r("./08ui/tool/Snapping.ts"),h=r("./08ui/tool/SnappingApprox.ts"),m=r("./09app/Scene3D.ts"),f=r("./09app/Camera.ts"),p=r("./09app/Viewer.ts"),v=r("./99api/Version.ts"),_=r("./99api/Comment.ts"),g=r("./00utility/Environment.ts"),b=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const y={isMobile:!1,transparent:!1,stencil:!1,samples:4};class x extends p.Viewer{constructor(e,t){super(e,t),console.log(`[${this._canvas.id}]`+" %cmodeloapi version: "+v.VERSION,"font-weight:bold;"),this._elapsedFrames=0;const r=this._setupGL(Object.assign({},y,t));this._resourceManager=new a.default(r),this._renderer=new l.default(this._resourceManager),this._materialManager=new s.default(this._resourceManager),this._scene=new m.default(this,this._materialManager),this._camera=new f.default(this),this._renderScene=new d.default(this._scene.core,this._camera.core,this._resourceManager,this._renderer,t&&t.stencil),this._snapping=null,this._onContextLostFn=null,this._onContextRestoreFn=null,this._canvas.addEventListener("webglcontextlost",this._onGLContextLost.bind(this),!1),this._canvas.addEventListener("webglcontextrestored",this._onGLContextRestore.bind(this),!1),this._onUpdate=null,this._animationFn=this._requestAnimationFrame.bind(this),this._animationId=window.requestAnimationFrame(this._animationFn),this._update(!0)}destroy(){if(this.state===p.State.UNINITIALIZED)return;this._cancelAnimationFrame(),this._canvas.removeEventListener("webglcontextlost",this._onGLContextLost.bind(this),!1),this._canvas.removeEventListener("webglcontextrestored",this._onGLContextRestore.bind(this),!1),this._renderScene.destroy(),this._renderScene=null,delete this._renderScene,this._renderer.destroy(),this._renderer=null,delete this._renderer,this._scene.destroy(),this._scene=null,delete this._scene;const e=this._resourceManager.gl;this._resourceManager.destroy(),this._resourceManager=null,delete this._resourceManager,this._camera&&(this._camera.destroy(),this._camera=null,delete this._camera),this._snapping&&(this._snapping.destroy(),this._snapping=null,delete this._snapping),this._destroyGL(e),super.destroy()}invalidate(){this._renderer.invalidate(),this._renderScene.refreshRendering(),super.invalidate()}resize(e,t){if(super.resize(e,t),this.state!==p.State.UNINITIALIZED&&this.state!==p.State.INITIALIZED_PAUSED&&this.state!==p.State.RENDERING_PAUSED){e=this._canvas.width,t=this._canvas.height,this._camera.resize(e,t),this._renderScene.resize(e,t),null!==this._snapping&&this._snapping.resize(e,t);for(let r=0;r<this._tools.length;r++)this._tools[r].resize(e,t);this.invalidate()}}loadModel(e,t,r,i,n){return b(this,void 0,void 0,function*(){let a=!1;if("object"==typeof(s=t)&&null!==s){a=t.usePbr,r=r||t.changeCamera;const s=t.cameraInfo,{onProgress:o=(()=>{}),initialTransform:l=[]}=t;return this._load(e,l,o,r,a,s,i,n)}{const s=t||(()=>{});return this._load(e,[],s,r,a,null,i,n)}var s})}_load(e,t,r,i,n,a,s,l){return b(this,void 0,void 0,function*(){let d=new o.default(e,t,this._resourceManager,this._materialManager,n,s);return t&&0!==t.length||(t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),d.load(e,r,s,l).then(()=>{this.state=p.State.RENDERING,this._elapsedFrames=1,this._scene.addModel(d,i,a),this._renderScene.optimize();let t=()=>{this._camera.core.setCullingEnabled(!0),this._camera.core.removeUpdateStopListener(t)};return this._camera.core.addUpdateStopListener(t),_.Comment.create=_.create.bind(null,this),_.Comment.activate=_.activate.bind(null,this),Promise.resolve(e)})})}setDefaultCam(e){this._camera.core.setDefaultCam(e)}_cancelAnimationFrame(){window.cancelAnimationFrame(this._animationId),this._animationId=-1}_requestAnimationFrame(){this._update(),this._animationId=window.requestAnimationFrame(this._animationFn)}_update(e=!1){if(!e&&this.state!==p.State.RENDERING)return;this.getEventEmitter().emit("before-rendering"),this._camera.update()&&this._renderScene.refreshRendering(1),this._onUpdate&&this._onUpdate(),this._renderer.beginFrame();let t=!1;this._tools.forEach(e=>{t=t||e.isInteractive()});let r=this._renderScene.draw(t);t&&this._tools.forEach(e=>{e.render()}),r&&this._renderer.present(this._renderScene.getRenderTarget().getFramebuffer()),this._renderer.endFrame(),r&&this._elapsedFrames++}pause(){this.state!==p.State.INITIALIZED&&this.state!==p.State.RENDERING||(this.state=this.state===p.State.INITIALIZED?p.State.INITIALIZED_PAUSED:p.State.RENDERING_PAUSED,this._resourceManager.discard(),this._cancelAnimationFrame()),super.pause()}resume(){this.state!==p.State.INITIALIZED_PAUSED&&this.state!==p.State.RENDERING_PAUSED||(this._resourceManager.restore(),this.state=this.state===p.State.INITIALIZED_PAUSED?p.State.INITIALIZED:p.State.RENDERING);const e=parseInt(this._canvas.style.width.replace("px","")),t=parseInt(this._canvas.style.height.replace("px",""));this.resize(e,t),this.invalidate(),this._requestAnimationFrame(),super.resume()}dumpScreen(e,t,r){const i=[];i[0]=this._scene.core.background.color[0],i[1]=this._scene.core.background.color[1],i[2]=this._scene.core.background.color[2],i[3]=this._scene.core.background.color[3],e||t?t||(t=e*this._canvas.height/this._canvas.width):(e=this._canvas.width,t=this._canvas.height);var n=Math.floor(this._canvas.width/g.Environment.devicePixelRatio),a=Math.floor(this._canvas.height/g.Environment.devicePixelRatio),s=Math.floor(e/g.Environment.devicePixelRatio),o=Math.floor(t/g.Environment.devicePixelRatio);r?this.setBackgroundColor(r):this._scene.core.background.skybox||this.setBackgroundColor([.96,.96,.96,1]),s!==n||o!==a?this.resize(s,o):this.invalidate(),this._renderScene.drawHD(),this.setBackgroundColor(i);const l=this._canvas.toDataURL("image/jpg");return s!==n||o!==a?this.resize(n,a):this.invalidate(),l}setLightingLatitude(e){this._scene.core.setLightingLatitude(e),this._renderScene.updateShadow(!0),this.invalidate()}setLightingLongitude(e){this._scene.core.setLightingLongitude(e),this._renderScene.updateShadow(!0),this.invalidate()}setLightingIntensity(e){this._scene.core.setLightingIntensity(e),this.invalidate()}setRenderingLinesEnabled(e){this._renderScene.setLineRendering(e),this.invalidate()}setBaseRenderingEnabled(e){this._renderScene.setBaseRenderingEnabled(e),this.invalidate()}setSpecularEnabled(e){this._renderScene.setSpecularEnabled(e),this.invalidate()}setShadowEnabled(e){this._renderScene.setShadowEnabled(e),this.invalidate()}addInput(e){const t=super.addInput(e);return this._camera.addInput(e),t}getMouse(){for(let e=0;e<this._inputs.length;e++)if("mouse"===this._inputs[e].name)return this._inputs[e];return null}getKeyboard(){for(let e=0;e<this._inputs.length;e++)if("keyboard"===this._inputs[e].name)return this._inputs[e];return null}_setupGL(e){const{isMobile:t,stencil:r,samples:i}=e,a=g.Environment.browserName,s=g.Environment.browserVersion;let o=!0;var l=!0;"chrome"===a&&"62"===s&&(l=!1),"mobile safari"===a&&(o=!1),t&&512===g.Environment.gpuMemory&&(o=!1);const d=Object(n.default)(this._canvas,{depth:!0,alpha:!0,premultipliedAlpha:!1,samples:i,stencil:r,preserveDrawingBuffer:!1,vao:l,instancing:!1,webgl2:o});if(null!==d){const e=d.isWebGL2?"2.0":"1.0";console.group(`[${this._canvas.id}] A WebGL ${e} context created`),console.log(`color: RGBA, depth: enabled, stencil: ${r?"enabled":"disabled"}`),console.log("  VAO: "+(l?"enabled":"disabled")),console.log("  Instancing: "+(d.instancingExtension?"enabled":"disabled")),console.groupEnd()}return d}_destroyGL(e){if(e){const t=e.isWebGL2?"2.0":"1.0";console.group(`A WebGL ${t} context is destroyed`);const r=e.getExtension("WEBGL_lose_context");null!==r&&r.loseContext(),e=void 0,console.groupEnd()}}setBackgroundColor(e){this._scene.core.background.setColor(e),this.invalidate()}setBackgroundImage(e,t=!1){this._scene.setBackgroundImage(e,t),this.invalidate()}setReflectionImages(e){this._scene.setReflectionMap(e),this.invalidate()}setBackgroundMode(e){this._scene.core.background.setMode(e),this.invalidate()}getScene(){return this._scene}getSnapping(){return null===this._snapping&&(this._resourceManager.gl.isWebGL2&&this.getScene().hasContours()?this._snapping=new c.default(this._scene.core,this._camera.core,this._resourceManager,this._renderScene.getRenderQueueManager()):(this._snapping=new h.default(this._scene.core,this._camera.core,this._resourceManager,this._renderScene.getRenderQueueManager()),this._snapping.setSnappingRadius(8))),this._snapping}getResourceManager(){return this._resourceManager}getMaterialManager(){return this._materialManager}getRenderer(){return this._renderer}getRenderScene(){return this._renderScene}getCamera(){return this._camera}setLazyRenderingEnabled(e){this._renderScene.setProgressiveRenderingEnabled(e)}_onGLContextLost(){this._cancelAnimationFrame(),this._onContextLostFn&&this._onContextLostFn()}_onGLContextRestore(){this._onContextRestoreFn&&this._onContextRestoreFn()}setContextLostCbk(e){this._onContextLostFn=e}setContextRestoreCbk(e){this._onContextRestoreFn=e}setUpdateCallback(e){this._onUpdate=e}setSmartCullingEnabled(e){this._renderScene.setSmartCullingEnabled(e)}isSmartCullingEnabled(){return this._renderScene.isSmartCullingEnabled()}setEffectEnabled(e,t){this._renderScene.setEffectEnabled(e,t),this.invalidate()}setEffectParameter(e,t,r){this._renderScene.getEffect(e).setParameter(t,r),this.invalidate()}isEffectEnabled(e){return this._renderScene.isEffectEnabled(e)}enterExplodedView(e,t){if(this._renderScene instanceof u.default)return;let r=new u.default(this._scene.core,this._renderScene,this._camera.core,this._resourceManager,this._renderer);r.previous=this._renderScene,this._renderScene=r;for(let t=0;t<e.length;t++)r.renderElements(e[t]);r.renderElementsTranslations(t),r.enter(2e3),this.invalidate()}quitExplodedView(){if(!(this._renderScene instanceof u.default))return;this._renderScene.quit(()=>{let e=this._renderScene;this._renderScene=e.previous,e.destroy(),this.invalidate()}),this.invalidate()}setOverrideColor(e){let t,r=this._materialManager.createMaterialAdhoc("override");this._resourceManager.hasShader("solid",[])&&(t=this._resourceManager.getShader("solid",[])),this._resourceManager.hasShader("texture",[])&&(t=this._resourceManager.getShader("texture",[])),this._resourceManager.hasShader("dark",[])&&(t=this._resourceManager.getShader("dark",[])),r.attachShader(t),r.setDiffuse(e),r.setTransparent(e[3]),this._renderScene.setOverridedMaterials({opaques:r}),this.invalidate()}setOITEnabled(e){this._renderScene.setOITEnabled(e),this.invalidate()}focusElements(e,t=1){if(null!=e&&0!=e.length){var r=this._scene.getElementsBBox(e);i.default.aabb.length(r)>=1/0||this._camera.cores.forEach(e=>{e.lookTo(i.default.aabb.center(r),t*i.default.aabb.length(r)/2)})}}getSelectedElements(){let e=this.getTool("SelectElement");return e?e.getSelectedElements():[]}getElapsedFrames(){return this._elapsedFrames}setMaterialParameter(e,t,r){this._scene.setMaterialParameter(e,t,r),"opacity"===t&&this._renderScene.onOpacityChanged(this._scene.core.getDrawablesByMaterialName(e)),this.invalidate()}getMaterialParameter(e,t){return this._scene.getMaterialParameter(e,t)}setToneMappingEnabled(e){this._scene.setToneMappingEnabled(e),this.invalidate()}setToneMappingExposure(e){e<=0?console.warn("Exposure should be greater than 0!"):(this._scene.setToneMappingExposure(e),this.invalidate())}enabledTwoPointsPerspective(e){this._camera.core.enabledTwoPointsPerspective(e),this.invalidate()}}},"./09app/Viewer3DCompare.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});var i=r("./09app/Viewer.ts"),n=r("./03scene/model/Model.ts"),a=r("./09app/Viewer3D.ts"),s=r("./04renderer/pipeline/RenderSceneForward.ts"),o=r("./09app/Scene3DMultiple.ts"),l=r("./09app/CameraMultiple.ts"),d=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};class u extends a.default{constructor(e,t){super(e,t),this._scene=new o.default(this),this._camera=new l.default(this),this._renderScenes=[],this._renderScenes.push(new s.default(this._scene.cores[0],this._camera.cores[0],this._resourceManager,this._renderer)),this._renderScenes.push(new s.default(this._scene.cores[1],this._camera.cores[1],this._resourceManager,this._renderer)),this._renderScenes[0].setScissorEnabled(!0),this._renderScenes[1].setScissorEnabled(!0),this._material=this._materialManager.createMaterialAdhoc("select-elements-other"),this._update(!0)}destroy(){this._renderScenes[0].destroy(),this._renderScenes[1].destroy(),this._renderScenes=null,delete this._renderScenes,this._camera.destroy(),this._camera=null,delete this._camera,super.destroy()}resize(e,t){this._paused||(super.resize(e,t),this.invalidate())}loadModelAtViewport(e,t,r){return d(this,void 0,void 0,function*(){if(((t=t||0)<0||t>1)&&console.error("Invalid viewport index. Maximum 2 viewports are supported."),"object"==typeof(i=r)&&null!==i){const{onProgress:i=(()=>{}),initialTransform:n=[]}=r;return this._loadToViewport(e,t,n,i)}{const i=r||(()=>{});return this._loadToViewport(e,t,[],i)}var i})}_loadToViewport(e,t,r,a){return d(this,void 0,void 0,function*(){r&&0!==r.length||(r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);let s=new n.default(e,r,this._resourceManager,this._materialManager);return s.load(e,a).then(()=>{return this.state=i.State.RENDERING,this._elapsedFrames=1,this._scene.addModelViewport(t,s),this._renderScenes[t].optimize(),this._camera.cores[t].setCullingEnabled(!0),Promise.resolve(e)})})}_update(e=!1){!e&&this.state!==i.State.RENDERING||void 0===this._renderScenes||(this._camera.update()&&(this._renderScenes[0].refreshRendering(1),this._renderScenes[1].refreshRendering(1)),this._onUpdate&&this._onUpdate(),this._renderer.beginFrame(),this._renderer.invalidate(),this._renderScenes[0].draw(!1),this._renderer.invalidate(),this._renderScenes[1].draw(!1),this._renderer.present(this._renderScene.getRenderTarget().getFramebuffer()),this._renderer.endFrame(),this._elapsedFrames++)}focusElementsInViewport(e,t,r,i){this._renderScenes[e].setOverridedMaterials(this._material),this._material.setDiffuse([1,1,1]),this._material.setTransparent(.4),this._renderScenes[e].renderElements(t,i),r&&this.focusElements(t)}}},"./09app/Viewer3DDark.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var i=r("./02resource/m3d_shader_library.js"),n=r("./09app/Viewer3D.ts"),a=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};class s extends n.default{constructor(e,t){super(e,t)}loadModel(e,t,r,n,s){const o=Object.create(null,{loadModel:{get:()=>super.loadModel}});return a(this,void 0,void 0,function*(){return o.loadModel.call(this,e,t,r,n,s).then(e=>{this.setBackgroundColor([26/255,26/255,55/255,1]);var t=this._resourceManager.getShader("dark",[]);if(!t.ready){var r=i.default.dark;t.createFromShaderSource(r,[])}return this._renderScene.setOverridedShaders(t),this.setSpecularEnabled(!0),this.setEffectEnabled("Sketch",!0),this.setEffectParameter("Sketch","color",[81/255,185/255,1]),this.setEffectParameter("Sketch","colored",!1),this.setEffectParameter("Sketch","surfaceColor",[.2,145/255,1,.2]),this.setEffectParameter("Sketch","transparents",!0),this.setEffectEnabled("SSAO",!0),this.setEffectParameter("SSAO","transparents",!0),Promise.resolve(e)})})}}},"./09app/animator/PathFollowingAnimator.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var i=r("./00utility/Path.ts"),n=r("./glMatrix.js");class a{constructor(e,t,r=!0){this._update=(()=>{if(this._playing){var e=this._speed*this._frameNumber;if(e>this._distances[this._distances.length-1]){if(!this._loop)return void(this._playing=!1);e=0,this._frameNumber=0}for(var t=0;t<this._distances.length-2&&!(e>=this._distances[t]&&e<this._distances[t+1]);t++);var r=(e-this._distances[t])/(this._distances[t+1]-this._distances[t]);n.vec3.lerp(this._currentPosition,this._points[t],this._points[t+1],r),this._currentPoseMatrix=[this._binormals[t][0],this._binormals[t][1],this._binormals[t][2],0,this._tangents[t][0],this._tangents[t][1],this._tangents[t][2],0,this._normals[t][0],this._normals[t][1],this._normals[t][2],0,this._currentPosition[0],this._currentPosition[1],this._currentPosition[2],1];for(var i=0;i<this._pawns.length;i++)n.mat4.copy(this._currentMatrix,this._pawns[i].getTransformMatrix()),this._currentMatrix[12]=0,this._currentMatrix[13]=0,this._currentMatrix[14]=0,n.mat4.multiply(this._currentMatrix,this._currentPoseMatrix,this._currentMatrix),this._pawns[i].drawables.forEach(e=>{e.transform.set(this._currentMatrix),e.updateBBox()});this._frameNumber++}}),this._useDefaultUpVector=r;var a=new i.Path3D(t,[0,0,1],r);this._points=a.getCurve(),this._normals=a.getNormals(),this._tangents=a.getTangents(),this._binormals=a.getBinormals(),this._distances=a.getDistances(),this._pawns=[],this._speed=.1,this._frameNumber=0,this._currentPoseMatrix=n.mat4.create(),this._currentMatrix=n.mat4.create(),this._playing=!1,this._currentPosition=n.vec3.create(),this._loop=!0,this._viewer=e,e.getEventEmitter().on("before-rendering",this._update)}destroy(){this._useDefaultUpVector=null,delete this._useDefaultUpVector,this._points=null,delete this._points,this._normals=null,delete this._normals,this._tangents=null,delete this._tangents,this._binormals=null,delete this._binormals,this._distances=null,delete this._distances,this._pawns=null,delete this._pawns,this._speed=null,delete this._speed,this._frameNumber=null,delete this._frameNumber,this._currentPoseMatrix=null,delete this._currentPoseMatrix,this._currentMatrix=null,delete this._currentMatrix,this._playing=null,delete this._playing,this._currentPosition=null,delete this._currentPosition,this._viewer=null,delete this._viewer,this._viewer.getEventEmitter().remove("before-rendering",this._update)}isInteractive(){return!0}doesSupportMobile(e){return!0}addPawn(e){this._pawns.push(e)}start(){this._playing=!0,this._frameNumber=0}stop(){this._playing=!1}resume(){this._playing=!0}setSpeed(e){this._speed=e}setLoop(e){this._loop=e}}},"./99api/Asset.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"Asset",function(){return i});var i,n=r("./99api/utils/client/asset.ts"),a=r("./99api/utils/index.ts"),s=r("./99api/graphql.types.ts"),o=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};!function(e){e.upload=function(e,t){return o(this,void 0,void 0,function*(){if("object"==typeof(r=t)&&null!==r){const{onProgress:r=(()=>{}),type:i}=t;return i&&Object(a.assert)(i,Object(a.oneOf)([s.AssetType.File,s.AssetType.Dwg,s.AssetType.Img,s.AssetType.Wbs,s.AssetType.ModelConvertedPdf,s.AssetType.Image360]),"asset type not supported"),Object(n.uploadAsset)(e,i,r)}{const r=t||(()=>{});return Object(n.uploadAsset)(e,null,r)}var r})},e.get=function(e){return o(this,void 0,void 0,function*(){return Object(n.getAsset)(e)})},e.remove=function(e){return o(this,void 0,void 0,function*(){return Object(n.deleteAsset)(e)})},e.update=function(e,t){return o(this,void 0,void 0,function*(){return Object(n.updateAsset)(e,t)})}}(i||(i={}))},"./99api/BIM.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"BIM",function(){return i});var i,n=r("./99api/utils/client/index.ts"),a=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};!function(e){let t;!function(e){e.Family="family",e.Level="level",e.Element="element",e.Category="category",e.Type="type",e.File="file"}(t=e.BIMTreeNodeType||(e.BIMTreeNodeType={})),e.getElementProperties=function(e,t,r){return a(this,void 0,void 0,function*(){return n.getElementProperties(e,t,r)})},e.getElementsProperties=function(e,t){return a(this,void 0,void 0,function*(){return n.getElementsProperties(e,t)})},e.addCustomElementProperty=function(e,t,r,i){return a(this,void 0,void 0,function*(){return n.addCustomElementProperty(e,t,r,i)})},e.addCustomElementsProperty=function(e,t,r,i){return a(this,void 0,void 0,function*(){return n.addCustomElementsProperty(e,t,r,i)})},e.removeCustomElementProperty=function(e,t,r){return a(this,void 0,void 0,function*(){return n.removeCustomElementProperty(e,t,r)})},e.removeCustomElementsProperty=function(e,t,r){return a(this,void 0,void 0,function*(){return n.removeCustomElementsProperty(e,t,r)})},e.updateElementProperty=function(e,t,r){return a(this,void 0,void 0,function*(){return n.updateElementProperty(e,t,r)})},e.updateElementsProperty=function(e,t,r){return a(this,void 0,void 0,function*(){return n.updateElementsProperty(e,t,r)})},e.getTreeInfo=function(e,t){return a(this,void 0,void 0,function*(){return n.getBimTree(e,t)})}}(i||(i={}))},"./99api/Comment.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"create",function(){return l}),r.d(t,"activate",function(){return d}),r.d(t,"Comment",function(){return u});var i=r("./99api/utils/client/index.ts"),n=r("./08ui/tool/Comment.ts"),a=r("./99api/utils/common/index.ts"),s=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const o={};function l(e,t,r){return s(this,void 0,void 0,function*(){const a=function(e){let t=e.getTool("Comment");t||(t=e.addTool(new n.default(e)));return t.create()}(e);return new Promise((e,n)=>{i.createComment(t,a,r||{}).then(t=>(o[t.id]=t.renderData,e(t))).catch(n)})})}function d(e,t){let r=e.getTool("Comment");r||(r=e.addTool(new n.default(e))),r.activate(o[t]),r.setEnabled(!0)}var u;!function(e){e.get=function(e){return s(this,void 0,void 0,function*(){return new Promise((t,r)=>{i.getModelComments(e).then(e=>{const r=Object(a.decodeComments)(e);return r.forEach(e=>{o[e.id]=e.renderData}),t(r)}).catch(r)})})},e.remove=function(e){return s(this,void 0,void 0,function*(){return new Promise((t,r)=>{i.deleteModelComment(e).then(e=>(delete o[e],t(e))).catch(r)})})},e.update=function(e,t){return s(this,void 0,void 0,function*(){return i.updateModelComment(e,t)})}}(u||(u={}))},"./99api/Model.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"Model",function(){return i});var i,n=r("./99api/utils/client/index.ts"),a=r("./99api/utils/client/model.ts"),s=r("./03scene/model/Element.ts"),o=r("./99api/utils/model/downloader.ts"),l=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};!function(e){e.ElementType=s.ElementType,e.get=function(e){return l(this,void 0,void 0,function*(){return Object(n.getModel)(e)})},e.remove=function(e){return l(this,void 0,void 0,function*(){return Object(a.deleteModel)(e)})},e.update=function(e,t){return l(this,void 0,void 0,function*(){return Object(a.updateModel)(e,t)})},e.upload=function(e,t){return l(this,void 0,void 0,function*(){if("object"==typeof(r=t)&&null!==r){const{onProgress:r=(()=>{}),reduceTextures:i}=t;return Object(a.uploadModel)(e,i,r)}{const r=t||(()=>{});return Object(a.uploadModel)(e,!1,r)}var r})},e.merge=function(e,t,r){return l(this,void 0,void 0,function*(){return Object(a.mergeModel)(e,t,r)})},e.generate3DPDF=function(e){return l(this,void 0,void 0,function*(){return Object(a.generate3DPDF)(e)})},e.compare=function(e,t){return l(this,void 0,void 0,function*(){return new Promise((r,i)=>{var n=new Blob(['\n        function Node(name, type) {\n            this.father   = null;\n            this.children = null;\n            this.name     = name;\n            this.type     = type;\n            this.docId    = null;\n        }\n        var extractNode = function(element, nodes) {\n            if (element.children === null) {\n                nodes.push(element.name);\n            } else {\n                for (var i = 0, len = element.children.length; i < len; i++) {\n                    extractNode(element.children[i], nodes);\n                }\n            }\n        }\n        \n        var parseGraph = function(modelGraphBin, modelBin) {\n            var byteLength = modelGraphBin.byteLength;\n            var len = byteLength / 9;\n            var index = 0;\n            var e_name, e_father, e_type;\n            var root = new Node(-1, -1);\n            root.children = [];\n            var fathers = [];\n            fathers.push(root);\n    \n            var currentDocName = 0;\n    \n            var elements = [];\n            for (var i = 0; i < len; i++) {\n                var data = new Uint8Array(modelGraphBin, i * 9, 9);\n                e_name   = ((data[3] << 24) | (data[2] << 16) | (data[1] << 8) | data[0]);\n                e_father = ((data[7] << 24) | (data[6] << 16) | (data[5] << 8) | data[4]);\n                e_type   = data[8];\n                \n                while (fathers.length > 0 && fathers[fathers.length - 1].name !== e_father) {\n                    fathers.pop();\n                }\n                if (fathers.length === 0) {\n                    postMessage("father of " + e_name + " is wrong");\n                    close();\n                }\n                var father = fathers[fathers.length - 1];\n                if (e_type === 4) { // NODE\n                    var node = new Node(e_name, e_type);\n                    node.father = father;\n                    father.children.push(node);\n                } else {\n                    if (e_type === 5) { // link\n                        currentDocName = e_name;\n                    } \n                    var element = new Node(e_name, e_type);\n                    element.children = [];\n                    element.docId = currentDocName;\n                    if (e_type === 3) { // ElEMENT\n                        elements.push(element);\n                    }\n                    element.father = father;\n                    father.children.push(element);\n                    fathers.push(element);\n                }\n            }\n            for (var i = 0, len = elements.length; i < len; i++) {\n                var element = elements[i];\n                element.nodes = [];\n                extractNode(element, element.nodes);\n            }\n    \n            return elements;\n        };    \n    \n        var parseBBox = function(bboxBuffer, index) {\n            return new Float32Array(bboxBuffer, (index * 21 + 3) * 4, 6);\n        };\n    \n        var getElementBBox = function(nodes, bboxBuffer) {\n            var bbox = new Float32Array([Infinity, Infinity, Infinity, -Infinity, -Infinity, -Infinity]);\n            for (var i = 0, len = nodes.length; i < len; i++) {\n                var nodeBBox = parseBBox(bboxBuffer, nodes[i]);\n                if (bbox[0] > nodeBBox[0]) {\n                    bbox[0] = nodeBBox[0]\n                }\n                if (bbox[1] > nodeBBox[1]) {\n                    bbox[1] = nodeBBox[1]\n                }\n                if (bbox[2] > nodeBBox[2]) {\n                    bbox[2] = nodeBBox[2]\n                }\n                if (bbox[3] < nodeBBox[3]) {\n                    bbox[3] = nodeBBox[3]\n                }\n                if (bbox[4] < nodeBBox[4]) {\n                    bbox[4] = nodeBBox[4]\n                }\n                if (bbox[5] < nodeBBox[5]) {\n                    bbox[5] = nodeBBox[5]\n                }\n            }\n            return bbox;\n        }\n        var compareModel = function(elements1, elements2, bboxBuffer1, bboxBuffer2, modelId1, modelId2) {\n            if (elements1 === null || elements2 === null || bboxBuffer1 === null || bboxBuffer2 === null) {\n                return;\n            }\n            var EPS                 = 0.001;\n            var newElementIds1      = [];\n            var newElementIds2      = [];\n            var modifiedElementIds1 = [];\n            var modifiedElementIds2 = [];\n            elements1.sort(function(a, b) {\n                return a.name - b.name;\n            });\n            elements2.sort(function(a, b) {\n                return a.name - b.name;\n            });\n            var idx1 = 0, idx2 = 0;\n            var element1 = elements1[idx1];\n            var element2 = elements2[idx2];\n            while(element1 !== undefined && element2 !== undefined) {\n                if (element1.name === element2.name) {\n                    // compare nodes number and bbox\n                    if (element1.nodes.length != element2.nodes.length) {\n                        modifiedElementIds1.push(modelId1 + "+" + element1.docId + "/" + element1.name);\n                        modifiedElementIds2.push(modelId2 + "+" + element1.docId + "/" + element2.name);\n                    } else {\n                        var bbox1 = getElementBBox(element1.nodes, bboxBuffer1);\n                        var bbox2 = getElementBBox(element2.nodes, bboxBuffer2);\n                        if (Math.abs(bbox1[0] - bbox2[0]) > EPS ||\n                            Math.abs(bbox1[1] - bbox2[1]) > EPS ||\n                            Math.abs(bbox1[2] - bbox2[2]) > EPS ||\n                            Math.abs(bbox1[3] - bbox2[3]) > EPS ||\n                            Math.abs(bbox1[4] - bbox2[4]) > EPS ||\n                            Math.abs(bbox1[5] - bbox2[5]) > EPS) {\n                            modifiedElementIds1.push(modelId1 + "+" + element1.docId + "/" + element1.name);\n                            modifiedElementIds2.push(modelId2 + "+" + element1.docId + "/" + element2.name);\n                        }\n                    }\n                    idx1++;\n                    idx2++;\n                    element1 = elements1[idx1];\n                    element2 = elements2[idx2];\n                } else if (element1 === undefined || element1.name > element2.name) {\n                    // element2 doesn\'t exist in elements1;\n                    newElementIds2.push(modelId2 + "+" + element2.docId + "/" + element2.name);\n                    idx2++;\n                    element2 = elements2[idx2];\n                } else if (element2 === undefined || element1.name <= element2.name) {\n                    // element1 doesn\'t exist in elements2;\n                    newElementIds1.push(modelId1 + "+" + element1.docId + "/" + element1.name);\n                    idx1++;\n                    element1 = elements1[idx1];\n                }\n            }\n            postMessage({\n                newElements1: newElementIds1,\n                newElements2: newElementIds2,\n                modifiedElements1: modifiedElementIds1,\n                modifiedElements2: modifiedElementIds2\n            });\n            close();\n        }\n        var elements1 = null;\n        var elements2 = null;\n        var bboxBuffer1 = null;\n        var bboxBuffer2 = null;\n        var modelId1 = null;\n        var modelId2 = null;\n            \n        onmessage = function(evt) {\n            switch(evt.data.name) {\n                case "graph1":\n                    elements1 = parseGraph(evt.data.buffer);\n                    break;\n                case "graph2":\n                    elements2 = parseGraph(evt.data.buffer);\n                    break;\n                case "model1": \n                    var len = new Uint32Array(evt.data.buffer, 0, 1)[0];\n                    var nodesLocation = len * 20 + 8; // len * sizeof(uint32) * 5 + 8\n                    bboxBuffer1 = evt.data.buffer.slice(nodesLocation);\n                    modelId1 = evt.data.modelId;\n                    break;\n                case "model2":\n                    var len = new Uint32Array(evt.data.buffer, 0, 1)[0];\n                    var nodesLocation = len * 20 + 8; // len * sizeof(uint32) * 5 + 8\n                    bboxBuffer2 = evt.data.buffer.slice(nodesLocation);\n                    modelId2 = evt.data.modelId;\n                    break;\n            }\n            compareModel(elements1, elements2, bboxBuffer1, bboxBuffer2, modelId1, modelId2);\n        };\n        '],{type:"text/javascript"}),a=new Worker(window.URL.createObjectURL(n));a.onmessage=function(e){if(e.data instanceof String)i(e.data);else{var t=e.data;r(t)}},Object(o.generatePromises)(e).then(t=>{t["model.bin"].downloadFile().then(t=>{var r={buffer:t.data,name:"model1",modelId:e};a.postMessage(r,[r.buffer]),t.data.byteLength&&console.warn("transferred buffer not supported")},e=>{i(e)}),t["modelgraph.bin"].downloadFile().then(e=>{var t={buffer:e.data,name:"graph1"};a.postMessage(t,[t.buffer]),e.data.byteLength&&console.warn("transferred buffer not supported")},e=>{i(e)})}).catch(e=>{i(e)}),Object(o.generatePromises)(t).then(e=>{e["model.bin"].downloadFile().then(e=>{var r={buffer:e.data,name:"model2",modelId:t};a.postMessage(r,[r.buffer])},e=>{i(e)}),e["modelgraph.bin"].downloadFile().then(e=>{var t={buffer:e.data,name:"graph2"};a.postMessage(t,[t.buffer])},e=>{i(e)})}).catch(e=>{i(e)})})})},e.get3DPDFURL=function(e){return l(this,void 0,void 0,function*(){return Object(a.get3DPDFURL)(e)})},e.getBBox=function(e){return l(this,void 0,void 0,function*(){return new Promise((t,r)=>{Object(o.generatePromises)(e).then(e=>{e["model.json"].downloadFile().then(e=>{var r=e.data;t(r["model.bin"].bbox)}).catch(()=>{r("error")})})})})}}(i||(i={}))},"./99api/RenderSetting.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"activate",function(){return l}),r.d(t,"RenderSetting",function(){return d});var i,n=r("./99api/utils/client/index.ts"),a=r("./03scene/drawables/Skybox.ts"),s=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};!function(e){e.Architect="Architect",e.Product="Product"}(i||(i={}));const o={};function l(e,t){return s(this,void 0,void 0,function*(){const r=o[t];e.setEffectEnabled("SSAO",r.enhancedRendering),e.setSmartCullingEnabled(r.acceleratedRendering),e.setEffectEnabled("Sketch",r.architectEffect),e.setEffectParameter("Sketch","detail",r.penDetail),e.setEffectParameter("Sketch","contrast",r.inkContrast),e.setEffectParameter("Sketch","colored",r.blackAndWhite),e.setShadowEnabled(r.shadow),e.setLightingIntensity(r.brightness),e.setLightingLatitude(r.latitude),e.setLightingLongitude(r.longitude),e.setBackgroundMode(r.backgroundMode),r.backgroundMode===a.SkyBoxMode.SKYBOX_SOLIDCOLOR&&e.setBackgroundColor(function(e){if(7!==e.length)throw Error("No a color");const t=[0,0,0];for(let r=0;r<3;r++){const i=2*r+1,n=e[i]+e[i+1];t[r]=parseInt(n,16)/255}return t}(r.backgroundColor)),r.backgroundMode===a.SkyBoxMode.SKYBOX_CUBEMAP&&e.setBackgroundImage(r.backgroundImage),r.backgroundMode===a.SkyBoxMode.SKYBOX_WALLPAPER&&e.setBackgroundImage(r.backgroundImage[0])})}var d;!function(e){let t;!function(e){e.Architect="Architect",e.Product="Product"}(t=e.ModelShaderSetting||(e.ModelShaderSetting={})),e.get=function(e){return s(this,void 0,void 0,function*(){return new Promise((t,r)=>{n.getModelRenderSettings(e).then(e=>(e.forEach(e=>{o[e.id]=e}),t(e))).catch(r)})})},e.create=function(e,t){return s(this,void 0,void 0,function*(){return n.createModelRenderSetting(e,t)})},e.update=function(e,t){return s(this,void 0,void 0,function*(){return n.updateModelRenderSetting(e,t)})},e.remove=function(e){return s(this,void 0,void 0,function*(){return n.deleteModelRenderSetting(e)})}}(d||(d={}))},"./99api/Version.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"VERSION",function(){return i});const i="2.9.1"},"./99api/View.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"View",function(){return i});var i,n=r("./08ui/input/Mouse.ts"),a=r("./08ui/input/Touch.ts"),s=r("./08ui/input/Keyboard.ts"),o=r("./09app/Viewer.ts"),l=r("./03scene/pawn/Pawn.ts"),d=r("./03scene/text/Text3D.ts"),u=r("./03scene/text/Text3DBillboard.ts"),c=r("./03scene/pawn/PawnBillboard.ts"),h=r("./03scene/model/Model.ts"),m=r("./09app/Scene3D.ts"),f=r("./09app/Camera.ts"),p=r("./09app/Viewer3D.ts"),v=r("./09app/Viewer360.ts"),_=r("./09app/Viewer3DCompare.ts"),g=r("./09app/Viewer3DDark.ts"),b=r("./08ui/tool/MeasureLine.ts"),y=r("./08ui/tool/MeasureLines.ts"),x=r("./08ui/tool/MeasureLineFan.ts"),w=r("./08ui/tool/MeasureLineStrip.ts"),E=r("./08ui/tool/MeasureAngle.ts"),M=r("./08ui/tool/MeasureArea.ts"),A=r("./08ui/tool/Section.ts"),T=r("./08ui/tool/MagnifyGlass.ts"),S=r("./08ui/tool/SelectElements.ts"),k=r("./08ui/tool/CameraNavigator.ts"),D=r("./09app/animator/PathFollowingAnimator.ts"),I=r("./08ui/tool/CameraManipulator.ts"),N=r("./08ui/tool/TransformGizmo.ts"),P=r("./08ui/tool/Comment.ts"),O=r("./08ui/tool/SelectModel.ts"),R=r("./04renderer/visualize/BarChart.ts"),F=r("./04renderer/visualize/HeatMap.ts"),C=r("./04renderer/visualize/HeightMap.ts"),B=r("./04renderer/visualize/MetaBall.ts"),L=r("./04renderer/visualize/Trail.ts"),j=r("./04renderer/visualize/Volume.ts"),V=r("./04renderer/visualize/MultiLayerVolume.ts"),z=r("./04renderer/visualize/MultiLayerColor.ts"),U=r("./04renderer/visualize/AnimatingRibbon.ts"),G=r("./04renderer/visualize/AnimatingStripe.ts");!function(e){let t,r,i,q,Q;!function(e){let t,r,i;!function(e){e[e.LINES=0]="LINES",e[e.LINE=1]="LINE",e[e.LINESTRIP=2]="LINESTRIP",e[e.LINEFAN=3]="LINEFAN",e[e.ANGLE=4]="ANGLE",e[e.AREA=5]="AREA"}(t=e.MeasureType||(e.MeasureType={})),function(e){e.FEET="feet",e.INCHES="inches",e.CM="cm",e.M="m"}(r=e.MeasureUnit||(e.MeasureUnit={})),function(e){e[e.NONE=-1]="NONE",e[e.VERTEX=0]="VERTEX",e[e.EDGE=1]="EDGE",e[e.EDGE_MIDPOINT=2]="EDGE_MIDPOINT"}(i=e.SnappingMode||(e.SnappingMode={})),e.MeasureLine=b.default,e.MeasureLineFan=x.default,e.MeasureLines=y.default,e.MeasureLineStrip=w.default,e.MeasureAngle=E.default,e.MeasureArea=M.default,e.Section=A.default,e.MagnifyGlass=T.default,e.SelectElements=S.default,e.CameraManipulator=I.default,e.TransformGizmo=N.default,e.Comment=P.default,e.SelectModel=O.default,e.CameraNavigator=k.default}(t=e.Tool||(e.Tool={})),function(e){e.Mouse=n.default,e.Keyboard=s.default,e.Touch=a.default}(r=e.Input||(e.Input={})),function(e){e[e.NONE=-1]="NONE",e[e.FRONT=0]="FRONT",e[e.BACK=1]="BACK",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e[e.TOP=4]="TOP",e[e.BOTTOM=5]="BOTTOM",e[e.WORLD=6]="WORLD"}(i=e.ViewAngle||(e.ViewAngle={})),function(e){e[e.SOLIDCOLOR=0]="SOLIDCOLOR",e[e.WALLPAPER=1]="WALLPAPER",e[e.EQUIRECTANGLE=2]="EQUIRECTANGLE",e[e.CUBEMAP=3]="CUBEMAP",e[e.WALLPAPER_TILED=4]="WALLPAPER_TILED"}(q=e.ViewBackground||(e.ViewBackground={})),e.State=o.State,e.Scene3D=m.default,e.Camera=f.default,e.Pawn=l.default,e.Text3D=d.default,e.Text3DBillboard=u.default,e.PawnBillboard=c.default,e.Model=h.default,function(e){e.AnimatingRibbon=U.default,e.AnimatingStripe=G.default,e.BarChart=R.default,e.HeatMap=F.default,e.HeightMap=C.default,e.MetaBall=B.default,e.Trail=L.default,e.Volume=j.default,e.MultiLayerVolume=V.default,e.MultiLayerColor=z.default}(Q=e.Visualize||(e.Visualize={})),e.Viewer3D=p.default,e.Viewer360=v.default,e.Viewer3DCompare=_.default,e.Viewer3DDark=g.default,e.PathFollowingAnimator=D.default}(i||(i={}))},"./99api/config.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"setConfig",function(){return a}),r.d(t,"init",function(){return s});var i=r("./99api/utils/index.ts");const n={endpoint:"",appToken:"",headers:null},a=e=>{n.endpoint=e.endpoint,n.appToken=e.appToken,n.headers=e.headers};function s(e){Object(i.assert)(e,Object(i.hasKeys)(["endpoint","appToken"]),"initial config not valid"),a(e)}t.default=n},"./99api/graphql.types.ts":function(e,t,r){"use strict";var i,n,a,s,o,l,d,u,c,h,m,f;r.r(t),r.d(t,"ComStatus",function(){return i}),r.d(t,"AssetType",function(){return n}),r.d(t,"TaskPriority",function(){return a}),r.d(t,"TaskCommentType",function(){return s}),r.d(t,"IssuePriority",function(){return o}),r.d(t,"IssueStatus",function(){return l}),r.d(t,"ModelType",function(){return d}),r.d(t,"ModelStatus",function(){return u}),r.d(t,"SelectionType",function(){return c}),r.d(t,"ModelShaderSetting",function(){return h}),r.d(t,"AssetStatus",function(){return m}),r.d(t,"WechatMessageType",function(){return f}),function(e){e.Init="INIT",e.Error="ERROR",e.Done="DONE"}(i||(i={})),function(e){e.Wbs="wbs",e.Img="img",e.File="file",e.Dwg="dwg",e.ModelConvertedPdf="modelConvertedPdf",e.Image360="image360"}(n||(n={})),function(e){e.Urgent="urgent",e.Critical="critical",e.Normal="normal"}(a||(a={})),function(e){e.Img="img",e.Txt="txt"}(s||(s={})),function(e){e.Urgent="urgent",e.Critical="critical",e.Normal="normal"}(o||(o={})),function(e){e.Open="open",e.InProgress="inProgress",e.Resolved="resolved",e.Bot="bot"}(l||(l={})),function(e){e.Normal="normal",e.Versioned="versioned",e.Partial="partial"}(d||(d={})),function(e){e.Error="ERROR",e.Init="INIT",e.Uploaded="UPLOADED",e.Converted="CONVERTED"}(u||(u={})),function(e){e.ElementId="elementId",e.Type="type",e.Family="family",e.Category="category",e.Level="level"}(c||(c={})),function(e){e.Architect="Architect",e.Product="Product"}(h||(h={})),function(e){e.Error="ERROR",e.Init="INIT",e.Uploaded="UPLOADED",e.Converted="CONVERTED"}(m||(m={})),function(e){e.Txt="txt",e.Img="img",e.File="file"}(f||(f={}))},"./99api/graphql/AddCombinedModel.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddCombinedModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addCombinedModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"modelIds"},value:{kind:"Variable",name:{kind:"Name",value:"modelIds"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:197}};r.loc.source={body:"mutation AddCombinedModel($folderId: Int!, $name: String!, $modelIds: [Id]!) {\r\n    addCombinedModel(folderId: $folderId, name: $name, modelIds: $modelIds) {\r\n        id\r\n        status\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddCombinedModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddCombinedModel")},"./99api/graphql/AddModelComment.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddModelComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"plainText"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bimdata"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"camera"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Id"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addModelComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"plainText"},value:{kind:"Variable",name:{kind:"Name",value:"plainText"}}},{kind:"Argument",name:{kind:"Name",value:"bimdata"},value:{kind:"Variable",name:{kind:"Name",value:"bimdata"}}},{kind:"Argument",name:{kind:"Name",value:"camera"},value:{kind:"Variable",name:{kind:"Name",value:"camera"}}},{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bimdata"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"camera"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plainText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:383}};r.loc.source={body:"mutation AddModelComment($message: String!, $plainText: String!, $bimdata: String, $camera: String, $modelId: Id) {\r\n    addModelComment(message: $message, plainText: $plainText, bimdata: $bimdata, camera: $camera, modelId: $modelId) {\r\n        id\r\n        bimdata\r\n        camera\r\n        modelId\r\n        message\r\n        plainText\r\n        createdAt\r\n        updatedAt\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddModelComment=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddModelComment")},"./99api/graphql/AddModelRenderSetting.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddModelRenderSetting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enhancedRendering"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acceleratedRendering"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"architectEffect"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"penDetail"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inkContrast"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"blackAndWhite"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shadow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"brightness"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"latitude"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"longitude"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"materials"}},type:{kind:"NamedType",name:{kind:"Name",value:"JSONObject"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundMode"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundColor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundImage"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reflectionImage"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shader"}},type:{kind:"NamedType",name:{kind:"Name",value:"ModelShaderSetting"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addModelSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}},{kind:"Argument",name:{kind:"Name",value:"enhancedRendering"},value:{kind:"Variable",name:{kind:"Name",value:"enhancedRendering"}}},{kind:"Argument",name:{kind:"Name",value:"acceleratedRendering"},value:{kind:"Variable",name:{kind:"Name",value:"acceleratedRendering"}}},{kind:"Argument",name:{kind:"Name",value:"architectEffect"},value:{kind:"Variable",name:{kind:"Name",value:"architectEffect"}}},{kind:"Argument",name:{kind:"Name",value:"penDetail"},value:{kind:"Variable",name:{kind:"Name",value:"penDetail"}}},{kind:"Argument",name:{kind:"Name",value:"inkContrast"},value:{kind:"Variable",name:{kind:"Name",value:"inkContrast"}}},{kind:"Argument",name:{kind:"Name",value:"blackAndWhite"},value:{kind:"Variable",name:{kind:"Name",value:"blackAndWhite"}}},{kind:"Argument",name:{kind:"Name",value:"shadow"},value:{kind:"Variable",name:{kind:"Name",value:"shadow"}}},{kind:"Argument",name:{kind:"Name",value:"brightness"},value:{kind:"Variable",name:{kind:"Name",value:"brightness"}}},{kind:"Argument",name:{kind:"Name",value:"latitude"},value:{kind:"Variable",name:{kind:"Name",value:"latitude"}}},{kind:"Argument",name:{kind:"Name",value:"longitude"},value:{kind:"Variable",name:{kind:"Name",value:"longitude"}}},{kind:"Argument",name:{kind:"Name",value:"materials"},value:{kind:"Variable",name:{kind:"Name",value:"materials"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundMode"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundMode"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundColor"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundColor"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundImage"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundImage"}}},{kind:"Argument",name:{kind:"Name",value:"reflectionImage"},value:{kind:"Variable",name:{kind:"Name",value:"reflectionImage"}}},{kind:"Argument",name:{kind:"Name",value:"shader"},value:{kind:"Variable",name:{kind:"Name",value:"shader"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filter"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enhancedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"acceleratedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"architectEffect"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"penDetail"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inkContrast"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blackAndWhite"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shadow"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"brightness"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"latitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"longitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"materials"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundMode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reflectionImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shader"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:1664}};r.loc.source={body:"mutation AddModelRenderSetting(\r\n    $modelId: Id!\r\n    $name: String\r\n    $filter: String\r\n    $enhancedRendering: Boolean\r\n    $acceleratedRendering: Boolean\r\n    $architectEffect: Boolean\r\n    $penDetail: Float\r\n    $inkContrast: Float\r\n    $blackAndWhite: Boolean\r\n    $shadow: Boolean\r\n    $brightness: Float\r\n    $latitude: Float\r\n    $longitude: Float\r\n    $materials: JSONObject\r\n    $backgroundMode: Int\r\n    $backgroundColor: String\r\n    $backgroundImage: [String]\r\n    $reflectionImage: [String]\r\n    $shader: ModelShaderSetting\r\n) {\r\n    addModelSettings(\r\n        modelId: $modelId\r\n        name: $name\r\n        filter: $filter\r\n        enhancedRendering: $enhancedRendering\r\n        acceleratedRendering: $acceleratedRendering\r\n        architectEffect: $architectEffect\r\n        penDetail: $penDetail\r\n        inkContrast: $inkContrast\r\n        blackAndWhite: $blackAndWhite\r\n        shadow: $shadow\r\n        brightness: $brightness\r\n        latitude: $latitude\r\n        longitude: $longitude\r\n        materials: $materials\r\n        backgroundMode: $backgroundMode\r\n        backgroundColor: $backgroundColor\r\n        backgroundImage: $backgroundImage\r\n        reflectionImage: $reflectionImage\r\n        shader: $shader\r\n    ) {\r\n        id\r\n        modelId\r\n        name\r\n        filter\r\n        enhancedRendering\r\n        acceleratedRendering\r\n        architectEffect\r\n        penDetail\r\n        inkContrast\r\n        blackAndWhite\r\n        shadow\r\n        brightness\r\n        latitude\r\n        longitude\r\n        materials\r\n        backgroundMode\r\n        backgroundColor\r\n        backgroundImage\r\n        reflectionImage\r\n        shader\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddModelRenderSetting=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddModelRenderSetting")},"./99api/graphql/AddModelSelectionSet.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddModelSelectionSet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addModelSelectionSet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"elementIds"},value:{kind:"Variable",name:{kind:"Name",value:"elementIds"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"elementIds"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:284}};r.loc.source={body:"mutation AddModelSelectionSet($name: String!, $modelId: Id!, $elementIds: [String]!) {\r\n    addModelSelectionSet(name: $name, modelId: $modelId, elementIds: $elementIds) {\r\n        id\r\n        name\r\n        modelId\r\n        elementIds\r\n        createdAt\r\n        updatedAt\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddModelSelectionSet=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddModelSelectionSet")},"./99api/graphql/AddSliceModel.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddSliceModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"query"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isTerrain"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sliceModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"Argument",name:{kind:"Name",value:"query"},value:{kind:"Variable",name:{kind:"Name",value:"query"}}},{kind:"Argument",name:{kind:"Name",value:"isTerrain"},value:{kind:"Variable",name:{kind:"Name",value:"isTerrain"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"folderId"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:224}};r.loc.source={body:"mutation AddSliceModel($name: String!, $folderId: Int, $query: String!, $isTerrain: Boolean) {\r\n  sliceModel(name: $name, folderId: $folderId, query: $query, isTerrain: $isTerrain) {\r\n    id\r\n    name\r\n    folderId\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddSliceModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddSliceModel")},"./99api/graphql/BatchAddProperty.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"BatchAddProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"strValueArr"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numValueArr"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"batchAddProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"docAndCatIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"elementIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"propertyArr"},value:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}}},{kind:"Argument",name:{kind:"Name",value:"strValueArr"},value:{kind:"Variable",name:{kind:"Name",value:"strValueArr"}}},{kind:"Argument",name:{kind:"Name",value:"numValueArr"},value:{kind:"Variable",name:{kind:"Name",value:"numValueArr"}}}],directives:[]}]}}],loc:{start:0,end:397}};r.loc.source={body:"mutation BatchAddProperty(\r\n  $modelId: Id!\r\n  $docAndCatIdArr: [Int]!\r\n  $elementIdArr: [Int]!\r\n  $propertyArr: [String]!\r\n  $strValueArr: [String]\r\n  $numValueArr: [Float]\r\n) {\r\n  batchAddProperties(\r\n    modelId: $modelId\r\n    docAndCatIdArr: $docAndCatIdArr\r\n    elementIdArr: $elementIdArr\r\n    propertyArr: $propertyArr\r\n    strValueArr: $strValueArr\r\n    numValueArr: $numValueArr\r\n  )\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.BatchAddProperty=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"BatchAddProperty")},"./99api/graphql/BatchDeleteProperty.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"BatchDeleteProperties"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"batchDeleteProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"docAndCatIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"elementIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"propertyArr"},value:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}}}],directives:[]}]}}],loc:{start:0,end:292}};r.loc.source={body:"mutation BatchDeleteProperties(\r\n  $modelId: Id!\r\n  $docAndCatIdArr: [Int]!\r\n  $elementIdArr: [Int]!\r\n  $propertyArr: [String]!\r\n) {\r\n  batchDeleteProperties(\r\n    modelId: $modelId\r\n    docAndCatIdArr: $docAndCatIdArr\r\n    elementIdArr: $elementIdArr\r\n    propertyArr: $propertyArr\r\n  )\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.BatchDeleteProperties=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"BatchDeleteProperties")},"./99api/graphql/BatchGetProperties.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"BatchGetProperties"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"batchGetElementProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"elementIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"propertyArr"},value:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"elementIdArr"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"properties"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"strValues"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"numValues"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:332}};r.loc.source={body:"query BatchGetProperties($modelId: Id!, $elementIdArr: [Int]!, $propertyArr: [String]!) {\r\n    batchGetElementProperties(modelId: $modelId, elementIdArr: $elementIdArr, propertyArr: $propertyArr) {\r\n        elementIdArr\r\n        properties {\r\n            property\r\n            strValues\r\n            numValues\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.BatchGetProperties=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"BatchGetProperties")},"./99api/graphql/BatchUpdateProperty.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"BatchUpdateProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"strValueArr"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numValueArr"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"batchUpdateProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"docAndCatIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"elementIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"propertyArr"},value:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}}},{kind:"Argument",name:{kind:"Name",value:"strValueArr"},value:{kind:"Variable",name:{kind:"Name",value:"strValueArr"}}},{kind:"Argument",name:{kind:"Name",value:"numValueArr"},value:{kind:"Variable",name:{kind:"Name",value:"numValueArr"}}}],directives:[]}]}}],loc:{start:0,end:403}};r.loc.source={body:"mutation BatchUpdateProperty(\r\n  $modelId: Id!\r\n  $docAndCatIdArr: [Int]!\r\n  $elementIdArr: [Int]!\r\n  $propertyArr: [String]!\r\n  $strValueArr: [String]\r\n  $numValueArr: [Float]\r\n) {\r\n  batchUpdateProperties(\r\n    modelId: $modelId\r\n    docAndCatIdArr: $docAndCatIdArr\r\n    elementIdArr: $elementIdArr\r\n    propertyArr: $propertyArr\r\n    strValueArr: $strValueArr\r\n    numValueArr: $numValueArr\r\n  )\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.BatchUpdateProperty=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"BatchUpdateProperty")},"./99api/graphql/DeleteAsset.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteAsset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}}],directives:[]}]}}],loc:{start:0,end:72}};r.loc.source={body:"mutation DeleteAsset($assetId: Int!) {\r\n  deleteAsset(id: $assetId)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteAsset=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteAsset")},"./99api/graphql/DeleteModel.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[]}]}}],loc:{start:0,end:71}};r.loc.source={body:"mutation DeleteModel($modelId: Id!) {\r\n  deleteModel(id: $modelId)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteModel")},"./99api/graphql/DeleteModelComment.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteModelComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteModelComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}}],loc:{start:0,end:78}};r.loc.source={body:"mutation DeleteModelComment($id: Int!) {\r\n    deleteModelComment(id: $id)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteModelComment=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteModelComment")},"./99api/graphql/DeleteModelRenderSetting.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteModelRenderSetting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteModelSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}}],loc:{start:0,end:83}};r.loc.source={body:"mutation DeleteModelRenderSetting($id: Int!) {\r\n  deleteModelSettings(id: $id)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteModelRenderSetting=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteModelRenderSetting")},"./99api/graphql/DeleteModelSelectionSet.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteModelSelectionSet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteModelSelectionSet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}}],loc:{start:0,end:88}};r.loc.source={body:"mutation DeleteModelSelectionSet($id: Int!) {\r\n    deleteModelSelectionSet(id: $id)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteModelSelectionSet=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteModelSelectionSet")},"./99api/graphql/Generate3DPDF.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"Generate3DPDF"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"modelStartConvertToPdf"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"assetId"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:109}};r.loc.source={body:"mutation Generate3DPDF($modelId: Id!) {\r\n  modelStartConvertToPdf(modelId: $modelId) {\r\n    assetId\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.Generate3DPDF=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"Generate3DPDF")},"./99api/graphql/Get3DPDFURL.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Get3DPDFURL"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"asset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:108}};r.loc.source={body:"query Get3DPDFURL($assetId: Int!) {\r\n  asset(id: $assetId) {\r\n    downloadUrls {\r\n      url\r\n    }\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.Get3DPDFURL=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"Get3DPDFURL")},"./99api/graphql/GetAsset.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"asset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filenames"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"convertedUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"panoConvertedUrl"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:333}};r.loc.source={body:"query GetAsset($assetId: Int!) {\r\n  asset(id: $assetId) {\r\n    id\r\n    name\r\n    type\r\n    status\r\n    filenames\r\n    createdBy {\r\n      id\r\n      username\r\n    }\r\n    createdAt\r\n    updatedAt\r\n    convertedUrls {\r\n      filename\r\n      url\r\n    }\r\n    downloadUrls {\r\n      filename\r\n      url\r\n    }\r\n    panoConvertedUrl\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetAsset=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetAsset")},"./99api/graphql/GetAssetFolder.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetAssetFolder"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"projects"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assetFolder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:155}};r.loc.source={body:"query GetAssetFolder {\r\n    user {\r\n        projects {\r\n            id\r\n            assetFolder {\r\n                id\r\n            }\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetAssetFolder=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetAssetFolder")},"./99api/graphql/GetElementProperties.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetElementProperties"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"elementProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"docAndCatId"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatId"}}},{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"elementId"},value:{kind:"Variable",name:{kind:"Name",value:"elementId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"strValue"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"numValue"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:241}};r.loc.source={body:"query GetElementProperties($docAndCatId: Int!, $modelId: Id!, $elementId: Int!) {\r\n    elementProperties(docAndCatId: $docAndCatId, modelId: $modelId, elementId: $elementId) {\r\n        property\r\n        strValue\r\n        numValue\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetElementProperties=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetElementProperties")},"./99api/graphql/GetModel.gql":function(e,t,r){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ModelInfo"},directives:[]},{kind:"Field",name:{kind:"Name",value:"versionedModels"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ModelInfo"},directives:[]}]}}]}}]}}],loc:{start:0,end:185}};i.loc.source={body:'#import "./ModelInfo.gql"\r\n\r\nquery GetModel($modelId: Id!) {\r\n    model(id: $modelId) {\r\n        ...ModelInfo\r\n        versionedModels {\r\n            ...ModelInfo\r\n        }\r\n    }\r\n}\r\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};i.definitions=i.definitions.concat(r("./99api/graphql/ModelInfo.gql").definitions.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)}));var a={};function s(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}i.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),a[e.name.value]=t}}),e.exports=i,e.exports.GetModel=function(e,t){var r={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var i=a[t]||new Set,n=new Set,o=new Set;for(i.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){n.has(e)||(n.add(e),(a[e]||new Set).forEach(function(e){o.add(e)}))})}return n.forEach(function(t){var i=s(e,t);i&&r.definitions.push(i)}),r}(i,"GetModel")},"./99api/graphql/GetModelComment.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"modelComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"commentId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bimdata"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"camera"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plainText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:295}};r.loc.source={body:"query GetModelComment($commentId: Int!) {\r\n    modelComment(id: $commentId) {\r\n        id\r\n        bimdata\r\n        camera\r\n        modelId\r\n        message\r\n        plainText\r\n        createdAt\r\n        updatedAt\r\n        createdBy {\r\n            id\r\n            username\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelComment=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelComment")},"./99api/graphql/GetModelComments.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelComments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"modelComments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bimdata"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"camera"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plainText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:297}};r.loc.source={body:"query GetModelComments($modelId: Id!) {\r\n    modelComments(modelId: $modelId) {\r\n        id\r\n        bimdata\r\n        camera\r\n        modelId\r\n        message\r\n        plainText\r\n        createdAt\r\n        updatedAt\r\n        createdBy {\r\n            id\r\n            username\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelComments=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelComments")},"./99api/graphql/GetModelFiles.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelFiles"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"convertedUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:236}};r.loc.source={body:"query GetModelFiles($modelId: Id!) {\r\n    model(id: $modelId) {\r\n        id\r\n        downloadUrls {\r\n            filename\r\n            url\r\n        }\r\n        convertedUrls {\r\n            filename\r\n            url\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelFiles=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelFiles")},"./99api/graphql/GetModelFolder.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelFolder"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"projects"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelFolder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:155}};r.loc.source={body:"query GetModelFolder {\r\n    user {\r\n        projects {\r\n            id\r\n            modelFolder {\r\n                id\r\n            }\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelFolder=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelFolder")},"./99api/graphql/GetModelRenderSetting.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelRenderSetting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filter"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enhancedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"acceleratedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"architectEffect"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"penDetail"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inkContrast"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blackAndWhite"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shadow"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"brightness"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"latitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"longitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"materials"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundMode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reflectionImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shader"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:617}};r.loc.source={body:"query GetModelRenderSetting($modelId: Id!) {\r\n    model(id: $modelId) {\r\n        id\r\n        settings {\r\n            id\r\n            name\r\n            modelId\r\n            filter\r\n            enhancedRendering\r\n            acceleratedRendering\r\n            architectEffect\r\n            penDetail\r\n            inkContrast\r\n            blackAndWhite\r\n            shadow\r\n            brightness\r\n            latitude\r\n            longitude\r\n            materials\r\n            backgroundMode\r\n            backgroundColor\r\n            backgroundImage\r\n            reflectionImage\r\n            shader\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelRenderSetting=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelRenderSetting")},"./99api/graphql/GetModelSelectionSets.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelSelectionSets"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelSelectionSets"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"elementIds"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:261}};r.loc.source={body:"query GetModelSelectionSets($modelId: Id!) {\r\n    model(id: $modelId) {\r\n        id\r\n        modelSelectionSets {\r\n            id\r\n            name\r\n            modelId\r\n            elementIds\r\n            createdAt\r\n            updatedAt\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelSelectionSets=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelSelectionSets")},"./99api/graphql/InitElementProperty.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"InitElementProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"property"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"strValue"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numValue"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"initModelElementProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"property"},value:{kind:"Variable",name:{kind:"Name",value:"property"}}},{kind:"Argument",name:{kind:"Name",value:"strValue"},value:{kind:"Variable",name:{kind:"Name",value:"strValue"}}},{kind:"Argument",name:{kind:"Name",value:"numValue"},value:{kind:"Variable",name:{kind:"Name",value:"numValue"}}}],directives:[]}]}}],loc:{start:0,end:221}};r.loc.source={body:"mutation InitElementProperty($modelId: Id!, $property: String!, $strValue: String, $numValue: Float) {\r\n    initModelElementProperties(modelId: $modelId, property: $property, strValue: $strValue, numValue: $numValue)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.InitElementProperty=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"InitElementProperty")},"./99api/graphql/ModelInfo.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ModelInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Model"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"folderId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"targetModelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"version"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"convertedUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:321}};r.loc.source={body:"fragment ModelInfo on Model {\r\n    id\r\n    folderId\r\n    targetModelId\r\n    type\r\n    name\r\n    status\r\n    version\r\n    createdBy {\r\n        id\r\n        username\r\n    }\r\n    createdAt\r\n    updatedAt\r\n    downloadUrls {\r\n        filename\r\n        url\r\n    }\r\n    convertedUrls {\r\n        filename\r\n        url\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=r},"./99api/graphql/UpdateAsset.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAsset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:152}};r.loc.source={body:"mutation UpdateAsset($assetId: Int!, $name: String, $folderId: Int) {\r\n  updateAsset(id: $assetId, name: $name, folderId: $folderId) {\r\n    id\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateAsset=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateAsset")},"./99api/graphql/UpdateElementProperty.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateElementProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"property"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"strValue"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numValue"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updatePropertyValue"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"docAndCatId"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatId"}}},{kind:"Argument",name:{kind:"Name",value:"elementId"},value:{kind:"Variable",name:{kind:"Name",value:"elementId"}}},{kind:"Argument",name:{kind:"Name",value:"property"},value:{kind:"Variable",name:{kind:"Name",value:"property"}}},{kind:"Argument",name:{kind:"Name",value:"strValue"},value:{kind:"Variable",name:{kind:"Name",value:"strValue"}}},{kind:"Argument",name:{kind:"Name",value:"numValue"},value:{kind:"Variable",name:{kind:"Name",value:"numValue"}}}],directives:[]}]}}],loc:{start:0,end:388}};r.loc.source={body:"mutation UpdateElementProperty(\r\n    $modelId: Id!\r\n    $docAndCatId: Int!\r\n    $elementId: Int!\r\n    $property: String!\r\n    $strValue: String\r\n    $numValue: Float\r\n) {\r\n    updatePropertyValue(\r\n        modelId: $modelId\r\n        docAndCatId: $docAndCatId\r\n        elementId: $elementId\r\n        property: $property\r\n        strValue: $strValue\r\n        numValue: $numValue\r\n    )\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateElementProperty=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateElementProperty")},"./99api/graphql/UpdateModel.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:159}};r.loc.source={body:"mutation UpdateModel($modelId: Id!, $name: String, $folderId: Int) {\r\n    updateModel(id: $modelId, name: $name, folderId: $folderId) {\r\n        id\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateModel")},"./99api/graphql/UpdateModelComment.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateModelComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"plainText"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateModelComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"plainText"},value:{kind:"Variable",name:{kind:"Name",value:"plainText"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bimdata"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"camera"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plainText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:305}};r.loc.source={body:"mutation UpdateModelComment($id: Int!, $message: String!, $plainText: String!) {\r\n    updateModelComment(id: $id, message: $message, plainText: $plainText) {\r\n        id\r\n        bimdata\r\n        camera\r\n        modelId\r\n        message\r\n        plainText\r\n        createdAt\r\n        updatedAt\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateModelComment=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateModelComment")},"./99api/graphql/UpdateModelRenderSetting.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateModelRenderSetting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Id"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enhancedRendering"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acceleratedRendering"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"architectEffect"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"penDetail"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inkContrast"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"blackAndWhite"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shadow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"brightness"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"latitude"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"longitude"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"materials"}},type:{kind:"NamedType",name:{kind:"Name",value:"JSONObject"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundMode"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundColor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundImage"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reflectionImage"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shader"}},type:{kind:"NamedType",name:{kind:"Name",value:"ModelShaderSetting"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateModelSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}},{kind:"Argument",name:{kind:"Name",value:"enhancedRendering"},value:{kind:"Variable",name:{kind:"Name",value:"enhancedRendering"}}},{kind:"Argument",name:{kind:"Name",value:"acceleratedRendering"},value:{kind:"Variable",name:{kind:"Name",value:"acceleratedRendering"}}},{kind:"Argument",name:{kind:"Name",value:"architectEffect"},value:{kind:"Variable",name:{kind:"Name",value:"architectEffect"}}},{kind:"Argument",name:{kind:"Name",value:"penDetail"},value:{kind:"Variable",name:{kind:"Name",value:"penDetail"}}},{kind:"Argument",name:{kind:"Name",value:"inkContrast"},value:{kind:"Variable",name:{kind:"Name",value:"inkContrast"}}},{kind:"Argument",name:{kind:"Name",value:"blackAndWhite"},value:{kind:"Variable",name:{kind:"Name",value:"blackAndWhite"}}},{kind:"Argument",name:{kind:"Name",value:"shadow"},value:{kind:"Variable",name:{kind:"Name",value:"shadow"}}},{kind:"Argument",name:{kind:"Name",value:"brightness"},value:{kind:"Variable",name:{kind:"Name",value:"brightness"}}},{kind:"Argument",name:{kind:"Name",value:"latitude"},value:{kind:"Variable",name:{kind:"Name",value:"latitude"}}},{kind:"Argument",name:{kind:"Name",value:"longitude"},value:{kind:"Variable",name:{kind:"Name",value:"longitude"}}},{kind:"Argument",name:{kind:"Name",value:"materials"},value:{kind:"Variable",name:{kind:"Name",value:"materials"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundMode"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundMode"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundColor"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundColor"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundImage"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundImage"}}},{kind:"Argument",name:{kind:"Name",value:"reflectionImage"},value:{kind:"Variable",name:{kind:"Name",value:"reflectionImage"}}},{kind:"Argument",name:{kind:"Name",value:"shader"},value:{kind:"Variable",name:{kind:"Name",value:"shader"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filter"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enhancedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"acceleratedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"architectEffect"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"penDetail"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inkContrast"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blackAndWhite"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shadow"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"brightness"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"latitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"longitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"materials"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundMode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reflectionImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shader"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:1701}};r.loc.source={body:"mutation UpdateModelRenderSetting(\r\n    $id: Int!\r\n    $modelId: Id\r\n    $name: String\r\n    $filter: String\r\n    $enhancedRendering: Boolean\r\n    $acceleratedRendering: Boolean\r\n    $architectEffect: Boolean\r\n    $penDetail: Float\r\n    $inkContrast: Float\r\n    $blackAndWhite: Boolean\r\n    $shadow: Boolean\r\n    $brightness: Float\r\n    $latitude: Float\r\n    $longitude: Float\r\n    $materials: JSONObject\r\n    $backgroundMode: Int\r\n    $backgroundColor: String\r\n    $backgroundImage: [String]\r\n    $reflectionImage: [String]\r\n    $shader: ModelShaderSetting\r\n) {\r\n    updateModelSettings(\r\n        id: $id\r\n        modelId: $modelId\r\n        name: $name\r\n        filter: $filter\r\n        enhancedRendering: $enhancedRendering\r\n        acceleratedRendering: $acceleratedRendering\r\n        architectEffect: $architectEffect\r\n        penDetail: $penDetail\r\n        inkContrast: $inkContrast\r\n        blackAndWhite: $blackAndWhite\r\n        shadow: $shadow\r\n        brightness: $brightness\r\n        latitude: $latitude\r\n        longitude: $longitude\r\n        materials: $materials\r\n        backgroundMode: $backgroundMode\r\n        backgroundColor: $backgroundColor\r\n        backgroundImage: $backgroundImage\r\n        reflectionImage: $reflectionImage\r\n        shader: $shader\r\n    ) {\r\n        id\r\n        modelId\r\n        name\r\n        filter\r\n        enhancedRendering\r\n        acceleratedRendering\r\n        architectEffect\r\n        penDetail\r\n        inkContrast\r\n        blackAndWhite\r\n        shadow\r\n        brightness\r\n        latitude\r\n        longitude\r\n        materials\r\n        backgroundMode\r\n        backgroundColor\r\n        backgroundImage\r\n        reflectionImage\r\n        shader\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateModelRenderSetting=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateModelRenderSetting")},"./99api/graphql/UpdateModelSelectionSet.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateModelSelectionSet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIds"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateModelSelectionSet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"elementIds"},value:{kind:"Variable",name:{kind:"Name",value:"elementIds"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"elementIds"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:274}};r.loc.source={body:"mutation UpdateModelSelectionSet($id: Int!, $name: String, $elementIds: [String]) {\r\n    updateModelSelectionSet(id: $id, name: $name, elementIds: $elementIds) {\r\n        id\r\n        name\r\n        modelId\r\n        elementIds\r\n        createdAt\r\n        updatedAt\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateModelSelectionSet=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateModelSelectionSet")},"./99api/graphql/UploadAsset.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileNames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AssetType"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uploadAsset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"assetName"}}},{kind:"Argument",name:{kind:"Name",value:"filenames"},value:{kind:"Variable",name:{kind:"Name",value:"fileNames"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"uploadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:275}};r.loc.source={body:"mutation UploadAsset(\r\n  $folderId: Int\r\n  $assetName: String!\r\n  $fileNames: [String]!\r\n  $type: AssetType!\r\n) {\r\n  uploadAsset(folderId: $folderId, name: $assetName, filenames: $fileNames, type: $type) {\r\n    id\r\n    uploadUrls {\r\n      filename\r\n      url\r\n    }\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UploadAsset=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UploadAsset")},"./99api/graphql/UploadAssetSuccess.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadAssetSuccess"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uploadAssetSuccess"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"folderId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filenames"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:302}};r.loc.source={body:"mutation UploadAssetSuccess($assetId: Int!) {\r\n  uploadAssetSuccess(id: $assetId) {\r\n    id\r\n    name\r\n    folderId\r\n    type\r\n    status\r\n    filenames\r\n    downloadUrls {\r\n        filename\r\n        url\r\n    }\r\n    createdBy {\r\n        id\r\n      username\r\n    }\r\n    createdAt\r\n    updatedAt\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UploadAssetSuccess=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UploadAssetSuccess")},"./99api/graphql/UploadModel.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filenames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cvtOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uploadModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"filenames"},value:{kind:"Variable",name:{kind:"Name",value:"filenames"}}},{kind:"Argument",name:{kind:"Name",value:"cvtOptions"},value:{kind:"Variable",name:{kind:"Name",value:"cvtOptions"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"uploadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:296}};r.loc.source={body:"mutation UploadModel($folderId: Int!, $name: String!, $filenames: [String]!, $cvtOptions: String) {\r\n    uploadModel(folderId: $folderId, name: $name, filenames: $filenames, cvtOptions: $cvtOptions) {\r\n        id\r\n        uploadUrls {\r\n            filename\r\n            url\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UploadModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UploadModel")},"./99api/graphql/UploadModelSuccess.gql":function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadModelSuccess"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uploadModelSuccess"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"folderId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"targetModelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"version"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"convertedUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:467}};r.loc.source={body:"mutation UploadModelSuccess($modelId: Id!) {\r\n    uploadModelSuccess(id: $modelId) {\r\n        id\r\n        folderId\r\n        targetModelId\r\n        type\r\n        name\r\n        status\r\n        version\r\n        createdBy {\r\n            id\r\n            username\r\n        }\r\n        createdAt\r\n        updatedAt\r\n        downloadUrls {\r\n            filename\r\n            url\r\n        }\r\n        convertedUrls {\r\n            filename\r\n            url\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UploadModelSuccess=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,s=new Set,o=new Set;for(a.forEach(function(e){o.add(e)});o.size>0;){var l=o;o=new Set,l.forEach(function(e){s.has(e)||(s.add(e),(i[e]||new Set).forEach(function(e){o.add(e)}))})}return s.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UploadModelSuccess")},"./99api/index.ts":function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"init",function(){return m});var i=r("./99api/config.ts"),n=r("./99api/Model.ts"),a=r("./99api/Asset.ts"),s=r("./99api/BIM.ts"),o=r("./99api/View.ts"),l=r("./99api/Comment.ts"),d=r("./99api/RenderSetting.ts"),u=r("./99api/utils/index.ts"),c=r("./webgl-utils.js"),h=r("./99api/graphql.types.ts");function m(e){Object(u.assert)(e,Object(u.hasKeys)(["endpoint","appToken"]),"initial config not valid"),Object(i.setConfig)(e)}r.d(t,"ComStatus",function(){return h.ComStatus}),r.d(t,"AssetType",function(){return h.AssetType}),r.d(t,"TaskPriority",function(){return h.TaskPriority}),r.d(t,"TaskCommentType",function(){return h.TaskCommentType}),r.d(t,"IssuePriority",function(){return h.IssuePriority}),r.d(t,"IssueStatus",function(){return h.IssueStatus}),r.d(t,"ModelType",function(){return h.ModelType}),r.d(t,"ModelStatus",function(){return h.ModelStatus}),r.d(t,"SelectionType",function(){return h.SelectionType}),r.d(t,"ModelShaderSetting",function(){return h.ModelShaderSetting}),r.d(t,"AssetStatus",function(){return h.AssetStatus}),r.d(t,"WechatMessageType",function(){return h.WechatMessageType}),e.WebGLUtils=Object(c.default)(),t.default={Model:n.Model,Asset:a.Asset,BIM:s.BIM,Comment:l.Comment,RenderSetting:d.RenderSetting,View:o.View,isSupportWebGL:u.isSupportWebGL,isSupportWebGL2:u.isSupportWebGL2,init:m}}.call(this,r("./node_modules/webpack/buildin/global.js"))},"./99api/utils/IBimTree.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"TypesInfoBySpaces",function(){return n}),r.d(t,"normaliseBimTextTree",function(){return a}),r.d(t,"normaliseElementsInfo",function(){return s});var i=r("./99api/utils/types.ts");const n=[{type:i.BIMTreeNodeType.File,idLabel:"modelId",container:"models"},{type:i.BIMTreeNodeType.Level,idLabel:"levelId",container:"levels"},{type:i.BIMTreeNodeType.Category,idLabel:"categoryId",container:"categories"},{type:i.BIMTreeNodeType.Family,idLabel:"familyId",container:"families"},{type:i.BIMTreeNodeType.Type,idLabel:"typeId",container:"types"},{type:i.BIMTreeNodeType.Element,idLabel:"elementId",container:"elements"}];function a(e,t,r,a={parseProps:!1,useElementIdAsId:!1,onlyDocNames:!1,ignoreElements:!1,modelId:null,docModelId:null,prependModelId:!1}){const s=r.split("\n").splice(1),o={};s.forEach(e=>{const[t,r,i]=e.split(",");r&&i&&(o[`${r}-${i.trim()}`]=t)});let l=1,d=1;const u=a.prependModelId?a.modelId+"+":"",c=(a.parseProps,!!a.useElementIdAsId),h={elements:{},types:{},families:{},levels:{},models:{},categories:{}},m=t.split("\n"),f=[null,null,null,null,null];if(a.onlyDocNames){for(let e=0;e<m.length;e++){const t=m[e];if(0===t.length||" "===t.charAt(0))continue;const[r,n,a]=m[0].match(/(.*)\((\d)\)$/);h.models[u+a]={type:i.BIMTreeNodeType.File,index:0,id:u+a,name:"地形环境",childrenNum:0,isTerrain:!0,levels:[],pathName:`${r}(${a})`}}return h}return m.forEach(t=>{let r=0;for(;" "===t.charAt(0)&&t.length>0;)r++,t=t.substr(1);t=t.trim();const s=n[r],m={type:s.type,index:d++,id:u+s.idLabel+"-"+l++,name:t||"undefined",pathName:t||"",childrenNum:0};if(s.type===i.BIMTreeNodeType.File){if(!t)return;const e=(t=t.slice(0,-1)).lastIndexOf("(");if(-1===e)throw new Error("Not a valid bim.txt");{const r=t.substring(e+1),[i,n]=a.docModelId?a.docModelId[r].split("_"):[null,null];m.id=u+r,m.docId=r,m.name=t.substring(0,e),m.originModelId=i||a.modelId,m.originDocId=n||r,m.pathName=`${m.name}(${m.docId})`}}if(s.type===i.BIMTreeNodeType.Element){if(a.ignoreElements)return;m.modelId=e,m.props="{}";const r=f[0],i=f[2];m.docId=r.docId;const[n,s]=a.docModelId?a.docModelId[m.docId].split("_"):[null,null];m.docAndCatId=parseInt(o[`${r.docId}-${i.name}`]),m.originModelId=n||a.modelId,m.originDocId=s||m.docId,c&&(m.id=u+`${r.docId}/${t}`),m.elementId=`${t}`}else{m[n[r+1].container]=[]}if(s.type!==i.BIMTreeNodeType.File){const e=n[r-1],t=f[r-1];t[s.container].push(m.id),t.childrenNum+=1,m[e.idLabel]=t.id}s.type===i.BIMTreeNodeType.Family&&(m.levelId=f[1].id),f[r]=m,h[s.container][m.id]=m}),h}function s(e,t,r){let i=e.split("/")[1];e.split("/")[0].split("+")[1];const n=(r=r.trim()).split("\n"),a=[];let s=0;return n.forEach(e=>{if(e.indexOf(i)<0)return;const r=e.split(",");if(!t.includes(r[0]))return;let n,o,l;0===s?(n=r[2].trim(),o=Number(r[3]),l=(l=r[4].trim()).length>0?l:null):(n=r[2].slice(1,r[2].length-1).trim(),o=Number(r[3]),l=(l=r[4].slice(1,r[4].length-1).trim()).length>0?l:null),s++,a.push({property:n,numValue:o,strValue:l,__typename:"ElementProperty"})}),a}},"./99api/utils/client/BIMProperty.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"initElementStatus",function(){return T}),r.d(t,"deleteElementsStatus",function(){return S}),r.d(t,"addCustomElementsProperty",function(){return k}),r.d(t,"addCustomElementProperty",function(){return D}),r.d(t,"updateElementStatus",function(){return I}),r.d(t,"removeCustomElementsProperty",function(){return N}),r.d(t,"removeCustomElementProperty",function(){return P}),r.d(t,"updateElementsStatus",function(){return O}),r.d(t,"getElementStatus",function(){return R}),r.d(t,"getBIMStatus",function(){return F}),r.d(t,"getElementsStatus",function(){return C}),r.d(t,"getElementProperties",function(){return B}),r.d(t,"getElementsProperties",function(){return L}),r.d(t,"updateElementProperty",function(){return j}),r.d(t,"updateElementsProperty",function(){return V});var i=r("./99api/utils/model/index.ts"),n=r("./99api/utils/client/model.ts"),a=r("./99api/utils/client/BIMTree.ts"),s=r("./99api/graphql/GetElementProperties.gql"),o=r.n(s),l=r("./99api/graphql/BatchAddProperty.gql"),d=r.n(l),u=r("./99api/graphql/BatchGetProperties.gql"),c=r.n(u),h=r("./99api/graphql/InitElementProperty.gql"),m=r.n(h),f=r("./99api/graphql/BatchDeleteProperty.gql"),p=r.n(f),v=r("./99api/graphql/UpdateElementProperty.gql"),_=r.n(v),g=r("./99api/graphql/BatchUpdateProperty.gql"),b=r.n(g),y=r("./99api/utils/propertyGroups.json"),x=r("./99api/utils/client/gqlClient.ts"),w=r("./03scene/model/m3d_load_misc.js"),E=r("./99api/utils/IBimTree.ts"),M=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const A=/(.*)\+(.*)\/(.*)/,T=(e,t)=>M(void 0,void 0,void 0,function*(){const r=yield Object(a.getBimTree)(e),i=(Object.keys(r.elements).map(e=>r.elements[e]),[t[0],...t].join("<>")),{data:n,errors:s}=yield Object(x.getGQLClient)().mutate({mutation:m.a,variables:{modelId:e,property:"MODELO-STATUS@688",strValue:i}});if(s)throw Error(s[0].message)}),S=e=>M(void 0,void 0,void 0,function*(){const t=yield Object(a.getBimTree)(e),r=Object.keys(t.elements).map(e=>t.elements[e]),{data:i}=yield Object(x.getGQLClient)().mutate({mutation:p.a,variables:{modelId:e,docAndCatIdArr:r.map(e=>e.docAndCatId),elementIdArr:r.map(e=>e.elementId),propertyArr:r.map(e=>"MODELO-STATUS@688")}})}),k=(e,t,r,i)=>M(void 0,void 0,void 0,function*(){const n=yield Object(a.getBimTree)(e),s=t.map(e=>n.elements[e]),{data:o}=yield Object(x.getGQLClient)().mutate({mutation:d.a,variables:{modelId:e,docAndCatIdArr:s.map(e=>e.docAndCatId),elementIdArr:s.map(e=>e.elementId),propertyArr:s.map(e=>`${r}@689`),strValueArr:s.map(e=>i)}});return!0}),D=(e,t,r,i)=>M(void 0,void 0,void 0,function*(){return k(e,[t],r,i)}),I=(e,t,r)=>M(void 0,void 0,void 0,function*(){if(!A.test(t))throw Error(`elementId ${t} seems not correct`);const i=(yield B(e,t)).find(e=>"MODELO-STATUS"===e.name&&688===e.groupKey);if(!i)throw Error("status needs to be initialized first");const n=i.strValue.split("<>");return n[0]=r,yield j(e,t,{name:"MODELO-STATUS",group:"MODELO",groupKey:688,strValue:n.join("<>")}),r}),N=(e,t,r)=>M(void 0,void 0,void 0,function*(){const i=yield Object(a.getBimTree)(e),n=t.map(e=>i.elements[e]),{data:s}=yield Object(x.getGQLClient)().mutate({mutation:p.a,variables:{modelId:e,docAndCatIdArr:n.map(e=>e.docAndCatId),elementIdArr:n.map(e=>e.elementId),propertyArr:n.map(e=>`${r}@689`)}});return!0}),P=(e,t,r)=>M(void 0,void 0,void 0,function*(){return N(e,[t],r)}),O=(e,t,r)=>M(void 0,void 0,void 0,function*(){if(0===t.length)return;if(1===t.length)return I(e,t[0],r);const i=(yield B(e,t[0])).find(e=>"MODELO-STATUS"===e.name&&688===e.groupKey);if(!i)throw Error("status needs to be initialized first");const n=i.strValue.split("<>");return n[0]=r,yield V(e,t,{name:"MODELO-STATUS",group:"MODELO",groupKey:688,strValue:n.join("<>")}),r}),R=(e,t)=>M(void 0,void 0,void 0,function*(){const r=(yield B(e,t)).find(e=>"MODELO-STATUS"===e.name&&688===e.groupKey);if(!r)throw Error("status needs to be initialized first");return r.strValue.split("<>")[0]}),F=e=>M(void 0,void 0,void 0,function*(){const t=yield Object(a.getBimTree)(e),r=t.elements[Object.keys(t.elements)[0]],i=(yield B(e,r.id)).find(e=>"MODELO-STATUS"===e.name&&688===e.groupKey);if(!i)throw Error("status needs to be initialized first");return i.strValue.split("<>").slice(1)}),C=(e,t)=>M(void 0,void 0,void 0,function*(){if(0===t.length)return{};if(1===t.length){const r=yield R(e,t[0]);return{[t[0]]:r}}const r=yield Object(a.getBimTree)(e),i=t.map(e=>r.elements[e]),{data:n,errors:s}=yield Object(x.getGQLClient)().query({query:c.a,variables:{modelId:e,elementIdArr:i.map(e=>e.elementId),propertyArr:i.map(e=>"MODELO-STATUS@688")}});if(s)throw s[0];if(!n.batchGetElementProperties.properties[0].strValues)throw Error("status needs to be initialized first");const o={};return n.batchGetElementProperties.elementIdArr.forEach((e,r)=>{const i=t.find(t=>t.endsWith(e+"")),a=n.batchGetElementProperties.properties[0].strValues[r];if(!a)throw Error("status needs to be initialized first");o[i]=a.split("<>")[0]}),o}),B=(e,t,r)=>M(void 0,void 0,void 0,function*(){if(!A.test(t))throw Error(`elementId ${t} seems not correct`);if(!r){const r=yield Object(a.getBimTree)(e),i=yield U(e,"unit.json"),n=r.elements[t],s=i[n.docId],{data:l}=yield Object(x.getGQLClient)().query({query:o.a,variables:{modelId:n.originModelId,docAndCatId:n.docAndCatId,elementId:n.elementId}});return l.elementProperties.map(e=>{const{property:t,numValue:r,strValue:i}=e,[n,a]=t.split("@");return{name:n,group:y[a],groupKey:parseInt(a),strValue:i,numValue:r,unit:s[n]||null}})}const i=r||"/"+e,n=yield Object(a.getBimTree)(e,i),s=i+"/unit.json",l=yield w.default.OpenFile1(s,"",Promise).downloadFile(),d=JSON.parse(l.data)[n.elements[t].docId],u=i+"/reference.csv",c=yield w.default.OpenFile1(u,"",Promise).downloadFile(),h=z(t,c.data),m=i+"/elementsInfo.csv",f=yield w.default.OpenFile1(m,"",Promise).downloadFile();return Object(E.normaliseElementsInfo)(t,h,f.data).map(e=>{const{property:t,numValue:r,strValue:i}=e,[n,a]=t.split("@");return{name:n,group:y[a],groupKey:parseInt(a),strValue:i,numValue:r,unit:d[n]||null}})}),L=(e,t)=>M(void 0,void 0,void 0,function*(){if(0===t.length)return[];if(1===t.length)return B(e,t[0]);const r=yield Object(a.getBimTree)(e),i=t.map(e=>{if(!A.test(e))throw Error(`elementId ${e} seems not correct`);return r.elements[e]}),n=(yield U(e,"unit.json"),yield U(e,"typeKeys.json"));let s=[];for(let e of i){const t=r.types[e.typeId];s=s.concat(n[e.docId][t.name]||[])}const o=[...new Set(s)].map(e=>{const[t,r,i]=e.split("@");return{name:t,group:y[r],groupKey:parseInt(r),strValue:"2"===i?"multiple values":null,numValue:"1"===i?"multiple values":null}});return new Promise(e=>e(o))}),j=(e,t,r)=>M(void 0,void 0,void 0,function*(){G(r);const i=(yield Object(a.getBimTree)(e)).elements[t];return yield Object(x.getGQLClient)().mutate({mutation:_.a,variables:{modelId:e,docAndCatId:i.docAndCatId,elementId:i.elementId,property:`${r.name}@${r.groupKey}`,strValue:r.strValue,numValue:r.numValue}}),r}),V=(e,t,r)=>M(void 0,void 0,void 0,function*(){G(r);const i=yield Object(a.getBimTree)(e),n=t.map(e=>i.elements[e]),s={modelId:e,docAndCatIdArr:n.map(e=>e.docAndCatId),elementIdArr:n.map(e=>e.elementId),propertyArr:n.map(()=>r).map(e=>`${e.name}@${e.groupKey}`)};return"string"==typeof r.strValue&&(s.strValueArr=n.map(()=>r).map(e=>e.strValue)),"number"==typeof r.numValue&&(s.numValueArr=n.map(()=>r).map(e=>e.numValue)),yield Object(x.getGQLClient)().mutate({mutation:b.a,variables:s}),r}),z=(e,t)=>{const r=e.split("/")[0].split("+")[1],i=t.split("\n"),n=[];for(let e=1;e<i.length;e++){const t=i[e].split(",");t[1]==r&&n.push(t[0])}return n},U=(e,t)=>M(void 0,void 0,void 0,function*(){const r=(yield Object(n.getModelFiles)(e)).convertedUrls.find(e=>e.filename===t);if(!r)throw Error(`this model does not contain ${t}`);if(t.endsWith(".json")){const{data:t}=yield Object(i.downloadFile)(e,r);return t}if(t.endsWith(".csv")){const{data:t}=yield Object(i.downloadFile)(e,r),n=t.split("\n").splice(1),a={};return n.filter(e=>e).forEach(e=>{const[t,r,i]=e.trim().split(",");a[`${r}-${i}`]=parseInt(t)}),a}return null}),G=e=>{if("number"!=typeof e.numValue&&"string"!=typeof e.strValue)throw Error("[strValue, numValue] should set one correct value");if("number"==typeof e.numValue&&"string"==typeof e.strValue)throw Error("[strValue, numValue] can only set one value");return!0}},"./99api/utils/client/BIMTree.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"getBimTree",function(){return d});var i=r("./99api/utils/IBimTree.ts"),n=r("./99api/utils/client/model.ts"),a=r("./99api/utils/model/index.ts"),s=r("./03scene/model/m3d_load_misc.js"),o=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const l={};function d(e,t){return o(this,void 0,void 0,function*(){if(l[e])return l[e];if(t){const r=t||"/"+e,n=r+"/bim.txt",a=r+"/reference.csv",o=r+"/docModelId.json";let d=yield s.default.OpenFile1(n,"",Promise).downloadFile(),u=yield s.default.OpenFile1(a,"",Promise).downloadFile(),c=null;try{c=yield s.default.OpenFile1(o,"json",Promise).downloadFile()}catch(e){}const h=Object(i.normaliseBimTextTree)(e,d.data,u.data,{useElementIdAsId:!0,docModelId:c?c.data:null,modelId:e,prependModelId:!0});return l[e]=h,h}{const t=yield Object(n.getModelFiles)(e),r=t.convertedUrls.filter(e=>"bim.txt"===e.filename)[0];if(!r)throw new Error("this model does not contain bim tree information");const s=t.convertedUrls.filter(e=>"reference.csv"===e.filename)[0];if(!s)throw new Error("this model does not contain reference.csv");const o=t.convertedUrls.find(e=>"docModelId.json"===e.filename),d=o?(yield Object(a.downloadFile)(e,o)).data:null,{data:u}=yield Object(a.downloadFile)(e,r),{data:c}=yield Object(a.downloadFile)(e,s),h=Object(i.normaliseBimTextTree)(e,u,c,{useElementIdAsId:!0,docModelId:d,modelId:e,prependModelId:!0});return l[e]=h,h}})}},"./99api/utils/client/asset.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"assetTypes",function(){return w}),r.d(t,"uploadAsset",function(){return E}),r.d(t,"deleteAsset",function(){return M}),r.d(t,"getAsset",function(){return A}),r.d(t,"updateAsset",function(){return T});var i=r("./node_modules/mime/index.js"),n=r.n(i),a=r("./node_modules/axios/index.js"),s=r.n(a),o=r("./99api/graphql/GetAsset.gql"),l=r.n(o),d=r("./99api/graphql/UploadAsset.gql"),u=r.n(d),c=r("./99api/graphql/UpdateAsset.gql"),h=r.n(c),m=r("./99api/graphql/DeleteAsset.gql"),f=r.n(m),p=r("./99api/graphql/UploadAssetSuccess.gql"),v=r.n(p),_=r("./99api/utils/client/gqlClient.ts"),g=r("./99api/utils/client/folder.ts"),b=r("./99api/utils/index.ts"),y=r("./99api/graphql.types.ts"),x=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const w={dwg:y.AssetType.Dwg},E=(e,t,r)=>x(void 0,void 0,void 0,function*(){const i=yield Object(g.getAssetFolder)();let a=t;if(!t){const t=Object(b.getExtension)(e.name);a=t&&w[t]?w[t]:y.AssetType.File}const{data:o}=yield Object(_.getGQLClient)().mutate({mutation:u.a,variables:{folderId:i.id,assetName:e.name,fileNames:[e.name],type:a}}),{id:l,uploadUrls:d}=o.uploadAsset;yield s.a.put(d[0].url,e,{headers:{"Content-Type":n.a.getType(e.name)},onUploadProgress:e=>{const t=e.loaded/e.total;r&&r(t)}});const{data:c}=yield Object(_.getGQLClient)().mutate({mutation:v.a,variables:{assetId:l}});return S(c.uploadAssetSuccess)}),M=e=>x(void 0,void 0,void 0,function*(){const{errors:t}=yield Object(_.getGQLClient)().mutate({mutation:f.a,variables:{assetId:e}});if(t)throw Error(t[0].message);return e}),A=e=>x(void 0,void 0,void 0,function*(){const{data:t,errors:r}=yield Object(_.getGQLClient)().query({query:l.a,variables:{assetId:e}});if(!t.asset)throw Error("asset does not exist");if(r)throw Error(r[0].message);return S(t.asset)}),T=(e,t)=>x(void 0,void 0,void 0,function*(){return yield Object(_.getGQLClient)().mutate({mutation:h.a,variables:{assetId:e,name:t}}),e});function S(e){if(!e.downloadUrls)throw Error(`get download url for ${e.name} failed`);return{id:e.id,name:e.name,status:e.status,type:e.type,downloadUrl:e.downloadUrls[0].url,convertedUrls:e.convertedUrls?e.convertedUrls.map(e=>({filename:e.filename,url:e.url})):null,panoConvertedUrl:e.panoConvertedUrl?e.panoConvertedUrl:null,updatedAt:e.updatedAt}}},"./99api/utils/client/auth.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"signIn",function(){return o}),r.d(t,"signOut",function(){return l});var i=r("./node_modules/axios/index.js"),n=r.n(i),a=r("./99api/config.ts"),s=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const o=(e,t,r)=>s(void 0,void 0,void 0,function*(){if(!a.default.endpoint)throw Error("ModeloAPI needs to be initialized first. Call Modelo.init().");const t=(i=e,decodeURIComponent(escape(window.atob(i))));var i;const[s,o]=t.split(","),l=yield n.a.post(a.default.endpoint+"/login",{username:s,password:o},{headers:r});localStorage.setItem("token",l.data.token)}),l=()=>{localStorage.removeItem("token")}},"./99api/utils/client/comment.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"getModelComments",function(){return v}),r.d(t,"deleteModelComment",function(){return _}),r.d(t,"addModelComment",function(){return g}),r.d(t,"updateModelComment",function(){return b}),r.d(t,"createComment",function(){return y});var i=r("./99api/graphql/GetModelComments.gql"),n=r.n(i),a=r("./99api/graphql/GetModelComment.gql"),s=r.n(a),o=r("./99api/graphql/DeleteModelComment.gql"),l=r.n(o),d=r("./99api/graphql/UpdateModelComment.gql"),u=r.n(d),c=r("./99api/graphql/AddModelComment.gql"),h=r.n(c),m=r("./99api/utils/client/gqlClient.ts"),f=r("./99api/utils/common/index.ts"),p=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const v=e=>p(void 0,void 0,void 0,function*(){const{data:t,errors:r}=yield Object(m.getGQLClient)().query({query:n.a,variables:{modelId:e}});if(r)throw Error(r[0].message);if(!t.modelComments)throw Error(`model ${e} does not exist`);return t.modelComments}),_=e=>p(void 0,void 0,void 0,function*(){const{data:t,errors:r}=yield Object(m.getGQLClient)().mutate({mutation:l.a,variables:{id:e}});if(!t)throw Error(`comment ${e} does not exist`);if(r)throw Error(r[0].message);return e}),g=(e,t,r,i,n)=>p(void 0,void 0,void 0,function*(){const a=t,s=i,o=n,{data:l,errors:d}=yield Object(m.getGQLClient)().mutate({mutation:h.a,variables:{message:r,plainText:a,bimdata:o,camera:s,modelId:e}});if(!l)throw Error(`model ${e} does not exist`);if(d)throw Error(d[0].message);return l.addModelComment.id}),b=(e,t)=>p(void 0,void 0,void 0,function*(){const{data:r,errors:i}=yield Object(m.getGQLClient)().query({query:s.a,variables:{commentId:e},fetchPolicy:"cache-first"});if(!r)throw Error(`comment ${e} does not exist`);if(i)throw Error(i[0].message);const n=r.modelComment,a=Object.assign({},JSON.parse(n.message),t),{data:o,errors:l}=yield Object(m.getGQLClient)().mutate({mutation:u.a,variables:{id:e,message:JSON.stringify(a),plainText:"placeholder"}});if(!o)throw Error(`comment ${e} does not exist`);if(l)throw Error(l[0].message);return Object(f.decodeComment)(o.updateModelComment)}),y=(e,t,r)=>p(void 0,void 0,void 0,function*(){const{data:i}=yield Object(m.getGQLClient)().mutate({mutation:h.a,variables:{modelId:e,plainText:"placeholder",message:JSON.stringify(r),camera:JSON.stringify(t)}}),n=i.addModelComment;return Object(f.decodeComment)(n)})},"./99api/utils/client/folder.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"getModelFolder",function(){return d}),r.d(t,"getAssetFolder",function(){return u});var i=r("./99api/utils/client/gqlClient.ts"),n=r("./99api/graphql/GetModelFolder.gql"),a=r.n(n),s=r("./99api/graphql/GetAssetFolder.gql"),o=r.n(s),l=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const d=()=>l(void 0,void 0,void 0,function*(){const{data:e,errors:t}=yield Object(i.getGQLClient)().query({query:a.a,variables:{}});if(t)throw Error(t[0].message);return e.user.projects[0].modelFolder}),u=()=>l(void 0,void 0,void 0,function*(){const{data:e,errors:t}=yield Object(i.getGQLClient)().query({query:o.a,variables:{}});if(t)throw Error(t[0].message);return e.user.projects[0].assetFolder})},"./99api/utils/client/gqlClient.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"getGQLClient",function(){return u});var i=r("./node_modules/apollo-client/bundle.esm.js"),n=r("./node_modules/apollo-link-http/lib/bundle.esm.js"),a=r("./node_modules/apollo-link/lib/bundle.esm.js"),s=r("./node_modules/apollo-cache-inmemory/lib/bundle.esm.js"),o=r("./node_modules/apollo-link-error/lib/bundle.esm.js"),l=r("./99api/config.ts");const d={},u=()=>{if(d.gqlClient)return d.gqlClient;const e=new n.HttpLink({uri:l.default.endpoint+"/graphql"}),t=Object(o.onError)(({graphQLErrors:e,networkError:t,operation:r,response:i})=>{e&&/Expected type \"Id\"/.test(e[0].message)&&(i.errors=[Error("model id is not valid")]),"InitElementProperty"===r.operationName&&e&&e[0]&&"property already exist"===e[0].message&&(i.errors=[Error("element Status cannot be initialized multiple times")])}),r=new a.ApolloLink((e,t)=>{let r={"x-access-token":l.default.appToken};return l.default.headers&&(r=Object.assign({},l.default.headers,r)),e.setContext({headers:r}),t(e)}),u=new i.ApolloClient({link:a.ApolloLink.from([t,r,e]),cache:new s.InMemoryCache,defaultOptions:{watchQuery:{fetchPolicy:"cache-and-network",errorPolicy:"all"},query:{fetchPolicy:"network-only",errorPolicy:"all"},mutate:{errorPolicy:"all"}}});return d.gqlClient=u,u}},"./99api/utils/client/index.ts":function(e,t,r){"use strict";r.r(t);var i=r("./99api/utils/client/model.ts");r.d(t,"getModel",function(){return i.getModel}),r.d(t,"getModelFiles",function(){return i.getModelFiles}),r.d(t,"deleteModel",function(){return i.deleteModel}),r.d(t,"uploadModel",function(){return i.uploadModel}),r.d(t,"updateModel",function(){return i.updateModel}),r.d(t,"combineModel",function(){return i.combineModel}),r.d(t,"sliceModel",function(){return i.sliceModel}),r.d(t,"mergeModel",function(){return i.mergeModel}),r.d(t,"generate3DPDF",function(){return i.generate3DPDF}),r.d(t,"get3DPDFURL",function(){return i.get3DPDFURL});var n=r("./99api/utils/client/asset.ts");r.d(t,"assetTypes",function(){return n.assetTypes}),r.d(t,"uploadAsset",function(){return n.uploadAsset}),r.d(t,"deleteAsset",function(){return n.deleteAsset}),r.d(t,"getAsset",function(){return n.getAsset}),r.d(t,"updateAsset",function(){return n.updateAsset});var a=r("./99api/utils/client/auth.ts");r.d(t,"signIn",function(){return a.signIn}),r.d(t,"signOut",function(){return a.signOut});var s=r("./99api/utils/client/BIMProperty.ts");r.d(t,"initElementStatus",function(){return s.initElementStatus}),r.d(t,"deleteElementsStatus",function(){return s.deleteElementsStatus}),r.d(t,"addCustomElementsProperty",function(){return s.addCustomElementsProperty}),r.d(t,"addCustomElementProperty",function(){return s.addCustomElementProperty}),r.d(t,"updateElementStatus",function(){return s.updateElementStatus}),r.d(t,"removeCustomElementsProperty",function(){return s.removeCustomElementsProperty}),r.d(t,"removeCustomElementProperty",function(){return s.removeCustomElementProperty}),r.d(t,"updateElementsStatus",function(){return s.updateElementsStatus}),r.d(t,"getElementStatus",function(){return s.getElementStatus}),r.d(t,"getBIMStatus",function(){return s.getBIMStatus}),r.d(t,"getElementsStatus",function(){return s.getElementsStatus}),r.d(t,"getElementProperties",function(){return s.getElementProperties}),r.d(t,"getElementsProperties",function(){return s.getElementsProperties}),r.d(t,"updateElementProperty",function(){return s.updateElementProperty}),r.d(t,"updateElementsProperty",function(){return s.updateElementsProperty});var o=r("./99api/utils/client/BIMTree.ts");r.d(t,"getBimTree",function(){return o.getBimTree});var l=r("./99api/utils/client/folder.ts");r.d(t,"getModelFolder",function(){return l.getModelFolder}),r.d(t,"getAssetFolder",function(){return l.getAssetFolder});var d=r("./99api/utils/client/comment.ts");r.d(t,"getModelComments",function(){return d.getModelComments}),r.d(t,"deleteModelComment",function(){return d.deleteModelComment}),r.d(t,"addModelComment",function(){return d.addModelComment}),r.d(t,"updateModelComment",function(){return d.updateModelComment}),r.d(t,"createComment",function(){return d.createComment});var u=r("./99api/utils/client/selectionSet.ts");r.d(t,"createModelSelectionSet",function(){return u.createModelSelectionSet}),r.d(t,"getModelSelectionSets",function(){return u.getModelSelectionSets}),r.d(t,"updateModelSelectionSet",function(){return u.updateModelSelectionSet}),r.d(t,"deleteModelSelectionSet",function(){return u.deleteModelSelectionSet});var c=r("./99api/utils/client/renderSetting.ts");r.d(t,"getModelRenderSettings",function(){return c.getModelRenderSettings}),r.d(t,"createModelRenderSetting",function(){return c.createModelRenderSetting}),r.d(t,"deleteModelRenderSetting",function(){return c.deleteModelRenderSetting}),r.d(t,"updateModelRenderSetting",function(){return c.updateModelRenderSetting})},"./99api/utils/client/model.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"getModel",function(){return D}),r.d(t,"getModelFiles",function(){return I}),r.d(t,"deleteModel",function(){return N}),r.d(t,"uploadModel",function(){return P}),r.d(t,"updateModel",function(){return O}),r.d(t,"combineModel",function(){return R}),r.d(t,"sliceModel",function(){return F}),r.d(t,"mergeModel",function(){return C}),r.d(t,"generate3DPDF",function(){return B}),r.d(t,"get3DPDFURL",function(){return L});var i=r("./99api/graphql/GetModel.gql"),n=r.n(i),a=r("./99api/graphql/GetModelFiles.gql"),s=r.n(a),o=r("./99api/graphql/DeleteModel.gql"),l=r.n(o),d=r("./99api/graphql/UploadModel.gql"),u=r.n(d),c=r("./99api/graphql/UploadModelSuccess.gql"),h=r.n(c),m=r("./99api/graphql/UpdateModel.gql"),f=r.n(m),p=r("./99api/graphql/AddCombinedModel.gql"),v=r.n(p),_=r("./99api/graphql/AddSliceModel.gql"),g=r.n(_),b=r("./99api/graphql/Generate3DPDF.gql"),y=r.n(b),x=r("./99api/graphql/Get3DPDFURL.gql"),w=r.n(x),E=r("./node_modules/axios/index.js"),M=r.n(E),A=r("./99api/utils/client/gqlClient.ts"),T=r("./99api/utils/client/folder.ts"),S=r("./99api/utils/model/index.ts"),k=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const D=e=>k(void 0,void 0,void 0,function*(){const{data:t,errors:r}=yield Object(A.getGQLClient)().query({query:n.a,variables:{modelId:e}});if(!t||!t.model)throw Error("model does not exist");if(r)throw Error(r[0].message);return j(t.model)}),I=e=>k(void 0,void 0,void 0,function*(){const{data:t,errors:r}=yield Object(A.getGQLClient)().query({query:s.a,variables:{modelId:e},fetchPolicy:"cache-first"});if(!t.model)throw Error("model does not exist");if(r)throw Error(r[0].message);return t.model}),N=e=>k(void 0,void 0,void 0,function*(){const{errors:t}=yield Object(A.getGQLClient)().mutate({mutation:l.a,variables:{modelId:e},errorPolicy:"all"});if(t)throw Error(t[0].message);return e}),P=(e,t,r)=>k(void 0,void 0,void 0,function*(){if(!Object(S.validateFileExt)(e.name))throw Error("file format not valid");const i=yield Object(T.getModelFolder)(),{data:n}=yield Object(A.getGQLClient)().mutate({mutation:u.a,variables:{folderId:i.id,name:e.name,filenames:[e.name],cvtOptions:t?"-comptex":""}}),{id:a,uploadUrls:s}=n.uploadModel;yield M.a.put(s[0].url,e,{onUploadProgress:e=>{const t=e.loaded/e.total;r&&r(t)}});const{data:o}=yield Object(A.getGQLClient)().mutate({mutation:h.a,variables:{modelId:a}});return j(o.uploadModelSuccess)}),O=(e,t)=>k(void 0,void 0,void 0,function*(){return yield Object(A.getGQLClient)().mutate({mutation:f.a,variables:{modelId:e,name:t}}),e}),R=(e,t)=>k(void 0,void 0,void 0,function*(){const r=yield Object(T.getModelFolder)();if(2!==t.length)throw Error("combined model requires two models");const{data:i}=yield Object(A.getGQLClient)().mutate({mutation:v.a,variables:{folderId:r.id,name:e,modelIds:t}});return i.addCombinedModel}),F=(e,t)=>k(void 0,void 0,void 0,function*(){const r=yield Object(T.getModelFolder)(),{data:i}=yield Object(A.getGQLClient)().mutate({mutation:g.a,variables:{name:e,query:t,folderId:r.id}});return i.sliceModel.id}),C=(e,t,r)=>k(void 0,void 0,void 0,function*(){if(t.length<2)throw Error("merge model requires at least 2 models");const i={modelFragments:t.map(e=>({modelId:e,tree:"*",transform:[]}))};if(r)for(let e=0;e<r.length;e++)i.modelFragments[e].transform=r[e];return yield F(e,JSON.stringify(i,null,0))}),B=e=>k(void 0,void 0,void 0,function*(){if(null==e)throw Error("Please enter a valid modelId");const{data:t}=yield Object(A.getGQLClient)().mutate({mutation:y.a,variables:{modelId:e}});return t.modelStartConvertToPdf.assetId}),L=e=>k(void 0,void 0,void 0,function*(){const{data:t}=yield Object(A.getGQLClient)().query({query:w.a,variables:{assetId:e}});return t.asset.downloadUrls[0].url});function j(e){let t,r;return e.downloadUrls&&e.downloadUrls.length&&(t=e.downloadUrls[0],r=e.downloadUrls.filter(t=>t.filename!==e.name)),{id:e.id,name:e.name,convertedUrls:e.convertedUrls?e.convertedUrls.map(e=>({filename:e.filename,url:e.url})):null,downloadUrl:t?t.url:null,attachments:r,status:e.status,createdAt:e.createdAt}}},"./99api/utils/client/renderSetting.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"getModelRenderSettings",function(){return m}),r.d(t,"createModelRenderSetting",function(){return f}),r.d(t,"deleteModelRenderSetting",function(){return p}),r.d(t,"updateModelRenderSetting",function(){return v});var i=r("./99api/utils/client/gqlClient.ts"),n=r("./99api/graphql/GetModelRenderSetting.gql"),a=r.n(n),s=r("./99api/graphql/AddModelRenderSetting.gql"),o=r.n(s),l=r("./99api/graphql/DeleteModelRenderSetting.gql"),d=r.n(l),u=r("./99api/graphql/UpdateModelRenderSetting.gql"),c=r.n(u),h=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};function m(e){return h(this,void 0,void 0,function*(){const{data:t,errors:r}=yield Object(i.getGQLClient)().query({query:a.a,variables:{modelId:e}});if(r)throw Error(r[0].message);return t.model.settings})}function f(e,t){return h(this,void 0,void 0,function*(){const{data:r,errors:n}=yield Object(i.getGQLClient)().mutate({mutation:o.a,variables:Object.assign({modelId:e},t)});if(n)throw Error(n[0].message);return r})}function p(e){return h(this,void 0,void 0,function*(){const{data:t,errors:r}=yield Object(i.getGQLClient)().mutate({mutation:d.a,variables:{id:e}});if(!t)throw Error(`render setting ${e} does not exist`);if(r)throw Error(r[0].message);return e})}function v(e,t){return h(this,void 0,void 0,function*(){const{data:r,errors:n}=yield Object(i.getGQLClient)().mutate({mutation:c.a,variables:Object.assign({},t,{id:e})});if(!r)throw Error(`render setting ${e} does not exist`);if(n)throw Error(n[0].message);return r.updateModelSettings})}},"./99api/utils/client/selectionSet.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"createModelSelectionSet",function(){return f}),r.d(t,"getModelSelectionSets",function(){return p}),r.d(t,"updateModelSelectionSet",function(){return v}),r.d(t,"deleteModelSelectionSet",function(){return _});var i=r("./99api/graphql/AddModelSelectionSet.gql"),n=r.n(i),a=r("./99api/graphql/GetModelSelectionSets.gql"),s=r.n(a),o=r("./99api/graphql/UpdateModelSelectionSet.gql"),l=r.n(o),d=r("./99api/graphql/DeleteModelSelectionSet.gql"),u=r.n(d),c=r("./99api/utils/client/gqlClient.ts"),h=r("./99api/utils/common/index.ts"),m=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const f=(e,t,r)=>m(void 0,void 0,void 0,function*(){const{data:i}=yield Object(c.getGQLClient)().mutate({mutation:n.a,variables:{name:t,modelId:e,elementIds:r}});return Object(h.omitTypes)(i.addModelSelectionSet)}),p=e=>m(void 0,void 0,void 0,function*(){const{data:t}=yield Object(c.getGQLClient)().query({query:s.a,variables:{modelId:e}});return t.model.modelSelectionSets.map(e=>Object(h.omitTypes)(e))}),v=(e,t,r)=>m(void 0,void 0,void 0,function*(){const{data:i}=yield Object(c.getGQLClient)().mutate({mutation:l.a,variables:{id:e,name:t,elementIds:r}});return Object(h.omitTypes)(i.updateModelSelectionSet)}),_=e=>m(void 0,void 0,void 0,function*(){return yield Object(c.getGQLClient)().mutate({mutation:u.a,variables:{id:e}}),e})},"./99api/utils/common/index.ts":function(e,t,r){"use strict";function i(e){const t=Object.create(null);for(const r in e)"symbol"!=typeof e[r]&&"__typename"!==r&&(t[r]=e[r]);return t}function n(e){const t={id:e.id,renderData:JSON.parse(e.camera),createdAt:e.createdAt};return"{}"!==e.message&&(t.extData=JSON.parse(e.message)),t}function a(e){return e.map(e=>n(e))}r.r(t),r.d(t,"omitTypes",function(){return i}),r.d(t,"decodeComment",function(){return n}),r.d(t,"decodeComments",function(){return a})},"./99api/utils/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"hasKeys",function(){return i}),r.d(t,"hasKey",function(){return n}),r.d(t,"oneOf",function(){return a}),r.d(t,"assert",function(){return s}),r.d(t,"isSupportWebGL",function(){return o}),r.d(t,"isSupportWebGL2",function(){return l}),r.d(t,"ViewAngle",function(){return d}),r.d(t,"deprecate",function(){return u}),r.d(t,"getExtension",function(){return c});const i=e=>t=>e.every(e=>e in t),n=e=>t=>e in t,a=e=>t=>e.includes(t);function s(e,t,r){if(!t(e)){const t=JSON.stringify(e,null,2);throw Error(`${r} ${t}`||`validation of ${t} failed`)}}function o(e){const t=e.createElement("canvas");return null!==WebGLUtils.setupWebGL(t,{webgl2:!1})}function l(e){const t=e.createElement("canvas"),r=WebGLUtils.setupWebGL(t,{webgl2:!0});return!!r&&null!==r.getParameter(r.VERSION).match("WebGL 2.0")}var d;function u(e,t){let r=!1;return function(){return r||(console.warn(t),r=!0),e.apply(this,arguments)}}function c(e){const t=e.split(".");return 1===t.length?null:t[t.length-1].toLowerCase()}!function(e){e[e.FRONT=0]="FRONT",e[e.BACK=1]="BACK",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e[e.TOP=4]="TOP",e[e.BOTTOM=5]="BOTTOM",e[e.WORLD=6]="WORLD"}(d||(d={}))},"./99api/utils/measure.ts":function(e,t,r){"use strict";function i(e="#6092e2"){const t=document.createElement("div");return t.style.width="16px",t.style.width="16px",t.style.height="16px",t.style.borderRadius="100%",t.style.pointerEvents="none",t.style.backgroundColor=e,t.style.position="absolute",t.style.top="-8px",t.style.left="-10px",t.style.transform="translate(0, 0)",t.style.borderWidth="3px",t.style.display="none",t.style.borderColor=e,t}function n(){const e=document.createElement("div");return e.style.position="relative",e.style.left="0px",e.style.top="-100%",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="none",e.style.overflow="hidden",e}function a(e,t){t?(e.style.display="block",e.style.transform=`translate(${t.pos[0]}px, ${t.pos[1]}px)`,"boolean"==typeof t.isSnapped&&(t.isSnapped?(e.style.backgroundColor="transparent",e.style.border="3px solid #f75223"):e.style.backgroundColor="#f75223")):e.style.display="none"}function s(e="red"){const t=document.createElement("div");return t.style.fontSize="14px",t.style.lineHeight="14px",t.style.height="14px",t.style.width="60px",t.style.pointerEvents="none",t.style.position="absolute",t.style.color=e,t.style.transformOrigin="center",t.style.left="0",t.style.top="-7px",t.style.padding="0 10px",t}function o(e,t){t?(t.pos?(e.style.display="block",e.style.transform=`translate(${t.pos[0]}px, ${t.pos[1]}px)`):e.style.display="none",t.value&&(e.innerText=t.value),t.color&&(e.style.color=t.color)):e.style.display="none"}r.r(t),r.d(t,"createAnchorPoint",function(){return i}),r.d(t,"createOverlays",function(){return n}),r.d(t,"updateAnchorPoint",function(){return a}),r.d(t,"createAnchorValue",function(){return s}),r.d(t,"updateAnchorValue",function(){return o}),r.d(t,"getCenterPoint",function(){return l});const l=(e,t)=>[(e[0]+t[0])/2,(e[1]+t[1])/2,(e[2]+t[2])/2]},"./99api/utils/model/downloader.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"generatePromises",function(){return o}),r.d(t,"downloadFile",function(){return l});var i=r("./99api/utils/model/localStorage.ts"),n=r("./99api/utils/client/index.ts"),a=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};const s={bin:{mime:"application/octet-binary",responseType:"arraybuffer",type:i.FileTypes.ArrayBuffer},xml:{mime:"application/xml",responseType:"text",type:i.FileTypes.XML},json:{mime:"application/json",responseType:"json",type:i.FileTypes.JSON},txt:{mime:"text/plain",responseType:"text",type:i.FileTypes.Text},csv:{mime:"text/plain",responseType:"text",type:i.FileTypes.Text},jpeg:{mime:"image/jpg",responseType:"blob",type:i.FileTypes.Image},jpg:{mime:"image/jpg",responseType:"blob",type:i.FileTypes.Image},png:{mime:"image/png",responseType:"blob",type:i.FileTypes.Image},gif:{mime:"image/gif",responseType:"blob",type:i.FileTypes.Image},bmp:{mime:"image/bmp",responseType:"blob",type:i.FileTypes.Image}};function o(e,t){return a(this,void 0,void 0,function*(){let r=[];if(t)r=t;else{const t=yield Object(n.getModel)(e);if(!t)throw Error("model does not exist");r=t.convertedUrls}const i={};return(r=r.map(e=>Object.assign({},e,{filename:e.filename.lastIndexOf(".gz")>=0?e.filename.replace(".gz",""):e.filename}))).forEach(t=>{const r=[];let n,s=!1;const o=e=>{s||r.forEach(t=>{t(e)})},l=new Promise((e,t)=>{n=(()=>{s=!0,e()})});i[t.filename]={progressEvents:r,progressFn:o,cancel:n,filename:t.filename,downloadFile:()=>a(this,void 0,void 0,function*(){if(!s)return d(e,t,o,l)}),onProgress:e=>{r.push(e)}}}),i})}function l(e,t){return d(e,t,()=>{})}function d(e,t,r,n){return a(this,void 0,void 0,function*(){const o=function(e){const t=e.split(".").pop()||"";return s[t.toLowerCase()]}(t.filename);let l=yield Object(i.openFile)("model-"+e+"/"+t.filename,o);if(l){new ProgressEvent("mesh");r({loaded:l.byteLength||0,total:l.byteLength||1})}else l=(yield function(e,t,r,i){return a(this,void 0,void 0,function*(){return new Promise((n,a)=>{const s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType=e.responseType,s.onload=(()=>{200===s.status||206===s.status?n({data:s.response}):a()}),s.onprogress=(e=>{r(e)}),s.onerror=(e=>{a(e)}),i&&i.then(()=>{s.abort()}),s.send()})})}(o,t.url,r,n)).data,Object(i.saveFile)(l,o,"model-"+e+"/"+t.filename).then(()=>{});return"blob"!==o.responseType?{data:l}:function(e,t){return a(this,void 0,void 0,function*(){const r=window.URL||window.webkitURL,i=r.createObjectURL(e);return new Promise((e,r)=>{const n=new Image;n.name=t,n.src=i,n.crossOrigin="",n.onload=(()=>e(n)),n.onerror=(e=>{r("error downloading image:"+t)})})})}(l,t.filename)})}},"./99api/utils/model/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"validateFileExt",function(){return a});var i=r("./99api/utils/model/downloader.ts");r.d(t,"generatePromises",function(){return i.generatePromises}),r.d(t,"downloadFile",function(){return i.downloadFile});const n=[".obj",".3dm",".skp",".stl",".m3d",".zip",".ifc",".rvt",".fbx",".rfa",".nwc",".nwd",".s3d",".max",".dgn"];function a(e){return n.some(t=>e.toLowerCase().endsWith(t))}},"./99api/utils/model/localStorage.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"FileTypes",function(){return i}),r.d(t,"openFile",function(){return u}),r.d(t,"saveFile",function(){return c});var i,n=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})};!function(e){e.Text="text",e.ArrayBuffer="arraybuffer",e.Image="blob",e.JSON="json",e.XML="text"}(i||(i={}));const a=(/Chrome/.test(navigator.userAgent)||/Safari/.test(navigator.userAgent))&&(/Google Inc/.test(navigator.vendor)||/Apple Computer, Inc/.test(navigator.vendor)),s={temporary:1073741824};function o(e,t){return n(this,void 0,void 0,function*(){const r={create:t};return new Promise((t,i)=>{(function(){return n(this,void 0,void 0,function*(){return new Promise((e,t)=>{a&&(window.requestFileSystem||window.webkitRequestFileSystem)?(window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,s.temporary,e,t)):t("FILESYSTEM_NOT_SUPPORTED")})})})().then(n=>n.root.getDirectory(e,r,t,i)).catch(i)})})}function l(e,t,r){return n(this,void 0,void 0,function*(){const i={create:t};return new Promise((n,a)=>{o(e,t).then(e=>e.getFile(r,i,n,a)).catch(a)})})}function d(e){const t=e.split("/").pop()||"";return{directory:e.replace(t,""),fileName:t}}function u(e,t){return n(this,void 0,void 0,function*(){return function(e,t){return n(this,void 0,void 0,function*(){const{directory:r,fileName:a}=d(e),s=yield l(r,!1,a),o=yield new Promise((e,t)=>s.file(e,t));if(0===o.size)throw new Error("FILE_SIZE_ZERO");const u=yield function(e,t){return n(this,void 0,void 0,function*(){const r=new FileReader;return new Promise((n,a)=>{switch(r.onloadend=(()=>{void 0!==r.result||null!==r.result?n(r.result):a(r.error)}),e.type){case i.JSON:case i.XML:r.readAsText(t);break;case i.ArrayBuffer:case i.Image:r.readAsArrayBuffer(t);break;default:throw new Error("File has no type")}})})}(t,o);return t.type===i.Image?new Blob([u],{type:t.mime}):t.type===i.JSON?JSON.parse(u):u})}(e,t).then(e=>e).catch(e=>null)})}function c(e,t,r){return n(this,void 0,void 0,function*(){let a;if(t.type===i.JSON){const r=JSON.stringify(e);a=new Blob([r],{type:t.mime})}else a=t.type===i.Image?e:new Blob([e],{type:t.mime});return function(e,t,r){return n(this,void 0,void 0,function*(){const{directory:r,fileName:i}=d(e),n=yield l(r,!0,i),a=yield new Promise(e=>n.createWriter(e));return new Promise((e,r)=>{a.onerror=(e=>r()),a.onwriteend=(()=>e()),a.write(t)})})}(r,a)})}},"./99api/utils/propertyGroups.json":function(e){e.exports={0:"PG_IDENTITY_DATA",1:"PG_GEOMETRY",3:"PG_CONSTRUCTION",4:"PG_GRAPHICS",5:"PG_MATERIALS",6:"PG_UNDERLAY",7:"PG_STAIR_TREADS",8:"PG_STAIR_RISERS",9:"PG_STAIR_STRINGERS",10:"PG_ELECTRICAL",11:"PG_PLUMBING",12:"PG_STRUCTURAL",13:"PG_MECHANICAL",14:"PG_PHASING",19:"PG_CONSTRAINTS",20:"PG_PATTERN",21:"PG_VIEW_EXTENTS",22:"PG_VIEW_CAMERA",23:"PG_TEXT",24:"PG_ELECTRICAL_LIGHTING",25:"PG_ELECTRICAL_LOADS",26:"PG_MECHANICAL_LOADS",27:"PG_MECHANICAL_AIRFLOW",28:"PG_STRUCTURAL_ANALYSIS",29:"PG_ENERGY_ANALYSIS",30:"PG_AELECTRICAL",31:"PG_IFC",33:"PG_CURTAIN_GRID_VERT",34:"PG_CURTAIN_GRID_1",35:"PG_CURTAIN_GRID_HORIZ",36:"PG_CURTAIN_GRID_2",37:"PG_CURTAIN_MULLION_VERT",38:"PG_CURTAIN_MULLION_1",39:"PG_CURTAIN_MULLION_HORIZ",40:"PG_CURTAIN_MULLION_2",41:"PG_CURTAIN_GRID",43:"PG_REBAR_SYSTEM_LAYERS",44:"PG_REBAR_ARRAY",45:"PG_ANALYTICAL_MODEL",46:"PG_TRANSLATION_IN",47:"PG_ROTATION_ABOUT",48:"PG_FIRE_PROTECTION",49:"PG_TITLE",50:"PG_TRUSS_FAMILY_VERT_WEB",51:"PG_TRUSS_FAMILY_DIAG_WEB",52:"PG_TRUSS_FAMILY_TOP_CHORD",53:"PG_TRUSS_FAMILY_BOTTOM_CHORD",54:"PG_PROFILE",55:"PG_PROFILE_1",56:"PG_PROFILE_2",57:"PG_GREEN_BUILDING",58:"PG_PATTERN_APPLICATION",59:"PG_LIGHT_PHOTOMETRICS",60:"PG_SLAB_SHAPE_EDIT",61:"PG_ANALYSIS_RESULTS",62:"PG_DISPLAY",63:"PG_CURTAIN_GRID_U",64:"PG_CURTAIN_GRID_V",65:"PG_ADSK_MODEL_PROPERTIES",66:"PG_AREA",67:"PG_CONCEPTUAL_ENERGY_DATA",68:"PG_FITTING",69:"PG_ENERGY_ANALYSIS_DETAILED_AND_CONCEPTUAL_MODELS",70:"PG_ENERGY_ANALYSIS_DETAILED_MODEL",71:"PG_ENERGY_ANALYSIS_CONCEPTUAL_MODEL",72:"PG_FLEXIBLE",73:"PG_GENERAL",74:"PG_ELECTRICAL_CIRCUITING",75:"PG_DATA",76:"PG_CONCEPTUAL_ENERGY_DATA_BUILDING_SERVICES",77:"PG_RAILING_SYSTEM_FAMILY_TOP_RAIL",78:"PG_RAILING_SYSTEM_FAMILY_HANDRAILS",79:"PG_RAILING_SYSTEM_FAMILY_SEGMENT_PATTERN",80:"PG_RAILING_SYSTEM_SEGMENT_PATTERN_REPEAT",81:"PG_RAILING_SYSTEM_SEGMENT_PATTERN_REMAINDER",82:"PG_RAILING_SYSTEM_SEGMENT_POSTS",83:"PG_RAILING_SYSTEM_SEGMENT_U_GRID",84:"PG_RAILING_SYSTEM_SEGMENT_V_GRID",85:"PG_SUPPORT",86:"PG_VISIBILITY",87:"PG_OVERALL_LEGEND",88:"PG_INSULATION",89:"PG_LINING",90:"PG_SYSTEMTYPE_RISEDROP",91:"PG_ANALYTICAL_ALIGNMENT",92:"PG_ANALYTICAL_PROPERTIES",93:"PG_NODES",94:"PG_LENGTH",95:"PG_SPLIT_PROFILE_DIMENSIONS",96:"PG_STAIRS_CALCULATOR_RULES",97:"PG_STAIRS_TREADS_RISERS",98:"PG_TERMINTATION",99:"PG_RAILING_SYSTEM_SECONDARY_FAMILY_HANDRAILS",100:"PG_STAIRS_OPEN_END_CONNECTION",101:"PG_STAIRS_SUPPORTS",102:"PG_STAIRS_WINDERS",103:"PG_CONTINUOUSRAIL_BEGIN_BOTTOM_EXTENSION",104:"PG_CONTINUOUSRAIL_END_TOP_EXTENSION",105:"PG_SEGMENTS_FITTINGS",106:"PG_DIVISION_GEOMETRY",107:"PG_GEOMETRY_POSITIONING",108:"PG_REFERENCE",110:"PG_FABRICATION_PRODUCT_DATA",111:"PG_FORCES",112:"PG_MOMENTS",113:"PG_PRIMARY_END",114:"PG_SECONDARY_END",116:"PG_RELEASES_MEMBER_FORCES",117:"PG_ENERGY_ANALYSIS_ADVANCED",118:"PG_COUPLER_ARRAY",119:"PG_ENERGY_ANALYSIS_BUILDING_DATA",120:"PG_ENERGY_ANALYSIS_ROOM_SPACE_DATA",121:"PG_ENERGY_ANALYSIS_BLDG_CONS_MTL_THERMAL_PROPS",125:"PG_STRUCTURAL_SECTION_GEOMETRY",126:"PG_GEO_LOCATION",688:"MODELO_PROPERTIES",689:"MODELO_CUSTOM_PROPERTIES",888:"MODELO_CONNECTED_DATA","-1":"INVALID"}},"./99api/utils/types.ts":function(e,t,r){"use strict";var i;r.r(t),r.d(t,"BIMTreeNodeType",function(){return i}),function(e){e.Family="family",e.Level="level",e.Element="element",e.Category="category",e.Type="type",e.File="file"}(i||(i={}))},"./glMatrix.js":function(e,t,r){var i;i=function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){t.glMatrix=r(1),t.mat2=r(2),t.mat2d=r(3),t.mat3=r(4),t.mat4=r(5),t.quat=r(6),t.vec2=r(9),t.vec3=r(7),t.vec4=r(8)},function(e,t){var r={EPSILON:1e-6};r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,r.ENABLE_SIMD=!1,r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in this,r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE,r.setMatrixArrayType=function(e){r.ARRAY_TYPE=e};var i=Math.PI/180;r.toRadian=function(e){return e*i},e.exports=r},function(e,t,r){var i=r(1),n={create:function(){var e=new i.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},clone:function(e){var t=new i.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},transpose:function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},invert:function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r*a-n*i;return s?(s=1/s,e[0]=a*s,e[1]=-i*s,e[2]=-n*s,e[3]=r*s,e):null},adjoint:function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},determinant:function(e){return e[0]*e[3]-e[2]*e[1]},multiply:function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=r[0],l=r[1],d=r[2],u=r[3];return e[0]=i*o+a*l,e[1]=n*o+s*l,e[2]=i*d+a*u,e[3]=n*d+s*u,e}};n.mul=n.multiply,n.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+a*o,e[1]=n*l+s*o,e[2]=i*-o+a*l,e[3]=n*-o+s*l,e},n.scale=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=r[0],l=r[1];return e[0]=i*o,e[1]=n*o,e[2]=a*l,e[3]=s*l,e},n.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e},n.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},n.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},n.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},n.LDU=function(e,t,r,i){return e[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-e[2]*r[1],[e,t,r]},e.exports=n},function(e,t,r){var i=r(1),n={create:function(){var e=new i.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},clone:function(e){var t=new i.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},invert:function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=r*a-i*n;return l?(l=1/l,e[0]=a*l,e[1]=-i*l,e[2]=-n*l,e[3]=r*l,e[4]=(n*o-a*s)*l,e[5]=(i*s-r*o)*l,e):null},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],d=r[0],u=r[1],c=r[2],h=r[3],m=r[4],f=r[5];return e[0]=i*d+a*u,e[1]=n*d+s*u,e[2]=i*c+a*h,e[3]=n*c+s*h,e[4]=i*m+a*f+o,e[5]=n*m+s*f+l,e}};n.mul=n.multiply,n.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],d=Math.sin(r),u=Math.cos(r);return e[0]=i*u+a*d,e[1]=n*u+s*d,e[2]=i*-d+a*u,e[3]=n*-d+s*u,e[4]=o,e[5]=l,e},n.scale=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],d=r[0],u=r[1];return e[0]=i*d,e[1]=n*d,e[2]=a*u,e[3]=s*u,e[4]=o,e[5]=l,e},n.translate=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],d=r[0],u=r[1];return e[0]=i,e[1]=n,e[2]=a,e[3]=s,e[4]=i*d+a*u+o,e[5]=n*d+s*u+l,e},n.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=0,e[5]=0,e},n.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},n.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},n.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},n.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},e.exports=n},function(e,t,r){var i=r(1),n={create:function(){var e=new i.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromMat4:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},clone:function(e){var t=new i.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},invert:function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=t[6],d=t[7],u=t[8],c=u*s-o*d,h=-u*a+o*l,m=d*a-s*l,f=r*c+i*h+n*m;return f?(f=1/f,e[0]=c*f,e[1]=(-u*i+n*d)*f,e[2]=(o*i-n*s)*f,e[3]=h*f,e[4]=(u*r-n*l)*f,e[5]=(-o*r+n*a)*f,e[6]=m*f,e[7]=(-d*r+i*l)*f,e[8]=(s*r-i*a)*f,e):null},adjoint:function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=t[6],d=t[7],u=t[8];return e[0]=s*u-o*d,e[1]=n*d-i*u,e[2]=i*o-n*s,e[3]=o*l-a*u,e[4]=r*u-n*l,e[5]=n*a-r*o,e[6]=a*d-s*l,e[7]=i*l-r*d,e[8]=r*s-i*a,e},determinant:function(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],s=e[5],o=e[6],l=e[7],d=e[8];return t*(d*a-s*l)+r*(-d*n+s*o)+i*(l*n-a*o)},multiply:function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],d=t[6],u=t[7],c=t[8],h=r[0],m=r[1],f=r[2],p=r[3],v=r[4],_=r[5],g=r[6],b=r[7],y=r[8];return e[0]=h*i+m*s+f*d,e[1]=h*n+m*o+f*u,e[2]=h*a+m*l+f*c,e[3]=p*i+v*s+_*d,e[4]=p*n+v*o+_*u,e[5]=p*a+v*l+_*c,e[6]=g*i+b*s+y*d,e[7]=g*n+b*o+y*u,e[8]=g*a+b*l+y*c,e}};n.mul=n.multiply,n.translate=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],d=t[6],u=t[7],c=t[8],h=r[0],m=r[1];return e[0]=i,e[1]=n,e[2]=a,e[3]=s,e[4]=o,e[5]=l,e[6]=h*i+m*s+d,e[7]=h*n+m*o+u,e[8]=h*a+m*l+c,e},n.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],d=t[6],u=t[7],c=t[8],h=Math.sin(r),m=Math.cos(r);return e[0]=m*i+h*s,e[1]=m*n+h*o,e[2]=m*a+h*l,e[3]=m*s-h*i,e[4]=m*o-h*n,e[5]=m*l-h*a,e[6]=d,e[7]=u,e[8]=c,e},n.scale=function(e,t,r){var i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},n.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},n.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},n.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},n.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},n.fromQuat=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r+r,o=i+i,l=n+n,d=r*s,u=i*s,c=i*o,h=n*s,m=n*o,f=n*l,p=a*s,v=a*o,_=a*l;return e[0]=1-c-f,e[3]=u-_,e[6]=h+v,e[1]=u+_,e[4]=1-d-f,e[7]=m-p,e[2]=h-v,e[5]=m+p,e[8]=1-d-c,e},n.normalFromMat4=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=t[6],d=t[7],u=t[8],c=t[9],h=t[10],m=t[11],f=t[12],p=t[13],v=t[14],_=t[15],g=r*o-i*s,b=r*l-n*s,y=r*d-a*s,x=i*l-n*o,w=i*d-a*o,E=n*d-a*l,M=u*p-c*f,A=u*v-h*f,T=u*_-m*f,S=c*v-h*p,k=c*_-m*p,D=h*_-m*v,I=g*D-b*k+y*S+x*T-w*A+E*M;return I?(I=1/I,e[0]=(o*D-l*k+d*S)*I,e[1]=(l*T-s*D-d*A)*I,e[2]=(s*k-o*T+d*M)*I,e[3]=(n*k-i*D-a*S)*I,e[4]=(r*D-n*T+a*A)*I,e[5]=(i*T-r*k-a*M)*I,e[6]=(p*E-v*w+_*x)*I,e[7]=(v*y-f*E-_*b)*I,e[8]=(f*w-p*y+_*g)*I,e):null},n.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},n.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},e.exports=n},function(e,t,r){var i=r(1),n={scalar:{},SIMD:{},fromValues:function(e,t,r,i,n,a,s,o,l,d,u,c,h,m,f,p){var v=new Float32Array(16);return v[0]=e,v[1]=t,v[2]=r,v[3]=i,v[4]=n,v[5]=a,v[6]=s,v[7]=o,v[8]=l,v[9]=d,v[10]=u,v[11]=c,v[12]=h,v[13]=m,v[14]=f,v[15]=p,v},create:function(){var e=new i.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},clone:function(e){var t=new i.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}};n.scalar.transpose=function(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],a=t[6],s=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=a,e[11]=t[14],e[12]=n,e[13]=s,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},n.SIMD.transpose=function(e,t){var r,i,n,a,s,o,l,d,u,c;return r=SIMD.Float32x4.load(t,0),i=SIMD.Float32x4.load(t,4),n=SIMD.Float32x4.load(t,8),a=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4.shuffle(r,i,0,1,4,5),o=SIMD.Float32x4.shuffle(n,a,0,1,4,5),l=SIMD.Float32x4.shuffle(s,o,0,2,4,6),d=SIMD.Float32x4.shuffle(s,o,1,3,5,7),SIMD.Float32x4.store(e,0,l),SIMD.Float32x4.store(e,4,d),s=SIMD.Float32x4.shuffle(r,i,2,3,6,7),o=SIMD.Float32x4.shuffle(n,a,2,3,6,7),u=SIMD.Float32x4.shuffle(s,o,0,2,4,6),c=SIMD.Float32x4.shuffle(s,o,1,3,5,7),SIMD.Float32x4.store(e,8,u),SIMD.Float32x4.store(e,12,c),e},n.transpose=i.USE_SIMD?n.SIMD.transpose:n.scalar.transpose,n.scalar.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=t[6],d=t[7],u=t[8],c=t[9],h=t[10],m=t[11],f=t[12],p=t[13],v=t[14],_=t[15],g=r*o-i*s,b=r*l-n*s,y=r*d-a*s,x=i*l-n*o,w=i*d-a*o,E=n*d-a*l,M=u*p-c*f,A=u*v-h*f,T=u*_-m*f,S=c*v-h*p,k=c*_-m*p,D=h*_-m*v,I=g*D-b*k+y*S+x*T-w*A+E*M;return I?(I=1/I,e[0]=(o*D-l*k+d*S)*I,e[1]=(n*k-i*D-a*S)*I,e[2]=(p*E-v*w+_*x)*I,e[3]=(h*w-c*E-m*x)*I,e[4]=(l*T-s*D-d*A)*I,e[5]=(r*D-n*T+a*A)*I,e[6]=(v*y-f*E-_*b)*I,e[7]=(u*E-h*y+m*b)*I,e[8]=(s*k-o*T+d*M)*I,e[9]=(i*T-r*k-a*M)*I,e[10]=(f*w-p*y+_*g)*I,e[11]=(c*y-u*w-m*g)*I,e[12]=(o*A-s*S-l*M)*I,e[13]=(r*S-i*A+n*M)*I,e[14]=(p*b-f*x-v*g)*I,e[15]=(u*x-c*b+h*g)*I,e):null},n.SIMD.invert=function(e,t){var r,i,n,a,s,o,l,d,u,c,h=SIMD.Float32x4.load(t,0),m=SIMD.Float32x4.load(t,4),f=SIMD.Float32x4.load(t,8),p=SIMD.Float32x4.load(t,12);return s=SIMD.Float32x4.shuffle(h,m,0,1,4,5),i=SIMD.Float32x4.shuffle(f,p,0,1,4,5),r=SIMD.Float32x4.shuffle(s,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,s,1,3,5,7),s=SIMD.Float32x4.shuffle(h,m,2,3,6,7),a=SIMD.Float32x4.shuffle(f,p,2,3,6,7),n=SIMD.Float32x4.shuffle(s,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,s,1,3,5,7),s=SIMD.Float32x4.mul(n,a),s=SIMD.Float32x4.swizzle(s,1,0,3,2),o=SIMD.Float32x4.mul(i,s),l=SIMD.Float32x4.mul(r,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),o=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),o),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,s),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),s=SIMD.Float32x4.mul(i,n),s=SIMD.Float32x4.swizzle(s,1,0,3,2),o=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),o),u=SIMD.Float32x4.mul(r,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),o=SIMD.Float32x4.sub(o,SIMD.Float32x4.mul(a,s)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,s),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),s=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,2,3,0,1),a),s=SIMD.Float32x4.swizzle(s,1,0,3,2),n=SIMD.Float32x4.swizzle(n,2,3,0,1),o=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,s),o),d=SIMD.Float32x4.mul(r,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),o=SIMD.Float32x4.sub(o,SIMD.Float32x4.mul(n,s)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,s),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),s=SIMD.Float32x4.mul(r,i),s=SIMD.Float32x4.swizzle(s,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),d),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,s),u),s=SIMD.Float32x4.swizzle(s,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),d),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,s)),s=SIMD.Float32x4.mul(r,a),s=SIMD.Float32x4.swizzle(s,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,s)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,s),d),s=SIMD.Float32x4.swizzle(s,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,s),l),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(i,s)),s=SIMD.Float32x4.mul(r,n),s=SIMD.Float32x4.swizzle(s,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,s)),s=SIMD.Float32x4.swizzle(s,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,s)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,s),u),c=SIMD.Float32x4.mul(r,o),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c),s=SIMD.Float32x4.reciprocalApproximation(c),c=SIMD.Float32x4.sub(SIMD.Float32x4.add(s,s),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(s,s))),(c=SIMD.Float32x4.swizzle(c,0,0,0,0))?(SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(c,o)),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(c,l)),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(c,d)),SIMD.Float32x4.store(e,12,SIMD.Float32x4.mul(c,u)),e):null},n.invert=i.USE_SIMD?n.SIMD.invert:n.scalar.invert,n.scalar.adjoint=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=t[6],d=t[7],u=t[8],c=t[9],h=t[10],m=t[11],f=t[12],p=t[13],v=t[14],_=t[15];return e[0]=o*(h*_-m*v)-c*(l*_-d*v)+p*(l*m-d*h),e[1]=-(i*(h*_-m*v)-c*(n*_-a*v)+p*(n*m-a*h)),e[2]=i*(l*_-d*v)-o*(n*_-a*v)+p*(n*d-a*l),e[3]=-(i*(l*m-d*h)-o*(n*m-a*h)+c*(n*d-a*l)),e[4]=-(s*(h*_-m*v)-u*(l*_-d*v)+f*(l*m-d*h)),e[5]=r*(h*_-m*v)-u*(n*_-a*v)+f*(n*m-a*h),e[6]=-(r*(l*_-d*v)-s*(n*_-a*v)+f*(n*d-a*l)),e[7]=r*(l*m-d*h)-s*(n*m-a*h)+u*(n*d-a*l),e[8]=s*(c*_-m*p)-u*(o*_-d*p)+f*(o*m-d*c),e[9]=-(r*(c*_-m*p)-u*(i*_-a*p)+f*(i*m-a*c)),e[10]=r*(o*_-d*p)-s*(i*_-a*p)+f*(i*d-a*o),e[11]=-(r*(o*m-d*c)-s*(i*m-a*c)+u*(i*d-a*o)),e[12]=-(s*(c*v-h*p)-u*(o*v-l*p)+f*(o*h-l*c)),e[13]=r*(c*v-h*p)-u*(i*v-n*p)+f*(i*h-n*c),e[14]=-(r*(o*v-l*p)-s*(i*v-n*p)+f*(i*l-n*o)),e[15]=r*(o*h-l*c)-s*(i*h-n*c)+u*(i*l-n*o),e},n.SIMD.adjoint=function(e,t){var r,i,n,a,s,o,l,d,u,c=SIMD.Float32x4.load(t,0),h=SIMD.Float32x4.load(t,4),m=SIMD.Float32x4.load(t,8),f=SIMD.Float32x4.load(t,12);return s=SIMD.Float32x4.shuffle(c,h,0,1,4,5),i=SIMD.Float32x4.shuffle(m,f,0,1,4,5),r=SIMD.Float32x4.shuffle(s,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,s,1,3,5,7),s=SIMD.Float32x4.shuffle(c,h,2,3,6,7),a=SIMD.Float32x4.shuffle(m,f,2,3,6,7),n=SIMD.Float32x4.shuffle(s,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,s,1,3,5,7),s=SIMD.Float32x4.mul(n,a),s=SIMD.Float32x4.swizzle(s,1,0,3,2),o=SIMD.Float32x4.mul(i,s),l=SIMD.Float32x4.mul(r,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),o=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),o),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,s),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),s=SIMD.Float32x4.mul(i,n),s=SIMD.Float32x4.swizzle(s,1,0,3,2),o=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),o),u=SIMD.Float32x4.mul(r,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),o=SIMD.Float32x4.sub(o,SIMD.Float32x4.mul(a,s)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,s),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),s=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,2,3,0,1),a),s=SIMD.Float32x4.swizzle(s,1,0,3,2),n=SIMD.Float32x4.swizzle(n,2,3,0,1),o=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,s),o),d=SIMD.Float32x4.mul(r,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),o=SIMD.Float32x4.sub(o,SIMD.Float32x4.mul(n,s)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,s),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),s=SIMD.Float32x4.mul(r,i),s=SIMD.Float32x4.swizzle(s,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),d),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,s),u),s=SIMD.Float32x4.swizzle(s,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),d),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,s)),s=SIMD.Float32x4.mul(r,a),s=SIMD.Float32x4.swizzle(s,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,s)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,s),d),s=SIMD.Float32x4.swizzle(s,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,s),l),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(i,s)),s=SIMD.Float32x4.mul(r,n),s=SIMD.Float32x4.swizzle(s,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,s)),s=SIMD.Float32x4.swizzle(s,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,s)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,s),u),SIMD.Float32x4.store(e,0,o),SIMD.Float32x4.store(e,4,l),SIMD.Float32x4.store(e,8,d),SIMD.Float32x4.store(e,12,u),e},n.adjoint=i.USE_SIMD?n.SIMD.adjoint:n.scalar.adjoint,n.determinant=function(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],s=e[5],o=e[6],l=e[7],d=e[8],u=e[9],c=e[10],h=e[11],m=e[12],f=e[13],p=e[14],v=e[15];return(t*s-r*a)*(c*v-h*p)-(t*o-i*a)*(u*v-h*f)+(t*l-n*a)*(u*p-c*f)+(r*o-i*s)*(d*v-h*m)-(r*l-n*s)*(d*p-c*m)+(i*l-n*o)*(d*f-u*m)},n.SIMD.multiply=function(e,t,r){var i=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),s=SIMD.Float32x4.load(t,12),o=SIMD.Float32x4.load(r,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(o,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(o,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(o,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(o,3,3,3,3),s))));SIMD.Float32x4.store(e,0,l);var d=SIMD.Float32x4.load(r,4),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),s))));SIMD.Float32x4.store(e,4,u);var c=SIMD.Float32x4.load(r,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),s))));SIMD.Float32x4.store(e,8,h);var m=SIMD.Float32x4.load(r,12),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,3,3,3,3),s))));return SIMD.Float32x4.store(e,12,f),e},n.scalar.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],d=t[6],u=t[7],c=t[8],h=t[9],m=t[10],f=t[11],p=t[12],v=t[13],_=t[14],g=t[15],b=r[0],y=r[1],x=r[2],w=r[3];return e[0]=b*i+y*o+x*c+w*p,e[1]=b*n+y*l+x*h+w*v,e[2]=b*a+y*d+x*m+w*_,e[3]=b*s+y*u+x*f+w*g,b=r[4],y=r[5],x=r[6],w=r[7],e[4]=b*i+y*o+x*c+w*p,e[5]=b*n+y*l+x*h+w*v,e[6]=b*a+y*d+x*m+w*_,e[7]=b*s+y*u+x*f+w*g,b=r[8],y=r[9],x=r[10],w=r[11],e[8]=b*i+y*o+x*c+w*p,e[9]=b*n+y*l+x*h+w*v,e[10]=b*a+y*d+x*m+w*_,e[11]=b*s+y*u+x*f+w*g,b=r[12],y=r[13],x=r[14],w=r[15],e[12]=b*i+y*o+x*c+w*p,e[13]=b*n+y*l+x*h+w*v,e[14]=b*a+y*d+x*m+w*_,e[15]=b*s+y*u+x*f+w*g,e},n.multiply=i.USE_SIMD?n.SIMD.multiply:n.scalar.multiply,n.mul=n.multiply,n.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},n.getScaling=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[4],s=t[5],o=t[6],l=t[8],d=t[9],u=t[10];return e[0]=Math.sqrt(r*r+i*i+n*n),e[1]=Math.sqrt(a*a+s*s+o*o),e[2]=Math.sqrt(l*l+d*d+u*u),e},n.getRotation=function(e,t){var r=t[0]+t[5]+t[10],i=0;return r>0?(i=2*Math.sqrt(r+1),e[3]=.25*i,e[0]=(t[6]-t[9])/i,e[1]=(t[8]-t[2])/i,e[2]=(t[1]-t[4])/i):t[0]>t[5]&&t[0]>t[10]?(i=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/i,e[0]=.25*i,e[1]=(t[1]+t[4])/i,e[2]=(t[8]+t[2])/i):t[5]>t[10]?(i=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/i,e[0]=(t[1]+t[4])/i,e[1]=.25*i,e[2]=(t[6]+t[9])/i):(i=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/i,e[0]=(t[8]+t[2])/i,e[1]=(t[6]+t[9])/i,e[2]=.25*i),e},n.scalar.translate=function(e,t,r){var i,n,a,s,o,l,d,u,c,h,m,f,p=r[0],v=r[1],_=r[2];return t===e?(e[12]=t[0]*p+t[4]*v+t[8]*_+t[12],e[13]=t[1]*p+t[5]*v+t[9]*_+t[13],e[14]=t[2]*p+t[6]*v+t[10]*_+t[14],e[15]=t[3]*p+t[7]*v+t[11]*_+t[15]):(i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],d=t[6],u=t[7],c=t[8],h=t[9],m=t[10],f=t[11],e[0]=i,e[1]=n,e[2]=a,e[3]=s,e[4]=o,e[5]=l,e[6]=d,e[7]=u,e[8]=c,e[9]=h,e[10]=m,e[11]=f,e[12]=i*p+o*v+c*_+t[12],e[13]=n*p+l*v+h*_+t[13],e[14]=a*p+d*v+m*_+t[14],e[15]=s*p+u*v+f*_+t[15]),e},n.SIMD.translate=function(e,t,r){var i=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),s=SIMD.Float32x4.load(t,12),o=SIMD.Float32x4(r[0],r[1],r[2],0);t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(o,0,0,0,0)),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(o,1,1,1,1)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(o,2,2,2,2));var l=SIMD.Float32x4.add(i,SIMD.Float32x4.add(n,SIMD.Float32x4.add(a,s)));return SIMD.Float32x4.store(e,12,l),e},n.translate=i.USE_SIMD?n.SIMD.translate:n.scalar.translate,n.scalar.scale=function(e,t,r){var i=r[0],n=r[1],a=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},n.SIMD.scale=function(e,t,r){var i,n,a,s=SIMD.Float32x4(r[0],r[1],r[2],0);return i=SIMD.Float32x4.load(t,0),SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,0,0,0,0))),n=SIMD.Float32x4.load(t,4),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,1,1,1,1))),a=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,2,2,2,2))),e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},n.scale=i.USE_SIMD?n.SIMD.scale:n.scalar.scale,n.rotate=function(e,t,r,n){var a,s,o,l,d,u,c,h,m,f,p,v,_,g,b,y,x,w,E,M,A,T,S,k,D=n[0],I=n[1],N=n[2],P=Math.sqrt(D*D+I*I+N*N);return Math.abs(P)<i.EPSILON?null:(D*=P=1/P,I*=P,N*=P,a=Math.sin(r),o=1-(s=Math.cos(r)),l=t[0],d=t[1],u=t[2],c=t[3],h=t[4],m=t[5],f=t[6],p=t[7],v=t[8],_=t[9],g=t[10],b=t[11],y=D*D*o+s,x=I*D*o+N*a,w=N*D*o-I*a,E=D*I*o-N*a,M=I*I*o+s,A=N*I*o+D*a,T=D*N*o+I*a,S=I*N*o-D*a,k=N*N*o+s,e[0]=l*y+h*x+v*w,e[1]=d*y+m*x+_*w,e[2]=u*y+f*x+g*w,e[3]=c*y+p*x+b*w,e[4]=l*E+h*M+v*A,e[5]=d*E+m*M+_*A,e[6]=u*E+f*M+g*A,e[7]=c*E+p*M+b*A,e[8]=l*T+h*S+v*k,e[9]=d*T+m*S+_*k,e[10]=u*T+f*S+g*k,e[11]=c*T+p*S+b*k,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},n.scalar.rotateX=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[4],s=t[5],o=t[6],l=t[7],d=t[8],u=t[9],c=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*n+d*i,e[5]=s*n+u*i,e[6]=o*n+c*i,e[7]=l*n+h*i,e[8]=d*n-a*i,e[9]=u*n-s*i,e[10]=c*n-o*i,e[11]=h*n-l*i,e},n.SIMD.rotateX=function(e,t,r){var i=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var a=SIMD.Float32x4.load(t,4),s=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,n),SIMD.Float32x4.mul(s,i))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,n),SIMD.Float32x4.mul(a,i))),e},n.rotateX=i.USE_SIMD?n.SIMD.rotateX:n.scalar.rotateX,n.scalar.rotateY=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],s=t[1],o=t[2],l=t[3],d=t[8],u=t[9],c=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n-d*i,e[1]=s*n-u*i,e[2]=o*n-c*i,e[3]=l*n-h*i,e[8]=a*i+d*n,e[9]=s*i+u*n,e[10]=o*i+c*n,e[11]=l*i+h*n,e},n.SIMD.rotateY=function(e,t,r){var i=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var a=SIMD.Float32x4.load(t,0),s=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,n),SIMD.Float32x4.mul(s,i))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(s,n))),e},n.rotateY=i.USE_SIMD?n.SIMD.rotateY:n.scalar.rotateY,n.scalar.rotateZ=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],s=t[1],o=t[2],l=t[3],d=t[4],u=t[5],c=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n+d*i,e[1]=s*n+u*i,e[2]=o*n+c*i,e[3]=l*n+h*i,e[4]=d*n-a*i,e[5]=u*n-s*i,e[6]=c*n-o*i,e[7]=h*n-l*i,e},n.SIMD.rotateZ=function(e,t,r){var i=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var a=SIMD.Float32x4.load(t,0),s=SIMD.Float32x4.load(t,4);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,n),SIMD.Float32x4.mul(s,i))),SIMD.Float32x4.store(e,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,n),SIMD.Float32x4.mul(a,i))),e},n.rotateZ=i.USE_SIMD?n.SIMD.rotateZ:n.scalar.rotateZ,n.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},n.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.fromRotation=function(e,t,r){var n,a,s,o=r[0],l=r[1],d=r[2],u=Math.sqrt(o*o+l*l+d*d);return Math.abs(u)<i.EPSILON?null:(o*=u=1/u,l*=u,d*=u,n=Math.sin(t),s=1-(a=Math.cos(t)),e[0]=o*o*s+a,e[1]=l*o*s+d*n,e[2]=d*o*s-l*n,e[3]=0,e[4]=o*l*s-d*n,e[5]=l*l*s+a,e[6]=d*l*s+o*n,e[7]=0,e[8]=o*d*s+l*n,e[9]=l*d*s-o*n,e[10]=d*d*s+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},n.fromXRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.fromYRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.fromZRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.fromRotationTranslation=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=i+i,l=n+n,d=a+a,u=i*o,c=i*l,h=i*d,m=n*l,f=n*d,p=a*d,v=s*o,_=s*l,g=s*d;return e[0]=1-(m+p),e[1]=c+g,e[2]=h-_,e[3]=0,e[4]=c-g,e[5]=1-(u+p),e[6]=f+v,e[7]=0,e[8]=h+_,e[9]=f-v,e[10]=1-(u+m),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},n.fromRotationTranslationScale=function(e,t,r,i){var n=t[0],a=t[1],s=t[2],o=t[3],l=n+n,d=a+a,u=s+s,c=n*l,h=n*d,m=n*u,f=a*d,p=a*u,v=s*u,_=o*l,g=o*d,b=o*u,y=i[0],x=i[1],w=i[2];return e[0]=(1-(f+v))*y,e[1]=(h+b)*y,e[2]=(m-g)*y,e[3]=0,e[4]=(h-b)*x,e[5]=(1-(c+v))*x,e[6]=(p+_)*x,e[7]=0,e[8]=(m+g)*w,e[9]=(p-_)*w,e[10]=(1-(c+f))*w,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},n.fromRotationTranslationScaleOrigin=function(e,t,r,i,n){var a=t[0],s=t[1],o=t[2],l=t[3],d=a+a,u=s+s,c=o+o,h=a*d,m=a*u,f=a*c,p=s*u,v=s*c,_=o*c,g=l*d,b=l*u,y=l*c,x=i[0],w=i[1],E=i[2],M=n[0],A=n[1],T=n[2];return e[0]=(1-(p+_))*x,e[1]=(m+y)*x,e[2]=(f-b)*x,e[3]=0,e[4]=(m-y)*w,e[5]=(1-(h+_))*w,e[6]=(v+g)*w,e[7]=0,e[8]=(f+b)*E,e[9]=(v-g)*E,e[10]=(1-(h+p))*E,e[11]=0,e[12]=r[0]+M-(e[0]*M+e[4]*A+e[8]*T),e[13]=r[1]+A-(e[1]*M+e[5]*A+e[9]*T),e[14]=r[2]+T-(e[2]*M+e[6]*A+e[10]*T),e[15]=1,e},n.fromQuat=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r+r,o=i+i,l=n+n,d=r*s,u=i*s,c=i*o,h=n*s,m=n*o,f=n*l,p=a*s,v=a*o,_=a*l;return e[0]=1-c-f,e[1]=u+_,e[2]=h-v,e[3]=0,e[4]=u-_,e[5]=1-d-f,e[6]=m+p,e[7]=0,e[8]=h+v,e[9]=m-p,e[10]=1-d-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.frustum=function(e,t,r,i,n,a,s){var o=1/(r-t),l=1/(n-i),d=1/(a-s);return e[0]=2*a*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*l,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(n+i)*l,e[10]=(s+a)*d,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*a*2*d,e[15]=0,e},n.perspective=function(e,t,r,i,n){var a=1/Math.tan(t/2),s=1/(i-n);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+i)*s,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*n*i*s,e[15]=0,e},n.perspectiveFromFieldOfView=function(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(s+o),d=2/(n+a);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=d,e[6]=0,e[7]=0,e[8]=-(s-o)*l*.5,e[9]=(n-a)*d*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e},n.ortho=function(e,t,r,i,n,a,s){var o=1/(t-r),l=1/(i-n),d=1/(a-s);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(t+r)*o,e[13]=(n+i)*l,e[14]=(s+a)*d,e[15]=1,e},n.lookAt=function(e,t,r,a){var s,o,l,d,u,c,h,m,f,p,v=t[0],_=t[1],g=t[2],b=a[0],y=a[1],x=a[2],w=r[0],E=r[1],M=r[2];return Math.abs(v-w)<i.EPSILON&&Math.abs(_-E)<i.EPSILON&&Math.abs(g-M)<i.EPSILON?n.identity(e):(h=v-w,m=_-E,f=g-M,s=y*(f*=p=1/Math.sqrt(h*h+m*m+f*f))-x*(m*=p),o=x*(h*=p)-b*f,l=b*m-y*h,(p=Math.sqrt(s*s+o*o+l*l))?(s*=p=1/p,o*=p,l*=p):(s=0,o=0,l=0),d=m*l-f*o,u=f*s-h*l,c=h*o-m*s,(p=Math.sqrt(d*d+u*u+c*c))?(d*=p=1/p,u*=p,c*=p):(d=0,u=0,c=0),e[0]=s,e[1]=d,e[2]=h,e[3]=0,e[4]=o,e[5]=u,e[6]=m,e[7]=0,e[8]=l,e[9]=c,e[10]=f,e[11]=0,e[12]=-(s*v+o*_+l*g),e[13]=-(d*v+u*_+c*g),e[14]=-(h*v+m*_+f*g),e[15]=1,e)},n.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},n.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},n.setFromEuler=function(e,t,r,i){var n=Math.cos(t),a=Math.sin(t),s=Math.cos(r),o=Math.sin(r),l=Math.cos(i),d=Math.sin(i),u=n*l,c=n*d,h=a*l,m=a*d;return e[0]=s*l,e[4]=-s*d,e[8]=o,e[1]=c+h*o,e[5]=u-m*o,e[9]=-a*s,e[2]=m-u*o,e[6]=h+c*o,e[10]=n*s,e},n.getEuler=function(e){var t=e[0],r=e[4],i=e[8],n=(e[1],e[5]),a=e[9],s=(e[2],e[6]),o=e[10],l=[];return Math.max(-1,Math.min(1,i)),l[1]=Math.asin(Math.max(-1,Math.min(1,i))),Math.abs(i)<.9999999?(l[0]=Math.atan2(-a,o),l[2]=Math.atan2(-r,t)):(l[0]=Math.atan2(s,n),l[2]=0),l},e.exports=n},function(e,t,r){var i,n,a,s,o,l,d=r(1),u=r(4),c=r(7),h=r(8),m={};m.create=function(){var e=new d.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},m.rotationTo=(i=c.create(),n=c.fromValues(1,0,0),a=c.fromValues(0,1,0),function(e,t,r){var s=c.dot(t,r);return s<-.999999?(c.cross(i,n,t),c.length(i)<1e-6&&c.cross(i,a,t),c.normalize(i,i),m.setAxisAngle(e,i,Math.PI),e):s>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(c.cross(i,t,r),e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=1+s,m.normalize(e,e))}),m.setAxes=(s=u.create(),function(e,t,r,i){return s[0]=r[0],s[3]=r[1],s[6]=r[2],s[1]=i[0],s[4]=i[1],s[7]=i[2],s[2]=-t[0],s[5]=-t[1],s[8]=-t[2],m.normalize(e,m.fromMat3(e,s))}),m.clone=h.clone,m.fromValues=h.fromValues,m.copy=h.copy,m.set=h.set,m.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},m.setAxisAngle=function(e,t,r){r*=.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e},m.add=h.add,m.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=r[0],l=r[1],d=r[2],u=r[3];return e[0]=i*u+s*o+n*d-a*l,e[1]=n*u+s*l+a*o-i*d,e[2]=a*u+s*d+i*l-n*o,e[3]=s*u-i*o-n*l-a*d,e},m.mul=m.multiply,m.scale=h.scale,m.rotateX=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],s=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+s*o,e[1]=n*l+a*o,e[2]=a*l-n*o,e[3]=s*l-i*o,e},m.rotateY=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],s=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l-a*o,e[1]=n*l+s*o,e[2]=a*l+i*o,e[3]=s*l-n*o,e},m.rotateZ=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],s=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+n*o,e[1]=n*l-i*o,e[2]=a*l+s*o,e[3]=s*l-a*o,e},m.fromYXZ=function(e,t,r,i){var n=Math.cos(r/2),a=Math.cos(t/2),s=Math.cos(i/2),o=Math.sin(r/2),l=Math.sin(t/2),d=Math.sin(i/2);return e[0]=o*a*s+n*l*d,e[1]=n*l*s-o*a*d,e[2]=n*a*d-o*l*s,e[3]=n*a*s+o*l*d,e},m.calculateW=function(e,t){var r=t[0],i=t[1],n=t[2];return e[0]=r,e[1]=i,e[2]=n,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),e},m.dot=h.dot,m.lerp=h.lerp,m.slerp=function(e,t,r,i){var n,a,s,o,l,d=t[0],u=t[1],c=t[2],h=t[3],m=r[0],f=r[1],p=r[2],v=r[3];return(a=d*m+u*f+c*p+h*v)<0&&(a=-a,m=-m,f=-f,p=-p,v=-v),1-a>1e-6?(n=Math.acos(a),s=Math.sin(n),o=Math.sin((1-i)*n)/s,l=Math.sin(i*n)/s):(o=1-i,l=i),e[0]=o*d+l*m,e[1]=o*u+l*f,e[2]=o*c+l*p,e[3]=o*h+l*v,e},m.sqlerp=(o=m.create(),l=m.create(),function(e,t,r,i,n,a){return m.slerp(o,t,n,a),m.slerp(l,r,i,a),m.slerp(e,o,l,2*a*(1-a)),e}),m.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r*r+i*i+n*n+a*a,o=s?1/s:0;return e[0]=-r*o,e[1]=-i*o,e[2]=-n*o,e[3]=a*o,e},m.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},m.length=h.length,m.len=m.length,m.squaredLength=h.squaredLength,m.sqrLen=m.squaredLength,m.normalize=h.normalize,m.fromMat3=function(e,t){var r,i=t[0]+t[4]+t[8];if(i>0)r=Math.sqrt(i+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var a=(n+1)%3,s=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*a+a]-t[3*s+s]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*a+s]-t[3*s+a])*r,e[a]=(t[3*a+n]+t[3*n+a])*r,e[s]=(t[3*s+n]+t[3*n+s])*r}return e},m.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},e.exports=m},function(e,t,r){var i,n=r(1),a={};a.create=function(){var e=new n.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e},a.clone=function(e){var t=new n.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.fromValues=function(e,t,r){var i=new n.ARRAY_TYPE(3);return i[0]=e,i[1]=t,i[2]=r,i},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.set=function(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},a.sub=a.subtract,a.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e},a.mul=a.multiply,a.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e},a.div=a.divide,a.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},a.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},a.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},a.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e},a.distance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(r*r+i*i+n*n)},a.dist=a.distance,a.squaredDistance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],r=e[1],i=e[2];return Math.sqrt(t*t+r*r+i*i)},a.len=a.length,a.squaredLength=function(e){var t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},a.normalize=function(e,t){var r=t[0],i=t[1],n=t[2],a=r*r+i*i+n*n;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.cross=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=r[0],o=r[1],l=r[2];return e[0]=n*l-a*o,e[1]=a*s-i*l,e[2]=i*o-n*s,e},a.lerp=function(e,t,r,i){var n=t[0],a=t[1],s=t[2];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=s+i*(r[2]-s),e},a.hermite=function(e,t,r,i,n,a){var s=a*a,o=s*(2*a-3)+1,l=s*(a-2)+a,d=s*(a-1),u=s*(3-2*a);return e[0]=t[0]*o+r[0]*l+i[0]*d+n[0]*u,e[1]=t[1]*o+r[1]*l+i[1]*d+n[1]*u,e[2]=t[2]*o+r[2]*l+i[2]*d+n[2]*u,e},a.bezier=function(e,t,r,i,n,a){var s=1-a,o=s*s,l=a*a,d=o*s,u=3*a*o,c=3*l*s,h=l*a;return e[0]=t[0]*d+r[0]*u+i[0]*c+n[0]*h,e[1]=t[1]*d+r[1]*u+i[1]*c+n[1]*h,e[2]=t[2]*d+r[2]*u+i[2]*c+n[2]*h,e},a.random=function(e,t){t=t||1;var r=2*n.RANDOM()*Math.PI,i=2*n.RANDOM()-1,a=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*a,e[1]=Math.sin(r)*a,e[2]=i*t,e},a.transformMat4=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=r[3]*i+r[7]*n+r[11]*a+r[15];return s=s||1,e[0]=(r[0]*i+r[4]*n+r[8]*a+r[12])/s,e[1]=(r[1]*i+r[5]*n+r[9]*a+r[13])/s,e[2]=(r[2]*i+r[6]*n+r[10]*a+r[14])/s,e},a.transformMat3=function(e,t,r){var i=t[0],n=t[1],a=t[2];return e[0]=i*r[0]+n*r[3]+a*r[6],e[1]=i*r[1]+n*r[4]+a*r[7],e[2]=i*r[2]+n*r[5]+a*r[8],e},a.transformQuat=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=r[0],o=r[1],l=r[2],d=r[3],u=d*i+o*a-l*n,c=d*n+l*i-s*a,h=d*a+s*n-o*i,m=-s*i-o*n-l*a;return e[0]=u*d+m*-s+c*-l-h*-o,e[1]=c*d+m*-o+h*-s-u*-l,e[2]=h*d+m*-l+u*-o-c*-s,e},a.rotateX=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[0],a[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),a[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},a.rotateY=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),a[1]=n[1],a[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},a.rotateZ=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),a[2]=n[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},a.forEach=(i=a.create(),function(e,t,r,n,a,s){var o,l;for(t||(t=3),r||(r=0),l=n?Math.min(n*t+r,e.length):e.length,o=r;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],i[2]=e[o+2],a(i,i,s),e[o]=i[0],e[o+1]=i[1],e[o+2]=i[2];return e}),a.angle=function(e,t){var r=a.fromValues(e[0],e[1],e[2]),i=a.fromValues(t[0],t[1],t[2]);a.normalize(r,r),a.normalize(i,i);var n=a.dot(r,i);return n>1?0:Math.acos(n)},a.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},e.exports=a},function(e,t,r){var i,n=r(1),a={};a.create=function(){var e=new n.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},a.clone=function(e){var t=new n.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.fromValues=function(e,t,r,i){var a=new n.ARRAY_TYPE(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=i,a},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.set=function(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e},a.sub=a.subtract,a.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},a.mul=a.multiply,a.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e},a.div=a.divide,a.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},a.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},a.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},a.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e},a.distance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+i*i+n*n+a*a)},a.dist=a.distance,a.squaredDistance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return r*r+i*i+n*n+a*a},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.sqrt(t*t+r*r+i*i+n*n)},a.len=a.length,a.squaredLength=function(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},a.normalize=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r*r+i*i+n*n+a*a;return s>0&&(s=1/Math.sqrt(s),e[0]=r*s,e[1]=i*s,e[2]=n*s,e[3]=a*s),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.lerp=function(e,t,r,i){var n=t[0],a=t[1],s=t[2],o=t[3];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=s+i*(r[2]-s),e[3]=o+i*(r[3]-o),e},a.random=function(e,t){return t=t||1,e[0]=n.RANDOM(),e[1]=n.RANDOM(),e[2]=n.RANDOM(),e[3]=n.RANDOM(),a.normalize(e,e),a.scale(e,e,t),e},a.transformMat4=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*s,e[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*s,e[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*s,e[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*s,e},a.transformQuat=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=r[0],o=r[1],l=r[2],d=r[3],u=d*i+o*a-l*n,c=d*n+l*i-s*a,h=d*a+s*n-o*i,m=-s*i-o*n-l*a;return e[0]=u*d+m*-s+c*-l-h*-o,e[1]=c*d+m*-o+h*-s-u*-l,e[2]=h*d+m*-l+u*-o-c*-s,e[3]=t[3],e},a.forEach=(i=a.create(),function(e,t,r,n,a,s){var o,l;for(t||(t=4),r||(r=0),l=n?Math.min(n*t+r,e.length):e.length,o=r;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],i[2]=e[o+2],i[3]=e[o+3],a(i,i,s),e[o]=i[0],e[o+1]=i[1],e[o+2]=i[2],e[o+3]=i[3];return e}),a.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},e.exports=a},function(e,t,r){var i,n=r(1),a={};a.create=function(){var e=new n.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},a.clone=function(e){var t=new n.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},a.fromValues=function(e,t){var r=new n.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},a.set=function(e,t,r){return e[0]=t,e[1]=r,e},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e},a.sub=a.subtract,a.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e},a.mul=a.multiply,a.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e},a.div=a.divide,a.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},a.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},a.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},a.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e},a.distance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)},a.dist=a.distance,a.squaredDistance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)},a.len=a.length,a.squaredLength=function(e){var t=e[0],r=e[1];return t*t+r*r},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},a.normalize=function(e,t){var r=t[0],i=t[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e},a.rotate=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},a.cross=function(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e},a.lerp=function(e,t,r,i){var n=t[0],a=t[1];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e},a.random=function(e,t){t=t||1;var r=2*n.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},a.transformMat2=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e},a.transformMat2d=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e},a.transformMat3=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e},a.transformMat4=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e},a.forEach=(i=a.create(),function(e,t,r,n,a,s){var o,l;for(t||(t=2),r||(r=0),l=n?Math.min(n*t+r,e.length):e.length,o=r;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],a(i,i,s),e[o]=i[0],e[o+1]=i[1];return e}),a.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},e.exports=a}])},e.exports=i()},"./node_modules/@wry/context/lib/context.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"Slot",function(){return o}),r.d(t,"asyncFromGen",function(){return c}),r.d(t,"bind",function(){return l}),r.d(t,"noContext",function(){return d}),r.d(t,"setTimeout",function(){return u}),r.d(t,"wrapYieldingFiberMethods",function(){return m});var i=null,n={},a=1,s=Array,o=s["@wry/context:Slot"]||function(){var e=function(){function e(){this.id=["slot",a++,Date.now(),Math.random().toString(36).slice(2)].join(":")}return e.prototype.hasValue=function(){for(var e=i;e;e=e.parent)if(this.id in e.slots){var t=e.slots[this.id];if(t===n)break;return e!==i&&(i.slots[this.id]=t),!0}return i&&(i.slots[this.id]=n),!1},e.prototype.getValue=function(){if(this.hasValue())return i.slots[this.id]},e.prototype.withValue=function(e,t,r,n){var a,s=((a={__proto__:null})[this.id]=e,a),o=i;i={parent:o,slots:s};try{return t.apply(n,r)}finally{i=o}},e.bind=function(e){var t=i;return function(){var r=i;try{return i=t,e.apply(this,arguments)}finally{i=r}}},e.noContext=function(e,t,r){if(!i)return e.apply(r,t);var n=i;try{return i=null,e.apply(r,t)}finally{i=n}},e}();try{Object.defineProperty(s,"@wry/context:Slot",{value:s["@wry/context:Slot"]=e,enumerable:!1,writable:!1,configurable:!1})}finally{return e}}(),l=o.bind,d=o.noContext;function u(e,t){return setTimeout(l(e),t)}function c(e){return function(){var t=e.apply(this,arguments),r=l(t.next),i=l(t.throw);return new Promise(function(e,n){function a(r,i){try{var a=r.call(t,i)}catch(e){return n(e)}var l,d=a.done?e:s;(l=a.value)&&"function"==typeof l.then?a.value.then(d,a.done?n:o):d(a.value)}var s=function(e){return a(r,e)},o=function(e){return a(i,e)};s()})}}var h=[];function m(e){if(h.indexOf(e)<0){var t=function(e,t){var r=e[t];e[t]=function(){return d(r,arguments,this)}};t(e,"yield"),t(e.prototype,"run"),t(e.prototype,"throwInto"),h.push(e)}return e}},"./node_modules/@wry/equality/lib/equality.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"equal",function(){return o});var i=Object.prototype,n=i.toString,a=i.hasOwnProperty,s=new Map;function o(e,t){try{return function e(t,r){if(t===r)return!0;var i=n.call(t);var s=n.call(r);if(i!==s)return!1;switch(i){case"[object Array]":if(t.length!==r.length)return!1;case"[object Object]":if(l(t,r))return!0;var o=Object.keys(t),d=Object.keys(r),u=o.length;if(u!==d.length)return!1;for(var c=0;c<u;++c)if(!a.call(r,o[c]))return!1;for(var c=0;c<u;++c){var h=o[c];if(!e(t[h],r[h]))return!1}return!0;case"[object Error]":return t.name===r.name&&t.message===r.message;case"[object Number]":if(t!=t)return r!=r;case"[object Boolean]":case"[object Date]":return+t==+r;case"[object RegExp]":case"[object String]":return t==""+r;case"[object Map]":case"[object Set]":if(t.size!==r.size)return!1;if(l(t,r))return!0;for(var m=t.entries(),f="[object Map]"===i;;){var p=m.next();if(p.done)break;var v=p.value,_=v[0],g=v[1];if(!r.has(_))return!1;if(f&&!e(g,r.get(_)))return!1}return!0}return!1}(e,t)}finally{s.clear()}}function l(e,t){var r=s.get(e);if(r){if(r.has(t))return!0}else s.set(e,r=new Set);return r.add(t),!1}t.default=o},"./node_modules/apollo-cache-inmemory/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"HeuristicFragmentMatcher",function(){return v}),r.d(t,"InMemoryCache",function(){return C}),r.d(t,"IntrospectionFragmentMatcher",function(){return _}),r.d(t,"ObjectCache",function(){return A}),r.d(t,"StoreReader",function(){return x}),r.d(t,"StoreWriter",function(){return D}),r.d(t,"WriteError",function(){return S}),r.d(t,"assertIdValue",function(){return M}),r.d(t,"defaultDataIdFromObject",function(){return O}),r.d(t,"defaultNormalizedCacheFactory",function(){return T}),r.d(t,"enhanceErrorWithDocument",function(){return k});var i=r("./node_modules/tslib/tslib.es6.js"),n=r("./node_modules/apollo-cache/lib/bundle.esm.js"),a=r("./node_modules/apollo-cache-inmemory/node_modules/apollo-utilities/lib/bundle.esm.js"),s=r("./node_modules/optimism/lib/bundle.esm.js"),o=r("./node_modules/ts-invariant/lib/invariant.esm.js"),l=new Map;if(l.set(1,2)!==l){var d=l.set;Map.prototype.set=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d.apply(this,e),this}}var u=new Set;if(u.add(3)!==u){var c=u.add;Set.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.apply(this,e),this}}var h={};"function"==typeof Object.freeze&&Object.freeze(h);try{l.set(h,h).delete(h)}catch(e){var m=function(e){return e&&function(t){try{l.set(t,t).delete(t)}finally{return e.call(Object,t)}}};Object.freeze=m(Object.freeze),Object.seal=m(Object.seal),Object.preventExtensions=m(Object.preventExtensions)}var f=!1;function p(){var e=!f;return Object(a.isTest)()||(f=!0),e}var v=function(){function e(){}return e.prototype.ensureReady=function(){return Promise.resolve()},e.prototype.canBypassInit=function(){return!0},e.prototype.match=function(e,t,r){var i=r.store.get(e.id),n="ROOT_QUERY"===e.id;if(!i)return n;var a=i.__typename,s=void 0===a?n&&"Query":a;return s?s===t||(p()&&o.invariant.error("You are using the simple (heuristic) fragment matcher, but your queries contain union or interface types. Apollo Client will not be able to accurately map fragments. To make this error go away, use the `IntrospectionFragmentMatcher` as described in the docs: https://www.apollographql.com/docs/react/advanced/fragments.html#fragment-matcher"),"heuristic"):(p()&&(o.invariant.warn("You're using fragments in your queries, but either don't have the addTypename:\n  true option set in Apollo Client, or you are trying to write a fragment to the store without the __typename.\n   Please turn on the addTypename option and include __typename when writing fragments so that Apollo Client\n   can accurately match fragments."),o.invariant.warn("Could not find __typename on Fragment ",t,i),o.invariant.warn("DEPRECATION WARNING: using fragments without __typename is unsupported behavior and will be removed in future versions of Apollo client. You should fix this and set addTypename to true now.")),"heuristic")},e}(),_=function(){function e(e){e&&e.introspectionQueryResultData?(this.possibleTypesMap=this.parseIntrospectionResult(e.introspectionQueryResultData),this.isReady=!0):this.isReady=!1,this.match=this.match.bind(this)}return e.prototype.match=function(e,t,r){Object(o.invariant)(this.isReady,"FragmentMatcher.match() was called before FragmentMatcher.init()");var i=r.store.get(e.id),n="ROOT_QUERY"===e.id;if(!i)return n;var a=i.__typename,s=void 0===a?n&&"Query":a;if(Object(o.invariant)(s,"Cannot match fragment because __typename property is missing: "+JSON.stringify(i)),s===t)return!0;var l=this.possibleTypesMap[t];return!!(l&&l.indexOf(s)>-1)},e.prototype.parseIntrospectionResult=function(e){var t={};return e.__schema.types.forEach(function(e){"UNION"!==e.kind&&"INTERFACE"!==e.kind||(t[e.name]=e.possibleTypes.map(function(e){return e.name}))}),t},e}(),g=Object.prototype.hasOwnProperty,b=function(){function e(e){var t=this;void 0===e&&(e=Object.create(null)),this.data=e,this.depend=Object(s.wrap)(function(e){return t.data[e]},{disposable:!0,makeCacheKey:function(e){return e}})}return e.prototype.toObject=function(){return this.data},e.prototype.get=function(e){return this.depend(e),this.data[e]},e.prototype.set=function(e,t){t!==this.data[e]&&(this.data[e]=t,this.depend.dirty(e))},e.prototype.delete=function(e){g.call(this.data,e)&&(delete this.data[e],this.depend.dirty(e))},e.prototype.clear=function(){this.replace(null)},e.prototype.replace=function(e){var t=this;e?(Object.keys(e).forEach(function(r){t.set(r,e[r])}),Object.keys(this.data).forEach(function(r){g.call(e,r)||t.delete(r)})):Object.keys(this.data).forEach(function(e){t.delete(e)})},e}();function y(e){return new b(e)}var x=function(){function e(e){var t=this,r=void 0===e?{}:e,i=r.cacheKeyRoot,n=void 0===i?new s.KeyTrie(a.canUseWeakMap):i,o=r.freezeResults,l=void 0!==o&&o,d=this.executeStoreQuery,u=this.executeSelectionSet,c=this.executeSubSelectedArray;this.freezeResults=l,this.executeStoreQuery=Object(s.wrap)(function(e){return d.call(t,e)},{makeCacheKey:function(e){var t=e.query,r=e.rootValue,i=e.contextValue,a=e.variableValues,s=e.fragmentMatcher;if(i.store instanceof b)return n.lookup(i.store,t,s,JSON.stringify(a),r.id)}}),this.executeSelectionSet=Object(s.wrap)(function(e){return u.call(t,e)},{makeCacheKey:function(e){var t=e.selectionSet,r=e.rootValue,i=e.execContext;if(i.contextValue.store instanceof b)return n.lookup(i.contextValue.store,t,i.fragmentMatcher,JSON.stringify(i.variableValues),r.id)}}),this.executeSubSelectedArray=Object(s.wrap)(function(e){return c.call(t,e)},{makeCacheKey:function(e){var t=e.field,r=e.array,i=e.execContext;if(i.contextValue.store instanceof b)return n.lookup(i.contextValue.store,t,r,JSON.stringify(i.variableValues))}})}return e.prototype.readQueryFromStore=function(e){return this.diffQueryAgainstStore(Object(i.__assign)({},e,{returnPartialData:!1})).result},e.prototype.diffQueryAgainstStore=function(e){var t=e.store,r=e.query,i=e.variables,n=e.previousResult,s=e.returnPartialData,l=void 0===s||s,d=e.rootId,u=void 0===d?"ROOT_QUERY":d,c=e.fragmentMatcherFunction,h=e.config,m=Object(a.getQueryDefinition)(r);i=Object(a.assign)({},Object(a.getDefaultValues)(m),i);var f={store:t,dataIdFromObject:h&&h.dataIdFromObject||null,cacheRedirects:h&&h.cacheRedirects||{}},p=this.executeStoreQuery({query:r,rootValue:{type:"id",id:u,generated:!0,typename:"Query"},contextValue:f,variableValues:i,fragmentMatcher:c}),v=p.missing&&p.missing.length>0;return v&&!l&&p.missing.forEach(function(e){if(!e.tolerable)throw new o.InvariantError("Can't find field "+e.fieldName+" on object "+JSON.stringify(e.object,null,2)+".")}),n&&Object(a.isEqual)(n,p.result)&&(p.result=n),{result:p.result,complete:!v}},e.prototype.executeStoreQuery=function(e){var t=e.query,r=e.rootValue,i=e.contextValue,n=e.variableValues,s=e.fragmentMatcher,o=void 0===s?E:s,l=Object(a.getMainDefinition)(t),d=Object(a.getFragmentDefinitions)(t),u={query:t,fragmentMap:Object(a.createFragmentMap)(d),contextValue:i,variableValues:n,fragmentMatcher:o};return this.executeSelectionSet({selectionSet:l.selectionSet,rootValue:r,execContext:u})},e.prototype.executeSelectionSet=function(e){var t=this,r=e.selectionSet,n=e.rootValue,s=e.execContext,l=s.fragmentMap,d=s.contextValue,u=s.variableValues,c={result:null},h=[],m=d.store.get(n.id),f=m&&m.__typename||"ROOT_QUERY"===n.id&&"Query"||void 0;function p(e){var t;return e.missing&&(c.missing=c.missing||[],(t=c.missing).push.apply(t,e.missing)),e.result}return r.selections.forEach(function(e){var r;if(Object(a.shouldInclude)(e,u))if(Object(a.isField)(e)){var c=p(t.executeField(m,f,e,s));void 0!==c&&h.push(((r={})[Object(a.resultKeyNameFromField)(e)]=c,r))}else{var v=void 0;if(Object(a.isInlineFragment)(e))v=e;else if(!(v=l[e.name.value]))throw new o.InvariantError("No fragment named "+e.name.value);var _=v.typeCondition.name.value,g=s.fragmentMatcher(n,_,d);if(g){var b=t.executeSelectionSet({selectionSet:v.selectionSet,rootValue:n,execContext:s});"heuristic"===g&&b.missing&&(b=Object(i.__assign)({},b,{missing:b.missing.map(function(e){return Object(i.__assign)({},e,{tolerable:!0})})})),h.push(p(b))}}}),c.result=Object(a.mergeDeepArray)(h),this.freezeResults&&Object.freeze(c.result),c},e.prototype.executeField=function(e,t,r,i){var n=i.variableValues,s=i.contextValue,o=function(e,t,r,i,n,s){s.resultKey;var o=s.directives,l=r;(i||o)&&(l=Object(a.getStoreKeyName)(l,i,o));var d=void 0;if(e&&void 0===(d=e[l])&&n.cacheRedirects&&"string"==typeof t){var u=n.cacheRedirects[t];if(u){var c=u[r];c&&(d=c(e,i,{getCacheKey:function(e){return Object(a.toIdValue)({id:n.dataIdFromObject(e),typename:e.__typename})}}))}}if(void 0===d)return{result:d,missing:[{object:e,fieldName:l,tolerable:!1}]};Object(a.isJsonValue)(d)&&(d=d.json);return{result:d}}(e,t,r.name.value,Object(a.argumentsObjectFromField)(r,n),s,{resultKey:Object(a.resultKeyNameFromField)(r),directives:Object(a.getDirectiveInfoFromField)(r,n)});return Array.isArray(o.result)?this.combineExecResults(o,this.executeSubSelectedArray({field:r,array:o.result,execContext:i})):r.selectionSet?null==o.result?o:this.combineExecResults(o,this.executeSelectionSet({selectionSet:r.selectionSet,rootValue:o.result,execContext:i})):(w(r,o.result),this.freezeResults&&Object(a.maybeDeepFreeze)(o),o)},e.prototype.combineExecResults=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=null;return e.forEach(function(e){e.missing&&(r=r||[]).push.apply(r,e.missing)}),{result:e.pop().result,missing:r}},e.prototype.executeSubSelectedArray=function(e){var t=this,r=e.field,i=e.array,n=e.execContext,a=null;function s(e){return e.missing&&(a=a||[]).push.apply(a,e.missing),e.result}return i=i.map(function(e){return null===e?null:Array.isArray(e)?s(t.executeSubSelectedArray({field:r,array:e,execContext:n})):r.selectionSet?s(t.executeSelectionSet({selectionSet:r.selectionSet,rootValue:e,execContext:n})):(w(r,e),e)}),this.freezeResults&&Object.freeze(i),{result:i,missing:a}},e}();function w(e,t){if(!e.selectionSet&&Object(a.isIdValue)(t))throw new o.InvariantError("Missing selection set for object of type "+t.typename+" returned for query field "+e.name.value)}function E(){return!0}function M(e){Object(o.invariant)(Object(a.isIdValue)(e),"Encountered a sub-selection on the query, but the store doesn't have an object reference. This should never happen during normal use unless you have custom code that is directly manipulating the store; please file an issue.")}var A=function(){function e(e){void 0===e&&(e=Object.create(null)),this.data=e}return e.prototype.toObject=function(){return this.data},e.prototype.get=function(e){return this.data[e]},e.prototype.set=function(e,t){this.data[e]=t},e.prototype.delete=function(e){this.data[e]=void 0},e.prototype.clear=function(){this.data=Object.create(null)},e.prototype.replace=function(e){this.data=e||Object.create(null)},e}();function T(e){return new A(e)}var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="WriteError",t}return Object(i.__extends)(t,e),t}(Error);function k(e,t){var r=new S("Error writing result to store for query:\n "+JSON.stringify(t));return r.message+="\n"+e.message,r.stack=e.stack,r}var D=function(){function e(){}return e.prototype.writeQueryToStore=function(e){var t=e.query,r=e.result,i=e.store,n=void 0===i?y():i,a=e.variables,s=e.dataIdFromObject,o=e.fragmentMatcherFunction;return this.writeResultToStore({dataId:"ROOT_QUERY",result:r,document:t,store:n,variables:a,dataIdFromObject:s,fragmentMatcherFunction:o})},e.prototype.writeResultToStore=function(e){var t=e.dataId,r=e.result,i=e.document,n=e.store,s=void 0===n?y():n,o=e.variables,l=e.dataIdFromObject,d=e.fragmentMatcherFunction,u=Object(a.getOperationDefinition)(i);try{return this.writeSelectionSetToStore({result:r,dataId:t,selectionSet:u.selectionSet,context:{store:s,processedData:{},variables:Object(a.assign)({},Object(a.getDefaultValues)(u),o),dataIdFromObject:l,fragmentMap:Object(a.createFragmentMap)(Object(a.getFragmentDefinitions)(i)),fragmentMatcherFunction:d}})}catch(e){throw k(e,i)}},e.prototype.writeSelectionSetToStore=function(e){var t=this,r=e.result,i=e.dataId,n=e.selectionSet,s=e.context,l=s.variables,d=s.store,u=s.fragmentMap;return n.selections.forEach(function(e){var n;if(Object(a.shouldInclude)(e,l))if(Object(a.isField)(e)){var d=Object(a.resultKeyNameFromField)(e),c=r[d];if(void 0!==c)t.writeFieldToStore({dataId:i,value:c,field:e,context:s});else{var h=!1,m=!1;e.directives&&e.directives.length&&(h=e.directives.some(function(e){return e.name&&"defer"===e.name.value}),m=e.directives.some(function(e){return e.name&&"client"===e.name.value})),h||m||!s.fragmentMatcherFunction||o.invariant.warn("Missing field "+d+" in "+JSON.stringify(r,null,2).substring(0,100))}}else{var f=void 0;Object(a.isInlineFragment)(e)?f=e:(f=(u||{})[e.name.value],Object(o.invariant)(f,"No fragment named "+e.name.value+"."));var p=!0;if(s.fragmentMatcherFunction&&f.typeCondition){var v=i||"self",_=Object(a.toIdValue)({id:v,typename:void 0}),g={store:new A((n={},n[v]=r,n)),cacheRedirects:{}},b=s.fragmentMatcherFunction(_,f.typeCondition.name.value,g);Object(a.isProduction)()||"heuristic"!==b||o.invariant.error("WARNING: heuristic fragment matching going on!"),p=!!b}p&&t.writeSelectionSetToStore({result:r,selectionSet:f.selectionSet,dataId:i,context:s})}}),d},e.prototype.writeFieldToStore=function(e){var t,r,n,s=e.field,l=e.value,d=e.dataId,u=e.context,c=u.variables,h=u.dataIdFromObject,m=u.store,f=Object(a.storeKeyNameFromField)(s,c);if(s.selectionSet&&null!==l)if(Array.isArray(l)){var p=d+"."+f;r=this.processArrayValue(l,p,s.selectionSet,u)}else{var v=d+"."+f,_=!0;if(I(v)||(v="$"+v),h){var g=h(l);Object(o.invariant)(!g||!I(g),'IDs returned by dataIdFromObject cannot begin with the "$" character.'),(g||"number"==typeof g&&0===g)&&(v=g,_=!1)}N(v,s,u.processedData)||this.writeSelectionSetToStore({dataId:v,result:l,selectionSet:s.selectionSet,context:u});var b=l.__typename;r=Object(a.toIdValue)({id:v,typename:b},_);var y=(n=m.get(d))&&n[f];if(y!==r&&Object(a.isIdValue)(y)){var x=void 0!==y.typename,w=void 0!==b,E=x&&w&&y.typename!==b;Object(o.invariant)(!_||y.generated||E,"Store error: the application attempted to write an object with no provided id but the store already contains an id of "+y.id+" for this object. The selectionSet that was trying to be written is:\n"+JSON.stringify(s)),Object(o.invariant)(!x||w,"Store error: the application attempted to write an object with no provided typename but the store already contains an object with typename of "+y.typename+" for the object of id "+y.id+". The selectionSet that was trying to be written is:\n"+JSON.stringify(s)),y.generated&&(E?_||m.delete(y.id):function e(t,r,n){if(t===r)return!1;var s=n.get(t);var o=n.get(r);var l=!1;Object.keys(s).forEach(function(t){var r=s[t],i=o[t];Object(a.isIdValue)(r)&&I(r.id)&&Object(a.isIdValue)(i)&&!Object(a.isEqual)(r,i)&&e(r.id,i.id,n)&&(l=!0)});n.delete(t);var d=Object(i.__assign)({},s,o);if(Object(a.isEqual)(d,o))return l;n.set(r,d);return!0}(y.id,r.id,m))}}else r=null!=l&&"object"==typeof l?{type:"json",json:l}:l;(n=m.get(d))&&Object(a.isEqual)(r,n[f])||m.set(d,Object(i.__assign)({},n,((t={})[f]=r,t)))},e.prototype.processArrayValue=function(e,t,r,i){var n=this;return e.map(function(e,s){if(null===e)return null;var o=t+"."+s;if(Array.isArray(e))return n.processArrayValue(e,o,r,i);var l=!0;if(i.dataIdFromObject){var d=i.dataIdFromObject(e);d&&(o=d,l=!1)}return N(o,r,i.processedData)||n.writeSelectionSetToStore({dataId:o,result:e,selectionSet:r,context:i}),Object(a.toIdValue)({id:o,typename:e.__typename},l)})},e}();function I(e){return"$"===e[0]}function N(e,t,r){if(!r)return!1;if(r[e]){if(r[e].indexOf(t)>=0)return!0;r[e].push(t)}else r[e]=[t];return!1}var P={fragmentMatcher:new v,dataIdFromObject:O,addTypename:!0,resultCaching:!0,freezeResults:!1};function O(e){if(e.__typename){if(void 0!==e.id)return e.__typename+":"+e.id;if(void 0!==e._id)return e.__typename+":"+e._id}return null}var R=Object.prototype.hasOwnProperty,F=function(e){function t(t,r,i){var n=e.call(this,Object.create(null))||this;return n.optimisticId=t,n.parent=r,n.transaction=i,n}return Object(i.__extends)(t,e),t.prototype.toObject=function(){return Object(i.__assign)({},this.parent.toObject(),this.data)},t.prototype.get=function(e){return R.call(this.data,e)?this.data[e]:this.parent.get(e)},t}(A),C=function(e){function t(t){void 0===t&&(t={});var r=e.call(this)||this;r.watches=new Set,r.typenameDocumentCache=new Map,r.cacheKeyRoot=new s.KeyTrie(a.canUseWeakMap),r.silenceBroadcast=!1,r.config=Object(i.__assign)({},P,t),r.config.customResolvers&&(o.invariant.warn("customResolvers have been renamed to cacheRedirects. Please update your config as we will be deprecating customResolvers in the next major version."),r.config.cacheRedirects=r.config.customResolvers),r.config.cacheResolvers&&(o.invariant.warn("cacheResolvers have been renamed to cacheRedirects. Please update your config as we will be deprecating cacheResolvers in the next major version."),r.config.cacheRedirects=r.config.cacheResolvers),r.addTypename=r.config.addTypename,r.data=r.config.resultCaching?new b:new A,r.optimisticData=r.data,r.storeWriter=new D,r.storeReader=new x({cacheKeyRoot:r.cacheKeyRoot,freezeResults:t.freezeResults});var n=r,l=n.maybeBroadcastWatch;return r.maybeBroadcastWatch=Object(s.wrap)(function(e){return l.call(r,e)},{makeCacheKey:function(e){if(!e.optimistic&&!e.previousResult)return n.data instanceof b?n.cacheKeyRoot.lookup(e.query,JSON.stringify(e.variables)):void 0}}),r}return Object(i.__extends)(t,e),t.prototype.restore=function(e){return e&&this.data.replace(e),this},t.prototype.extract=function(e){return void 0===e&&(e=!1),(e?this.optimisticData:this.data).toObject()},t.prototype.read=function(e){return"string"==typeof e.rootId&&void 0===this.data.get(e.rootId)?null:this.storeReader.readQueryFromStore({store:e.optimistic?this.optimisticData:this.data,query:this.transformDocument(e.query),variables:e.variables,rootId:e.rootId,fragmentMatcherFunction:this.config.fragmentMatcher.match,previousResult:e.previousResult,config:this.config})},t.prototype.write=function(e){this.storeWriter.writeResultToStore({dataId:e.dataId,result:e.result,variables:e.variables,document:this.transformDocument(e.query),store:this.data,dataIdFromObject:this.config.dataIdFromObject,fragmentMatcherFunction:this.config.fragmentMatcher.match}),this.broadcastWatches()},t.prototype.diff=function(e){return this.storeReader.diffQueryAgainstStore({store:e.optimistic?this.optimisticData:this.data,query:this.transformDocument(e.query),variables:e.variables,returnPartialData:e.returnPartialData,previousResult:e.previousResult,fragmentMatcherFunction:this.config.fragmentMatcher.match,config:this.config})},t.prototype.watch=function(e){var t=this;return this.watches.add(e),function(){t.watches.delete(e)}},t.prototype.evict=function(e){throw new o.InvariantError("eviction is not implemented on InMemory Cache")},t.prototype.reset=function(){return this.data.clear(),this.broadcastWatches(),Promise.resolve()},t.prototype.removeOptimistic=function(e){for(var t=[],r=0,i=this.optimisticData;i instanceof F;)i.optimisticId===e?++r:t.push(i),i=i.parent;if(r>0){for(this.optimisticData=i;t.length>0;){var n=t.pop();this.performTransaction(n.transaction,n.optimisticId)}this.broadcastWatches()}},t.prototype.performTransaction=function(e,t){var r=this.data,i=this.silenceBroadcast;this.silenceBroadcast=!0,"string"==typeof t&&(this.data=this.optimisticData=new F(t,this.optimisticData,e));try{e(this)}finally{this.silenceBroadcast=i,this.data=r}this.broadcastWatches()},t.prototype.recordOptimisticTransaction=function(e,t){return this.performTransaction(e,t)},t.prototype.transformDocument=function(e){if(this.addTypename){var t=this.typenameDocumentCache.get(e);return t||(t=Object(a.addTypenameToDocument)(e),this.typenameDocumentCache.set(e,t),this.typenameDocumentCache.set(t,t)),t}return e},t.prototype.broadcastWatches=function(){var e=this;this.silenceBroadcast||this.watches.forEach(function(t){return e.maybeBroadcastWatch(t)})},t.prototype.maybeBroadcastWatch=function(e){e.callback(this.diff({query:e.query,variables:e.variables,previousResult:e.previousResult&&e.previousResult(),optimistic:e.optimistic}))},t}(n.ApolloCache)},"./node_modules/apollo-cache-inmemory/node_modules/apollo-utilities/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"addTypenameToDocument",function(){return Z}),r.d(t,"argumentsObjectFromField",function(){return p}),r.d(t,"assign",function(){return P}),r.d(t,"buildQueryFromSelectionSet",function(){return ne}),r.d(t,"canUseWeakMap",function(){return se}),r.d(t,"checkDocument",function(){return R}),r.d(t,"cloneDeep",function(){return le}),r.d(t,"createFragmentMap",function(){return U}),r.d(t,"getDefaultValues",function(){return G}),r.d(t,"getDirectiveInfoFromField",function(){return M}),r.d(t,"getDirectiveNames",function(){return T}),r.d(t,"getDirectivesFromDocument",function(){return te}),r.d(t,"getEnv",function(){return de}),r.d(t,"getFragmentDefinition",function(){return V}),r.d(t,"getFragmentDefinitions",function(){return L}),r.d(t,"getFragmentQueryDocument",function(){return N}),r.d(t,"getInclusionDirectives",function(){return I}),r.d(t,"getMainDefinition",function(){return z}),r.d(t,"getMutationDefinition",function(){return O}),r.d(t,"getOperationDefinition",function(){return F}),r.d(t,"getOperationDefinitionOrDie",function(){return C}),r.d(t,"getOperationName",function(){return B}),r.d(t,"getQueryDefinition",function(){return j}),r.d(t,"getStoreKeyName",function(){return f}),r.d(t,"graphQLResultHasError",function(){return pe}),r.d(t,"hasClientExports",function(){return k}),r.d(t,"hasDirectives",function(){return S}),r.d(t,"isDevelopment",function(){return he}),r.d(t,"isEnv",function(){return ue}),r.d(t,"isField",function(){return _}),r.d(t,"isIdValue",function(){return b}),r.d(t,"isInlineFragment",function(){return g}),r.d(t,"isJsonValue",function(){return x}),r.d(t,"isNumberValue",function(){return u}),r.d(t,"isProduction",function(){return ce}),r.d(t,"isScalarValue",function(){return d}),r.d(t,"isTest",function(){return me}),r.d(t,"maybeDeepFreeze",function(){return ve}),r.d(t,"mergeDeep",function(){return ge}),r.d(t,"mergeDeepArray",function(){return be}),r.d(t,"removeArgumentsFromDocument",function(){return re}),r.d(t,"removeClientSetsFromDocument",function(){return ae}),r.d(t,"removeConnectionDirectiveFromDocument",function(){return J}),r.d(t,"removeDirectivesFromDocument",function(){return X}),r.d(t,"removeFragmentSpreadFromDocument",function(){return ie}),r.d(t,"resultKeyNameFromField",function(){return v}),r.d(t,"shouldInclude",function(){return A}),r.d(t,"storeKeyNameFromField",function(){return h}),r.d(t,"stripSymbols",function(){return Ae}),r.d(t,"toIdValue",function(){return y}),r.d(t,"tryFunctionOrLogError",function(){return fe}),r.d(t,"valueFromNode",function(){return E}),r.d(t,"valueToObjectRepresentation",function(){return c}),r.d(t,"variablesInOperation",function(){return q}),r.d(t,"warnOnceInDevelopment",function(){return Me});var i=r("./node_modules/graphql/language/visitor.js"),n=r("./node_modules/ts-invariant/lib/invariant.esm.js"),a=r("./node_modules/tslib/tslib.es6.js"),s=r("./node_modules/fast-json-stable-stringify/index.js"),o=r.n(s),l=r("./node_modules/@wry/equality/lib/equality.esm.js");function d(e){return["StringValue","BooleanValue","EnumValue"].indexOf(e.kind)>-1}function u(e){return["IntValue","FloatValue"].indexOf(e.kind)>-1}function c(e,t,r,i){if(function(e){return"IntValue"===e.kind}(r)||function(e){return"FloatValue"===e.kind}(r))e[t.value]=Number(r.value);else if(function(e){return"BooleanValue"===e.kind}(r)||function(e){return"StringValue"===e.kind}(r))e[t.value]=r.value;else if(function(e){return"ObjectValue"===e.kind}(r)){var a={};r.fields.map(function(e){return c(a,e.name,e.value,i)}),e[t.value]=a}else if(function(e){return"Variable"===e.kind}(r)){var s=(i||{})[r.name.value];e[t.value]=s}else if(function(e){return"ListValue"===e.kind}(r))e[t.value]=r.values.map(function(e){var r={};return c(r,t,e,i),r[t.value]});else if(function(e){return"EnumValue"===e.kind}(r))e[t.value]=r.value;else{if(!function(e){return"NullValue"===e.kind}(r))throw new n.InvariantError('The inline argument "'+t.value+'" of kind "'+r.kind+'"is not supported. Use variables instead of inline arguments to overcome this limitation.');e[t.value]=null}}function h(e,t){var r=null;e.directives&&(r={},e.directives.forEach(function(e){r[e.name.value]={},e.arguments&&e.arguments.forEach(function(i){var n=i.name,a=i.value;return c(r[e.name.value],n,a,t)})}));var i=null;return e.arguments&&e.arguments.length&&(i={},e.arguments.forEach(function(e){var r=e.name,n=e.value;return c(i,r,n,t)})),f(e.name.value,i,r)}r.d(t,"isEqual",function(){return l.equal});var m=["connection","include","skip","client","rest","export"];function f(e,t,r){if(r&&r.connection&&r.connection.key){if(r.connection.filter&&r.connection.filter.length>0){var i=r.connection.filter?r.connection.filter:[];i.sort();var n=t,a={};return i.forEach(function(e){a[e]=n[e]}),r.connection.key+"("+JSON.stringify(a)+")"}return r.connection.key}var s=e;if(t){var l=o()(t);s+="("+l+")"}return r&&Object.keys(r).forEach(function(e){-1===m.indexOf(e)&&(r[e]&&Object.keys(r[e]).length?s+="@"+e+"("+JSON.stringify(r[e])+")":s+="@"+e)}),s}function p(e,t){if(e.arguments&&e.arguments.length){var r={};return e.arguments.forEach(function(e){var i=e.name,n=e.value;return c(r,i,n,t)}),r}return null}function v(e){return e.alias?e.alias.value:e.name.value}function _(e){return"Field"===e.kind}function g(e){return"InlineFragment"===e.kind}function b(e){return e&&"id"===e.type&&"boolean"==typeof e.generated}function y(e,t){return void 0===t&&(t=!1),Object(a.__assign)({type:"id",generated:t},"string"==typeof e?{id:e,typename:void 0}:e)}function x(e){return null!=e&&"object"==typeof e&&"json"===e.type}function w(e){throw new n.InvariantError("Variable nodes are not supported by valueFromNode")}function E(e,t){switch(void 0===t&&(t=w),e.kind){case"Variable":return t(e);case"NullValue":return null;case"IntValue":return parseInt(e.value,10);case"FloatValue":return parseFloat(e.value);case"ListValue":return e.values.map(function(e){return E(e,t)});case"ObjectValue":for(var r={},i=0,n=e.fields;i<n.length;i++){var a=n[i];r[a.name.value]=E(a.value,t)}return r;default:return e.value}}function M(e,t){if(e.directives&&e.directives.length){var r={};return e.directives.forEach(function(e){r[e.name.value]=p(e,t)}),r}return null}function A(e,t){return void 0===t&&(t={}),I(e.directives).every(function(e){var r=e.directive,i=e.ifArgument,a=!1;return"Variable"===i.value.kind?(a=t[i.value.name.value],Object(n.invariant)(void 0!==a,"Invalid variable referenced in @"+r.name.value+" directive.")):a=i.value.value,"skip"===r.name.value?!a:a})}function T(e){var t=[];return Object(i.visit)(e,{Directive:function(e){t.push(e.name.value)}}),t}function S(e,t){return T(t).some(function(t){return e.indexOf(t)>-1})}function k(e){return e&&S(["client"],e)&&S(["export"],e)}function D(e){var t=e.name.value;return"skip"===t||"include"===t}function I(e){return e?e.filter(D).map(function(e){var t=e.arguments,r=e.name.value;Object(n.invariant)(t&&1===t.length,"Incorrect number of arguments for the @"+r+" directive.");var i=t[0];Object(n.invariant)(i.name&&"if"===i.name.value,"Invalid argument for the @"+r+" directive.");var a=i.value;return Object(n.invariant)(a&&("Variable"===a.kind||"BooleanValue"===a.kind),"Argument for the @"+r+" directive must be a variable or a boolean value."),{directive:e,ifArgument:i}}):[]}function N(e,t){var r=t,i=[];return e.definitions.forEach(function(e){if("OperationDefinition"===e.kind)throw new n.InvariantError("Found a "+e.operation+" operation"+(e.name?" named '"+e.name.value+"'":"")+". No operations are allowed when using a fragment as a query. Only fragments are allowed.");"FragmentDefinition"===e.kind&&i.push(e)}),void 0===r&&(Object(n.invariant)(1===i.length,"Found "+i.length+" fragments. `fragmentName` must be provided when there is not exactly 1 fragment."),r=i[0].name.value),Object(a.__assign)({},e,{definitions:[{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:r}}]}}].concat(e.definitions)})}function P(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(t){null!=t&&Object.keys(t).forEach(function(r){e[r]=t[r]})}),e}function O(e){R(e);var t=e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})[0];return Object(n.invariant)(t,"Must contain a mutation definition."),t}function R(e){Object(n.invariant)(e&&"Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql');var t=e.definitions.filter(function(e){return"FragmentDefinition"!==e.kind}).map(function(e){if("OperationDefinition"!==e.kind)throw new n.InvariantError('Schema type definitions not allowed in queries. Found: "'+e.kind+'"');return e});return Object(n.invariant)(t.length<=1,"Ambiguous GraphQL document: contains "+t.length+" operations"),e}function F(e){return R(e),e.definitions.filter(function(e){return"OperationDefinition"===e.kind})[0]}function C(e){var t=F(e);return Object(n.invariant)(t,"GraphQL document is missing an operation"),t}function B(e){return e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&e.name}).map(function(e){return e.name.value})[0]||null}function L(e){return e.definitions.filter(function(e){return"FragmentDefinition"===e.kind})}function j(e){var t=F(e);return Object(n.invariant)(t&&"query"===t.operation,"Must contain a query definition."),t}function V(e){Object(n.invariant)("Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql'),Object(n.invariant)(e.definitions.length<=1,"Fragment must have exactly one definition.");var t=e.definitions[0];return Object(n.invariant)("FragmentDefinition"===t.kind,"Must be a fragment definition."),t}function z(e){var t;R(e);for(var r=0,i=e.definitions;r<i.length;r++){var a=i[r];if("OperationDefinition"===a.kind){var s=a.operation;if("query"===s||"mutation"===s||"subscription"===s)return a}"FragmentDefinition"!==a.kind||t||(t=a)}if(t)return t;throw new n.InvariantError("Expected a parsed GraphQL query with a query, mutation, subscription, or a fragment.")}function U(e){void 0===e&&(e=[]);var t={};return e.forEach(function(e){t[e.name.value]=e}),t}function G(e){if(e&&e.variableDefinitions&&e.variableDefinitions.length){var t=e.variableDefinitions.filter(function(e){return e.defaultValue}).map(function(e){var t=e.variable,r=e.defaultValue,i={};return c(i,t.name,r),i});return P.apply(void 0,[{}].concat(t))}return{}}function q(e){var t=new Set;if(e.variableDefinitions)for(var r=0,i=e.variableDefinitions;r<i.length;r++){var n=i[r];t.add(n.variable.name.value)}return t}function Q(e,t,r){var i=0;return e.forEach(function(r,n){t.call(this,r,n,e)&&(e[i++]=r)},r),e.length=i,e}var H={kind:"Field",name:{kind:"Name",value:"__typename"}};function Y(e){return function e(t,r){return t.selectionSet.selections.every(function(t){return"FragmentSpread"===t.kind&&e(r[t.name.value],r)})}(F(e)||V(e),U(L(e)))?null:e}function W(e){return function(t){return e.some(function(e){return e.name&&e.name===t.name.value||e.test&&e.test(t)})}}function X(e,t){var r=Object.create(null),n=[],a=Object.create(null),s=[],o=Y(Object(i.visit)(t,{Variable:{enter:function(e,t,i){"VariableDefinition"!==i.kind&&(r[e.name.value]=!0)}},Field:{enter:function(t){if(e&&t.directives&&(e.some(function(e){return e.remove})&&t.directives&&t.directives.some(W(e))))return t.arguments&&t.arguments.forEach(function(e){"Variable"===e.value.kind&&n.push({name:e.value.name.value})}),t.selectionSet&&function e(t){var r=[];t.selections.forEach(function(t){(_(t)||g(t))&&t.selectionSet?e(t.selectionSet).forEach(function(e){return r.push(e)}):"FragmentSpread"===t.kind&&r.push(t)});return r}(t.selectionSet).forEach(function(e){s.push({name:e.name.value})}),null}},FragmentSpread:{enter:function(e){a[e.name.value]=!0}},Directive:{enter:function(t){if(W(e)(t))return null}}}));return o&&Q(n,function(e){return!r[e.name]}).length&&(o=re(n,o)),o&&Q(s,function(e){return!a[e.name]}).length&&(o=ie(s,o)),o}function Z(e){return Object(i.visit)(R(e),{SelectionSet:{enter:function(e,t,r){if(!r||"OperationDefinition"!==r.kind){var i=e.selections;if(i)if(!i.some(function(e){return _(e)&&("__typename"===e.name.value||0===e.name.value.lastIndexOf("__",0))})){var n=r;if(!(_(n)&&n.directives&&n.directives.some(function(e){return"export"===e.name.value})))return Object(a.__assign)({},e,{selections:i.concat([H])})}}}}})}var K={test:function(e){var t="connection"===e.name.value;return t&&(e.arguments&&e.arguments.some(function(e){return"key"===e.name.value})||n.invariant.warn("Removing an @connection directive even though it does not have a key. You may want to use the key parameter to specify a store key.")),t}};function J(e){return X([K],R(e))}function $(e,t,r){return void 0===r&&(r=!0),t&&t.selections&&t.selections.some(function(t){return ee(e,t,r)})}function ee(e,t,r){return void 0===r&&(r=!0),!_(t)||!!t.directives&&(t.directives.some(W(e))||r&&$(e,t.selectionSet,r))}function te(e,t){var r;return R(t),Y(Object(i.visit)(t,{SelectionSet:{enter:function(t,i,n,s){var o=s.join("-");if(!r||o===r||!o.startsWith(r)){if(t.selections){var l=t.selections.filter(function(t){return ee(e,t)});return $(e,t,!1)&&(r=o),Object(a.__assign)({},t,{selections:l})}return null}}}}))}function re(e,t){var r=function(e){return function(t){return e.some(function(e){return t.value&&"Variable"===t.value.kind&&t.value.name&&(e.name===t.value.name.value||e.test&&e.test(t))})}}(e);return Y(Object(i.visit)(t,{OperationDefinition:{enter:function(t){return Object(a.__assign)({},t,{variableDefinitions:t.variableDefinitions.filter(function(t){return!e.some(function(e){return e.name===t.variable.name.value})})})}},Field:{enter:function(t){if(e.some(function(e){return e.remove})){var i=0;if(t.arguments.forEach(function(e){r(e)&&(i+=1)}),1===i)return null}}},Argument:{enter:function(e){if(r(e))return null}}}))}function ie(e,t){function r(t){if(e.some(function(e){return e.name===t.name.value}))return null}return Y(Object(i.visit)(t,{FragmentSpread:{enter:r},FragmentDefinition:{enter:r}}))}function ne(e){return"query"===z(e).operation?e:Object(i.visit)(e,{OperationDefinition:{enter:function(e){return Object(a.__assign)({},e,{operation:"query"})}}})}function ae(e){R(e);var t=X([{test:function(e){return"client"===e.name.value},remove:!0}],e);return t&&(t=Object(i.visit)(t,{FragmentDefinition:{enter:function(e){if(e.selectionSet&&e.selectionSet.selections.every(function(e){return _(e)&&"__typename"===e.name.value}))return null}}})),t}var se="function"==typeof WeakMap&&!("object"==typeof navigator&&"ReactNative"===navigator.product),oe=Object.prototype.toString;function le(e){return function e(t,r){switch(oe.call(t)){case"[object Array]":if(r.has(t))return r.get(t);var i=t.slice(0);return r.set(t,i),i.forEach(function(t,n){i[n]=e(t,r)}),i;case"[object Object]":if(r.has(t))return r.get(t);var n=Object.create(Object.getPrototypeOf(t));return r.set(t,n),Object.keys(t).forEach(function(i){n[i]=e(t[i],r)}),n;default:return t}}(e,new Map)}function de(){return"development"}function ue(e){return"development"===e}function ce(){return!0===ue("production")}function he(){return!0===ue("development")}function me(){return!0===ue("test")}function fe(e){try{return e()}catch(e){console.error&&console.error(e)}}function pe(e){return e.errors&&e.errors.length}function ve(e){if((he()||me())&&!("function"==typeof Symbol&&"string"==typeof Symbol("")))return function e(t){return Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(r){null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||e(t[r])}),t}(e);return e}var _e=Object.prototype.hasOwnProperty;function ge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return be(e)}function be(e){var t=e[0]||{},r=e.length;if(r>1){var i=[];t=we(t,i);for(var n=1;n<r;++n)t=xe(t,e[n],i)}return t}function ye(e){return null!==e&&"object"==typeof e}function xe(e,t,r){return ye(t)&&ye(e)?(Object.isExtensible&&!Object.isExtensible(e)&&(e=we(e,r)),Object.keys(t).forEach(function(i){var n=t[i];if(_e.call(e,i)){var a=e[i];n!==a&&(e[i]=xe(we(a,r),n,r))}else e[i]=n}),e):t}function we(e,t){return null!==e&&"object"==typeof e&&t.indexOf(e)<0&&(e=Array.isArray(e)?e.slice(0):Object(a.__assign)({__proto__:Object.getPrototypeOf(e)},e),t.push(e)),e}var Ee=Object.create({});function Me(e,t){void 0===t&&(t="warn"),ce()||Ee[e]||(me()||(Ee[e]=!0),"error"===t?console.error(e):console.warn(e))}function Ae(e){return JSON.parse(JSON.stringify(e))}}.call(this,r("./node_modules/process/browser.js"))},"./node_modules/apollo-cache/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"ApolloCache",function(){return l}),r.d(t,"Cache",function(){return s});var i=r("./node_modules/apollo-cache/node_modules/apollo-utilities/lib/bundle.esm.js");function n(e){return{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GeneratedClientQuery"},selectionSet:a(e)}]}}function a(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return null;if(Array.isArray(e))return a(e[0]);var t=[];return Object.keys(e).forEach(function(r){var i={kind:"Field",name:{kind:"Name",value:r},selectionSet:a(e[r])||void 0};t.push(i)}),{kind:"SelectionSet",selections:t}}var s,o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:null,variableDefinitions:null,directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:null,name:{kind:"Name",value:"__typename"},arguments:[],directives:[],selectionSet:null}]}}]},l=function(){function e(){}return e.prototype.transformDocument=function(e){return e},e.prototype.transformForLink=function(e){return e},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!1),this.read({query:e.query,variables:e.variables,optimistic:t})},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!1),this.read({query:Object(i.getFragmentQueryDocument)(e.fragment,e.fragmentName),variables:e.variables,rootId:e.id,optimistic:t})},e.prototype.writeQuery=function(e){this.write({dataId:"ROOT_QUERY",result:e.data,query:e.query,variables:e.variables})},e.prototype.writeFragment=function(e){this.write({dataId:e.id,result:e.data,variables:e.variables,query:Object(i.getFragmentQueryDocument)(e.fragment,e.fragmentName)})},e.prototype.writeData=function(e){var t,r,i=e.id,s=e.data;if(void 0!==i){var l=null;try{l=this.read({rootId:i,optimistic:!1,query:o})}catch(e){}var d=l&&l.__typename||"__ClientData",u=Object.assign({__typename:d},s);this.writeFragment({id:i,fragment:(t=u,r=d,{kind:"Document",definitions:[{kind:"FragmentDefinition",typeCondition:{kind:"NamedType",name:{kind:"Name",value:r||"__FakeType"}},name:{kind:"Name",value:"GeneratedClientQuery"},selectionSet:a(t)}]}),data:u})}else this.writeQuery({query:n(s),data:s})},e}();s||(s={})},"./node_modules/apollo-cache/node_modules/apollo-utilities/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"addTypenameToDocument",function(){return Z}),r.d(t,"argumentsObjectFromField",function(){return p}),r.d(t,"assign",function(){return P}),r.d(t,"buildQueryFromSelectionSet",function(){return ne}),r.d(t,"canUseWeakMap",function(){return se}),r.d(t,"checkDocument",function(){return R}),r.d(t,"cloneDeep",function(){return le}),r.d(t,"createFragmentMap",function(){return U}),r.d(t,"getDefaultValues",function(){return G}),r.d(t,"getDirectiveInfoFromField",function(){return M}),r.d(t,"getDirectiveNames",function(){return T}),r.d(t,"getDirectivesFromDocument",function(){return te}),r.d(t,"getEnv",function(){return de}),r.d(t,"getFragmentDefinition",function(){return V}),r.d(t,"getFragmentDefinitions",function(){return L}),r.d(t,"getFragmentQueryDocument",function(){return N}),r.d(t,"getInclusionDirectives",function(){return I}),r.d(t,"getMainDefinition",function(){return z}),r.d(t,"getMutationDefinition",function(){return O}),r.d(t,"getOperationDefinition",function(){return F}),r.d(t,"getOperationDefinitionOrDie",function(){return C}),r.d(t,"getOperationName",function(){return B}),r.d(t,"getQueryDefinition",function(){return j}),r.d(t,"getStoreKeyName",function(){return f}),r.d(t,"graphQLResultHasError",function(){return pe}),r.d(t,"hasClientExports",function(){return k}),r.d(t,"hasDirectives",function(){return S}),r.d(t,"isDevelopment",function(){return he}),r.d(t,"isEnv",function(){return ue}),r.d(t,"isField",function(){return _}),r.d(t,"isIdValue",function(){return b}),r.d(t,"isInlineFragment",function(){return g}),r.d(t,"isJsonValue",function(){return x}),r.d(t,"isNumberValue",function(){return u}),r.d(t,"isProduction",function(){return ce}),r.d(t,"isScalarValue",function(){return d}),r.d(t,"isTest",function(){return me}),r.d(t,"maybeDeepFreeze",function(){return ve}),r.d(t,"mergeDeep",function(){return ge}),r.d(t,"mergeDeepArray",function(){return be}),r.d(t,"removeArgumentsFromDocument",function(){return re}),r.d(t,"removeClientSetsFromDocument",function(){return ae}),r.d(t,"removeConnectionDirectiveFromDocument",function(){return J}),r.d(t,"removeDirectivesFromDocument",function(){return X}),r.d(t,"removeFragmentSpreadFromDocument",function(){return ie}),r.d(t,"resultKeyNameFromField",function(){return v}),r.d(t,"shouldInclude",function(){return A}),r.d(t,"storeKeyNameFromField",function(){return h}),r.d(t,"stripSymbols",function(){return Ae}),r.d(t,"toIdValue",function(){return y}),r.d(t,"tryFunctionOrLogError",function(){return fe}),r.d(t,"valueFromNode",function(){return E}),r.d(t,"valueToObjectRepresentation",function(){return c}),r.d(t,"variablesInOperation",function(){return q}),r.d(t,"warnOnceInDevelopment",function(){return Me});var i=r("./node_modules/graphql/language/visitor.js"),n=r("./node_modules/ts-invariant/lib/invariant.esm.js"),a=r("./node_modules/tslib/tslib.es6.js"),s=r("./node_modules/fast-json-stable-stringify/index.js"),o=r.n(s),l=r("./node_modules/@wry/equality/lib/equality.esm.js");function d(e){return["StringValue","BooleanValue","EnumValue"].indexOf(e.kind)>-1}function u(e){return["IntValue","FloatValue"].indexOf(e.kind)>-1}function c(e,t,r,i){if(function(e){return"IntValue"===e.kind}(r)||function(e){return"FloatValue"===e.kind}(r))e[t.value]=Number(r.value);else if(function(e){return"BooleanValue"===e.kind}(r)||function(e){return"StringValue"===e.kind}(r))e[t.value]=r.value;else if(function(e){return"ObjectValue"===e.kind}(r)){var a={};r.fields.map(function(e){return c(a,e.name,e.value,i)}),e[t.value]=a}else if(function(e){return"Variable"===e.kind}(r)){var s=(i||{})[r.name.value];e[t.value]=s}else if(function(e){return"ListValue"===e.kind}(r))e[t.value]=r.values.map(function(e){var r={};return c(r,t,e,i),r[t.value]});else if(function(e){return"EnumValue"===e.kind}(r))e[t.value]=r.value;else{if(!function(e){return"NullValue"===e.kind}(r))throw new n.InvariantError('The inline argument "'+t.value+'" of kind "'+r.kind+'"is not supported. Use variables instead of inline arguments to overcome this limitation.');e[t.value]=null}}function h(e,t){var r=null;e.directives&&(r={},e.directives.forEach(function(e){r[e.name.value]={},e.arguments&&e.arguments.forEach(function(i){var n=i.name,a=i.value;return c(r[e.name.value],n,a,t)})}));var i=null;return e.arguments&&e.arguments.length&&(i={},e.arguments.forEach(function(e){var r=e.name,n=e.value;return c(i,r,n,t)})),f(e.name.value,i,r)}r.d(t,"isEqual",function(){return l.equal});var m=["connection","include","skip","client","rest","export"];function f(e,t,r){if(r&&r.connection&&r.connection.key){if(r.connection.filter&&r.connection.filter.length>0){var i=r.connection.filter?r.connection.filter:[];i.sort();var n=t,a={};return i.forEach(function(e){a[e]=n[e]}),r.connection.key+"("+JSON.stringify(a)+")"}return r.connection.key}var s=e;if(t){var l=o()(t);s+="("+l+")"}return r&&Object.keys(r).forEach(function(e){-1===m.indexOf(e)&&(r[e]&&Object.keys(r[e]).length?s+="@"+e+"("+JSON.stringify(r[e])+")":s+="@"+e)}),s}function p(e,t){if(e.arguments&&e.arguments.length){var r={};return e.arguments.forEach(function(e){var i=e.name,n=e.value;return c(r,i,n,t)}),r}return null}function v(e){return e.alias?e.alias.value:e.name.value}function _(e){return"Field"===e.kind}function g(e){return"InlineFragment"===e.kind}function b(e){return e&&"id"===e.type&&"boolean"==typeof e.generated}function y(e,t){return void 0===t&&(t=!1),Object(a.__assign)({type:"id",generated:t},"string"==typeof e?{id:e,typename:void 0}:e)}function x(e){return null!=e&&"object"==typeof e&&"json"===e.type}function w(e){throw new n.InvariantError("Variable nodes are not supported by valueFromNode")}function E(e,t){switch(void 0===t&&(t=w),e.kind){case"Variable":return t(e);case"NullValue":return null;case"IntValue":return parseInt(e.value,10);case"FloatValue":return parseFloat(e.value);case"ListValue":return e.values.map(function(e){return E(e,t)});case"ObjectValue":for(var r={},i=0,n=e.fields;i<n.length;i++){var a=n[i];r[a.name.value]=E(a.value,t)}return r;default:return e.value}}function M(e,t){if(e.directives&&e.directives.length){var r={};return e.directives.forEach(function(e){r[e.name.value]=p(e,t)}),r}return null}function A(e,t){return void 0===t&&(t={}),I(e.directives).every(function(e){var r=e.directive,i=e.ifArgument,a=!1;return"Variable"===i.value.kind?(a=t[i.value.name.value],Object(n.invariant)(void 0!==a,"Invalid variable referenced in @"+r.name.value+" directive.")):a=i.value.value,"skip"===r.name.value?!a:a})}function T(e){var t=[];return Object(i.visit)(e,{Directive:function(e){t.push(e.name.value)}}),t}function S(e,t){return T(t).some(function(t){return e.indexOf(t)>-1})}function k(e){return e&&S(["client"],e)&&S(["export"],e)}function D(e){var t=e.name.value;return"skip"===t||"include"===t}function I(e){return e?e.filter(D).map(function(e){var t=e.arguments,r=e.name.value;Object(n.invariant)(t&&1===t.length,"Incorrect number of arguments for the @"+r+" directive.");var i=t[0];Object(n.invariant)(i.name&&"if"===i.name.value,"Invalid argument for the @"+r+" directive.");var a=i.value;return Object(n.invariant)(a&&("Variable"===a.kind||"BooleanValue"===a.kind),"Argument for the @"+r+" directive must be a variable or a boolean value."),{directive:e,ifArgument:i}}):[]}function N(e,t){var r=t,i=[];return e.definitions.forEach(function(e){if("OperationDefinition"===e.kind)throw new n.InvariantError("Found a "+e.operation+" operation"+(e.name?" named '"+e.name.value+"'":"")+". No operations are allowed when using a fragment as a query. Only fragments are allowed.");"FragmentDefinition"===e.kind&&i.push(e)}),void 0===r&&(Object(n.invariant)(1===i.length,"Found "+i.length+" fragments. `fragmentName` must be provided when there is not exactly 1 fragment."),r=i[0].name.value),Object(a.__assign)({},e,{definitions:[{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:r}}]}}].concat(e.definitions)})}function P(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(t){null!=t&&Object.keys(t).forEach(function(r){e[r]=t[r]})}),e}function O(e){R(e);var t=e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})[0];return Object(n.invariant)(t,"Must contain a mutation definition."),t}function R(e){Object(n.invariant)(e&&"Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql');var t=e.definitions.filter(function(e){return"FragmentDefinition"!==e.kind}).map(function(e){if("OperationDefinition"!==e.kind)throw new n.InvariantError('Schema type definitions not allowed in queries. Found: "'+e.kind+'"');return e});return Object(n.invariant)(t.length<=1,"Ambiguous GraphQL document: contains "+t.length+" operations"),e}function F(e){return R(e),e.definitions.filter(function(e){return"OperationDefinition"===e.kind})[0]}function C(e){var t=F(e);return Object(n.invariant)(t,"GraphQL document is missing an operation"),t}function B(e){return e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&e.name}).map(function(e){return e.name.value})[0]||null}function L(e){return e.definitions.filter(function(e){return"FragmentDefinition"===e.kind})}function j(e){var t=F(e);return Object(n.invariant)(t&&"query"===t.operation,"Must contain a query definition."),t}function V(e){Object(n.invariant)("Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql'),Object(n.invariant)(e.definitions.length<=1,"Fragment must have exactly one definition.");var t=e.definitions[0];return Object(n.invariant)("FragmentDefinition"===t.kind,"Must be a fragment definition."),t}function z(e){var t;R(e);for(var r=0,i=e.definitions;r<i.length;r++){var a=i[r];if("OperationDefinition"===a.kind){var s=a.operation;if("query"===s||"mutation"===s||"subscription"===s)return a}"FragmentDefinition"!==a.kind||t||(t=a)}if(t)return t;throw new n.InvariantError("Expected a parsed GraphQL query with a query, mutation, subscription, or a fragment.")}function U(e){void 0===e&&(e=[]);var t={};return e.forEach(function(e){t[e.name.value]=e}),t}function G(e){if(e&&e.variableDefinitions&&e.variableDefinitions.length){var t=e.variableDefinitions.filter(function(e){return e.defaultValue}).map(function(e){var t=e.variable,r=e.defaultValue,i={};return c(i,t.name,r),i});return P.apply(void 0,[{}].concat(t))}return{}}function q(e){var t=new Set;if(e.variableDefinitions)for(var r=0,i=e.variableDefinitions;r<i.length;r++){var n=i[r];t.add(n.variable.name.value)}return t}function Q(e,t,r){var i=0;return e.forEach(function(r,n){t.call(this,r,n,e)&&(e[i++]=r)},r),e.length=i,e}var H={kind:"Field",name:{kind:"Name",value:"__typename"}};function Y(e){return function e(t,r){return t.selectionSet.selections.every(function(t){return"FragmentSpread"===t.kind&&e(r[t.name.value],r)})}(F(e)||V(e),U(L(e)))?null:e}function W(e){return function(t){return e.some(function(e){return e.name&&e.name===t.name.value||e.test&&e.test(t)})}}function X(e,t){var r=Object.create(null),n=[],a=Object.create(null),s=[],o=Y(Object(i.visit)(t,{Variable:{enter:function(e,t,i){"VariableDefinition"!==i.kind&&(r[e.name.value]=!0)}},Field:{enter:function(t){if(e&&t.directives&&(e.some(function(e){return e.remove})&&t.directives&&t.directives.some(W(e))))return t.arguments&&t.arguments.forEach(function(e){"Variable"===e.value.kind&&n.push({name:e.value.name.value})}),t.selectionSet&&function e(t){var r=[];t.selections.forEach(function(t){(_(t)||g(t))&&t.selectionSet?e(t.selectionSet).forEach(function(e){return r.push(e)}):"FragmentSpread"===t.kind&&r.push(t)});return r}(t.selectionSet).forEach(function(e){s.push({name:e.name.value})}),null}},FragmentSpread:{enter:function(e){a[e.name.value]=!0}},Directive:{enter:function(t){if(W(e)(t))return null}}}));return o&&Q(n,function(e){return!r[e.name]}).length&&(o=re(n,o)),o&&Q(s,function(e){return!a[e.name]}).length&&(o=ie(s,o)),o}function Z(e){return Object(i.visit)(R(e),{SelectionSet:{enter:function(e,t,r){if(!r||"OperationDefinition"!==r.kind){var i=e.selections;if(i)if(!i.some(function(e){return _(e)&&("__typename"===e.name.value||0===e.name.value.lastIndexOf("__",0))})){var n=r;if(!(_(n)&&n.directives&&n.directives.some(function(e){return"export"===e.name.value})))return Object(a.__assign)({},e,{selections:i.concat([H])})}}}}})}var K={test:function(e){var t="connection"===e.name.value;return t&&(e.arguments&&e.arguments.some(function(e){return"key"===e.name.value})||n.invariant.warn("Removing an @connection directive even though it does not have a key. You may want to use the key parameter to specify a store key.")),t}};function J(e){return X([K],R(e))}function $(e,t,r){return void 0===r&&(r=!0),t&&t.selections&&t.selections.some(function(t){return ee(e,t,r)})}function ee(e,t,r){return void 0===r&&(r=!0),!_(t)||!!t.directives&&(t.directives.some(W(e))||r&&$(e,t.selectionSet,r))}function te(e,t){var r;return R(t),Y(Object(i.visit)(t,{SelectionSet:{enter:function(t,i,n,s){var o=s.join("-");if(!r||o===r||!o.startsWith(r)){if(t.selections){var l=t.selections.filter(function(t){return ee(e,t)});return $(e,t,!1)&&(r=o),Object(a.__assign)({},t,{selections:l})}return null}}}}))}function re(e,t){var r=function(e){return function(t){return e.some(function(e){return t.value&&"Variable"===t.value.kind&&t.value.name&&(e.name===t.value.name.value||e.test&&e.test(t))})}}(e);return Y(Object(i.visit)(t,{OperationDefinition:{enter:function(t){return Object(a.__assign)({},t,{variableDefinitions:t.variableDefinitions.filter(function(t){return!e.some(function(e){return e.name===t.variable.name.value})})})}},Field:{enter:function(t){if(e.some(function(e){return e.remove})){var i=0;if(t.arguments.forEach(function(e){r(e)&&(i+=1)}),1===i)return null}}},Argument:{enter:function(e){if(r(e))return null}}}))}function ie(e,t){function r(t){if(e.some(function(e){return e.name===t.name.value}))return null}return Y(Object(i.visit)(t,{FragmentSpread:{enter:r},FragmentDefinition:{enter:r}}))}function ne(e){return"query"===z(e).operation?e:Object(i.visit)(e,{OperationDefinition:{enter:function(e){return Object(a.__assign)({},e,{operation:"query"})}}})}function ae(e){R(e);var t=X([{test:function(e){return"client"===e.name.value},remove:!0}],e);return t&&(t=Object(i.visit)(t,{FragmentDefinition:{enter:function(e){if(e.selectionSet&&e.selectionSet.selections.every(function(e){return _(e)&&"__typename"===e.name.value}))return null}}})),t}var se="function"==typeof WeakMap&&!("object"==typeof navigator&&"ReactNative"===navigator.product),oe=Object.prototype.toString;function le(e){return function e(t,r){switch(oe.call(t)){case"[object Array]":if(r.has(t))return r.get(t);var i=t.slice(0);return r.set(t,i),i.forEach(function(t,n){i[n]=e(t,r)}),i;case"[object Object]":if(r.has(t))return r.get(t);var n=Object.create(Object.getPrototypeOf(t));return r.set(t,n),Object.keys(t).forEach(function(i){n[i]=e(t[i],r)}),n;default:return t}}(e,new Map)}function de(){return"development"}function ue(e){return"development"===e}function ce(){return!0===ue("production")}function he(){return!0===ue("development")}function me(){return!0===ue("test")}function fe(e){try{return e()}catch(e){console.error&&console.error(e)}}function pe(e){return e.errors&&e.errors.length}function ve(e){if((he()||me())&&!("function"==typeof Symbol&&"string"==typeof Symbol("")))return function e(t){return Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(r){null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||e(t[r])}),t}(e);return e}var _e=Object.prototype.hasOwnProperty;function ge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return be(e)}function be(e){var t=e[0]||{},r=e.length;if(r>1){var i=[];t=we(t,i);for(var n=1;n<r;++n)t=xe(t,e[n],i)}return t}function ye(e){return null!==e&&"object"==typeof e}function xe(e,t,r){return ye(t)&&ye(e)?(Object.isExtensible&&!Object.isExtensible(e)&&(e=we(e,r)),Object.keys(t).forEach(function(i){var n=t[i];if(_e.call(e,i)){var a=e[i];n!==a&&(e[i]=xe(we(a,r),n,r))}else e[i]=n}),e):t}function we(e,t){return null!==e&&"object"==typeof e&&t.indexOf(e)<0&&(e=Array.isArray(e)?e.slice(0):Object(a.__assign)({__proto__:Object.getPrototypeOf(e)},e),t.push(e)),e}var Ee=Object.create({});function Me(e,t){void 0===t&&(t="warn"),ce()||Ee[e]||(me()||(Ee[e]=!0),"error"===t?console.error(e):console.warn(e))}function Ae(e){return JSON.parse(JSON.stringify(e))}}.call(this,r("./node_modules/process/browser.js"))},"./node_modules/apollo-client/bundle.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"ApolloClient",function(){return I}),r.d(t,"ApolloError",function(){return v}),r.d(t,"FetchType",function(){return f}),r.d(t,"NetworkStatus",function(){return i}),r.d(t,"ObservableQuery",function(){return _}),r.d(t,"isApolloError",function(){return m});var i,n=r("./node_modules/tslib/tslib.es6.js"),a=r("./node_modules/apollo-client/node_modules/apollo-utilities/lib/bundle.esm.js"),s=r("./node_modules/apollo-link/lib/bundle.esm.js"),o=r("./node_modules/symbol-observable/es/index.js"),l=r("./node_modules/ts-invariant/lib/invariant.esm.js"),d=r("./node_modules/graphql/language/visitor.js");function u(e){return e<7}!function(e){e[e.loading=1]="loading",e[e.setVariables=2]="setVariables",e[e.fetchMore=3]="fetchMore",e[e.refetch=4]="refetch",e[e.poll=6]="poll",e[e.ready=7]="ready",e[e.error=8]="error"}(i||(i={}));var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype[o.default]=function(){return this},t.prototype["@@observable"]=function(){return this},t}(s.Observable);function h(e){return Array.isArray(e)&&e.length>0}function m(e){return e.hasOwnProperty("graphQLErrors")}var f,p=function(e){var t="";return h(e.graphQLErrors)&&e.graphQLErrors.forEach(function(e){var r=e?e.message:"Error message not found.";t+="GraphQL error: "+r+"\n"}),e.networkError&&(t+="Network error: "+e.networkError.message+"\n"),t=t.replace(/\n$/,"")},v=function(e){function t(r){var i=r.graphQLErrors,n=r.networkError,a=r.errorMessage,s=r.extraInfo,o=e.call(this,a)||this;return o.graphQLErrors=i||[],o.networkError=n||null,o.message=a||p(o),o.extraInfo=s,o.__proto__=t.prototype,o}return Object(n.__extends)(t,e),t}(Error);!function(e){e[e.normal=1]="normal",e[e.refetch=2]="refetch",e[e.poll=3]="poll"}(f||(f={}));var _=function(e){function t(t){var r=t.queryManager,i=t.options,n=t.shouldSubscribe,s=void 0===n||n,o=e.call(this,function(e){return o.onSubscribe(e)})||this;o.observers=new Set,o.subscriptions=new Set,o.isTornDown=!1,o.options=i,o.variables=i.variables||{},o.queryId=r.generateQueryId(),o.shouldSubscribe=s;var l=Object(a.getOperationDefinition)(i.query);return o.queryName=l&&l.name&&l.name.value,o.queryManager=r,o}return Object(n.__extends)(t,e),t.prototype.result=function(){var e=this;return new Promise(function(t,r){var i={next:function(r){t(r),e.observers.delete(i),e.observers.size||e.queryManager.removeQuery(e.queryId),setTimeout(function(){n.unsubscribe()},0)},error:r},n=e.subscribe(i)})},t.prototype.currentResult=function(){var e=this.getCurrentResult();return void 0===e.data&&(e.data={}),e},t.prototype.getCurrentResult=function(){if(this.isTornDown){var e=this.lastResult;return{data:!this.lastError&&e&&e.data||void 0,error:this.lastError,loading:!1,networkStatus:i.error}}var t,r,a,s=this.queryManager.getCurrentQueryResult(this),o=s.data,l=s.partial,d=this.queryManager.queryStore.get(this.queryId),c=this.options.fetchPolicy,m="network-only"===c||"no-cache"===c;if(d){var f=d.networkStatus;if(r=d,void 0===(a=this.options.errorPolicy)&&(a="none"),r&&(r.networkError||"none"===a&&h(r.graphQLErrors)))return{data:void 0,loading:!1,networkStatus:f,error:new v({graphQLErrors:d.graphQLErrors,networkError:d.networkError})};d.variables&&(this.options.variables=Object(n.__assign)({},this.options.variables,d.variables),this.variables=this.options.variables),t={data:o,loading:u(f),networkStatus:f},d.graphQLErrors&&"all"===this.options.errorPolicy&&(t.errors=d.graphQLErrors)}else{var p=m||l&&"cache-only"!==c;t={data:o,loading:p,networkStatus:p?i.loading:i.ready}}return l||this.updateLastResult(Object(n.__assign)({},t,{stale:!1})),Object(n.__assign)({},t,{partial:l})},t.prototype.isDifferentFromLastResult=function(e){var t=this.lastResultSnapshot;return!(t&&e&&t.networkStatus===e.networkStatus&&t.stale===e.stale&&Object(a.isEqual)(t.data,e.data))},t.prototype.getLastResult=function(){return this.lastResult},t.prototype.getLastError=function(){return this.lastError},t.prototype.resetLastResults=function(){delete this.lastResult,delete this.lastResultSnapshot,delete this.lastError,this.isTornDown=!1},t.prototype.resetQueryStoreErrors=function(){var e=this.queryManager.queryStore.get(this.queryId);e&&(e.networkError=null,e.graphQLErrors=[])},t.prototype.refetch=function(e){var t=this.options.fetchPolicy;return"cache-only"===t?Promise.reject(new l.InvariantError("cache-only fetchPolicy option should not be used together with query refetch.")):("no-cache"!==t&&"cache-and-network"!==t&&(t="network-only"),Object(a.isEqual)(this.variables,e)||(this.variables=Object(n.__assign)({},this.variables,e)),Object(a.isEqual)(this.options.variables,this.variables)||(this.options.variables=Object(n.__assign)({},this.options.variables,this.variables)),this.queryManager.fetchQuery(this.queryId,Object(n.__assign)({},this.options,{fetchPolicy:t}),f.refetch))},t.prototype.fetchMore=function(e){var t=this;Object(l.invariant)(e.updateQuery,"updateQuery option is required. This function defines how to update the query data with the new results.");var r=Object(n.__assign)({},e.query?e:Object(n.__assign)({},this.options,e,{variables:Object(n.__assign)({},this.variables,e.variables)}),{fetchPolicy:"network-only"}),i=this.queryManager.generateQueryId();return this.queryManager.fetchQuery(i,r,f.normal,this.queryId).then(function(n){return t.updateQuery(function(t){return e.updateQuery(t,{fetchMoreResult:n.data,variables:r.variables})}),t.queryManager.stopQuery(i),n},function(e){throw t.queryManager.stopQuery(i),e})},t.prototype.subscribeToMore=function(e){var t=this,r=this.queryManager.startGraphQLSubscription({query:e.document,variables:e.variables}).subscribe({next:function(r){var i=e.updateQuery;i&&t.updateQuery(function(e,t){var n=t.variables;return i(e,{subscriptionData:r,variables:n})})},error:function(t){e.onError?e.onError(t):l.invariant.error("Unhandled GraphQL subscription error",t)}});return this.subscriptions.add(r),function(){t.subscriptions.delete(r)&&r.unsubscribe()}},t.prototype.setOptions=function(e){var t=this.options.fetchPolicy;this.options=Object(n.__assign)({},this.options,e),e.pollInterval?this.startPolling(e.pollInterval):0===e.pollInterval&&this.stopPolling();var r=e.fetchPolicy;return this.setVariables(this.options.variables,t!==r&&("cache-only"===t||"standby"===t||"network-only"===r),e.fetchResults)},t.prototype.setVariables=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!0),this.isTornDown=!1,e=e||this.variables,!t&&Object(a.isEqual)(e,this.variables)?this.observers.size&&r?this.result():Promise.resolve():(this.variables=this.options.variables=e,this.observers.size?this.queryManager.fetchQuery(this.queryId,this.options):Promise.resolve())},t.prototype.updateQuery=function(e){var t=this.queryManager,r=t.getQueryWithPreviousResult(this.queryId),i=r.previousResult,n=r.variables,s=r.document,o=Object(a.tryFunctionOrLogError)(function(){return e(i,{variables:n})});o&&(t.dataStore.markUpdateQueryResult(s,n,o),t.broadcastQueries())},t.prototype.stopPolling=function(){this.queryManager.stopPollingQuery(this.queryId),this.options.pollInterval=void 0},t.prototype.startPolling=function(e){y(this),this.options.pollInterval=e,this.queryManager.startPollingQuery(this.options,this.queryId)},t.prototype.updateLastResult=function(e){var t=this.lastResult;return this.lastResult=e,this.lastResultSnapshot=this.queryManager.assumeImmutableResults?e:Object(a.cloneDeep)(e),t},t.prototype.onSubscribe=function(e){var t=this;try{var r=e._subscription._observer;r&&!r.error&&(r.error=g)}catch(e){}var i=!this.observers.size;return this.observers.add(e),e.next&&this.lastResult&&e.next(this.lastResult),e.error&&this.lastError&&e.error(this.lastError),i&&this.setUpQuery(),function(){t.observers.delete(e)&&!t.observers.size&&t.tearDownQuery()}},t.prototype.setUpQuery=function(){var e=this,t=this.queryManager,r=this.queryId;this.shouldSubscribe&&t.addObservableQuery(r,this),this.options.pollInterval&&(y(this),t.startPollingQuery(this.options,r));var i=function(t){b(e.observers,"error",e.lastError=t)};t.observeQuery(r,this.options,{next:function(r){if(e.lastError||e.isDifferentFromLastResult(r)){var i=e.updateLastResult(r),n=e.options,s=n.query,o=n.variables,l=n.fetchPolicy;t.transform(s).hasClientExports?t.getLocalState().addExportedVariables(s,o).then(function(n){var o=e.variables;e.variables=e.options.variables=n,!r.loading&&i&&"cache-only"!==l&&t.transform(s).serverQuery&&!Object(a.isEqual)(o,n)?e.refetch():b(e.observers,"next",r)}):b(e.observers,"next",r)}},error:i}).catch(i)},t.prototype.tearDownQuery=function(){var e=this.queryManager;this.isTornDown=!0,e.stopPollingQuery(this.queryId),this.subscriptions.forEach(function(e){return e.unsubscribe()}),this.subscriptions.clear(),e.removeObservableQuery(this.queryId),e.stopQuery(this.queryId),this.observers.clear()},t}(c);function g(e){l.invariant.error("Unhandled error",e.message,e.stack)}function b(e,t,r){var i=[];e.forEach(function(e){return e[t]&&i.push(e)}),i.forEach(function(e){return e[t](r)})}function y(e){var t=e.options.fetchPolicy;Object(l.invariant)("cache-first"!==t&&"cache-only"!==t,"Queries that specify the cache-first and cache-only fetchPolicies cannot also be polling queries.")}var x=function(){function e(){this.store={}}return e.prototype.getStore=function(){return this.store},e.prototype.get=function(e){return this.store[e]},e.prototype.initMutation=function(e,t,r){this.store[e]={mutation:t,variables:r||{},loading:!0,error:null}},e.prototype.markMutationError=function(e,t){var r=this.store[e];r&&(r.loading=!1,r.error=t)},e.prototype.markMutationResult=function(e){var t=this.store[e];t&&(t.loading=!1,t.error=null)},e.prototype.reset=function(){this.store={}},e}(),w=function(){function e(){this.store={}}return e.prototype.getStore=function(){return this.store},e.prototype.get=function(e){return this.store[e]},e.prototype.initQuery=function(e){var t=this.store[e.queryId];Object(l.invariant)(!t||t.document===e.document||Object(a.isEqual)(t.document,e.document),"Internal Error: may not update existing query string in store");var r,n=!1,s=null;e.storePreviousVariables&&t&&t.networkStatus!==i.loading&&(Object(a.isEqual)(t.variables,e.variables)||(n=!0,s=t.variables)),r=n?i.setVariables:e.isPoll?i.poll:e.isRefetch?i.refetch:i.loading;var o=[];t&&t.graphQLErrors&&(o=t.graphQLErrors),this.store[e.queryId]={document:e.document,variables:e.variables,previousVariables:s,networkError:null,graphQLErrors:o,networkStatus:r,metadata:e.metadata},"string"==typeof e.fetchMoreForQueryId&&this.store[e.fetchMoreForQueryId]&&(this.store[e.fetchMoreForQueryId].networkStatus=i.fetchMore)},e.prototype.markQueryResult=function(e,t,r){this.store&&this.store[e]&&(this.store[e].networkError=null,this.store[e].graphQLErrors=h(t.errors)?t.errors:[],this.store[e].previousVariables=null,this.store[e].networkStatus=i.ready,"string"==typeof r&&this.store[r]&&(this.store[r].networkStatus=i.ready))},e.prototype.markQueryError=function(e,t,r){this.store&&this.store[e]&&(this.store[e].networkError=t,this.store[e].networkStatus=i.error,"string"==typeof r&&this.markQueryResultClient(r,!0))},e.prototype.markQueryResultClient=function(e,t){var r=this.store&&this.store[e];r&&(r.networkError=null,r.previousVariables=null,t&&(r.networkStatus=i.ready))},e.prototype.stopQuery=function(e){delete this.store[e]},e.prototype.reset=function(e){var t=this;Object.keys(this.store).forEach(function(r){e.indexOf(r)<0?t.stopQuery(r):t.store[r].networkStatus=i.loading})},e}();var E=function(){function e(e){var t=e.cache,r=e.client,i=e.resolvers,n=e.fragmentMatcher;this.cache=t,r&&(this.client=r),i&&this.addResolvers(i),n&&this.setFragmentMatcher(n)}return e.prototype.addResolvers=function(e){var t=this;this.resolvers=this.resolvers||{},Array.isArray(e)?e.forEach(function(e){t.resolvers=Object(a.mergeDeep)(t.resolvers,e)}):this.resolvers=Object(a.mergeDeep)(this.resolvers,e)},e.prototype.setResolvers=function(e){this.resolvers={},this.addResolvers(e)},e.prototype.getResolvers=function(){return this.resolvers||{}},e.prototype.runResolvers=function(e){var t=e.document,r=e.remoteResult,i=e.context,a=e.variables,s=e.onlyRunForcedResolvers,o=void 0!==s&&s;return Object(n.__awaiter)(this,void 0,void 0,function(){return Object(n.__generator)(this,function(e){return t?[2,this.resolveDocument(t,r.data,i,a,this.fragmentMatcher,o).then(function(e){return Object(n.__assign)({},r,{data:e.result})})]:[2,r]})})},e.prototype.setFragmentMatcher=function(e){this.fragmentMatcher=e},e.prototype.getFragmentMatcher=function(){return this.fragmentMatcher},e.prototype.clientQuery=function(e){if(Object(a.hasDirectives)(["client"],e)){if(this.resolvers)return e;l.invariant.warn("Found @client directives in a query but no ApolloClient resolvers were specified. This means ApolloClient local resolver handling has been disabled, and @client directives will be passed through to your link chain.")}return null},e.prototype.serverQuery=function(e){return this.resolvers?Object(a.removeClientSetsFromDocument)(e):e},e.prototype.prepareContext=function(e){void 0===e&&(e={});var t=this.cache;return Object(n.__assign)({},e,{cache:t,getCacheKey:function(e){if(t.config)return t.config.dataIdFromObject(e);Object(l.invariant)(!1,"To use context.getCacheKey, you need to use a cache that has a configurable dataIdFromObject, like apollo-cache-inmemory.")}})},e.prototype.addExportedVariables=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r={}),Object(n.__awaiter)(this,void 0,void 0,function(){return Object(n.__generator)(this,function(i){return e?[2,this.resolveDocument(e,this.buildRootValueFromCache(e,t)||{},this.prepareContext(r),t).then(function(e){return Object(n.__assign)({},t,e.exportedVariables)})]:[2,Object(n.__assign)({},t)]})})},e.prototype.shouldForceResolvers=function(e){var t=!1;return Object(d.visit)(e,{Directive:{enter:function(e){if("client"===e.name.value&&e.arguments&&(t=e.arguments.some(function(e){return"always"===e.name.value&&"BooleanValue"===e.value.kind&&!0===e.value.value})))return d.BREAK}}}),t},e.prototype.buildRootValueFromCache=function(e,t){return this.cache.diff({query:Object(a.buildQueryFromSelectionSet)(e),variables:t,returnPartialData:!0,optimistic:!1}).result},e.prototype.resolveDocument=function(e,t,r,i,s,o){return void 0===r&&(r={}),void 0===i&&(i={}),void 0===s&&(s=function(){return!0}),void 0===o&&(o=!1),Object(n.__awaiter)(this,void 0,void 0,function(){var l,d,u,c,h,m,f,p,v;return Object(n.__generator)(this,function(_){var g;return l=Object(a.getMainDefinition)(e),d=Object(a.getFragmentDefinitions)(e),u=Object(a.createFragmentMap)(d),c=l.operation,h=c?(g=c).charAt(0).toUpperCase()+g.slice(1):"Query",f=(m=this).cache,p=m.client,v={fragmentMap:u,context:Object(n.__assign)({},r,{cache:f,client:p}),variables:i,fragmentMatcher:s,defaultOperationType:h,exportedVariables:{},onlyRunForcedResolvers:o},[2,this.resolveSelectionSet(l.selectionSet,t,v).then(function(e){return{result:e,exportedVariables:v.exportedVariables}})]})})},e.prototype.resolveSelectionSet=function(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,function(){var i,s,o,d,u,c=this;return Object(n.__generator)(this,function(h){return i=r.fragmentMap,s=r.context,o=r.variables,d=[t],u=function(e){return Object(n.__awaiter)(c,void 0,void 0,function(){var u,c;return Object(n.__generator)(this,function(n){return Object(a.shouldInclude)(e,o)?Object(a.isField)(e)?[2,this.resolveField(e,t,r).then(function(t){var r;void 0!==t&&d.push(((r={})[Object(a.resultKeyNameFromField)(e)]=t,r))})]:(Object(a.isInlineFragment)(e)?u=e:(u=i[e.name.value],Object(l.invariant)(u,"No fragment named "+e.name.value)),u&&u.typeCondition&&(c=u.typeCondition.name.value,r.fragmentMatcher(t,c,s))?[2,this.resolveSelectionSet(u.selectionSet,t,r).then(function(e){d.push(e)})]:[2]):[2]})})},[2,Promise.all(e.selections.map(u)).then(function(){return Object(a.mergeDeepArray)(d)})]})})},e.prototype.resolveField=function(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,function(){var i,s,o,l,d,u,c,h,m,f=this;return Object(n.__generator)(this,function(n){return i=r.variables,s=e.name.value,o=Object(a.resultKeyNameFromField)(e),l=s!==o,d=t[o]||t[s],u=Promise.resolve(d),r.onlyRunForcedResolvers&&!this.shouldForceResolvers(e)||(c=t.__typename||r.defaultOperationType,(h=this.resolvers&&this.resolvers[c])&&(m=h[l?s:o])&&(u=Promise.resolve(m(t,Object(a.argumentsObjectFromField)(e,i),r.context,{field:e})))),[2,u.then(function(t){return void 0===t&&(t=d),e.directives&&e.directives.forEach(function(e){"export"===e.name.value&&e.arguments&&e.arguments.forEach(function(e){"as"===e.name.value&&"StringValue"===e.value.kind&&(r.exportedVariables[e.value.value]=t)})}),e.selectionSet?null==t?t:Array.isArray(t)?f.resolveSubSelectedArray(e,t,r):e.selectionSet?f.resolveSelectionSet(e.selectionSet,t,r):void 0:t})]})})},e.prototype.resolveSubSelectedArray=function(e,t,r){var i=this;return Promise.all(t.map(function(t){return null===t?null:Array.isArray(t)?i.resolveSubSelectedArray(e,t,r):e.selectionSet?i.resolveSelectionSet(e.selectionSet,t,r):void 0}))},e}();function M(e){var t=new Set,r=null;return new c(function(i){return t.add(i),r=r||e.subscribe({next:function(e){t.forEach(function(t){return t.next&&t.next(e)})},error:function(e){t.forEach(function(t){return t.error&&t.error(e)})},complete:function(){t.forEach(function(e){return e.complete&&e.complete()})}}),function(){t.delete(i)&&!t.size&&r&&(r.unsubscribe(),r=null)}})}var A=Object.prototype.hasOwnProperty,T=function(){function e(e){var t=e.link,r=e.queryDeduplication,i=void 0!==r&&r,n=e.store,s=e.onBroadcast,o=void 0===s?function(){}:s,l=e.ssrMode,d=void 0!==l&&l,u=e.clientAwareness,c=void 0===u?{}:u,h=e.localState,m=e.assumeImmutableResults;this.mutationStore=new x,this.queryStore=new w,this.clientAwareness={},this.idCounter=1,this.queries=new Map,this.fetchQueryRejectFns=new Map,this.transformCache=new(a.canUseWeakMap?WeakMap:Map),this.inFlightLinkObservables=new Map,this.pollingInfoByQueryId=new Map,this.link=t,this.queryDeduplication=i,this.dataStore=n,this.onBroadcast=o,this.clientAwareness=c,this.localState=h||new E({cache:n.getCache()}),this.ssrMode=d,this.assumeImmutableResults=!!m}return e.prototype.stop=function(){var e=this;this.queries.forEach(function(t,r){e.stopQueryNoBroadcast(r)}),this.fetchQueryRejectFns.forEach(function(e){e(new l.InvariantError("QueryManager stopped while query was in flight"))})},e.prototype.mutate=function(e){var t=e.mutation,r=e.variables,i=e.optimisticResponse,s=e.updateQueries,o=e.refetchQueries,d=void 0===o?[]:o,u=e.awaitRefetchQueries,c=void 0!==u&&u,m=e.update,f=e.errorPolicy,p=void 0===f?"none":f,_=e.fetchPolicy,g=e.context,b=void 0===g?{}:g;return Object(n.__awaiter)(this,void 0,void 0,function(){var e,o,u,f=this;return Object(n.__generator)(this,function(g){switch(g.label){case 0:return Object(l.invariant)(t,"mutation option is required. You must specify your GraphQL document in the mutation option."),Object(l.invariant)(!_||"no-cache"===_,"fetchPolicy for mutations currently only supports the 'no-cache' policy"),e=this.generateQueryId(),t=this.transform(t).document,this.setQuery(e,function(){return{document:t}}),r=this.getVariables(t,r),this.transform(t).hasClientExports?[4,this.localState.addExportedVariables(t,r,b)]:[3,2];case 1:r=g.sent(),g.label=2;case 2:return o=function(){var e={};return s&&f.queries.forEach(function(t,r){var i=t.observableQuery;if(i){var n=i.queryName;n&&A.call(s,n)&&(e[r]={updater:s[n],query:f.queryStore.get(r)})}}),e},this.mutationStore.initMutation(e,t,r),this.dataStore.markMutationInit({mutationId:e,document:t,variables:r,updateQueries:o(),update:m,optimisticResponse:i}),this.broadcastQueries(),u=this,[2,new Promise(function(s,l){var f,g;u.getObservableFromLink(t,Object(n.__assign)({},b,{optimisticResponse:i}),r,!1).subscribe({next:function(i){Object(a.graphQLResultHasError)(i)&&"none"===p?g=new v({graphQLErrors:i.errors}):(u.mutationStore.markMutationResult(e),"no-cache"!==_&&u.dataStore.markMutationResult({mutationId:e,result:i,document:t,variables:r,updateQueries:o(),update:m}),f=i)},error:function(t){u.mutationStore.markMutationError(e,t),u.dataStore.markMutationComplete({mutationId:e,optimisticResponse:i}),u.broadcastQueries(),u.setQuery(e,function(){return{document:null}}),l(new v({networkError:t}))},complete:function(){if(g&&u.mutationStore.markMutationError(e,g),u.dataStore.markMutationComplete({mutationId:e,optimisticResponse:i}),u.broadcastQueries(),g)l(g);else{"function"==typeof d&&(d=d(f));var t=[];h(d)&&d.forEach(function(e){if("string"==typeof e)u.queries.forEach(function(r){var i=r.observableQuery;i&&i.queryName===e&&t.push(i.refetch())});else{var r={query:e.query,variables:e.variables,fetchPolicy:"network-only"};e.context&&(r.context=e.context),t.push(u.query(r))}}),Promise.all(c?t:[]).then(function(){u.setQuery(e,function(){return{document:null}}),"ignore"===p&&f&&Object(a.graphQLResultHasError)(f)&&delete f.errors,s(f)})}}})})]}})})},e.prototype.fetchQuery=function(e,t,r,i){return Object(n.__awaiter)(this,void 0,void 0,function(){var s,o,l,d,u,c,h,p,_,g,b,y,x,w,E,M,A,T,S=this;return Object(n.__generator)(this,function(k){switch(k.label){case 0:return s=t.metadata,o=void 0===s?null:s,l=t.fetchPolicy,d=void 0===l?"cache-first":l,u=t.context,c=void 0===u?{}:u,h=this.transform(t.query).document,p=this.getVariables(h,t.variables),this.transform(h).hasClientExports?[4,this.localState.addExportedVariables(h,p,c)]:[3,2];case 1:p=k.sent(),k.label=2;case 2:if(t=Object(n.__assign)({},t,{variables:p}),b=g="network-only"===d||"no-cache"===d,g||(y=this.dataStore.getCache().diff({query:h,variables:p,returnPartialData:!0,optimistic:!1}),x=y.complete,w=y.result,b=!x||"cache-and-network"===d,_=w),E=b&&"cache-only"!==d&&"standby"!==d,Object(a.hasDirectives)(["live"],h)&&(E=!0),M=this.idCounter++,A="no-cache"!==d?this.updateQueryWatch(e,h,t):void 0,this.setQuery(e,function(){return{document:h,lastRequestId:M,invalidated:!0,cancel:A}}),this.invalidate(i),this.queryStore.initQuery({queryId:e,document:h,storePreviousVariables:E,variables:p,isPoll:r===f.poll,isRefetch:r===f.refetch,metadata:o,fetchMoreForQueryId:i}),this.broadcastQueries(),E){if(T=this.fetchRequest({requestId:M,queryId:e,document:h,options:t,fetchMoreForQueryId:i}).catch(function(t){throw m(t)?t:(M>=S.getQuery(e).lastRequestId&&(S.queryStore.markQueryError(e,t,i),S.invalidate(e),S.invalidate(i),S.broadcastQueries()),new v({networkError:t}))}),"cache-and-network"!==d)return[2,T];T.catch(function(){})}return this.queryStore.markQueryResultClient(e,!E),this.invalidate(e),this.invalidate(i),this.transform(h).hasForcedResolvers?[2,this.localState.runResolvers({document:h,remoteResult:{data:_},context:c,variables:p,onlyRunForcedResolvers:!0}).then(function(r){return S.markQueryResult(e,r,t,i),S.broadcastQueries(),r})]:(this.broadcastQueries(),[2,{data:_}])}})})},e.prototype.markQueryResult=function(e,t,r,i){var n=r.fetchPolicy,a=r.variables,s=r.errorPolicy;"no-cache"===n?this.setQuery(e,function(){return{newData:{result:t.data,complete:!0}}}):this.dataStore.markQueryResult(t,this.getQuery(e).document,a,i,"ignore"===s||"all"===s)},e.prototype.queryListenerForObserver=function(e,t,r){var i=this;function n(e,t){if(r[e])try{r[e](t)}catch(e){l.invariant.error(e)}else"error"===e&&l.invariant.error(t)}return function(r,a){if(i.invalidate(e,!1),r){var s=i.getQuery(e),o=s.observableQuery,l=s.document,d=o?o.options.fetchPolicy:t.fetchPolicy;if("standby"!==d){var c=u(r.networkStatus),m=o&&o.getLastResult(),f=!(!m||m.networkStatus===r.networkStatus),p=t.returnPartialData||!a&&r.previousVariables||f&&t.notifyOnNetworkStatusChange||"cache-only"===d||"cache-and-network"===d;if(!c||p){var _=h(r.graphQLErrors),g=o&&o.options.errorPolicy||t.errorPolicy||"none";if("none"===g&&_||r.networkError)return n("error",new v({graphQLErrors:r.graphQLErrors,networkError:r.networkError}));try{var b=void 0,y=void 0;if(a)"no-cache"!==d&&"network-only"!==d&&i.setQuery(e,function(){return{newData:null}}),b=a.result,y=!a.complete;else{var x=o&&o.getLastError(),w="none"!==g&&(x&&x.graphQLErrors)!==r.graphQLErrors;if(m&&m.data&&!w)b=m.data,y=!1;else{var E=i.dataStore.getCache().diff({query:l,variables:r.previousVariables||r.variables,returnPartialData:!0,optimistic:!0});b=E.result,y=!E.complete}}var M=y&&!(t.returnPartialData||"cache-only"===d),A={data:M?m&&m.data:b,loading:c,networkStatus:r.networkStatus,stale:M};"all"===g&&_&&(A.errors=r.graphQLErrors),n("next",A)}catch(e){n("error",new v({networkError:e}))}}}}}},e.prototype.transform=function(e){var t=this.transformCache;if(!t.has(e)){var r=this.dataStore.getCache(),i=r.transformDocument(e),n=Object(a.removeConnectionDirectiveFromDocument)(r.transformForLink(i)),s=this.localState.clientQuery(i),o=this.localState.serverQuery(n),l={document:i,hasClientExports:Object(a.hasClientExports)(i),hasForcedResolvers:this.localState.shouldForceResolvers(i),clientQuery:s,serverQuery:o,defaultVars:Object(a.getDefaultValues)(Object(a.getOperationDefinition)(i))},d=function(e){e&&!t.has(e)&&t.set(e,l)};d(e),d(i),d(s),d(o)}return t.get(e)},e.prototype.getVariables=function(e,t){return Object(n.__assign)({},this.transform(e).defaultVars,t)},e.prototype.watchQuery=function(e,t){void 0===t&&(t=!0),Object(l.invariant)("standby"!==e.fetchPolicy,'client.watchQuery cannot be called with fetchPolicy set to "standby"'),e.variables=this.getVariables(e.query,e.variables),void 0===e.notifyOnNetworkStatusChange&&(e.notifyOnNetworkStatusChange=!1);var r=Object(n.__assign)({},e);return new _({queryManager:this,options:r,shouldSubscribe:t})},e.prototype.query=function(e){var t=this;return Object(l.invariant)(e.query,"query option is required. You must specify your GraphQL document in the query option."),Object(l.invariant)("Document"===e.query.kind,'You must wrap the query string in a "gql" tag.'),Object(l.invariant)(!e.returnPartialData,"returnPartialData option only supported on watchQuery."),Object(l.invariant)(!e.pollInterval,"pollInterval option only supported on watchQuery."),new Promise(function(r,i){var n=t.watchQuery(e,!1);t.fetchQueryRejectFns.set("query:"+n.queryId,i),n.result().then(r,i).then(function(){return t.fetchQueryRejectFns.delete("query:"+n.queryId)})})},e.prototype.generateQueryId=function(){return String(this.idCounter++)},e.prototype.stopQueryInStore=function(e){this.stopQueryInStoreNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryInStoreNoBroadcast=function(e){this.stopPollingQuery(e),this.queryStore.stopQuery(e),this.invalidate(e)},e.prototype.addQueryListener=function(e,t){this.setQuery(e,function(e){return e.listeners.add(t),{invalidated:!1}})},e.prototype.updateQueryWatch=function(e,t,r){var i=this,n=this.getQuery(e).cancel;n&&n();return this.dataStore.getCache().watch({query:t,variables:r.variables,optimistic:!0,previousResult:function(){var t=null,r=i.getQuery(e).observableQuery;if(r){var n=r.getLastResult();n&&(t=n.data)}return t},callback:function(t){i.setQuery(e,function(){return{invalidated:!0,newData:t}})}})},e.prototype.addObservableQuery=function(e,t){this.setQuery(e,function(){return{observableQuery:t}})},e.prototype.removeObservableQuery=function(e){var t=this.getQuery(e).cancel;this.setQuery(e,function(){return{observableQuery:null}}),t&&t()},e.prototype.clearStore=function(){this.fetchQueryRejectFns.forEach(function(e){e(new l.InvariantError("Store reset while query was in flight (not completed in link chain)"))});var e=[];return this.queries.forEach(function(t,r){t.observableQuery&&e.push(r)}),this.queryStore.reset(e),this.mutationStore.reset(),this.dataStore.reset()},e.prototype.resetStore=function(){var e=this;return this.clearStore().then(function(){return e.reFetchObservableQueries()})},e.prototype.reFetchObservableQueries=function(e){var t=this;void 0===e&&(e=!1);var r=[];return this.queries.forEach(function(i,n){var a=i.observableQuery;if(a){var s=a.options.fetchPolicy;a.resetLastResults(),"cache-only"===s||!e&&"standby"===s||r.push(a.refetch()),t.setQuery(n,function(){return{newData:null}}),t.invalidate(n)}}),this.broadcastQueries(),Promise.all(r)},e.prototype.observeQuery=function(e,t,r){return this.addQueryListener(e,this.queryListenerForObserver(e,t,r)),this.fetchQuery(e,t)},e.prototype.startQuery=function(e,t,r){return l.invariant.warn("The QueryManager.startQuery method has been deprecated"),this.addQueryListener(e,r),this.fetchQuery(e,t).catch(function(){}),e},e.prototype.startGraphQLSubscription=function(e){var t=this,r=e.query,i=e.fetchPolicy,n=e.variables;r=this.transform(r).document,n=this.getVariables(r,n);var s=function(e){return t.getObservableFromLink(r,{},e,!1).map(function(n){if(i&&"no-cache"===i||(t.dataStore.markSubscriptionResult(n,r,e),t.broadcastQueries()),Object(a.graphQLResultHasError)(n))throw new v({graphQLErrors:n.errors});return n})};if(this.transform(r).hasClientExports){var o=this.localState.addExportedVariables(r,n).then(s);return new c(function(e){var t=null;return o.then(function(r){return t=r.subscribe(e)},e.error),function(){return t&&t.unsubscribe()}})}return s(n)},e.prototype.stopQuery=function(e){this.stopQueryNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryNoBroadcast=function(e){this.stopQueryInStoreNoBroadcast(e),this.removeQuery(e)},e.prototype.removeQuery=function(e){this.fetchQueryRejectFns.delete("query:"+e),this.fetchQueryRejectFns.delete("fetchRequest:"+e),this.getQuery(e).subscriptions.forEach(function(e){return e.unsubscribe()}),this.queries.delete(e)},e.prototype.getCurrentQueryResult=function(e,t){void 0===t&&(t=!0);var r=e.options,i=r.variables,n=r.query,a=r.fetchPolicy,s=r.returnPartialData,o=e.getLastResult(),l=this.getQuery(e.queryId).newData;if(l&&l.complete)return{data:l.result,partial:!1};if("no-cache"===a||"network-only"===a)return{data:void 0,partial:!1};var d=this.dataStore.getCache().diff({query:n,variables:i,previousResult:o?o.data:void 0,returnPartialData:!0,optimistic:t}),u=d.result,c=d.complete;return{data:c||s?u:void 0,partial:!c}},e.prototype.getQueryWithPreviousResult=function(e){var t;if("string"==typeof e){var r=this.getQuery(e).observableQuery;Object(l.invariant)(r,"ObservableQuery with this id doesn't exist: "+e),t=r}else t=e;var i=t.options,n=i.variables,a=i.query;return{previousResult:this.getCurrentQueryResult(t,!1).data,variables:n,document:a}},e.prototype.broadcastQueries=function(){var e=this;this.onBroadcast(),this.queries.forEach(function(t,r){t.invalidated&&t.listeners.forEach(function(i){i&&i(e.queryStore.get(r),t.newData)})})},e.prototype.getLocalState=function(){return this.localState},e.prototype.getObservableFromLink=function(e,t,r,i){var o,l=this;void 0===i&&(i=this.queryDeduplication);var d=this.transform(e).serverQuery;if(d){var u=this.inFlightLinkObservables,h=this.link,m={query:d,variables:r,operationName:Object(a.getOperationName)(d)||void 0,context:this.prepareContext(Object(n.__assign)({},t,{forceFetch:!i}))};if(t=m.context,i){var f=u.get(d)||new Map;u.set(d,f);var p=JSON.stringify(r);if(!(o=f.get(p))){f.set(p,o=M(Object(s.execute)(h,m)));var v=function(){f.delete(p),f.size||u.delete(d),_.unsubscribe()},_=o.subscribe({next:v,error:v,complete:v})}}else o=M(Object(s.execute)(h,m))}else o=c.of({data:{}}),t=this.prepareContext(t);var g=this.transform(e).clientQuery;return g&&(o=function(e,t){return new c(function(r){var i=r.next,n=r.error,a=r.complete,s=0,o=!1,l={next:function(e){++s,new Promise(function(r){r(t(e))}).then(function(e){--s,i&&i.call(r,e),o&&l.complete()},function(e){--s,n&&n.call(r,e)})},error:function(e){n&&n.call(r,e)},complete:function(){o=!0,s||a&&a.call(r)}},d=e.subscribe(l);return function(){return d.unsubscribe()}})}(o,function(e){return l.localState.runResolvers({document:g,remoteResult:e,context:t,variables:r})})),o},e.prototype.fetchRequest=function(e){var t,r,n=this,a=e.requestId,s=e.queryId,o=e.document,l=e.options,d=e.fetchMoreForQueryId,u=l.variables,c=l.errorPolicy,m=void 0===c?"none":c,f=l.fetchPolicy;return new Promise(function(e,c){var p=n.getObservableFromLink(o,l.context,u),_="fetchRequest:"+s;n.fetchQueryRejectFns.set(_,c);var g=function(){n.fetchQueryRejectFns.delete(_),n.setQuery(s,function(e){e.subscriptions.delete(b)})},b=p.map(function(e){if(a>=n.getQuery(s).lastRequestId&&(n.markQueryResult(s,e,l,d),n.queryStore.markQueryResult(s,e,d),n.invalidate(s),n.invalidate(d),n.broadcastQueries()),"none"===m&&h(e.errors))return c(new v({graphQLErrors:e.errors}));if("all"===m&&(r=e.errors),d||"no-cache"===f)t=e.data;else{var i=n.dataStore.getCache().diff({variables:u,query:o,optimistic:!1,returnPartialData:!0}),p=i.result;(i.complete||l.returnPartialData)&&(t=p)}}).subscribe({error:function(e){g(),c(e)},complete:function(){g(),e({data:t,errors:r,loading:!1,networkStatus:i.ready,stale:!1})}});n.setQuery(s,function(e){e.subscriptions.add(b)})})},e.prototype.getQuery=function(e){return this.queries.get(e)||{listeners:new Set,invalidated:!1,document:null,newData:null,lastRequestId:1,observableQuery:null,subscriptions:new Set}},e.prototype.setQuery=function(e,t){var r=this.getQuery(e),i=Object(n.__assign)({},r,t(r));this.queries.set(e,i)},e.prototype.invalidate=function(e,t){void 0===t&&(t=!0),e&&this.setQuery(e,function(){return{invalidated:t}})},e.prototype.prepareContext=function(e){void 0===e&&(e={});var t=this.localState.prepareContext(e);return Object(n.__assign)({},t,{clientAwareness:this.clientAwareness})},e.prototype.checkInFlight=function(e){var t=this.queryStore.get(e);return t&&t.networkStatus!==i.ready&&t.networkStatus!==i.error},e.prototype.startPollingQuery=function(e,t,r){var i=this,a=e.pollInterval;if(Object(l.invariant)(a,"Attempted to start a polling query without a polling interval."),!this.ssrMode){var s=this.pollingInfoByQueryId.get(t);s||this.pollingInfoByQueryId.set(t,s={}),s.interval=a,s.options=Object(n.__assign)({},e,{fetchPolicy:"network-only"});var o=function(){var e=i.pollingInfoByQueryId.get(t);e&&(i.checkInFlight(t)?d():i.fetchQuery(t,e.options,f.poll).then(d,d))},d=function(){var e=i.pollingInfoByQueryId.get(t);e&&(clearTimeout(e.timeout),e.timeout=setTimeout(o,e.interval))};r&&this.addQueryListener(t,r),d()}return t},e.prototype.stopPollingQuery=function(e){this.pollingInfoByQueryId.delete(e)},e}(),S=function(){function e(e){this.cache=e}return e.prototype.getCache=function(){return this.cache},e.prototype.markQueryResult=function(e,t,r,i,n){void 0===n&&(n=!1);var s=!Object(a.graphQLResultHasError)(e);n&&Object(a.graphQLResultHasError)(e)&&e.data&&(s=!0),!i&&s&&this.cache.write({result:e.data,dataId:"ROOT_QUERY",query:t,variables:r})},e.prototype.markSubscriptionResult=function(e,t,r){Object(a.graphQLResultHasError)(e)||this.cache.write({result:e.data,dataId:"ROOT_SUBSCRIPTION",query:t,variables:r})},e.prototype.markMutationInit=function(e){var t,r=this;e.optimisticResponse&&(t="function"==typeof e.optimisticResponse?e.optimisticResponse(e.variables):e.optimisticResponse,this.cache.recordOptimisticTransaction(function(i){var n=r.cache;r.cache=i;try{r.markMutationResult({mutationId:e.mutationId,result:{data:t},document:e.document,variables:e.variables,updateQueries:e.updateQueries,update:e.update})}finally{r.cache=n}},e.mutationId))},e.prototype.markMutationResult=function(e){var t=this;if(!Object(a.graphQLResultHasError)(e.result)){var r=[{result:e.result.data,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}],i=e.updateQueries;i&&Object.keys(i).forEach(function(n){var s=i[n],o=s.query,l=s.updater,d=t.cache.diff({query:o.document,variables:o.variables,returnPartialData:!0,optimistic:!1}),u=d.result;if(d.complete){var c=Object(a.tryFunctionOrLogError)(function(){return l(u,{mutationResult:e.result,queryName:Object(a.getOperationName)(o.document)||void 0,queryVariables:o.variables})});c&&r.push({result:c,dataId:"ROOT_QUERY",query:o.document,variables:o.variables})}}),this.cache.performTransaction(function(t){r.forEach(function(e){return t.write(e)});var i=e.update;i&&Object(a.tryFunctionOrLogError)(function(){return i(t,e.result)})})}},e.prototype.markMutationComplete=function(e){var t=e.mutationId;e.optimisticResponse&&this.cache.removeOptimistic(t)},e.prototype.markUpdateQueryResult=function(e,t,r){this.cache.write({result:r,dataId:"ROOT_QUERY",variables:t,query:e})},e.prototype.reset=function(){return this.cache.reset()},e}(),k="2.6.3",D=!1,I=function(){function e(e){var t=this;this.defaultOptions={},this.resetStoreCallbacks=[],this.clearStoreCallbacks=[];var r=e.cache,i=e.ssrMode,n=void 0!==i&&i,a=e.ssrForceFetchDelay,o=void 0===a?0:a,d=e.connectToDevTools,u=e.queryDeduplication,c=void 0===u||u,h=e.defaultOptions,m=e.assumeImmutableResults,f=void 0!==m&&m,p=e.resolvers,v=e.typeDefs,_=e.fragmentMatcher,g=e.name,b=e.version,y=e.link;if(!y&&p&&(y=s.ApolloLink.empty()),!y||!r)throw new l.InvariantError("In order to initialize Apollo Client, you must specify 'link' and 'cache' properties in the options object.\nThese options are part of the upgrade requirements when migrating from Apollo Client 1.x to Apollo Client 2.x.\nFor more information, please visit: https://www.apollographql.com/docs/tutorial/client.html#apollo-client-setup");this.link=y,this.cache=r,this.store=new S(r),this.disableNetworkFetches=n||o>0,this.queryDeduplication=c,this.defaultOptions=h||{},this.typeDefs=v,o&&setTimeout(function(){return t.disableNetworkFetches=!1},o),this.watchQuery=this.watchQuery.bind(this),this.query=this.query.bind(this),this.mutate=this.mutate.bind(this),this.resetStore=this.resetStore.bind(this),this.reFetchObservableQueries=this.reFetchObservableQueries.bind(this);var x="undefined"!=typeof window&&!window.__APOLLO_CLIENT__;(void 0===d?x:d&&"undefined"!=typeof window)&&(window.__APOLLO_CLIENT__=this),D||(D=!0,"undefined"!=typeof window&&window.document&&window.top===window.self&&void 0===window.__APOLLO_DEVTOOLS_GLOBAL_HOOK__&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("Chrome")>-1&&console.debug("Download the Apollo DevTools for a better development experience: https://chrome.google.com/webstore/detail/apollo-client-developer-t/jdkknkkbebbapilgoeccciglkfbmbnfm")),this.version=k,this.localState=new E({cache:r,client:this,resolvers:p,fragmentMatcher:_}),this.queryManager=new T({link:this.link,store:this.store,queryDeduplication:c,ssrMode:n,clientAwareness:{name:g,version:b},localState:this.localState,assumeImmutableResults:f,onBroadcast:function(){t.devToolsHookCb&&t.devToolsHookCb({action:{},state:{queries:t.queryManager.queryStore.getStore(),mutations:t.queryManager.mutationStore.getStore()},dataWithOptimisticResults:t.cache.extract(!0)})}})}return e.prototype.stop=function(){this.queryManager.stop()},e.prototype.watchQuery=function(e){return this.defaultOptions.watchQuery&&(e=Object(n.__assign)({},this.defaultOptions.watchQuery,e)),!this.disableNetworkFetches||"network-only"!==e.fetchPolicy&&"cache-and-network"!==e.fetchPolicy||(e=Object(n.__assign)({},e,{fetchPolicy:"cache-first"})),this.queryManager.watchQuery(e)},e.prototype.query=function(e){return this.defaultOptions.query&&(e=Object(n.__assign)({},this.defaultOptions.query,e)),Object(l.invariant)("cache-and-network"!==e.fetchPolicy,"The cache-and-network fetchPolicy does not work with client.query, because client.query can only return a single result. Please use client.watchQuery to receive multiple results from the cache and the network, or consider using a different fetchPolicy, such as cache-first or network-only."),this.disableNetworkFetches&&"network-only"===e.fetchPolicy&&(e=Object(n.__assign)({},e,{fetchPolicy:"cache-first"})),this.queryManager.query(e)},e.prototype.mutate=function(e){return this.defaultOptions.mutate&&(e=Object(n.__assign)({},this.defaultOptions.mutate,e)),this.queryManager.mutate(e)},e.prototype.subscribe=function(e){return this.queryManager.startGraphQLSubscription(e)},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!1),this.cache.readQuery(e,t)},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!1),this.cache.readFragment(e,t)},e.prototype.writeQuery=function(e){var t=this.cache.writeQuery(e);return this.queryManager.broadcastQueries(),t},e.prototype.writeFragment=function(e){var t=this.cache.writeFragment(e);return this.queryManager.broadcastQueries(),t},e.prototype.writeData=function(e){var t=this.cache.writeData(e);return this.queryManager.broadcastQueries(),t},e.prototype.__actionHookForDevTools=function(e){this.devToolsHookCb=e},e.prototype.__requestRaw=function(e){return Object(s.execute)(this.link,e)},e.prototype.initQueryManager=function(){return l.invariant.warn("Calling the initQueryManager method is no longer necessary, and it will be removed from ApolloClient in version 3.0."),this.queryManager},e.prototype.resetStore=function(){var e=this;return Promise.resolve().then(function(){return e.queryManager.clearStore()}).then(function(){return Promise.all(e.resetStoreCallbacks.map(function(e){return e()}))}).then(function(){return e.reFetchObservableQueries()})},e.prototype.clearStore=function(){var e=this;return Promise.resolve().then(function(){return e.queryManager.clearStore()}).then(function(){return Promise.all(e.clearStoreCallbacks.map(function(e){return e()}))})},e.prototype.onResetStore=function(e){var t=this;return this.resetStoreCallbacks.push(e),function(){t.resetStoreCallbacks=t.resetStoreCallbacks.filter(function(t){return t!==e})}},e.prototype.onClearStore=function(e){var t=this;return this.clearStoreCallbacks.push(e),function(){t.clearStoreCallbacks=t.clearStoreCallbacks.filter(function(t){return t!==e})}},e.prototype.reFetchObservableQueries=function(e){return this.queryManager.reFetchObservableQueries(e)},e.prototype.extract=function(e){return this.cache.extract(e)},e.prototype.restore=function(e){return this.cache.restore(e)},e.prototype.addResolvers=function(e){this.localState.addResolvers(e)},e.prototype.setResolvers=function(e){this.localState.setResolvers(e)},e.prototype.getResolvers=function(){return this.localState.getResolvers()},e.prototype.setLocalStateFragmentMatcher=function(e){this.localState.setFragmentMatcher(e)},e}();t.default=I},"./node_modules/apollo-client/node_modules/apollo-utilities/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"addTypenameToDocument",function(){return Z}),r.d(t,"argumentsObjectFromField",function(){return p}),r.d(t,"assign",function(){return P}),r.d(t,"buildQueryFromSelectionSet",function(){return ne}),r.d(t,"canUseWeakMap",function(){return se}),r.d(t,"checkDocument",function(){return R}),r.d(t,"cloneDeep",function(){return le}),r.d(t,"createFragmentMap",function(){return U}),r.d(t,"getDefaultValues",function(){return G}),r.d(t,"getDirectiveInfoFromField",function(){return M}),r.d(t,"getDirectiveNames",function(){return T}),r.d(t,"getDirectivesFromDocument",function(){return te}),r.d(t,"getEnv",function(){return de}),r.d(t,"getFragmentDefinition",function(){return V}),r.d(t,"getFragmentDefinitions",function(){return L}),r.d(t,"getFragmentQueryDocument",function(){return N}),r.d(t,"getInclusionDirectives",function(){return I}),r.d(t,"getMainDefinition",function(){return z}),r.d(t,"getMutationDefinition",function(){return O}),r.d(t,"getOperationDefinition",function(){return F}),r.d(t,"getOperationDefinitionOrDie",function(){return C}),r.d(t,"getOperationName",function(){return B}),r.d(t,"getQueryDefinition",function(){return j}),r.d(t,"getStoreKeyName",function(){return f}),r.d(t,"graphQLResultHasError",function(){return pe}),r.d(t,"hasClientExports",function(){return k}),r.d(t,"hasDirectives",function(){return S}),r.d(t,"isDevelopment",function(){return he}),r.d(t,"isEnv",function(){return ue}),r.d(t,"isField",function(){return _}),r.d(t,"isIdValue",function(){return b}),r.d(t,"isInlineFragment",function(){return g}),r.d(t,"isJsonValue",function(){return x}),r.d(t,"isNumberValue",function(){return u}),r.d(t,"isProduction",function(){return ce}),r.d(t,"isScalarValue",function(){return d}),r.d(t,"isTest",function(){return me}),r.d(t,"maybeDeepFreeze",function(){return ve}),r.d(t,"mergeDeep",function(){return ge}),r.d(t,"mergeDeepArray",function(){return be}),r.d(t,"removeArgumentsFromDocument",function(){return re}),r.d(t,"removeClientSetsFromDocument",function(){return ae}),r.d(t,"removeConnectionDirectiveFromDocument",function(){return J}),r.d(t,"removeDirectivesFromDocument",function(){return X}),r.d(t,"removeFragmentSpreadFromDocument",function(){return ie}),r.d(t,"resultKeyNameFromField",function(){return v}),r.d(t,"shouldInclude",function(){return A}),r.d(t,"storeKeyNameFromField",function(){return h}),r.d(t,"stripSymbols",function(){return Ae}),r.d(t,"toIdValue",function(){return y}),r.d(t,"tryFunctionOrLogError",function(){return fe}),r.d(t,"valueFromNode",function(){return E}),r.d(t,"valueToObjectRepresentation",function(){return c}),r.d(t,"variablesInOperation",function(){return q}),r.d(t,"warnOnceInDevelopment",function(){return Me});var i=r("./node_modules/graphql/language/visitor.js"),n=r("./node_modules/ts-invariant/lib/invariant.esm.js"),a=r("./node_modules/tslib/tslib.es6.js"),s=r("./node_modules/fast-json-stable-stringify/index.js"),o=r.n(s),l=r("./node_modules/@wry/equality/lib/equality.esm.js");function d(e){return["StringValue","BooleanValue","EnumValue"].indexOf(e.kind)>-1}function u(e){return["IntValue","FloatValue"].indexOf(e.kind)>-1}function c(e,t,r,i){if(function(e){return"IntValue"===e.kind}(r)||function(e){return"FloatValue"===e.kind}(r))e[t.value]=Number(r.value);else if(function(e){return"BooleanValue"===e.kind}(r)||function(e){return"StringValue"===e.kind}(r))e[t.value]=r.value;else if(function(e){return"ObjectValue"===e.kind}(r)){var a={};r.fields.map(function(e){return c(a,e.name,e.value,i)}),e[t.value]=a}else if(function(e){return"Variable"===e.kind}(r)){var s=(i||{})[r.name.value];e[t.value]=s}else if(function(e){return"ListValue"===e.kind}(r))e[t.value]=r.values.map(function(e){var r={};return c(r,t,e,i),r[t.value]});else if(function(e){return"EnumValue"===e.kind}(r))e[t.value]=r.value;else{if(!function(e){return"NullValue"===e.kind}(r))throw new n.InvariantError('The inline argument "'+t.value+'" of kind "'+r.kind+'"is not supported. Use variables instead of inline arguments to overcome this limitation.');e[t.value]=null}}function h(e,t){var r=null;e.directives&&(r={},e.directives.forEach(function(e){r[e.name.value]={},e.arguments&&e.arguments.forEach(function(i){var n=i.name,a=i.value;return c(r[e.name.value],n,a,t)})}));var i=null;return e.arguments&&e.arguments.length&&(i={},e.arguments.forEach(function(e){var r=e.name,n=e.value;return c(i,r,n,t)})),f(e.name.value,i,r)}r.d(t,"isEqual",function(){return l.equal});var m=["connection","include","skip","client","rest","export"];function f(e,t,r){if(r&&r.connection&&r.connection.key){if(r.connection.filter&&r.connection.filter.length>0){var i=r.connection.filter?r.connection.filter:[];i.sort();var n=t,a={};return i.forEach(function(e){a[e]=n[e]}),r.connection.key+"("+JSON.stringify(a)+")"}return r.connection.key}var s=e;if(t){var l=o()(t);s+="("+l+")"}return r&&Object.keys(r).forEach(function(e){-1===m.indexOf(e)&&(r[e]&&Object.keys(r[e]).length?s+="@"+e+"("+JSON.stringify(r[e])+")":s+="@"+e)}),s}function p(e,t){if(e.arguments&&e.arguments.length){var r={};return e.arguments.forEach(function(e){var i=e.name,n=e.value;return c(r,i,n,t)}),r}return null}function v(e){return e.alias?e.alias.value:e.name.value}function _(e){return"Field"===e.kind}function g(e){return"InlineFragment"===e.kind}function b(e){return e&&"id"===e.type&&"boolean"==typeof e.generated}function y(e,t){return void 0===t&&(t=!1),Object(a.__assign)({type:"id",generated:t},"string"==typeof e?{id:e,typename:void 0}:e)}function x(e){return null!=e&&"object"==typeof e&&"json"===e.type}function w(e){throw new n.InvariantError("Variable nodes are not supported by valueFromNode")}function E(e,t){switch(void 0===t&&(t=w),e.kind){case"Variable":return t(e);case"NullValue":return null;case"IntValue":return parseInt(e.value,10);case"FloatValue":return parseFloat(e.value);case"ListValue":return e.values.map(function(e){return E(e,t)});case"ObjectValue":for(var r={},i=0,n=e.fields;i<n.length;i++){var a=n[i];r[a.name.value]=E(a.value,t)}return r;default:return e.value}}function M(e,t){if(e.directives&&e.directives.length){var r={};return e.directives.forEach(function(e){r[e.name.value]=p(e,t)}),r}return null}function A(e,t){return void 0===t&&(t={}),I(e.directives).every(function(e){var r=e.directive,i=e.ifArgument,a=!1;return"Variable"===i.value.kind?(a=t[i.value.name.value],Object(n.invariant)(void 0!==a,"Invalid variable referenced in @"+r.name.value+" directive.")):a=i.value.value,"skip"===r.name.value?!a:a})}function T(e){var t=[];return Object(i.visit)(e,{Directive:function(e){t.push(e.name.value)}}),t}function S(e,t){return T(t).some(function(t){return e.indexOf(t)>-1})}function k(e){return e&&S(["client"],e)&&S(["export"],e)}function D(e){var t=e.name.value;return"skip"===t||"include"===t}function I(e){return e?e.filter(D).map(function(e){var t=e.arguments,r=e.name.value;Object(n.invariant)(t&&1===t.length,"Incorrect number of arguments for the @"+r+" directive.");var i=t[0];Object(n.invariant)(i.name&&"if"===i.name.value,"Invalid argument for the @"+r+" directive.");var a=i.value;return Object(n.invariant)(a&&("Variable"===a.kind||"BooleanValue"===a.kind),"Argument for the @"+r+" directive must be a variable or a boolean value."),{directive:e,ifArgument:i}}):[]}function N(e,t){var r=t,i=[];return e.definitions.forEach(function(e){if("OperationDefinition"===e.kind)throw new n.InvariantError("Found a "+e.operation+" operation"+(e.name?" named '"+e.name.value+"'":"")+". No operations are allowed when using a fragment as a query. Only fragments are allowed.");"FragmentDefinition"===e.kind&&i.push(e)}),void 0===r&&(Object(n.invariant)(1===i.length,"Found "+i.length+" fragments. `fragmentName` must be provided when there is not exactly 1 fragment."),r=i[0].name.value),Object(a.__assign)({},e,{definitions:[{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:r}}]}}].concat(e.definitions)})}function P(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(t){null!=t&&Object.keys(t).forEach(function(r){e[r]=t[r]})}),e}function O(e){R(e);var t=e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})[0];return Object(n.invariant)(t,"Must contain a mutation definition."),t}function R(e){Object(n.invariant)(e&&"Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql');var t=e.definitions.filter(function(e){return"FragmentDefinition"!==e.kind}).map(function(e){if("OperationDefinition"!==e.kind)throw new n.InvariantError('Schema type definitions not allowed in queries. Found: "'+e.kind+'"');return e});return Object(n.invariant)(t.length<=1,"Ambiguous GraphQL document: contains "+t.length+" operations"),e}function F(e){return R(e),e.definitions.filter(function(e){return"OperationDefinition"===e.kind})[0]}function C(e){var t=F(e);return Object(n.invariant)(t,"GraphQL document is missing an operation"),t}function B(e){return e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&e.name}).map(function(e){return e.name.value})[0]||null}function L(e){return e.definitions.filter(function(e){return"FragmentDefinition"===e.kind})}function j(e){var t=F(e);return Object(n.invariant)(t&&"query"===t.operation,"Must contain a query definition."),t}function V(e){Object(n.invariant)("Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql'),Object(n.invariant)(e.definitions.length<=1,"Fragment must have exactly one definition.");var t=e.definitions[0];return Object(n.invariant)("FragmentDefinition"===t.kind,"Must be a fragment definition."),t}function z(e){var t;R(e);for(var r=0,i=e.definitions;r<i.length;r++){var a=i[r];if("OperationDefinition"===a.kind){var s=a.operation;if("query"===s||"mutation"===s||"subscription"===s)return a}"FragmentDefinition"!==a.kind||t||(t=a)}if(t)return t;throw new n.InvariantError("Expected a parsed GraphQL query with a query, mutation, subscription, or a fragment.")}function U(e){void 0===e&&(e=[]);var t={};return e.forEach(function(e){t[e.name.value]=e}),t}function G(e){if(e&&e.variableDefinitions&&e.variableDefinitions.length){var t=e.variableDefinitions.filter(function(e){return e.defaultValue}).map(function(e){var t=e.variable,r=e.defaultValue,i={};return c(i,t.name,r),i});return P.apply(void 0,[{}].concat(t))}return{}}function q(e){var t=new Set;if(e.variableDefinitions)for(var r=0,i=e.variableDefinitions;r<i.length;r++){var n=i[r];t.add(n.variable.name.value)}return t}function Q(e,t,r){var i=0;return e.forEach(function(r,n){t.call(this,r,n,e)&&(e[i++]=r)},r),e.length=i,e}var H={kind:"Field",name:{kind:"Name",value:"__typename"}};function Y(e){return function e(t,r){return t.selectionSet.selections.every(function(t){return"FragmentSpread"===t.kind&&e(r[t.name.value],r)})}(F(e)||V(e),U(L(e)))?null:e}function W(e){return function(t){return e.some(function(e){return e.name&&e.name===t.name.value||e.test&&e.test(t)})}}function X(e,t){var r=Object.create(null),n=[],a=Object.create(null),s=[],o=Y(Object(i.visit)(t,{Variable:{enter:function(e,t,i){"VariableDefinition"!==i.kind&&(r[e.name.value]=!0)}},Field:{enter:function(t){if(e&&t.directives&&(e.some(function(e){return e.remove})&&t.directives&&t.directives.some(W(e))))return t.arguments&&t.arguments.forEach(function(e){"Variable"===e.value.kind&&n.push({name:e.value.name.value})}),t.selectionSet&&function e(t){var r=[];t.selections.forEach(function(t){(_(t)||g(t))&&t.selectionSet?e(t.selectionSet).forEach(function(e){return r.push(e)}):"FragmentSpread"===t.kind&&r.push(t)});return r}(t.selectionSet).forEach(function(e){s.push({name:e.name.value})}),null}},FragmentSpread:{enter:function(e){a[e.name.value]=!0}},Directive:{enter:function(t){if(W(e)(t))return null}}}));return o&&Q(n,function(e){return!r[e.name]}).length&&(o=re(n,o)),o&&Q(s,function(e){return!a[e.name]}).length&&(o=ie(s,o)),o}function Z(e){return Object(i.visit)(R(e),{SelectionSet:{enter:function(e,t,r){if(!r||"OperationDefinition"!==r.kind){var i=e.selections;if(i)if(!i.some(function(e){return _(e)&&("__typename"===e.name.value||0===e.name.value.lastIndexOf("__",0))})){var n=r;if(!(_(n)&&n.directives&&n.directives.some(function(e){return"export"===e.name.value})))return Object(a.__assign)({},e,{selections:i.concat([H])})}}}}})}var K={test:function(e){var t="connection"===e.name.value;return t&&(e.arguments&&e.arguments.some(function(e){return"key"===e.name.value})||n.invariant.warn("Removing an @connection directive even though it does not have a key. You may want to use the key parameter to specify a store key.")),t}};function J(e){return X([K],R(e))}function $(e,t,r){return void 0===r&&(r=!0),t&&t.selections&&t.selections.some(function(t){return ee(e,t,r)})}function ee(e,t,r){return void 0===r&&(r=!0),!_(t)||!!t.directives&&(t.directives.some(W(e))||r&&$(e,t.selectionSet,r))}function te(e,t){var r;return R(t),Y(Object(i.visit)(t,{SelectionSet:{enter:function(t,i,n,s){var o=s.join("-");if(!r||o===r||!o.startsWith(r)){if(t.selections){var l=t.selections.filter(function(t){return ee(e,t)});return $(e,t,!1)&&(r=o),Object(a.__assign)({},t,{selections:l})}return null}}}}))}function re(e,t){var r=function(e){return function(t){return e.some(function(e){return t.value&&"Variable"===t.value.kind&&t.value.name&&(e.name===t.value.name.value||e.test&&e.test(t))})}}(e);return Y(Object(i.visit)(t,{OperationDefinition:{enter:function(t){return Object(a.__assign)({},t,{variableDefinitions:t.variableDefinitions.filter(function(t){return!e.some(function(e){return e.name===t.variable.name.value})})})}},Field:{enter:function(t){if(e.some(function(e){return e.remove})){var i=0;if(t.arguments.forEach(function(e){r(e)&&(i+=1)}),1===i)return null}}},Argument:{enter:function(e){if(r(e))return null}}}))}function ie(e,t){function r(t){if(e.some(function(e){return e.name===t.name.value}))return null}return Y(Object(i.visit)(t,{FragmentSpread:{enter:r},FragmentDefinition:{enter:r}}))}function ne(e){return"query"===z(e).operation?e:Object(i.visit)(e,{OperationDefinition:{enter:function(e){return Object(a.__assign)({},e,{operation:"query"})}}})}function ae(e){R(e);var t=X([{test:function(e){return"client"===e.name.value},remove:!0}],e);return t&&(t=Object(i.visit)(t,{FragmentDefinition:{enter:function(e){if(e.selectionSet&&e.selectionSet.selections.every(function(e){return _(e)&&"__typename"===e.name.value}))return null}}})),t}var se="function"==typeof WeakMap&&!("object"==typeof navigator&&"ReactNative"===navigator.product),oe=Object.prototype.toString;function le(e){return function e(t,r){switch(oe.call(t)){case"[object Array]":if(r.has(t))return r.get(t);var i=t.slice(0);return r.set(t,i),i.forEach(function(t,n){i[n]=e(t,r)}),i;case"[object Object]":if(r.has(t))return r.get(t);var n=Object.create(Object.getPrototypeOf(t));return r.set(t,n),Object.keys(t).forEach(function(i){n[i]=e(t[i],r)}),n;default:return t}}(e,new Map)}function de(){return"development"}function ue(e){return"development"===e}function ce(){return!0===ue("production")}function he(){return!0===ue("development")}function me(){return!0===ue("test")}function fe(e){try{return e()}catch(e){console.error&&console.error(e)}}function pe(e){return e.errors&&e.errors.length}function ve(e){if((he()||me())&&!("function"==typeof Symbol&&"string"==typeof Symbol("")))return function e(t){return Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(r){null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||e(t[r])}),t}(e);return e}var _e=Object.prototype.hasOwnProperty;function ge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return be(e)}function be(e){var t=e[0]||{},r=e.length;if(r>1){var i=[];t=we(t,i);for(var n=1;n<r;++n)t=xe(t,e[n],i)}return t}function ye(e){return null!==e&&"object"==typeof e}function xe(e,t,r){return ye(t)&&ye(e)?(Object.isExtensible&&!Object.isExtensible(e)&&(e=we(e,r)),Object.keys(t).forEach(function(i){var n=t[i];if(_e.call(e,i)){var a=e[i];n!==a&&(e[i]=xe(we(a,r),n,r))}else e[i]=n}),e):t}function we(e,t){return null!==e&&"object"==typeof e&&t.indexOf(e)<0&&(e=Array.isArray(e)?e.slice(0):Object(a.__assign)({__proto__:Object.getPrototypeOf(e)},e),t.push(e)),e}var Ee=Object.create({});function Me(e,t){void 0===t&&(t="warn"),ce()||Ee[e]||(me()||(Ee[e]=!0),"error"===t?console.error(e):console.warn(e))}function Ae(e){return JSON.parse(JSON.stringify(e))}}.call(this,r("./node_modules/process/browser.js"))},"./node_modules/apollo-link-error/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"ErrorLink",function(){return s}),r.d(t,"onError",function(){return a});var i=r("./node_modules/tslib/tslib.es6.js"),n=r("./node_modules/apollo-link/lib/bundle.esm.js");function a(e){return new n.ApolloLink(function(t,r){return new n.Observable(function(i){var n,a,s;try{n=r(t).subscribe({next:function(n){n.errors&&(s=e({graphQLErrors:n.errors,response:n,operation:t,forward:r}))?a=s.subscribe({next:i.next.bind(i),error:i.error.bind(i),complete:i.complete.bind(i)}):i.next(n)},error:function(n){(s=e({operation:t,networkError:n,graphQLErrors:n&&n.result&&n.result.errors,forward:r}))?a=s.subscribe({next:i.next.bind(i),error:i.error.bind(i),complete:i.complete.bind(i)}):i.error(n)},complete:function(){s||i.complete.bind(i)()}})}catch(n){e({networkError:n,operation:t,forward:r}),i.error(n)}return function(){n&&n.unsubscribe(),a&&n.unsubscribe()}})})}var s=function(e){function t(t){var r=e.call(this)||this;return r.link=a(t),r}return Object(i.__extends)(t,e),t.prototype.request=function(e,t){return this.link.request(e,t)},t}(n.ApolloLink)},"./node_modules/apollo-link-http-common/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"checkFetcher",function(){return d}),r.d(t,"createSignalIfSupported",function(){return u}),r.d(t,"fallbackHttpConfig",function(){return s}),r.d(t,"parseAndCheckHttpResponse",function(){return l}),r.d(t,"selectHttpOptionsAndBody",function(){return c}),r.d(t,"selectURI",function(){return m}),r.d(t,"serializeFetchParameter",function(){return h}),r.d(t,"throwServerError",function(){return o});var i=r("./node_modules/tslib/tslib.es6.js"),n=r("./node_modules/graphql/language/printer.js"),a=r("./node_modules/ts-invariant/lib/invariant.esm.js"),s={http:{includeQuery:!0,includeExtensions:!1},headers:{accept:"*/*","content-type":"application/json"},options:{method:"POST"}},o=function(e,t,r){var i=new Error(r);throw i.name="ServerError",i.response=e,i.statusCode=e.status,i.result=t,i},l=function(e){return function(t){return t.text().then(function(e){try{return JSON.parse(e)}catch(i){var r=i;return r.name="ServerParseError",r.response=t,r.statusCode=t.status,r.bodyText=e,Promise.reject(r)}}).then(function(r){return t.status>=300&&o(t,r,"Response not successful: Received status code "+t.status),Array.isArray(r)||r.hasOwnProperty("data")||r.hasOwnProperty("errors")||o(t,r,"Server response was missing for query '"+(Array.isArray(e)?e.map(function(e){return e.operationName}):e.operationName)+"'."),r})}},d=function(e){if(!e&&"undefined"==typeof fetch){var t="unfetch";throw"undefined"==typeof window&&(t="node-fetch"),new a.InvariantError("\nfetch is not found globally and no fetcher passed, to fix pass a fetch for\nyour environment like https://www.npmjs.com/package/"+t+".\n\nFor example:\nimport fetch from '"+t+"';\nimport { createHttpLink } from 'apollo-link-http';\n\nconst link = createHttpLink({ uri: '/graphql', fetch: fetch });")}},u=function(){if("undefined"==typeof AbortController)return{controller:!1,signal:!1};var e=new AbortController;return{controller:e,signal:e.signal}},c=function(e,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var s=Object(i.__assign)({},t.options,{headers:t.headers,credentials:t.credentials}),o=t.http;r.forEach(function(e){s=Object(i.__assign)({},s,e.options,{headers:Object(i.__assign)({},s.headers,e.headers)}),e.credentials&&(s.credentials=e.credentials),o=Object(i.__assign)({},o,e.http)});var l=e.operationName,d=e.extensions,u=e.variables,c=e.query,h={operationName:l,variables:u};return o.includeExtensions&&(h.extensions=d),o.includeQuery&&(h.query=Object(n.print)(c)),{options:s,body:h}},h=function(e,t){var r;try{r=JSON.stringify(e)}catch(e){var i=new a.InvariantError("Network request failed. "+t+" is not serializable: "+e.message);throw i.parseError=e,i}return r},m=function(e,t){var r=e.getContext().uri;return r||("function"==typeof t?t(e):t||"/graphql")}},"./node_modules/apollo-link-http/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"HttpLink",function(){return o}),r.d(t,"createHttpLink",function(){return s});var i=r("./node_modules/tslib/tslib.es6.js"),n=r("./node_modules/apollo-link/lib/bundle.esm.js"),a=r("./node_modules/apollo-link-http-common/lib/bundle.esm.js"),s=function(e){void 0===e&&(e={});var t=e.uri,r=void 0===t?"/graphql":t,s=e.fetch,o=e.includeExtensions,l=e.useGETForQueries,d=Object(i.__rest)(e,["uri","fetch","includeExtensions","useGETForQueries"]);Object(a.checkFetcher)(s),s||(s=fetch);var u={http:{includeExtensions:o},options:d.fetchOptions,credentials:d.credentials,headers:d.headers};return new n.ApolloLink(function(e){var t=Object(a.selectURI)(e,r),o=e.getContext(),d={};if(o.clientAwareness){var c=o.clientAwareness,h=c.name,m=c.version;h&&(d["apollographql-client-name"]=h),m&&(d["apollographql-client-version"]=m)}var f,p=Object(i.__assign)({},d,o.headers),v={http:o.http,options:o.fetchOptions,credentials:o.credentials,headers:p},_=Object(a.selectHttpOptionsAndBody)(e,a.fallbackHttpConfig,u,v),g=_.options,b=_.body;if(!g.signal){var y=Object(a.createSignalIfSupported)(),x=y.controller,w=y.signal;(f=x)&&(g.signal=w)}if(l&&!e.query.definitions.some(function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})&&(g.method="GET"),"GET"===g.method){var E=function(e,t){var r=[],i=function(e,t){r.push(e+"="+encodeURIComponent(t))};"query"in t&&i("query",t.query);t.operationName&&i("operationName",t.operationName);if(t.variables){var n=void 0;try{n=Object(a.serializeFetchParameter)(t.variables,"Variables map")}catch(e){return{parseError:e}}i("variables",n)}if(t.extensions){var s=void 0;try{s=Object(a.serializeFetchParameter)(t.extensions,"Extensions map")}catch(e){return{parseError:e}}i("extensions",s)}var o="",l=e,d=e.indexOf("#");-1!==d&&(o=e.substr(d),l=e.substr(0,d));var u=-1===l.indexOf("?")?"?":"&";return{newURI:l+u+r.join("&")+o}}(t,b),M=E.newURI,A=E.parseError;if(A)return Object(n.fromError)(A);t=M}else try{g.body=Object(a.serializeFetchParameter)(b,"Payload")}catch(A){return Object(n.fromError)(A)}return new n.Observable(function(r){return s(t,g).then(function(t){return e.setContext({response:t}),t}).then(Object(a.parseAndCheckHttpResponse)(e)).then(function(e){return r.next(e),r.complete(),e}).catch(function(e){"AbortError"!==e.name&&(e.result&&e.result.errors&&e.result.data&&r.next(e.result),r.error(e))}),function(){f&&f.abort()}})})};var o=function(e){function t(t){return e.call(this,s(t).request)||this}return Object(i.__extends)(t,e),t}(n.ApolloLink)},"./node_modules/apollo-link/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"ApolloLink",function(){return y}),r.d(t,"concat",function(){return b}),r.d(t,"createOperation",function(){return m}),r.d(t,"empty",function(){return v}),r.d(t,"execute",function(){return x}),r.d(t,"from",function(){return _}),r.d(t,"fromError",function(){return h}),r.d(t,"fromPromise",function(){return c}),r.d(t,"makePromise",function(){return u}),r.d(t,"split",function(){return g}),r.d(t,"toPromise",function(){return d});var i=r("./node_modules/zen-observable-ts/lib/bundle.esm.js");r.d(t,"Observable",function(){return i.default});var n=r("./node_modules/ts-invariant/lib/invariant.esm.js"),a=r("./node_modules/tslib/tslib.es6.js"),s=r("./node_modules/apollo-link/node_modules/apollo-utilities/lib/bundle.esm.js");r.d(t,"getOperationName",function(){return s.getOperationName});var o=function(e){function t(t,r){var i=e.call(this,t)||this;return i.link=r,i}return Object(a.__extends)(t,e),t}(Error);function l(e){return e.request.length<=1}function d(e){var t=!1;return new Promise(function(r,i){e.subscribe({next:function(e){t?n.invariant.warn("Promise Wrapper does not support multiple results from Observable"):(t=!0,r(e))},error:i})})}var u=d;function c(e){return new i.default(function(t){e.then(function(e){t.next(e),t.complete()}).catch(t.error.bind(t))})}function h(e){return new i.default(function(t){t.error(e)})}function m(e,t){var r=Object(a.__assign)({},e);return Object.defineProperty(t,"setContext",{enumerable:!1,value:function(e){r="function"==typeof e?Object(a.__assign)({},r,e(r)):Object(a.__assign)({},r,e)}}),Object.defineProperty(t,"getContext",{enumerable:!1,value:function(){return Object(a.__assign)({},r)}}),Object.defineProperty(t,"toKey",{enumerable:!1,value:function(){return function(e){var t=e.query,r=e.variables,i=e.operationName;return JSON.stringify([i,t,r])}(t)}}),t}function f(e,t){return t?t(e):i.default.of()}function p(e){return"function"==typeof e?new y(e):e}function v(){return new y(function(){return i.default.of()})}function _(e){return 0===e.length?v():e.map(p).reduce(function(e,t){return e.concat(t)})}function g(e,t,r){var n=p(t),a=p(r||new y(f));return l(n)&&l(a)?new y(function(t){return e(t)?n.request(t)||i.default.of():a.request(t)||i.default.of()}):new y(function(t,r){return e(t)?n.request(t,r)||i.default.of():a.request(t,r)||i.default.of()})}var b=function(e,t){var r=p(e);if(l(r))return n.invariant.warn(new o("You are calling concat on a terminating link, which will have no effect",r)),r;var a=p(t);return l(a)?new y(function(e){return r.request(e,function(e){return a.request(e)||i.default.of()})||i.default.of()}):new y(function(e,t){return r.request(e,function(e){return a.request(e,t)||i.default.of()})||i.default.of()})},y=function(){function e(e){e&&(this.request=e)}return e.prototype.split=function(t,r,i){return this.concat(g(t,r,i||new e(f)))},e.prototype.concat=function(e){return b(this,e)},e.prototype.request=function(e,t){throw new n.InvariantError("request is not implemented")},e.empty=v,e.from=_,e.split=g,e.execute=x,e}();function x(e,t){return e.request(m(t.context,function(e){var t={variables:e.variables||{},extensions:e.extensions||{},operationName:e.operationName,query:e.query};return t.operationName||(t.operationName="string"!=typeof t.query?Object(s.getOperationName)(t.query):""),t}(function(e){for(var t=["query","operationName","variables","extensions","context"],r=0,i=Object.keys(e);r<i.length;r++){var a=i[r];if(t.indexOf(a)<0)throw new n.InvariantError("illegal argument: "+a)}return e}(t))))||i.default.of()}},"./node_modules/apollo-link/node_modules/apollo-utilities/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"addTypenameToDocument",function(){return Z}),r.d(t,"argumentsObjectFromField",function(){return p}),r.d(t,"assign",function(){return P}),r.d(t,"buildQueryFromSelectionSet",function(){return ne}),r.d(t,"canUseWeakMap",function(){return se}),r.d(t,"checkDocument",function(){return R}),r.d(t,"cloneDeep",function(){return le}),r.d(t,"createFragmentMap",function(){return U}),r.d(t,"getDefaultValues",function(){return G}),r.d(t,"getDirectiveInfoFromField",function(){return M}),r.d(t,"getDirectiveNames",function(){return T}),r.d(t,"getDirectivesFromDocument",function(){return te}),r.d(t,"getEnv",function(){return de}),r.d(t,"getFragmentDefinition",function(){return V}),r.d(t,"getFragmentDefinitions",function(){return L}),r.d(t,"getFragmentQueryDocument",function(){return N}),r.d(t,"getInclusionDirectives",function(){return I}),r.d(t,"getMainDefinition",function(){return z}),r.d(t,"getMutationDefinition",function(){return O}),r.d(t,"getOperationDefinition",function(){return F}),r.d(t,"getOperationDefinitionOrDie",function(){return C}),r.d(t,"getOperationName",function(){return B}),r.d(t,"getQueryDefinition",function(){return j}),r.d(t,"getStoreKeyName",function(){return f}),r.d(t,"graphQLResultHasError",function(){return pe}),r.d(t,"hasClientExports",function(){return k}),r.d(t,"hasDirectives",function(){return S}),r.d(t,"isDevelopment",function(){return he}),r.d(t,"isEnv",function(){return ue}),r.d(t,"isField",function(){return _}),r.d(t,"isIdValue",function(){return b}),r.d(t,"isInlineFragment",function(){return g}),r.d(t,"isJsonValue",function(){return x}),r.d(t,"isNumberValue",function(){return u}),r.d(t,"isProduction",function(){return ce}),r.d(t,"isScalarValue",function(){return d}),r.d(t,"isTest",function(){return me}),r.d(t,"maybeDeepFreeze",function(){return ve}),r.d(t,"mergeDeep",function(){return ge}),r.d(t,"mergeDeepArray",function(){return be}),r.d(t,"removeArgumentsFromDocument",function(){return re}),r.d(t,"removeClientSetsFromDocument",function(){return ae}),r.d(t,"removeConnectionDirectiveFromDocument",function(){return J}),r.d(t,"removeDirectivesFromDocument",function(){return X}),r.d(t,"removeFragmentSpreadFromDocument",function(){return ie}),r.d(t,"resultKeyNameFromField",function(){return v}),r.d(t,"shouldInclude",function(){return A}),r.d(t,"storeKeyNameFromField",function(){return h}),r.d(t,"stripSymbols",function(){return Ae}),r.d(t,"toIdValue",function(){return y}),r.d(t,"tryFunctionOrLogError",function(){return fe}),r.d(t,"valueFromNode",function(){return E}),r.d(t,"valueToObjectRepresentation",function(){return c}),r.d(t,"variablesInOperation",function(){return q}),r.d(t,"warnOnceInDevelopment",function(){return Me});var i=r("./node_modules/graphql/language/visitor.js"),n=r("./node_modules/ts-invariant/lib/invariant.esm.js"),a=r("./node_modules/tslib/tslib.es6.js"),s=r("./node_modules/fast-json-stable-stringify/index.js"),o=r.n(s),l=r("./node_modules/@wry/equality/lib/equality.esm.js");function d(e){return["StringValue","BooleanValue","EnumValue"].indexOf(e.kind)>-1}function u(e){return["IntValue","FloatValue"].indexOf(e.kind)>-1}function c(e,t,r,i){if(function(e){return"IntValue"===e.kind}(r)||function(e){return"FloatValue"===e.kind}(r))e[t.value]=Number(r.value);else if(function(e){return"BooleanValue"===e.kind}(r)||function(e){return"StringValue"===e.kind}(r))e[t.value]=r.value;else if(function(e){return"ObjectValue"===e.kind}(r)){var a={};r.fields.map(function(e){return c(a,e.name,e.value,i)}),e[t.value]=a}else if(function(e){return"Variable"===e.kind}(r)){var s=(i||{})[r.name.value];e[t.value]=s}else if(function(e){return"ListValue"===e.kind}(r))e[t.value]=r.values.map(function(e){var r={};return c(r,t,e,i),r[t.value]});else if(function(e){return"EnumValue"===e.kind}(r))e[t.value]=r.value;else{if(!function(e){return"NullValue"===e.kind}(r))throw new n.InvariantError('The inline argument "'+t.value+'" of kind "'+r.kind+'"is not supported. Use variables instead of inline arguments to overcome this limitation.');e[t.value]=null}}function h(e,t){var r=null;e.directives&&(r={},e.directives.forEach(function(e){r[e.name.value]={},e.arguments&&e.arguments.forEach(function(i){var n=i.name,a=i.value;return c(r[e.name.value],n,a,t)})}));var i=null;return e.arguments&&e.arguments.length&&(i={},e.arguments.forEach(function(e){var r=e.name,n=e.value;return c(i,r,n,t)})),f(e.name.value,i,r)}r.d(t,"isEqual",function(){return l.equal});var m=["connection","include","skip","client","rest","export"];function f(e,t,r){if(r&&r.connection&&r.connection.key){if(r.connection.filter&&r.connection.filter.length>0){var i=r.connection.filter?r.connection.filter:[];i.sort();var n=t,a={};return i.forEach(function(e){a[e]=n[e]}),r.connection.key+"("+JSON.stringify(a)+")"}return r.connection.key}var s=e;if(t){var l=o()(t);s+="("+l+")"}return r&&Object.keys(r).forEach(function(e){-1===m.indexOf(e)&&(r[e]&&Object.keys(r[e]).length?s+="@"+e+"("+JSON.stringify(r[e])+")":s+="@"+e)}),s}function p(e,t){if(e.arguments&&e.arguments.length){var r={};return e.arguments.forEach(function(e){var i=e.name,n=e.value;return c(r,i,n,t)}),r}return null}function v(e){return e.alias?e.alias.value:e.name.value}function _(e){return"Field"===e.kind}function g(e){return"InlineFragment"===e.kind}function b(e){return e&&"id"===e.type&&"boolean"==typeof e.generated}function y(e,t){return void 0===t&&(t=!1),Object(a.__assign)({type:"id",generated:t},"string"==typeof e?{id:e,typename:void 0}:e)}function x(e){return null!=e&&"object"==typeof e&&"json"===e.type}function w(e){throw new n.InvariantError("Variable nodes are not supported by valueFromNode")}function E(e,t){switch(void 0===t&&(t=w),e.kind){case"Variable":return t(e);case"NullValue":return null;case"IntValue":return parseInt(e.value,10);case"FloatValue":return parseFloat(e.value);case"ListValue":return e.values.map(function(e){return E(e,t)});case"ObjectValue":for(var r={},i=0,n=e.fields;i<n.length;i++){var a=n[i];r[a.name.value]=E(a.value,t)}return r;default:return e.value}}function M(e,t){if(e.directives&&e.directives.length){var r={};return e.directives.forEach(function(e){r[e.name.value]=p(e,t)}),r}return null}function A(e,t){return void 0===t&&(t={}),I(e.directives).every(function(e){var r=e.directive,i=e.ifArgument,a=!1;return"Variable"===i.value.kind?(a=t[i.value.name.value],Object(n.invariant)(void 0!==a,"Invalid variable referenced in @"+r.name.value+" directive.")):a=i.value.value,"skip"===r.name.value?!a:a})}function T(e){var t=[];return Object(i.visit)(e,{Directive:function(e){t.push(e.name.value)}}),t}function S(e,t){return T(t).some(function(t){return e.indexOf(t)>-1})}function k(e){return e&&S(["client"],e)&&S(["export"],e)}function D(e){var t=e.name.value;return"skip"===t||"include"===t}function I(e){return e?e.filter(D).map(function(e){var t=e.arguments,r=e.name.value;Object(n.invariant)(t&&1===t.length,"Incorrect number of arguments for the @"+r+" directive.");var i=t[0];Object(n.invariant)(i.name&&"if"===i.name.value,"Invalid argument for the @"+r+" directive.");var a=i.value;return Object(n.invariant)(a&&("Variable"===a.kind||"BooleanValue"===a.kind),"Argument for the @"+r+" directive must be a variable or a boolean value."),{directive:e,ifArgument:i}}):[]}function N(e,t){var r=t,i=[];return e.definitions.forEach(function(e){if("OperationDefinition"===e.kind)throw new n.InvariantError("Found a "+e.operation+" operation"+(e.name?" named '"+e.name.value+"'":"")+". No operations are allowed when using a fragment as a query. Only fragments are allowed.");"FragmentDefinition"===e.kind&&i.push(e)}),void 0===r&&(Object(n.invariant)(1===i.length,"Found "+i.length+" fragments. `fragmentName` must be provided when there is not exactly 1 fragment."),r=i[0].name.value),Object(a.__assign)({},e,{definitions:[{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:r}}]}}].concat(e.definitions)})}function P(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(t){null!=t&&Object.keys(t).forEach(function(r){e[r]=t[r]})}),e}function O(e){R(e);var t=e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})[0];return Object(n.invariant)(t,"Must contain a mutation definition."),t}function R(e){Object(n.invariant)(e&&"Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql');var t=e.definitions.filter(function(e){return"FragmentDefinition"!==e.kind}).map(function(e){if("OperationDefinition"!==e.kind)throw new n.InvariantError('Schema type definitions not allowed in queries. Found: "'+e.kind+'"');return e});return Object(n.invariant)(t.length<=1,"Ambiguous GraphQL document: contains "+t.length+" operations"),e}function F(e){return R(e),e.definitions.filter(function(e){return"OperationDefinition"===e.kind})[0]}function C(e){var t=F(e);return Object(n.invariant)(t,"GraphQL document is missing an operation"),t}function B(e){return e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&e.name}).map(function(e){return e.name.value})[0]||null}function L(e){return e.definitions.filter(function(e){return"FragmentDefinition"===e.kind})}function j(e){var t=F(e);return Object(n.invariant)(t&&"query"===t.operation,"Must contain a query definition."),t}function V(e){Object(n.invariant)("Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql'),Object(n.invariant)(e.definitions.length<=1,"Fragment must have exactly one definition.");var t=e.definitions[0];return Object(n.invariant)("FragmentDefinition"===t.kind,"Must be a fragment definition."),t}function z(e){var t;R(e);for(var r=0,i=e.definitions;r<i.length;r++){var a=i[r];if("OperationDefinition"===a.kind){var s=a.operation;if("query"===s||"mutation"===s||"subscription"===s)return a}"FragmentDefinition"!==a.kind||t||(t=a)}if(t)return t;throw new n.InvariantError("Expected a parsed GraphQL query with a query, mutation, subscription, or a fragment.")}function U(e){void 0===e&&(e=[]);var t={};return e.forEach(function(e){t[e.name.value]=e}),t}function G(e){if(e&&e.variableDefinitions&&e.variableDefinitions.length){var t=e.variableDefinitions.filter(function(e){return e.defaultValue}).map(function(e){var t=e.variable,r=e.defaultValue,i={};return c(i,t.name,r),i});return P.apply(void 0,[{}].concat(t))}return{}}function q(e){var t=new Set;if(e.variableDefinitions)for(var r=0,i=e.variableDefinitions;r<i.length;r++){var n=i[r];t.add(n.variable.name.value)}return t}function Q(e,t,r){var i=0;return e.forEach(function(r,n){t.call(this,r,n,e)&&(e[i++]=r)},r),e.length=i,e}var H={kind:"Field",name:{kind:"Name",value:"__typename"}};function Y(e){return function e(t,r){return t.selectionSet.selections.every(function(t){return"FragmentSpread"===t.kind&&e(r[t.name.value],r)})}(F(e)||V(e),U(L(e)))?null:e}function W(e){return function(t){return e.some(function(e){return e.name&&e.name===t.name.value||e.test&&e.test(t)})}}function X(e,t){var r=Object.create(null),n=[],a=Object.create(null),s=[],o=Y(Object(i.visit)(t,{Variable:{enter:function(e,t,i){"VariableDefinition"!==i.kind&&(r[e.name.value]=!0)}},Field:{enter:function(t){if(e&&t.directives&&(e.some(function(e){return e.remove})&&t.directives&&t.directives.some(W(e))))return t.arguments&&t.arguments.forEach(function(e){"Variable"===e.value.kind&&n.push({name:e.value.name.value})}),t.selectionSet&&function e(t){var r=[];t.selections.forEach(function(t){(_(t)||g(t))&&t.selectionSet?e(t.selectionSet).forEach(function(e){return r.push(e)}):"FragmentSpread"===t.kind&&r.push(t)});return r}(t.selectionSet).forEach(function(e){s.push({name:e.name.value})}),null}},FragmentSpread:{enter:function(e){a[e.name.value]=!0}},Directive:{enter:function(t){if(W(e)(t))return null}}}));return o&&Q(n,function(e){return!r[e.name]}).length&&(o=re(n,o)),o&&Q(s,function(e){return!a[e.name]}).length&&(o=ie(s,o)),o}function Z(e){return Object(i.visit)(R(e),{SelectionSet:{enter:function(e,t,r){if(!r||"OperationDefinition"!==r.kind){var i=e.selections;if(i)if(!i.some(function(e){return _(e)&&("__typename"===e.name.value||0===e.name.value.lastIndexOf("__",0))})){var n=r;if(!(_(n)&&n.directives&&n.directives.some(function(e){return"export"===e.name.value})))return Object(a.__assign)({},e,{selections:i.concat([H])})}}}}})}var K={test:function(e){var t="connection"===e.name.value;return t&&(e.arguments&&e.arguments.some(function(e){return"key"===e.name.value})||n.invariant.warn("Removing an @connection directive even though it does not have a key. You may want to use the key parameter to specify a store key.")),t}};function J(e){return X([K],R(e))}function $(e,t,r){return void 0===r&&(r=!0),t&&t.selections&&t.selections.some(function(t){return ee(e,t,r)})}function ee(e,t,r){return void 0===r&&(r=!0),!_(t)||!!t.directives&&(t.directives.some(W(e))||r&&$(e,t.selectionSet,r))}function te(e,t){var r;return R(t),Y(Object(i.visit)(t,{SelectionSet:{enter:function(t,i,n,s){var o=s.join("-");if(!r||o===r||!o.startsWith(r)){if(t.selections){var l=t.selections.filter(function(t){return ee(e,t)});return $(e,t,!1)&&(r=o),Object(a.__assign)({},t,{selections:l})}return null}}}}))}function re(e,t){var r=function(e){return function(t){return e.some(function(e){return t.value&&"Variable"===t.value.kind&&t.value.name&&(e.name===t.value.name.value||e.test&&e.test(t))})}}(e);return Y(Object(i.visit)(t,{OperationDefinition:{enter:function(t){return Object(a.__assign)({},t,{variableDefinitions:t.variableDefinitions.filter(function(t){return!e.some(function(e){return e.name===t.variable.name.value})})})}},Field:{enter:function(t){if(e.some(function(e){return e.remove})){var i=0;if(t.arguments.forEach(function(e){r(e)&&(i+=1)}),1===i)return null}}},Argument:{enter:function(e){if(r(e))return null}}}))}function ie(e,t){function r(t){if(e.some(function(e){return e.name===t.name.value}))return null}return Y(Object(i.visit)(t,{FragmentSpread:{enter:r},FragmentDefinition:{enter:r}}))}function ne(e){return"query"===z(e).operation?e:Object(i.visit)(e,{OperationDefinition:{enter:function(e){return Object(a.__assign)({},e,{operation:"query"})}}})}function ae(e){R(e);var t=X([{test:function(e){return"client"===e.name.value},remove:!0}],e);return t&&(t=Object(i.visit)(t,{FragmentDefinition:{enter:function(e){if(e.selectionSet&&e.selectionSet.selections.every(function(e){return _(e)&&"__typename"===e.name.value}))return null}}})),t}var se="function"==typeof WeakMap&&!("object"==typeof navigator&&"ReactNative"===navigator.product),oe=Object.prototype.toString;function le(e){return function e(t,r){switch(oe.call(t)){case"[object Array]":if(r.has(t))return r.get(t);var i=t.slice(0);return r.set(t,i),i.forEach(function(t,n){i[n]=e(t,r)}),i;case"[object Object]":if(r.has(t))return r.get(t);var n=Object.create(Object.getPrototypeOf(t));return r.set(t,n),Object.keys(t).forEach(function(i){n[i]=e(t[i],r)}),n;default:return t}}(e,new Map)}function de(){return"development"}function ue(e){return"development"===e}function ce(){return!0===ue("production")}function he(){return!0===ue("development")}function me(){return!0===ue("test")}function fe(e){try{return e()}catch(e){console.error&&console.error(e)}}function pe(e){return e.errors&&e.errors.length}function ve(e){if((he()||me())&&!("function"==typeof Symbol&&"string"==typeof Symbol("")))return function e(t){return Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(r){null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||e(t[r])}),t}(e);return e}var _e=Object.prototype.hasOwnProperty;function ge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return be(e)}function be(e){var t=e[0]||{},r=e.length;if(r>1){var i=[];t=we(t,i);for(var n=1;n<r;++n)t=xe(t,e[n],i)}return t}function ye(e){return null!==e&&"object"==typeof e}function xe(e,t,r){return ye(t)&&ye(e)?(Object.isExtensible&&!Object.isExtensible(e)&&(e=we(e,r)),Object.keys(t).forEach(function(i){var n=t[i];if(_e.call(e,i)){var a=e[i];n!==a&&(e[i]=xe(we(a,r),n,r))}else e[i]=n}),e):t}function we(e,t){return null!==e&&"object"==typeof e&&t.indexOf(e)<0&&(e=Array.isArray(e)?e.slice(0):Object(a.__assign)({__proto__:Object.getPrototypeOf(e)},e),t.push(e)),e}var Ee=Object.create({});function Me(e,t){void 0===t&&(t="warn"),ce()||Ee[e]||(me()||(Ee[e]=!0),"error"===t?console.error(e):console.warn(e))}function Ae(e){return JSON.parse(JSON.stringify(e))}}.call(this,r("./node_modules/process/browser.js"))},"./node_modules/axios/index.js":function(e,t,r){e.exports=r("./node_modules/axios/lib/axios.js")},"./node_modules/axios/lib/adapters/xhr.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js"),n=r("./node_modules/axios/lib/core/settle.js"),a=r("./node_modules/axios/lib/helpers/buildURL.js"),s=r("./node_modules/axios/lib/helpers/parseHeaders.js"),o=r("./node_modules/axios/lib/helpers/isURLSameOrigin.js"),l=r("./node_modules/axios/lib/core/createError.js");e.exports=function(e){return new Promise(function(t,d){var u=e.data,c=e.headers;i.isFormData(u)&&delete c["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",f=e.auth.password||"";c.Authorization="Basic "+btoa(m+":"+f)}if(h.open(e.method.toUpperCase(),a(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in h?s(h.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:r,config:e,request:h};n(t,d,i),h=null}},h.onerror=function(){d(l("Network Error",e,null,h)),h=null},h.ontimeout=function(){d(l("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",h)),h=null},i.isStandardBrowserEnv()){var p=r("./node_modules/axios/lib/helpers/cookies.js"),v=(e.withCredentials||o(e.url))&&e.xsrfCookieName?p.read(e.xsrfCookieName):void 0;v&&(c[e.xsrfHeaderName]=v)}if("setRequestHeader"in h&&i.forEach(c,function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete c[t]:h.setRequestHeader(t,e)}),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){h&&(h.abort(),d(e),h=null)}),void 0===u&&(u=null),h.send(u)})}},"./node_modules/axios/lib/axios.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js"),n=r("./node_modules/axios/lib/helpers/bind.js"),a=r("./node_modules/axios/lib/core/Axios.js"),s=r("./node_modules/axios/lib/defaults.js");function o(e){var t=new a(e),r=n(a.prototype.request,t);return i.extend(r,a.prototype,t),i.extend(r,t),r}var l=o(s);l.Axios=a,l.create=function(e){return o(i.merge(s,e))},l.Cancel=r("./node_modules/axios/lib/cancel/Cancel.js"),l.CancelToken=r("./node_modules/axios/lib/cancel/CancelToken.js"),l.isCancel=r("./node_modules/axios/lib/cancel/isCancel.js"),l.all=function(e){return Promise.all(e)},l.spread=r("./node_modules/axios/lib/helpers/spread.js"),e.exports=l,e.exports.default=l},"./node_modules/axios/lib/cancel/Cancel.js":function(e,t,r){"use strict";function i(e){this.message=e}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,e.exports=i},"./node_modules/axios/lib/cancel/CancelToken.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/cancel/Cancel.js");function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new i(e),t(r.reason))})}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e;return{token:new n(function(t){e=t}),cancel:e}},e.exports=n},"./node_modules/axios/lib/cancel/isCancel.js":function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},"./node_modules/axios/lib/core/Axios.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/defaults.js"),n=r("./node_modules/axios/lib/utils.js"),a=r("./node_modules/axios/lib/core/InterceptorManager.js"),s=r("./node_modules/axios/lib/core/dispatchRequest.js");function o(e){this.defaults=e,this.interceptors={request:new a,response:new a}}o.prototype.request=function(e){"string"==typeof e&&(e=n.merge({url:arguments[0]},arguments[1])),(e=n.merge(i,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[s,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},n.forEach(["delete","get","head","options"],function(e){o.prototype[e]=function(t,r){return this.request(n.merge(r||{},{method:e,url:t}))}}),n.forEach(["post","put","patch"],function(e){o.prototype[e]=function(t,r,i){return this.request(n.merge(i||{},{method:e,url:t,data:r}))}}),e.exports=o},"./node_modules/axios/lib/core/InterceptorManager.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js");function n(){this.handlers=[]}n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){i.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=n},"./node_modules/axios/lib/core/createError.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/core/enhanceError.js");e.exports=function(e,t,r,n,a){var s=new Error(e);return i(s,t,r,n,a)}},"./node_modules/axios/lib/core/dispatchRequest.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js"),n=r("./node_modules/axios/lib/core/transformData.js"),a=r("./node_modules/axios/lib/cancel/isCancel.js"),s=r("./node_modules/axios/lib/defaults.js"),o=r("./node_modules/axios/lib/helpers/isAbsoluteURL.js"),l=r("./node_modules/axios/lib/helpers/combineURLs.js");function d(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return d(e),e.baseURL&&!o(e.url)&&(e.url=l(e.baseURL,e.url)),e.headers=e.headers||{},e.data=n(e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),i.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||s.adapter)(e).then(function(t){return d(e),t.data=n(t.data,t.headers,e.transformResponse),t},function(t){return a(t)||(d(e),t&&t.response&&(t.response.data=n(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},"./node_modules/axios/lib/core/enhanceError.js":function(e,t,r){"use strict";e.exports=function(e,t,r,i,n){return e.config=t,r&&(e.code=r),e.request=i,e.response=n,e}},"./node_modules/axios/lib/core/settle.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/core/createError.js");e.exports=function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(i("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},"./node_modules/axios/lib/core/transformData.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js");e.exports=function(e,t,r){return i.forEach(r,function(r){e=r(e,t)}),e}},"./node_modules/axios/lib/defaults.js":function(e,t,r){"use strict";(function(t){var i=r("./node_modules/axios/lib/utils.js"),n=r("./node_modules/axios/lib/helpers/normalizeHeaderName.js"),a={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var o,l={adapter:("undefined"!=typeof XMLHttpRequest?o=r("./node_modules/axios/lib/adapters/xhr.js"):void 0!==t&&(o=r("./node_modules/axios/lib/adapters/xhr.js")),o),transformRequest:[function(e,t){return n(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],function(e){l.headers[e]={}}),i.forEach(["post","put","patch"],function(e){l.headers[e]=i.merge(a)}),e.exports=l}).call(this,r("./node_modules/process/browser.js"))},"./node_modules/axios/lib/helpers/bind.js":function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return e.apply(t,r)}}},"./node_modules/axios/lib/helpers/buildURL.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js");function n(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var a;if(r)a=r(t);else if(i.isURLSearchParams(t))a=t.toString();else{var s=[];i.forEach(t,function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),s.push(n(t)+"="+n(e))}))}),a=s.join("&")}return a&&(e+=(-1===e.indexOf("?")?"?":"&")+a),e}},"./node_modules/axios/lib/helpers/combineURLs.js":function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},"./node_modules/axios/lib/helpers/cookies.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js");e.exports=i.isStandardBrowserEnv()?{write:function(e,t,r,n,a,s){var o=[];o.push(e+"="+encodeURIComponent(t)),i.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),i.isString(n)&&o.push("path="+n),i.isString(a)&&o.push("domain="+a),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},"./node_modules/axios/lib/helpers/isAbsoluteURL.js":function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},"./node_modules/axios/lib/helpers/isURLSameOrigin.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js");e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var i=e;return t&&(r.setAttribute("href",i),i=r.href),r.setAttribute("href",i),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=i.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},"./node_modules/axios/lib/helpers/normalizeHeaderName.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js");e.exports=function(e,t){i.forEach(e,function(r,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[i])})}},"./node_modules/axios/lib/helpers/parseHeaders.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/utils.js"),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,a,s={};return e?(i.forEach(e.split("\n"),function(e){if(a=e.indexOf(":"),t=i.trim(e.substr(0,a)).toLowerCase(),r=i.trim(e.substr(a+1)),t){if(s[t]&&n.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([r]):s[t]?s[t]+", "+r:r}}),s):s}},"./node_modules/axios/lib/helpers/spread.js":function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},"./node_modules/axios/lib/utils.js":function(e,t,r){"use strict";var i=r("./node_modules/axios/lib/helpers/bind.js"),n=r("./node_modules/axios/node_modules/is-buffer/index.js"),a=Object.prototype.toString;function s(e){return"[object Array]"===a.call(e)}function o(e){return null!==e&&"object"==typeof e}function l(e){return"[object Function]"===a.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===a.call(e)},isBuffer:n,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:o,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===a.call(e)},isFile:function(e){return"[object File]"===a.call(e)},isBlob:function(e){return"[object Blob]"===a.call(e)},isFunction:l,isStream:function(e){return o(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function e(){var t={};function r(r,i){"object"==typeof t[i]&&"object"==typeof r?t[i]=e(t[i],r):t[i]=r}for(var i=0,n=arguments.length;i<n;i++)d(arguments[i],r);return t},extend:function(e,t,r){return d(t,function(t,n){e[n]=r&&"function"==typeof t?i(t,r):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},"./node_modules/axios/node_modules/is-buffer/index.js":function(e,t){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},"./node_modules/fast-json-stable-stringify/index.js":function(e,t,r){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r,i="boolean"==typeof t.cycles&&t.cycles,n=t.cmp&&(r=t.cmp,function(e){return function(t,i){var n={key:t,value:e[t]},a={key:i,value:e[i]};return r(n,a)}}),a=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var r,s;if(Array.isArray(t)){for(s="[",r=0;r<t.length;r++)r&&(s+=","),s+=e(t[r])||"null";return s+"]"}if(null===t)return"null";if(-1!==a.indexOf(t)){if(i)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var o=a.push(t)-1,l=Object.keys(t).sort(n&&n(t));for(s="",r=0;r<l.length;r++){var d=l[r],u=e(t[d]);u&&(s&&(s+=","),s+=JSON.stringify(d)+":"+u)}return a.splice(o,1),"{"+s+"}"}}(e)}},"./node_modules/graphql/jsutils/inspect.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return l(e,[])};var i,n=(i=r("./node_modules/graphql/jsutils/nodejsCustomInspectSymbol.js"))&&i.__esModule?i:{default:i};function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=10,o=2;function l(e,t){switch(a(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return null===e?"null":function(e,t){if(-1!==t.indexOf(e))return"[Circular]";var r=[].concat(t,[e]),i=function(e){var t=e[String(n.default)];if("function"==typeof t)return t;if("function"==typeof e.inspect)return e.inspect}(e);if(void 0!==i){var a=i.call(e);if(a!==e)return"string"==typeof a?a:l(a,r)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>o)return"[Array]";for(var r=Math.min(s,e.length),i=e.length-r,n=[],a=0;a<r;++a)n.push(l(e[a],t));1===i?n.push("... 1 more item"):i>1&&n.push("... ".concat(i," more items"));return"["+n.join(", ")+"]"}(e,r);return function(e,t){var r=Object.keys(e);if(0===r.length)return"{}";if(t.length>o)return"["+function(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){var r=e.constructor.name;if("string"==typeof r)return r}return t}(e)+"]";return"{ "+r.map(function(r){var i=l(e[r],t);return r+": "+i}).join(", ")+" }"}(e,r)}(e,t);default:return String(e)}}},"./node_modules/graphql/jsutils/nodejsCustomInspectSymbol.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):void 0;t.default=i},"./node_modules/graphql/language/blockString.js":function(e,t,r){"use strict";function i(e){for(var t=null,r=1;r<e.length;r++){var i=e[r],a=n(i);if(a!==i.length&&((null===t||a<t)&&0===(t=a)))break}return null===t?0:t}function n(e){for(var t=0;t<e.length&&(" "===e[t]||"\t"===e[t]);)t++;return t}function a(e){return n(e)===e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.dedentBlockStringValue=function(e){var t=e.split(/\r\n|[\n\r]/g),r=i(t);if(0!==r)for(var n=1;n<t.length;n++)t[n]=t[n].slice(r);for(;t.length>0&&a(t[0]);)t.shift();for(;t.length>0&&a(t[t.length-1]);)t.pop();return t.join("\n")},t.getBlockStringIndentation=i,t.printBlockString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=-1===e.indexOf("\n"),n=" "===e[0]||"\t"===e[0],a='"'===e[e.length-1],s=!i||a||r,o="";!s||i&&n||(o+="\n"+t);o+=t?e.replace(/\n/g,"\n"+t):e,s&&(o+="\n");return'"""'+o.replace(/"""/g,'\\"""')+'"""'}},"./node_modules/graphql/language/printer.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.print=function(e){return(0,i.visit)(e,{leave:a})};var i=r("./node_modules/graphql/language/visitor.js"),n=r("./node_modules/graphql/language/blockString.js");var a={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return o(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var t=e.operation,r=e.name,i=d("(",o(e.variableDefinitions,", "),")"),n=o(e.directives," "),a=e.selectionSet;return r||n||i||"query"!==t?o([t,o([r,i]),n,a]," "):a},VariableDefinition:function(e){var t=e.variable,r=e.type,i=e.defaultValue,n=e.directives;return t+": "+r+d(" = ",i)+d(" ",o(n," "))},SelectionSet:function(e){return l(e.selections)},Field:function(e){var t=e.alias,r=e.name,i=e.arguments,n=e.directives,a=e.selectionSet;return o([d("",t,": ")+r+d("(",o(i,", "),")"),o(n," "),a]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+d(" ",o(e.directives," "))},InlineFragment:function(e){var t=e.typeCondition,r=e.directives,i=e.selectionSet;return o(["...",d("on ",t),o(r," "),i]," ")},FragmentDefinition:function(e){var t=e.name,r=e.typeCondition,i=e.variableDefinitions,n=e.directives,a=e.selectionSet;return"fragment ".concat(t).concat(d("(",o(i,", "),")")," ")+"on ".concat(r," ").concat(d("",o(n," ")," "))+a},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e,t){var r=e.value;return e.block?(0,n.printBlockString)(r,"description"===t?"":"  "):JSON.stringify(r)},BooleanValue:function(e){return e.value?"true":"false"},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+o(e.values,", ")+"]"},ObjectValue:function(e){return"{"+o(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+d("(",o(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:function(e){var t=e.directives,r=e.operationTypes;return o(["schema",o(t," "),l(r)]," ")},OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:s(function(e){return o(["scalar",e.name,o(e.directives," ")]," ")}),ObjectTypeDefinition:s(function(e){var t=e.name,r=e.interfaces,i=e.directives,n=e.fields;return o(["type",t,d("implements ",o(r," & ")),o(i," "),l(n)]," ")}),FieldDefinition:s(function(e){var t=e.name,r=e.arguments,i=e.type,n=e.directives;return t+(h(r)?d("(\n",u(o(r,"\n")),"\n)"):d("(",o(r,", "),")"))+": "+i+d(" ",o(n," "))}),InputValueDefinition:s(function(e){var t=e.name,r=e.type,i=e.defaultValue,n=e.directives;return o([t+": "+r,d("= ",i),o(n," ")]," ")}),InterfaceTypeDefinition:s(function(e){var t=e.name,r=e.directives,i=e.fields;return o(["interface",t,o(r," "),l(i)]," ")}),UnionTypeDefinition:s(function(e){var t=e.name,r=e.directives,i=e.types;return o(["union",t,o(r," "),i&&0!==i.length?"= "+o(i," | "):""]," ")}),EnumTypeDefinition:s(function(e){var t=e.name,r=e.directives,i=e.values;return o(["enum",t,o(r," "),l(i)]," ")}),EnumValueDefinition:s(function(e){return o([e.name,o(e.directives," ")]," ")}),InputObjectTypeDefinition:s(function(e){var t=e.name,r=e.directives,i=e.fields;return o(["input",t,o(r," "),l(i)]," ")}),DirectiveDefinition:s(function(e){var t=e.name,r=e.arguments,i=e.repeatable,n=e.locations;return"directive @"+t+(h(r)?d("(\n",u(o(r,"\n")),"\n)"):d("(",o(r,", "),")"))+(i?" repeatable":"")+" on "+o(n," | ")}),SchemaExtension:function(e){var t=e.directives,r=e.operationTypes;return o(["extend schema",o(t," "),l(r)]," ")},ScalarTypeExtension:function(e){return o(["extend scalar",e.name,o(e.directives," ")]," ")},ObjectTypeExtension:function(e){var t=e.name,r=e.interfaces,i=e.directives,n=e.fields;return o(["extend type",t,d("implements ",o(r," & ")),o(i," "),l(n)]," ")},InterfaceTypeExtension:function(e){var t=e.name,r=e.directives,i=e.fields;return o(["extend interface",t,o(r," "),l(i)]," ")},UnionTypeExtension:function(e){var t=e.name,r=e.directives,i=e.types;return o(["extend union",t,o(r," "),i&&0!==i.length?"= "+o(i," | "):""]," ")},EnumTypeExtension:function(e){var t=e.name,r=e.directives,i=e.values;return o(["extend enum",t,o(r," "),l(i)]," ")},InputObjectTypeExtension:function(e){var t=e.name,r=e.directives,i=e.fields;return o(["extend input",t,o(r," "),l(i)]," ")}};function s(e){return function(t){return o([t.description,e(t)],"\n")}}function o(e,t){return e?e.filter(function(e){return e}).join(t||""):""}function l(e){return e&&0!==e.length?"{\n"+u(o(e,"\n"))+"\n}":""}function d(e,t,r){return t?e+t+(r||""):""}function u(e){return e&&"  "+e.replace(/\n/g,"\n  ")}function c(e){return-1!==e.indexOf("\n")}function h(e){return e&&e.some(c)}},"./node_modules/graphql/language/visitor.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.visit=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,i=void 0,d=Array.isArray(e),u=[e],c=-1,h=[],m=void 0,f=void 0,p=void 0,v=[],_=[],g=e;do{var b=++c===u.length,y=b&&0!==h.length;if(b){if(f=0===_.length?void 0:v[v.length-1],m=p,p=_.pop(),y){if(d)m=m.slice();else{for(var x={},w=0,E=Object.keys(m);w<E.length;w++){var M=E[w];x[M]=m[M]}m=x}for(var A=0,T=0;T<h.length;T++){var S=h[T][0],k=h[T][1];d&&(S-=A),d&&null===k?(m.splice(S,1),A++):m[S]=k}}c=i.index,u=i.keys,h=i.edits,d=i.inArray,i=i.prev}else{if(f=p?d?c:u[c]:void 0,null==(m=p?p[f]:g))continue;p&&v.push(f)}var D=void 0;if(!Array.isArray(m)){if(!o(m))throw new Error("Invalid AST Node: "+(0,n.default)(m));var I=l(t,m.kind,b);if(I){if((D=I.call(t,m,f,p,v,_))===s)break;if(!1===D){if(!b){v.pop();continue}}else if(void 0!==D&&(h.push([f,D]),!b)){if(!o(D)){v.pop();continue}m=D}}}void 0===D&&y&&h.push([f,m]),b?v.pop():(i={inArray:d,index:c,keys:u,edits:h,prev:i},d=Array.isArray(m),u=d?m:r[m.kind]||[],c=-1,h=[],p&&_.push(p),p=m)}while(void 0!==i);0!==h.length&&(g=h[h.length-1][1]);return g},t.visitInParallel=function(e){var t=new Array(e.length);return{enter:function(r){for(var i=0;i<e.length;i++)if(!t[i]){var n=l(e[i],r.kind,!1);if(n){var a=n.apply(e[i],arguments);if(!1===a)t[i]=r;else if(a===s)t[i]=s;else if(void 0!==a)return a}}},leave:function(r){for(var i=0;i<e.length;i++)if(t[i])t[i]===r&&(t[i]=null);else{var n=l(e[i],r.kind,!0);if(n){var a=n.apply(e[i],arguments);if(a===s)t[i]=s;else if(void 0!==a&&!1!==a)return a}}}}},t.visitWithTypeInfo=function(e,t){return{enter:function(r){e.enter(r);var i=l(t,r.kind,!1);if(i){var n=i.apply(t,arguments);return void 0!==n&&(e.leave(r),o(n)&&e.enter(n)),n}},leave:function(r){var i,n=l(t,r.kind,!0);return n&&(i=n.apply(t,arguments)),e.leave(r),i}}},t.getVisitFn=l,t.BREAK=t.QueryDocumentKeys=void 0;var i,n=(i=r("./node_modules/graphql/jsutils/inspect.js"))&&i.__esModule?i:{default:i};var a={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]};t.QueryDocumentKeys=a;var s=Object.freeze({});function o(e){return Boolean(e&&"string"==typeof e.kind)}function l(e,t,r){var i=e[t];if(i){if(!r&&"function"==typeof i)return i;var n=r?i.leave:i.enter;if("function"==typeof n)return n}else{var a=r?e.leave:e.enter;if(a){if("function"==typeof a)return a;var s=a[t];if("function"==typeof s)return s}}}t.BREAK=s},"./node_modules/mime/Mime.js":function(e,t,r){"use strict";function i(){this._types=Object.create(null),this._extensions=Object.create(null);for(var e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}i.prototype.define=function(e,t){for(var r in e){var i=e[r].map(function(e){return e.toLowerCase()});r=r.toLowerCase();for(var n=0;n<i.length;n++){if("*"!=(a=i[n])[0]){if(!t&&a in this._types)throw new Error('Attempt to change mapping for "'+a+'" extension from "'+this._types[a]+'" to "'+r+'". Pass `force=true` to allow this, otherwise remove "'+a+'" from the list of extensions for "'+r+'".');this._types[a]=r}}if(t||!this._extensions[r]){var a=i[0];this._extensions[r]="*"!=a[0]?a:a.substr(1)}}},i.prototype.getType=function(e){var t=(e=String(e)).replace(/^.*[\/\\]/,"").toLowerCase(),r=t.replace(/^.*\./,"").toLowerCase(),i=t.length<e.length;return(r.length<t.length-1||!i)&&this._types[r]||null},i.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null},e.exports=i},"./node_modules/mime/index.js":function(e,t,r){"use strict";var i=r("./node_modules/mime/Mime.js");e.exports=new i(r("./node_modules/mime/types/standard.js"),r("./node_modules/mime/types/other.js"))},"./node_modules/mime/types/other.js":function(e,t){e.exports={"application/prs.cww":["cww"],"application/vnd.3gpp.pic-bw-large":["plb"],"application/vnd.3gpp.pic-bw-small":["psb"],"application/vnd.3gpp.pic-bw-var":["pvb"],"application/vnd.3gpp2.tcap":["tcap"],"application/vnd.3m.post-it-notes":["pwn"],"application/vnd.accpac.simply.aso":["aso"],"application/vnd.accpac.simply.imp":["imp"],"application/vnd.acucobol":["acu"],"application/vnd.acucorp":["atc","acutc"],"application/vnd.adobe.air-application-installer-package+zip":["air"],"application/vnd.adobe.formscentral.fcdt":["fcdt"],"application/vnd.adobe.fxp":["fxp","fxpl"],"application/vnd.adobe.xdp+xml":["xdp"],"application/vnd.adobe.xfdf":["xfdf"],"application/vnd.ahead.space":["ahead"],"application/vnd.airzip.filesecure.azf":["azf"],"application/vnd.airzip.filesecure.azs":["azs"],"application/vnd.amazon.ebook":["azw"],"application/vnd.americandynamics.acc":["acc"],"application/vnd.amiga.ami":["ami"],"application/vnd.android.package-archive":["apk"],"application/vnd.anser-web-certificate-issue-initiation":["cii"],"application/vnd.anser-web-funds-transfer-initiation":["fti"],"application/vnd.antix.game-component":["atx"],"application/vnd.apple.installer+xml":["mpkg"],"application/vnd.apple.keynote":["keynote"],"application/vnd.apple.mpegurl":["m3u8"],"application/vnd.apple.numbers":["numbers"],"application/vnd.apple.pages":["pages"],"application/vnd.apple.pkpass":["pkpass"],"application/vnd.aristanetworks.swi":["swi"],"application/vnd.astraea-software.iota":["iota"],"application/vnd.audiograph":["aep"],"application/vnd.blueice.multipass":["mpm"],"application/vnd.bmi":["bmi"],"application/vnd.businessobjects":["rep"],"application/vnd.chemdraw+xml":["cdxml"],"application/vnd.chipnuts.karaoke-mmd":["mmd"],"application/vnd.cinderella":["cdy"],"application/vnd.citationstyles.style+xml":["csl"],"application/vnd.claymore":["cla"],"application/vnd.cloanto.rp9":["rp9"],"application/vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"application/vnd.cluetrust.cartomobile-config":["c11amc"],"application/vnd.cluetrust.cartomobile-config-pkg":["c11amz"],"application/vnd.commonspace":["csp"],"application/vnd.contact.cmsg":["cdbcmsg"],"application/vnd.cosmocaller":["cmc"],"application/vnd.crick.clicker":["clkx"],"application/vnd.crick.clicker.keyboard":["clkk"],"application/vnd.crick.clicker.palette":["clkp"],"application/vnd.crick.clicker.template":["clkt"],"application/vnd.crick.clicker.wordbank":["clkw"],"application/vnd.criticaltools.wbs+xml":["wbs"],"application/vnd.ctc-posml":["pml"],"application/vnd.cups-ppd":["ppd"],"application/vnd.curl.car":["car"],"application/vnd.curl.pcurl":["pcurl"],"application/vnd.dart":["dart"],"application/vnd.data-vision.rdz":["rdz"],"application/vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"application/vnd.dece.ttml+xml":["uvt","uvvt"],"application/vnd.dece.unspecified":["uvx","uvvx"],"application/vnd.dece.zip":["uvz","uvvz"],"application/vnd.denovo.fcselayout-link":["fe_launch"],"application/vnd.dna":["dna"],"application/vnd.dolby.mlp":["mlp"],"application/vnd.dpgraph":["dpg"],"application/vnd.dreamfactory":["dfac"],"application/vnd.ds-keypoint":["kpxx"],"application/vnd.dvb.ait":["ait"],"application/vnd.dvb.service":["svc"],"application/vnd.dynageo":["geo"],"application/vnd.ecowin.chart":["mag"],"application/vnd.enliven":["nml"],"application/vnd.epson.esf":["esf"],"application/vnd.epson.msf":["msf"],"application/vnd.epson.quickanime":["qam"],"application/vnd.epson.salt":["slt"],"application/vnd.epson.ssf":["ssf"],"application/vnd.eszigno3+xml":["es3","et3"],"application/vnd.ezpix-album":["ez2"],"application/vnd.ezpix-package":["ez3"],"application/vnd.fdf":["fdf"],"application/vnd.fdsn.mseed":["mseed"],"application/vnd.fdsn.seed":["seed","dataless"],"application/vnd.flographit":["gph"],"application/vnd.fluxtime.clip":["ftc"],"application/vnd.framemaker":["fm","frame","maker","book"],"application/vnd.frogans.fnc":["fnc"],"application/vnd.frogans.ltf":["ltf"],"application/vnd.fsc.weblaunch":["fsc"],"application/vnd.fujitsu.oasys":["oas"],"application/vnd.fujitsu.oasys2":["oa2"],"application/vnd.fujitsu.oasys3":["oa3"],"application/vnd.fujitsu.oasysgp":["fg5"],"application/vnd.fujitsu.oasysprs":["bh2"],"application/vnd.fujixerox.ddd":["ddd"],"application/vnd.fujixerox.docuworks":["xdw"],"application/vnd.fujixerox.docuworks.binder":["xbd"],"application/vnd.fuzzysheet":["fzs"],"application/vnd.genomatix.tuxedo":["txd"],"application/vnd.geogebra.file":["ggb"],"application/vnd.geogebra.tool":["ggt"],"application/vnd.geometry-explorer":["gex","gre"],"application/vnd.geonext":["gxt"],"application/vnd.geoplan":["g2w"],"application/vnd.geospace":["g3w"],"application/vnd.gmx":["gmx"],"application/vnd.google-apps.document":["gdoc"],"application/vnd.google-apps.presentation":["gslides"],"application/vnd.google-apps.spreadsheet":["gsheet"],"application/vnd.google-earth.kml+xml":["kml"],"application/vnd.google-earth.kmz":["kmz"],"application/vnd.grafeq":["gqf","gqs"],"application/vnd.groove-account":["gac"],"application/vnd.groove-help":["ghf"],"application/vnd.groove-identity-message":["gim"],"application/vnd.groove-injector":["grv"],"application/vnd.groove-tool-message":["gtm"],"application/vnd.groove-tool-template":["tpl"],"application/vnd.groove-vcard":["vcg"],"application/vnd.hal+xml":["hal"],"application/vnd.handheld-entertainment+xml":["zmm"],"application/vnd.hbci":["hbci"],"application/vnd.hhe.lesson-player":["les"],"application/vnd.hp-hpgl":["hpgl"],"application/vnd.hp-hpid":["hpid"],"application/vnd.hp-hps":["hps"],"application/vnd.hp-jlyt":["jlt"],"application/vnd.hp-pcl":["pcl"],"application/vnd.hp-pclxl":["pclxl"],"application/vnd.hydrostatix.sof-data":["sfd-hdstx"],"application/vnd.ibm.minipay":["mpy"],"application/vnd.ibm.modcap":["afp","listafp","list3820"],"application/vnd.ibm.rights-management":["irm"],"application/vnd.ibm.secure-container":["sc"],"application/vnd.iccprofile":["icc","icm"],"application/vnd.igloader":["igl"],"application/vnd.immervision-ivp":["ivp"],"application/vnd.immervision-ivu":["ivu"],"application/vnd.insors.igm":["igm"],"application/vnd.intercon.formnet":["xpw","xpx"],"application/vnd.intergeo":["i2g"],"application/vnd.intu.qbo":["qbo"],"application/vnd.intu.qfx":["qfx"],"application/vnd.ipunplugged.rcprofile":["rcprofile"],"application/vnd.irepository.package+xml":["irp"],"application/vnd.is-xpr":["xpr"],"application/vnd.isac.fcs":["fcs"],"application/vnd.jam":["jam"],"application/vnd.jcp.javame.midlet-rms":["rms"],"application/vnd.jisp":["jisp"],"application/vnd.joost.joda-archive":["joda"],"application/vnd.kahootz":["ktz","ktr"],"application/vnd.kde.karbon":["karbon"],"application/vnd.kde.kchart":["chrt"],"application/vnd.kde.kformula":["kfo"],"application/vnd.kde.kivio":["flw"],"application/vnd.kde.kontour":["kon"],"application/vnd.kde.kpresenter":["kpr","kpt"],"application/vnd.kde.kspread":["ksp"],"application/vnd.kde.kword":["kwd","kwt"],"application/vnd.kenameaapp":["htke"],"application/vnd.kidspiration":["kia"],"application/vnd.kinar":["kne","knp"],"application/vnd.koan":["skp","skd","skt","skm"],"application/vnd.kodak-descriptor":["sse"],"application/vnd.las.las+xml":["lasxml"],"application/vnd.llamagraphics.life-balance.desktop":["lbd"],"application/vnd.llamagraphics.life-balance.exchange+xml":["lbe"],"application/vnd.lotus-1-2-3":["123"],"application/vnd.lotus-approach":["apr"],"application/vnd.lotus-freelance":["pre"],"application/vnd.lotus-notes":["nsf"],"application/vnd.lotus-organizer":["org"],"application/vnd.lotus-screencam":["scm"],"application/vnd.lotus-wordpro":["lwp"],"application/vnd.macports.portpkg":["portpkg"],"application/vnd.mcd":["mcd"],"application/vnd.medcalcdata":["mc1"],"application/vnd.mediastation.cdkey":["cdkey"],"application/vnd.mfer":["mwf"],"application/vnd.mfmp":["mfm"],"application/vnd.micrografx.flo":["flo"],"application/vnd.micrografx.igx":["igx"],"application/vnd.mif":["mif"],"application/vnd.mobius.daf":["daf"],"application/vnd.mobius.dis":["dis"],"application/vnd.mobius.mbk":["mbk"],"application/vnd.mobius.mqy":["mqy"],"application/vnd.mobius.msl":["msl"],"application/vnd.mobius.plc":["plc"],"application/vnd.mobius.txf":["txf"],"application/vnd.mophun.application":["mpn"],"application/vnd.mophun.certificate":["mpc"],"application/vnd.mozilla.xul+xml":["xul"],"application/vnd.ms-artgalry":["cil"],"application/vnd.ms-cab-compressed":["cab"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.addin.macroenabled.12":["xlam"],"application/vnd.ms-excel.sheet.binary.macroenabled.12":["xlsb"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.ms-excel.template.macroenabled.12":["xltm"],"application/vnd.ms-fontobject":["eot"],"application/vnd.ms-htmlhelp":["chm"],"application/vnd.ms-ims":["ims"],"application/vnd.ms-lrm":["lrm"],"application/vnd.ms-officetheme":["thmx"],"application/vnd.ms-outlook":["msg"],"application/vnd.ms-pki.seccat":["cat"],"application/vnd.ms-pki.stl":["*stl"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.ms-powerpoint.addin.macroenabled.12":["ppam"],"application/vnd.ms-powerpoint.presentation.macroenabled.12":["pptm"],"application/vnd.ms-powerpoint.slide.macroenabled.12":["sldm"],"application/vnd.ms-powerpoint.slideshow.macroenabled.12":["ppsm"],"application/vnd.ms-powerpoint.template.macroenabled.12":["potm"],"application/vnd.ms-project":["mpp","mpt"],"application/vnd.ms-word.document.macroenabled.12":["docm"],"application/vnd.ms-word.template.macroenabled.12":["dotm"],"application/vnd.ms-works":["wps","wks","wcm","wdb"],"application/vnd.ms-wpl":["wpl"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.mseq":["mseq"],"application/vnd.musician":["mus"],"application/vnd.muvee.style":["msty"],"application/vnd.mynfc":["taglet"],"application/vnd.neurolanguage.nlu":["nlu"],"application/vnd.nitf":["ntf","nitf"],"application/vnd.noblenet-directory":["nnd"],"application/vnd.noblenet-sealer":["nns"],"application/vnd.noblenet-web":["nnw"],"application/vnd.nokia.n-gage.data":["ngdat"],"application/vnd.nokia.n-gage.symbian.install":["n-gage"],"application/vnd.nokia.radio-preset":["rpst"],"application/vnd.nokia.radio-presets":["rpss"],"application/vnd.novadigm.edm":["edm"],"application/vnd.novadigm.edx":["edx"],"application/vnd.novadigm.ext":["ext"],"application/vnd.oasis.opendocument.chart":["odc"],"application/vnd.oasis.opendocument.chart-template":["otc"],"application/vnd.oasis.opendocument.database":["odb"],"application/vnd.oasis.opendocument.formula":["odf"],"application/vnd.oasis.opendocument.formula-template":["odft"],"application/vnd.oasis.opendocument.graphics":["odg"],"application/vnd.oasis.opendocument.graphics-template":["otg"],"application/vnd.oasis.opendocument.image":["odi"],"application/vnd.oasis.opendocument.image-template":["oti"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.presentation-template":["otp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.spreadsheet-template":["ots"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.oasis.opendocument.text-master":["odm"],"application/vnd.oasis.opendocument.text-template":["ott"],"application/vnd.oasis.opendocument.text-web":["oth"],"application/vnd.olpc-sugar":["xo"],"application/vnd.oma.dd2+xml":["dd2"],"application/vnd.openofficeorg.extension":["oxt"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.osgeo.mapguide.package":["mgp"],"application/vnd.osgi.dp":["dp"],"application/vnd.osgi.subsystem":["esa"],"application/vnd.palm":["pdb","pqa","oprc"],"application/vnd.pawaafile":["paw"],"application/vnd.pg.format":["str"],"application/vnd.pg.osasli":["ei6"],"application/vnd.picsel":["efif"],"application/vnd.pmi.widget":["wg"],"application/vnd.pocketlearn":["plf"],"application/vnd.powerbuilder6":["pbd"],"application/vnd.previewsystems.box":["box"],"application/vnd.proteus.magazine":["mgz"],"application/vnd.publishare-delta-tree":["qps"],"application/vnd.pvi.ptid1":["ptid"],"application/vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"application/vnd.realvnc.bed":["bed"],"application/vnd.recordare.musicxml":["mxl"],"application/vnd.recordare.musicxml+xml":["musicxml"],"application/vnd.rig.cryptonote":["cryptonote"],"application/vnd.rim.cod":["cod"],"application/vnd.rn-realmedia":["rm"],"application/vnd.rn-realmedia-vbr":["rmvb"],"application/vnd.route66.link66+xml":["link66"],"application/vnd.sailingtracker.track":["st"],"application/vnd.seemail":["see"],"application/vnd.sema":["sema"],"application/vnd.semd":["semd"],"application/vnd.semf":["semf"],"application/vnd.shana.informed.formdata":["ifm"],"application/vnd.shana.informed.formtemplate":["itp"],"application/vnd.shana.informed.interchange":["iif"],"application/vnd.shana.informed.package":["ipk"],"application/vnd.simtech-mindmapper":["twd","twds"],"application/vnd.smaf":["mmf"],"application/vnd.smart.teacher":["teacher"],"application/vnd.solent.sdkm+xml":["sdkm","sdkd"],"application/vnd.spotfire.dxp":["dxp"],"application/vnd.spotfire.sfs":["sfs"],"application/vnd.stardivision.calc":["sdc"],"application/vnd.stardivision.draw":["sda"],"application/vnd.stardivision.impress":["sdd"],"application/vnd.stardivision.math":["smf"],"application/vnd.stardivision.writer":["sdw","vor"],"application/vnd.stardivision.writer-global":["sgl"],"application/vnd.stepmania.package":["smzip"],"application/vnd.stepmania.stepchart":["sm"],"application/vnd.sun.wadl+xml":["wadl"],"application/vnd.sun.xml.calc":["sxc"],"application/vnd.sun.xml.calc.template":["stc"],"application/vnd.sun.xml.draw":["sxd"],"application/vnd.sun.xml.draw.template":["std"],"application/vnd.sun.xml.impress":["sxi"],"application/vnd.sun.xml.impress.template":["sti"],"application/vnd.sun.xml.math":["sxm"],"application/vnd.sun.xml.writer":["sxw"],"application/vnd.sun.xml.writer.global":["sxg"],"application/vnd.sun.xml.writer.template":["stw"],"application/vnd.sus-calendar":["sus","susp"],"application/vnd.svd":["svd"],"application/vnd.symbian.install":["sis","sisx"],"application/vnd.syncml+xml":["xsm"],"application/vnd.syncml.dm+wbxml":["bdm"],"application/vnd.syncml.dm+xml":["xdm"],"application/vnd.tao.intent-module-archive":["tao"],"application/vnd.tcpdump.pcap":["pcap","cap","dmp"],"application/vnd.tmobile-livetv":["tmo"],"application/vnd.trid.tpt":["tpt"],"application/vnd.triscape.mxs":["mxs"],"application/vnd.trueapp":["tra"],"application/vnd.ufdl":["ufd","ufdl"],"application/vnd.uiq.theme":["utz"],"application/vnd.umajin":["umj"],"application/vnd.unity":["unityweb"],"application/vnd.uoml+xml":["uoml"],"application/vnd.vcx":["vcx"],"application/vnd.visio":["vsd","vst","vss","vsw"],"application/vnd.visionary":["vis"],"application/vnd.vsf":["vsf"],"application/vnd.wap.wbxml":["wbxml"],"application/vnd.wap.wmlc":["wmlc"],"application/vnd.wap.wmlscriptc":["wmlsc"],"application/vnd.webturbo":["wtb"],"application/vnd.wolfram.player":["nbp"],"application/vnd.wordperfect":["wpd"],"application/vnd.wqd":["wqd"],"application/vnd.wt.stf":["stf"],"application/vnd.xara":["xar"],"application/vnd.xfdl":["xfdl"],"application/vnd.yamaha.hv-dic":["hvd"],"application/vnd.yamaha.hv-script":["hvs"],"application/vnd.yamaha.hv-voice":["hvp"],"application/vnd.yamaha.openscoreformat":["osf"],"application/vnd.yamaha.openscoreformat.osfpvg+xml":["osfpvg"],"application/vnd.yamaha.smaf-audio":["saf"],"application/vnd.yamaha.smaf-phrase":["spf"],"application/vnd.yellowriver-custom-menu":["cmp"],"application/vnd.zul":["zir","zirz"],"application/vnd.zzazz.deck+xml":["zaz"],"application/x-7z-compressed":["7z"],"application/x-abiword":["abw"],"application/x-ace-compressed":["ace"],"application/x-apple-diskimage":["*dmg"],"application/x-arj":["arj"],"application/x-authorware-bin":["aab","x32","u32","vox"],"application/x-authorware-map":["aam"],"application/x-authorware-seg":["aas"],"application/x-bcpio":["bcpio"],"application/x-bdoc":["*bdoc"],"application/x-bittorrent":["torrent"],"application/x-blorb":["blb","blorb"],"application/x-bzip":["bz"],"application/x-bzip2":["bz2","boz"],"application/x-cbr":["cbr","cba","cbt","cbz","cb7"],"application/x-cdlink":["vcd"],"application/x-cfs-compressed":["cfs"],"application/x-chat":["chat"],"application/x-chess-pgn":["pgn"],"application/x-chrome-extension":["crx"],"application/x-cocoa":["cco"],"application/x-conference":["nsc"],"application/x-cpio":["cpio"],"application/x-csh":["csh"],"application/x-debian-package":["*deb","udeb"],"application/x-dgc-compressed":["dgc"],"application/x-director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"application/x-doom":["wad"],"application/x-dtbncx+xml":["ncx"],"application/x-dtbook+xml":["dtb"],"application/x-dtbresource+xml":["res"],"application/x-dvi":["dvi"],"application/x-envoy":["evy"],"application/x-eva":["eva"],"application/x-font-bdf":["bdf"],"application/x-font-ghostscript":["gsf"],"application/x-font-linux-psf":["psf"],"application/x-font-pcf":["pcf"],"application/x-font-snf":["snf"],"application/x-font-type1":["pfa","pfb","pfm","afm"],"application/x-freearc":["arc"],"application/x-futuresplash":["spl"],"application/x-gca-compressed":["gca"],"application/x-glulx":["ulx"],"application/x-gnumeric":["gnumeric"],"application/x-gramps-xml":["gramps"],"application/x-gtar":["gtar"],"application/x-hdf":["hdf"],"application/x-httpd-php":["php"],"application/x-install-instructions":["install"],"application/x-iso9660-image":["*iso"],"application/x-java-archive-diff":["jardiff"],"application/x-java-jnlp-file":["jnlp"],"application/x-latex":["latex"],"application/x-lua-bytecode":["luac"],"application/x-lzh-compressed":["lzh","lha"],"application/x-makeself":["run"],"application/x-mie":["mie"],"application/x-mobipocket-ebook":["prc","mobi"],"application/x-ms-application":["application"],"application/x-ms-shortcut":["lnk"],"application/x-ms-wmd":["wmd"],"application/x-ms-wmz":["wmz"],"application/x-ms-xbap":["xbap"],"application/x-msaccess":["mdb"],"application/x-msbinder":["obd"],"application/x-mscardfile":["crd"],"application/x-msclip":["clp"],"application/x-msdos-program":["*exe"],"application/x-msdownload":["*exe","*dll","com","bat","*msi"],"application/x-msmediaview":["mvb","m13","m14"],"application/x-msmetafile":["*wmf","*wmz","*emf","emz"],"application/x-msmoney":["mny"],"application/x-mspublisher":["pub"],"application/x-msschedule":["scd"],"application/x-msterminal":["trm"],"application/x-mswrite":["wri"],"application/x-netcdf":["nc","cdf"],"application/x-ns-proxy-autoconfig":["pac"],"application/x-nzb":["nzb"],"application/x-perl":["pl","pm"],"application/x-pilot":["*prc","*pdb"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b","spc"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["rar"],"application/x-redhat-package-manager":["rpm"],"application/x-research-info-systems":["ris"],"application/x-sea":["sea"],"application/x-sh":["sh"],"application/x-shar":["shar"],"application/x-shockwave-flash":["swf"],"application/x-silverlight-app":["xap"],"application/x-sql":["sql"],"application/x-stuffit":["sit"],"application/x-stuffitx":["sitx"],"application/x-subrip":["srt"],"application/x-sv4cpio":["sv4cpio"],"application/x-sv4crc":["sv4crc"],"application/x-t3vm-image":["t3"],"application/x-tads":["gam"],"application/x-tar":["tar"],"application/x-tcl":["tcl","tk"],"application/x-tex":["tex"],"application/x-tex-tfm":["tfm"],"application/x-texinfo":["texinfo","texi"],"application/x-tgif":["obj"],"application/x-ustar":["ustar"],"application/x-virtualbox-hdd":["hdd"],"application/x-virtualbox-ova":["ova"],"application/x-virtualbox-ovf":["ovf"],"application/x-virtualbox-vbox":["vbox"],"application/x-virtualbox-vbox-extpack":["vbox-extpack"],"application/x-virtualbox-vdi":["vdi"],"application/x-virtualbox-vhd":["vhd"],"application/x-virtualbox-vmdk":["vmdk"],"application/x-wais-source":["src"],"application/x-web-app-manifest+json":["webapp"],"application/x-x509-ca-cert":["der","crt","pem"],"application/x-xfig":["fig"],"application/x-xliff+xml":["xlf"],"application/x-xpinstall":["xpi"],"application/x-xz":["xz"],"application/x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/x-aac":["aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-m4a":["*m4a"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-realaudio":["*ra"],"audio/x-wav":["*wav"],"chemical/x-cdx":["cdx"],"chemical/x-cif":["cif"],"chemical/x-cmdf":["cmdf"],"chemical/x-cml":["cml"],"chemical/x-csml":["csml"],"chemical/x-xyz":["xyz"],"image/prs.btif":["btif"],"image/prs.pti":["pti"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["*sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/x-3ds":["3ds"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["*ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["*bmp"],"image/x-pcx":["*pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"],"message/vnd.wfa.wsc":["wsc"],"model/vnd.collada+xml":["dae"],"model/vnd.dwf":["dwf"],"model/vnd.gdl":["gdl"],"model/vnd.gtw":["gtw"],"model/vnd.mts":["mts"],"model/vnd.opengex":["ogex"],"model/vnd.parasolid.transmit.binary":["x_b"],"model/vnd.parasolid.transmit.text":["x_t"],"model/vnd.usdz+zip":["usdz"],"model/vnd.valve.source.compiled-map":["bsp"],"model/vnd.vtu":["vtu"],"text/prs.lines.tag":["dsc"],"text/vnd.curl":["curl"],"text/vnd.curl.dcurl":["dcurl"],"text/vnd.curl.mcurl":["mcurl"],"text/vnd.curl.scurl":["scurl"],"text/vnd.dvb.subtitle":["sub"],"text/vnd.fly":["fly"],"text/vnd.fmi.flexstor":["flx"],"text/vnd.graphviz":["gv"],"text/vnd.in3d.3dml":["3dml"],"text/vnd.in3d.spot":["spot"],"text/vnd.sun.j2me.app-descriptor":["jad"],"text/vnd.wap.wml":["wml"],"text/vnd.wap.wmlscript":["wmls"],"text/x-asm":["s","asm"],"text/x-c":["c","cc","cxx","cpp","h","hh","dic"],"text/x-component":["htc"],"text/x-fortran":["f","for","f77","f90"],"text/x-handlebars-template":["hbs"],"text/x-java-source":["java"],"text/x-lua":["lua"],"text/x-markdown":["mkd"],"text/x-nfo":["nfo"],"text/x-opml":["opml"],"text/x-org":["*org"],"text/x-pascal":["p","pas"],"text/x-processing":["pde"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/x-setext":["etx"],"text/x-sfv":["sfv"],"text/x-suse-ymp":["ymp"],"text/x-uuencode":["uu"],"text/x-vcalendar":["vcs"],"text/x-vcard":["vcf"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"],"x-conference/x-cooltalk":["ice"]}},"./node_modules/mime/types/standard.js":function(e,t){e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomsvc+xml":["atomsvc"],"application/bdoc":["bdoc"],"application/ccxml+xml":["ccxml"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma","es"],"application/emma+xml":["emma"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-diff+xml":["xdf"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/ktx":["ktx"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},"./node_modules/optimism/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"KeyTrie",function(){return M}),r.d(t,"defaultMakeCacheKey",function(){return T}),r.d(t,"wrap",function(){return S});var i=r("./node_modules/@wry/context/lib/context.esm.js");function n(){}r.d(t,"asyncFromGen",function(){return i.asyncFromGen}),r.d(t,"bindContext",function(){return i.bind}),r.d(t,"noContext",function(){return i.noContext}),r.d(t,"setTimeout",function(){return i.setTimeout});var a=function(){function e(e,t){void 0===e&&(e=1/0),void 0===t&&(t=n),this.max=e,this.dispose=t,this.map=new Map,this.newest=null,this.oldest=null}return e.prototype.has=function(e){return this.map.has(e)},e.prototype.get=function(e){var t=this.getEntry(e);return t&&t.value},e.prototype.getEntry=function(e){var t=this.map.get(e);if(t&&t!==this.newest){var r=t.older,i=t.newer;i&&(i.older=r),r&&(r.newer=i),t.older=this.newest,t.older.newer=t,t.newer=null,this.newest=t,t===this.oldest&&(this.oldest=i)}return t},e.prototype.set=function(e,t){var r=this.getEntry(e);return r?r.value=t:(r={key:e,value:t,newer:null,older:this.newest},this.newest&&(this.newest.newer=r),this.newest=r,this.oldest=this.oldest||r,this.map.set(e,r),r.value)},e.prototype.clean=function(){for(;this.oldest&&this.map.size>this.max;)this.delete(this.oldest.key)},e.prototype.delete=function(e){var t=this.map.get(e);return!!t&&(t===this.newest&&(this.newest=t.older),t===this.oldest&&(this.oldest=t.newer),t.newer&&(t.newer.older=t.older),t.older&&(t.older.newer=t.newer),this.map.delete(e),this.dispose(t.value,e),!0)},e}(),s=new i.Slot,o=Object.create(null),l=[],d=[],u=100;function c(e,t){if(!e)throw new Error(t||"assertion failure")}var h=function(){function e(t,r){this.fn=t,this.args=r,this.parents=new Set,this.childValues=new Map,this.dirtyChildren=null,this.dirty=!0,this.recomputing=!1,this.value=o,++e.count}return e.prototype.recompute=function(){if(function(e){var t=s.getValue();if(t)return e.parents.add(t),t.childValues.has(e)||t.childValues.set(e,o),f(e)?_(t,e):g(t,e),t}(this)||!y(this))return function e(t){if(t.dirty)return m(t);if(f(t)&&(t.dirtyChildren.forEach(function(r){c(t.childValues.has(r));try{e(r)}catch(e){t.setDirty()}}),t.dirty))return m(t);c(t.value!==o);return t.value}(this)},e.prototype.setDirty=function(){this.dirty||(this.dirty=!0,this.value=o,p(this),E(this))},e.prototype.dispose=function(){var e=this;x(this).forEach(y),E(this),this.parents.forEach(function(t){t.setDirty(),w(t,e)})},e.count=0,e}();function m(e){c(!e.recomputing,"already recomputing"),e.recomputing=!0;var t=x(e),r=!0;try{s.withValue(e,function(){e.value=e.fn.apply(null,e.args)}),r=!1}finally{e.recomputing=!1,r||!function(e){if("function"==typeof e.subscribe)try{E(e),e.unsubscribe=e.subscribe.apply(null,e.args)}catch(t){return e.setDirty(),!1}return!0}(e)?e.setDirty():function(e){if(e.dirty=!1,f(e))return;v(e)}(e)}return t.forEach(y),e.value}function f(e){return e.dirty||!(!e.dirtyChildren||!e.dirtyChildren.size)}function p(e){e.parents.forEach(function(t){return _(t,e)})}function v(e){e.parents.forEach(function(t){return g(t,e)})}function _(e,t){if(c(e.childValues.has(t)),c(f(t)),e.dirtyChildren){if(e.dirtyChildren.has(t))return}else e.dirtyChildren=d.pop()||new Set;e.dirtyChildren.add(t),p(e)}function g(e,t){c(e.childValues.has(t)),c(!f(t));var r=e.childValues.get(t);r===o?e.childValues.set(t,t.value):r!==t.value&&e.setDirty(),b(e,t),f(e)||v(e)}function b(e,t){var r=e.dirtyChildren;r&&(r.delete(t),0===r.size&&(d.length<u&&d.push(r),e.dirtyChildren=null))}function y(e){return 0===e.parents.size&&"function"==typeof e.reportOrphan&&!0===e.reportOrphan()}function x(e){var t=l;return e.childValues.size>0&&(t=[],e.childValues.forEach(function(r,i){w(e,i),t.push(i)})),c(null===e.dirtyChildren),t}function w(e,t){t.parents.delete(e),e.childValues.delete(t),b(e,t)}function E(e){var t=e.unsubscribe;"function"==typeof t&&(e.unsubscribe=void 0,t())}var M=function(){function e(e){this.weakness=e}return e.prototype.lookup=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.lookupArray(e)},e.prototype.lookupArray=function(e){var t=this;return e.forEach(function(e){return t=t.getChildTrie(e)}),t.data||(t.data=Object.create(null))},e.prototype.getChildTrie=function(t){var r=this.weakness&&function(e){switch(typeof e){case"object":if(null===e)break;case"function":return!0}return!1}(t)?this.weak||(this.weak=new WeakMap):this.strong||(this.strong=new Map),i=r.get(t);return i||r.set(t,i=new e(this.weakness)),i},e}();var A=new M("function"==typeof WeakMap);function T(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return A.lookupArray(e)}function S(e,t){void 0===t&&(t=Object.create(null));var r=new a(t.max||Math.pow(2,16),function(e){return e.dispose()}),i=!!t.disposable,n=t.makeCacheKey||T;function o(){if(!i||s.hasValue()){var a=n.apply(null,arguments);if(!a)return e.apply(null,arguments);var o=Array.prototype.slice.call(arguments),l=r.get(a);l?l.args=o:(l=new h(e,o),r.set(a,l),l.subscribe=t.subscribe,i&&(l.reportOrphan=function(){return r.delete(a)}));var d=l.recompute();return r.set(a,l),s.hasValue()||r.clean(),i?void 0:d}}return o.dirty=function(){var e=n.apply(null,arguments),t=e&&r.get(e);t&&t.setDirty()},o}},"./node_modules/process/browser.js":function(e,t){var r,i,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var l,d=[],u=!1,c=-1;function h(){u&&l&&(u=!1,l.length?d=l.concat(d):c=-1,d.length&&m())}function m(){if(!u){var e=o(h);u=!0;for(var t=d.length;t;){for(l=d,d=[];++c<t;)l&&l[c].run();c=-1,t=d.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new f(e,t)),1!==d.length||u||o(m)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},"./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js":function(e,t,r){"use strict";r.r(t),function(e){var r=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var r=-1;return e.some(function(e,i){return e[0]===t&&(r=i,!0)}),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var r=e(this.__entries__,t),i=this.__entries__[r];return i&&i[1]},t.prototype.set=function(t,r){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,i=e(r,t);~i&&r.splice(i,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,i=this.__entries__;r<i.length;r++){var n=i[r];e.call(t,n[1],n[0])}},t}()}(),i="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,n=void 0!==e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(n):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},s=2;var o=20,l=["top","right","bottom","left","width","height","size","weight"],d="undefined"!=typeof MutationObserver,u=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var r=!1,i=!1,n=0;function o(){r&&(r=!1,e()),i&&d()}function l(){a(o)}function d(){var e=Date.now();if(r){if(e-n<s)return;i=!0}else r=!0,i=!1,setTimeout(l,t);n=e}return d}(this.refresh.bind(this),o)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},e.prototype.connect_=function(){i&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),d?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){i&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=void 0===t?"":t;l.some(function(e){return!!~r.indexOf(e)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),c=function(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var n=i[r];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},h=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||n},m=b(0,0,0,0);function f(e){return parseFloat(e)||0}function p(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce(function(t,r){return t+f(e["border-"+r+"-width"])},0)}function v(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return m;var i=h(e).getComputedStyle(e),n=function(e){for(var t={},r=0,i=["top","right","bottom","left"];r<i.length;r++){var n=i[r],a=e["padding-"+n];t[n]=f(a)}return t}(i),a=n.left+n.right,s=n.top+n.bottom,o=f(i.width),l=f(i.height);if("border-box"===i.boxSizing&&(Math.round(o+a)!==t&&(o-=p(i,"left","right")+a),Math.round(l+s)!==r&&(l-=p(i,"top","bottom")+s)),!function(e){return e===h(e).document.documentElement}(e)){var d=Math.round(o+a)-t,u=Math.round(l+s)-r;1!==Math.abs(d)&&(o-=d),1!==Math.abs(u)&&(l-=u)}return b(n.left,n.top,o,l)}var _="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof h(e).SVGGraphicsElement}:function(e){return e instanceof h(e).SVGElement&&"function"==typeof e.getBBox};function g(e){return i?_(e)?function(e){var t=e.getBBox();return b(0,0,t.width,t.height)}(e):v(e):m}function b(e,t,r,i){return{x:e,y:t,width:r,height:i}}var y=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=b(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=g(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),x=function(){return function(e,t){var r,i,n,a,s,o,l,d=(i=(r=t).x,n=r.y,a=r.width,s=r.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(o.prototype),c(l,{x:i,y:n,width:a,height:s,top:n,right:i+a,bottom:s+n,left:i}),l);c(this,{target:e,contentRect:d})}}(),w=function(){function e(e,t,i){if(this.activeObservations_=[],this.observations_=new r,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof h(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new y(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof h(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new x(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),E="undefined"!=typeof WeakMap?new WeakMap:new r,M=function(){return function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=u.getInstance(),i=new w(t,r,this);E.set(this,i)}}();["observe","unobserve","disconnect"].forEach(function(e){M.prototype[e]=function(){var t;return(t=E.get(this))[e].apply(t,arguments)}});var A=void 0!==n.ResizeObserver?n.ResizeObserver:M;t.default=A}.call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/symbol-observable/es/index.js":function(e,t,r){"use strict";r.r(t),function(e,i){var n,a=r("./node_modules/symbol-observable/es/ponyfill.js");n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:i;var s=Object(a.default)(n);t.default=s}.call(this,r("./node_modules/webpack/buildin/global.js"),r("./node_modules/webpack/buildin/harmony-module.js")(e))},"./node_modules/symbol-observable/es/ponyfill.js":function(e,t,r){"use strict";function i(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.r(t),r.d(t,"default",function(){return i})},"./node_modules/ts-invariant/lib/invariant.esm.js":function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"InvariantError",function(){return o}),r.d(t,"invariant",function(){return l}),r.d(t,"process",function(){return u});var i=r("./node_modules/tslib/tslib.es6.js"),n="Invariant Violation",a=Object.setPrototypeOf,s=void 0===a?function(e,t){return e.__proto__=t,e}:a,o=function(e){function t(r){void 0===r&&(r=n);var i=e.call(this,"number"==typeof r?n+": "+r+" (see https://github.com/apollographql/invariant-packages)":r)||this;return i.framesToPop=1,i.name=n,s(i,t.prototype),i}return Object(i.__extends)(t,e),t}(Error);function l(e,t){if(!e)throw new o(t)}function d(e){return function(){return console[e].apply(console,arguments)}}!function(e){e.warn=d("warn"),e.error=d("error")}(l||(l={}));var u={env:{}};if("object"==typeof e)u=e;else try{Function("stub","process = stub")(u)}catch(e){}var c=l;t.default=c}.call(this,r("./node_modules/process/browser.js"))},"./node_modules/tslib/tslib.es6.js":function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return n}),r.d(t,"__assign",function(){return a}),r.d(t,"__rest",function(){return s}),r.d(t,"__decorate",function(){return o}),r.d(t,"__param",function(){return l}),r.d(t,"__metadata",function(){return d}),r.d(t,"__awaiter",function(){return u}),r.d(t,"__generator",function(){return c}),r.d(t,"__exportStar",function(){return h}),r.d(t,"__values",function(){return m}),r.d(t,"__read",function(){return f}),r.d(t,"__spread",function(){return p}),r.d(t,"__await",function(){return v}),r.d(t,"__asyncGenerator",function(){return _}),r.d(t,"__asyncDelegator",function(){return g}),r.d(t,"__asyncValues",function(){return b}),r.d(t,"__makeTemplateObject",function(){return y}),r.d(t,"__importStar",function(){return x}),r.d(t,"__importDefault",function(){return w});var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function n(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&(r[i[n]]=e[i[n]])}return r}function o(e,t,r,i){var n,a=arguments.length,s=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(s=(a<3?n(s):a>3?n(t,r,s):n(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s}function l(e,t){return function(r,i){t(r,i,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,o)}l((i=i.apply(e,t||[])).next())})}function c(e,t){var r,i,n,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}function h(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function m(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function f(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return s}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),a=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){n[e]&&(i[e]=function(t){return new Promise(function(r,i){a.push([e,t,r,i])>1||o(e,t)})})}function o(e,t){try{(r=n[e](t)).value instanceof v?Promise.resolve(r.value.v).then(l,d):u(a[0][2],r)}catch(e){u(a[0][3],e)}var r}function l(e){o("next",e)}function d(e){o("throw",e)}function u(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function g(e){var t,r;return t={},i("next"),i("throw",function(e){throw e}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:v(e[i](t)),done:"return"===i}:n?n(t):t}:n}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=m(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise(function(i,n){(function(e,t,r,i){Promise.resolve(i).then(function(t){e({value:t,done:r})},t)})(i,n,(t=e[r](t)).done,t.value)})}}}function y(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function x(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function w(e){return e&&e.__esModule?e:{default:e}}},"./node_modules/ua-parser-js/src/ua-parser.js":function(e,t,r){var i;!function(n,a){"use strict";var s="model",o="name",l="type",d="vendor",u="version",c="mobile",h="tablet",m={extend:function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},f={rgx:function(e,t){for(var r,i,n,a,s,o,l=0;l<t.length&&!s;){var d=t[l],u=t[l+1];for(r=i=0;r<d.length&&!s;)if(s=d[r++].exec(e))for(n=0;n<u.length;n++)o=s[++i],"object"==typeof(a=u[n])&&a.length>0?2==a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,o):this[a[0]]=a[1]:3==a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=o?o.replace(a[1],a[2]):void 0:this[a[0]]=o?a[1].call(this,o,a[2]):void 0:4==a.length&&(this[a[0]]=o?a[3].call(this,o.replace(a[1],a[2])):void 0):this[a]=o||void 0;l+=2}},str:function(e,t){for(var r in t)if("object"==typeof t[r]&&t[r].length>0){for(var i=0;i<t[r].length;i++)if(m.has(t[r][i],e))return"?"===r?void 0:r}else if(m.has(t[r],e))return"?"===r?void 0:r;return e}},p={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},v={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[o,u],[/(opios)[\/\s]+([\w\.]+)/i],[[o,"Opera Mini"],u],[/\s(opr)\/([\w\.]+)/i],[[o,"Opera"],u],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[o,u],[/(konqueror)\/([\w\.]+)/i],[[o,"Konqueror"],u],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[o,"IE"],u],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[o,"Edge"],u],[/(yabrowser)\/([\w\.]+)/i],[[o,"Yandex"],u],[/(puffin)\/([\w\.]+)/i],[[o,"Puffin"],u],[/(focus)\/([\w\.]+)/i],[[o,"Firefox Focus"],u],[/(opt)\/([\w\.]+)/i],[[o,"Opera Touch"],u],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[o,"UCBrowser"],u],[/(comodo_dragon)\/([\w\.]+)/i],[[o,/_/g," "],u],[/(windowswechat qbcore)\/([\w\.]+)/i],[[o,"WeChat(Win) Desktop"],u],[/(micromessenger)\/([\w\.]+)/i],[[o,"WeChat"],u],[/(brave)\/([\w\.]+)/i],[[o,"Brave"],u],[/(qqbrowserlite)\/([\w\.]+)/i],[o,u],[/(QQ)\/([\d\.]+)/i],[o,u],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[o,u],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[o,u],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[o,u],[/(MetaSr)[\/\s]?([\w\.]+)/i],[o],[/(LBBROWSER)/i],[o],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[u,[o,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[u,[o,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[o,u],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[u,[o,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[o,/(.+)/,"$1 WebView"],u],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[o,/(.+(?:g|us))(.+)/,"$1 $2"],u],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[u,[o,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[o,"Sailfish Browser"],u],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[o,u],[/(dolfin)\/([\w\.]+)/i],[[o,"Dolphin"],u],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[o,"Chrome"],u],[/(coast)\/([\w\.]+)/i],[[o,"Opera Coast"],u],[/fxios\/([\w\.-]+)/i],[u,[o,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[u,[o,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[u,o],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[o,"GSA"],u],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[o,[u,f.str,p.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[o,u],[/(navigator|netscape)\/([\w\.-]+)/i],[[o,"Netscape"],u],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[o,u]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",m.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",m.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",m.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[s,d,[l,h]],[/applecoremedia\/[\w\.]+ \((ipad)/],[s,[d,"Apple"],[l,h]],[/(apple\s{0,1}tv)/i],[[s,"Apple TV"],[d,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[d,s,[l,h]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[s,[d,"Amazon"],[l,h]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[s,f.str,p.device.amazon.model],[d,"Amazon"],[l,c]],[/android.+aft([bms])\sbuild/i],[s,[d,"Amazon"],[l,"smarttv"]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[s,d,[l,c]],[/\((ip[honed|\s\w*]+);/i],[s,[d,"Apple"],[l,c]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[d,s,[l,c]],[/\(bb10;\s(\w+)/i],[s,[d,"BlackBerry"],[l,c]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[s,[d,"Asus"],[l,h]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[d,"Sony"],[s,"Xperia Tablet"],[l,h]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[d,"Sony"],[l,c]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[d,s,[l,"console"]],[/android.+;\s(shield)\sbuild/i],[s,[d,"Nvidia"],[l,"console"]],[/(playstation\s[34portablevi]+)/i],[s,[d,"Sony"],[l,"console"]],[/(sprint\s(\w+))/i],[[d,f.str,p.device.sprint.vendor],[s,f.str,p.device.sprint.model],[l,c]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[d,[s,/_/g," "],[l,c]],[/(nexus\s9)/i],[s,[d,"HTC"],[l,h]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[s,[d,"Huawei"],[l,c]],[/(microsoft);\s(lumia[\s\w]+)/i],[d,s,[l,c]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[s,[d,"Microsoft"],[l,"console"]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[d,"Microsoft"],[l,c]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[s,[d,"Motorola"],[l,c]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[s,[d,"Motorola"],[l,h]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[d,m.trim],[s,m.trim],[l,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[d,"Samsung"],[l,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[s,[d,"Sharp"],[l,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[d,"Samsung"],s,[l,h]],[/smart-tv.+(samsung)/i],[d,[l,"smarttv"],s],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[d,"Samsung"],s,[l,c]],[/sie-(\w*)/i],[s,[d,"Siemens"],[l,c]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[d,"Nokia"],s,[l,c]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[s,[d,"Acer"],[l,h]],[/android.+([vl]k\-?\d{3})\s+build/i],[s,[d,"LG"],[l,h]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[d,"LG"],s,[l,h]],[/(lg) netcast\.tv/i],[d,s,[l,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[s,[d,"LG"],[l,c]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[d,s,[l,h]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[s,[d,"Lenovo"],[l,h]],[/(lenovo)[_\s-]?([\w-]+)/i],[d,s,[l,c]],[/linux;.+((jolla));/i],[d,s,[l,c]],[/((pebble))app\/[\d\.]+\s/i],[d,s,[l,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[d,s,[l,c]],[/crkey/i],[[s,"Chromecast"],[d,"Google"]],[/android.+;\s(glass)\s\d/i],[s,[d,"Google"],[l,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[s,[d,"Google"],[l,h]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[s,[d,"Google"],[l,c]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[d,"Xiaomi"],[l,c]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[d,"Xiaomi"],[l,h]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[s,[d,"Meizu"],[l,c]],[/(mz)-([\w-]{2,})/i],[[d,"Meizu"],s,[l,c]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[s,[d,"OnePlus"],[l,c]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[s,[d,"RCA"],[l,h]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[s,[d,"Dell"],[l,h]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[s,[d,"Verizon"],[l,h]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[d,"Barnes & Noble"],s,[l,h]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[s,[d,"NuVision"],[l,h]],[/android.+;\s(k88)\sbuild/i],[s,[d,"ZTE"],[l,h]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[s,[d,"Swiss"],[l,c]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[s,[d,"Swiss"],[l,h]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[s,[d,"Zeki"],[l,h]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[d,"Dragon Touch"],s,[l,h]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[s,[d,"Insignia"],[l,h]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[s,[d,"NextBook"],[l,h]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[d,"Voice"],s,[l,c]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[d,"LvTel"],s,[l,c]],[/android.+;\s(PH-1)\s/i],[s,[d,"Essential"],[l,c]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[s,[d,"Envizen"],[l,h]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[d,s,[l,h]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[s,[d,"MachSpeed"],[l,h]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[d,s,[l,h]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[s,[d,"Rotor"],[l,h]],[/android.+(KS(.+))\s+build/i],[s,[d,"Amazon"],[l,h]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[d,s,[l,h]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[l,m.lowerize],d,s],[/[\s\/\(](smart-?tv)[;\)]/i],[[l,"smarttv"]],[/(android[\w\.\s\-]{0,9});.+build/i],[s,[d,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[u,[o,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[o,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[o,u],[/rv\:([\w\.]{1,9}).+(gecko)/i],[u,o]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[o,u],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[o,[u,f.str,p.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[o,"Windows"],[u,f.str,p.os.windows.version]],[/\((bb)(10);/i],[[o,"BlackBerry"],u],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[o,u],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[o,"Symbian"],u],[/\((series40);/i],[o],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[o,"Firefox OS"],u],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[o,u],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[o,"Chromium OS"],u],[/(sunos)\s?([\w\.\d]*)/i],[[o,"Solaris"],u],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[o,u],[/(haiku)\s(\w+)/i],[o,u],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[u,/_/g,"."],[o,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[o,"Mac OS"],[u,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[o,u]]},_=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof _))return new _(e,t).getResult();var r=e||(n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:""),i=t?m.extend(v,t):v;return this.getBrowser=function(){var e={name:void 0,version:void 0};return f.rgx.call(e,r,i.browser),e.major=m.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return f.rgx.call(e,r,i.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return f.rgx.call(e,r,i.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return f.rgx.call(e,r,i.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return f.rgx.call(e,r,i.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=e,this},this};_.VERSION="0.7.20",_.BROWSER={NAME:o,MAJOR:"major",VERSION:u},_.CPU={ARCHITECTURE:"architecture"},_.DEVICE={MODEL:s,VENDOR:d,TYPE:l,CONSOLE:"console",MOBILE:c,SMARTTV:"smarttv",TABLET:h,WEARABLE:"wearable",EMBEDDED:"embedded"},_.ENGINE={NAME:o,VERSION:u},_.OS={NAME:o,VERSION:u},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=_),t.UAParser=_):void 0===(i=function(){return _}.call(t,r,t,e))||(e.exports=i);var g=n&&(n.jQuery||n.Zepto);if(void 0!==g&&!g.ua){var b=new _;g.ua=b.getResult(),g.ua.get=function(){return b.getUA()},g.ua.set=function(e){b.setUA(e);var t=b.getResult();for(var r in t)g.ua[r]=t[r]}}}("object"==typeof window?window:this)},"./node_modules/webpack/buildin/global.js":function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},"./node_modules/webpack/buildin/harmony-module.js":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"./node_modules/zen-observable-ts/lib/bundle.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,"Observable",function(){return n});var i=r("./node_modules/zen-observable/index.js"),n=r.n(i).a;t.default=n},"./node_modules/zen-observable/index.js":function(e,t,r){e.exports=r("./node_modules/zen-observable/lib/Observable.js").Observable},"./node_modules/zen-observable/lib/Observable.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){return"function"==typeof Symbol},s=function(e){return a()&&Boolean(Symbol[e])},o=function(e){return s(e)?Symbol[e]:"@@"+e};a()&&!s("observable")&&(Symbol.observable=Symbol("observable"));var l=o("iterator"),d=o("observable"),u=o("species");function c(e,t){var r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}}function h(e){var t=e.constructor;return void 0!==t&&null===(t=t[u])&&(t=void 0),void 0!==t?t:w}function m(e){return e instanceof w}function f(e){f.log?f.log(e):setTimeout(function(){throw e})}function p(e){Promise.resolve().then(function(){try{e()}catch(e){f(e)}})}function v(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var r=c(t,"unsubscribe");r&&r.call(t)}}catch(e){f(e)}}function _(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function g(e,t,r){e._state="running";var i=e._observer;try{var n=c(i,t);switch(t){case"next":n&&n.call(i,r);break;case"error":if(_(e),!n)throw r;n.call(i,r);break;case"complete":_(e),n&&n.call(i)}}catch(e){f(e)}"closed"===e._state?v(e):"running"===e._state&&(e._state="ready")}function b(e,t,r){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:r}],void p(function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var r=0;r<t.length&&(g(e,t[r].type,t[r].value),"closed"!==e._state);++r);}}(e)})):void g(e,t,r);e._queue.push({type:t,value:r})}}var y=function(){function e(t,r){n(this,e),this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var i=new x(this);try{this._cleanup=r.call(void 0,i)}catch(e){i.error(e)}"initializing"===this._state&&(this._state="ready")}return i(e,[{key:"unsubscribe",value:function(){"closed"!==this._state&&(_(this),v(this))}},{key:"closed",get:function(){return"closed"===this._state}}]),e}(),x=function(){function e(t){n(this,e),this._subscription=t}return i(e,[{key:"next",value:function(e){b(this._subscription,"next",e)}},{key:"error",value:function(e){b(this._subscription,"error",e)}},{key:"complete",value:function(){b(this._subscription,"complete")}},{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),w=t.Observable=function(){function e(t){if(n(this,e),!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}return i(e,[{key:"subscribe",value:function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new y(e,this._subscriber)}},{key:"forEach",value:function(e){var t=this;return new Promise(function(r,i){if("function"==typeof e)var n=t.subscribe({next:function(t){try{e(t,a)}catch(e){i(e),n.unsubscribe()}},error:i,complete:r});else i(new TypeError(e+" is not a function"));function a(){n.unsubscribe(),r()}})}},{key:"map",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(h(this))(function(r){return t.subscribe({next:function(t){try{t=e(t)}catch(e){return r.error(e)}r.next(t)},error:function(e){r.error(e)},complete:function(){r.complete()}})})}},{key:"filter",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(h(this))(function(r){return t.subscribe({next:function(t){try{if(!e(t))return}catch(e){return r.error(e)}r.next(t)},error:function(e){r.error(e)},complete:function(){r.complete()}})})}},{key:"reduce",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var r=h(this),i=arguments.length>1,n=!1,a=arguments[1];return new r(function(r){return t.subscribe({next:function(t){var s=!n;if(n=!0,!s||i)try{a=e(a,t)}catch(e){return r.error(e)}else a=t},error:function(e){r.error(e)},complete:function(){if(!n&&!i)return r.error(new TypeError("Cannot reduce an empty sequence"));r.next(a),r.complete()}})})}},{key:"concat",value:function(){for(var e=this,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var n=h(this);return new n(function(t){var i=void 0,a=0;return function e(s){i=s.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){a===r.length?(i=void 0,t.complete()):e(n.from(r[a++]))}})}(e),function(){i&&(i.unsubscribe(),i=void 0)}})}},{key:"flatMap",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var r=h(this);return new r(function(i){var n=[],a=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(e){return i.error(e)}var a=r.from(t).subscribe({next:function(e){i.next(e)},error:function(e){i.error(e)},complete:function(){var e=n.indexOf(a);e>=0&&n.splice(e,1),s()}});n.push(a)},error:function(e){i.error(e)},complete:function(){s()}});function s(){a.closed&&0===n.length&&i.complete()}return function(){n.forEach(function(e){return e.unsubscribe()}),a.unsubscribe()}})}},{key:d,value:function(){return this}}],[{key:"from",value:function(t){var r="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var i=c(t,d);if(i){var n=i.call(t);if(Object(n)!==n)throw new TypeError(n+" is not an object");return m(n)&&n.constructor===r?n:new r(function(e){return n.subscribe(e)})}if(s("iterator")&&(i=c(t,l)))return new r(function(e){p(function(){if(!e.closed){var r=!0,n=!1,a=void 0;try{for(var s,o=i.call(t)[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;if(e.next(l),e.closed)return}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}e.complete()}})});if(Array.isArray(t))return new r(function(e){p(function(){if(!e.closed){for(var r=0;r<t.length;++r)if(e.next(t[r]),e.closed)return;e.complete()}})});throw new TypeError(t+" is not observable")}},{key:"of",value:function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return new("function"==typeof this?this:e)(function(e){p(function(){if(!e.closed){for(var t=0;t<r.length;++t)if(e.next(r[t]),e.closed)return;e.complete()}})})}},{key:u,get:function(){return this}}]),e}();a()&&Object.defineProperty(w,Symbol("extensions"),{value:{symbol:d,hostReportError:f},configurable:!0})},"./webgl-utils.js":function(e,t,r){"use strict";r.r(t),t.default=function(){var e=function(e){return'<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+e+"</div></div></td></tr></table>"},t=function(e,t){var r=null;if(t.webgl2){if(r=e.getContext("webgl2",t),console.log("Try to use webgl2.0."),!!r)return r;console.warn("webgl2.0 is not supported on this browser!")}for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=0;n<i.length;++n){try{r=e.getContext(i[n],t)}catch(e){}if(r)break}return r};return window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout(e,1e3/60)},window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout,{create3DContext:t,setupWebGL:function(r,i){return window.WebGLRenderingContext?t(r,i):(n='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',(a=r.parentNode)&&(a.innerHTML=e(n)),null);var n,a}}}},0:function(e,t,r){e.exports=r("./99api/index.ts")}}).default});