!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Modelo",[],t):"object"==typeof exports?exports.Modelo=t():e.Modelo=t()}(this,function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=145)}([function(e,t,r){"use strict";var i=r(11),n=new(function(){function e(){this.sub=this.subtract,this.mul=this.multiply,this.div=this.divide,this.dist=this.distance,this.sqrDist=this.squaredDistance,this.len=this.length,this.sqrLen=this.squaredLength}return e.prototype.create=function(){var e=new i.a.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},e.prototype.clone=function(e){var t=new i.a.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},e.prototype.fromValues=function(e,t){var r=new i.a.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},e.prototype.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},e.prototype.set=function(e,t,r){return e[0]=t,e[1]=r,e},e.prototype.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},e.prototype.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e},e.prototype.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e},e.prototype.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e},e.prototype.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},e.prototype.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},e.prototype.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},e.prototype.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e},e.prototype.distance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)},e.prototype.squaredDistance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i},e.prototype.length=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)},e.prototype.squaredLength=function(e){var t=e[0],r=e[1];return t*t+r*r},e.prototype.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},e.prototype.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},e.prototype.normalize=function(e,t){var r=t[0],i=t[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e},e.prototype.rotate=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e},e.prototype.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},e.prototype.cross=function(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e},e.prototype.lerp=function(e,t,r,i){var n=t[0],a=t[1];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e},e.prototype.random=function(e,t){t=t||1;var r=2*i.a.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},e.prototype.transformMat2=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e},e.prototype.transformMat2d=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e},e.prototype.transformMat3=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e},e.prototype.transformMat4=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e},e.prototype.forEach=function(e,t,r,i,a,o){var s,l,u=n.create();for(t||(t=2),r||(r=0),l=i?Math.min(i*t+r,e.length):e.length,s=r;s<l;s+=t)u[0]=e[s],u[1]=e[s+1],a(u,u,o),e[s]=u[0],e[s+1]=u[1];return e},e.prototype.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},e}()),a=n,o=r(10),s=r(29),l=new(function(){function e(){}return e.prototype.create=function(){var e=new i.a.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},e.prototype.clone=function(e){var t=new i.a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.prototype.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.prototype.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},e.prototype.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},e.prototype.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r*a-n*i;return o?(o=1/o,e[0]=a*o,e[1]=-i*o,e[2]=-n*o,e[3]=r*o,e):null},e.prototype.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},e.prototype.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},e.prototype.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],l=r[1],u=r[2],c=r[3];return e[0]=i*s+a*l,e[1]=n*s+o*l,e[2]=i*u+a*c,e[3]=n*u+o*c,e},e.prototype.mul=function(e,t,r){return this.multiply(e,t,r)},e.prototype.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=i*l+a*s,e[1]=n*l+o*s,e[2]=i*-s+a*l,e[3]=n*-s+o*l,e},e.prototype.scale=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],l=r[1];return e[0]=i*s,e[1]=n*s,e[2]=a*l,e[3]=o*l,e},e.prototype.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e},e.prototype.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},e.prototype.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},e.prototype.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},e.prototype.LDU=function(e,t,r,i){return e[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-e[2]*r[1],[e,t,r]},e}()),u=new(function(){function e(){}return e.prototype.create=function(){var e=new i.a.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},e.prototype.clone=function(e){var t=new i.a.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.prototype.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.prototype.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},e.prototype.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=r*a-i*n;return l?(l=1/l,e[0]=a*l,e[1]=-i*l,e[2]=-n*l,e[3]=r*l,e[4]=(n*s-a*o)*l,e[5]=(i*o-r*s)*l,e):null},e.prototype.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},e.prototype.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=r[0],c=r[1],h=r[2],d=r[3],p=r[4],f=r[5];return e[0]=i*u+a*c,e[1]=n*u+o*c,e[2]=i*h+a*d,e[3]=n*h+o*d,e[4]=i*p+a*f+s,e[5]=n*p+o*f+l,e},e.prototype.mul=function(e,t,r){this.multiply(e,t,r)},e.prototype.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=Math.sin(r),c=Math.cos(r);return e[0]=i*c+a*u,e[1]=n*c+o*u,e[2]=i*-u+a*c,e[3]=n*-u+o*c,e[4]=s,e[5]=l,e},e.prototype.scale=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=r[0],c=r[1];return e[0]=i*u,e[1]=n*u,e[2]=a*c,e[3]=o*c,e[4]=s,e[5]=l,e},e.prototype.translate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=r[0],c=r[1];return e[0]=i,e[1]=n,e[2]=a,e[3]=o,e[4]=i*u+a*c+s,e[5]=n*u+o*c+l,e},e.prototype.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=0,e[5]=0,e},e.prototype.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},e.prototype.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},e.prototype.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},e.prototype.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},e}()),c=r(54),h=r(53),d=r(43);r.d(t,!1,function(){return i.a}),r.d(t,"c",function(){return a}),r.d(t,"d",function(){return o.a}),r.d(t,"e",function(){return s.a}),r.d(t,!1,function(){return l}),r.d(t,!1,function(){return u}),r.d(t,!1,function(){return c.a}),r.d(t,"b",function(){return h.a}),r.d(t,"a",function(){return d.a})},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i={isMobile:!1,devicePixelRatio:1,littleEndian:!0,gpuMemory:256,browserName:"",browserVersion:"",initResize:!0,webvr:!1,isOrbital:!1}},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,LINEAR_MIPMAP_LINEAR:9987,LINEAR:9729,NEAREST:9728,NEAREST_MIPMAP_NEAREST:9984,REPEAT:10497,CLAMP_TO_EDGE:33071,RGBA:6408,RGB:6407}},function(e,t,r){"use strict";var i,n=r(0),a=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],o=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],s=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],l={width:0,height:0,depth:0};!function(e){var t=0,r=0,i=function(){function e(){}return e.create=function(){return{tip:n.d.create(),direction:n.d.create(),cosThetaSquared:0,sinThetaSquared:0,invSinTheta:0}},e.updateShape=function(e,i,n){t=.017453293*i*.5,r=Math.tan(t),r*=Math.sqrt(1+n*n),e.cosThetaSquared=1/(r*r+1),e.sinThetaSquared=1-e.cosThetaSquared,e.invSinTheta=1/Math.sqrt(e.sinThetaSquared)},e}();e.cone=i;var u=function(){function e(){this._vec=new Float32Array(3)}return e.createFromArray=function(e){var t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.createFromSphere=function(e){var t=new Float32Array(6);return t[0]=e[0]-e[3],t[1]=e[1]-e[3],t[2]=e[2]-e[3],t[3]=e[0]+e[3],t[4]=e[1]+e[3],t[5]=e[2]+e[3],t},e.createFromPoints=function(e,t){e[0]=t[0][0],e[3]=t[0][0],e[1]=t[0][1],e[4]=t[0][1],e[2]=t[0][2],e[5]=t[0][2];for(var r=1,i=t.length;r<i;r++)e[0]>t[r][0]&&(e[0]=t[r][0]),e[3]<t[r][0]&&(e[3]=t[r][0]),e[1]>t[r][1]&&(e[1]=t[r][1]),e[4]<t[r][1]&&(e[4]=t[r][1]),e[2]>t[r][2]&&(e[2]=t[r][2]),e[5]<t[r][2]&&(e[5]=t[r][2]);return e},e.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.create=function(e,t){var r=new Float32Array(6);return e=e||a,t=t||o,r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t[0],r[4]=t[1],r[5]=t[2],r},e.invalidate=function(e){e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=o[0],e[4]=o[1],e[5]=o[2]},e.min=function(e){return n.d.fromValues(e[0],e[1],e[2])},e.max=function(e){return n.d.fromValues(e[3],e[4],e[5])},e.len=function(e){var t=e[3]-e[0],r=e[4]-e[1],i=e[5]-e[2];return Math.sqrt(t*t+r*r+i*i)},e.isEqual=function(e,t){return Math.abs(e[0]-t[0])<1e-6&&Math.abs(e[1]-t[1])<1e-6&&Math.abs(e[2]-t[2])<1e-6&&Math.abs(e[3]-t[3])<1e-6&&Math.abs(e[4]-t[4])<1e-6&&Math.abs(e[5]-t[5])<1e-6},e.union=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e[4]=Math.max(t[4],r[4]),e[5]=Math.max(t[5],r[5]),e},e.moveTo=function(e,t,r){var i=r[0]-.5*(t[0]+t[3]),n=r[1]-.5*(t[1]+t[4]),a=r[2]-.5*(t[2]+t[5]);return e[0]=t[0]+i,e[1]=t[1]+n,e[2]=t[2]+a,e[3]=t[3]+i,e[4]=t[4]+n,e[5]=t[5]+a,e},e.scaleTo=function(e,t,r){var i=.5*(t[0]+t[3])-.5*r[0],n=.5*(t[0]+t[3])+.5*r[0],a=.5*(t[1]+t[4])-.5*r[1],o=.5*(t[1]+t[4])+.5*r[1],s=.5*(t[2]+t[5])-.5*r[2],l=.5*(t[2]+t[5])+.5*r[2];e[0]=i,e[3]=n,e[1]=a,e[4]=o,e[2]=s,e[5]=l},e.scale=function(e,t,r){var i=.5-.5*r,n=.5+.5*r,a=t[0]*n+t[3]*i,o=t[0]*i+t[3]*n,s=t[1]*n+t[4]*i,l=t[1]*i+t[4]*n,u=t[2]*n+t[5]*i,c=t[2]*i+t[5]*n;e[0]=a,e[3]=o,e[1]=s,e[4]=l,e[2]=u,e[5]=c},e.expand=function(e,t){void 0===t&&(t=1e-4),e[0]-=t,e[1]-=t,e[2]-=t,e[3]+=t,e[4]+=t,e[5]+=t},e.points=function(e){var t=[];return t.push(n.d.fromValues(e[0],e[1],e[2])),t.push(n.d.fromValues(e[3],e[1],e[2])),t.push(n.d.fromValues(e[3],e[4],e[2])),t.push(n.d.fromValues(e[0],e[4],e[2])),t.push(n.d.fromValues(e[0],e[1],e[5])),t.push(n.d.fromValues(e[3],e[1],e[5])),t.push(n.d.fromValues(e[3],e[4],e[5])),t.push(n.d.fromValues(e[0],e[4],e[5])),t},e.points2=function(e,t){return t[0][0]=e[0],t[0][1]=e[1],t[0][2]=e[2],t[1][0]=e[3],t[1][1]=e[1],t[1][2]=e[2],t[2][0]=e[3],t[2][1]=e[4],t[2][2]=e[2],t[3][0]=e[0],t[3][1]=e[4],t[3][2]=e[2],t[4][0]=e[0],t[4][1]=e[1],t[4][2]=e[5],t[5][0]=e[3],t[5][1]=e[1],t[5][2]=e[5],t[6][0]=e[3],t[6][1]=e[4],t[6][2]=e[5],t[7][0]=e[0],t[7][1]=e[4],t[7][2]=e[5],t},e.points3=function(e,t){return t[0][0]=e[0],t[0][1]=e[1],t[0][2]=e[2],t[1][0]=e[3],t[1][1]=e[1],t[1][2]=e[2],t[2][0]=e[3],t[2][1]=e[1],t[2][2]=e[5],t[3][0]=e[0],t[3][1]=e[1],t[3][2]=e[5],t[4][0]=e[0],t[4][1]=e[4],t[4][2]=e[2],t[5][0]=e[3],t[5][1]=e[4],t[5][2]=e[2],t[6][0]=e[3],t[6][1]=e[4],t[6][2]=e[5],t[7][0]=e[0],t[7][1]=e[4],t[7][2]=e[5],t},e.planes=function(e){var t=[];return t.push(n.e.fromValues(-1,0,0,+e[0])),t.push(n.e.fromValues(0,-1,0,+e[1])),t.push(n.e.fromValues(0,0,-1,+e[2])),t.push(n.e.fromValues(1,0,0,-e[3])),t.push(n.e.fromValues(0,1,0,-e[4])),t.push(n.e.fromValues(0,0,1,-e[5])),t},e.volume=function(e){return(e[3]-e[0])*(e[4]-e[1])*(e[5]-e[2])},e.size=function(e){return l.width=e[3]-e[0],l.height=e[4]-e[1],l.depth=e[5]-e[2],l},e.center=function(e){return[.5*(e[0]+e[3]),.5*(e[1]+e[4]),.5*(e[2]+e[5])]},e.transform=function(t,r,i){e.points2(r,s),n.d.transformMat4(s[0],s[0],i),n.d.transformMat4(s[1],s[1],i),n.d.transformMat4(s[2],s[2],i),n.d.transformMat4(s[3],s[3],i),n.d.transformMat4(s[4],s[4],i),n.d.transformMat4(s[5],s[5],i),n.d.transformMat4(s[6],s[6],i),n.d.transformMat4(s[7],s[7],i),t[0]=s[0][0],t[3]=s[0][0],t[1]=s[0][1],t[4]=s[0][1],t[2]=s[0][2],t[5]=s[0][2];for(var a=1;a<8;a++)t[0]>s[a][0]&&(t[0]=s[a][0]),t[3]<s[a][0]&&(t[3]=s[a][0]),t[1]>s[a][1]&&(t[1]=s[a][1]),t[4]<s[a][1]&&(t[4]=s[a][1]),t[2]>s[a][2]&&(t[2]=s[a][2]),t[5]<s[a][2]&&(t[5]=s[a][2])},e}();e.aabb=u;var c=function(){function e(){}return e.create=function(e,t,r){var i=t[0]-e[0],a=t[1]-e[1],o=t[2]-e[2],s=r[0]-e[0],l=r[1]-e[1],u=r[2]-e[2],c=n.e.create();return c[0]=a*u-o*l,c[1]=o*s-i*u,c[2]=i*l-a*s,c[3]=-(c[0]*e[0]+c[1]*e[1]+c[2]*e[2]),this.normalize(c),c},e.createABCD=function(e,t,r,i){var a=n.e.fromValues(e,t,r,i);return this.normalize(a),a},e.normalize=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t,e[3]/=t},e}();e.plane=c;var h=function(){function e(){}return e.createFromAABB=function(e){var t=new Float32Array(4);return t[0]=.5*(e[0]+e[3]),t[1]=.5*(e[1]+e[4]),t[2]=.5*(e[2]+e[5]),t[3]=.5*u.len(e),t},e.createFromArray=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e}();e.sphere=h;var d=n.a.create(),p=function(){function e(){}return e.createFromMatrix=function(e){var t,r=[];for(t=0;t<14;++t)r.push(n.e.create());for(n.a.invert(d,e),n.e.transformMat4(r[6],[-1,-1,-1,1],d),n.e.transformMat4(r[7],[1,-1,-1,1],d),n.e.transformMat4(r[8],[1,-1,1,1],d),n.e.transformMat4(r[9],[-1,-1,1,1],d),n.e.transformMat4(r[10],[-1,1,-1,1],d),n.e.transformMat4(r[11],[1,1,-1,1],d),n.e.transformMat4(r[12],[1,1,1,1],d),n.e.transformMat4(r[13],[-1,1,1,1],d),t=6;t<14;++t)n.e.scale(r[t],r[t],1/r[t][3]);var i=-e[3],a=-e[7],o=-e[11],s=-e[15];return r[0]=c.createABCD(i-e[2],a-e[6],o-e[10],s-e[14]),r[1]=c.createABCD(i+e[2],a+e[6],o+e[10],s+e[14]),r[2]=c.createABCD(i+e[1],a+e[5],o+e[9],s+e[13]),r[3]=c.createABCD(i-e[1],a-e[5],o-e[9],s-e[13]),r[4]=c.createABCD(i-e[0],a-e[4],o-e[8],s-e[12]),r[5]=c.createABCD(i+e[0],a+e[4],o+e[8],s+e[12]),r},e.points=function(e){return e.slice(6)},e.planes=function(e){var t=[];return t.push(e[0]),t.push(e[1]),t.push(e[2]),t.push(e[3]),t.push(e[4]),t.push(e[5]),t},e}();e.frustum=p;var f=new Array(4),m=[0,0,0],_=[0,0,0],v=[0,0,0],y=[0,0,0],g=[0,0,0],b=[0,0,0],w=[0,0,0],x=[0,0,0],M=function(){function e(){}return e.line_plane=function(e,t,r){n.d.subtract(g,e,t),n.d.normalize(y,g);var i=n.d.dot(y,r);if(Math.abs(i)<=.001)return null;for(var a=-(n.d.dot(t,r)+r[3])/i,o=0;o<3;++o)if(a*y[o]/g[o]<0||a*y[o]/g[o]>1)return null;var s=n.d.create();return s[0]=t[0]+a*y[0],s[1]=t[1]+a*y[1],s[2]=t[2]+a*y[2],s},e.line_frustum=function(t,r,i,n){for(var a=[[0,1,5,4],[2,3,7,6],[4,5,6,7],[0,3,2,1],[0,4,7,3],[1,2,6,5]],o=!1,s=0;s<6;s++){var l=i[s],u=[];u.push(i[a[s][0]+6]),u.push(i[a[s][1]+6]),u.push(i[a[s][2]+6]),u.push(i[a[s][3]+6]);var c=e.line_frustum_quad(t,r,l,u);null!==c&&(n.push(c),o=!0)}return o},e.line_aabb=function(t,r,i,n){for(var a=u.planes(i),o=!1,s=0;s<6;s++){var l=e.line_aabb_quad(t,r,a[s],i,s);null!=l&&(n.push(l),o=!0)}return o},e.line_frustum_quad=function(t,r,i,n){var a;return null==(a=e.line_plane(t,r,i))?null:T.point_triangle(n[0],n[1],n[2],a)||T.point_triangle(n[2],n[3],n[0],a)?a:null},e.line_aabb_quad=function(t,r,i,n,a){var o;if(null===(o=e.line_plane(t,r,i)))return null;var s=!1;switch(a){case 1:case 4:s=T.point_slab(o[0],n[0],n[3])&&T.point_slab(o[2],n[2],n[5]);break;case 5:case 2:s=T.point_slab(o[0],n[0],n[3])&&T.point_slab(o[1],n[1],n[4]);break;case 0:case 3:s=T.point_slab(o[1],n[1],n[4])&&T.point_slab(o[2],n[2],n[5])}return s?o:null},e.ray_aabb=function(e,t,r){for(var i=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,a=!0,o=-1,s=0;s<3;s++){var l=t[s],u=e[s],c=r[s],h=r[s+3];if(0!==l){var d=(c-u)/l,p=(h-u)/l,m=0;if(d>p){var _=p;p=d,d=_,m=1}if(d>i&&(i=d,o=2*s+m),(i=Math.max(d,i))>(n=Math.min(p,n))){a=!1;break}if(n<0){a=!1;break}}else if(l<c||l>h){a=!1;break}}return a?(f[0]=e[0]+t[0]*i,f[1]=e[1]+t[1]*i,f[2]=e[2]+t[2]*i,f[3]=o,f):null},e.sphere_frustum=function(e,t){return n.d.dot(t[0],e)+t[0][3]<e[3]&&n.d.dot(t[1],e)+t[1][3]<e[3]&&n.d.dot(t[2],e)+t[2][3]<e[3]&&n.d.dot(t[3],e)+t[3][3]<e[3]&&n.d.dot(t[4],e)+t[4][3]<e[3]&&n.d.dot(t[5],e)+t[5][3]<e[3]},e.prototype.sphere_cone=function(e,t){n.d.scale(m,t.direction,t.invSinTheta*e[3]),n.d.subtract(_,t.tip,m),n.d.subtract(v,e,_);var r=n.d.dot(v,v),i=n.d.dot(t.direction,v);return i>0&&i*i>=r*t.cosThetaSquared&&(n.d.subtract(v,e,t.tip),r=n.d.dot(v,v),!((i=-n.d.dot(t.direction,v))>0&&i*i>=r*t.sinThetaSquared)||r<=e[3]*e[3])},e.aabb_frustum=function(t,r){var i,n=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],a=u.points(t),o=p.points(r),s=[];for(i=0;i<12;i++)e.line_frustum(a[n[i][0]],a[n[i][1]],r,s);for(i=0;i<12;i++)e.line_aabb(o[n[i][0]],o[n[i][1]],t,s);for(i=0;i<8;i++){var l=a[i];T.point_frustum(l,r)&&s.push(l)}for(i=0;i<8;i++){var c=o[i];T.point_aabb(c,t)&&s.push(c)}return s},e.aabb_aabb=function(e,t){return(T.point_slab(e[0],t[0],t[3])||T.point_slab(e[3],t[0],t[3]))&&(T.point_slab(e[1],t[1],t[4])||T.point_slab(e[4],t[1],t[4]))&&(T.point_slab(e[2],t[2],t[5])||T.point_slab(e[5],t[2],t[5]))||(T.point_slab(t[0],e[0],e[3])||T.point_slab(t[3],e[0],e[3]))&&(T.point_slab(t[1],e[1],e[4])||T.point_slab(t[4],e[1],e[4]))&&(T.point_slab(t[2],e[2],e[5])||T.point_slab(t[5],e[2],e[5]))},e}();e.intersect=M;var T=function(){function e(){}return e.point_triangle=function(e,t,r,i){n.d.subtract(b,r,e),n.d.subtract(w,t,e),n.d.subtract(x,i,e);var a=n.d.dot(b,b),o=n.d.dot(b,w),s=n.d.dot(b,x),l=n.d.dot(w,w),u=n.d.dot(w,x),c=1/(a*l-o*o),h=(l*s-o*u)*c;if(h<0||h>1)return!1;var d=(a*u-o*s)*c;return!(d<0||d>1)&&h+d<=1},e.point_aabb=function(e,t){return e[0]>t[0]&&e[1]>t[1]&&e[2]>t[2]&&e[0]<t[3]&&e[1]<t[4]&&e[2]<t[5]},e.point_frustum=function(e,t){return n.d.dot(t[0],e)+t[0][3]<0&&n.d.dot(t[1],e)+t[1][3]<0&&n.d.dot(t[2],e)+t[2][3]<0&&n.d.dot(t[3],e)+t[3][3]<0&&n.d.dot(t[4],e)+t[4][3]<0&&n.d.dot(t[5],e)+t[5][3]<0},e.sphere_frustum=function(e,t){return n.d.dot(t[0],e)+t[0][3]<-e[3]&&n.d.dot(t[1],e)+t[1][3]<-e[3]&&n.d.dot(t[2],e)+t[2][3]<-e[3]&&n.d.dot(t[3],e)+t[3][3]<-e[3]&&n.d.dot(t[4],e)+t[4][3]<-e[3]&&n.d.dot(t[5],e)+t[5][3]<-e[3]},e.point_slab=function(e,t,r){return e<r&&e>t},e.aabb_frustum=function(t,r){var i=u.points(t);return e.point_frustum(i[0],r)&&e.point_frustum(i[1],r)&&e.point_frustum(i[2],r)&&e.point_frustum(i[3],r)&&e.point_frustum(i[4],r)&&e.point_frustum(i[5],r)&&e.point_frustum(i[6],r)&&e.point_frustum(i[7],r)},e}();e.inside=T;var E=function(){function e(){}return e.point_frustum=function(e,t){return n.d.dot(t[0],e)+t[0][3]>0||n.d.dot(t[1],e)+t[1][3]>0||n.d.dot(t[2],e)+t[2][3]>0||n.d.dot(t[3],e)+t[3][3]>0||n.d.dot(t[4],e)+t[4][3]>0||n.d.dot(t[5],e)+t[5][3]>0},e.sphere_frustum=function(e,t){return n.d.dot(t[0],e)+t[0][3]>e[3]||n.d.dot(t[1],e)+t[1][3]>e[3]||n.d.dot(t[2],e)+t[2][3]>e[3]||n.d.dot(t[3],e)+t[3][3]>e[3]||n.d.dot(t[4],e)+t[4][3]>e[3]||n.d.dot(t[5],e)+t[5][3]>e[3]},e.aabb_frustum=function(e,t){for(var r=0;r<6;r++){var i=t[r][0]>0?e[0]:e[3],n=t[r][1]>0?e[1]:e[4],a=t[r][2]>0?e[2]:e[5];if(t[r][0]*i+t[r][1]*n+t[r][2]*a+t[r][3]>0)return!0}for(r=0;r<3;r++){if(t[6][r]>e[1][r]&&t[7][r]>e[1][r]&&t[8][r]>e[1][r]&&t[9][r]>e[1][r]&&t[10][r]>e[1][r]&&t[11][r]>e[1][r]&&t[12][r]>e[1][r]&&t[13][r]>e[1][r])return!0;if(t[6][r]<e[0][r]&&t[7][r]<e[0][r]&&t[8][r]<e[0][r]&&t[9][r]<e[0][r]&&t[10][r]<e[0][r]&&t[11][r]<e[0][r]&&t[12][r]<e[0][r]&&t[13][r]<e[0][r])return!0}return!1},e.aabb_aabb=function(e,t){return e[3]<=t[0]||e[0]>=t[3]||e[4]<=t[1]||e[1]>=t[4]||e[5]<=t[2]||e[2]>=t[5]},e}();e.outside=E,e.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},e.lerp=function(e,t,r){return e+(t-e)*r},e.isPowerOfTwo=function(e){return 0==(e&e-1)&&0!==e},e.floorPowerOfTwo=function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.vfovToHfov=function(e,t){var r=2*Math.tan(e*Math.PI/180/2)*t;return 2*Math.atan(r/2)*180/Math.PI}}(i||(i={})),t.a=i},function(e,t,r){"use strict";var i=r(12),n={};n.pbr=new i.a("pbr",["main.vs","pbr_main.vs","transform_simple.inc"],["pbr.fs","pbr_main.fs","material_pbr.inc","shade_pbr.inc"],{highPrecision:!0,vpMatrix:!0,position:!0,normal:!0,modelMatrix:!0,uv:!0}),n["animating-stripe"]=new i.a("animating-stripe",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_animating_ribbon.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,uv:!0}),n["animating-ribbon"]=new i.a("animating-ribbon",["main.vs","modelo_ribbon.vs"],["main.fs","modelo_main.fs","material_animating_ribbon.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,uv:!0}),n.heightmap=new i.a("heightmap",["main.vs","modelo_main.vs","transform_heightmap.inc"],["main.fs","modelo_main.fs","material_heightmap.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),n.heatmap=new i.a("heatmap",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_heatmap.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!1,uv:!0}),n.volume=new i.a("volume",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_dummy.inc","shade_volume.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),n.volume_multi_layer=new i.a("volume_multi_layer",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_dummy.inc","shade_volume_multi_layer.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),n.color_multi_layer=new i.a("color_multi_layer",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_dummy.inc","shade_color_multi_layer.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),n.barchart_wireframe=new i.a("barchart_wireframe",["main.vs","modelo_main.vs","transform_barchart_wireframe.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!1,uv:!1}),n.barchart=new i.a("barchart",["main.vs","modelo_main.vs","transform_barchart.inc"],["main.fs","modelo_main.fs","material_barchart.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),n.blit=new i.a("blit","blit.vs",["blit.fs","blit_simple.inc"],{highPrecision:!0,position:!0,modelMatrix:!0,uv:!0}),n.blit_dof=new i.a("blit_dof","blit.vs",["blit.fs","blit_dof.inc"],{highPrecision:!0,position:!0,modelMatrix:!0,uv:!0}),n.blit_multiply=new i.a("blit","blit.vs",["blit.fs","blit_multiply.inc"],{highPrecision:!0,position:!0,modelMatrix:!0,uv:!0}),n.blit_glow=new i.a("blit_glow","blit.vs",["blit.fs","blit_glow.inc"],{highPrecision:!0,position:!0,modelMatrix:!0,uv:!0}),n.accumulate=new i.a("accumulate","blit.vs",["blit.fs","blit_accumulate.inc"],{highPrecision:!0,position:!0,uv:!0}),n.normaldepth=new i.a("normaldepth",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","normaldepth_main.fs"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,normal:!0,depth:!0,uv:!0}),n.depth=new i.a("depth",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","depth_main.fs"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,depth:!0,uv:!0}),n.solid=new i.a("solid",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_adhoc.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),n.dark=new i.a("dark",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_dark.fs"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),n.mark=new i.a("mark",["main.vs","modelo_main.vs","transform_mark.inc"],["main.fs","mark_main.fs"],{highPrecision:!0,modelMatrix:!0,vpMatrix:!0,vertexid:!0}),n.color=new i.a("color",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_color.inc","shade_adhoc.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,color:!0}),n.texture=new i.a("texture",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_texture.inc","shade_adhoc.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0,uv:!0}),n.glass=new i.a("glass",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_glass.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,normal:!0}),n.plain=new i.a("plain",["main.vs","modelo_main.vs","transform_nonormal.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0}),n.plain_texture=new i.a("plain_texture",["main.vs","modelo_main.vs","transform_nonormal.inc"],["main.fs","modelo_main.fs","material_texture.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,uv:!0}),n.df_text=new i.a("df_text",["main.vs","modelo_main.vs","transform_nonormal.inc"],["main.fs","modelo_main.fs","material_dummy.inc","shade_glyph.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0,uv:!0}),n.constant=new i.a("constant",["main.vs","modelo_main.vs","transform_nonormal.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,position:!0}),n.constant2d=new i.a("constant2d","blit.vs","blit_direct.fs",{highPrecision:!0,position:!0}),n.skybox=new i.a("skybox",["main.vs","modelo_main.vs","transform_skybox.inc"],["main.fs","modelo_main.fs","material_skybox.inc","shade_plain.inc"],{highPrecision:!0,vpMatrix:!0,modelMatrix:!0,uv:!0}),n.woit_accum_texture=new i.a("woit_accum_texture",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_texture.inc","shade_oit.inc"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,normal:!0,depth:!0,uv:!0}),n.woit_accum_solid=new i.a("woit_accum_solid",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_solid.inc","shade_oit.inc"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,normal:!0,depth:!0}),n.woit_accum_color=new i.a("woit_accum_color",["main.vs","modelo_main.vs","transform_simple.inc"],["main.fs","modelo_main.fs","material_color.inc","shade_oit.inc"],{highPrecision:!0,vpMatrix:!0,viewMatrix:!0,modelMatrix:!0,position:!0,normal:!0,depth:!0}),n.woit_reveal=new i.a("woit_reveal","blit.vs",["blit.fs","blit_oit.inc"],{highPrecision:!0,modelMatrix:!0,position:!0}),n.ssao=new i.a("ssao","blit.vs",["blit.fs","blit_ssao2.inc"],{highPrecision:!0}),n.shadowsmooth=new i.a("shadowsmooth","blit.vs",["blit.fs","blit_shadow.inc"],{highPrecision:!0,position:!0,uv:!0}),n.sketch=new i.a("sketch","blit.vs",["blit.fs","blit_sketch.inc"],{highPrecision:!0,position:!0,uv:!0}),n.contour=new i.a("contour","blit.vs",["blit.fs","blit_contour.inc"],{highPrecision:!0,position:!0,uv:!0}),n.contouroverlay=new i.a("contouroverlay","blit.vs",["blit.fs","blit_contour_overlay.inc"],{highPrecision:!0,position:!0,uv:!0}),n.outline=new i.a("outline","blit.vs",["blit.fs","blit_outline.inc"],{highPrecision:!0,position:!0,uv:!0}),n.outlineoverlay=new i.a("outlineoverlay","blit.vs",["blit.fs","blit_outline_overlay.inc"],{highPrecision:!0,position:!0,uv:!0}),n.vr_wrap=new i.a("vr_wrap","blit.vs",["blit.fs","blit_vr_wrap.inc"],{highPrecision:!0,position:!0,uv:!0}),n.gradient=new i.a("gradient","blit.vs",["blit.fs","blit_gradient.inc"],{highPrecision:!0,position:!0,uv:!0}),n.glow=new i.a("glow","blit.vs",["blit.fs","blit_glow.inc"],{highPrecision:!0,position:!0,uv:!0}),n.glow_blur=new i.a("glow_blur","blit.vs",["blit.fs","blit_glow_blur.inc"],{highPrecision:!0,position:!0,uv:!0}),n.fog=new i.a("fog","blit.vs",["blit.fs","blit_fog.inc"],{highPrecision:!0,position:!0,uv:!0}),n.metaball=new i.a("metaball","blit.vs",["blit.fs","blit_metaball.inc"],{highPrecision:!0,position:!0,uv:!0}),n.overlay=new i.a("overlay","blit.vs",["blit.fs","blit_overlay.inc"],{highPrecision:!0,position:!0,uv:!0}),n.background=new i.a("background","blit.vs",["blit.fs","blit_transparent.inc"],{highPrecision:!0,position:!0,uv:!0}),t.a=n},function(e,t,r){"use strict";r.d(t,"c",function(){return n}),r.d(t,"a",function(){return a}),r.d(t,"e",function(){return o}),r.d(t,"b",function(){return s}),r.d(t,"d",function(){return l}),r.d(t,"f",function(){return u});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function n(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}function s(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})}function l(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function u(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,n++)i[n]=a[o];return i}},function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return V}),r.d(t,"b",function(){return d}),r.d(t,"c",function(){return E}),r.d(t,"d",function(){return j}),r.d(t,"e",function(){return q}),r.d(t,"f",function(){return H}),r.d(t,"g",function(){return I}),r.d(t,"h",function(){return O}),r.d(t,"i",function(){return g}),r.d(t,"j",function(){return P}),r.d(t,"k",function(){return T}),r.d(t,"l",function(){return D}),r.d(t,"m",function(){return A}),r.d(t,"n",function(){return k}),r.d(t,"o",function(){return N}),r.d(t,"p",function(){return h}),r.d(t,"q",function(){return K}),r.d(t,"r",function(){return x}),r.d(t,"s",function(){return w}),r.d(t,"t",function(){return f}),r.d(t,"u",function(){return _}),r.d(t,"v",function(){return m}),r.d(t,"w",function(){return y}),r.d(t,"x",function(){return Y}),r.d(t,"y",function(){return X}),r.d(t,"z",function(){return J}),r.d(t,"A",function(){return ee}),r.d(t,"B",function(){return te}),r.d(t,"C",function(){return G}),r.d(t,"D",function(){return z}),r.d(t,"E",function(){return p}),r.d(t,"F",function(){return b}),r.d(t,"G",function(){return u}),r.d(t,"H",function(){return v}),r.d(t,"I",function(){return Z});var i=r(30),n=r(8),a=r(5),o=r(108),s=r.n(o);r(65);function l(e,t,r,i){if(function(e){return"IntValue"===e.kind}(r)||function(e){return"FloatValue"===e.kind}(r))e[t.value]=Number(r.value);else if(function(e){return"BooleanValue"===e.kind}(r)||function(e){return"StringValue"===e.kind}(r))e[t.value]=r.value;else if(function(e){return"ObjectValue"===e.kind}(r)){var a={};r.fields.map(function(e){return l(a,e.name,e.value,i)}),e[t.value]=a}else if(function(e){return"Variable"===e.kind}(r)){var o=(i||{})[r.name.value];e[t.value]=o}else if(function(e){return"ListValue"===e.kind}(r))e[t.value]=r.values.map(function(e){var r={};return l(r,t,e,i),r[t.value]});else if(function(e){return"EnumValue"===e.kind}(r))e[t.value]=r.value;else{if(!function(e){return"NullValue"===e.kind}(r))throw new n.a(17);e[t.value]=null}}function u(e,t){var r=null;e.directives&&(r={},e.directives.forEach(function(e){r[e.name.value]={},e.arguments&&e.arguments.forEach(function(i){var n=i.name,a=i.value;return l(r[e.name.value],n,a,t)})}));var i=null;return e.arguments&&e.arguments.length&&(i={},e.arguments.forEach(function(e){var r=e.name,n=e.value;return l(i,r,n,t)})),h(e.name.value,i,r)}var c=["connection","include","skip","client","rest","export"];function h(e,t,r){if(r&&r.connection&&r.connection.key){if(r.connection.filter&&r.connection.filter.length>0){var i=r.connection.filter?r.connection.filter:[];i.sort();var n=t,a={};return i.forEach(function(e){a[e]=n[e]}),r.connection.key+"("+JSON.stringify(a)+")"}return r.connection.key}var o=e;if(t){var l=s()(t);o+="("+l+")"}return r&&Object.keys(r).forEach(function(e){-1===c.indexOf(e)&&(r[e]&&Object.keys(r[e]).length?o+="@"+e+"("+JSON.stringify(r[e])+")":o+="@"+e)}),o}function d(e,t){if(e.arguments&&e.arguments.length){var r={};return e.arguments.forEach(function(e){var i=e.name,n=e.value;return l(r,i,n,t)}),r}return null}function p(e){return e.alias?e.alias.value:e.name.value}function f(e){return"Field"===e.kind}function m(e){return"InlineFragment"===e.kind}function _(e){return e&&"id"===e.type&&"boolean"==typeof e.generated}function v(e,t){return void 0===t&&(t=!1),Object(a.a)({type:"id",generated:t},"string"==typeof e?{id:e,typename:void 0}:e)}function y(e){return null!=e&&"object"==typeof e&&"json"===e.type}function g(e,t){if(e.directives&&e.directives.length){var r={};return e.directives.forEach(function(e){r[e.name.value]=d(e,t)}),r}return null}function b(e,t){return void 0===t&&(t={}),function(e){return e?e.filter(M).map(function(e){var t=e.arguments;e.name.value;Object(n.b)(t&&1===t.length,14);var r=t[0];Object(n.b)(r.name&&"if"===r.name.value,15);var i=r.value;return Object(n.b)(i&&("Variable"===i.kind||"BooleanValue"===i.kind),16),{directive:e,ifArgument:r}}):[]}(e.directives).every(function(e){var r=e.directive,i=e.ifArgument,a=!1;return"Variable"===i.value.kind?(a=t[i.value.name.value],Object(n.b)(void 0!==a,13)):a=i.value.value,"skip"===r.name.value?!a:a})}function w(e,t){return function(e){var t=[];return Object(i.visit)(e,{Directive:function(e){t.push(e.name.value)}}),t}(t).some(function(t){return e.indexOf(t)>-1})}function x(e){return e&&w(["client"],e)&&w(["export"],e)}function M(e){var t=e.name.value;return"skip"===t||"include"===t}function T(e,t){var r=t,i=[];return e.definitions.forEach(function(e){if("OperationDefinition"===e.kind)throw new n.a(11);"FragmentDefinition"===e.kind&&i.push(e)}),void 0===r&&(Object(n.b)(1===i.length,12),r=i[0].name.value),Object(a.a)(Object(a.a)({},e),{definitions:Object(a.f)([{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:r}}]}}],e.definitions)})}function E(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(t){void 0!==t&&null!==t&&Object.keys(t).forEach(function(r){e[r]=t[r]})}),e}function S(e){Object(n.b)(e&&"Document"===e.kind,2);var t=e.definitions.filter(function(e){return"FragmentDefinition"!==e.kind}).map(function(e){if("OperationDefinition"!==e.kind)throw new n.a(3);return e});return Object(n.b)(t.length<=1,4),e}function A(e){return S(e),e.definitions.filter(function(e){return"OperationDefinition"===e.kind})[0]}function k(e){return e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&e.name}).map(function(e){return e.name.value})[0]||null}function P(e){return e.definitions.filter(function(e){return"FragmentDefinition"===e.kind})}function N(e){var t=A(e);return Object(n.b)(t&&"query"===t.operation,6),t}function D(e){var t;S(e);for(var r=0,i=e.definitions;r<i.length;r++){var a=i[r];if("OperationDefinition"===a.kind){var o=a.operation;if("query"===o||"mutation"===o||"subscription"===o)return a}"FragmentDefinition"!==a.kind||t||(t=a)}if(t)return t;throw new n.a(10)}function I(e){void 0===e&&(e=[]);var t={};return e.forEach(function(e){t[e.name.value]=e}),t}function O(e){if(e&&e.variableDefinitions&&e.variableDefinitions.length){var t=e.variableDefinitions.filter(function(e){return e.defaultValue}).map(function(e){var t=e.variable,r=e.defaultValue,i={};return l(i,t.name,r),i});return E.apply(void 0,Object(a.f)([{}],t))}return{}}function R(e,t,r){var i=0;return e.forEach(function(r,n){t.call(this,r,n,e)&&(e[i++]=r)},r),e.length=i,e}var C={kind:"Field",name:{kind:"Name",value:"__typename"}};function B(e){return function e(t,r){return t.selectionSet.selections.every(function(t){return"FragmentSpread"===t.kind&&e(r[t.name.value],r)})}(A(e)||function(e){Object(n.b)("Document"===e.kind,7),Object(n.b)(e.definitions.length<=1,8);var t=e.definitions[0];return Object(n.b)("FragmentDefinition"===t.kind,9),t}(e),I(P(e)))?null:e}function L(e){return function(t){return e.some(function(e){return e.name&&e.name===t.name.value||e.test&&e.test(t)})}}function F(e,t){var r=Object.create(null),n=[],o=Object.create(null),s=[],l=B(Object(i.visit)(t,{Variable:{enter:function(e,t,i){"VariableDefinition"!==i.kind&&(r[e.name.value]=!0)}},Field:{enter:function(t){if(e&&t.directives&&(e.some(function(e){return e.remove})&&t.directives&&t.directives.some(L(e))))return t.arguments&&t.arguments.forEach(function(e){"Variable"===e.value.kind&&n.push({name:e.value.name.value})}),t.selectionSet&&function e(t){var r=[];t.selections.forEach(function(t){(f(t)||m(t))&&t.selectionSet?e(t.selectionSet).forEach(function(e){return r.push(e)}):"FragmentSpread"===t.kind&&r.push(t)});return r}(t.selectionSet).forEach(function(e){s.push({name:e.name.value})}),null}},FragmentSpread:{enter:function(e){o[e.name.value]=!0}},Directive:{enter:function(t){if(L(e)(t))return null}}}));return l&&R(n,function(e){return!r[e.name]}).length&&(l=function(e,t){var r=function(e){return function(t){return e.some(function(e){return t.value&&"Variable"===t.value.kind&&t.value.name&&(e.name===t.value.name.value||e.test&&e.test(t))})}}(e);return B(Object(i.visit)(t,{OperationDefinition:{enter:function(t){return Object(a.a)(Object(a.a)({},t),{variableDefinitions:t.variableDefinitions.filter(function(t){return!e.some(function(e){return e.name===t.variable.name.value})})})}},Field:{enter:function(t){var i=e.some(function(e){return e.remove});if(i){var n=0;if(t.arguments.forEach(function(e){r(e)&&(n+=1)}),1===n)return null}}},Argument:{enter:function(e){if(r(e))return null}}}))}(n,l)),l&&R(s,function(e){return!o[e.name]}).length&&(l=function(e,t){function r(t){if(e.some(function(e){return e.name===t.name.value}))return null}return B(Object(i.visit)(t,{FragmentSpread:{enter:r},FragmentDefinition:{enter:r}}))}(s,l)),l}function V(e){return Object(i.visit)(S(e),{SelectionSet:{enter:function(e,t,r){if(!r||"OperationDefinition"!==r.kind){var i=e.selections;if(i)if(!i.some(function(e){return f(e)&&("__typename"===e.name.value||0===e.name.value.lastIndexOf("__",0))})){var n=r;if(!(f(n)&&n.directives&&n.directives.some(function(e){return"export"===e.name.value})))return Object(a.a)(Object(a.a)({},e),{selections:Object(a.f)(i,[C])})}}}}})}var U={test:function(e){var t="connection"===e.name.value;return t&&(!e.arguments||e.arguments.some(function(e){return"key"===e.name.value})),t}};function z(e){return F([U],S(e))}function j(e){return"query"===D(e).operation?e:Object(i.visit)(e,{OperationDefinition:{enter:function(e){return Object(a.a)(Object(a.a)({},e),{operation:"query"})}}})}function G(e){S(e);var t=F([{test:function(e){return"client"===e.name.value},remove:!0}],e);return t&&(t=Object(i.visit)(t,{FragmentDefinition:{enter:function(e){if(e.selectionSet&&e.selectionSet.selections.every(function(e){return f(e)&&"__typename"===e.name.value}))return null}}})),t}var q="function"==typeof WeakMap&&!("object"==typeof navigator&&"ReactNative"===navigator.product),Q=Object.prototype.toString;function H(e){return function e(t,r){switch(Q.call(t)){case"[object Array]":if(r.has(t))return r.get(t);var i=t.slice(0);return r.set(t,i),i.forEach(function(t,n){i[n]=e(t,r)}),i;case"[object Object]":if(r.has(t))return r.get(t);var n=Object.create(Object.getPrototypeOf(t));return r.set(t,n),Object.keys(t).forEach(function(i){n[i]=e(t[i],r)}),n;default:return t}}(e,new Map)}function W(t){return(void 0!==e?"production":"development")===t}function Y(){return!0===W("production")}function X(){return!0===W("test")}function Z(e){try{return e()}catch(e){console.error&&console.error(e)}}function K(e){return e.errors&&e.errors.length}function J(e){if((!0===W("development")||X())&&!("function"==typeof Symbol&&"string"==typeof Symbol("")))return function e(t){return Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(r){null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||e(t[r])}),t}(e);return e}var $=Object.prototype.hasOwnProperty;function ee(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return te(e)}function te(e){var t=e[0]||{},r=e.length;if(r>1){var i=[];t=ne(t,i);for(var n=1;n<r;++n)t=ie(t,e[n],i)}return t}function re(e){return null!==e&&"object"==typeof e}function ie(e,t,r){return re(t)&&re(e)?(Object.isExtensible&&!Object.isExtensible(e)&&(e=ne(e,r)),Object.keys(t).forEach(function(i){var n=t[i];if($.call(e,i)){var a=e[i];n!==a&&(e[i]=ie(ne(a,r),n,r))}else e[i]=n}),e):t}function ne(e,t){return null!==e&&"object"==typeof e&&t.indexOf(e)<0&&(e=Array.isArray(e)?e.slice(0):Object(a.a)({__proto__:Object.getPrototypeOf(e)},e),t.push(e)),e}Object.create({})}).call(this,r(52))},function(e,t,r){"use strict";var i=function(){function e(){this.upload=null,this.value=null,this.texUnit=-1}return e.prototype.uploadTexture=function(e,t){this.value&&this.value.use(this.texUnit),e&&e.upload(this.texUnit,t)},e.prototype.uploadValue=function(e,t){e.upload(this.value,t)},e}();t.a=i},function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return s}),r.d(t,"b",function(){return l});var i=r(5),n="Invariant Violation",a=Object.setPrototypeOf,o=void 0===a?function(e,t){return e.__proto__=t,e}:a,s=function(e){function t(r){void 0===r&&(r=n);var i=e.call(this,"number"==typeof r?n+": "+r+" (see https://github.com/apollographql/invariant-packages)":r)||this;return i.framesToPop=1,i.name=n,o(i,t.prototype),i}return Object(i.c)(t,e),t}(Error);function l(e,t){if(!e)throw new s(t)}function u(e){return function(){return console[e].apply(console,arguments)}}!function(e){e.warn=u("warn"),e.error=u("error")}(l||(l={}));var c={env:{}};if("object"==typeof e)c=e;else try{Function("stub","process = stub")(c)}catch(e){}}).call(this,r(52))},function(e,t,r){"use strict";var i=function(){function e(e,t,r,i,n){this.ready=!1,this.always=!1,this._name=e,this._options=n||{},this._framebuffer=null;var a=t.gl;if(this._options.hasOwnProperty("clearColor")||(this._options.clearColor=new Float32Array([1,1,1,0])),this._options.hasOwnProperty("colorMask")||(this._options.colorMask=new Int32Array([1,1,1,1])),this._options.hasOwnProperty("depthTest")||(this._options.depthTest=!0),this._options.hasOwnProperty("depthMask")||(this._options.depthMask=!0),this._options.hasOwnProperty("clearDepth")||(this._options.clearDepth=1),this._options.hasOwnProperty("depthFunc")||(this._options.depthFunc=a.LESS),this._options.hasOwnProperty("blend")||(this._options.blend=!1),this._options.hasOwnProperty("blendFunc")||(this._options.blendFunc=[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA]),this._options.hasOwnProperty("stencilTest")||(this._options.stencilTest=!1),this._options.hasOwnProperty("stencilOp")||(this._options.stencilOp=[a.KEEP,a.KEEP,a.REPLACE]),this._options.hasOwnProperty("stencilFunc")||(this._options.stencilFunc=[a.ALWAYS,0,-1]),this._options.hasOwnProperty("samples")||(this._options.samples=1),this._options.hasOwnProperty("depthFilter")||(this._options.depthFilter=a.NEAREST),this._framebuffer=t.getFramebuffer(this._name),this._framebuffer.ready)this._framebuffer.resize(r,i);else{var o=-1;n.hasOwnProperty("colorBuffer")&&(o=n.colorBuffer);var s=-1;n.hasOwnProperty("depthBuffer")&&(s=n.depthBuffer);var l,u=n.colorFormat||a.RGBA8,c=n.depthFormat||(a.isWebGL2?a.DEPTH_COMPONENT24:a.DEPTH_COMPONENT);this._options.stencilTest&&(c=a.isWebGL2?a.DEPTH24_STENCIL8:a.DEPTH_STENCIL),l=-1===o?e+"-cbuf":"c"+o.toString()+"-"+r.toString()+"x"+i.toString()+"-"+u+"x"+this._options.samples;var h=t.getTexture(l);if(!h.ready&&(h.create(r,i,u,this._options.colorFilter,this._options.colorWrap,this._options.samples),!h.ready))return console.warn("colorBufferObject named:"+l+"is ceate error"),h.destroy(),void(this.ready=!1);var d=[h];if(this._options.colorBuffers&&this._options.colorBuffers.length>0)for(var p=0,f=this._options.colorBuffers.length;p<f;p++){var m=this._options.colorBuffers[p];m.colorFormat=m.colorFormat||a.RGBA8,m.samples=m.samples||1,l=null==m.index?e+"-cbuf":"c"+m.index.toString()+"-"+r.toString()+"x"+i.toString()+"-"+m.colorFormat+"x"+m.samples;var _=t.getTexture(l);if(!_.ready&&(_.create(r,i,m.colorFormat,m.colorFilter,m.colorWrap,m.samples),!_.ready))return _.destroy(),console.warn("colorBufferObject named:"+l+"is ceate error"),void(this.ready=!1);d.push(_)}l=-1===s?e+"-dbuf":"d"+s.toString()+"-"+r.toString()+"x"+i.toString()+"-"+c+"x"+this._options.samples;var v=t.getTexture(l);if(!v.ready&&(v.create(r,i,c,this._options.depthFilter,this._options.depthWrap,this._options.samples),!v.ready))return v.destroy(),console.warn("depthBufferObject named:"+l+"is ceate error"),void(this.ready=!1);this._framebuffer.create(d,v)}this.ready=this._framebuffer.ready,this.ready||console.warn("framebuffer named  "+this._name+"  create error")}return e.prototype.destroy=function(){this._name=null,delete this._name,this._framebuffer.destroy(),this._framebuffer=null,delete this._framebuffer,this._options=null,delete this._options},e.prototype.render=function(e){this.ready?(e.useFramebuffer(this._framebuffer),e.blend(this._options.blend),this._options.blend&&e.blendFunc(this._options.blendFunc),e.clearColor(this._options.clearColor),e.colorMask(this._options.colorMask),e.depthTest(this._options.depthTest,this._options.clearDepth,this._options.depthFunc),e.depthMask(this._options.depthMask),e.stencilTest(this._options.stencilTest,this._options.stencilFunc,this._options.stencilOp,this._options.stencilMask)):console.log("render target '"+this._name+"' is not ready.")},e.prototype.resize=function(e,t){this.ready?(this.ready=!1,this._framebuffer.resize(e,t),this.ready=this._framebuffer.ready):console.log("render target '"+this._name+"' is not ready.")},e.prototype.setClearColor=function(e){this.ready?(this._options.clearColor[0]=e[0],this._options.clearColor[1]=e[1],this._options.clearColor[2]=e[2],this._options.clearColor[3]=e[3]):console.log("render target "+this._name+" is not ready.")},e.prototype.getOption=function(e){return this._options[e]},e.prototype.setOption=function(e,t){this._options[e]=t},e.prototype.getOptions=function(){return this._options},e.prototype.getColorBuffer=function(e){return this._framebuffer.getColorBuffer(e)},e.prototype.getDepthBuffer=function(){return this._framebuffer.getDepthBuffer()},e.prototype.getWidth=function(){return this._framebuffer.getWidth()},e.prototype.getHeight=function(){return this._framebuffer.getHeight()},e.prototype.getFramebuffer=function(){return this._framebuffer},e.prototype.getName=function(){return this._name},e}();t.a=i},function(e,t,r){"use strict";var i=r(11),n=new(function(){function e(){this.sub=this.subtract,this.mul=this.multiply,this.div=this.divide,this.dist=this.distance,this.sqrDist=this.squaredDistance,this.len=this.length,this.sqrLen=this.squaredLength}return e.prototype.create=function(){var e=new i.a.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e},e.prototype.clone=function(e){var t=new i.a.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.prototype.fromValues=function(e,t,r){var n=new i.a.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n},e.prototype.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.prototype.set=function(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e},e.prototype.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},e.prototype.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},e.prototype.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e},e.prototype.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e},e.prototype.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},e.prototype.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},e.prototype.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},e.prototype.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e},e.prototype.distance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(r*r+i*i+n*n)},e.prototype.squaredDistance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n},e.prototype.length=function(e){var t=e[0],r=e[1],i=e[2];return Math.sqrt(t*t+r*r+i*i)},e.prototype.squaredLength=function(e){var t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i},e.prototype.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},e.prototype.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},e.prototype.normalize=function(e,t){var r=t[0],i=t[1],n=t[2],a=r*r+i*i+n*n;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e},e.prototype.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.prototype.cross=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[0],s=r[1],l=r[2];return e[0]=n*l-a*s,e[1]=a*o-i*l,e[2]=i*s-n*o,e},e.prototype.lerp=function(e,t,r,i){var n=t[0],a=t[1],o=t[2];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=o+i*(r[2]-o),e},e.prototype.hermite=function(e,t,r,i,n,a){var o=a*a,s=o*(2*a-3)+1,l=o*(a-2)+a,u=o*(a-1),c=o*(3-2*a);return e[0]=t[0]*s+r[0]*l+i[0]*u+n[0]*c,e[1]=t[1]*s+r[1]*l+i[1]*u+n[1]*c,e[2]=t[2]*s+r[2]*l+i[2]*u+n[2]*c,e},e.prototype.bezier=function(e,t,r,i,n,a){var o=1-a,s=o*o,l=a*a,u=s*o,c=3*a*s,h=3*l*o,d=l*a;return e[0]=t[0]*u+r[0]*c+i[0]*h+n[0]*d,e[1]=t[1]*u+r[1]*c+i[1]*h+n[1]*d,e[2]=t[2]*u+r[2]*c+i[2]*h+n[2]*d,e},e.prototype.random=function(e,t){t=t||1;var r=2*i.a.RANDOM()*Math.PI,n=2*i.a.RANDOM()-1,a=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*a,e[1]=Math.sin(r)*a,e[2]=n*t,e},e.prototype.transformMat4=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[3]*i+r[7]*n+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*i+r[4]*n+r[8]*a+r[12])/o,e[1]=(r[1]*i+r[5]*n+r[9]*a+r[13])/o,e[2]=(r[2]*i+r[6]*n+r[10]*a+r[14])/o,e},e.prototype.transformMat3=function(e,t,r){var i=t[0],n=t[1],a=t[2];return e[0]=i*r[0]+n*r[3]+a*r[6],e[1]=i*r[1]+n*r[4]+a*r[7],e[2]=i*r[2]+n*r[5]+a*r[8],e},e.prototype.transformQuat=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*i+s*a-l*n,h=u*n+l*i-o*a,d=u*a+o*n-s*i,p=-o*i-s*n-l*a;return e[0]=c*u+p*-o+h*-l-d*-s,e[1]=h*u+p*-s+d*-o-c*-l,e[2]=d*u+p*-l+c*-s-h*-o,e},e.prototype.rotateX=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[0],a[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),a[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},e.prototype.rotateY=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),a[1]=n[1],a[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},e.prototype.rotateZ=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),a[2]=n[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},e.prototype.rotateAxisZ=function(e,t,r){return e[0]=t[0]*Math.cos(r)-t[1]*Math.sin(r),e[1]=t[0]*Math.sin(r)+t[1]*Math.cos(r),e[2]=t[2],e},e.prototype.rotateByVector=function(e,t,r,i){var n=Math.cos(i),a=Math.sin(i);return e[0]=(r[0]*r[0]*(1-n)+n)*t[0]+(r[0]*r[1]*(1-n)-r[2]*a)*t[1]+(r[0]*r[2]*(1-n)+r[1]*a)*t[2],e[1]=(r[1]*r[0]*(1-n)+r[2]*a)*t[0]+(r[1]*r[1]*(1-n)+n)*t[1]+(r[1]*r[2]*(1-n)-r[0]*a)*t[2],e[2]=(r[0]*r[2]*(1-n)-r[1]*a)*t[0]+(r[1]*r[2]*(1-n)+r[0]*a)*t[1]+(r[2]*r[2]*(1-n)+n)*t[2],e},e.prototype.forEach=function(e,t,r,i,n,a){var o,s,l=this.create();for(t||(t=3),r||(r=0),s=i?Math.min(i*t+r,e.length):e.length,o=r;o<s;o+=t)l[0]=e[o],l[1]=e[o+1],l[2]=e[o+2],n(l,l,a),e[o]=l[0],e[o+1]=l[1],e[o+2]=l[2];return e},e.prototype.angle=function(e,t){var r=this.fromValues(e[0],e[1],e[2]),i=this.fromValues(t[0],t[1],t[2]);this.normalize(r,r),this.normalize(i,i);var n=this.dot(r,i);return n>1?0:n<-1?Math.PI:Math.acos(n)},e.prototype.angleTo=function(e,t){var r=this.create();this.cross(r,e,t);var i=this.fromValues(e[0],e[1],e[2]),n=this.fromValues(t[0],t[1],t[2]);this.normalize(i,i),this.normalize(n,n);var a=this.dot(i,n);return a>1?0:a<-1?Math.PI:r[2]>0?Math.acos(a):-Math.acos(a)},e.prototype.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},e.prototype.clamp=function(e,t,r){return Math.max(t,Math.min(r,e))},e}());t.a=n},function(e,t,r){"use strict";var i=new(function(){function e(){this.degree=Math.PI/180,this.EPSILON=1e-6,this.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,this.RANDOM=Math.random,this.ENABLE_SIMD=!1,this.SIMD_AVAILABLE=this.ARRAY_TYPE===Float32Array&&"SIMD"in this,this.USE_SIMD=this.ENABLE_SIMD&&this.SIMD_AVAILABLE}return e.prototype.setMatrixArrayType=function(e){this.ARRAY_TYPE=e},e.prototype.toRadian=function(e){return e*this.degree},e}());t.a=i},function(e,t,r){"use strict";var i={"blit.fs":"uniform sampler2D m_uBlitTexture;\r\n#if MOBILE\r\nuniform sampler2D m_uBlitDepthTexture;\r\n#endif\r\nuniform vec2 m_uInvResolution;\r\n\r\n#if WEBGL2\r\n\r\nin vec2 m_vTexCoord;\r\nout vec4 out_color;\r\n\r\n#else \r\n\r\nvarying vec2 m_vTexCoord;\r\n\r\n#endif\r\n\r\n#include <uniform.inc>\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution);\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution);\r\n#endif\r\nvoid main() \r\n{ \r\n#if WEBGL2\r\n\r\n#if MOBILE\r\n out_color = shade(m_uBlitTexture, m_uBlitDepthTexture, m_vTexCoord, m_uInvResolution);\r\n#else\r\n out_color = shade(m_uBlitTexture, m_vTexCoord, m_uInvResolution);\r\n#endif\r\n\r\n#else\r\n\r\n#if MOBILE\r\n gl_FragColor = shade(m_uBlitTexture, m_uBlitDepthTexture, m_vTexCoord, m_uInvResolution);\r\n#else\r\n gl_FragColor = shade(m_uBlitTexture, m_vTexCoord, m_uInvResolution);\r\n#endif\r\n\r\n#endif\r\n}\r\n","blit.vs":"#if WEBGL2\r\n\r\nin vec3 m_aPosition;\r\nin vec2 m_aTexCoord;\r\nout vec2 m_vTexCoord;\r\n\r\n#else\r\n\r\nattribute vec3 m_aPosition;\r\nattribute vec2 m_aTexCoord;\r\nvarying vec2 m_vTexCoord;\r\n\r\n#endif\r\n\r\nvoid main() \r\n{ \r\n#if MODEL_TRANSFORM\r\n gl_Position = m_uPerNode.modelMatrix * vec4(m_aPosition.xy, 0.999999, 1.0); \r\n#else\r\n gl_Position = vec4(m_aPosition.xy, 0.999999, 1.0); \r\n#endif\r\n m_vTexCoord = m_aTexCoord;\r\n}\r\n\r\n","blit_accumulate.inc":"uniform sampler2D uTexture0;\r\nuniform float uFrameCount;\r\n\r\nfloat random( vec2 p )\r\n{\r\n return fract(sin(dot(p.xy, vec2(12.9898, 78.233))) * (43758.5453 + uFrameCount * 1231.3));\r\n}\r\n \r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 accum = sampleTexture2D(tex, uv);\r\n vec4 sampleColor = sampleTexture2D(uTexture0, uv); \r\n vec4 result = (sampleColor + (uFrameCount - 1.0) * accum) / uFrameCount;\r\n float dither = 1.0/255.0 * (random(uv - 0.5) - 0.5);\r\n result += vec4(dither,dither, dither, 0.0);\r\n\r\n return result;\r\n}\r\n\r\n","blit_simple.inc":"#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n return sampleTexture2D(tex, uv);\r\n}\r\n","blit_vr_wrap.inc":"uniform vec2 uLeftCenterOffset; \r\nuniform vec2 uRightCenterOffset; \r\nuniform vec4 uWarpScaleParam; \r\nuniform vec3 uHmdWarpParam; \r\nuniform bool uCalibration;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 res;\r\n if(m_vTexCoord.x <= 0.5){ \r\n vec2 coord = vec2(m_vTexCoord.x * 2.0, m_vTexCoord.y); \r\n vec2 offset = (coord.xy - uLeftCenterOffset) * uWarpScaleParam.xy;\r\n float dist2 = offset.x * offset.x + offset.y * offset.y;\r\n \r\n vec2 offsetWarp = offset * (uHmdWarpParam.x + uHmdWarpParam.y * dist2 + uHmdWarpParam.z * dist2 * dist2);\r\n vec2 sampLoc = uLeftCenterOffset + offsetWarp * uWarpScaleParam.zw;\r\n \r\n if(all(equal(clamp(sampLoc, 0.0, 1.0), sampLoc)))\r\n res = sampleTexture2D(tex, vec2(sampLoc.x * 0.5, sampLoc.y)); \r\n else\r\n res = vec4(0.0);\r\n \r\n if (uCalibration) {\r\n if(res.w > 0.0 && (mod(sampLoc.x - uLeftCenterOffset.x, 0.1) < 0.002 || mod(sampLoc.y, 0.1) < 0.002))\r\n res = vec4(0.0,0.0,1.0,1.0);\r\n \r\n if(length(coord.xy - uLeftCenterOffset) < 0.01) \r\n res = vec4(0.0, 0.0, 0.0, 1.0);\r\n }\r\n } else { \r\n vec2 coord = vec2((m_vTexCoord.x - 0.5) * 2.0, m_vTexCoord.y); \r\n vec2 offset = (coord.xy - uRightCenterOffset) * uWarpScaleParam.xy;\r\n float dist2 = offset.x * offset.x + offset.y * offset.y;\r\n vec2 offsetWarp = offset * (uHmdWarpParam.x + \r\n uHmdWarpParam.y * dist2 + uHmdWarpParam.z * dist2 * dist2);\r\n vec2 sampLoc = uRightCenterOffset + offsetWarp * uWarpScaleParam.zw;\r\n if(all(equal(clamp(sampLoc, 0.0, 1.0), sampLoc)))\r\n res = sampleTexture2D(tex, vec2(sampLoc.x* 0.5 + 0.5, sampLoc.y));\r\n else\r\n res = vec4(0.0, 0.0, 0.0, 1.0);\r\n\r\n if (uCalibration) {\r\n if(res.w > 0.0 && (mod(sampLoc.x - uRightCenterOffset.x, 0.1) < 0.002 || mod(sampLoc.y, 0.1) < 0.002))\r\n res = vec4(0.0,0.0,1.0,1.0);\r\n if(length(coord.xy - uRightCenterOffset) < 0.01)\r\n res = vec4(1.0,0.0,0.0,1.0);\r\n }\r\n\r\n }\r\n return res;\r\n}\r\n","clipping.inc":"#if CLIPPING\r\n if (dot(m_vVertex.xyz, m_uGlobal.clipPlanes[0].xyz) > m_uGlobal.clipPlanes[0].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[1].xyz) > m_uGlobal.clipPlanes[1].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[2].xyz) > m_uGlobal.clipPlanes[2].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[3].xyz) > m_uGlobal.clipPlanes[3].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[4].xyz) > m_uGlobal.clipPlanes[4].w ||\r\n dot(m_vVertex.xyz, m_uGlobal.clipPlanes[5].xyz) > m_uGlobal.clipPlanes[5].w) {\r\n discard;\r\n }\r\n#endif","depth_main.fs":"#include <globalvars.inc>\r\n\r\n#if ENCODE_DEPTH\r\nvec4 encodeDepth(float depth)\r\n{\r\n const vec4 bitShift = vec4(255.0*255.0*255.0, 255.0*255.0, 255.0, 1.0);\r\n const vec4 bitMask = vec4(0.0, 1.0/255.0, 1.0/255.0, 1.0/255.0);\r\n vec4 res = fract(depth * bitShift); \r\n res -= res.xxyz * bitMask; \r\n return res;\r\n}\r\n#endif\r\n\r\n#if WEBGL2\r\n out vec4 out_color;\r\n#endif\r\n\r\n#if ALPHATEST\r\n uniform sampler2D m_uDiffuseTexture;\r\n#endif\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n#if ALPHATEST\r\n vec4 texel = sampleTexture2D(m_uDiffuseTexture, m_vTexCoord.xy);\r\n if (texel.a < 0.15)\r\n {\r\n discard;\r\n }\r\n#endif\r\n\r\n#if ENCODE_DEPTH\r\n vec4 o = encodeDepth(gl_FragCoord.z); \r\n#else\r\n vec4 o = gl_FragCoord.zzzz;\r\n#endif\r\n\r\n#if WEBGL2\r\n out_color = o;\r\n#else\r\n gl_FragColor = o;\r\n#endif\r\n}\r\n","gamma.inc":"float linearTosRGB1(const in float c, const in float gamma)\r\n{\r\n float v = 0.0;\r\n if (c < 0.0031308) \r\n {\r\n if ( c > 0.0) \r\n {\r\n v = c * 12.92;\r\n }\r\n } \r\n else \r\n {\r\n v = 1.055 * pow(c, 1.0 / gamma) - 0.055;\r\n }\r\n return v;\r\n}\r\n\r\nvec3 linearTosRGB(const in vec3 rgb, const in float gamma)\r\n{\r\n vec3 ret;\r\n ret.r = linearTosRGB1(rgb.r, gamma);\r\n ret.g = linearTosRGB1(rgb.g, gamma);\r\n ret.b = linearTosRGB1(rgb.b, gamma);\r\n return ret;\r\n}\r\n\r\nfloat sRGBToLinear1(const in float c, const in float gamma)\r\n{\r\n float v = 0.0;\r\n if (c < 0.04045)\r\n {\r\n if (c >= 0.0)\r\n {\r\n v = c * ( 1.0 / 12.92);\r\n }\r\n } \r\n else \r\n {\r\n v = pow((c + 0.055) * (1.0 / 1.055), gamma);\r\n }\r\n return v;\r\n}\r\n\r\nvec3 sRGBToLinear(const in vec3 srgb, const in float gamma)\r\n{\r\n vec3 ret;\r\n ret.r = sRGBToLinear1(srgb.r, gamma);\r\n ret.g = sRGBToLinear1(srgb.g, gamma);\r\n ret.b = sRGBToLinear1(srgb.b, gamma);\r\n\r\n return ret;\r\n}\r\n","globalvars.inc":"#if CLIPPING\r\nstruct GlobalStruct\r\n{\r\n vec4 clipPlanes[6];\r\n};\r\nuniform GlobalStruct m_uGlobal;\r\n#endif\r\n","lights.inc":"struct SunLightStruct\r\n{\r\n mat4 diffuseMatrix[3];\r\n float intensity;\r\n vec3 direction;\r\n mat4 shadowMatrix0;\r\n mat4 shadowMatrix1;\r\n};\r\nuniform SunLightStruct m_uSunLight;\r\nuniform sampler2D m_uSunLightProbe;\r\n\r\nstruct PointLightStruct\r\n{\r\n vec3 color;\r\n vec3 position;\r\n float radius;\r\n};\r\n\r\nstruct DirectionalLightStruct\r\n{\r\n vec3 color;\r\n vec3 direction;\r\n};\r\n\r\nstruct SpotLightStruct\r\n{\r\n vec3 color;\r\n vec3 position;\r\n vec3 direction;\r\n float cutoff;\r\n float radius;\r\n};\r\n\r\n#if POINT_LIGHT0\r\nuniform PointLightStruct m_uPointLight0;\r\n#endif\r\n#if POINT_LIGHT1\r\nuniform PointLightStruct m_uPointLight1;\r\n#endif\r\n#if POINT_LIGHT2\r\nuniform PointLightStruct m_uPointLight2;\r\n#endif\r\n\r\n#if DIRECTIONAL_LIGHT0\r\nuniform DirectionalLightStruct m_uDirectionalLight0;\r\n#endif\r\n#if DIRECTIONAL_LIGHT1\r\nuniform DirectionalLightStruct m_uDirectionalLight1;\r\n#endif\r\n#if DIRECTIONAL_LIGHT2\r\nuniform DirectionalLightStruct m_uDirectionalLight2;\r\n#endif\r\n\r\n#if SPOT_LIGHT0\r\nuniform SpotLightStruct m_uSpotLight0;\r\n#endif\r\n#if SPOT_LIGHT1\r\nuniform SpotLightStruct m_uSpotLight1;\r\n#endif\r\n#if SPOT_LIGHT2\r\nuniform SpotLightStruct m_uSpotLight2;\r\n#endif\r\n","main.fs":"#if WEBGL2\r\nin vec3 m_vVertex;\r\nin vec3 m_vNormal;\r\nin vec3 m_vTexCoord;\r\nin vec4 m_vColor;\r\nflat in vec4 m_vId;\r\nin float m_vDepth;\r\nin float m_vColorIndex;\r\n#else \r\n\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\n#include <uniform.inc>\r\n\r\n\r\n\r\n\r\n","main.vs":"#if WEBGL2\r\nlayout (location = 0) in vec3 m_aPosition;\r\n\r\n#if COMPRESSION\r\nlayout (location = 1) in float m_aNormal0;\r\n#else\r\nlayout (location = 1) in vec3 m_aNormal0;\r\n#endif\r\n\r\nlayout (location = 2) in float m_aNormal1;\r\nlayout (location = 3) in float m_aNormal2;\r\nlayout (location = 4) in vec2 m_aTexCoord;\r\nlayout (location = 5) in vec4 m_aColor;\r\nlayout (location = 6) in float m_aMaterial;\r\nlayout (location = 7) in vec3 m_aTangent;\r\nlayout (location = 8) in vec4 m_aJoint0;\r\nlayout (location = 9) in vec4 m_aWeight0;\r\n\r\n#if INSTANCING\r\nlayout (location = 10) in mat4 m_aModelMatrix;\r\n#endif\r\n\r\n\r\n\r\n#else\r\nattribute vec3 m_aPosition;\r\n\r\n#if COMPRESSION\r\nattribute float m_aNormal0;\r\n#else\r\nattribute vec3 m_aNormal0;\r\n#endif\r\n\r\nattribute float m_aNormal1;\r\nattribute float m_aNormal2;\r\nattribute vec2 m_aTexCoord;\r\nattribute vec4 m_aColor;\r\nattribute float m_aMaterial;\r\nattribute vec3 m_aTangent;\r\nattribute vec4 m_aJoint0;\r\nattribute vec4 m_aWeight0;\r\n#if INSTANCING\r\nattribute mat4 m_aModelMatrix;\r\n#endif\r\n\r\n\r\n#endif\r\n\r\n","material_skybox.inc":"#if EQUIRECTANGLE || WALLPAPER\r\nuniform sampler2D m_uSkyTexture;\r\n#else \r\nuniform samplerCube m_uSkyTexture;\r\n#endif \r\n\r\nuniform float m_uTransparency;\r\nuniform float m_uTextureOffset;\r\n\r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness,in vec3 platteColor, in bool usePlate)\r\n{\r\n#if EQUIRECTANGLE \r\n vec2 uv=m_vTexCoord.xy;\r\n uv.x = fract(uv.x+m_uTextureOffset);\r\n diffuse *= sampleTexture2D(m_uSkyTexture, uv).xyz;\r\n#endif\r\n\r\n#if WALLPAPER \r\n diffuse *= sampleTexture2D(m_uSkyTexture, m_vTexCoord.xy).xyz; \r\n#endif\r\n#if CUBEMAP\r\n diffuse *= sampleTexture3D(m_uSkyTexture, normalize(m_vTexCoord.xyz)).xyz; \r\n#endif \r\n\r\n#if GAMMA\r\n diffuse *= sRGBToLinear(diffuse, 2.2); \r\n#endif\r\n transparent = m_uTransparency;\r\n}\r\n","modelo_main.fs":"#include <globalvars.inc>\r\n#include <gamma.inc>\r\n#include <lights.inc>\r\n#include <shadow.inc>\r\n\r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness,in vec3 platteColor,in bool usePlate);\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor); \r\n\r\n#if WEBGL2\r\nlayout(location=0) out vec4 out_color;\r\nlayout(location=1) out vec4 out_color1; \r\n#endif\r\n\r\n#if USE_PLATTE\r\nuniform sampler2D m_uPlatteTexture;\r\n#endif\r\n\r\n#if TONE_MAPPING\r\n\r\n#include <tone_mapping.inc>\r\n\r\n#endif\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n vec3 N = normalize(m_vNormal);\r\n vec3 V = normalize(m_vVertex * m_uPerFrame.cameraPosition.w - m_uPerFrame.cameraPosition.xyz);\r\n vec3 P = m_vVertex;\r\n\r\n#if DOUBLESIDED \r\n N *= (float(gl_FrontFacing)*2.0-1.0);\r\n#endif\r\n\r\n vec3 diffuse = vec3(1.0); \r\n float transparent;\r\n vec3 specular;\r\n float roughness;\r\n vec4 platte = vec4(1.0);\r\n vec3 platteColor = vec3(1.0);\r\n bool usePlate = false;\r\n#if USE_PLATTE\r\n float colorIndex = m_vColorIndex - step(0.499, m_vColorIndex)*0.5;\r\n if (colorIndex < 0.495)\r\n {\r\n vec4 platte = sampleTexture2D(m_uPlatteTexture, vec2(colorIndex, 0));\r\n platteColor = platte.xyz;\r\n transparent = platte.w;\r\n usePlate = true;\r\n }\r\n#endif\r\n parseMaterial(diffuse, specular, transparent, roughness ,platteColor, usePlate);\r\n\r\n#if !WEBGL2\r\n vec4 out_color1;\r\n#endif\r\n vec3 color = shade(diffuse, specular, roughness, transparent, P, N, V, out_color1); \r\n\r\n#if TONE_MAPPING\r\n color.rgb = toneMapping(color.rgb);\r\n#endif\r\n\r\n#if DRAW_POINT\r\n float dist = distance(gl_PointCoord,vec2(0.5,0.5));\r\n if(dist > 0.5){\r\n discard;\r\n }\r\n#endif\r\n\r\n#if GAMMA\r\n color = linearTosRGB(color, 2.2);\r\n#endif\r\n\r\n#if WEBGL2\r\n out_color = vec4(color, transparent);\r\n#else\r\n gl_FragColor = vec4(color, transparent); \r\n#endif\r\n \r\n}\r\n","modelo_main.vs":"#if WEBGL2\r\nout vec3 m_vVertex;\r\nout vec3 m_vNormal;\r\nout vec3 m_vTexCoord;\r\nout vec4 m_vColor;\r\nflat out vec4 m_vId;\r\nout float m_vDepth;\r\nout float m_vColorIndex;\r\n#else\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition);\r\n\r\nvoid main()\r\n{\r\n vec4 position = vec4(m_aPosition, 1.0);\r\n#if COMPRESSION\r\nvec4 normal = vec4(m_aNormal0, m_aNormal1, m_aNormal2, 0.0);\r\n#else\r\nvec4 normal = vec4(m_aNormal0, 0.0);\r\n#endif\r\n vec3 uv = vec3(m_aTexCoord, 1.0);\r\n\r\n vec4 worldPosition;\r\n\r\n transform(position, normal, uv, worldPosition);\r\n\r\n#if VISIBILITY\r\n position.z -= step(0.5, m_aMaterial) * position.w * 10000.0;\r\n#endif\r\n\r\n#if USE_PLATTE\r\n m_vColorIndex = m_aMaterial; \r\n#endif\r\n\r\n#include <varying.inc>\r\n\r\n gl_Position = position;\r\n\r\n gl_PointSize = 10.0;\r\n}\r\n\r\n","normaldepth_main.fs":"#include <globalvars.inc>\r\n\r\n#if WEBGL2\r\n out vec4 out_color;\r\n#endif\r\n\r\n#if ALPHATEST\r\n uniform sampler2D m_uDiffuseTexture;\r\n#endif\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n#if ALPHATEST\r\n vec4 texel = sampleTexture2D(m_uDiffuseTexture, m_vTexCoord.xy);\r\n if (texel.a < 0.15)\r\n {\r\n discard;\r\n }\r\n#endif\r\n\r\n vec4 normal = vec4(m_vNormal, 0.0);\r\n\r\n#if !WORLDSPACE_NORMAL\r\n normal = m_uPerFrame.viewMatrix * normal;\r\n#endif\r\n\r\n#if DOUBLESIDED\r\n \r\n#if WORLDSPACE_NORMAL\r\n vec4 eyeNormal = m_uPerFrame.viewMatrix * normal;\r\n#else\r\n vec4 eyeNormal = normal;\r\n#endif\r\n\r\n vec4 eyeDir = m_uPerFrame.viewMatrix * vec4(m_vVertex, 1.0);\r\n normal *= -sign(dot(eyeNormal.xyz, eyeDir.xyz));\r\n\r\n#endif\r\n \r\n vec3 n = normalize(normal.xyz);\r\n\r\n#if ENCODE_NORMAL\r\n n = (n + vec3(1.0)) * 0.5;\r\n#endif\r\n\r\n#if WEBGL2\r\n out_color = vec4(n, m_vDepth); \r\n#else\r\n gl_FragColor = vec4(n, m_vDepth);\r\n#endif\r\n \r\n}\r\n","shade_plain.inc":"vec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n return diffuse;\r\n}\r\n","shadow.inc":"#if SHADOW\r\nuniform sampler2D m_uShadowTexture0;\r\nuniform float m_uShadowContrast;\r\n#if MOBILE\r\n\r\nfloat shadow(vec3 P, vec3 N, vec3 L)\r\n{\r\n mat4 matrix = m_uSunLight.shadowMatrix0;\r\n \r\n float backside = min(1.0, max(0.0, dot(N, -L) * 10.0));\r\n vec4 v = matrix * vec4(P, 1);\r\n vec3 t = (v.xyz / v.w + vec3(1.0)) * 0.5;\r\n\r\n vec2 coord = t.xy;\r\n float fz = sampleTexture2D(m_uShadowTexture0, coord).x;\r\n float fd = exp(85.0 * (fz - t.z));\r\n float lit = min(fd, 1.0) * backside; return lit * 0.2 + 0.8; }\r\n\r\n#else\r\n\r\nuniform float m_uShadowFine;\r\nuniform float m_uShadowSize;\r\n\r\nfloat bilinear(vec2 frac2, vec4 v)\r\n{\r\n vec2 cc = mix(v.xz, v.yw, frac2.x);\r\n return mix(cc.x, cc.y, frac2.y);\r\n}\r\n\r\nfloat pcf2x(float depth, vec2 coord, in float shadowMapSize, in sampler2D shadowTexture, in float isFineShadow)\r\n{\r\n coord = coord * shadowMapSize;\r\n vec2 p = floor(coord - vec2(0.5)) + vec2(0.5);\r\n vec2 f = coord - p;\r\n vec2 p0 = p / shadowMapSize;\r\n float pixel = 1.0 / shadowMapSize;\r\n \r\n vec4 c;\r\n c.x = sampleTexture2D(shadowTexture, p0).x;\r\n c.y = sampleTexture2D(shadowTexture, p0 + vec2(pixel, 0)).x;\r\n c.z = sampleTexture2D(shadowTexture, p0 + vec2(0, pixel)).x;\r\n c.w = sampleTexture2D(shadowTexture, p0 + vec2(pixel, pixel)).x;\r\n \r\n if (isFineShadow > 0.5) {\r\n c = exp(300.0 * c + vec4(-300.0 * depth));\r\n return bilinear(f, c);\r\n } \r\n \r\n float z = bilinear(f, c);\r\n return z * exp(-85.0 * depth);\r\n}\r\n\r\nfloat shadow1(vec3 P, vec3 N, vec3 L, sampler2D shadowTexture, mat4 shadowMatrix)\r\n{\r\n vec4 v = shadowMatrix * vec4(P, 1);\r\n vec3 t = (v.xyz / v.w + vec3(1.0)) * 0.5;\r\n float fd = pcf2x(t.z, t.xy, m_uShadowSize, shadowTexture, m_uShadowFine);\r\n \r\n float backside = min(1.0, max(0.0, dot(N, -L) * 10.0));\r\n float lit = min(fd, 1.0) * backside; return lit * 0.6 * m_uShadowContrast + 0.6 * (1.0 - m_uShadowContrast) + 0.4; }\r\n\r\n\r\nfloat shadow(vec3 P, vec3 N, vec3 L)\r\n{\r\n return shadow1(P, N, L, m_uShadowTexture0, m_uSunLight.shadowMatrix0);\r\n}\r\n\r\n#endif\r\n\r\n#endif\r\n","tone_mapping.inc":"uniform float uExposure;\r\n\r\nfloat getLuminance(vec3 c)\r\n{\r\n return dot(c, vec3(0.22, 0.707, 0.071));\r\n}\r\n\r\nvec3 toneMapping(vec3 color) \r\n{\r\n float lum = getLuminance(color);\r\n float lumTm = lum * uExposure;\r\n float scale = lumTm / (1.0 + lumTm);\r\n\r\n return color * scale / lum;\r\n}\r\n","transform_simple.inc":"#if POP_BUFFER\r\nstruct PopParams {\r\n vec3 vertexConstant;\r\n float vertexGridSize;\r\n float powPrecision;\r\n};\r\nuniform PopParams m_uPopParams;\r\n#endif\r\n\r\n#if HAS_SKIN\r\n#if WEBGL2\r\nuniform m_bJointMatrix\r\n{\r\n mat4 matrix[128];\r\n} m_uJointMatrix;\r\n#else\r\nuniform sampler2D m_uTransformTexture;\r\n\r\nmat4 transpose(in mat4 inMatrix) {\r\n highp vec4 i0 = inMatrix[0];\r\n highp vec4 i1 = inMatrix[1];\r\n highp vec4 i2 = inMatrix[2];\r\n highp vec4 i3 = inMatrix[3];\r\n\r\n highp mat4 outMatrix = mat4(\r\n vec4(i0.x, i1.x, i2.x, i3.x),\r\n vec4(i0.y, i1.y, i2.y, i3.y),\r\n vec4(i0.z, i1.z, i2.z, i3.z),\r\n vec4(i0.w, i1.w, i2.w, i3.w)\r\n );\r\n\r\n return outMatrix;\r\n}\r\n\r\nmat4 inverse(mat4 m) {\r\n float\r\n a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\r\n a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\r\n a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\r\n a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\r\n\r\n b00 = a00 * a11 - a01 * a10,\r\n b01 = a00 * a12 - a02 * a10,\r\n b02 = a00 * a13 - a03 * a10,\r\n b03 = a01 * a12 - a02 * a11,\r\n b04 = a01 * a13 - a03 * a11,\r\n b05 = a02 * a13 - a03 * a12,\r\n b06 = a20 * a31 - a21 * a30,\r\n b07 = a20 * a32 - a22 * a30,\r\n b08 = a20 * a33 - a23 * a30,\r\n b09 = a21 * a32 - a22 * a31,\r\n b10 = a21 * a33 - a23 * a31,\r\n b11 = a22 * a33 - a23 * a32,\r\n\r\n det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n return mat4(\r\n a11 * b11 - a12 * b10 + a13 * b09,\r\n a02 * b10 - a01 * b11 - a03 * b09,\r\n a31 * b05 - a32 * b04 + a33 * b03,\r\n a22 * b04 - a21 * b05 - a23 * b03,\r\n a12 * b08 - a10 * b11 - a13 * b07,\r\n a00 * b11 - a02 * b08 + a03 * b07,\r\n a32 * b02 - a30 * b05 - a33 * b01,\r\n a20 * b05 - a22 * b02 + a23 * b01,\r\n a10 * b10 - a11 * b08 + a13 * b06,\r\n a01 * b08 - a00 * b10 - a03 * b06,\r\n a30 * b04 - a31 * b02 + a33 * b00,\r\n a21 * b02 - a20 * b04 - a23 * b00,\r\n a11 * b07 - a10 * b09 - a12 * b06,\r\n a00 * b09 - a01 * b07 + a02 * b06,\r\n a31 * b01 - a30 * b03 - a32 * b00,\r\n a20 * b03 - a21 * b01 + a22 * b00) / det;\r\n}\r\n#endif\r\n#endif\r\n\r\n#if HAS_SKIN\r\nmat4 getJointMatrix(in vec4 indices) {\r\n#if WEBGL2\r\n return m_aWeight0.x * m_uJointMatrix.matrix[int(indices.x)] +\r\n m_aWeight0.y * m_uJointMatrix.matrix[int(indices.y)] +\r\n m_aWeight0.z * m_uJointMatrix.matrix[int(indices.z)] +\r\n m_aWeight0.w * m_uJointMatrix.matrix[int(indices.w)];\r\n#else\r\n vec4 col1, col2, col3, col4;\r\n col1 = texture2DLod(m_uTransformTexture, vec2((indices.x * 4.0 ) / 511.0, 0.0), 0.0);\r\n col2 = texture2DLod(m_uTransformTexture, vec2((indices.x * 4.0 + 1.0) / 511.0, 0.0), 0.0);\r\n col3 = texture2DLod(m_uTransformTexture, vec2((indices.x * 4.0 + 2.0) / 511.0, 0.0), 0.0);\r\n col4 = texture2DLod(m_uTransformTexture, vec2((indices.x * 4.0 + 3.0) / 511.0, 0.0), 0.0);\r\n mat4 matrix1 = mat4(col1, col2, col3, col4); \r\n col1 = texture2DLod(m_uTransformTexture, vec2((indices.y * 4.0 ) / 511.0, 0.0), 0.0);\r\n col2 = texture2DLod(m_uTransformTexture, vec2((indices.y * 4.0 + 1.0) / 511.0, 0.0), 0.0);\r\n col3 = texture2DLod(m_uTransformTexture, vec2((indices.y * 4.0 + 2.0) / 511.0, 0.0), 0.0);\r\n col4 = texture2DLod(m_uTransformTexture, vec2((indices.y * 4.0 + 3.0) / 511.0, 0.0), 0.0);\r\n mat4 matrix2 = mat4(col1, col2, col3, col4);\r\n col1 = texture2DLod(m_uTransformTexture, vec2((indices.z * 4.0 ) / 511.0, 0.0), 0.0);\r\n col2 = texture2DLod(m_uTransformTexture, vec2((indices.z * 4.0 + 1.0) / 511.0, 0.0), 0.0);\r\n col3 = texture2DLod(m_uTransformTexture, vec2((indices.z * 4.0 + 2.0) / 511.0, 0.0), 0.0);\r\n col4 = texture2DLod(m_uTransformTexture, vec2((indices.z * 4.0 + 3.0) / 511.0, 0.0), 0.0);\r\n mat4 matrix3 = mat4(col1, col2, col3, col4);\r\n col1 = texture2DLod(m_uTransformTexture, vec2((indices.w * 4.0 ) / 511.0, 0.0), 0.0);\r\n col2 = texture2DLod(m_uTransformTexture, vec2((indices.w * 4.0 + 1.0) / 511.0, 0.0), 0.0);\r\n col3 = texture2DLod(m_uTransformTexture, vec2((indices.w * 4.0 + 2.0) / 511.0, 0.0), 0.0);\r\n col4 = texture2DLod(m_uTransformTexture, vec2((indices.w * 4.0 + 3.0) / 511.0, 0.0), 0.0);\r\n mat4 matrix4 = mat4(col1, col2, col3, col4);\r\n return m_aWeight0.x * matrix1 + \r\n m_aWeight0.y * matrix2 + \r\n m_aWeight0.z * matrix3 + \r\n m_aWeight0.w * matrix4;\r\n#endif\r\n}\r\n#endif\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if POP_BUFFER\r\n position.xyz = (position.xyz - m_uPopParams.vertexConstant) / m_uPopParams.vertexGridSize;\r\n position.xyz = floor(position.xyz / m_uPopParams.powPrecision) * m_uPopParams.powPrecision * m_uPopParams.vertexGridSize;\r\n#endif\r\n\r\n#if HAS_SKIN\r\n mat4 jointMatrix = getJointMatrix(m_aJoint0);\r\n#endif\r\n\r\n#if MODEL_TRANSFORM\r\n#if INSTANCING\r\n position = m_aModelMatrix * position;\r\n normal = (m_aModelMatrix * normal);\r\n#else\r\n\r\n#if HAS_SKIN\r\n normal = m_uPerNode.normalMatrix * vec4(normalize(transpose(inverse(jointMatrix)) * normal).xyz, 0.0);\r\n position = m_uPerNode.modelMatrix * jointMatrix * position;\r\n#else\r\n position = m_uPerNode.modelMatrix * position;\r\n normal = m_uPerNode.normalMatrix * vec4(normalize(normal.xyz), 0.0);\r\n#endif\r\n#endif\r\n#endif\r\n\r\n worldPosition = position;\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_skybox.inc":"\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if EQUIRECTANGLE\r\n uv = vec3(1.0 - uv.x, uv.y, 1.0);\r\n#endif\r\n#if WALLPAPER\r\n uv = vec3(uv.x, 1.0 - uv.y, 1.0);\r\n#endif\r\n#if CUBEMAP\r\n#if FLIP\r\n uv = vec3(position.x, -position.z, -position.y);\r\n#else\r\n uv = vec3(position.x, position.z, -position.y);\r\n#endif\r\n#endif\r\n\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n#endif\r\n#if EQUIRECTANGLE || CUBEMAP\r\n position = m_uPerFrame.vpMatrix * vec4(position.xyz, 0.0);\r\n#endif\r\n\r\n position = position.xyww; \r\n}\r\n\r\n\r\n","uniform.inc":"#if WEBGL2\r\nvec4 sampleTexture2D(sampler2D tex, vec2 coord)\r\n{\r\n return texture(tex, coord);\r\n}\r\n\r\nvec4 sampleTexture2D(samplerCube tex, vec3 coord, float LOD) \r\n{\r\n return textureLod(tex, coord, LOD);\r\n}\r\n#else\r\nvec4 sampleTexture2D(sampler2D tex, vec2 coord)\r\n{\r\n return texture2D(tex, coord);\r\n}\r\n\r\nvec4 sampleTexture2D(samplerCube tex, vec3 coord, float LOD) \r\n{\r\n return textureCube(tex, coord);\r\n}\r\n#endif\r\n\r\n#if WEBGL2\r\nvec4 sampleTexture3D(samplerCube tex, vec3 coord)\r\n{\r\n return texture(tex, coord);\r\n}\r\n\r\nvec4 sampleTexture3D(samplerCube tex, vec3 coord, float LOD) \r\n{\r\n return textureLod(tex, coord, LOD);\r\n}\r\n\r\n#else\r\nvec4 sampleTexture3D(samplerCube tex, vec3 coord)\r\n{\r\n return textureCube(tex, coord);\r\n}\r\n\r\nvec4 sampleTexture3D(samplerCube tex, vec3 coord, float LOD) \r\n{\r\n return textureCube(tex, coord);\r\n}\r\n#endif\r\n\r\n","blit_contour.inc":"vec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{ \r\n vec2 coordCenter = uv + vec2( 0.0, 0.0); \r\n vec2 coordUp = uv + vec2( 0.0, -invResolution.y); \r\n vec2 coordDown = uv + vec2( 0.0, +invResolution.y); \r\n vec2 coordLeft = uv + vec2(-invResolution.x, 0.0); \r\n vec2 coordRight = uv + vec2(+invResolution.x, 0.0); \r\n vec2 coordUpLeft = uv + vec2(-invResolution.x, -invResolution.y); \r\n vec2 coordDownLeft = uv + vec2(-invResolution.x, +invResolution.y); \r\n vec2 coordUpRight = uv + vec2(-invResolution.x, +invResolution.y); \r\n vec2 coordDownRight = uv + vec2(+invResolution.x, +invResolution.y); \r\n\r\n bool centerOutsideOfTarget = sampleTexture2D(tex, coordCenter ).r < 1.0;\r\n bool neighborInsideOfTarget = sampleTexture2D(tex, coordUp ).r > 0.5\r\n || sampleTexture2D(tex, coordDown ).r > 0.5 \r\n || sampleTexture2D(tex, coordLeft ).r > 0.5 \r\n || sampleTexture2D(tex, coordRight ).r > 0.5 \r\n || sampleTexture2D(tex, coordUpLeft ).r > 0.5 \r\n || sampleTexture2D(tex, coordDownLeft ).r > 0.5 \r\n || sampleTexture2D(tex, coordUpRight ).r > 0.5 \r\n || sampleTexture2D(tex, coordDownRight).r > 0.5;\r\n bool isContour = centerOutsideOfTarget && neighborInsideOfTarget;\r\n\r\n return isContour? vec4(0.0, 0.0, 0.0, 1.0) : vec4(0.0, 0.0, 0.0, 0.0);\r\n} \r\n","blit_contour_overlay.inc":"uniform vec4 uColor;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 scene = sampleTexture2D(tex, uv);\r\n vec2 coord00 = uv + vec2(-invResolution.x * 2.0, -invResolution.y * 2.0);\r\n vec2 coord01 = uv + vec2(-invResolution.x * 2.0, -invResolution.y);\r\n vec2 coord02 = uv + vec2(-invResolution.x * 2.0, 0.0);\r\n vec2 coord03 = uv + vec2(-invResolution.x * 2.0, invResolution.y);\r\n vec2 coord04 = uv + vec2(-invResolution.x * 2.0, invResolution.y * 2.0);\r\n\r\n vec2 coord10 = uv + vec2(-invResolution.x, -invResolution.y * 2.0);\r\n vec2 coord11 = uv + vec2(-invResolution.x, -invResolution.y);\r\n vec2 coord12 = uv + vec2(-invResolution.x, 0.0);\r\n vec2 coord13 = uv + vec2(-invResolution.x, invResolution.y);\r\n vec2 coord14 = uv + vec2(-invResolution.x, invResolution.y * 2.0);\r\n\r\n vec2 coord20 = uv + vec2(0.0, -invResolution.y * 2.0);\r\n vec2 coord21 = uv + vec2(0.0, -invResolution.y);\r\n vec2 coord22 = uv + vec2(0.0, 0.0);\r\n vec2 coord23 = uv + vec2(0.0, invResolution.y);\r\n vec2 coord24 = uv + vec2(0.0, invResolution.y * 2.0);\r\n vec2 coord30 = uv + vec2(invResolution.x, -invResolution.y * 2.0);\r\n vec2 coord31 = uv + vec2(invResolution.x, -invResolution.y);\r\n vec2 coord32 = uv + vec2(invResolution.x, 0.0);\r\n vec2 coord33 = uv + vec2(invResolution.x, invResolution.y);\r\n vec2 coord34 = uv + vec2(invResolution.x, invResolution.y * 2.0);\r\n vec2 coord40 = uv + vec2(invResolution.x * 2.0, -invResolution.y * 2.0);\r\n vec2 coord41 = uv + vec2(invResolution.x * 2.0, -invResolution.y);\r\n vec2 coord42 = uv + vec2(invResolution.x * 2.0, 0.0);\r\n vec2 coord43 = uv + vec2(invResolution.x * 2.0, invResolution.y);\r\n vec2 coord44 = uv + vec2(invResolution.x * 2.0, invResolution.y * 2.0);\r\n\r\n vec4 contour = sampleTexture2D(tex, coord00) * 0.0090 +\r\n sampleTexture2D(tex, coord01) * 0.0399 +\r\n sampleTexture2D(tex, coord02) * 0.0657 +\r\n sampleTexture2D(tex, coord03) * 0.0399 +\r\n sampleTexture2D(tex, coord04) * 0.0090 +\r\n sampleTexture2D(tex, coord10) * 0.0399 +\r\n sampleTexture2D(tex, coord11) * 0.1788 +\r\n sampleTexture2D(tex, coord12) * 0.2949 +\r\n sampleTexture2D(tex, coord13) * 0.1788 +\r\n sampleTexture2D(tex, coord14) * 0.0399 +\r\n sampleTexture2D(tex, coord20) * 0.0657 +\r\n sampleTexture2D(tex, coord21) * 0.2949 +\r\n sampleTexture2D(tex, coord22) * 0.4863 +\r\n sampleTexture2D(tex, coord23) * 0.2949 +\r\n sampleTexture2D(tex, coord24) * 0.0657 +\r\n sampleTexture2D(tex, coord30) * 0.0399 +\r\n sampleTexture2D(tex, coord31) * 0.1788 +\r\n sampleTexture2D(tex, coord32) * 0.2949 +\r\n sampleTexture2D(tex, coord33) * 0.1788 +\r\n sampleTexture2D(tex, coord34) * 0.0399 +\r\n sampleTexture2D(tex, coord40) * 0.0090 +\r\n sampleTexture2D(tex, coord41) * 0.0399 +\r\n sampleTexture2D(tex, coord42) * 0.0657 +\r\n sampleTexture2D(tex, coord43) * 0.0399 +\r\n sampleTexture2D(tex, coord44) * 0.0090;\r\n float a = min(1.0, contour.a);\r\n return uColor * a + scene * (1.0 - a);\r\n} \r\n\r\n","blit_direct.fs":"uniform vec3 uColor;\r\n\r\n#if WEBGL2\r\nout vec4 out_color;\r\n#endif\r\n\r\nvoid main() \r\n{ \r\n#if WEBGL2\r\n out_color = vec4(uColor, 1);\r\n#else\r\n gl_FragColor = vec4(uColor, 1);\r\n#endif\r\n}\r\n","blit_oit.inc":"uniform sampler2D uTexture1;\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 rgbAlphaAdd = sampleTexture2D(m_uBlitTexture, uv);\r\n \r\n float alphaMulti = sampleTexture2D(uTexture1, uv).r; \r\n\r\n vec4 ret = vec4(rgbAlphaAdd.rgb / clamp(alphaMulti, 1e-4, 5e4), rgbAlphaAdd.a);\r\n\r\n return ret;\r\n}\r\n","blit_outline.inc":"uniform float u_outlineWidth;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{ \r\n bool centerInsideOfTarget = sampleTexture2D(tex, uv).r > 0.5;\r\n if(centerInsideOfTarget) return vec4(0.0);\r\n\r\n float w2 = u_outlineWidth*u_outlineWidth;\r\n for(float i=-8.0; i<=8.0; i+=1.0)\r\n {\r\n if(i<-u_outlineWidth || i>u_outlineWidth) continue;\r\n\r\n float i2 = i*i;\r\n for(float j=-8.0; j<8.0; j+=1.0)\r\n {\r\n float j2 = j*j;\r\n if(i2+j2>w2) continue;\r\n\r\n vec2 coordIJ = uv + vec2(i, j)*invResolution;\r\n bool neighborInsideOfTarget = sampleTexture2D(tex, coordIJ).r>0.5;\r\n if(neighborInsideOfTarget) return vec4(vec3(0.0), 1.0);\r\n }\r\n }\r\n\r\n return vec4(0.0);\r\n} \r\n","blit_outline_overlay.inc":"uniform vec4 uColor;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 scene = sampleTexture2D(tex, uv);\r\n float a = scene.a;\r\n return uColor * a + scene * (1.0 - a);\r\n} \r\n","blit_overlay.inc":"uniform sampler2D m_uForeground;\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n vec4 ret = sampleTexture2D(m_uForeground, uv);\r\n return ret;\r\n}\r\n","blit_shadow.inc":"const float g0 = 0.0751; const float g1 = 0.1238; const float g2 = 0.0751; \r\nconst float g3 = 0.1238; const float g4 = 0.2042; const float g5 = 0.1238; \r\nconst float g6 = 0.0751; const float g7 = 0.1238; const float g8 = 0.0751; \r\nconst float C = 85.0;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{ \r\n float tmp = 0.0;\r\n vec2 coord; \r\n\r\n float pixelSize = invResolution.x;\r\n\r\n coord = uv + vec2(-pixelSize, -pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g0;\r\n\r\n coord = uv + vec2(0.0, -pixelSize); \r\n \r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g1;\r\n \r\n coord = uv + vec2(pixelSize, -pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g2;\r\n\r\n coord = uv + vec2(-pixelSize, 0.0); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g3; \r\n\r\n coord = uv; \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g4;\r\n \r\n coord = uv + vec2(pixelSize, 0.0 ); \r\n \r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g5;\r\n\r\n coord = uv + vec2(-pixelSize, pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g6;\r\n \r\n coord = uv + vec2(0.0, pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g7;\r\n \r\n coord = uv + vec2(pixelSize, pixelSize); \r\n\r\n tmp += exp(C * sampleTexture2D(tex, coord).x) * g8;\r\n\r\n return vec4(tmp); \r\n} \r\n\r\n","blit_sketch.inc":"uniform float uThreshold; \r\nuniform float uContrast; \r\nuniform vec3 uNearAxis; \r\nuniform bool uIsPerspective; \r\n\r\n#if MOBILE\r\nuniform vec2 uNearFar;\r\n\r\nvoid getNormalPosition(in sampler2D tex, in sampler2D tex2, vec2 coord, out vec3 position, out vec3 normal) \r\n{\r\n vec2 uv = coord * 0.5 + vec2(0.5); \r\n vec4 n = sampleTexture2D(tex, uv); \r\n\r\n normal = normalize(n.xyz * 2.0 - 1.0); \r\n vec4 p = sampleTexture2D(tex2, uv);\r\n float depth = p.x * 2.0 -1.0;\r\n \r\n if (uIsPerspective) \r\n {\r\n position.z = -2.0 * uNearFar.x * uNearFar.y / (uNearFar.x + uNearFar.y - depth * (uNearFar.y - uNearFar.x));\r\n position.xy = uNearAxis.xy * coord.xy * position.z / uNearAxis.z; \r\n } \r\n else \r\n {\r\n position.xy = uNearAxis.xy * coord.xy;\r\n position.z = 0.5 * (depth * (uNearFar.y - uNearFar.x) + uNearFar.x + uNearFar.y);\r\n }\r\n} \r\n#else\r\nvoid getNormalPosition(in sampler2D tex, vec2 coord, out vec3 position, out vec3 normal) \r\n{\r\n vec2 uv = coord * 0.5 + vec2(0.5); \r\n vec4 p = sampleTexture2D(tex, uv); \r\n\r\n normal = normalize(p.xyz); \r\n position.z = p.w; \r\n if (uIsPerspective) \r\n { \r\n position.xy = uNearAxis.xy * coord.xy * p.w / uNearAxis.z; \r\n } \r\n else \r\n {\r\n position.xy = uNearAxis.xy * coord.xy;\r\n }\r\n}\r\n#endif\r\n\r\nfloat planeDistance(vec3 posA, vec3 norA, vec3 posB, vec3 norB) \r\n{ \r\n vec3 posDelta = normalize(posB - posA); \r\n float planeDist = max(abs(dot(posDelta, norA)), abs(dot(posDelta, norB))); \r\n float normalDist = max(1.0 - dot(norA, norB), 0.0); \r\n \r\n return max(planeDist, normalDist);\r\n} \r\n\r\nuniform vec3 uColor;\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else \r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n vec2 vFragCoord = uv * 2.0 - vec2(1.0);\r\n vec2 coordCenter = vFragCoord.xy ; \r\n vec2 coordUp = vFragCoord - vec2(0.0, 2.0 * invResolution.y); \r\n vec2 coordDown = vFragCoord + vec2(0.0, 2.0 * invResolution.y); \r\n vec2 coordLeft = vFragCoord - vec2(2.0 * invResolution.x, 0.0); \r\n vec2 coordRight = vFragCoord + vec2(2.0 * invResolution.x, 0.0); \r\n vec3 posUp, norUp; \r\n vec3 posDown, norDown; \r\n vec3 posLeft, norLeft; \r\n vec3 posRight, norRight; \r\n#if MOBILE\r\n getNormalPosition(tex, tex2, coordUp, posUp, norUp); \r\n getNormalPosition(tex, tex2, coordDown, posDown, norDown); \r\n getNormalPosition(tex, tex2, coordLeft, posLeft, norLeft); \r\n getNormalPosition(tex, tex2, coordRight, posRight, norRight); \r\n#else \r\n getNormalPosition(tex, coordUp, posUp, norUp); \r\n getNormalPosition(tex, coordDown, posDown, norDown); \r\n getNormalPosition(tex, coordLeft, posLeft, norLeft); \r\n getNormalPosition(tex, coordRight, posRight, norRight);\r\n#endif\r\n vec2 planeDist = vec2(planeDistance(posLeft, norLeft, posRight, norRight), \r\n planeDistance(posUp, norUp, posDown, norDown)); \r\n float edge = length(planeDist); \r\n float sketch = step(edge, uThreshold); \r\n sketch = clamp(uContrast * (1.0 - sketch), 0.0, 1.0); \r\n \r\n return vec4(uColor, sketch);\r\n}\r\n","blit_solid.inc":"uniform vec3 uColor;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n return vec4(uColor, 1);\r\n}\r\n","blit_ssao2.inc":"uniform vec3 uNearAxis; \r\nuniform vec2 uTexTransform; \r\nuniform float uRadius; \r\nuniform bool uIsPerspective; \r\nuniform float uFrameCount; \r\nuniform vec4 uTexSizeAndInv; \r\nuniform vec2 SAMPLES[8]; \r\n\r\n#if MOBILE\r\nuniform vec2 uNearFar;\r\n\r\nvec4 getNormalAndDepth(in sampler2D tex, in sampler2D tex2, vec2 fragCoord) \r\n{\r\n vec2 texcoord = fragCoord * 0.5 + vec2(0.5);\r\n texcoord.x = texcoord.x * uTexTransform.x + uTexTransform.y;\r\n \r\n vec4 ret = sampleTexture2D(tex, texcoord); \r\n ret.xyz = normalize(ret.xyz * 2.0 - 1.0); \r\n \r\n vec4 p = sampleTexture2D(tex2, texcoord);\r\n float depth = p.x * 2.0 -1.0;\r\n if (uIsPerspective) \r\n {\r\n ret.w = -2.0 * uNearFar.x * uNearFar.y / (uNearFar.x + uNearFar.y - depth * (uNearFar.y - uNearFar.x));\r\n } \r\n else \r\n {\r\n ret.w = 0.5 * (depth * (uNearFar.y - uNearFar.x) + uNearFar.x + uNearFar.y);\r\n }\r\n return ret;\r\n} \r\n#else\r\nvec4 getNormalAndDepth(in sampler2D tex, vec2 fragCoord) \r\n{\r\n vec2 texcoord = fragCoord * 0.5 + vec2(0.5);\r\n texcoord.x = texcoord.x * uTexTransform.x + uTexTransform.y;\r\n \r\n return sampleTexture2D(tex, texcoord); \r\n} \r\n#endif\r\n\r\n\r\nvec3 getEyePosition(vec2 fragCoord, float depth) \r\n{\r\n vec3 eyeDirection = uNearAxis * vec3(fragCoord, 1.0); \r\n vec3 eyePosition; \r\n eyePosition.z = depth; \r\n if (uIsPerspective) \r\n { \r\n eyePosition.xy = eyeDirection.xy * depth / eyeDirection.z; \r\n } \r\n else \r\n {\r\n eyePosition.xy = eyeDirection.xy; \r\n } \r\n return eyePosition; \r\n} \r\n\r\nvec3 getScreenPosition(vec3 eyePos) \r\n{ \r\n if (uIsPerspective)\r\n {\r\n return vec3(eyePos.xy * uNearAxis.z / uNearAxis.xy / eyePos.z, eyePos.z); \r\n }\r\n else\r\n {\r\n return vec3(eyePos.xy / uNearAxis.xy, eyePos.z); \r\n }\r\n} \r\n\r\n#if MOBILE\r\nvec3 getOffsetEyePosition(in sampler2D tex, in sampler2D tex2, vec3 viewPos, vec2 offset) \r\n#else\r\nvec3 getOffsetEyePosition(in sampler2D tex, vec3 viewPos, vec2 offset) \r\n#endif\r\n{ \r\n vec2 scnPos = getScreenPosition(viewPos).xy; \r\n vec2 scnOffset = getScreenPosition(vec3(offset, viewPos.z)).xy; \r\n vec2 pixOffset = scnOffset * uTexSizeAndInv.xy * 0.5;\r\n if(length(pixOffset) > 2.0) \r\n {\r\n scnOffset = (floor(pixOffset + 0.5) ) * uTexSizeAndInv.zw * 2.0;\r\n }\r\n#if MOBILE\r\nfloat sampDepth = getNormalAndDepth(tex, tex2, scnPos + scnOffset).w; \r\n#else\r\nfloat sampDepth = getNormalAndDepth(tex, scnPos + scnOffset).w; \r\n#endif\r\n return getEyePosition(scnPos + scnOffset, sampDepth); \r\n} \r\n\r\nvec3 computeMultiBounceColor(float x, vec3 albedo) \r\n{ \r\n vec3 a = 2.0404 * albedo - 0.3324; \r\n vec3 b = -4.7951 * albedo + 0.6417; \r\n vec3 c = 2.7552 * albedo + 0.6903; \r\n return max( vec3(x,x,x), ( ( x * a + b ) * x + c ) * x ); \r\n} \r\n\r\nfloat random(vec2 p) \r\n{ \r\n return fract(sin(dot(p.xy, vec2(12.9898, 78.233))) * (43758.5453 + (uFrameCount) * 1231.3));\r\n} \r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else \r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{ \r\n float maxScreenRadius = 0.4; float falloffDist = 0.0; float randScale = 0.4; const float aoStrength = 1.1; const float PI = 3.1415926535898; \r\n const float HalfPI = 1.570796326794895; \r\n\r\n vec2 vFragCoord = uv * 2.0 - vec2(1.0);\r\n#if MOBILE\r\n vec4 p = getNormalAndDepth(tex, tex2, vFragCoord); \r\n#else\r\n vec4 p = getNormalAndDepth(tex, vFragCoord); \r\n#endif\r\n vec3 eyePosition = getEyePosition(vFragCoord, p.w); \r\n vec3 normal = p.xyz; \r\n float xx = p.w;\r\n if (length(normal) < 0.95) {\r\n return vec4(1.0);\r\n }\r\n\r\n vec2 projScrRadius = getEyePosition(vec2(1.0, 1.0) * maxScreenRadius, p.w).xy; \r\n vec3 viewDir = vec3(0.0, 0.0, 1.0);\r\n\r\n float radiusScale = 1.0 + randScale * (random(vFragCoord * 0.5 - 0.5) - 0.5); \r\n float radius = radiusScale * min(uRadius, min(projScrRadius.x, projScrRadius.y)); \r\n\r\n if (uIsPerspective) {\r\n viewDir = normalize(-uNearAxis * vec3(vFragCoord, 1.0)); \r\n } \r\n\r\n vec3 sliceTan = normalize(vec3(SAMPLES[7], 0.0));\r\n vec3 sliceNorm = normalize(cross(viewDir, sliceTan)); \r\n vec3 normalSliceProj = normal - dot(normal, sliceNorm) * sliceNorm; \r\n vec3 normalSliceDir = normalize(normalSliceProj); \r\n float thetaN = acos(dot(normalSliceDir, viewDir)) * sign(dot(cross(sliceNorm, viewDir), normalSliceDir)); \r\n\r\n float horizon1 = thetaN + HalfPI;\r\n for (int i = 0; i < 8; ++i) \r\n { \r\n vec2 p = SAMPLES[i];\r\n#if MOBILE\r\nvec3 offsetPosition = getOffsetEyePosition(tex, tex2, eyePosition, p * radius); \r\n#else\r\nvec3 offsetPosition = getOffsetEyePosition(tex, eyePosition, p * radius); \r\n#endif\r\n vec3 v_i = offsetPosition - eyePosition; \r\n float h1 = min(acos(dot(normalize(v_i), viewDir)), HalfPI + thetaN); \r\n float weight = 1.0 - clamp((length(v_i) / radius - falloffDist), 0.0, 1.0); \r\n horizon1 = mix(horizon1, min(horizon1, h1), weight); \r\n } \r\n\r\n float horizon2 = -thetaN + HalfPI;\r\n for(int i = 0; i < 8; ++i) \r\n { \r\n vec2 p = -SAMPLES[i]; \r\n#if MOBILE\r\nvec3 offsetPosition = getOffsetEyePosition(tex, tex2, eyePosition, p * radius); \r\n#else\r\nvec3 offsetPosition = getOffsetEyePosition(tex, eyePosition, p * radius); \r\n#endif\r\n vec3 v_i = offsetPosition - eyePosition; \r\n float h2 = min(acos(dot(normalize(v_i), viewDir)), HalfPI - thetaN); \r\n float weight = 1.0 - clamp((length(v_i) / radius - falloffDist), 0.0, 1.0); \r\n horizon2 = mix(horizon2, min(horizon2, h2), weight); \r\n } \r\n\r\n \r\n float occ = 1.0 - (cos(horizon1) + cos(horizon2)) * 0.5 * aoStrength; \r\n vec3 ao = computeMultiBounceColor(occ, vec3(1.0,1.0,1.0));\r\n\r\n return vec4(ao, 1.0); \r\n}\r\n","blit_transparent.inc":"uniform vec4 uColor;\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else \r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n float x = uColor.a;\r\n return uColor;\r\n}\r\n","material_color.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nconst vec3 dielectricColor = vec3(0.04); \r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness,in vec3 platteColor,in bool usePlate)\r\n{\r\n vec3 albedo = m_vColor.rgb;\r\n\r\n transparent = m_vColor.a * m_uMaterial.values[3];\r\n \r\n#if GAMMA\r\n albedo = sRGBToLinear(albedo, 2.2); \r\n#endif\r\n\r\n diffuse = albedo;\r\n specular = dielectricColor;\r\n}\r\n\r\n","material_solid.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nconst vec3 dielectricColor = vec3(0.04); \r\n#if ALPHATEST\r\n uniform sampler2D m_uDiffuseTexture;\r\n#endif\r\n\r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness,in vec3 platteColor,in bool usePlate)\r\n{\r\n vec3 albedo = vec3(m_uMaterial.values[0], m_uMaterial.values[1], m_uMaterial.values[2]);\r\n transparent = m_uMaterial.values[3];\r\n\r\n#if ALPHATEST\r\n vec4 texel = sampleTexture2D(m_uDiffuseTexture, m_vTexCoord.xy);\r\n float alphatest = texel.a * transparent;\r\n\r\n if (alphatest < 0.15)\r\n {\r\n discard;\r\n }\r\n#endif\r\n \r\n#if GAMMA\r\n albedo = sRGBToLinear(albedo, 2.2); \r\n#endif\r\n\r\n#if USE_PLATTE\r\n if(usePlate == true){\r\n diffuse = platteColor;\r\n }else{\r\n diffuse = albedo;\r\n }\r\n#else\r\n diffuse = albedo;\r\n#endif\r\n specular = dielectricColor;\r\n}\r\n\r\n","material_texture.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nuniform sampler2D m_uDiffuseTexture;\r\n\r\nuniform vec3 m_uTextureScale;\r\n\r\nuniform vec3 m_uTextureOffset;\r\n\r\n#if SECOND_TEXTURE\r\nuniform sampler2D m_uDiffuseTexture2;\r\n#endif\r\n\r\nconst vec3 dielectricColor = vec3(0.04); \r\nvec2 _getTransformedUV()\r\n{\r\n if(m_uTextureOffset.z<0.1)\r\n {\r\n return m_vTexCoord.xy;\r\n }\r\n\r\n vec2 uv;\r\n float cosValue = cos(m_uTextureScale.z);\r\n float sinValue = sin(m_uTextureScale.z);\r\n uv.x = cosValue*m_uTextureScale.x*m_vTexCoord.x - sinValue*m_uTextureScale.y*m_vTexCoord.y + m_uTextureOffset.x;\r\n uv.y = sinValue*m_uTextureScale.x*m_vTexCoord.x + cosValue*m_uTextureScale.y*m_vTexCoord.y + m_uTextureOffset.y;\r\n return uv;\r\n}\r\n\r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness ,in vec3 platteColor, in bool usePlate)\r\n{\r\n vec2 uv = _getTransformedUV();\r\n vec4 texel = sampleTexture2D(m_uDiffuseTexture, uv);\r\n#if SECOND_TEXTURE\r\n vec4 texel2 = sampleTexture2D(m_uDiffuseTexture2, uv);\r\n#endif\r\n\r\n transparent = texel.a * m_uMaterial.values[3];\r\n#if SECOND_TEXTURE\r\n transparent = transparent * (1.0 - texel2.a) + texel2.a;\r\n#endif\r\n\r\n#if ALPHATEST\r\n if (transparent < 0.55) \r\n {\r\n discard;\r\n }\r\n#endif\r\n\r\n vec3 albedo = texel.rgb * vec3(m_uMaterial.values[0], m_uMaterial.values[1], m_uMaterial.values[2]);\r\n#if SECOND_TEXTURE \r\n albedo = albedo * texel.a * m_uMaterial.values[3];\r\n albedo = albedo * (1.0 - texel2.a) + texel2.rgb * texel2.a;\r\n#endif\r\n\r\n#if GAMMA\r\n albedo = sRGBToLinear(albedo, 2.2); \r\n#endif\r\n\r\n#if USE_PLATTE\r\n if(usePlate == true){\r\n diffuse = texel.rgb * platteColor;\r\n }else{\r\n diffuse = albedo;\r\n }\r\n#else\r\n diffuse = albedo;\r\n#endif\r\n specular = dielectricColor;\r\n\r\n}\r\n\r\n","shade_adhoc.inc":"\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n#if BASE\r\n vec3 color = diffuse;\r\n#else\r\n float diffuseTerm = dot(vec4(N, 1), m_uSunLight.diffuseMatrix[0] * vec4(N, 1));\r\n \r\n float nv = max(dot(N, -V), 0.0);\r\n float vl = max(dot(V, m_uSunLight.direction), 0.0);\r\n diffuseTerm = diffuseTerm + (nv * (1.0 - vl)) * 0.8;\r\n \r\n vec3 color = m_uSunLight.intensity * vec3(0.5, 0.497, 0.49) * (diffuse * diffuseTerm) + diffuse * 0.5;\r\n \r\n float specularTerm = 0.0;\r\n float nh;\r\n \r\n#if SPECULAR\r\n vec3 H = -normalize(m_uSunLight.direction + V);\r\n nh = max(dot(N, H), 0.0);\r\n specularTerm = pow(nh, 100.0); \r\n color += m_uSunLight.intensity * vec3(0.5) * specularTerm;\r\n#endif\r\n\r\n#if SHADOW\r\n color *= shadow(P, N, m_uSunLight.direction);\r\n#endif\r\n\r\n#endif\r\n return color;\r\n}\r\n\r\n\r\n","shade_color_multi_layer.inc":"uniform sampler2D m_uPlatteTexture;\r\nuniform sampler2D m_uDensityTexture;\r\nuniform vec2 m_uInvResolution;\r\nuniform float m_uAlphaCorrection;\r\nuniform mat4 m_uInvTransform;\r\nuniform float m_uLayers;\r\nuniform vec2 m_uGridSize;\r\nuniform float m_uSampleNumber;\r\nuniform float m_uInstanceFilter;\r\nconst float STEP = 1.73205081 / 256.0;\r\n\r\nvec4 getColor(float intensity) {\r\n vec2 _uv = vec2(intensity, 0);\r\n vec4 color = sampleTexture2D(m_uPlatteTexture, _uv);\r\n float alpha = 1.0;\r\n return vec4(color.r, color.g, color.b, alpha); \r\n}\r\n\r\nfloat sampleAs3DTexture( vec3 texCoord ) {\r\n texCoord += vec3(0.5); float z = clamp(texCoord.z, 0.0, 0.99);\r\n float sliceNumber = floor(z * m_uLayers);\r\n\r\n float top = min(m_uSampleNumber + sliceNumber + 1.0, m_uLayers - 1.0);\r\n float bottom = max(sliceNumber - m_uSampleNumber, 0.0);\r\n float totalSamples = 0.0;\r\n\r\n texCoord.y = 1.0 - texCoord.y;\r\n texCoord.xy /= m_uGridSize;\r\n float intensity = 0.0;\r\n float heightLength = 0.0;\r\n int i;\r\n for (i = int(bottom); i <= int(top); i++)\r\n {\r\n vec2 texCoordSlice = texCoord.xy;\r\n texCoordSlice.x += mod(float(i), m_uGridSize.x) / m_uGridSize.x;\r\n texCoordSlice.y += floor(float(i) / m_uGridSize.x) / m_uGridSize.y;\r\n float tempIntensity = sampleTexture2D(m_uDensityTexture, texCoordSlice).x;\r\n intensity += tempIntensity;\r\n heightLength += 1.0;\r\n }\r\n intensity /= max(heightLength,1.0);\r\n\treturn intensity;\r\n}\r\n\r\n vec2 boxIntersection(vec3 orig, vec3 dir) \r\n{\r\n\tconst vec3 box_min = vec3( - 0.5 );\r\n\tconst vec3 box_max = vec3( 0.5 );\r\n\tvec3 inv_dir = 1.0 / dir;\r\n\tvec3 tmin_tmp = ( box_min - orig ) * inv_dir;\r\n vec3 tmax_tmp = ( box_max - orig ) * inv_dir;\r\n\tvec3 tmin = min( tmin_tmp, tmax_tmp );\r\n\tvec3 tmax = max( tmin_tmp, tmax_tmp );\r\n\tfloat t0 = max( tmin.x, max( tmin.y, tmin.z ) );\r\n\tfloat t1 = min( tmax.x, min( tmax.y, tmax.z ) );\r\n\treturn vec2( t0, t1 );\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n vec2 texc = vec2(gl_FragCoord.x * m_uInvResolution.x,\r\n gl_FragCoord.y * m_uInvResolution.y);\r\n\r\n vec3 frontPos = (m_uInvTransform * vec4(P.x, P.y, P.z, 1.0)).xyz;\r\n vec3 cameraPos = (m_uInvTransform * vec4(m_uPerFrame.cameraPosition.xyz, 1.0)).xyz;\r\n vec3 rayDir = normalize((m_uInvTransform * vec4(V.xyz, 0.0)).xyz);\r\n vec3 backPos = frontPos;\r\n vec2 bounds = boxIntersection(cameraPos, rayDir);\r\n if ( bounds.x > bounds.y ) discard;\r\n bounds.x = max( bounds.x, 0.0 );\r\n vec3 p = cameraPos + bounds.x * rayDir;\r\n vec3 inc = 1.0 / abs( rayDir );\r\n float delta = min( inc.x, min( inc.y, inc.z ) );\r\n\tdelta /= 100.0;\r\n\r\n vec4 accumulatedColor = vec4(0.0);\r\n vec4 tempColor = vec4(0.0);\r\n float d = 0.0;\r\n float widthLength = 0.0;\r\n for ( float t = bounds.x; t < bounds.y; t += delta ) {\r\n\t\td += sampleAs3DTexture( p );\r\n p += rayDir * delta;\r\n widthLength += 1.0;\r\n }\r\n d /= widthLength;\r\n if ( d > m_uInstanceFilter ) {\r\n accumulatedColor = getColor(d);\r\n\t\t accumulatedColor.a = 1.0;\r\n transparent = 1.0;\r\n }else{\r\n\t\t accumulatedColor.a = 0.0;\r\n transparent = 0.0;\r\n }\r\n return accumulatedColor.xyz;\r\n}\r\n","shade_glass.inc":"\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n#if BASE\r\n vec3 color = diffuse;\r\n#else\r\n vec3 color = diffuse * m_uSunLight.intensity;\r\n \r\n#if SPECULAR\r\n vec3 H = -normalize(m_uSunLight.direction + V);\r\n float nh = max(dot(N, H), 0.0);\r\n color += vec3(pow(nh, roughness));\r\n#endif\r\n#endif\r\n return color;\r\n}\r\n","shade_oit.inc":"\r\nfloat weight(float z, float a) {\r\n return pow(a, 1.0) * clamp(0.03 / (1e-5 + pow(abs(z) / 200.0, 4.0)), 1e-2, 3e3);\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n#if BASE\r\n vec3 color = diffuse;\r\n#else\r\n float diffuseTerm = dot(vec4(N, 1), m_uSunLight.diffuseMatrix[0] * vec4(N, 1));\r\n \r\n float nv = max(dot(N, -V), 0.0);\r\n float vl = max(dot(V, m_uSunLight.direction), 0.0);\r\n diffuseTerm = diffuseTerm + (nv * (1.0 - vl)) * 0.8;\r\n \r\n vec3 color = m_uSunLight.intensity * vec3(0.5, 0.497, 0.49) * (diffuse * diffuseTerm) + diffuse * 0.5;\r\n \r\n float specularTerm = 0.0;\r\n float nh;\r\n\r\n#if SPECULAR\r\n vec3 H = -normalize(m_uSunLight.direction + V);\r\n nh = max(dot(N, H), 0.0);\r\n specularTerm = pow(nh, 100.0); \r\n color += m_uSunLight.intensity * vec3(0.5, 0.497, 0.49) * specularTerm;\r\n#endif\r\n\r\n float w = weight(m_vDepth, transparent);\r\n color = diffuse * w * transparent;\r\n secondColor = vec4(vec3(transparent * w), 1.0);\r\n\r\n#endif\r\n return color;\r\n}\r\n","transform_nonormal.inc":"\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if MODEL_TRANSFORM\r\n#if INSTANCING\r\n position = m_aModelMatrix * position;\r\n#else\r\n position = m_uPerNode.modelMatrix * position;\r\n#endif\r\n#endif\r\n\r\n worldPosition = position;\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","blit_dof.inc":"uniform bool useDepth;\r\nuniform sampler2D m_uBlitDepthTexture;\r\nuniform float maxblur;\r\nuniform float aperture;\r\nuniform vec2 nearFar;\r\nuniform float focus;\r\n\r\nconst float UnpackDownscale = 255. / 256.; const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\r\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\r\n\r\nfloat unpackRGBAToDepth( const in vec4 v ) {\r\n return dot( v, UnpackFactors );\r\n}\r\n\r\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\r\n return ( near * far ) / ( ( far - near ) * invClipZ - far );\r\n}\r\n\r\nfloat getViewZ( const in float depth ) {\r\n\treturn perspectiveDepthToViewZ( depth, nearFar.x, nearFar.y );\r\n}\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec2 dofblur;\r\n vec2 aspectcorrect = vec2(1.0, invResolution.y / invResolution.x);\r\n if (useDepth) \r\n {\r\n float viewZ = getViewZ(unpackRGBAToDepth(sampleTexture2D(m_uBlitDepthTexture, uv)));\r\n float factor = focus + viewZ;\r\n dofblur = vec2(clamp(factor * aperture, -maxblur, maxblur));\r\n }\r\n else \r\n {\r\n dofblur = vec2(clamp(sampleTexture2D(m_uBlitDepthTexture, vec2(uv.x, 1.0 - uv.y)).a * aperture, -maxblur, maxblur));\r\n }\r\n vec2 dofblur9 = dofblur * 0.9;\r\n vec2 dofblur7 = dofblur * 0.7;\r\n vec2 dofblur4 = dofblur * 0.4;\r\n vec4 col = vec4( 0.0 );\r\n col += sampleTexture2D(tex, uv);\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, 0.4 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.15, 0.37 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, 0.29 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.37, 0.15 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.40, 0.0 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.37, -0.15 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, -0.29 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, -0.4 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.15, 0.37 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, 0.29 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.37, 0.15 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.4, 0.0 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.15, -0.37 ) * aspectcorrect ) * dofblur );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.15, 0.37 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.37, 0.15 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.15, 0.37 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.37, 0.15 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, 0.29 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.40, 0.0 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, -0.4 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, 0.29 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.4, 0.0 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, 0.4 ) * aspectcorrect ) * dofblur7 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, 0.29 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.4, 0.0 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, -0.4 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, 0.29 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.4, 0.0 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\r\n col += sampleTexture2D( tex, uv.xy + ( vec2( 0.0, 0.4 ) * aspectcorrect ) * dofblur4 );\r\n col = col / 41.0;\r\n col.a = 1.0;\r\n return col;\r\n}\r\n","blit_fog.inc":"uniform vec4 uColor;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n vec4 color = sampleTexture2D(tex, uv);\r\n float depth = uv.y;\r\n\r\n return mix(color, uColor, depth);\r\n}\r\n","blit_glow.inc":"uniform float intensity;\r\nuniform float offset;\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n vec4 color = sampleTexture2D(tex, uv);\r\n color.a = abs(offset - color.a);\r\n return color * intensity * 2.0;\r\n}\r\n","blit_glow_blur.inc":"uniform vec2 direction;\r\nuniform float radius;\r\nuniform float weights[7];\r\n\r\nfloat getLuminance(vec3 color)\r\n{\r\n return dot(color, vec3(0.2126, 0.7152, 0.0722));\r\n}\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n\r\n\tvec2 texelStep = invResolution * direction * radius;\r\n\tvec2 start = uv - 3.0 * texelStep;\r\n\r\n\tvec4 baseColor = vec4(0., 0., 0., 0.);\r\n\tvec2 texelOffset = vec2(0., 0.);\r\n\r\n\tfor (int i = 0; i < 7; i++)\r\n\t{\r\n\t\t\t\tvec4 texel = sampleTexture2D(tex, start + texelOffset);\r\n\t\tbaseColor.a += texel.a * weights[i];\r\n\r\n\t\t\t\tfloat luminance = getLuminance(baseColor.rgb);\r\n\t\tfloat luminanceTexel = getLuminance(texel.rgb);\r\n\t\tfloat choice = step(luminanceTexel, luminance);\r\n\t\tbaseColor.rgb = choice * baseColor.rgb + (1.0 - choice) * texel.rgb;\r\n\r\n\t\ttexelOffset += texelStep;\r\n\t}\r\n\r\n\treturn baseColor;\r\n}\r\n","blit_gradient.inc":"uniform vec3 uColor;\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n \r\n \r\n \r\n vec4 t = sampleTexture2D(tex, uv);\r\n return vec4(uColor, 1.0 - t.r);\r\n}\r\n","blit_metaball.inc":"uniform vec4 uColor;\r\nuniform vec4 uContourColor;\r\nuniform float uContourWidth;\r\nconst float uThreshold = 0.3;\r\n\r\n#if MOBILE\r\nvec4 shade(in sampler2D tex, in sampler2D tex2, in vec2 uv, in vec2 invResolution)\r\n#else\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n#endif\r\n{\r\n float contourThreshold = uThreshold * uContourWidth;\r\n float alpha = sampleTexture2D(tex, uv).r;\r\n\r\n vec4 ret;\r\n \r\n if (alpha < uThreshold) {\r\n\t discard;\r\n }\r\n\r\n#if CONTOUR\r\n if (alpha < contourThreshold) {\r\n ret = uContourColor;\r\n } else {\r\n#endif\r\n ret = uColor;\r\n#if CONTOUR\r\n }\r\n#endif\r\n\r\n return ret;\r\n}\r\n","blit_ssao.inc":"uniform vec3 uNearAxis;\r\nuniform vec2 uTexTransform;\r\nuniform vec2 SAMPLES[16];\r\nuniform float uRadius;\r\nuniform bool uIsPerspective;\r\n\r\nvec4 getNormalAndDepth(sampler2D tex, vec2 fragCoord)\r\n{\r\n vec2 texcoord = fragCoord * 0.5 + vec2(0.5);\r\n texcoord.x = texcoord.x * uTexTransform.x + uTexTransform.y;\r\n return sampleTexture2D(tex, texcoord);\r\n}\r\n\r\nvec3 getEyePosition(vec2 fragCoord, float depth)\r\n{\r\n vec3 eyeDirection = uNearAxis * vec3(fragCoord, 1.0);\r\n vec3 eyePosition;\r\n eyePosition.z = depth;\r\n if (uIsPerspective) \r\n {\r\n eyePosition.xy = eyeDirection.xy * depth / eyeDirection.z;\r\n } \r\n else \r\n {\r\n eyePosition.xy = eyeDirection.xy;\r\n }\r\n return eyePosition; \r\n}\r\n\r\nvec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\r\n{\r\n float ao = 0.0;\r\n float radius = uRadius;\r\n float radius2 = radius * radius;\r\n const float bias = 0.0001;\r\n const float epsilon = 0.0001;\r\n vec2 vFragCoord = uv * 2.0 - vec2(1.0);\r\n vec4 p = getNormalAndDepth(tex, vFragCoord);\r\n vec3 eyePosition = getEyePosition(vFragCoord, p.w);\r\n vec3 normal = p.xyz;\r\n for (int i = 0; i < 16; i++)\r\n {\r\n vec2 d = SAMPLES[i] - vec2(0.5);\r\n vec2 sample = vec2(vFragCoord + d * radius / eyePosition.z);\r\n float depth = getNormalAndDepth(tex, sample).w;\r\n vec3 samplePosition = getEyePosition(sample, depth);\r\n vec3 v_i = samplePosition - eyePosition;\r\n float v_v = dot(v_i, v_i);\r\n float f = max(radius2 - v_v, 0.0) / radius2;\r\n ao += f * f * f * max(0.0,(dot(v_i, normal) + eyePosition.z * bias)/(v_v + epsilon));\r\n }\r\n float occ = 1.0 - ao / (4.0 * 16.0);\r\n occ = clamp(pow(occ, 2.04), 0.0, 1.0);\r\n return vec4(occ);\r\n}\r\n\r\n","mark_main.fs":"#include <globalvars.inc>\r\n\r\nout vec4 out_color;\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n \r\n out_color = m_vId;\r\n}","material_animating_ribbon.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nuniform sampler2D m_uPlatteTexture;\r\nuniform float m_uTime;\r\nuniform float m_uSpeed;\r\n\r\nconst vec3 dielectricColor = vec3(0.04); \r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness,in vec3 platteColor ,in bool usePlate)\r\n{\r\n vec4 texel = sampleTexture2D(m_uPlatteTexture, m_vTexCoord.xy + m_uTime * vec2(0.001 * m_uSpeed, 0.0));\r\n transparent = texel.a;\r\n diffuse *= texel.rgb;\r\n specular = dielectricColor;\r\n}\r\n","material_barchart.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nconst vec3 dielectricColor = vec3(1.0); \r\n#if ALPHATEST\r\n uniform sampler2D m_uDiffuseTexture;\r\n#endif\r\n\r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness,in vec3 platteColor ,in bool usePlate)\r\n{\r\n diffuse *= m_vColor.xyz;\r\n specular = dielectricColor;\r\n transparent = 1.0;\r\n}\r\n","material_dummy.inc":"struct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness,in vec3 platteColor,in bool usePlate)\r\n{\r\n transparent = 0.5;\r\n return;\r\n}\r\n","material_heatmap.inc":"const vec3 dielectricColor = vec3(1.0);\r\n\r\nuniform sampler2D m_uData;\r\nuniform sampler2D m_uPlatte;\r\n#if ENABLE_FOREGROUND\r\nuniform sampler2D m_uForeground;\r\n#endif\r\n\r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness,in vec3 platteColor,in bool usePlate)\r\n{\r\n float intensity = sampleTexture2D(m_uData, m_vTexCoord.xy).x;\r\n diffuse *= sampleTexture2D(m_uPlatte, vec2(intensity, 0.0)).rgb;\r\n#if ENABLE_FOREGROUND\r\n vec4 foregroundColor = sampleTexture2D(m_uForeground, m_vTexCoord.xy);\r\n diffuse *= foregroundColor.rgb * foregroundColor.a + diffuse * (1.0 - foregroundColor.a);\r\n#endif\r\n specular = dielectricColor;\r\n#if DISABLE_BLEND\r\n transparent = 1.0;\r\n#else\r\n transparent = intensity * 100.0; \r\n#endif\r\n}\r\n","material_heightmap.inc":"const vec3 dielectricColor = vec3(1.0);\r\n\r\nvoid parseMaterial(inout vec3 diffuse, out vec3 specular, out float transparent, out float roughness,in vec3 platteColor,in bool usePlate)\r\n{\r\n diffuse *= m_vColor.xyz;\r\n specular = dielectricColor;\r\n transparent = 1.0;\r\n}\r\n","material_pbr.inc":"#if HAS_BASECOLORMAP\r\nuniform sampler2D m_uBaseColorTexture;\r\n#endif\r\n\r\n#if HAS_METALROUGHNESSMAP\r\nuniform sampler2D m_uMetallicRoughnessTexture;\r\n#endif\r\n\r\n#if HAS_NORMALMAP\r\nuniform sampler2D m_uNormalTexture;\r\n#endif\r\n\r\n#if HAS_EMISSIVEMAP\r\nuniform sampler2D m_uEmissiveTexture;\r\n#endif\r\n\r\n#if HAS_OCCLUSIONMAP\r\n uniform sampler2D m_uOcclusionTexture;\r\n#endif\r\n\r\nstruct MaterialStruct\r\n{\r\n float values[10]; \r\n};\r\n\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nvoid parseMaterial(out vec4 baseColor, out vec3 normal, out vec2 metallicRoughness, out vec3 emissiveColor, out float occlusion)\r\n{\r\n baseColor = vec4(m_uMaterial.values[0], m_uMaterial.values[1], m_uMaterial.values[2], m_uMaterial.values[3]); \r\n#if HAS_BASECOLORMAP\r\n baseColor *= sampleTexture2D(m_uBaseColorTexture, m_vTexCoord.xy);\r\n#endif\r\n\r\n metallicRoughness = vec2(m_uMaterial.values[5], m_uMaterial.values[4]);\r\n#if HAS_METALROUGHNESSMAP\r\n metallicRoughness *= sampleTexture2D(m_uMetallicRoughnessTexture, m_vTexCoord.xy).bg;\r\n#endif\r\n\r\n#if HAS_NORMALMAP\r\n normal = sampleTexture2D(m_uNormalTexture, m_vTexCoord.xy).xyz * 2.0 - vec3(1.0);\r\n#else \r\n normal = m_vNormal;\r\n#endif\r\n\r\n emissiveColor = vec3(m_uMaterial.values[6], m_uMaterial.values[7], m_uMaterial.values[8]);\r\n#if HAS_EMISSIVEMAP\r\n emissiveColor *= sampleTexture2D(m_uEmissiveTexture, m_vTexCoord.xy).xyz;\r\n#endif\r\n\r\n#if HAS_OCCLUSIONMAP\r\n occlusion = sampleTexture2D(m_uOcclusionTexture, m_vTexCoord.xy).r;\r\n#endif\r\n}\r\n\r\n","modelo_dark.fs":"#include <globalvars.inc>\r\n#include <gamma.inc>\r\n#include <lights.inc>\r\n#include <shadow.inc>\r\n\r\n#if WEBGL2\r\nlayout(location=0) out vec4 out_color;\r\n#endif\r\n\r\nstruct MaterialStruct\r\n{\r\n float values[6]; \r\n};\r\nuniform MaterialStruct m_uMaterial;\r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n vec3 N = normalize(m_vNormal);\r\n vec3 V = normalize(m_vVertex * m_uPerFrame.cameraPosition.w - m_uPerFrame.cameraPosition.xyz);\r\n vec3 P = m_vVertex;\r\n\r\n#if DOUBLESIDED \r\n N *= (float(gl_FrontFacing)*2.0-1.0);\r\n#endif\r\n\r\n vec3 diffuse; \r\n float transparent;\r\n vec3 specular;\r\n\r\n diffuse = vec3(m_uMaterial.values[0], m_uMaterial.values[1], m_uMaterial.values[2]);\r\n transparent = m_uMaterial.values[3];\r\n\r\n\r\n float diffuseTerm = dot(vec4(N, 1), m_uSunLight.diffuseMatrix[0] * vec4(N, 1));\r\n \r\n float nv = max(dot(N, -V), 0.0);\r\n float vl = max(dot(V, m_uSunLight.direction), 0.0);\r\n diffuseTerm = diffuseTerm + (nv * (1.0 - vl)) * 0.8;\r\n \r\n vec3 color = m_uSunLight.intensity * vec3(0.5, 0.497, 0.49) * (diffuse * diffuseTerm) + diffuse * 0.5;\r\n \r\n float specularTerm = 0.0;\r\n float nh;\r\n \r\n#if SPECULAR\r\n vec3 H = -normalize(m_uSunLight.direction + V);\r\n nh = max(dot(vec3(0.0, 0.0, N.z), H), 0.0); specularTerm = pow(nh, 10.0); \r\n color += m_uSunLight.intensity * vec3(10.0) * specularTerm;\r\n#endif\r\n\r\n transparent = max(specularTerm, transparent);\r\n\r\n#if SHADOW\r\n color *= shadow(P, N, m_uSunLight.direction);\r\n#endif\r\n \r\n#if WEBGL2\r\n out_color = vec4(color, transparent);\r\n#else\r\n gl_FragColor = vec4(color, transparent); \r\n#endif\r\n \r\n}\r\n\r\n","modelo_ribbon.vs":"#if WEBGL2\r\nout vec3 m_vVertex;\r\nout vec3 m_vNormal;\r\nout vec3 m_vTexCoord;\r\nout vec4 m_vColor;\r\nflat out vec4 m_vId;\r\nout float m_vDepth;\r\nout float m_vColorIndex;\r\n#else\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\nuniform vec4 uTexSizeAndInv;\r\nuniform float m_uWidth;\r\nvec2 project(vec4 device)\r\n{\r\n vec3 devicePos = device.xyz / device.w;\r\n vec2 clipPos = (devicePos * 0.5 + 0.5).xy;\r\n return clipPos * uTexSizeAndInv.xy;\r\n}\r\n\r\nvec4 unproject(vec2 screen, float z, float w) \r\n{\r\n vec2 clipPos = screen * uTexSizeAndInv.zw;\r\n vec2 devicePos = clipPos * 2.0 - 1.0;\r\n return vec4(devicePos * w, z, w);\r\n}\r\n\r\nconst float PI = 3.14159;\r\nvoid main()\r\n{\r\n vec2 sLast = project(m_uPerFrame.vpMatrix * vec4(m_aNormal0.xyz, 1.0));\r\n vec2 sNext = project(m_uPerFrame.vpMatrix * vec4(m_aColor.xyz, 1.0));\r\n vec4 dCurrent = m_uPerFrame.vpMatrix * vec4(m_aPosition.xyz, 1.0);\r\n vec2 sCurrent = project(dCurrent);\r\n\r\n vec2 normal1 = (sLast - sCurrent);\r\n vec2 normal2 = (sCurrent - sNext);\r\n vec2 normal = normalize(normal1 + normal2);\r\n float off = m_aColor.w;\r\n \r\n vec2 dir = vec2(normal.y, -normal.x) * off;\r\n vec2 pos = sCurrent + dir * m_uWidth;\r\n\r\n vec4 worldPosition = vec4(m_aPosition.xyz, 1.0);\r\n\r\n vec3 uv = vec3(m_aTexCoord.x, (off + 1.0) * 0.5, 1.0);\r\n\r\n#include <varying.inc>\r\n\r\n gl_Position = unproject(pos, dCurrent.z, dCurrent.w);\r\n}\r\n\r\n","pbr.fs":"#if WEBGL2\r\nin vec3 m_vVertex;\r\nin vec3 m_vNormal;\r\nin vec3 m_vTexCoord;\r\nin mat3 m_vTBN;\r\nin vec4 m_vColor;\r\nflat in vec4 m_vId;\r\nin float m_vDepth;\r\nin float m_vColorIndex;\r\n#else \r\n\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying mat3 m_vTBN;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\n#include <uniform.inc>\r\n\r\n\r\n\r\n\r\n","pbr_main.fs":"#include <globalvars.inc>\r\n#include <gamma.inc>\r\n#include <lights.inc>\r\n#include <shadow.inc>\r\n\r\nvoid parseMaterial(out vec4 baseColor, out vec3 normal, out vec2 metallicRoughness, out vec3 emissiveColor, out float occlusion);\r\n\r\nvec4 shade(in vec4 baseColor, in vec3 normal, in vec3 V, in vec2 metallicRoughness, in vec3 emissiveColor, in float occlusion); \r\n\r\n#if WEBGL2\r\nlayout(location=0) out vec4 out_color;\r\nlayout(location=1) out vec4 out_color1; \r\n#endif\r\n\r\n#if USE_PLATTE\r\nuniform sampler2D m_uPlatteTexture;\r\n#endif\r\n\r\n#if TONE_MAPPING \r\n\r\n#include <tone_mapping.inc>\r\n\r\n#endif \r\n\r\nvoid main()\r\n{\r\n#include <clipping.inc>\r\n\r\n vec3 N = normalize(m_vNormal);\r\n vec3 V = normalize(m_vVertex - m_uPerFrame.cameraPosition.xyz);\r\n vec3 P = m_vVertex;\r\n\r\n#if DOUBLESIDED \r\n N *= -sign(dot(N, V));\r\n#endif\r\n\r\n vec4 baseColor; \r\n vec3 normal;\r\n vec2 metallicRoughness;\r\n vec3 emissiveColor;\r\n float occlusion;\r\n#if USE_PLATTE\r\n if (m_vColorIndex < 0.495)\r\n {\r\n vec4 platteColor = sampleTexture2D(m_uPlatteTexture, vec2(m_vColorIndex, 0));\r\n baseColor = platteColor;\r\n }\r\n else\r\n {\r\n parseMaterial(baseColor, normal, metallicRoughness, emissiveColor, occlusion);\r\n }\r\n#else\r\n parseMaterial(baseColor, normal, metallicRoughness, emissiveColor, occlusion);\r\n#endif\r\n vec4 color = shade(baseColor, normal, V, metallicRoughness, emissiveColor, occlusion);\r\n\r\n#if TONE_MAPPING\r\n color.rgb = toneMapping(color.rgb);\r\n#endif\r\n#if GAMMA\r\n color.xyz = linearTosRGB(color.xyz, 2.2);\r\n#endif\r\n\r\n#if WEBGL2\r\n out_color = color;\r\n#else\r\n gl_FragColor = color; \r\n#endif\r\n \r\n}\r\n","pbr_main.vs":"#if WEBGL2\r\nout vec3 m_vVertex;\r\nout vec3 m_vNormal;\r\nout vec3 m_vTexCoord;\r\nout mat3 m_vTBN;\r\nout vec4 m_vColor;\r\nflat out vec4 m_vId;\r\nout float m_vDepth;\r\nout float m_vColorIndex;\r\n#else\r\nvarying vec3 m_vVertex;\r\nvarying vec3 m_vNormal;\r\nvarying vec3 m_vTexCoord;\r\nvarying mat3 m_vTBN;\r\nvarying vec4 m_vColor;\r\nvarying float m_vDepth;\r\nvarying float m_vColorIndex;\r\n#endif\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition);\r\n\r\nvoid main()\r\n{\r\n vec4 position = vec4(m_aPosition, 1.0);\r\n#if COMPRESSION\r\n vec4 normal = vec4(m_aNormal0, m_aNormal1, m_aNormal2);\r\n#else\r\n vec4 normal = vec4(m_aNormal0, 0.0);\r\n#endif\r\n vec3 uv = vec3(m_aTexCoord, 1.0);\r\n\r\n vec4 worldPosition;\r\n\r\n transform(position, normal, uv, worldPosition);\r\n\r\n#if VISIBILITY\r\n position.z -= step(0.5, m_aMaterial) * position.w * 10000.0;\r\n#endif\r\n\r\n#if HAS_TANGENT\r\n vec3 tangent = (m_uPerNode.modelMatrix * vec4(m_aTangent, 0.0)).xyz;\r\n vec3 biTangent = normalize(cross(normal.xyz, tangent));\r\n m_vTBN = mat3(normalize(tangent), biTangent, normal.xyz);\r\n#endif\r\n\r\n#if USE_PLATTE\r\n m_vColorIndex = m_aMaterial; \r\n#endif\r\n\r\n#include <varying.inc>\r\n\r\n gl_Position = position;\r\n\r\n gl_PointSize = 4.0;\r\n}\r\n\r\n","shade_glyph.inc":"uniform sampler2D m_uFontBitmap;\r\nuniform vec2 m_uTextureSize;\r\nuniform vec3 m_uColor;\r\n\r\nfloat bilinear(vec2 frac2, vec4 v)\r\n{\r\n vec2 cc = mix(v.xz, v.yw, frac2.x);\r\n return mix(cc.x, cc.y, frac2.y);\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n \r\n vec2 coord = m_vTexCoord.xy * m_uTextureSize;\r\n vec2 p = floor(coord - vec2(0.5)) + vec2(0.5);\r\n vec2 f = coord - p;\r\n vec2 p0 = p / m_uTextureSize;\r\n vec2 pixel = 1.0 / m_uTextureSize;\r\n\r\n vec4 c;\r\n c.x = sampleTexture2D(m_uFontBitmap, p0).x;\r\n c.y = sampleTexture2D(m_uFontBitmap, p0 + vec2(pixel.x, 0)).x;\r\n c.z = sampleTexture2D(m_uFontBitmap, p0 + vec2(0, pixel.y)).x;\r\n c.w = sampleTexture2D(m_uFontBitmap, p0 + vec2(pixel.x, pixel.y)).x;\r\n\r\n float value = bilinear(f, c);\r\n\r\n transparent = step(0.45, value);\r\n if (transparent < 0.5) {\r\n discard;\r\n }\r\n return m_uColor;\r\n}\r\n","shade_pbr.inc":"uniform sampler2D m_uBrdfLut;\r\nuniform samplerCube m_uDiffuseEnvMap;\r\nuniform samplerCube m_uSpecularEnvMap;\r\nuniform float m_uTotalLod;\r\nconst float M_PI = 3.1416926;\r\nvec3 specularReflection(vec3 reflectance0, vec3 reflectance90, float VdotH)\r\n{\r\n return reflectance0 + (reflectance90 - reflectance0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\r\n}\r\n\r\n\r\nfloat geometricOcclusion(float NdotL, float NdotV, float alphaRoughness)\r\n{\r\n float r = alphaRoughness;\r\n\r\n float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\r\n float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\r\n return attenuationL * attenuationV;\r\n}\r\n\r\nfloat microfacetDistribution(float alphaRoughness, float NdotH)\r\n{\r\n float roughnessSq = alphaRoughness * alphaRoughness;\r\n float f = (NdotH * roughnessSq - NdotH) * NdotH + 1.0;\r\n return roughnessSq / (M_PI * f * f);\r\n}\r\n\r\nvec3 diffuse(vec3 diffuseColor)\r\n{\r\n return diffuseColor / M_PI;\r\n}\r\n\r\nvec3 getIBLContribution(float perceptualRoughness, vec3 n, float NdotV, vec3 diffuseColor, vec3 specularColor, vec3 reflection)\r\n{\r\n \r\n vec3 brdf = sampleTexture2D(m_uBrdfLut, vec2(NdotV, 1.0 - perceptualRoughness)).rgb;\r\n brdf = pow(brdf,vec3(2.2));\r\n \r\n#if DIFFUSE_EVN_MAP\r\n vec3 diffuseLight = sampleTexture3D(m_uDiffuseEnvMap, vec3(n.x, n.z, -n.y)).rgb;\r\n#else\r\n vec3 diffuseLight = vec3(1.0);\r\n\r\n#if SPECULAR_ENV_MAP\r\n float lod = (perceptualRoughness * m_uTotalLod);\r\n vec3 specularLight = sampleTexture3D(m_uSpecularEnvMap, vec3(-reflection.x, -reflection.z, reflection.y), lod).rgb;\r\n#else\r\n vec3 specularLight = vec3(1.0);\r\n#endif\r\n\r\n vec3 diffuse = diffuseLight * diffuseColor;\r\n vec3 specular = specularLight * (specularColor * brdf.x + brdf.y);\r\n\r\n return diffuse + specular;\r\n}\r\n\r\nvec4 shade(in vec4 baseColor, in vec3 normal, in vec3 V, in vec2 metallicRoughness, in vec3 emissiveColor, in float occlusion)\r\n{\r\n#if BASE\r\n vec3 color = baseColor;\r\n#else\r\n float roughness = clamp(metallicRoughness.y, 0.04, 1.0);\r\n float metallic = clamp(metallicRoughness.x, 0.0, 1.0);\r\n\r\n#if HAS_NORMALMAP\r\n\r\n#if HAS_TANGENT\r\n vec3 worldNormal = normalize(m_vTBN * normal);\r\n#else\r\n vec3 pos_dx = dFdx(m_vVertex);\r\n vec3 pos_dy = dFdy(m_vVertex);\r\n vec3 tex_dx = dFdx(m_vTexCoord);\r\n vec3 tex_dy = dFdy(m_vTexCoord);\r\n vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\r\n t = normalize(t - m_vNormal * dot(m_vNormal, t));\r\n vec3 b = normalize(cross(m_vNormal, t));\r\n mat3 tbn = mat3(t, b, m_vNormal);\r\n vec3 worldNormal = normalize(tbn * normal);\r\n#endif\r\n\r\n#else\r\n vec3 worldNormal = normalize(m_vNormal);\r\n#endif\r\n\r\n vec3 l = normalize(m_uSunLight.direction); vec3 h = normalize(l + V); vec3 reflection = -normalize(reflect(V, worldNormal));\r\n\r\n float NdotL = clamp(dot(worldNormal, l), 0.001, 1.0);\r\n float NdotV = abs(dot(worldNormal, V)) + 0.001;\r\n float NdotH = clamp(dot(worldNormal, h), 0.0, 1.0);\r\n float LdotH = clamp(dot(l, h), 0.0, 1.0);\r\n float VdotH = clamp(dot(V, h), 0.0, 1.0);\r\n\r\n vec3 f0 = vec3(0.04);\r\n vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\r\n diffuseColor *= 1.0 - metallic;\r\n vec3 specularColor = mix(f0, baseColor.rgb, metallic);\r\n float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\r\n\r\n float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\r\n vec3 specularEnvironmentR0 = specularColor.rgb;\r\n vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\r\n\r\n float alphaRoughness = roughness * roughness;\r\n vec3 F = specularReflection(specularEnvironmentR0, specularEnvironmentR90, VdotH);\r\n float G = geometricOcclusion(NdotL, NdotV, alphaRoughness);\r\n float D = microfacetDistribution(alphaRoughness, NdotH);\r\n vec3 diffuseContrib = (1.0 - F) * diffuse(diffuseColor);\r\n vec3 specContrib = max(vec3(0.0), F * G * D / (4.0 * NdotL * NdotV));\r\n vec3 color = NdotL * (diffuseContrib + specContrib);\r\n\r\n diffuseColor *= m_uSunLight.intensity;\r\n specularColor *= m_uSunLight.intensity;\r\n color += m_uMaterial.values[9] * getIBLContribution(roughness, worldNormal, NdotV, diffuseColor, specularColor, reflection);\r\n\r\n#if SHADOW\r\n color *= shadow(m_vVertex, normal, m_uSunLight.direction);\r\n#endif\r\n\r\n#if HAS_EMISSIVEMAP\r\n color += emissiveColor;\r\n#endif\r\n\r\n#if HAS_OCCLUSIONMAP\r\n color *= occlusion;\r\n#endif\r\n#endif\r\n return vec4(color, baseColor.a);\r\n}\r\n","shade_pbs.inc":"","shade_volume.inc":"uniform sampler2D m_uGradientTexture;\r\nuniform sampler2D m_uPlatteTexture;\r\nuniform sampler2D m_uDensityTexture;\r\nuniform vec2 m_uInvResolution;\r\nuniform float m_uAlphaCorrection;\r\nuniform mat4 m_uInvTransform;\r\n\r\nconst float STEP = 1.73205081 / 256.0;\r\n\r\nvec4 getColor(float density) \r\n{\r\n density = min(0.26, density) / 0.26;\r\n vec4 color = sampleTexture2D(m_uPlatteTexture, vec2(density, 0.0));\r\n\r\n float alpha = max(density, 0.02);\r\n \r\n return vec4(color.rgb, alpha); \r\n}\r\n\r\nvec4 sampleDensity(vec3 position) \r\n{\r\n \r\n \r\n \r\n \r\n \r\n vec3 xyz = position + vec3(0.5);\r\n \r\n float density = sampleTexture2D(m_uDensityTexture, xyz.xy).x;\r\n \r\n vec4 res = getColor(density);\r\n\r\n \r\n res.w *= 2.0 * (xyz.z * xyz.z * xyz.z) - 3.0 * (xyz.z * xyz.z) + 1.0; \r\n return res;\r\n}\r\n\r\n vec2 boxIntersection(vec3 ro, vec3 rd) \r\n{\r\n vec3 m = 1.0 / rd; vec3 n = m * ro; vec3 k = abs(m) * 0.5;\r\n \r\n vec3 t1 = -n - k;\r\n vec3 t2 = -n + k;\r\n\r\n float tN = max(max(t1.x, t1.y), t1.z);\r\n float tF = min(min(t2.x, t2.y), t2.z);\r\n \r\n if( tN > tF || tF < 0.0) return vec2(-1.0); \r\n return vec2(tN, tF);\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n vec3 frontPos = (m_uInvTransform * vec4(P.x, P.y, P.z, 1.0)).xyz;\r\n vec3 cameraPos = (m_uInvTransform * vec4(m_uPerFrame.cameraPosition.xyz, 1.0)).xyz;\r\n vec3 rayDir = normalize((m_uInvTransform * vec4(V.xyz, 0.0)).xyz);\r\n vec3 backPos = frontPos;\r\n vec2 t = boxIntersection(cameraPos, rayDir);\r\n if (t.x > -1.0 && t.y > -1.0)\r\n {\r\n backPos = cameraPos + rayDir * t.y;\r\n }\r\n \r\n float rayLength = length(backPos - frontPos);\r\n\r\n int steps = int(max(1.0, floor(rayLength / STEP)));\r\n \r\n float delta = rayLength / float(steps);\r\n \r\n vec3 deltaDirection = rayDir * delta;\r\n \r\n vec3 currentPosition = frontPos;\r\n \r\n vec4 accumulatedColor = vec4(0.0);\r\n \r\n float accumulatedAlpha = 0.0;\r\n \r\n vec4 colorSample;\r\n float alphaSample;\r\n \r\n#if WEBGL2\r\n for (int i = 0; i < steps; i++)\r\n {\r\n#else\r\n for (int i = 0; i < 256; i++) \r\n {\r\n if (i >= steps) \r\n {\r\n break;\r\n }\r\n#endif\r\n colorSample = sampleDensity(currentPosition);\r\n \r\n alphaSample = colorSample.a * m_uAlphaCorrection;\r\n \r\n alphaSample *= (1.0 - accumulatedAlpha);\r\n \r\n accumulatedColor += colorSample * alphaSample;\r\n \r\n accumulatedAlpha += alphaSample;\r\n \r\n currentPosition += deltaDirection;\r\n }\r\n \r\n transparent = accumulatedAlpha;\r\n \r\n return accumulatedColor.xyz;\r\n}\r\n","shade_volume_multi_layer.inc":"uniform sampler2D m_uDensityTexture;\r\nuniform sampler2D m_uPlatteTexture;\r\nuniform vec2 m_uInvResolution;\r\nuniform float m_uAlphaCorrection;\r\nuniform mat4 m_uInvTransform;\r\nuniform float m_uLayers;\r\nuniform vec2 m_uGridSize;\r\nuniform float m_uSampleNumber;\r\nconst float STEP = 1.73205081 / 256.0;\r\n\r\nvec4 getColor(float intensity) {\r\n intensity = min(0.26, intensity) / 0.26;\r\n vec2 _uv = vec2(intensity, 0);\r\n vec4 color = sampleTexture2D(m_uPlatteTexture, _uv);\r\n float alpha = intensity;\r\n if (alpha < 0.03)\r\n {\r\n alpha = 0.02;\r\n }\r\n\r\n return vec4(color.r, color.g, color.b, alpha); \r\n}\r\n\r\nvec4 sampleAs3DTexture(vec3 texCoord) {\r\n texCoord += vec3(0.5);\r\n vec4 heightSlice1;\r\n vec4 heightSlice2;\r\n vec4 colorSlice1;\r\n vec4 colorSlice2;\r\n vec2 texCoordSlice1;\r\n vec2 texCoordSlice2;\r\n\r\n float z = clamp(texCoord.z, 0.0, 0.99);\r\n\r\n float sliceNumber = floor(z * m_uLayers);\r\n\r\n float top = min(m_uSampleNumber + sliceNumber + 1.0, m_uLayers - 1.0);\r\n float bottom = max(sliceNumber - m_uSampleNumber, 0.0);\r\n\r\n float totalSamples = 0.0;\r\n\r\n texCoord.y = 1.0 - texCoord.y;\r\n texCoord.xy /= m_uGridSize;\r\n\r\n float intensity = 0.0;\r\n float sampleWeight;\r\n int i;\r\n#if WEBGL2\r\n for (i = int(bottom); i <= int(top); i++)\r\n {\r\n#else\r\n for (int j = 0; j < 256; j++)\r\n {\r\n i = int(bottom) + j;\r\n if (i > int(top))\r\n {\r\n break;\r\n }\r\n#endif\r\n vec2 texCoordSlice = texCoord.xy;\r\n texCoordSlice.x += (mod(float(i), m_uGridSize.x) / m_uGridSize.x);\r\n texCoordSlice.y += floor(float(i) / m_uGridSize.x) / m_uGridSize.y;\r\n\r\n float tempIntensity = sampleTexture2D(m_uDensityTexture, texCoordSlice).x;\r\n sampleWeight = (m_uSampleNumber + 1.0) - abs(z * m_uLayers - (float(i)));\r\n intensity += sampleWeight * tempIntensity;\r\n totalSamples += sampleWeight;\r\n }\r\n\r\n if (totalSamples != 0.0)\r\n {\r\n intensity /= totalSamples; \r\n } \r\n\r\n return getColor(intensity);\r\n}\r\n\r\n\r\n vec2 boxIntersection(vec3 ro, vec3 rd) \r\n{\r\n vec3 m = 1.0 / rd; vec3 n = m * ro; vec3 k = abs(m) * 0.5;\r\n \r\n vec3 t1 = -n - k;\r\n vec3 t2 = -n + k;\r\n\r\n float tN = max(max(t1.x, t1.y), t1.z);\r\n float tF = min(min(t2.x, t2.y), t2.z);\r\n \r\n if( tN > tF || tF < 0.0) return vec2(-1.0); \r\n return vec2(tN, tF);\r\n}\r\n\r\nvec3 shade(in vec3 diffuse, in vec3 specular, in float roughness, inout float transparent, in vec3 P, in vec3 N, in vec3 V, out vec4 secondColor)\r\n{\r\n vec2 texc = vec2(gl_FragCoord.x * m_uInvResolution.x,\r\n gl_FragCoord.y * m_uInvResolution.y);\r\n\r\n vec3 frontPos = (m_uInvTransform * vec4(P.x, P.y, P.z, 1.0)).xyz;\r\n vec3 cameraPos = (m_uInvTransform * vec4(m_uPerFrame.cameraPosition.xyz, 1.0)).xyz;\r\n vec3 rayDir = normalize((m_uInvTransform * vec4(V.xyz, 0.0)).xyz);\r\n vec3 backPos = frontPos;\r\n vec2 t = boxIntersection(cameraPos, rayDir);\r\n \r\n if (t.x > -1.0 && t.y > -1.0)\r\n {\r\n backPos = cameraPos + rayDir * t.y;\r\n }\r\n\r\n float rayLength = length(backPos - frontPos);\r\n\r\n int steps = int(max(1.0, floor(rayLength / STEP)));\r\n\r\n float delta = rayLength / float(steps);\r\n\r\n vec3 deltaDirection = rayDir * delta;\r\n\r\n vec3 currentPosition = frontPos;\r\n\r\n vec4 accumulatedColor = vec4(0.0);\r\n\r\n float accumulatedAlpha = 0.0;\r\n\r\n vec4 colorSample;\r\n float alphaSample;\r\n\r\n \r\n#if WEBGL2\r\n for (int i = 0; i < steps; i++)\r\n {\r\n#else\r\n for (int i = 0; i < 256; i++) \r\n {\r\n if (i >= steps)\r\n {\r\n break;\r\n }\r\n#endif\r\n colorSample = sampleAs3DTexture(currentPosition);\r\n\r\n alphaSample = colorSample.a * m_uAlphaCorrection;\r\n\r\n alphaSample *= (1.0 - accumulatedAlpha);\r\n\r\n accumulatedColor += colorSample * alphaSample;\r\n\r\n accumulatedAlpha += alphaSample;\r\n\r\n currentPosition += deltaDirection;\r\n }\r\n\r\n transparent = accumulatedAlpha;\r\n\r\n return accumulatedColor.xyz;\r\n}\r\n","transform_barchart.inc":"uniform sampler2D m_uData;\r\nuniform ivec2 m_uRes;\r\nuniform float m_uThickness;\r\nuniform sampler2D m_uPlatte;\r\n \r\nconst vec2 offsets[4] = vec2[](vec2(-1, -1), vec2(1, -1), vec2(-1, 1), vec2(1, 1));\r\nconst int columns[6] = int[](0, 0, 1, 1, 2, 2);\r\nconst float signs[6] = float[](-1.0, 1.0, -1.0, 1.0, -1.0, 1.0);\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n float height = textureLod(m_uData, (position.xy + 1.0) * 0.5, 0.0).r;\r\n \r\n float xSize = m_uThickness / float(m_uRes.x); float ySize = m_uThickness / float(m_uRes.y);\r\n int vertexId = gl_VertexID % 24;\r\n\r\n int faceIndex = vertexId / 4;\r\n int vertIndex = vertexId % 4;\r\n\r\n int c0 = columns[faceIndex];\r\n int c1 = (c0 + 1) % 3;\r\n int c2 = (c0 + 2) % 3;\r\n\r\n float stretch[3];\r\n stretch[c0] = signs[faceIndex];\r\n stretch[c1] = offsets[vertIndex][0];\r\n stretch[c2] = offsets[vertIndex][1];\r\n\r\n position.x += stretch[0] * xSize;\r\n position.y += stretch[1] * ySize;\r\n position.z += (stretch[2] + 1.0) * 0.5 * height;\r\n\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n normal = m_uPerNode.modelMatrix * normal;\r\n#endif\r\n\r\n m_vColor = textureLod(m_uPlatte, vec2(height, 0.0), 0.0);\r\n\r\n worldPosition = position;\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_barchart_wireframe.inc":"uniform sampler2D m_uData;\r\nuniform ivec2 m_uRes;\r\nuniform float m_uThickness;\r\n \r\nconst vec2 offsets[4] = vec2[](vec2(1, -1), vec2(1, 1), vec2(-1, 1), vec2(-1, -1));\r\nconst float signs[2] = float[](0.0, 1.0);\r\n\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n float height = textureLod(m_uData, (position.xy + 1.0) * 0.5, 0.0).r;\r\n \r\n float xSize = m_uThickness / float(m_uRes.x); float ySize = m_uThickness / float(m_uRes.y);\r\n int vertexId = gl_VertexID % 8;\r\n\r\n int heightIndex = vertexId / 4;\r\n int vertIndex = vertexId % 4;\r\n\r\n float stretch[3];\r\n stretch[0] = offsets[vertIndex][0];\r\n stretch[1] = offsets[vertIndex][1];\r\n stretch[2] = signs[heightIndex];\r\n\r\n position.x += 1.005 * stretch[0] * xSize; position.y += 1.005 * stretch[1] * ySize;\r\n position.z += 1.005 * stretch[2] * height;\r\n\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n normal = m_uPerNode.modelMatrix * normal;\r\n#endif\r\n\r\n worldPosition = position;\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_heightmap.inc":"uniform sampler2D m_uData;\r\nuniform sampler2D m_uPlatte;\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if WEBGL2\r\n float height = texture(m_uData, uv.xy).x;\r\n#else\r\n float height = texture2DLod(m_uData, uv.xy, 0.0).a;\r\n#endif\r\n position.z = height;\r\n\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n normal = m_uPerNode.modelMatrix * normal;\r\n#endif\r\n\r\n#if WEBGL2\r\n m_vColor = textureLod(m_uPlatte, vec2(height, 0.0), 0.0);\r\n#else\r\n m_vColor = texture2DLod(m_uPlatte, vec2(height, 0.0), 0.0);\r\n#endif\r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n","transform_mark.inc":"\r\nvoid transform(inout vec4 position, inout vec4 normal, inout vec3 uv, out vec4 worldPosition)\r\n{\r\n#if MODEL_TRANSFORM\r\n position = m_uPerNode.modelMatrix * position;\r\n#endif\r\n \r\n position = m_uPerFrame.vpMatrix * position;\r\n}\r\n"},n=i,a=function(){function e(e,t,r,i){this.name=e,this.ready=!1;var a,o,s="";if(Array.isArray(t))for(a=0,o=t.length;a<o;++a)n[t[a]]?s+=n[t[a]]:s+=t[a];else n[t]?s+=n[t]:s+=t;var l="";if(Array.isArray(r))for(a=0,o=r.length;a<o;++a)n[r[a]]?l+=n[r[a]]:l+=r[a];else n[r]?l+=n[r]:l+=r;this._precompile(s,l,i)}return e.prototype.destroy=function(){this.ready&&(this.vsSource=null,this.fsSource=null,this.ready=!1)},e.prototype._precompile=function(e,t,r){if(!this.ready){try{this.vsSource=this._dissolve(e,!0,r),this.fsSource=this._dissolve(t,!1,r)}catch(e){return void console.warn(e)}this.ready=!0}},e.prototype._dissolve=function(e,t,r){var i="";i+="#if WEBGL2 \n#version 300 es \n#endif \n",r.highPrecision?i+="precision highp float;\nprecision highp sampler2D;\n":i+="precision mediump float;\nprecision mediump sampler2D;\n",t?((r.viewMatrix||r.vpMatrix||r.projectionMatrix||r.mvpMatrix)&&(i+="#if WEBGL2 \nuniform m_bPerFrame { \n    mat4 viewMatrix;\n    mat4 vpMatrix;\n    vec4 cameraPosition;\n} m_uPerFrame; \n#else \nstruct PerFrameStruct {\n",r.viewMatrix&&(i+="    mat4 viewMatrix;\n"),r.vpMatrix&&(i+="    mat4 vpMatrix;\n"),i+="    vec4 cameraPosition;\n};\nuniform PerFrameStruct m_uPerFrame; \n#endif \n"),r.modelMatrix&&(i+="#if WEBGL2 && MODEL_TRANSFORM\nuniform m_bPerNode { \n    mat4 modelMatrix;\n    mat4 normalMatrix;\n} m_uPerNode; \n#endif\n#if !WEBGL2 && MODEL_TRANSFORM\nstruct PerNodeStruct {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\nuniform PerNodeStruct m_uPerNode;\n#endif\n"),r.vertexid&&(i+="uniform int m_uBaseVertexOffset; \n")):(r.viewMatrix||r.vpMatrix||r.projectionMatrix||r.mvpMatrix)&&(i+="#if WEBGL2 \nuniform m_bPerFrame { \n    mat4 viewMatrix;\n    mat4 vpMatrix;\n    vec4 cameraPosition;\n} m_uPerFrame; \n#else \nstruct PerFrameStruct {\n",r.viewMatrix&&(i+="    mat4 viewMatrix;\n"),r.vpMatrix&&(i+="    mat4 vpMatrix;\n"),i+="    vec4 cameraPosition;\n};\nuniform PerFrameStruct m_uPerFrame; \n#endif \n");for(var a="",o=e.split("\n"),s=/<([\w\d\.]+)>/g,l=0,u=o.length;l<u;l++){var c=o[l];if(c.match(/#include/g)){var h=c.match(s);if(h){var d=h[0].substring(1,h[0].length-1);"varying.inc"===d?(t&&r.normal&&(a+="    m_vNormal = normal.xyz; \n"),t&&r.position&&(a+="    m_vVertex = worldPosition.xyz; \n"),t&&r.uv&&(a+="    m_vTexCoord = uv; \n"),t&&r.vertexid&&(a+="    int objectID = gl_VertexID + m_uBaseVertexOffset; \n",a+="    m_vId = vec4( \n",a+="    float(objectID & 0xFF) / 255.0,  \n",a+="    float((objectID >> 8) & 0xFF) / 255.0,  \n",a+="    float((objectID >> 16) & 0xFF) / 255.0,  \n",a+="    float((objectID >> 24) & 0xFF) / 255.0); \n"),t&&r.color&&(a+="    m_vColor = m_aColor; \n"),t&&r.material&&(a+="    m_vMaterial = m_aMaterial;\n"),t&&r.depth&&(a+="m_vDepth = (m_uPerFrame.viewMatrix * worldPosition).z;\n")):a+=n[d]}}else a+=c+"\n"}return s=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,i+(a=a.replace(s,function(e,t,r,i){for(var n="",a=parseInt(t);a<parseInt(r);a++)n+=i.replace(/\[i\]/g,"["+a+"]");return n}))},e}();t.a=a},function(e,t,r){"use strict";var i=r(5),n=r(6),a=r(65),o=r(107),s=r.n(o).a,l=r(8);!function(e){function t(t,r){var i=e.call(this,t)||this;return i.link=r,i}Object(i.c)(t,e)}(Error);function u(e){return e.request.length<=1}function c(e){return new s(function(t){t.error(e)})}function h(e,t){var r=Object(i.a)({},e);return Object.defineProperty(t,"setContext",{enumerable:!1,value:function(e){r="function"==typeof e?Object(i.a)({},r,e(r)):Object(i.a)({},r,e)}}),Object.defineProperty(t,"getContext",{enumerable:!1,value:function(){return Object(i.a)({},r)}}),Object.defineProperty(t,"toKey",{enumerable:!1,value:function(){return function(e){var t=e.query,r=e.variables,i=e.operationName;return JSON.stringify([i,t,r])}(t)}}),t}function d(e,t){return t?t(e):s.of()}function p(e){return"function"==typeof e?new v(e):e}function f(){return new v(function(){return s.of()})}function m(e){return 0===e.length?f():e.map(p).reduce(function(e,t){return e.concat(t)})}function _(e,t,r){var i=p(t),n=p(r||new v(d));return u(i)&&u(n)?new v(function(t){return e(t)?i.request(t)||s.of():n.request(t)||s.of()}):new v(function(t,r){return e(t)?i.request(t,r)||s.of():n.request(t,r)||s.of()})}var v=function(){function e(e){e&&(this.request=e)}return e.prototype.split=function(t,r,i){return this.concat(_(t,r,i||new e(d)))},e.prototype.concat=function(e){return function(e,t){var r=p(e);if(u(r))return r;var i=p(t);return u(i)?new v(function(e){return r.request(e,function(e){return i.request(e)||s.of()})||s.of()}):new v(function(e,t){return r.request(e,function(e){return i.request(e,t)||s.of()})||s.of()})}(this,e)},e.prototype.request=function(e,t){throw new l.a(1)},e.empty=f,e.from=m,e.split=_,e.execute=y,e}();function y(e,t){return e.request(h(t.context,function(e){var t={variables:e.variables||{},extensions:e.extensions||{},operationName:e.operationName,query:e.query};return t.operationName||(t.operationName="string"!=typeof t.query?Object(n.n)(t.query):""),t}(function(e){for(var t=["query","operationName","variables","extensions","context"],r=0,i=Object.keys(e);r<i.length;r++){var n=i[r];if(t.indexOf(n)<0)throw new l.a(2)}return e}(t))))||s.of()}var g,b=r(106),w=r(30);function x(e){return e<7}!function(e){e[e.loading=1]="loading",e[e.setVariables=2]="setVariables",e[e.fetchMore=3]="fetchMore",e[e.refetch=4]="refetch",e[e.poll=6]="poll",e[e.ready=7]="ready",e[e.error=8]="error"}(g||(g={}));var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.c)(t,e),t.prototype[b.a]=function(){return this},t.prototype["@@observable"]=function(){return this},t}(s);function T(e){return Array.isArray(e)&&e.length>0}var E,S=function(e){var t="";return T(e.graphQLErrors)&&e.graphQLErrors.forEach(function(e){var r=e?e.message:"Error message not found.";t+="GraphQL error: "+r+"\n"}),e.networkError&&(t+="Network error: "+e.networkError.message+"\n"),t=t.replace(/\n$/,"")},A=function(e){function t(r){var i=r.graphQLErrors,n=r.networkError,a=r.errorMessage,o=r.extraInfo,s=e.call(this,a)||this;return s.graphQLErrors=i||[],s.networkError=n||null,s.message=a||S(s),s.extraInfo=o,s.__proto__=t.prototype,s}return Object(i.c)(t,e),t}(Error);!function(e){e[e.normal=1]="normal",e[e.refetch=2]="refetch",e[e.poll=3]="poll"}(E||(E={}));var k=function(e){function t(t){var r=t.queryManager,i=t.options,a=t.shouldSubscribe,o=void 0===a||a,s=e.call(this,function(e){return s.onSubscribe(e)})||this;s.observers=new Set,s.subscriptions=new Set,s.isTornDown=!1,s.options=i,s.variables=i.variables||{},s.queryId=r.generateQueryId(),s.shouldSubscribe=o;var l=Object(n.m)(i.query);return s.queryName=l&&l.name&&l.name.value,s.queryManager=r,s}return Object(i.c)(t,e),t.prototype.result=function(){var e=this;return new Promise(function(t,r){var i={next:function(r){t(r),e.observers.delete(i),e.observers.size||e.queryManager.removeQuery(e.queryId),setTimeout(function(){n.unsubscribe()},0)},error:r},n=e.subscribe(i)})},t.prototype.currentResult=function(){var e=this.getCurrentResult();return void 0===e.data&&(e.data={}),e},t.prototype.getCurrentResult=function(){if(this.isTornDown){var e=this.lastResult;return{data:!this.lastError&&e&&e.data||void 0,error:this.lastError,loading:!1,networkStatus:g.error}}var t,r=this.queryManager.getCurrentQueryResult(this),n=r.data,a=r.partial,o=this.queryManager.queryStore.get(this.queryId),s=this.options.fetchPolicy,l="network-only"===s||"no-cache"===s;if(o){var u=o.networkStatus;if(function(e,t){return void 0===t&&(t="none"),e&&(e.networkError||"none"===t&&T(e.graphQLErrors))}(o,this.options.errorPolicy))return{data:void 0,loading:!1,networkStatus:u,error:new A({graphQLErrors:o.graphQLErrors,networkError:o.networkError})};o.variables&&(this.options.variables=Object(i.a)(Object(i.a)({},this.options.variables),o.variables),this.variables=this.options.variables),t={data:n,loading:x(u),networkStatus:u},o.graphQLErrors&&"all"===this.options.errorPolicy&&(t.errors=o.graphQLErrors)}else{var c=l||a&&"cache-only"!==s;t={data:n,loading:c,networkStatus:c?g.loading:g.ready}}return a||this.updateLastResult(Object(i.a)(Object(i.a)({},t),{stale:!1})),Object(i.a)(Object(i.a)({},t),{partial:a})},t.prototype.isDifferentFromLastResult=function(e){var t=this.lastResultSnapshot;return!(t&&e&&t.networkStatus===e.networkStatus&&t.stale===e.stale&&Object(a.a)(t.data,e.data))},t.prototype.getLastResult=function(){return this.lastResult},t.prototype.getLastError=function(){return this.lastError},t.prototype.resetLastResults=function(){delete this.lastResult,delete this.lastResultSnapshot,delete this.lastError,this.isTornDown=!1},t.prototype.resetQueryStoreErrors=function(){var e=this.queryManager.queryStore.get(this.queryId);e&&(e.networkError=null,e.graphQLErrors=[])},t.prototype.refetch=function(e){var t=this.options.fetchPolicy;return"cache-only"===t?Promise.reject(new l.a(1)):("no-cache"!==t&&"cache-and-network"!==t&&(t="network-only"),Object(a.a)(this.variables,e)||(this.variables=Object(i.a)(Object(i.a)({},this.variables),e)),Object(a.a)(this.options.variables,this.variables)||(this.options.variables=Object(i.a)(Object(i.a)({},this.options.variables),this.variables)),this.queryManager.fetchQuery(this.queryId,Object(i.a)(Object(i.a)({},this.options),{fetchPolicy:t}),E.refetch))},t.prototype.fetchMore=function(e){var t=this;Object(l.b)(e.updateQuery,2);var r=Object(i.a)(Object(i.a)({},e.query?e:Object(i.a)(Object(i.a)(Object(i.a)({},this.options),e),{variables:Object(i.a)(Object(i.a)({},this.variables),e.variables)})),{fetchPolicy:"network-only"}),n=this.queryManager.generateQueryId();return this.queryManager.fetchQuery(n,r,E.normal,this.queryId).then(function(i){return t.updateQuery(function(t){return e.updateQuery(t,{fetchMoreResult:i.data,variables:r.variables})}),t.queryManager.stopQuery(n),i},function(e){throw t.queryManager.stopQuery(n),e})},t.prototype.subscribeToMore=function(e){var t=this,r=this.queryManager.startGraphQLSubscription({query:e.document,variables:e.variables}).subscribe({next:function(r){var i=e.updateQuery;i&&t.updateQuery(function(e,t){var n=t.variables;return i(e,{subscriptionData:r,variables:n})})},error:function(t){e.onError&&e.onError(t)}});return this.subscriptions.add(r),function(){t.subscriptions.delete(r)&&r.unsubscribe()}},t.prototype.setOptions=function(e){var t=this.options.fetchPolicy;this.options=Object(i.a)(Object(i.a)({},this.options),e),e.pollInterval?this.startPolling(e.pollInterval):0===e.pollInterval&&this.stopPolling();var r=e.fetchPolicy;return this.setVariables(this.options.variables,t!==r&&("cache-only"===t||"standby"===t||"network-only"===r),e.fetchResults)},t.prototype.setVariables=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!0),this.isTornDown=!1,e=e||this.variables,!t&&Object(a.a)(e,this.variables)?this.observers.size&&r?this.result():Promise.resolve():(this.variables=this.options.variables=e,this.observers.size?this.queryManager.fetchQuery(this.queryId,this.options):Promise.resolve())},t.prototype.updateQuery=function(e){var t=this.queryManager,r=t.getQueryWithPreviousResult(this.queryId),i=r.previousResult,a=r.variables,o=r.document,s=Object(n.I)(function(){return e(i,{variables:a})});s&&(t.dataStore.markUpdateQueryResult(o,a,s),t.broadcastQueries())},t.prototype.stopPolling=function(){this.queryManager.stopPollingQuery(this.queryId),this.options.pollInterval=void 0},t.prototype.startPolling=function(e){D(this),this.options.pollInterval=e,this.queryManager.startPollingQuery(this.options,this.queryId)},t.prototype.updateLastResult=function(e){var t=this.lastResult;return this.lastResult=e,this.lastResultSnapshot=this.queryManager.assumeImmutableResults?e:Object(n.f)(e),t},t.prototype.onSubscribe=function(e){var t=this;try{var r=e._subscription._observer;r&&!r.error&&(r.error=P)}catch(e){}var i=!this.observers.size;return this.observers.add(e),e.next&&this.lastResult&&e.next(this.lastResult),e.error&&this.lastError&&e.error(this.lastError),i&&this.setUpQuery(),function(){t.observers.delete(e)&&!t.observers.size&&t.tearDownQuery()}},t.prototype.setUpQuery=function(){var e=this,t=this.queryManager,r=this.queryId;this.shouldSubscribe&&t.addObservableQuery(r,this),this.options.pollInterval&&(D(this),t.startPollingQuery(this.options,r));var n=function(t){e.updateLastResult(Object(i.a)(Object(i.a)({},e.lastResult),{errors:t.graphQLErrors,networkStatus:g.error,loading:!1})),N(e.observers,"error",e.lastError=t)};t.observeQuery(r,this.options,{next:function(r){if(e.lastError||e.isDifferentFromLastResult(r)){var i=e.updateLastResult(r),n=e.options,o=n.query,s=n.variables,l=n.fetchPolicy;t.transform(o).hasClientExports?t.getLocalState().addExportedVariables(o,s).then(function(n){var s=e.variables;e.variables=e.options.variables=n,!r.loading&&i&&"cache-only"!==l&&t.transform(o).serverQuery&&!Object(a.a)(s,n)?e.refetch():N(e.observers,"next",r)}):N(e.observers,"next",r)}},error:n}).catch(n)},t.prototype.tearDownQuery=function(){var e=this.queryManager;this.isTornDown=!0,e.stopPollingQuery(this.queryId),this.subscriptions.forEach(function(e){return e.unsubscribe()}),this.subscriptions.clear(),e.removeObservableQuery(this.queryId),e.stopQuery(this.queryId),this.observers.clear()},t}(M);function P(e){}function N(e,t,r){var i=[];e.forEach(function(e){return e[t]&&i.push(e)}),i.forEach(function(e){return e[t](r)})}function D(e){var t=e.options.fetchPolicy;Object(l.b)("cache-first"!==t&&"cache-only"!==t,3)}var I=function(){function e(){this.store={}}return e.prototype.getStore=function(){return this.store},e.prototype.get=function(e){return this.store[e]},e.prototype.initMutation=function(e,t,r){this.store[e]={mutation:t,variables:r||{},loading:!0,error:null}},e.prototype.markMutationError=function(e,t){var r=this.store[e];r&&(r.loading=!1,r.error=t)},e.prototype.markMutationResult=function(e){var t=this.store[e];t&&(t.loading=!1,t.error=null)},e.prototype.reset=function(){this.store={}},e}(),O=function(){function e(){this.store={}}return e.prototype.getStore=function(){return this.store},e.prototype.get=function(e){return this.store[e]},e.prototype.initQuery=function(e){var t=this.store[e.queryId];Object(l.b)(!t||t.document===e.document||Object(a.a)(t.document,e.document),19);var r,i=!1,n=null;e.storePreviousVariables&&t&&t.networkStatus!==g.loading&&(Object(a.a)(t.variables,e.variables)||(i=!0,n=t.variables)),r=i?g.setVariables:e.isPoll?g.poll:e.isRefetch?g.refetch:g.loading;var o=[];t&&t.graphQLErrors&&(o=t.graphQLErrors),this.store[e.queryId]={document:e.document,variables:e.variables,previousVariables:n,networkError:null,graphQLErrors:o,networkStatus:r,metadata:e.metadata},"string"==typeof e.fetchMoreForQueryId&&this.store[e.fetchMoreForQueryId]&&(this.store[e.fetchMoreForQueryId].networkStatus=g.fetchMore)},e.prototype.markQueryResult=function(e,t,r){this.store&&this.store[e]&&(this.store[e].networkError=null,this.store[e].graphQLErrors=T(t.errors)?t.errors:[],this.store[e].previousVariables=null,this.store[e].networkStatus=g.ready,"string"==typeof r&&this.store[r]&&(this.store[r].networkStatus=g.ready))},e.prototype.markQueryError=function(e,t,r){this.store&&this.store[e]&&(this.store[e].networkError=t,this.store[e].networkStatus=g.error,"string"==typeof r&&this.markQueryResultClient(r,!0))},e.prototype.markQueryResultClient=function(e,t){var r=this.store&&this.store[e];r&&(r.networkError=null,r.previousVariables=null,t&&(r.networkStatus=g.ready))},e.prototype.stopQuery=function(e){delete this.store[e]},e.prototype.reset=function(e){var t=this;Object.keys(this.store).forEach(function(r){e.indexOf(r)<0?t.stopQuery(r):t.store[r].networkStatus=g.loading})},e}();var R=function(){function e(e){var t=e.cache,r=e.client,i=e.resolvers,n=e.fragmentMatcher;this.cache=t,r&&(this.client=r),i&&this.addResolvers(i),n&&this.setFragmentMatcher(n)}return e.prototype.addResolvers=function(e){var t=this;this.resolvers=this.resolvers||{},Array.isArray(e)?e.forEach(function(e){t.resolvers=Object(n.A)(t.resolvers,e)}):this.resolvers=Object(n.A)(this.resolvers,e)},e.prototype.setResolvers=function(e){this.resolvers={},this.addResolvers(e)},e.prototype.getResolvers=function(){return this.resolvers||{}},e.prototype.runResolvers=function(e){var t=e.document,r=e.remoteResult,n=e.context,a=e.variables,o=e.onlyRunForcedResolvers,s=void 0!==o&&o;return Object(i.b)(this,void 0,void 0,function(){return Object(i.d)(this,function(e){return t?[2,this.resolveDocument(t,r.data,n,a,this.fragmentMatcher,s).then(function(e){return Object(i.a)(Object(i.a)({},r),{data:e.result})})]:[2,r]})})},e.prototype.setFragmentMatcher=function(e){this.fragmentMatcher=e},e.prototype.getFragmentMatcher=function(){return this.fragmentMatcher},e.prototype.clientQuery=function(e){return Object(n.s)(["client"],e)&&this.resolvers?e:null},e.prototype.serverQuery=function(e){return this.resolvers?Object(n.C)(e):e},e.prototype.prepareContext=function(e){void 0===e&&(e={});var t=this.cache;return Object(i.a)(Object(i.a)({},e),{cache:t,getCacheKey:function(e){if(t.config)return t.config.dataIdFromObject(e);Object(l.b)(!1,6)}})},e.prototype.addExportedVariables=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r={}),Object(i.b)(this,void 0,void 0,function(){return Object(i.d)(this,function(n){return e?[2,this.resolveDocument(e,this.buildRootValueFromCache(e,t)||{},this.prepareContext(r),t).then(function(e){return Object(i.a)(Object(i.a)({},t),e.exportedVariables)})]:[2,Object(i.a)({},t)]})})},e.prototype.shouldForceResolvers=function(e){var t=!1;return Object(w.visit)(e,{Directive:{enter:function(e){if("client"===e.name.value&&e.arguments&&(t=e.arguments.some(function(e){return"always"===e.name.value&&"BooleanValue"===e.value.kind&&!0===e.value.value})))return w.BREAK}}}),t},e.prototype.buildRootValueFromCache=function(e,t){return this.cache.diff({query:Object(n.d)(e),variables:t,returnPartialData:!0,optimistic:!1}).result},e.prototype.resolveDocument=function(e,t,r,a,o,s){return void 0===r&&(r={}),void 0===a&&(a={}),void 0===o&&(o=function(){return!0}),void 0===s&&(s=!1),Object(i.b)(this,void 0,void 0,function(){var l,u,c,h,d,p,f,m,_;return Object(i.d)(this,function(v){return l=Object(n.l)(e),u=Object(n.j)(e),c=Object(n.g)(u),h=l.operation,d=h?function(e){return e.charAt(0).toUpperCase()+e.slice(1)}(h):"Query",f=(p=this).cache,m=p.client,_={fragmentMap:c,context:Object(i.a)(Object(i.a)({},r),{cache:f,client:m}),variables:a,fragmentMatcher:o,defaultOperationType:d,exportedVariables:{},onlyRunForcedResolvers:s},[2,this.resolveSelectionSet(l.selectionSet,t,_).then(function(e){return{result:e,exportedVariables:_.exportedVariables}})]})})},e.prototype.resolveSelectionSet=function(e,t,r){return Object(i.b)(this,void 0,void 0,function(){var a,o,s,u,c,h=this;return Object(i.d)(this,function(d){return a=r.fragmentMap,o=r.context,s=r.variables,u=[t],c=function(e){return Object(i.b)(h,void 0,void 0,function(){var c,h;return Object(i.d)(this,function(i){return Object(n.F)(e,s)?Object(n.t)(e)?[2,this.resolveField(e,t,r).then(function(t){var r;void 0!==t&&u.push(((r={})[Object(n.E)(e)]=t,r))})]:(Object(n.v)(e)?c=e:(c=a[e.name.value],Object(l.b)(c,7)),c&&c.typeCondition&&(h=c.typeCondition.name.value,r.fragmentMatcher(t,h,o))?[2,this.resolveSelectionSet(c.selectionSet,t,r).then(function(e){u.push(e)})]:[2]):[2]})})},[2,Promise.all(e.selections.map(c)).then(function(){return Object(n.B)(u)})]})})},e.prototype.resolveField=function(e,t,r){return Object(i.b)(this,void 0,void 0,function(){var a,o,s,l,u,c,h,d,p,f=this;return Object(i.d)(this,function(i){return a=r.variables,o=e.name.value,s=Object(n.E)(e),l=o!==s,u=t[s]||t[o],c=Promise.resolve(u),r.onlyRunForcedResolvers&&!this.shouldForceResolvers(e)||(h=t.__typename||r.defaultOperationType,(d=this.resolvers&&this.resolvers[h])&&(p=d[l?o:s])&&(c=Promise.resolve(p(t,Object(n.b)(e,a),r.context,{field:e,fragmentMap:r.fragmentMap})))),[2,c.then(function(t){return void 0===t&&(t=u),e.directives&&e.directives.forEach(function(e){"export"===e.name.value&&e.arguments&&e.arguments.forEach(function(e){"as"===e.name.value&&"StringValue"===e.value.kind&&(r.exportedVariables[e.value.value]=t)})}),e.selectionSet?null==t?t:Array.isArray(t)?f.resolveSubSelectedArray(e,t,r):e.selectionSet?f.resolveSelectionSet(e.selectionSet,t,r):void 0:t})]})})},e.prototype.resolveSubSelectedArray=function(e,t,r){var i=this;return Promise.all(t.map(function(t){return null===t?null:Array.isArray(t)?i.resolveSubSelectedArray(e,t,r):e.selectionSet?i.resolveSelectionSet(e.selectionSet,t,r):void 0}))},e}();function C(e){var t=new Set,r=null;return new M(function(i){return t.add(i),r=r||e.subscribe({next:function(e){t.forEach(function(t){return t.next&&t.next(e)})},error:function(e){t.forEach(function(t){return t.error&&t.error(e)})},complete:function(){t.forEach(function(e){return e.complete&&e.complete()})}}),function(){t.delete(i)&&!t.size&&r&&(r.unsubscribe(),r=null)}})}var B=Object.prototype.hasOwnProperty,L=function(){function e(e){var t=e.link,r=e.queryDeduplication,i=void 0!==r&&r,a=e.store,o=e.onBroadcast,s=void 0===o?function(){}:o,l=e.ssrMode,u=void 0!==l&&l,c=e.clientAwareness,h=void 0===c?{}:c,d=e.localState,p=e.assumeImmutableResults;this.mutationStore=new I,this.queryStore=new O,this.clientAwareness={},this.idCounter=1,this.queries=new Map,this.fetchQueryRejectFns=new Map,this.transformCache=new(n.e?WeakMap:Map),this.inFlightLinkObservables=new Map,this.pollingInfoByQueryId=new Map,this.link=t,this.queryDeduplication=i,this.dataStore=a,this.onBroadcast=s,this.clientAwareness=h,this.localState=d||new R({cache:a.getCache()}),this.ssrMode=u,this.assumeImmutableResults=!!p}return e.prototype.stop=function(){var e=this;this.queries.forEach(function(t,r){e.stopQueryNoBroadcast(r)}),this.fetchQueryRejectFns.forEach(function(e){e(new l.a(8))})},e.prototype.mutate=function(e){var t=e.mutation,r=e.variables,a=e.optimisticResponse,o=e.updateQueries,s=e.refetchQueries,u=void 0===s?[]:s,c=e.awaitRefetchQueries,h=void 0!==c&&c,d=e.update,p=e.errorPolicy,f=void 0===p?"none":p,m=e.fetchPolicy,_=e.context,v=void 0===_?{}:_;return Object(i.b)(this,void 0,void 0,function(){var e,s,c,p=this;return Object(i.d)(this,function(_){switch(_.label){case 0:return Object(l.b)(t,9),Object(l.b)(!m||"no-cache"===m,10),e=this.generateQueryId(),t=this.transform(t).document,this.setQuery(e,function(){return{document:t}}),r=this.getVariables(t,r),this.transform(t).hasClientExports?[4,this.localState.addExportedVariables(t,r,v)]:[3,2];case 1:r=_.sent(),_.label=2;case 2:return s=function(){var e={};return o&&p.queries.forEach(function(t,r){var i=t.observableQuery;if(i){var n=i.queryName;n&&B.call(o,n)&&(e[r]={updater:o[n],query:p.queryStore.get(r)})}}),e},this.mutationStore.initMutation(e,t,r),this.dataStore.markMutationInit({mutationId:e,document:t,variables:r,updateQueries:s(),update:d,optimisticResponse:a}),this.broadcastQueries(),c=this,[2,new Promise(function(o,l){var p,_;c.getObservableFromLink(t,Object(i.a)(Object(i.a)({},v),{optimisticResponse:a}),r,!1).subscribe({next:function(i){Object(n.q)(i)&&"none"===f?_=new A({graphQLErrors:i.errors}):(c.mutationStore.markMutationResult(e),"no-cache"!==m&&c.dataStore.markMutationResult({mutationId:e,result:i,document:t,variables:r,updateQueries:s(),update:d}),p=i)},error:function(t){c.mutationStore.markMutationError(e,t),c.dataStore.markMutationComplete({mutationId:e,optimisticResponse:a}),c.broadcastQueries(),c.setQuery(e,function(){return{document:null}}),l(new A({networkError:t}))},complete:function(){if(_&&c.mutationStore.markMutationError(e,_),c.dataStore.markMutationComplete({mutationId:e,optimisticResponse:a}),c.broadcastQueries(),_)l(_);else{"function"==typeof u&&(u=u(p));var t=[];T(u)&&u.forEach(function(e){if("string"==typeof e)c.queries.forEach(function(r){var i=r.observableQuery;i&&i.queryName===e&&t.push(i.refetch())});else{var r={query:e.query,variables:e.variables,fetchPolicy:"network-only"};e.context&&(r.context=e.context),t.push(c.query(r))}}),Promise.all(h?t:[]).then(function(){c.setQuery(e,function(){return{document:null}}),"ignore"===f&&p&&Object(n.q)(p)&&delete p.errors,o(p)})}}})})]}})})},e.prototype.fetchQuery=function(e,t,r,a){return Object(i.b)(this,void 0,void 0,function(){var o,s,l,u,c,h,d,p,f,m,_,v,y,g,b,w,x,M,T=this;return Object(i.d)(this,function(S){switch(S.label){case 0:return o=t.metadata,s=void 0===o?null:o,l=t.fetchPolicy,u=void 0===l?"cache-first":l,c=t.context,h=void 0===c?{}:c,d=this.transform(t.query).document,p=this.getVariables(d,t.variables),this.transform(d).hasClientExports?[4,this.localState.addExportedVariables(d,p,h)]:[3,2];case 1:p=S.sent(),S.label=2;case 2:if(t=Object(i.a)(Object(i.a)({},t),{variables:p}),_=m="network-only"===u||"no-cache"===u,m||(v=this.dataStore.getCache().diff({query:d,variables:p,returnPartialData:!0,optimistic:!1}),y=v.complete,g=v.result,_=!y||"cache-and-network"===u,f=g),b=_&&"cache-only"!==u&&"standby"!==u,Object(n.s)(["live"],d)&&(b=!0),w=this.idCounter++,x="no-cache"!==u?this.updateQueryWatch(e,d,t):void 0,this.setQuery(e,function(){return{document:d,lastRequestId:w,invalidated:!0,cancel:x}}),this.invalidate(a),this.queryStore.initQuery({queryId:e,document:d,storePreviousVariables:b,variables:p,isPoll:r===E.poll,isRefetch:r===E.refetch,metadata:s,fetchMoreForQueryId:a}),this.broadcastQueries(),b){if(M=this.fetchRequest({requestId:w,queryId:e,document:d,options:t,fetchMoreForQueryId:a}).catch(function(t){throw function(e){return e.hasOwnProperty("graphQLErrors")}(t)?t:(w>=T.getQuery(e).lastRequestId&&(T.queryStore.markQueryError(e,t,a),T.invalidate(e),T.invalidate(a),T.broadcastQueries()),new A({networkError:t}))}),"cache-and-network"!==u)return[2,M];M.catch(function(){})}return this.queryStore.markQueryResultClient(e,!b),this.invalidate(e),this.invalidate(a),this.transform(d).hasForcedResolvers?[2,this.localState.runResolvers({document:d,remoteResult:{data:f},context:h,variables:p,onlyRunForcedResolvers:!0}).then(function(r){return T.markQueryResult(e,r,t,a),T.broadcastQueries(),r})]:(this.broadcastQueries(),[2,{data:f}])}})})},e.prototype.markQueryResult=function(e,t,r,i){var n=r.fetchPolicy,a=r.variables,o=r.errorPolicy;"no-cache"===n?this.setQuery(e,function(){return{newData:{result:t.data,complete:!0}}}):this.dataStore.markQueryResult(t,this.getQuery(e).document,a,i,"ignore"===o||"all"===o)},e.prototype.queryListenerForObserver=function(e,t,r){var i=this;function n(e,t){if(r[e])try{r[e](t)}catch(e){}}return function(r,a){if(i.invalidate(e,!1),r){var o=i.getQuery(e),s=o.observableQuery,l=o.document,u=s?s.options.fetchPolicy:t.fetchPolicy;if("standby"!==u){var c=x(r.networkStatus),h=s&&s.getLastResult(),d=!(!h||h.networkStatus===r.networkStatus),p=t.returnPartialData||!a&&r.previousVariables||d&&t.notifyOnNetworkStatusChange||"cache-only"===u||"cache-and-network"===u;if(!c||p){var f=T(r.graphQLErrors),m=s&&s.options.errorPolicy||t.errorPolicy||"none";if("none"===m&&f||r.networkError)return n("error",new A({graphQLErrors:r.graphQLErrors,networkError:r.networkError}));try{var _=void 0,v=void 0;if(a)"no-cache"!==u&&"network-only"!==u&&i.setQuery(e,function(){return{newData:null}}),_=a.result,v=!a.complete;else{var y=s&&s.getLastError(),g="none"!==m&&(y&&y.graphQLErrors)!==r.graphQLErrors;if(h&&h.data&&!g)_=h.data,v=!1;else{var b=i.dataStore.getCache().diff({query:l,variables:r.previousVariables||r.variables,returnPartialData:!0,optimistic:!0});_=b.result,v=!b.complete}}var w=v&&!(t.returnPartialData||"cache-only"===u),M={data:w?h&&h.data:_,loading:c,networkStatus:r.networkStatus,stale:w};"all"===m&&f&&(M.errors=r.graphQLErrors),n("next",M)}catch(e){n("error",new A({networkError:e}))}}}}}},e.prototype.transform=function(e){var t=this.transformCache;if(!t.has(e)){var r=this.dataStore.getCache(),i=r.transformDocument(e),a=Object(n.D)(r.transformForLink(i)),o=this.localState.clientQuery(i),s=this.localState.serverQuery(a),l={document:i,hasClientExports:Object(n.r)(i),hasForcedResolvers:this.localState.shouldForceResolvers(i),clientQuery:o,serverQuery:s,defaultVars:Object(n.h)(Object(n.m)(i))},u=function(e){e&&!t.has(e)&&t.set(e,l)};u(e),u(i),u(o),u(s)}return t.get(e)},e.prototype.getVariables=function(e,t){return Object(i.a)(Object(i.a)({},this.transform(e).defaultVars),t)},e.prototype.watchQuery=function(e,t){void 0===t&&(t=!0),Object(l.b)("standby"!==e.fetchPolicy,11),e.variables=this.getVariables(e.query,e.variables),void 0===e.notifyOnNetworkStatusChange&&(e.notifyOnNetworkStatusChange=!1);var r=Object(i.a)({},e);return new k({queryManager:this,options:r,shouldSubscribe:t})},e.prototype.query=function(e){var t=this;return Object(l.b)(e.query,12),Object(l.b)("Document"===e.query.kind,13),Object(l.b)(!e.returnPartialData,14),Object(l.b)(!e.pollInterval,15),new Promise(function(r,i){var n=t.watchQuery(e,!1);t.fetchQueryRejectFns.set("query:"+n.queryId,i),n.result().then(r,i).then(function(){return t.fetchQueryRejectFns.delete("query:"+n.queryId)})})},e.prototype.generateQueryId=function(){return String(this.idCounter++)},e.prototype.stopQueryInStore=function(e){this.stopQueryInStoreNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryInStoreNoBroadcast=function(e){this.stopPollingQuery(e),this.queryStore.stopQuery(e),this.invalidate(e)},e.prototype.addQueryListener=function(e,t){this.setQuery(e,function(e){return e.listeners.add(t),{invalidated:!1}})},e.prototype.updateQueryWatch=function(e,t,r){var i=this,n=this.getQuery(e).cancel;n&&n();return this.dataStore.getCache().watch({query:t,variables:r.variables,optimistic:!0,previousResult:function(){var t=null,r=i.getQuery(e).observableQuery;if(r){var n=r.getLastResult();n&&(t=n.data)}return t},callback:function(t){i.setQuery(e,function(){return{invalidated:!0,newData:t}})}})},e.prototype.addObservableQuery=function(e,t){this.setQuery(e,function(){return{observableQuery:t}})},e.prototype.removeObservableQuery=function(e){var t=this.getQuery(e).cancel;this.setQuery(e,function(){return{observableQuery:null}}),t&&t()},e.prototype.clearStore=function(){this.fetchQueryRejectFns.forEach(function(e){e(new l.a(16))});var e=[];return this.queries.forEach(function(t,r){t.observableQuery&&e.push(r)}),this.queryStore.reset(e),this.mutationStore.reset(),this.dataStore.reset()},e.prototype.resetStore=function(){var e=this;return this.clearStore().then(function(){return e.reFetchObservableQueries()})},e.prototype.reFetchObservableQueries=function(e){var t=this;void 0===e&&(e=!1);var r=[];return this.queries.forEach(function(i,n){var a=i.observableQuery;if(a){var o=a.options.fetchPolicy;a.resetLastResults(),"cache-only"===o||!e&&"standby"===o||r.push(a.refetch()),t.setQuery(n,function(){return{newData:null}}),t.invalidate(n)}}),this.broadcastQueries(),Promise.all(r)},e.prototype.observeQuery=function(e,t,r){return this.addQueryListener(e,this.queryListenerForObserver(e,t,r)),this.fetchQuery(e,t)},e.prototype.startQuery=function(e,t,r){return this.addQueryListener(e,r),this.fetchQuery(e,t).catch(function(){}),e},e.prototype.startGraphQLSubscription=function(e){var t=this,r=e.query,i=e.fetchPolicy,a=e.variables;r=this.transform(r).document,a=this.getVariables(r,a);var o=function(e){return t.getObservableFromLink(r,{},e,!1).map(function(a){if(i&&"no-cache"===i||(t.dataStore.markSubscriptionResult(a,r,e),t.broadcastQueries()),Object(n.q)(a))throw new A({graphQLErrors:a.errors});return a})};if(this.transform(r).hasClientExports){var s=this.localState.addExportedVariables(r,a).then(o);return new M(function(e){var t=null;return s.then(function(r){return t=r.subscribe(e)},e.error),function(){return t&&t.unsubscribe()}})}return o(a)},e.prototype.stopQuery=function(e){this.stopQueryNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryNoBroadcast=function(e){this.stopQueryInStoreNoBroadcast(e),this.removeQuery(e)},e.prototype.removeQuery=function(e){this.fetchQueryRejectFns.delete("query:"+e),this.fetchQueryRejectFns.delete("fetchRequest:"+e),this.getQuery(e).subscriptions.forEach(function(e){return e.unsubscribe()}),this.queries.delete(e)},e.prototype.getCurrentQueryResult=function(e,t){void 0===t&&(t=!0);var r=e.options,i=r.variables,n=r.query,a=r.fetchPolicy,o=r.returnPartialData,s=e.getLastResult(),l=this.getQuery(e.queryId).newData;if(l&&l.complete)return{data:l.result,partial:!1};if("no-cache"===a||"network-only"===a)return{data:void 0,partial:!1};var u=this.dataStore.getCache().diff({query:n,variables:i,previousResult:s?s.data:void 0,returnPartialData:!0,optimistic:t}),c=u.result,h=u.complete;return{data:h||o?c:void 0,partial:!h}},e.prototype.getQueryWithPreviousResult=function(e){var t;if("string"==typeof e){var r=this.getQuery(e).observableQuery;Object(l.b)(r,17),t=r}else t=e;var i=t.options,n=i.variables,a=i.query;return{previousResult:this.getCurrentQueryResult(t,!1).data,variables:n,document:a}},e.prototype.broadcastQueries=function(){var e=this;this.onBroadcast(),this.queries.forEach(function(t,r){t.invalidated&&t.listeners.forEach(function(i){i&&i(e.queryStore.get(r),t.newData)})})},e.prototype.getLocalState=function(){return this.localState},e.prototype.getObservableFromLink=function(e,t,r,a){var o,s=this;void 0===a&&(a=this.queryDeduplication);var l=this.transform(e).serverQuery;if(l){var u=this.inFlightLinkObservables,c=this.link,h={query:l,variables:r,operationName:Object(n.n)(l)||void 0,context:this.prepareContext(Object(i.a)(Object(i.a)({},t),{forceFetch:!a}))};if(t=h.context,a){var d=u.get(l)||new Map;u.set(l,d);var p=JSON.stringify(r);if(!(o=d.get(p))){d.set(p,o=C(y(c,h)));var f=function(){d.delete(p),d.size||u.delete(l),m.unsubscribe()},m=o.subscribe({next:f,error:f,complete:f})}}else o=C(y(c,h))}else o=M.of({data:{}}),t=this.prepareContext(t);var _=this.transform(e).clientQuery;return _&&(o=function(e,t){return new M(function(r){var i=r.next,n=r.error,a=r.complete,o=0,s=!1,l={next:function(e){++o,new Promise(function(r){r(t(e))}).then(function(e){--o,i&&i.call(r,e),s&&l.complete()},function(e){--o,n&&n.call(r,e)})},error:function(e){n&&n.call(r,e)},complete:function(){s=!0,o||a&&a.call(r)}},u=e.subscribe(l);return function(){return u.unsubscribe()}})}(o,function(e){return s.localState.runResolvers({document:_,remoteResult:e,context:t,variables:r})})),o},e.prototype.fetchRequest=function(e){var t,r,i=this,n=e.requestId,a=e.queryId,o=e.document,s=e.options,l=e.fetchMoreForQueryId,u=s.variables,c=s.errorPolicy,h=void 0===c?"none":c,d=s.fetchPolicy;return new Promise(function(e,c){var p=i.getObservableFromLink(o,s.context,u),f="fetchRequest:"+a;i.fetchQueryRejectFns.set(f,c);var m=function(){i.fetchQueryRejectFns.delete(f),i.setQuery(a,function(e){e.subscriptions.delete(_)})},_=p.map(function(e){if(n>=i.getQuery(a).lastRequestId&&(i.markQueryResult(a,e,s,l),i.queryStore.markQueryResult(a,e,l),i.invalidate(a),i.invalidate(l),i.broadcastQueries()),"none"===h&&T(e.errors))return c(new A({graphQLErrors:e.errors}));if("all"===h&&(r=e.errors),l||"no-cache"===d)t=e.data;else{var p=i.dataStore.getCache().diff({variables:u,query:o,optimistic:!1,returnPartialData:!0}),f=p.result;(p.complete||s.returnPartialData)&&(t=f)}}).subscribe({error:function(e){m(),c(e)},complete:function(){m(),e({data:t,errors:r,loading:!1,networkStatus:g.ready,stale:!1})}});i.setQuery(a,function(e){e.subscriptions.add(_)})})},e.prototype.getQuery=function(e){return this.queries.get(e)||{listeners:new Set,invalidated:!1,document:null,newData:null,lastRequestId:1,observableQuery:null,subscriptions:new Set}},e.prototype.setQuery=function(e,t){var r=this.getQuery(e),n=Object(i.a)(Object(i.a)({},r),t(r));this.queries.set(e,n)},e.prototype.invalidate=function(e,t){void 0===t&&(t=!0),e&&this.setQuery(e,function(){return{invalidated:t}})},e.prototype.prepareContext=function(e){void 0===e&&(e={});var t=this.localState.prepareContext(e);return Object(i.a)(Object(i.a)({},t),{clientAwareness:this.clientAwareness})},e.prototype.checkInFlight=function(e){var t=this.queryStore.get(e);return t&&t.networkStatus!==g.ready&&t.networkStatus!==g.error},e.prototype.startPollingQuery=function(e,t,r){var n=this,a=e.pollInterval;if(Object(l.b)(a,18),!this.ssrMode){var o=this.pollingInfoByQueryId.get(t);o||this.pollingInfoByQueryId.set(t,o={}),o.interval=a,o.options=Object(i.a)(Object(i.a)({},e),{fetchPolicy:"network-only"});var s=function(){var e=n.pollingInfoByQueryId.get(t);e&&(n.checkInFlight(t)?u():n.fetchQuery(t,e.options,E.poll).then(u,u))},u=function(){var e=n.pollingInfoByQueryId.get(t);e&&(clearTimeout(e.timeout),e.timeout=setTimeout(s,e.interval))};r&&this.addQueryListener(t,r),u()}return t},e.prototype.stopPollingQuery=function(e){this.pollingInfoByQueryId.delete(e)},e}(),F=function(){function e(e){this.cache=e}return e.prototype.getCache=function(){return this.cache},e.prototype.markQueryResult=function(e,t,r,i,a){void 0===a&&(a=!1);var o=!Object(n.q)(e);a&&Object(n.q)(e)&&e.data&&(o=!0),!i&&o&&this.cache.write({result:e.data,dataId:"ROOT_QUERY",query:t,variables:r})},e.prototype.markSubscriptionResult=function(e,t,r){Object(n.q)(e)||this.cache.write({result:e.data,dataId:"ROOT_SUBSCRIPTION",query:t,variables:r})},e.prototype.markMutationInit=function(e){var t,r=this;e.optimisticResponse&&(t="function"==typeof e.optimisticResponse?e.optimisticResponse(e.variables):e.optimisticResponse,this.cache.recordOptimisticTransaction(function(i){var n=r.cache;r.cache=i;try{r.markMutationResult({mutationId:e.mutationId,result:{data:t},document:e.document,variables:e.variables,updateQueries:e.updateQueries,update:e.update})}finally{r.cache=n}},e.mutationId))},e.prototype.markMutationResult=function(e){var t=this;if(!Object(n.q)(e.result)){var r=[{result:e.result.data,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}],i=e.updateQueries;i&&Object.keys(i).forEach(function(a){var o=i[a],s=o.query,l=o.updater,u=t.cache.diff({query:s.document,variables:s.variables,returnPartialData:!0,optimistic:!1}),c=u.result;if(u.complete){var h=Object(n.I)(function(){return l(c,{mutationResult:e.result,queryName:Object(n.n)(s.document)||void 0,queryVariables:s.variables})});h&&r.push({result:h,dataId:"ROOT_QUERY",query:s.document,variables:s.variables})}}),this.cache.performTransaction(function(t){r.forEach(function(e){return t.write(e)});var i=e.update;i&&Object(n.I)(function(){return i(t,e.result)})})}},e.prototype.markMutationComplete=function(e){var t=e.mutationId;e.optimisticResponse&&this.cache.removeOptimistic(t)},e.prototype.markUpdateQueryResult=function(e,t,r){this.cache.write({result:r,dataId:"ROOT_QUERY",variables:t,query:e})},e.prototype.reset=function(){return this.cache.reset()},e}(),V="2.6.10",U=function(){function e(e){var t=this;this.defaultOptions={},this.resetStoreCallbacks=[],this.clearStoreCallbacks=[];var r=e.cache,i=e.ssrMode,n=void 0!==i&&i,a=e.ssrForceFetchDelay,o=void 0===a?0:a,s=e.connectToDevTools,u=e.queryDeduplication,c=void 0===u||u,h=e.defaultOptions,d=e.assumeImmutableResults,p=void 0!==d&&d,f=e.resolvers,m=e.typeDefs,_=e.fragmentMatcher,y=e.name,g=e.version,b=e.link;if(!b&&f&&(b=v.empty()),!b||!r)throw new l.a(4);this.link=b,this.cache=r,this.store=new F(r),this.disableNetworkFetches=n||o>0,this.queryDeduplication=c,this.defaultOptions=h||{},this.typeDefs=m,o&&setTimeout(function(){return t.disableNetworkFetches=!1},o),this.watchQuery=this.watchQuery.bind(this),this.query=this.query.bind(this),this.mutate=this.mutate.bind(this),this.resetStore=this.resetStore.bind(this),this.reFetchObservableQueries=this.reFetchObservableQueries.bind(this);void 0!==s&&(s&&"undefined"!=typeof window)&&(window.__APOLLO_CLIENT__=this),this.version=V,this.localState=new R({cache:r,client:this,resolvers:f,fragmentMatcher:_}),this.queryManager=new L({link:this.link,store:this.store,queryDeduplication:c,ssrMode:n,clientAwareness:{name:y,version:g},localState:this.localState,assumeImmutableResults:p,onBroadcast:function(){t.devToolsHookCb&&t.devToolsHookCb({action:{},state:{queries:t.queryManager.queryStore.getStore(),mutations:t.queryManager.mutationStore.getStore()},dataWithOptimisticResults:t.cache.extract(!0)})}})}return e.prototype.stop=function(){this.queryManager.stop()},e.prototype.watchQuery=function(e){return this.defaultOptions.watchQuery&&(e=Object(i.a)(Object(i.a)({},this.defaultOptions.watchQuery),e)),!this.disableNetworkFetches||"network-only"!==e.fetchPolicy&&"cache-and-network"!==e.fetchPolicy||(e=Object(i.a)(Object(i.a)({},e),{fetchPolicy:"cache-first"})),this.queryManager.watchQuery(e)},e.prototype.query=function(e){return this.defaultOptions.query&&(e=Object(i.a)(Object(i.a)({},this.defaultOptions.query),e)),Object(l.b)("cache-and-network"!==e.fetchPolicy,5),this.disableNetworkFetches&&"network-only"===e.fetchPolicy&&(e=Object(i.a)(Object(i.a)({},e),{fetchPolicy:"cache-first"})),this.queryManager.query(e)},e.prototype.mutate=function(e){return this.defaultOptions.mutate&&(e=Object(i.a)(Object(i.a)({},this.defaultOptions.mutate),e)),this.queryManager.mutate(e)},e.prototype.subscribe=function(e){return this.queryManager.startGraphQLSubscription(e)},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!1),this.cache.readQuery(e,t)},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!1),this.cache.readFragment(e,t)},e.prototype.writeQuery=function(e){var t=this.cache.writeQuery(e);return this.queryManager.broadcastQueries(),t},e.prototype.writeFragment=function(e){var t=this.cache.writeFragment(e);return this.queryManager.broadcastQueries(),t},e.prototype.writeData=function(e){var t=this.cache.writeData(e);return this.queryManager.broadcastQueries(),t},e.prototype.__actionHookForDevTools=function(e){this.devToolsHookCb=e},e.prototype.__requestRaw=function(e){return y(this.link,e)},e.prototype.initQueryManager=function(){return this.queryManager},e.prototype.resetStore=function(){var e=this;return Promise.resolve().then(function(){return e.queryManager.clearStore()}).then(function(){return Promise.all(e.resetStoreCallbacks.map(function(e){return e()}))}).then(function(){return e.reFetchObservableQueries()})},e.prototype.clearStore=function(){var e=this;return Promise.resolve().then(function(){return e.queryManager.clearStore()}).then(function(){return Promise.all(e.clearStoreCallbacks.map(function(e){return e()}))})},e.prototype.onResetStore=function(e){var t=this;return this.resetStoreCallbacks.push(e),function(){t.resetStoreCallbacks=t.resetStoreCallbacks.filter(function(t){return t!==e})}},e.prototype.onClearStore=function(e){var t=this;return this.clearStoreCallbacks.push(e),function(){t.clearStoreCallbacks=t.clearStoreCallbacks.filter(function(t){return t!==e})}},e.prototype.reFetchObservableQueries=function(e){return this.queryManager.reFetchObservableQueries(e)},e.prototype.extract=function(e){return this.cache.extract(e)},e.prototype.restore=function(e){return this.cache.restore(e)},e.prototype.addResolvers=function(e){this.localState.addResolvers(e)},e.prototype.setResolvers=function(e){this.localState.setResolvers(e)},e.prototype.getResolvers=function(){return this.localState.getResolvers()},e.prototype.setLocalStateFragmentMatcher=function(e){this.localState.setFragmentMatcher(e)},e}(),z=r(104),j={http:{includeQuery:!0,includeExtensions:!1},headers:{accept:"*/*","content-type":"application/json"},options:{method:"POST"}},G=function(e,t,r){var i=new Error(r);throw i.name="ServerError",i.response=e,i.statusCode=e.status,i.result=t,i},q=function(e,t){var r;try{r=JSON.stringify(e)}catch(e){var i=new l.a(2);throw i.parseError=e,i}return r},Q=function(e){void 0===e&&(e={});var t=e.uri,r=void 0===t?"/graphql":t,n=e.fetch,a=e.includeExtensions,o=e.useGETForQueries,u=Object(i.e)(e,["uri","fetch","includeExtensions","useGETForQueries"]);!function(e){if(!e&&"undefined"==typeof fetch)throw new l.a(1)}(n),n||(n=fetch);var h={http:{includeExtensions:a},options:u.fetchOptions,credentials:u.credentials,headers:u.headers};return new v(function(e){var t=function(e,t){var r=e.getContext().uri;return r||("function"==typeof t?t(e):t||"/graphql")}(e,r),a=e.getContext(),l={};if(a.clientAwareness){var u=a.clientAwareness,d=u.name,p=u.version;d&&(l["apollographql-client-name"]=d),p&&(l["apollographql-client-version"]=p)}var f,m=Object(i.a)({},l,a.headers),_={http:a.http,options:a.fetchOptions,credentials:a.credentials,headers:m},v=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=Object(i.a)({},t.options,{headers:t.headers,credentials:t.credentials}),o=t.http;r.forEach(function(e){a=Object(i.a)({},a,e.options,{headers:Object(i.a)({},a.headers,e.headers)}),e.credentials&&(a.credentials=e.credentials),o=Object(i.a)({},o,e.http)});var s=e.operationName,l=e.extensions,u=e.variables,c=e.query,h={operationName:s,variables:u};return o.includeExtensions&&(h.extensions=l),o.includeQuery&&(h.query=Object(z.print)(c)),{options:a,body:h}}(e,j,h,_),y=v.options,g=v.body;if(!y.signal){var b=function(){if("undefined"==typeof AbortController)return{controller:!1,signal:!1};var e=new AbortController;return{controller:e,signal:e.signal}}(),w=b.controller,x=b.signal;(f=w)&&(y.signal=x)}if(o&&!e.query.definitions.some(function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})&&(y.method="GET"),"GET"===y.method){var M=function(e,t){var r=[],i=function(e,t){r.push(e+"="+encodeURIComponent(t))};"query"in t&&i("query",t.query);t.operationName&&i("operationName",t.operationName);if(t.variables){var n=void 0;try{n=q(t.variables,"Variables map")}catch(e){return{parseError:e}}i("variables",n)}if(t.extensions){var a=void 0;try{a=q(t.extensions,"Extensions map")}catch(e){return{parseError:e}}i("extensions",a)}var o="",s=e,l=e.indexOf("#");-1!==l&&(o=e.substr(l),s=e.substr(0,l));var u=-1===s.indexOf("?")?"?":"&";return{newURI:s+u+r.join("&")+o}}(t,g),T=M.newURI,E=M.parseError;if(E)return c(E);t=T}else try{y.body=q(g,"Payload")}catch(E){return c(E)}return new s(function(r){return n(t,y).then(function(t){return e.setContext({response:t}),t}).then(function(e){return function(t){return t.text().then(function(e){try{return JSON.parse(e)}catch(i){var r=i;return r.name="ServerParseError",r.response=t,r.statusCode=t.status,r.bodyText=e,Promise.reject(r)}}).then(function(r){return t.status>=300&&G(t,r,"Response not successful: Received status code "+t.status),Array.isArray(r)||r.hasOwnProperty("data")||r.hasOwnProperty("errors")||G(t,r,"Server response was missing for query '"+(Array.isArray(e)?e.map(function(e){return e.operationName}):e.operationName)+"'."),r})}}(e)).then(function(e){return r.next(e),r.complete(),e}).catch(function(e){"AbortError"!==e.name&&(e.result&&e.result.errors&&e.result.data&&r.next(e.result),r.error(e))}),function(){f&&f.abort()}})})};var H=function(e){function t(t){return e.call(this,Q(t).request)||this}return Object(i.c)(t,e),t}(v);function W(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||void 0===e||null===e)return null;if(Array.isArray(e))return W(e[0]);var t=[];return Object.keys(e).forEach(function(r){var i={kind:"Field",name:{kind:"Name",value:r},selectionSet:W(e[r])||void 0};t.push(i)}),{kind:"SelectionSet",selections:t}}var Y,X={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:null,variableDefinitions:null,directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:null,name:{kind:"Name",value:"__typename"},arguments:[],directives:[],selectionSet:null}]}}]},Z=function(){function e(){}return e.prototype.transformDocument=function(e){return e},e.prototype.transformForLink=function(e){return e},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!1),this.read({query:e.query,variables:e.variables,optimistic:t})},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!1),this.read({query:Object(n.k)(e.fragment,e.fragmentName),variables:e.variables,rootId:e.id,optimistic:t})},e.prototype.writeQuery=function(e){this.write({dataId:"ROOT_QUERY",result:e.data,query:e.query,variables:e.variables})},e.prototype.writeFragment=function(e){this.write({dataId:e.id,result:e.data,variables:e.variables,query:Object(n.k)(e.fragment,e.fragmentName)})},e.prototype.writeData=function(e){var t=e.id,r=e.data;if(void 0!==t){var i=null;try{i=this.read({rootId:t,optimistic:!1,query:X})}catch(e){}var n=i&&i.__typename||"__ClientData",a=Object.assign({__typename:n},r);this.writeFragment({id:t,fragment:function(e,t){return{kind:"Document",definitions:[{kind:"FragmentDefinition",typeCondition:{kind:"NamedType",name:{kind:"Name",value:t||"__FakeType"}},name:{kind:"Name",value:"GeneratedClientQuery"},selectionSet:W(e)}]}}(a,n),data:a})}else this.writeQuery({query:function(e){return{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GeneratedClientQuery"},selectionSet:W(e)}]}}(r),data:r})},e}();Y||(Y={});var K=null,J={},$=1,ee=Array,te=ee["@wry/context:Slot"]||function(){var e=function(){function e(){this.id=["slot",$++,Date.now(),Math.random().toString(36).slice(2)].join(":")}return e.prototype.hasValue=function(){for(var e=K;e;e=e.parent)if(this.id in e.slots){var t=e.slots[this.id];if(t===J)break;return e!==K&&(K.slots[this.id]=t),!0}return K&&(K.slots[this.id]=J),!1},e.prototype.getValue=function(){if(this.hasValue())return K.slots[this.id]},e.prototype.withValue=function(e,t,r,i){var n,a=((n={__proto__:null})[this.id]=e,n),o=K;K={parent:o,slots:a};try{return t.apply(i,r)}finally{K=o}},e.bind=function(e){var t=K;return function(){var r=K;try{return K=t,e.apply(this,arguments)}finally{K=r}}},e.noContext=function(e,t,r){if(!K)return e.apply(r,t);var i=K;try{return K=null,e.apply(r,t)}finally{K=i}},e}();try{Object.defineProperty(ee,"@wry/context:Slot",{value:ee["@wry/context:Slot"]=e,enumerable:!1,writable:!1,configurable:!1})}finally{return e}}();te.bind,te.noContext;function re(){}var ie=function(){function e(e,t){void 0===e&&(e=1/0),void 0===t&&(t=re),this.max=e,this.dispose=t,this.map=new Map,this.newest=null,this.oldest=null}return e.prototype.has=function(e){return this.map.has(e)},e.prototype.get=function(e){var t=this.getEntry(e);return t&&t.value},e.prototype.getEntry=function(e){var t=this.map.get(e);if(t&&t!==this.newest){var r=t.older,i=t.newer;i&&(i.older=r),r&&(r.newer=i),t.older=this.newest,t.older.newer=t,t.newer=null,this.newest=t,t===this.oldest&&(this.oldest=i)}return t},e.prototype.set=function(e,t){var r=this.getEntry(e);return r?r.value=t:(r={key:e,value:t,newer:null,older:this.newest},this.newest&&(this.newest.newer=r),this.newest=r,this.oldest=this.oldest||r,this.map.set(e,r),r.value)},e.prototype.clean=function(){for(;this.oldest&&this.map.size>this.max;)this.delete(this.oldest.key)},e.prototype.delete=function(e){var t=this.map.get(e);return!!t&&(t===this.newest&&(this.newest=t.older),t===this.oldest&&(this.oldest=t.newer),t.newer&&(t.newer.older=t.older),t.older&&(t.older.newer=t.newer),this.map.delete(e),this.dispose(t.value,e),!0)},e}(),ne=new te,ae=[],oe=[],se=100;function le(e,t){if(!e)throw new Error(t||"assertion failure")}function ue(e){switch(e.length){case 0:throw new Error("unknown value");case 1:return e[0];case 2:throw e[1]}}var ce=function(){function e(t,r){this.fn=t,this.args=r,this.parents=new Set,this.childValues=new Map,this.dirtyChildren=null,this.dirty=!0,this.recomputing=!1,this.value=[],++e.count}return e.prototype.recompute=function(){if(le(!this.recomputing,"already recomputing"),function(e){var t=ne.getValue();if(t)return e.parents.add(t),t.childValues.has(e)||t.childValues.set(e,[]),de(e)?me(t,e):_e(t,e),t}(this)||!ye(this))return de(this)?function(e){var t=ge(e);ne.withValue(e,he,[e]),function(e){if("function"==typeof e.subscribe)try{we(e),e.unsubscribe=e.subscribe.apply(null,e.args)}catch(t){return e.setDirty(),!1}return!0}(e)&&function(e){if(e.dirty=!1,de(e))return;fe(e)}(e);return t.forEach(ye),ue(e.value)}(this):ue(this.value)},e.prototype.setDirty=function(){this.dirty||(this.dirty=!0,this.value.length=0,pe(this),we(this))},e.prototype.dispose=function(){var e=this;ge(this).forEach(ye),we(this),this.parents.forEach(function(t){t.setDirty(),be(t,e)})},e.count=0,e}();function he(e){e.recomputing=!0,e.value.length=0;try{e.value[0]=e.fn.apply(null,e.args)}catch(t){e.value[1]=t}e.recomputing=!1}function de(e){return e.dirty||!(!e.dirtyChildren||!e.dirtyChildren.size)}function pe(e){e.parents.forEach(function(t){return me(t,e)})}function fe(e){e.parents.forEach(function(t){return _e(t,e)})}function me(e,t){if(le(e.childValues.has(t)),le(de(t)),e.dirtyChildren){if(e.dirtyChildren.has(t))return}else e.dirtyChildren=oe.pop()||new Set;e.dirtyChildren.add(t),pe(e)}function _e(e,t){le(e.childValues.has(t)),le(!de(t));var r=e.childValues.get(t);0===r.length?e.childValues.set(t,function(e){return e.slice(0)}(t.value)):function(e,t){var r=e.length;return r>0&&r===t.length&&e[r-1]===t[r-1]}(r,t.value)||e.setDirty(),ve(e,t),de(e)||fe(e)}function ve(e,t){var r=e.dirtyChildren;r&&(r.delete(t),0===r.size&&(oe.length<se&&oe.push(r),e.dirtyChildren=null))}function ye(e){return 0===e.parents.size&&"function"==typeof e.reportOrphan&&!0===e.reportOrphan()}function ge(e){var t=ae;return e.childValues.size>0&&(t=[],e.childValues.forEach(function(r,i){be(e,i),t.push(i)})),le(null===e.dirtyChildren),t}function be(e,t){t.parents.delete(e),e.childValues.delete(t),ve(e,t)}function we(e){var t=e.unsubscribe;"function"==typeof t&&(e.unsubscribe=void 0,t())}var xe=function(){function e(e){this.weakness=e}return e.prototype.lookup=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.lookupArray(e)},e.prototype.lookupArray=function(e){var t=this;return e.forEach(function(e){return t=t.getChildTrie(e)}),t.data||(t.data=Object.create(null))},e.prototype.getChildTrie=function(t){var r=this.weakness&&function(e){switch(typeof e){case"object":if(null===e)break;case"function":return!0}return!1}(t)?this.weak||(this.weak=new WeakMap):this.strong||(this.strong=new Map),i=r.get(t);return i||r.set(t,i=new e(this.weakness)),i},e}();var Me=new xe("function"==typeof WeakMap);function Te(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Me.lookupArray(e)}var Ee=new Set;function Se(e,t){void 0===t&&(t=Object.create(null));var r=new ie(t.max||Math.pow(2,16),function(e){return e.dispose()}),i=!!t.disposable,n=t.makeCacheKey||Te;function a(){if(!i||ne.hasValue()){var a=n.apply(null,arguments);if(void 0===a)return e.apply(null,arguments);var o=Array.prototype.slice.call(arguments),s=r.get(a);s?s.args=o:(s=new ce(e,o),r.set(a,s),s.subscribe=t.subscribe,i&&(s.reportOrphan=function(){return r.delete(a)}));var l=s.recompute();return r.set(a,s),Ee.add(r),ne.hasValue()||(Ee.forEach(function(e){return e.clean()}),Ee.clear()),i?void 0:l}}return a.dirty=function(){var e=n.apply(null,arguments),t=void 0!==e&&r.get(e);t&&t.setDirty()},a}var Ae=!1;function ke(){var e=!Ae;return Object(n.y)()||(Ae=!0),e}var Pe=function(){function e(){}return e.prototype.ensureReady=function(){return Promise.resolve()},e.prototype.canBypassInit=function(){return!0},e.prototype.match=function(e,t,r){var i=r.store.get(e.id),n="ROOT_QUERY"===e.id;if(!i)return n;var a=i.__typename,o=void 0===a?n&&"Query":a;return o&&o===t||(ke(),"heuristic")},e}(),Ne=(function(){function e(e){e&&e.introspectionQueryResultData?(this.possibleTypesMap=this.parseIntrospectionResult(e.introspectionQueryResultData),this.isReady=!0):this.isReady=!1,this.match=this.match.bind(this)}e.prototype.match=function(e,t,r){Object(l.b)(this.isReady,1);var i=r.store.get(e.id),n="ROOT_QUERY"===e.id;if(!i)return n;var a=i.__typename,o=void 0===a?n&&"Query":a;if(Object(l.b)(o,2),o===t)return!0;var s=this.possibleTypesMap[t];return!!(o&&s&&s.indexOf(o)>-1)},e.prototype.parseIntrospectionResult=function(e){var t={};return e.__schema.types.forEach(function(e){"UNION"!==e.kind&&"INTERFACE"!==e.kind||(t[e.name]=e.possibleTypes.map(function(e){return e.name}))}),t}}(),Object.prototype.hasOwnProperty),De=function(){function e(e){var t=this;void 0===e&&(e=Object.create(null)),this.data=e,this.depend=Se(function(e){return t.data[e]},{disposable:!0,makeCacheKey:function(e){return e}})}return e.prototype.toObject=function(){return this.data},e.prototype.get=function(e){return this.depend(e),this.data[e]},e.prototype.set=function(e,t){t!==this.data[e]&&(this.data[e]=t,this.depend.dirty(e))},e.prototype.delete=function(e){Ne.call(this.data,e)&&(delete this.data[e],this.depend.dirty(e))},e.prototype.clear=function(){this.replace(null)},e.prototype.replace=function(e){var t=this;e?(Object.keys(e).forEach(function(r){t.set(r,e[r])}),Object.keys(this.data).forEach(function(r){Ne.call(e,r)||t.delete(r)})):Object.keys(this.data).forEach(function(e){t.delete(e)})},e}();function Ie(e){return new De(e)}var Oe=function(){function e(e){var t=this,r=void 0===e?{}:e,i=r.cacheKeyRoot,a=void 0===i?new xe(n.e):i,o=r.freezeResults,s=void 0!==o&&o,l=this.executeStoreQuery,u=this.executeSelectionSet,c=this.executeSubSelectedArray;this.freezeResults=s,this.executeStoreQuery=Se(function(e){return l.call(t,e)},{makeCacheKey:function(e){var t=e.query,r=e.rootValue,i=e.contextValue,n=e.variableValues,o=e.fragmentMatcher;if(i.store instanceof De)return a.lookup(i.store,t,o,JSON.stringify(n),r.id)}}),this.executeSelectionSet=Se(function(e){return u.call(t,e)},{makeCacheKey:function(e){var t=e.selectionSet,r=e.rootValue,i=e.execContext;if(i.contextValue.store instanceof De)return a.lookup(i.contextValue.store,t,i.fragmentMatcher,JSON.stringify(i.variableValues),r.id)}}),this.executeSubSelectedArray=Se(function(e){return c.call(t,e)},{makeCacheKey:function(e){var t=e.field,r=e.array,i=e.execContext;if(i.contextValue.store instanceof De)return a.lookup(i.contextValue.store,t,r,JSON.stringify(i.variableValues))}})}return e.prototype.readQueryFromStore=function(e){return this.diffQueryAgainstStore(Object(i.a)(Object(i.a)({},e),{returnPartialData:!1})).result},e.prototype.diffQueryAgainstStore=function(e){var t=e.store,r=e.query,i=e.variables,o=e.previousResult,s=e.returnPartialData,u=void 0===s||s,c=e.rootId,h=void 0===c?"ROOT_QUERY":c,d=e.fragmentMatcherFunction,p=e.config,f=Object(n.o)(r);i=Object(n.c)({},Object(n.h)(f),i);var m={store:t,dataIdFromObject:p&&p.dataIdFromObject,cacheRedirects:p&&p.cacheRedirects||{}},_=this.executeStoreQuery({query:r,rootValue:{type:"id",id:h,generated:!0,typename:"Query"},contextValue:m,variableValues:i,fragmentMatcher:d}),v=_.missing&&_.missing.length>0;return v&&!u&&_.missing.forEach(function(e){if(!e.tolerable)throw new l.a(8)}),o&&Object(a.a)(o,_.result)&&(_.result=o),{result:_.result,complete:!v}},e.prototype.executeStoreQuery=function(e){var t=e.query,r=e.rootValue,i=e.contextValue,a=e.variableValues,o=e.fragmentMatcher,s=void 0===o?Ce:o,l=Object(n.l)(t),u=Object(n.j)(t),c={query:t,fragmentMap:Object(n.g)(u),contextValue:i,variableValues:a,fragmentMatcher:s};return this.executeSelectionSet({selectionSet:l.selectionSet,rootValue:r,execContext:c})},e.prototype.executeSelectionSet=function(e){var t=this,r=e.selectionSet,a=e.rootValue,o=e.execContext,s=o.fragmentMap,u=o.contextValue,c=o.variableValues,h={result:null},d=[],p=u.store.get(a.id),f=p&&p.__typename||"ROOT_QUERY"===a.id&&"Query"||void 0;function m(e){var t;return e.missing&&(h.missing=h.missing||[],(t=h.missing).push.apply(t,e.missing)),e.result}return r.selections.forEach(function(e){var r;if(Object(n.F)(e,c))if(Object(n.t)(e)){var h=m(t.executeField(p,f,e,o));void 0!==h&&d.push(((r={})[Object(n.E)(e)]=h,r))}else{var _=void 0;if(Object(n.v)(e))_=e;else if(!(_=s[e.name.value]))throw new l.a(9);var v=_.typeCondition&&_.typeCondition.name.value,y=!v||o.fragmentMatcher(a,v,u);if(y){var g=t.executeSelectionSet({selectionSet:_.selectionSet,rootValue:a,execContext:o});"heuristic"===y&&g.missing&&(g=Object(i.a)(Object(i.a)({},g),{missing:g.missing.map(function(e){return Object(i.a)(Object(i.a)({},e),{tolerable:!0})})})),d.push(m(g))}}}),h.result=Object(n.B)(d),this.freezeResults,h},e.prototype.executeField=function(e,t,r,i){var a=i.variableValues,o=i.contextValue,s=function(e,t,r,i,a,o){o.resultKey;var s=o.directives,l=r;(i||s)&&(l=Object(n.p)(l,i,s));var u=void 0;if(e&&void 0===(u=e[l])&&a.cacheRedirects&&"string"==typeof t){var c=a.cacheRedirects[t];if(c){var h=c[r];h&&(u=h(e,i,{getCacheKey:function(e){var t=a.dataIdFromObject(e);return t&&Object(n.H)({id:t,typename:e.__typename})}}))}}if(void 0===u)return{result:u,missing:[{object:e,fieldName:l,tolerable:!1}]};Object(n.w)(u)&&(u=u.json);return{result:u}}(e,t,r.name.value,Object(n.b)(r,a),o,{resultKey:Object(n.E)(r),directives:Object(n.i)(r,a)});return Array.isArray(s.result)?this.combineExecResults(s,this.executeSubSelectedArray({field:r,array:s.result,execContext:i})):r.selectionSet?null==s.result?s:this.combineExecResults(s,this.executeSelectionSet({selectionSet:r.selectionSet,rootValue:s.result,execContext:i})):(Re(r,s.result),this.freezeResults,s)},e.prototype.combineExecResults=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.forEach(function(t){t.missing&&(e=e||[]).push.apply(e,t.missing)}),{result:t.pop().result,missing:e}},e.prototype.executeSubSelectedArray=function(e){var t,r=this,i=e.field,n=e.array,a=e.execContext;function o(e){return e.missing&&(t=t||[]).push.apply(t,e.missing),e.result}return n=n.map(function(e){return null===e?null:Array.isArray(e)?o(r.executeSubSelectedArray({field:i,array:e,execContext:a})):i.selectionSet?o(r.executeSelectionSet({selectionSet:i.selectionSet,rootValue:e,execContext:a})):(Re(i,e),e)}),this.freezeResults,{result:n,missing:t}},e}();function Re(e,t){if(!e.selectionSet&&Object(n.u)(t))throw new l.a(10)}function Ce(){return!0}var Be=function(){function e(e){void 0===e&&(e=Object.create(null)),this.data=e}return e.prototype.toObject=function(){return this.data},e.prototype.get=function(e){return this.data[e]},e.prototype.set=function(e,t){this.data[e]=t},e.prototype.delete=function(e){this.data[e]=void 0},e.prototype.clear=function(){this.data=Object.create(null)},e.prototype.replace=function(e){this.data=e||Object.create(null)},e}();var Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="WriteError",t}return Object(i.c)(t,e),t}(Error);var Fe=function(){function e(){}return e.prototype.writeQueryToStore=function(e){var t=e.query,r=e.result,i=e.store,n=void 0===i?Ie():i,a=e.variables,o=e.dataIdFromObject,s=e.fragmentMatcherFunction;return this.writeResultToStore({dataId:"ROOT_QUERY",result:r,document:t,store:n,variables:a,dataIdFromObject:o,fragmentMatcherFunction:s})},e.prototype.writeResultToStore=function(e){var t=e.dataId,r=e.result,i=e.document,a=e.store,o=void 0===a?Ie():a,s=e.variables,l=e.dataIdFromObject,u=e.fragmentMatcherFunction,c=Object(n.m)(i);try{return this.writeSelectionSetToStore({result:r,dataId:t,selectionSet:c.selectionSet,context:{store:o,processedData:{},variables:Object(n.c)({},Object(n.h)(c),s),dataIdFromObject:l,fragmentMap:Object(n.g)(Object(n.j)(i)),fragmentMatcherFunction:u}})}catch(e){throw function(e,t){var r=new Le("Error writing result to store for query:\n "+JSON.stringify(t));return r.message+="\n"+e.message,r.stack=e.stack,r}(e,i)}},e.prototype.writeSelectionSetToStore=function(e){var t=this,r=e.result,i=e.dataId,a=e.selectionSet,o=e.context,s=o.variables,u=o.store,c=o.fragmentMap;return a.selections.forEach(function(e){var a;if(Object(n.F)(e,s))if(Object(n.t)(e)){var u=Object(n.E)(e),h=r[u];if(void 0!==h)t.writeFieldToStore({dataId:i,value:h,field:e,context:o});else{var d=!1,p=!1;e.directives&&e.directives.length&&(d=e.directives.some(function(e){return e.name&&"defer"===e.name.value}),p=e.directives.some(function(e){return e.name&&"client"===e.name.value})),!d&&!p&&o.fragmentMatcherFunction}}else{var f=void 0;Object(n.v)(e)?f=e:(f=(c||{})[e.name.value],Object(l.b)(f,3));var m=!0;if(o.fragmentMatcherFunction&&f.typeCondition){var _=i||"self",v=Object(n.H)({id:_,typename:void 0}),y={store:new Be((a={},a[_]=r,a)),cacheRedirects:{}},g=o.fragmentMatcherFunction(v,f.typeCondition.name.value,y);Object(n.x)(),m=!!g}m&&t.writeSelectionSetToStore({result:r,selectionSet:f.selectionSet,dataId:i,context:o})}}),u},e.prototype.writeFieldToStore=function(e){var t,r,o,s=e.field,u=e.value,c=e.dataId,h=e.context,d=h.variables,p=h.dataIdFromObject,f=h.store,m=Object(n.G)(s,d);if(s.selectionSet&&null!==u)if(Array.isArray(u)){var _=c+"."+m;r=this.processArrayValue(u,_,s.selectionSet,h)}else{var v=c+"."+m,y=!0;if(Ve(v)||(v="$"+v),p){var g=p(u);Object(l.b)(!g||!Ve(g),4),(g||"number"==typeof g&&0===g)&&(v=g,y=!1)}Ue(v,s,h.processedData)||this.writeSelectionSetToStore({dataId:v,result:u,selectionSet:s.selectionSet,context:h});var b=u.__typename;r=Object(n.H)({id:v,typename:b},y);var w=(o=f.get(c))&&o[m];if(w!==r&&Object(n.u)(w)){var x=void 0!==w.typename,M=void 0!==b,T=x&&M&&w.typename!==b;Object(l.b)(!y||w.generated||T,5),Object(l.b)(!x||M,6),w.generated&&(T?y||f.delete(w.id):function e(t,r,o){if(t===r)return!1;var s=o.get(t);var l=o.get(r);var u=!1;Object.keys(s).forEach(function(t){var r=s[t],i=l[t];Object(n.u)(r)&&Ve(r.id)&&Object(n.u)(i)&&!Object(a.a)(r,i)&&e(r.id,i.id,o)&&(u=!0)});o.delete(t);var c=Object(i.a)(Object(i.a)({},s),l);if(Object(a.a)(c,l))return u;o.set(r,c);return!0}(w.id,r.id,f))}}else r=null!=u&&"object"==typeof u?{type:"json",json:u}:u;(o=f.get(c))&&Object(a.a)(r,o[m])||f.set(c,Object(i.a)(Object(i.a)({},o),((t={})[m]=r,t)))},e.prototype.processArrayValue=function(e,t,r,i){var a=this;return e.map(function(e,o){if(null===e)return null;var s=t+"."+o;if(Array.isArray(e))return a.processArrayValue(e,s,r,i);var l=!0;if(i.dataIdFromObject){var u=i.dataIdFromObject(e);u&&(s=u,l=!1)}return Ue(s,r,i.processedData)||a.writeSelectionSetToStore({dataId:s,result:e,selectionSet:r,context:i}),Object(n.H)({id:s,typename:e.__typename},l)})},e}();function Ve(e){return"$"===e[0]}function Ue(e,t,r){if(!r)return!1;if(r[e]){if(r[e].indexOf(t)>=0)return!0;r[e].push(t)}else r[e]=[t];return!1}var ze={fragmentMatcher:new Pe,dataIdFromObject:function(e){if(e.__typename){if(void 0!==e.id)return e.__typename+":"+e.id;if(void 0!==e._id)return e.__typename+":"+e._id}return null},addTypename:!0,resultCaching:!0,freezeResults:!1};var je=Object.prototype.hasOwnProperty,Ge=function(e){function t(t,r,i){var n=e.call(this,Object.create(null))||this;return n.optimisticId=t,n.parent=r,n.transaction=i,n}return Object(i.c)(t,e),t.prototype.toObject=function(){return Object(i.a)(Object(i.a)({},this.parent.toObject()),this.data)},t.prototype.get=function(e){return je.call(this.data,e)?this.data[e]:this.parent.get(e)},t}(Be),qe=function(e){function t(t){void 0===t&&(t={});var r=e.call(this)||this;r.watches=new Set,r.typenameDocumentCache=new Map,r.cacheKeyRoot=new xe(n.e),r.silenceBroadcast=!1,r.config=Object(i.a)(Object(i.a)({},ze),t),r.config.customResolvers&&(r.config.cacheRedirects=r.config.customResolvers),r.config.cacheResolvers&&(r.config.cacheRedirects=r.config.cacheResolvers),r.addTypename=!!r.config.addTypename,r.data=r.config.resultCaching?new De:new Be,r.optimisticData=r.data,r.storeWriter=new Fe,r.storeReader=new Oe({cacheKeyRoot:r.cacheKeyRoot,freezeResults:t.freezeResults});var a=r,o=a.maybeBroadcastWatch;return r.maybeBroadcastWatch=Se(function(e){return o.call(r,e)},{makeCacheKey:function(e){if(!e.optimistic&&!e.previousResult)return a.data instanceof De?a.cacheKeyRoot.lookup(e.query,JSON.stringify(e.variables)):void 0}}),r}return Object(i.c)(t,e),t.prototype.restore=function(e){return e&&this.data.replace(e),this},t.prototype.extract=function(e){return void 0===e&&(e=!1),(e?this.optimisticData:this.data).toObject()},t.prototype.read=function(e){if("string"==typeof e.rootId&&void 0===this.data.get(e.rootId))return null;var t=this.config.fragmentMatcher,r=t&&t.match;return this.storeReader.readQueryFromStore({store:e.optimistic?this.optimisticData:this.data,query:this.transformDocument(e.query),variables:e.variables,rootId:e.rootId,fragmentMatcherFunction:r,previousResult:e.previousResult,config:this.config})||null},t.prototype.write=function(e){var t=this.config.fragmentMatcher,r=t&&t.match;this.storeWriter.writeResultToStore({dataId:e.dataId,result:e.result,variables:e.variables,document:this.transformDocument(e.query),store:this.data,dataIdFromObject:this.config.dataIdFromObject,fragmentMatcherFunction:r}),this.broadcastWatches()},t.prototype.diff=function(e){var t=this.config.fragmentMatcher,r=t&&t.match;return this.storeReader.diffQueryAgainstStore({store:e.optimistic?this.optimisticData:this.data,query:this.transformDocument(e.query),variables:e.variables,returnPartialData:e.returnPartialData,previousResult:e.previousResult,fragmentMatcherFunction:r,config:this.config})},t.prototype.watch=function(e){var t=this;return this.watches.add(e),function(){t.watches.delete(e)}},t.prototype.evict=function(e){throw new l.a(7)},t.prototype.reset=function(){return this.data.clear(),this.broadcastWatches(),Promise.resolve()},t.prototype.removeOptimistic=function(e){for(var t=[],r=0,i=this.optimisticData;i instanceof Ge;)i.optimisticId===e?++r:t.push(i),i=i.parent;if(r>0){for(this.optimisticData=i;t.length>0;){var n=t.pop();this.performTransaction(n.transaction,n.optimisticId)}this.broadcastWatches()}},t.prototype.performTransaction=function(e,t){var r=this.data,i=this.silenceBroadcast;this.silenceBroadcast=!0,"string"==typeof t&&(this.data=this.optimisticData=new Ge(t,this.optimisticData,e));try{e(this)}finally{this.silenceBroadcast=i,this.data=r}this.broadcastWatches()},t.prototype.recordOptimisticTransaction=function(e,t){return this.performTransaction(e,t)},t.prototype.transformDocument=function(e){if(this.addTypename){var t=this.typenameDocumentCache.get(e);return t||(t=Object(n.a)(e),this.typenameDocumentCache.set(e,t),this.typenameDocumentCache.set(t,t)),t}return e},t.prototype.broadcastWatches=function(){var e=this;this.silenceBroadcast||this.watches.forEach(function(t){return e.maybeBroadcastWatch(t)})},t.prototype.maybeBroadcastWatch=function(e){e.callback(this.diff({query:e.query,variables:e.variables,previousResult:e.previousResult&&e.previousResult(),optimistic:e.optimistic}))},t}(Z);function Qe(e){return new v(function(t,r){return new s(function(i){var n,a,o;try{n=r(t).subscribe({next:function(n){n.errors&&(o=e({graphQLErrors:n.errors,response:n,operation:t,forward:r}))?a=o.subscribe({next:i.next.bind(i),error:i.error.bind(i),complete:i.complete.bind(i)}):i.next(n)},error:function(n){(o=e({operation:t,networkError:n,graphQLErrors:n&&n.result&&n.result.errors,forward:r}))?a=o.subscribe({next:i.next.bind(i),error:i.error.bind(i),complete:i.complete.bind(i)}):i.error(n)},complete:function(){o||i.complete.bind(i)()}})}catch(n){e({networkError:n,operation:t,forward:r}),i.error(n)}return function(){n&&n.unsubscribe(),a&&n.unsubscribe()}})})}!function(e){function t(t){var r=e.call(this)||this;return r.link=Qe(t),r}Object(i.c)(t,e),t.prototype.request=function(e,t){return this.link.request(e,t)}}(v);var He=r(39);r.d(t,"a",function(){return Xe});var We=function(){return(We=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Ye={},Xe=function(){if(Ye.gqlClient)return Ye.gqlClient;var e=new H({uri:He.a.endpoint+"/graphql"}),t=Qe(function(e){var t=e.graphQLErrors,r=(e.networkError,e.operation),i=e.response;t&&/Expected type \"Id\"/.test(t[0].message)&&(i.errors=[Error("model id is not valid")]),"InitElementProperty"===r.operationName&&t&&t[0]&&"property already exist"===t[0].message&&(i.errors=[Error("element Status cannot be initialized multiple times")])}),r=new v(function(e,t){var r={"x-access-token":He.a.appToken};return He.a.headers&&(r=We(We({},He.a.headers),r)),e.setContext({headers:r}),t(e)}),i=new U({link:v.from([t,r,e]),cache:new qe,defaultOptions:{watchQuery:{fetchPolicy:"cache-and-network",errorPolicy:"all"},query:{fetchPolicy:"network-only",errorPolicy:"all"},mutate:{errorPolicy:"all"}}});return Ye.gqlClient=i,i}},function(e,t,r){"use strict";var i=r(3),n=r(51),a=r(0),o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=function(){function e(t,r,i,o,s,l){if(this._id=0,this._id=e._totalNumber++,this.mesh=t,this.material=i,this.shader=r,this.transform=new n.a(o),this.worldTransform=new n.a(o),this.initMatrix=a.a.create(),this._parent=null,this._dirty=!1,this.name=l||"",this.faceCamera=!1,this.visible=!0,this.bbox=null,this.bsphere=null,this.distance=0,this.nodes=[],this.hidables=-1,this.originalMaterial=null,this.minVertexBits=0,this.material){var u=this.material.attachShader(this.shader,this.mesh.getManager());this.shader=this.shader||u}s&&this.setBbox(s)}return e.prototype.dump=function(){console.groupCollapsed("Drawable: "+this._id),console.log("material: ",this.material),console.log("nodes: ",this.nodes),console.log("mesh: ",this.mesh),console.log("shader: ",this.shader),console.log("transform: ",this.transform),console.log("worldTransform: ",this.worldTransform),console.log("skeleton: ",this.skeleton),console.log("faceCamera: "+this.faceCamera),console.log("visible: "+this.visible),console.log("bbox: "+this.bbox),console.log("bsphere: "+this.bsphere),console.log("originBBox: "+this.originBBox),console.log("_dirty: "+this._dirty),console.log("distance: "+this.distance),console.groupEnd()},e.prototype.dumpVisibility=function(){console.log("drawable<"+this._id+">: "+(this.visible?"shown":"hidden")),this.nodes.forEach(function(e){return console.log("node<"+e.id+">: "+(e.isVisible()?"shown":"hidden"))})},e.prototype.destroy=function(){this.transform.destroy(),this.transform=null,delete this.transform,this.worldTransform.destroy(),this.worldTransform=null,delete this.worldTransform,this.bbox=null,delete this.bbox,this.bsphere=null,delete this.bsphere,this.mesh=null,delete this.mesh,this.material=null,delete this.material,this.originalMaterial=null,delete this.originalMaterial,this.nodes=null,delete this.nodes},e.prototype.setBbox=function(e){this.bbox=i.a.aabb.createFromArray(e),this.bsphere=i.a.sphere.createFromAABB(this.bbox);var t=a.a.create();a.a.invert(t,this.transform.matrix),this.initMatrix[12]=(this.bbox[0]+this.bbox[3])/2,this.initMatrix[13]=(this.bbox[1]+this.bbox[4])/2,this.initMatrix[14]=(this.bbox[2]+this.bbox[5])/2,this.originBBox=i.a.aabb.create(),i.a.aabb.transform(this.originBBox,this.bbox,t)},e.prototype.isShadowCaster=function(){return(!this.material.transparent||this.material.parameters.hasOwnProperty("uMaterialDiffuseTexture"))&&this.mesh.isTriangle()},e.prototype.setShader=function(e){this.shader!==e&&(this.shader=e,this.material.attachShader(e))},e.prototype.setParent=function(e){this._parent=e},e.prototype.setTranslation=function(e,t,r){this.transform.setTranslation(e,t,r),this.updateBBox(),this.recompileShader("MODEL_TRANSFORM",!this.transform.identity)},e.prototype.translate=function(e,t,r){this.transform.translate(e,t,r),this.bbox[0]+=e,this.bbox[1]+=t,this.bbox[2]+=r,this.bbox[3]+=e,this.bbox[4]+=t,this.bbox[5]+=r,this.bsphere[0]+=e,this.bsphere[1]+=t,this.bsphere[2]+=r,this.recompileShader("MODEL_TRANSFORM",!this.transform.identity)},e.prototype.setScaling=function(e,t,r){var i=this.transform.getScaling();this.transform.setScaling(e,t,r);var n=.5*(this.bbox[3]+this.bbox[0]),a=.5*(this.bbox[4]+this.bbox[1]),o=.5*(this.bbox[5]+this.bbox[2]),s=e/i[0]*(this.bbox[3]-this.bbox[0])*.5,l=t/i[1]*(this.bbox[4]-this.bbox[1])*.5,u=r/i[2]*(this.bbox[5]-this.bbox[2])*.5;this.bbox[0]=n-s,this.bbox[1]=a-l,this.bbox[2]=o-u,this.bbox[3]=n+s,this.bbox[4]=a+l,this.bbox[5]=o+u,this.bsphere[3]=Math.sqrt(s*s+l*l+u*u)},e.prototype.multiply=function(e){a.d.transformMat4(this.bsphere,this.bsphere,e),this.transform.multiply(e),this.updateBBox()},e.prototype.setTransformMatrix=function(e){this.transform.setTransform(e),this.updateBBox()},e.prototype.setTransform=function(e){var t=a.a.create(),r=a.a.create();a.a.invert(t,this.initMatrix),a.a.multiply(r,e,t),this.setTransformMatrix(r)},e.prototype.setWorldMatrix=function(e){this.transform.set(e),this.updateBBox()},e.prototype.recompileShader=function(e,t){var r,i=this.shader.flags.lastIndexOf(e),n=!1;if(t?-1===i&&(r=this.shader.flags.concat(e),n=!0):-1!==i&&((r=this.shader.flags.slice(0)).splice(i,1),n=!0),n){var a=this.shader.shaderSource.name,o=this.shader.getManager().getShader(a,r);if(!o.ready&&(o.createFromShaderSource(this.shader.shaderSource,r),!o.ready))throw new Error("Failed to create shader '"+a+"'!");this.shader=o,this.material.attachShader(this.shader)}},e.prototype._onlyHasOneNode=function(){return 1===this.nodes.length},e.prototype._allNodesHasSameVisibilty=function(){var e,t,r=this.nodes[0].isVisible();try{for(var i=o(this.nodes),n=i.next();!n.done;n=i.next()){if(r!==n.value.isVisible())return!1}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return!0},e.prototype._updateVisibilityAccordingNodes=function(e){void 0===e&&(e=!1),this.visible=this.nodes[0].isVisible();var t=this.nodes[0].clonedDrawable;t&&e&&(t.visible=this.visible)},e.prototype.changeVisibilityAttributeOfNodeVertices=function(){var e,t,r=this._getVerticesCount(),i=this._getBufferOffset(),n=0,a=new Uint8Array(r);try{for(var s=o(this.nodes),l=s.next();!l.done;l=s.next()){var u=l.value;a.fill(u.getPlatteIndex(),n,n+u.verticesCount),n+=u.verticesCount}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}this.mesh.vbSubData(i,a)},e.prototype.updateVisibility=function(e,t){if(void 0===e&&(e=!0),void 0===t&&(t=!1),this._onlyHasOneNode())return this._updateVisibilityAccordingNodes(t),void(e&&this.recompileShader("VISIBILITY",!1));this.visible=!0,this.changeVisibilityAttributeOfNodeVertices(),e&&this.recompileShader("VISIBILITY",!0)},e.prototype.updateColor=function(){var e,t,r=!1;try{for(var i=o(this.nodes),n=i.next();!n.done;n=i.next()){if(r=n.value.usePlatte())break}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.recompileShader("USE_PLATTE",r),r&&this._uploadPlatteIndices()},e.prototype._uploadPlatteIndices=function(){this.mesh.vbSubData(this._getBufferOffset(),this._getPlatteIndices())},e.prototype._getVerticesCount=function(){var e,t,r=0;try{for(var i=o(this.nodes),n=i.next();!n.done;n=i.next()){r+=n.value.verticesCount}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},e.prototype._getBufferOffset=function(){return this._getVerticesCount()*this.mesh.attributes.values[0].stride},e.prototype._getPlatteIndices=function(){var e,t,r=this._getVerticesCount(),i=new Uint8Array(r),n=0;try{for(var a=o(this.nodes),s=a.next();!s.done;s=a.next()){var l=s.value;i.fill(l.getPlatteIndex(),n,n+l.verticesCount),n+=l.verticesCount}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return i},e.prototype.updateTransformMatrix=function(){this._dirty&&this.worldTransform.multiply(this._parent)},e.prototype.render=function(e,t,r){this.transform.use(e,t),this.skeleton&&this.skeleton.use(t),this.popLodInfo&&this._preparePop(e,t,r),this.mesh.renderSub(r[0],r[1])},e.prototype._preparePop=function(e,t,r){var i=this.shader.getManager().gl,n=Math.ceil(Math.log2(960*this.bsphere[3]*e._invTanFov/a.d.distance(this.bsphere,e.eye))-1);n=this.minVertexBits-n;for(var o=0,s=0;s<this.popLodInfo.lod.length;s++){var l=this.popLodInfo.lod[s];if(l.level<n){r[1]=l.indexLength,o=l.level;break}}t.reservedUniforms["m_uPopParams.vertexConstant"]&&t.reservedUniforms["m_uPopParams.vertexConstant"].upload(this.popLodInfo.vertexConstant,i),t.reservedUniforms["m_uPopParams.vertexGridSize"]&&t.reservedUniforms["m_uPopParams.vertexGridSize"].upload(this.popLodInfo.gridSize,i),t.reservedUniforms["m_uPopParams.powPrecision"]&&t.reservedUniforms["m_uPopParams.powPrecision"].upload(Math.pow(2,o),i)},e.prototype.updateBBox=function(){i.a.aabb.transform(this.bbox,this.originBBox,this.transform.matrix),this.bsphere=i.a.sphere.createFromAABB(this.bbox)},e.prototype.getWorldMatrix=function(){return this.worldTransform.matrix},e.prototype.getTransformMatrix=function(){return this.transform.matrix},e.prototype.getTransformArray=function(){var e=[];return e=e.concat(this.transform.matrix)},e.prototype.clone=function(){var t=new e(this.mesh,this.shader,this.material.clone(this.material.name+"-cloned"),this.transform.matrix,this.bbox);return t.faceCamera=this.faceCamera,t.bsphere=this.bsphere,t.distance=this.distance,t.nodes=this.nodes,t.hidables=this.hidables,t.originalMaterial=this.originalMaterial,t},e.prototype.show=function(){this.visible=!0},e.prototype.hide=function(){this.visible=!1},e.prototype.isSingleton=function(){return 1===this.nodes.length},e.prototype.isMerged=function(){return this.nodes.length>1},e.prototype.isLine=function(){return this.mesh.isLine()},e.prototype.isTriangle=function(){return this.mesh.isTriangle()},e.prototype.setId=function(e){this._id=e},e.prototype.getId=function(){return this._id},e._totalNumber=0,e}();t.a=s},function(e,t,r){"use strict";var i=r(1),n=r(0),a=r(55),o=new Float32Array([0,0,0,0]),s=new Float32Array([0,0,0,0]),l=new Array(5),u=function(){function e(e){if(this.enabledCull=!1,arguments.length<1)throw new Error("BaseCamera requires viewport.");this._at=[0,0,0],this._theta=Math.PI,this._phi=0,this._distance=15,this._firstPerson=!1,this._fov=46,this._invTanFov=1/Math.tan(.00872665*this._fov),this._znear=.1,this._zfar=1e3,this._perspective=!0,this._twoPointsPerpective=!1,this._yVanishFactor=n.e.create(),this._height=1,this.viewport=n.e.create(),this.viewMatrix=n.a.create(),this.projectMatrix=n.a.create(),this.vpMatrix=n.a.create(),this.eye=new Float32Array([15,0,0,1]),this.viewport[0]=e[0],this.viewport[1]=e[1],this.viewport[2]=e[2],this.viewport[3]=e[3],e[3]<1&&(e[3]=1),this._aspect=e[2]/e[3],n.a.perspective(this.projectMatrix,this._fov*Math.PI/180,this._aspect,this._znear,this._zfar),n.a.identity(this.viewMatrix),this._frustumCull=new a.a(this),this.enabledCull=!1,this.uniformBlock=new Float32Array(36)}return e.prototype.destroy=function(){this.viewport=null,delete this.viewport,this.viewMatrix=null,delete this.viewMatrix,this.projectMatrix=null,delete this.projectMatrix,this.vpMatrix=null,delete this.vpMatrix,this._at=null,delete this._at,this.eye=null,delete this.eye},e.prototype.update=function(e,t,r){var i,a,o=Math.sin(this._phi),s=Math.cos(this._phi),l=Math.sin(this._theta),u=Math.cos(this._theta),c=this.viewMatrix;c[2]=s*u,c[6]=s*l,this._yVanishFactor[2]=o,this._firstPerson&&(c[2]=-c[2],c[6]=-c[6],this._yVanishFactor[2]=-this._yVanishFactor[2]),Math.abs(this._phi)>=.499999*Math.PI?(c[0]=u*this._yVanishFactor[2],c[4]=l*this._yVanishFactor[2],this._yVanishFactor[0]=-l*c[6]-u*c[2]):(c[0]=-c[6],c[4]=c[2],this._yVanishFactor[0]=0),(i=this._length(c[0],c[4],this._yVanishFactor[0]))>0&&(a=1/i,c[0]*=a,c[4]*=a,this._yVanishFactor[0]*=a),c[1]=-this._yVanishFactor[2]*c[4],c[5]=this._yVanishFactor[2]*c[0],this._yVanishFactor[1]=c[2]*c[4]-c[6]*c[0],(i=this._length(c[1],c[5],this._yVanishFactor[1]))>0&&(a=1/i,c[1]*=a,c[5]*=a,this._yVanishFactor[1]*=a),this._twoPointsPerpective?(c[8]=0,c[9]=1,c[10]=0,c[11]=0):(c[8]=this._yVanishFactor[0],c[9]=this._yVanishFactor[1],c[10]=this._yVanishFactor[2],c[11]=this._yVanishFactor[3]),this._firstPerson?(this._at[0]=this.eye[0]-c[2]*this._distance,this._at[1]=this.eye[1]-c[6]*this._distance,this._at[2]=this.eye[2]-this._yVanishFactor[2]*this._distance):(this.eye[0]=this._at[0]+c[2]*this._distance,this.eye[1]=this._at[1]+c[6]*this._distance,this.eye[2]=this._at[2]+this._yVanishFactor[2]*this._distance),c[12]=-(c[0]*this.eye[0]+c[4]*this.eye[1]+c[8]*this.eye[2]),c[13]=-(c[1]*this.eye[0]+c[5]*this.eye[1]+c[9]*this.eye[2]),c[14]=-(c[2]*this.eye[0]+c[6]*this.eye[1]+c[10]*this.eye[2]),n.a.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},e.prototype.cull=function(e,t){return!!this.enabledCull&&this._frustumCull.isCulled(e)},e.prototype.cullUpdate=function(e){this._frustumCull.update(e)},e.prototype.setViewport=function(e){var t=e[2],r=e[3];if((t>8192||r>8192)&&(t>=r?(r=Math.floor(8192*r/t),t=8192):(t=Math.floor(8192*t/r),r=8192)),r<1&&(r=1),e[0]!==this.viewport[0]||e[1]!==this.viewport[1]||t!==this.viewport[2]||r!==this.viewport[3]){if(this.viewport[0]=e[0],this.viewport[1]=e[1],this.viewport[2]=t,this.viewport[3]=r,r<1&&(r=1),this._aspect=t/r,this._perspective)this.projectMatrix[0]=this._invTanFov/this._aspect,this.projectMatrix[5]=this._invTanFov;else{var i=this._height*this._aspect,a=this._height;this.projectMatrix[0]=2/i,this.projectMatrix[5]=2/a}n.a.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)}},e.prototype.isPerspective=function(){return this._perspective},e.prototype.setPerspective=function(e){if(this._perspective!==e){if(this._perspective=e,this._perspective)this.projectMatrix[1]=this.projectMatrix[2]=this.projectMatrix[3]=this.projectMatrix[4]=this.projectMatrix[6]=this.projectMatrix[7]=this.projectMatrix[8]=this.projectMatrix[9]=this.projectMatrix[12]=this.projectMatrix[13]=this.projectMatrix[15]=0,this.projectMatrix[11]=-1,this.projectMatrix[0]=this._invTanFov/this._aspect,this.projectMatrix[5]=this._invTanFov;else{this.projectMatrix[1]=this.projectMatrix[2]=this.projectMatrix[3]=this.projectMatrix[4]=this.projectMatrix[6]=this.projectMatrix[7]=this.projectMatrix[8]=this.projectMatrix[9]=this.projectMatrix[11]=0,this.projectMatrix[12]=0,this.projectMatrix[13]=0,this.projectMatrix[15]=1;var t=this._height*this._aspect,r=this._height;this.projectMatrix[0]=2/t,this.projectMatrix[5]=2/r}n.a.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)}},e.prototype._setFov=function(e){this._fov!==e&&(this._fov=e,this._invTanFov=1/Math.tan(.00872665*this._fov),this._perspective&&(this.projectMatrix[0]=this._invTanFov/this._aspect,this.projectMatrix[5]=this._invTanFov))},e.prototype._setHeight=function(e){if(this._height!==e&&(this._height=e,!this._perspective)){var t=this._height*this._aspect,r=this._height;this.projectMatrix[0]=2/t,this.projectMatrix[5]=2/r}},e.prototype._updateProjection=function(e,t){var r;this._znear=e||this._znear,this._zfar=t||this._zfar,this._perspective?(r=1/(this._znear-this._zfar),this.projectMatrix[10]=(this._zfar+this._znear)*r,this.projectMatrix[14]=2*this._zfar*this._znear*r):(r=1/(this._znear-this._zfar),this.projectMatrix[10]=2*r,this.projectMatrix[14]=(this._znear+this._zfar)*r),n.a.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},e.prototype.reset=function(e,t){this._firstPerson=!1,this._theta=Math.PI,this._phi=0,this._distance=15,this._fov=46,this._invTanFov=1/Math.tan(.00872665*this._fov),this._perspective=!0,n.a.perspective(this.projectMatrix,this._fov*Math.PI/180,this._aspect,this._znear,this._zfar),this._at[0]=0,this._at[1]=0,this._at[2]=0,this.eye[0]=-this._distance,this.eye[1]=0,this.eye[2]=0},e.prototype.resetDefaultCam=function(){if(this._defaultCameraInfo.height&&!this._defaultCameraInfo.fov)return console.warn("Reset camera info can't be ortho."),!1;this._firstPerson=!1;var e=this._defaultCameraInfo.phi;e>=.49999*Math.PI&&(e=.49999*Math.PI),e<=-.49999*Math.PI&&(e=-.49999*Math.PI);var t=this._defaultCameraInfo.theta;(t%=2*Math.PI)>Math.PI?t-=2*Math.PI:t<-Math.PI&&(t+=2*Math.PI),this._theta=t,this._phi=e,this._distance=this._defaultCameraInfo.distance,this._fov=this._defaultCameraInfo.fov,this._invTanFov=1/Math.tan(.00872665*this._fov),this._perspective=!0,this._at=this._defaultCameraInfo.at;var r=Math.sin(this._phi),i=Math.cos(this._phi),n=Math.sin(this._theta),a=Math.cos(this._theta);this.eye[0]=this._at[0]+i*a*this._distance,this.eye[1]=this._at[1]+i*n*this._distance,this.eye[2]=this._at[2]+r*this._distance,this._updateProjection();if(this._defaultCameraInfo.theta-this._targetTheta<1e-4&&this._defaultCameraInfo.phi-this._targetPhi<1e-4&&this._defaultCameraInfo.distance-this._targetDistance<1e-4){var o=this._defaultCameraInfo.at[0]-this._targetAt[0],s=this._defaultCameraInfo.at[1]-this._targetAt[1],l=this._defaultCameraInfo.at[2]-this._targetAt[2];Math.sqrt(o*o+s*s+l*l)<=1e-4&&(this._distance+=3*1e-4)}return!0},e.prototype.unproject=function(e,t,r){var n=[0,0,0],a=[0,0,0];e=Math.floor(e*i.a.devicePixelRatio),t=Math.floor(t*i.a.devicePixelRatio);var o,s=this.viewport[2]-this.viewport[0],l=this.viewport[3]-this.viewport[1];o=void 0!==r?r:this._znear;var u,c,h=e/s*2-1,d=(l-1-t)/l*2-1;return this._perspective?(u=h*o/this.projectMatrix[0],c=d*o/this.projectMatrix[5]):(u=(h-this.projectMatrix[12])/this.projectMatrix[0],c=(d-this.projectMatrix[13])/this.projectMatrix[5]),n[0]=this.eye[0]-this.viewMatrix[2]*o,n[1]=this.eye[1]-this.viewMatrix[6]*o,n[2]=this.eye[2]-this._yVanishFactor[2]*o,a[0]=n[0]+u*this.viewMatrix[0]+c*this.viewMatrix[1],a[1]=n[1]+u*this.viewMatrix[4]+c*this.viewMatrix[5],a[2]=n[2]+u*this._yVanishFactor[0]+c*this._yVanishFactor[1],a},e.prototype.project=function(e,t){var r=n.e.create();null!==t&&void 0!==t?n.d.transformMat4(r,e,t):(r[0]=e[0],r[1]=e[1],r[2]=e[2]),r[3]=1;var a=n.e.create();n.e.transformMat4(a,r,this.vpMatrix),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];var o=this.viewport[3]-this.viewport[1],s=(a[0]+1)/2*this.viewport[2]+this.viewport[0],l=(a[1]+1)/2*o;return[s/=i.a.devicePixelRatio,l=(o-1-l)/i.a.devicePixelRatio,Math.sign(a[3])]},e.prototype.setFirstPerson=function(e){this._firstPerson!==e&&(this._theta=Math.PI+this._theta,this._phi=-this._phi,this._firstPerson=e)},e.prototype._length=function(e,t,r){return Math.sqrt(e*e+t*t+r*r)},e.prototype.getViewDirection=function(){return o[0]=-this.viewMatrix[2],o[1]=-this.viewMatrix[6],o[2]=-this._yVanishFactor[2],o},e.prototype.getEye=function(){return s[0]=this.eye[0],s[1]=this.eye[1],s[2]=this.eye[2],s[3]=1,s},e.prototype.jitter=function(e,t){this._perspective?(this.projectMatrix[8]+=2*e,this.projectMatrix[9]+=2*t):(this.projectMatrix[12]+=2*e,this.projectMatrix[13]+=2*t),n.a.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},e.prototype.getNearPlaneSize=function(){if(this._perspective){var e=Math.tan(.017453293*this._fov*.5)*this._znear;return[e*this._aspect,e,-this._znear]}return[1/this.projectMatrix[0],1/this.projectMatrix[5],1]},e.prototype.getFarPlaneSize=function(){if(this._perspective){var e=Math.tan(.017453293*this._fov*.5)*this._zfar;return[e*this._aspect,e,-this._zfar]}return[1/this.projectMatrix[0],1/this.projectMatrix[5],1]},e.prototype.transformPerspectiveToOrthogonal=function(){this._perspective&&(this.setPerspective(!1),this._setHeight(this._distance),this._distance+=3e-4)},e.prototype.shootRay=function(e,t,r,i){var a=this.unproject(e,t);this._perspective?(r[0]=this.eye[0],r[1]=this.eye[1],r[2]=this.eye[2],i[0]=a[0]-r[0],i[1]=a[1]-r[1],i[2]=a[2]-r[2]):(r[0]=a[0],r[1]=a[1],r[2]=a[2],i[0]=-this.viewMatrix[2],i[1]=-this.viewMatrix[6],i[2]=-this._yVanishFactor[2]),n.d.normalize(i,i)},e.prototype.transformOrthogonalToPerspective=function(){this._perspective||(this.setPerspective(!0),this._distance+=15e-5)},e.prototype.copy=function(e){this._at[0]=e._at[0],this._at[1]=e._at[1],this._at[2]=e._at[2],this._theta=e._theta,this._phi=e._phi,this._distance=e._distance,this._firstPerson=e._firstPerson,this._fov=e._fov,this._invTanFov=e._invTanFov,this._znear=e._znear,this._zfar=e._zfar,this._aspect=e._aspect,this._perspective=e._perspective,this._height=e._height,n.e.copy(this.viewport,e.viewport),n.a.copy(this.viewMatrix,e.viewMatrix),n.a.copy(this.projectMatrix,e.projectMatrix),n.a.copy(this.vpMatrix,e.vpMatrix),n.e.copy(this.eye,e.eye)},e.prototype.split=function(e,t){for(var r=this._znear,i=this._zfar,a=r,o=.1*(i-r),s=1;s<e;s++){var u=s/e,c=.5*(r*Math.pow(i/r,u)+r+Math.pow(i-r,u))+o;(h=t[s-1]).copy(this),h._updateProjection(a,c),n.a.multiply(h.vpMatrix,h.projectMatrix,h.viewMatrix),a=c,l[s-1]=c}var h;return(h=t[e-1]).copy(this),h._updateProjection(a,i),n.a.multiply(h.vpMatrix,h.projectMatrix,h.viewMatrix),l},e}();t.a=u},function(e,t,r){"use strict";var i=function(){function e(){}return e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.indexOf=function(t,r){if(!e.isArray(t))return console.error("Not an array!"),-1;for(var i=0,n=t.length;i<n;++i)if(t[i]===r)return i;return-1},e.decodeUTF8=function(e){for(var t="",r=0;r<e.length;r++){var i=e[r];if(i<128)t+=String.fromCharCode(i);else if(i>191&&i<224)t+=String.fromCharCode((31&i)<<6|63&e[r+1]),r+=1;else if(i>223&&i<240)t+=String.fromCharCode((15&i)<<12|(63&e[r+1])<<6|63&e[r+2]),r+=2;else{var n=((7&i)<<18|(63&e[r+1])<<12|(63&e[r+2])<<6|63&e[r+3])-65536;t+=String.fromCharCode(n>>10|55296,1023&n|56320),r+=3}}return t},e.generateUUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)})},e}();t.a=i},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i={webvr:!1,compressNormals:!1,maxInstanceCount:1e3}},function(e,t,r){"use strict";var i=r(35);function n(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var a,o=n("DXT1"),s=n("DXT3"),l=n("DXT5"),u=n("DX10");!function(e){e[e.TEXTURETYPE_UNSIGNED_INT=0]="TEXTURETYPE_UNSIGNED_INT",e[e.TEXTURETYPE_HALF_FLOAT=1]="TEXTURETYPE_HALF_FLOAT",e[e.TEXTURETYPE_FLOAT=2]="TEXTURETYPE_FLOAT"}(a||(a={}));var c=function(){function e(){}return e.GetDDSInfo=function(e){var t=new Int32Array(e,0,31),r=new Int32Array(e,0,35),i=1;131072&t[2]&&(i=Math.max(1,t[7]));var n=t[21],c=n===u?r[32]:0,h=a.TEXTURETYPE_UNSIGNED_INT;switch(n){case 113:h=a.TEXTURETYPE_HALF_FLOAT;break;case 116:h=a.TEXTURETYPE_FLOAT;break;case u:if(10===c){h=a.TEXTURETYPE_HALF_FLOAT;break}if(2===c){h=a.TEXTURETYPE_FLOAT;break}}return{width:t[4],height:t[3],mipmapCount:i,isFourCC:4==(4&t[20]),isRGB:64==(64&t[20]),isLuminance:131072==(131072&t[20]),isCube:512==(512&t[28]),isCompressed:n===o||n===s||n===l,dxgiFormat:c,textureType:h}},e._ToHalfFloat=function(t){e._FloatView||(e._FloatView=new Float32Array(1),e._Int32View=new Int32Array(e._FloatView.buffer)),e._FloatView[0]=t;var r=e._Int32View[0],i=r>>16&32768,n=r>>12&2047,a=r>>23&255;return a<103?i:a>142?(i|=31744,i|=(255==a?0:1)&&8388607&r):a<113?i|=((n|=2048)>>114-a)+(n>>113-a&1):(i|=a-112<<10|n>>1,i+=1&n)},e._FromHalfFloat=function(e){var t=(32768&e)>>15,r=(31744&e)>>10,i=1023&e;return 0===r?(t?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):31==r?i?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,r-15)*(1+i/Math.pow(2,10))},e._GetHalfFloatAsFloatRGBAArrayBuffer=function(t,r,i,n,a,o){for(var s=new Float32Array(n),l=new Uint16Array(a,i),u=0,c=0;c<r;c++)for(var h=0;h<t;h++){var d=4*(h+c*t);s[u]=e._FromHalfFloat(l[d]),s[u+1]=e._FromHalfFloat(l[d+1]),s[u+2]=e._FromHalfFloat(l[d+2]),e.StoreLODInAlphaChannel?s[u+3]=o:s[u+3]=e._FromHalfFloat(l[d+3]),u+=4}return s},e._GetHalfFloatRGBAArrayBuffer=function(t,r,i,n,a,o){if(e.StoreLODInAlphaChannel){for(var s=new Uint16Array(n),l=new Uint16Array(a,i),u=0,c=0;c<r;c++)for(var h=0;h<t;h++){var d=4*(h+c*t);s[u]=l[d],s[u+1]=l[d+1],s[u+2]=l[d+2],s[u+3]=e._ToHalfFloat(o),u+=4}return s}return new Uint16Array(a,i,n)},e._GetFloatRGBAArrayBuffer=function(t,r,i,n,a,o){if(e.StoreLODInAlphaChannel){for(var s=new Float32Array(n),l=new Float32Array(a,i),u=0,c=0;c<r;c++)for(var h=0;h<t;h++){var d=4*(h+c*t);s[u]=l[d],s[u+1]=l[d+1],s[u+2]=l[d+2],s[u+3]=o,u+=4}return s}return new Float32Array(a,i,n)},e._GetFloatAsUIntRGBAArrayBuffer=function(t,r,i,n,a,o){for(var s=new Uint8Array(n),l=new Float32Array(a,i),u=0,c=0;c<r;c++)for(var h=0;h<t;h++){var d=4*(h+c*t);s[u]=255*Math.min(1,Math.max(0,l[d])),s[u+1]=255*Math.min(1,Math.max(0,l[d+1])),s[u+2]=255*Math.min(1,Math.max(0,l[d+2])),e.StoreLODInAlphaChannel?s[u+3]=o:s[u+3]=255*Math.min(1,Math.max(0,l[d+3])),u+=4}return s},e._GetHalfFloatAsUIntRGBAArrayBuffer=function(t,r,i,n,a,o){for(var s=new Uint8Array(n),l=new Uint16Array(a,i),u=0,c=0;c<r;c++)for(var h=0;h<t;h++){var d=4*(h+c*t);s[u]=255*Math.min(1,Math.max(0,e._FromHalfFloat(l[d]))),s[u+1]=255*Math.min(1,Math.max(0,e._FromHalfFloat(l[d+1]))),s[u+2]=255*Math.min(1,Math.max(0,e._FromHalfFloat(l[d+2]))),e.StoreLODInAlphaChannel?s[u+3]=o:s[u+3]=255*Math.min(1,Math.max(0,e._FromHalfFloat(l[d+3]))),u+=4}return s},e._GetRGBAArrayBuffer=function(e,t,r,i,n,a,o,s,l){for(var u=new Uint8Array(i),c=new Uint8Array(n,r),h=0,d=0;d<t;d++)for(var p=0;p<e;p++){var f=4*(p+d*e);u[h]=c[f+a],u[h+1]=c[f+o],u[h+2]=c[f+s],u[h+3]=c[f+l],h+=4}return u},e._ExtractLongWordOrder=function(t){return 0===t||255===t||-16777216===t?0:1+e._ExtractLongWordOrder(t>>8)},e._GetRGBArrayBuffer=function(e,t,r,i,n,a,o,s){for(var l=new Uint8Array(i),u=new Uint8Array(n,r),c=0,h=0;h<t;h++)for(var d=0;d<e;d++){var p=3*(d+h*e);l[c]=u[p+a],l[c+1]=u[p+o],l[c+2]=u[p+s],c+=3}return l},e._GetLuminanceArrayBuffer=function(e,t,r,i,n){for(var a=new Uint8Array(i),o=new Uint8Array(n,r),s=0,l=0;l<t;l++)for(var u=0;u<e;u++){var c=u+l*e;a[s]=o[c],s++}return a},e.uploadDataToTexture=function(e,t,r,i,n,a,o,s,l){void 0===l&&(l=!1);var u=e.TEXTURE_CUBE_MAP_POSITIVE_X+o,c=Math.round(Math.log(t.width)*Math.LOG2E),h=Math.round(Math.log(t.height)*Math.LOG2E),d=l?t.width:Math.pow(2,Math.max(c-s,0)),p=l?t.height:Math.pow(2,Math.max(h-s,0));e.isWebGL2||(n=a),e.texImage2D(u,s,a,d,p,0,n,i,r)},e.uploadCompressedDataToTextureDirectly=function(e,t,r,i,n,a,o,s){void 0===o&&(o=0),void 0===s&&(s=0);var l=e.TEXTURE_CUBE_MAP_POSITIVE_X+o;e.compressedTexImage2D(l,s,r,i,n,0,a)},e.UploadDDSLevels=function(t,r,i,n,a,c,h,d){void 0===h&&(h=-1);var p,f,m,_,v,y,g,b=t.s3tcExtension,w=new Int32Array(i,0,31),x=0,M=0,T=1;if(542327876===w[0])if(n.isFourCC||n.isRGB||n.isLuminance)if(!n.isCompressed||b){var E=w[22];_=w[1]+4;if(n.isFourCC)switch(p=w[21]){case o:T=8,M=b.COMPRESSED_RGBA_S3TC_DXT1_EXT;break;case s:T=16,M=b.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case l:T=16,M=b.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case 113:case 116:!0;break;case u:_+=20;var S=!1;switch(n.dxgiFormat){case 10:case 2:!0,S=!0;break;case 88:n.isRGB=!0,n.isFourCC=!1,E=32,S=!0}if(S)break;default:return void console.error("Unsupported FourCC code:",function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}(p))}var A=e._ExtractLongWordOrder(w[23]),k=e._ExtractLongWordOrder(w[24]),P=e._ExtractLongWordOrder(w[25]),N=e._ExtractLongWordOrder(w[26]);y=1,131072&w[2]&&!1!==a&&(y=Math.max(1,w[7]));for(var D,I,O,R=d||0,C=t.isWebGL2||t.halfFloatExtension,B=R;B<c;B++){for(f=w[4],m=w[3],g=0;g<y;++g){if(-1===h||h===g){var L=-1===h?g:0;if(!n.isCompressed&&n.isFourCC){D=t.RGBA,x=f*m*4;var F=null;128===E?(O=t.FLOAT,I=t.RGBA32F,F=e._GetFloatRGBAArrayBuffer(f,m,_,x,i,L)):64!==E||C?(O=t.HALF_FLOAT||C.HALF_FLOAT_OES,I=t.RGBA16F||t.RGBA,F=e._GetHalfFloatRGBAArrayBuffer(f,m,_,x,i,L)):(O=t.FLOAT,I=t.RGBA32F,F=e._GetHalfFloatAsFloatRGBAArrayBuffer(f,m,_,x,i,L)),F&&e.uploadDataToTexture(t,r,F,O,D,I,B,L)}else if(n.isRGB)O=t.UNSIGNED_INT,24===E?(D=t.RGB,I=t.RGB8,x=f*m*3,v=e._GetRGBArrayBuffer(f,m,_,x,i,A,k,P),e.uploadDataToTexture(t,r,v,O,D,I,B,L)):(D=t.RGBA,I=t.RGBA8,x=f*m*4,v=e._GetRGBAArrayBuffer(f,m,_,x,i,A,k,P,N),e.uploadDataToTexture(t,r,v,O,D,I,B,L));else if(n.isLuminance){var V=t.getParameter(t.UNPACK_ALIGNMENT),U=f;x=Math.floor((f+V-1)/V)*V*(m-1)+U,v=e._GetLuminanceArrayBuffer(f,m,_,x,i),D=t.LUMINANCE,I=t.LUMINANCE,O=t.UNSIGNED_INT,e.uploadDataToTexture(t,r,v,O,D,I,B,L)}else x=Math.max(4,f)/4*Math.max(4,m)/4*T,v=new Uint8Array(i,_,x),O=t.UNSIGNED_INT,e.uploadCompressedDataToTextureDirectly(t,r,M,f,m,v,B,L)}_+=E?f*m*(E/8):x,f*=.5,m*=.5,f=Math.max(1,f),m=Math.max(1,m)}if(void 0!==d)break}}else console.error("Compressed textures are not supported on this platform.");else console.error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");else console.error("Invalid magic number in DDS header")},e.StoreLODInAlphaChannel=!1,e}(),h=r(1),d=r(23),p=r(3),f=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),m=function(e){function t(t,r){var i=e.call(this,t,r)||this;i._resizeImage=function(e,t){var r=1;(e.width>t||e.height>t)&&(r=t/Math.max(e.width,e.height));var n=p.a.floorPowerOfTwo,a=n(r*e.width),o=n(r*e.height);i._canvas||(i._canvas=i._createCanvas(a,o));var s=i._canvas;return s.width=a,s.height=o,s.getContext("2d").drawImage(e,0,0,a,o),console.warn("Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+o+")"),s};var n=r.gl;return i._texture=null,i._internalFormat=n.RGBA,i._format=n.RGBA,i._type=n.UNSIGNED_BYTE,i._wrap=n.CLAMP_TO_EDGE,i._filter=n.LINEAR,i._flipY=!1,i._mipmap=!1,i._rbo=!1,i._target=n.TEXTURE_2D,i._samples=1,i._is3d=!1,i._canvas=null,i._maxTextureSize=h.a.isMobile?Math.min(n.getParameter(n.MAX_TEXTURE_SIZE),2048):n.getParameter(n.MAX_TEXTURE_SIZE),i.width=1,i.height=1,i.depth=1,i.bytes=0,i.url=null,i}return f(t,e),t.prototype.useTexture3d=function(){this._is3d=!0},t.prototype.destroy=function(t){if(void 0===t&&(t=!1),t||(this._ref--,!(this._ref>0))){if(this.ready){var r=this._manager.gl;this._rbo?r.deleteRenderbuffer(this._texture):r.deleteTexture(this._texture),this._texture=null,delete this._texture;var i;(i=r.getError())!==r.NO_ERROR&&console.log("GL error in texture.destroy(): "+i)}this._manager&&this._manager.deleteTexture(this.name),e.prototype.destroy.call(this)}},t.prototype._isPowerOfTwo=function(e){return p.a.isPowerOfTwo(e.width)&&p.a.isPowerOfTwo(e.height)},t.prototype._createCanvas=function(e,t){return"undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")},t.prototype._create=function(e){var t=this._manager.gl;this._texture=t.createTexture();var r=t.NEAREST;(this._filter!==t.LINEAR_MIPMAP_NEAREST&&this._filter!==t.NEAREST_MIPMAP_LINEAR&&this._filter!==t.LINEAR_MIPMAP_LINEAR&&this._filter!==t.LINEAR||(r=t.LINEAR),t.activeTexture(t.TEXTURE0+7),t.bindTexture(t.TEXTURE_2D,this._texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this._filter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this._wrap),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this._wrap),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this._flipY),e)?((!1===this._isPowerOfTwo(e)||e.width>this._maxTextureSize||e.height>this._maxTextureSize)&&(e=this._resizeImage(e,this._maxTextureSize)),t.texImage2D(t.TEXTURE_2D,0,this._format,this._format,this._type,e)):t.texImage2D(t.TEXTURE_2D,0,this._internalFormat,this.width,this.height,0,this._format,this._type,null);this._mipmap&&t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)},t.prototype.updateImage=function(e,t,r,i,n){this.ready=!1,this.createFromImage(e,t,r,i,n)},t.prototype.createFromImage=function(e,t,r,i,n,a){void 0===a&&(a=!1);var o=this._manager.gl;this.ready||(this._format=t,this._type=r,this.width=e.width,this.height=e.height,this._filter=i,this._wrap=n,this._filter!==o.LINEAR_MIPMAP_NEAREST&&this._filter!==o.NEAREST_MIPMAP_LINEAR&&this._filter!==o.LINEAR_MIPMAP_LINEAR&&this._filter!==o.NEAREST_MIPMAP_NEAREST||(this._mipmap=!0),this._flipY=a,this._create(e),o.getError()===o.NO_ERROR?this.ready=!0:o.deleteTexture(this._texture))},t.prototype.createFromCanvas=function(e,t,r,i,n,a){void 0===a&&(a=!1);var o=this._manager.gl;if(!this.ready){this._format=t,this._type=r,this.width=e.width,this.height=e.height,this._filter=i,this._wrap=n,this._filter!==o.LINEAR_MIPMAP_NEAREST&&this._filter!==o.NEAREST_MIPMAP_LINEAR&&this._filter!==o.LINEAR_MIPMAP_LINEAR&&this._filter!==o.NEAREST_MIPMAP_NEAREST||(this._mipmap=!0),this._flipY=a,this._texture=o.createTexture();var s=o.NEAREST;this._filter!==o.LINEAR_MIPMAP_NEAREST&&this._filter!==o.NEAREST_MIPMAP_LINEAR&&this._filter!==o.LINEAR_MIPMAP_LINEAR&&this._filter!==o.LINEAR||(s=o.LINEAR),o.activeTexture(o.TEXTURE0+7),o.bindTexture(o.TEXTURE_2D,this._texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this._filter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,s),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,this._wrap),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,this._wrap),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,this._flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),o.texImage2D(o.TEXTURE_2D,0,this._format,this._format,this._type,e),this._mipmap&&o.generateMipmap(o.TEXTURE_2D),o.bindTexture(o.TEXTURE_2D,null),o.getError()===o.NO_ERROR?this.ready=!0:o.deleteTexture(this._texture)}},t.prototype.createFromImages=function(e,t,r,i,n){var a=this._manager.gl;if(!this.ready){this._target=a.TEXTURE_CUBE_MAP,this._format=t,this._type=r,this.width=e[0].width,this.height=e[0].height,this._filter=i,this._wrap=n,this._filter!==a.LINEAR_MIPMAP_NEAREST&&this._filter!==a.NEAREST_MIPMAP_LINEAR&&this._filter!==a.LINEAR_MIPMAP_LINEAR&&this._filter!==a.NEAREST_MIPMAP_NEAREST||(this._mipmap=!0),this._texture=a.createTexture();var o=a.NEAREST;this._filter!==a.LINEAR_MIPMAP_NEAREST&&this._filter!==a.NEAREST_MIPMAP_LINEAR&&this._filter!==a.LINEAR_MIPMAP_LINEAR&&this._filter!==a.LINEAR||(o=a.LINEAR),a.activeTexture(a.TEXTURE0+7),a.bindTexture(a.TEXTURE_CUBE_MAP,this._texture),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,this._filter),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,o),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,this._wrap),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,this._wrap),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._format,this._format,this._type,e[0]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._format,this._format,this._type,e[1]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._format,this._format,this._type,e[2]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._format,this._format,this._type,e[3]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._format,this._format,this._type,e[4]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._format,this._format,this._type,e[5]),this._mipmap&&a.generateMipmap(a.TEXTURE_CUBE_MAP),a.bindTexture(a.TEXTURE_CUBE_MAP,null),a.getError()===a.NO_ERROR?this.ready=!0:a.deleteTexture(this._texture)}},t.prototype.createFromDDS=function(e,t){var r=this;d.a.OpenFile1(e,"arraybuffer",Promise).downloadFile().then(function(e){var i=c.GetDDSInfo(e.data);r.width=i.width,r.height=i.height;var n=i.isRGB||i.isLuminance||i.mipmapCount>1,a=r._manager.gl;r._texture=a.createTexture(),i.isCube?(r._target=a.TEXTURE_CUBE_MAP,r._filter=a.LINEAR_MIPMAP_LINEAR):(r._target=a.TEXTURE_2D,r._filter=a.LINEAR);var o=a.LINEAR;r._wrap=a.CLAMP_TO_EDGE,a.activeTexture(a.TEXTURE0+7),a.bindTexture(r._target,r._texture),a.texParameteri(r._target,a.TEXTURE_MIN_FILTER,r._filter),a.texParameteri(r._target,a.TEXTURE_MAG_FILTER,o),a.texParameteri(r._target,a.TEXTURE_WRAP_S,r._wrap),a.texParameteri(r._target,a.TEXTURE_WRAP_T,r._wrap),c.UploadDDSLevels(a,r,e.data,i,n,6,-1),a.bindTexture(a.TEXTURE_CUBE_MAP,null),i.isFourCC||1!==i.mipmapCount||r.generateCubeMapMipMap(),a.getError()===a.NO_ERROR?r.ready=!0:a.deleteTexture(r._texture),t&&t()})},t.prototype.createFromFiles=function(e,t,r,i,n){var a=this;if(6===e.length){var o=[],s=0;e.forEach(function(l,u){var c=new Image;c.crossOrigin="anonymous",o.push(c),c.onload=function(){++s===e.length&&(a.createFromImages(o,t,a._manager.gl.UNSIGNED_BYTE,r,i),n&&n(a))},c.src=l})}else console.warn("file length should be 6.")},t.prototype.createFromFile=function(e,t,r,i,n){var a=this;if(!this.ready){var o=new Image;o.crossOrigin="anonymous",o.onload=function(){a.createFromImage(o,t,a._manager.gl.UNSIGNED_BYTE,r,i),null!==n&&n(a)},o.src=e}},t.prototype.create=function(e,t,r,i,n,a,o){var s=this._manager.gl;if(!this.ready){r=r||s.RGBA;var l=s.UNSIGNED_BYTE;this.width=e,this.height=t,this.depth,this._filter=i||s.LINEAR,this._wrap=n||s.CLAMP_TO_EDGE;var u=r;if(s.isWebGL2&&(this._samples=a||1),r===s.RGB32F||r===s.RGBA32F||r===s.R32F){if(!s.floatTextureExtension&&!s.isWebGL2)return void console.error("Unsupported texture format for texture "+this.name);l=s.FLOAT,r=r===s.RGB32F?s.RGB:r===s.RGBA32F?s.RGBA:s.RED}else if(r===s.RGB16F||r===s.RGBA16F||r===s.R16F)l=s.HALF_FLOAT,r=r===s.RGB16F?s.RGB:r===s.RGBA16F?s.RGBA:s.RED;else if(r===s.RGBA8||r===s.RGBA)l=s.UNSIGNED_BYTE,r=s.RGBA;else if(r===s.RGB8||r===s.RGB)l=s.UNSIGNED_BYTE,r=s.RGB;else if(r===s.R8)l=s.UNSIGNED_BYTE,r=s.isWebGL2?s.RED:s.ALPHA;else if(r===s.DEPTH_COMPONENT16||r===s.DEPTH_COMPONENT24||r===s.DEPTH_COMPONENT32||r===s.DEPTH_COMPONENT){if(!s.depthTextureExtension&&!s.isWebGL2)return void console.error("Unsupported texture format for texture "+this.name);l=s.UNSIGNED_INT,r===s.DEPTH_COMPONENT16?l=s.UNSIGNED_SHORT:r!==s.DEPTH_COMPONENT24&&r!==s.DEPTH_COMPONENT32||(l=s.UNSIGNED_INT),r=s.DEPTH_COMPONENT}else if(r===s.DEPTH24_STENCIL8||r===s.DEPTH_STENCIL)l=s.isWebGL2?s.UNSIGNED_INT_24_8:s.depthTextureExtension.UNSIGNED_INT_24_8_WEBGL,r=s.DEPTH_STENCIL;else{if(r!==s.ALPHA&&r!==s.LUMINANCE_ALPHA&&r!==s.LUMINANCE)return void console.error("Unsupported texture format for texture "+this.name);l=s.UNSIGNED_BYTE}this._format=r,this._internalFormat=s.isWebGL2?u:r,this._type=l;var c=s.NEAREST;if(this._filter!==s.LINEAR_MIPMAP_NEAREST&&this._filter!==s.NEAREST_MIPMAP_LINEAR&&this._filter!==s.LINEAR_MIPMAP_LINEAR&&this._filter!==s.LINEAR||(c=s.LINEAR),s.isWebGL2)if(a>1){if(this._texture=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,this._texture),s.renderbufferStorageMultisample(s.RENDERBUFFER,this._samples,this._internalFormat,this.width,this.height),s.getError()!==s.NO_ERROR)return void s.deleteRenderbuffer(this._texture);this._rbo=!0}else this._texture=s.createTexture(),s.activeTexture(s.TEXTURE0+7),this._is3d?(s.bindTexture(s.TEXTURE_3D,this._texture),s.texParameteri(s.TEXTURE_3D,s.TEXTURE_MIN_FILTER,this._filter),s.texParameteri(s.TEXTURE_3D,s.TEXTURE_MAG_FILTER,c),s.texParameteri(s.TEXTURE_3D,s.TEXTURE_WRAP_S,this._wrap),s.texParameteri(s.TEXTURE_3D,s.TEXTURE_WRAP_T,this._wrap),s.texStorage2D(s.TEXTURE_3D,1,this._internalFormat,this.width,this.height,this.depth)):(s.bindTexture(s.TEXTURE_2D,this._texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,this._filter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,c),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,this._wrap),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,this._wrap),s.texStorage2D(s.TEXTURE_2D,1,this._internalFormat,this.width,this.height));else if(this._format!==s.DEPTH24_STENCIL8||s.depthTextureExtension)this._texture=s.createTexture(),s.activeTexture(s.TEXTURE0+7),s.bindTexture(s.TEXTURE_2D,this._texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,this._filter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,c),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,this._wrap),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,this._wrap),s.texImage2D(s.TEXTURE_2D,0,this._internalFormat,this.width,this.height,0,this._internalFormat,this._type,null);else{if(this._texture=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,this._texture),s.renderbufferStorage(s.RENDERBUFFER,this._internalFormat,e,t),s.getError()!==s.NO_ERROR)return void s.deleteRenderbuffer(this._texture);this._rbo=!0}s.getError()===s.NO_ERROR?this.ready=!0:s.deleteTexture(this._texture)}},t.prototype.update=function(e){var t=this._manager.gl;t.activeTexture(t.TEXTURE0+7),t.bindTexture(t.TEXTURE_2D,this._texture),this._format===t.LUMINANCE&&t.pixelStorei(t.UNPACK_ALIGNMENT,1),t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,this._format,this._type,e),this._format===t.LUMINANCE&&t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.getError()===t.NO_ERROR?this.ready=!0:t.deleteTexture(this._texture)},t.prototype.copy=function(){var e=this._manager.gl;if(!this._rbo){this.ready=!1;var t=this.width,r=this.height;e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,this._texture),e.copyTexSubImage2D(e.TEXTURE_2D,0,0,0,0,0,t,r),e.getError()===e.NO_ERROR&&(this.ready=!0),e.bindTexture(e.TEXTURE_2D,null)}},t.prototype.resize=function(e,t){var r=this._manager.gl;if(this.ready&&(this.width!==e||this.height!==t)){if(e>4096&&(e=4096),t>4096&&(t=4096),this.width=e,this.height=t,-1!==this.name.search(/-[0-9]+x[0-9]+-/)){var i=this.name.split("-"),n=i[0]+"-"+this.width+"x"+this.height+"-"+i[2];this._manager.renameTexture(this.name,n),this.name=n}this.ready=!1,this._rbo?(r.bindRenderbuffer(r.RENDERBUFFER,this._texture),this._samples<=1?r.renderbufferStorage(r.RENDERBUFFER,this._internalFormat,e,t):r.renderbufferStorageMultisample(r.RENDERBUFFER,this._samples,this._internalFormat,this.width,this.height),r.getError()===r.NO_ERROR?this.ready=!0:r.deleteRenderbuffer(this._texture),r.bindRenderbuffer(r.RENDERBUFFER,null)):(r.deleteTexture(this._texture),this._create(null),r.getError()===r.NO_ERROR?this.ready=!0:r.deleteTexture(this._texture))}},t.prototype.generateMipmap=function(){var e=this._manager.gl;!this.ready||this._rbo||this._mipmap||(this._mipmap=!0,e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,this._texture),e.generateMipmap(e.TEXTURE_2D),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.bindTexture(e.TEXTURE_2D,null))},t.prototype.generateCubeMapMipMap=function(){var e=this._manager.gl;!this.ready||this._rbo||this._mipmap||(this._mipmap=!0,e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_CUBE_MAP,this._texture),e.generateMipmap(e.TEXTURE_CUBE_MAP),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.bindTexture(e.TEXTURE_CUBE_MAP,null))},t.prototype.use=function(e){var t=this._manager.gl;this.ready&&!this._rbo?(t.activeTexture(t.TEXTURE0+e),t.bindTexture(this._target,this._texture)):console.warn("texture "+this.name+" is either not ready or not bindable.")},t.prototype.isFloating=function(){var e=this._manager.gl;return this._type===e.FLOAT||this._type===e.isWebGL2?e.UNSIGNED_INT_24_8:e.depthTextureExtension.UNSIGNED_INT_24_8_WEBGL},t.prototype.isMultisamples=function(){return this._samples>1},t.prototype.hasAlpha=function(){var e=this._manager.gl;return this._format===e.RGBA||this._format===e.RGBA32F||this._format===e.RGBA16F||this._format===e.RGBA8},t.prototype.getSize=function(){var e=this._manager.gl;if(!this.ready)return 0;var t=this.width*this.height;switch(this._format){case e.RG:t*=2;break;case e.RGB:t*=3;break;case e.RGBA:t*=4}switch(this._type){case e.FLOAT:case e.isWebGL2?e.UNSIGNED_INT_24_8:e.depthTextureExtension.UNSIGNED_INT_24_8_WEBGL:t*=4;break;case e.DEPTH_COMPONENT16:t*=2}return this.bytes=t,this.bytes},t.prototype.discard=function(){var e=this._manager.gl;this.ready&&(this._rbo?e.deleteRenderbuffer(this._texture):e.deleteTexture(this._texture),this._texture=null,this.ready=!1)},t.prototype.getFilter=function(){return this._filter},t.prototype.getWrap=function(){return this._wrap},t.prototype.setWarp=function(e){this._wrap=e},t.prototype.restore=function(){var e=this._manager.gl;this.ready||(this._rbo?this.create(this.width,this.height,this._internalFormat,this._filter,this._wrap,this._samples):this._create(null),e.getError()===e.NO_ERROR?this.ready=!0:e.deleteTexture(this._texture))},t}(i.a);t.a=m},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i,n=r(3);!function(e){e[e.ROOT=0]="ROOT",e[e.INSTANCE=1]="INSTANCE",e[e.GROUP=2]="GROUP",e[e.ELEMENT=3]="ELEMENT",e[e.NODE=4]="NODE",e[e.LINK=5]="LINK",e[e.ROOM=6]="ROOM",e[e.AREA=7]="AREA",e[e.ANY=-1]="ANY"}(i||(i={}));var a=function(){function e(e,t,r,i){this.etype=e,this.id=t,this.father=null,this.children=[],this.bbox=n.a.aabb.create(),this.model=r,this.guid="",this.name=i}return e.prototype.getNodes=function(){for(var e=[],t=[],r=0,i=this.children.length;r<i;++r){var n=this.children[r];n.hasOwnProperty("children")?t.push(n):e.push(n)}for(;t.length>0;)for(var a=t.pop(),o=0,s=a.children.length;o<s;++o){var l=a.children[o];l.hasOwnProperty("children")?t.push(l):e.push(l)}return e},e.prototype.getDocument=function(){for(var e=this.father;null!==e&&e.etype!==i.LINK;)e=e.father;return e.etype===i.LINK?e:null},e}();t.b=a},function(e,t,r){"use strict";var i=r(16),n=r(4),a=r(22),o=r(7),s=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),l=function(e){function t(t){return e.call(this,t)||this}return s(t,e),t.prototype.attachShader=function(e,t){if(e&&e.ready){for(var r in e.userUniforms)if(!this.parameters.hasOwnProperty(r))if(this.parameters[r]=new o.a,r.match(/uTexture\d/)){this.hasTexture=!0;var i=parseInt(r.substr(8));if(i>2){console.error("can't support >3 user textures. See shader '"+e.name+"'");continue}this.parameters[r].texUnit=i,this.parameters[r].upload=this.parameters[r].uploadTexture}else this.parameters[r].upload=this.parameters[r].uploadValue;for(var n in e.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uSkyTexture"===n?(this.reservedParameters[n]=new o.a,this.hasTexture=!0,this.reservedParameters[n].texUnit=4,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uTransparency"===n?(this.reservedParameters[n]=new o.a,this.reservedParameters[n].value=1,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uTextureOffset"===n&&(this.reservedParameters[n]=new o.a,this.reservedParameters[n].value=0,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue));for(var a in this.reservedParameters)e.reservedUniforms[a]||delete this.reservedParameters[a];return e}},t.prototype.setTexture=function(e){this.reservedParameters.m_uSkyTexture.value=e},t.prototype.setTextureOffset=function(e){this.reservedParameters.m_uTextureOffset.value=e},t.prototype.texture=function(){return this.reservedParameters.m_uSkyTexture.value},t.prototype.setTransparency=function(e){this.reservedParameters.m_uTransparency.value=e},t}(a.a),u=r(15),c=r(14),h=r(0),d=r(2);r.d(t,"a",function(){return p});var p,f=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(e){e[e.SKYBOX_SOLIDCOLOR=0]="SKYBOX_SOLIDCOLOR",e[e.SKYBOX_WALLPAPER=1]="SKYBOX_WALLPAPER",e[e.SKYBOX_EQUIRECTANGLE=2]="SKYBOX_EQUIRECTANGLE",e[e.SKYBOX_CUBEMAP=3]="SKYBOX_CUBEMAP",e[e.SKYBOX_WALLPAPER_TILED=4]="SKYBOX_WALLPAPER_TILED"}(p||(p={}));var m=function(e){function t(t){var r=e.call(this,null,null,null,null,null)||this;r._resourceManager=t,r._mode=-1,r._flipY=!1,r.camera=new u.a([0,0,1,1]);for(var i=0,n="model-skybox-texture-"+i;r._resourceManager.hasTexture(n);)n="model-skybox-texture-"+ ++i;return r._texture=r._resourceManager.getTexture(n),r.visible=!1,r.material=new l(n),r.setMode(p.SKYBOX_EQUIRECTANGLE),r}return f(t,e),t.prototype.destroy=function(){this._texture&&this._texture.destroy(),delete this._texture,this.camera.destroy(),delete this.camera,this._resourceManager=null,delete this._resourceManager,this._flipY=null,delete this._flipY,e.prototype.destroy.call(this)},t.prototype.update=function(e){if(this._mode===p.SKYBOX_WALLPAPER_TILED&&this.visible){var t=this.camera.viewport[3]-this.camera.viewport[1],r=this._texture.height/this._texture.width*(i/t),i=this.camera.viewport[2]-this.camera.viewport[0];this.transform.setScaling(1,r,1),this.transform.setTranslation(0,1-r,1)}else h.a.copy(this.camera.viewMatrix,e),this.camera.viewMatrix[12]=0,this.camera.viewMatrix[13]=0,this.camera.viewMatrix[14]=0,h.a.multiply(this.camera.vpMatrix,this.camera.projectMatrix,e)},t.prototype.resize=function(e,t){this.camera.setViewport([0,0,e,t])},t.prototype._updateMaterial=function(){this.visible=this._texture.ready,this.visible?this.material.setTexture(this._texture):console.warn("skybox sees a corrupted image.")},t.prototype.setImage=function(e){var t=this;if(e){if(this._texture&&this._texture.ready){this._texture.destroy();for(var r=0,n="model-skybox-texture-"+r;this._resourceManager.hasTexture(n);)n="model-skybox-texture-"+ ++r;this._texture=this._resourceManager.getTexture(n)}if(e&&i.a.isArray(e))e[0]instanceof HTMLImageElement?(this._texture.createFromImages(e,d.a.RGB,d.a.UNSIGNED_BYTE,d.a.LINEAR,d.a.CLAMP_TO_EDGE),this._updateMaterial()):this._texture.createFromFiles(e,d.a.RGB,d.a.LINEAR,d.a.CLAMP_TO_EDGE,function(){t._updateMaterial()}),this.visible=this._texture.ready,this.visible?this.material.setTexture(this._texture):console.warn("skybox sees a corrupted image.");else if(e instanceof HTMLImageElement)this._texture.createFromImage(e,d.a.RGB,d.a.UNSIGNED_BYTE,d.a.LINEAR,d.a.CLAMP_TO_EDGE),this._updateMaterial(),this.visible=this._texture.ready,this.visible?this.material.setTexture(this._texture):console.warn("skybox sees a corrupted image.");else{var a=e.split(".");"dds"==a[a.length-1].toLocaleLowerCase()&&this._texture.createFromDDS(e,function(){t._updateMaterial(),t.visible=t._texture.ready,t.visible?t.material.setTexture(t._texture):console.warn("skybox sees a corrupted image.")})}}else this.visible=!1},t.prototype.getMode=function(){return this._mode},t.prototype.setMode=function(e){if(this._mode!==e){this._mode=e;var t=n.a.skybox;if(this._mode===p.SKYBOX_WALLPAPER)this.mesh=this._resourceManager.getMesh("quad"),this.mesh.ready||this.mesh.createQuad(),this.shader=this._resourceManager.getShader("skybox",["WALLPAPER"]),this.shader.ready||this.shader.createFromShaderSource(t,["WALLPAPER"]),this.transform.reset();else if(this._mode===p.SKYBOX_WALLPAPER_TILED)this.mesh=this._resourceManager.getMesh("quad"),this.mesh.ready||this.mesh.createQuad(),this.shader=this._resourceManager.getShader("skybox",["WALLPAPER","MODEL_TRANSFORM"]),this.shader.ready||this.shader.createFromShaderSource(t,["WALLPAPER","MODEL_TRANSFORM"]),this.transform.reset();else if(this._mode===p.SKYBOX_EQUIRECTANGLE)this.mesh=this._resourceManager.getMesh("sphere-64-128"),this.mesh.ready||this.mesh.createSphere(64,128),this.shader=this._resourceManager.getShader("skybox",["EQUIRECTANGLE"]),this.shader.ready||this.shader.createFromShaderSource(t,["EQUIRECTANGLE"]);else if(this._mode===p.SKYBOX_CUBEMAP){this.mesh=this._resourceManager.getMesh("sphere-64-128"),this.mesh.ready||this.mesh.createSphere(64,p.SKYBOX_CUBEMAP);var r=["CUBEMAP"];this._flipY&&r.push("FLIP"),this.shader=this._resourceManager.getShader("skybox",r),this.shader.ready||this.shader.createFromShaderSource(t,r)}this.material.attachShader(this.shader),this.material.setTexture(this._texture),this.material.setTransparency(1)}},t.prototype.setTransparency=function(e){this.material.setTransparency(e)},t.prototype.setFlipYEnabled=function(e){this._flipY=e,this._mode=-1,this.setMode(p.SKYBOX_CUBEMAP)},t.prototype.getTexture=function(){return this._texture},t.prototype.setDirection=function(e){this._mode===p.SKYBOX_EQUIRECTANGLE&&(this.material.setTextureOffset(e),this._direction=e)},t.prototype.getDirection=function(){return this._direction},t.prototype.setFov=function(e){this.camera._setFov(e)},t}(c.a);t.b=m},function(e,t,r){"use strict";var i=r(9),n=function(){function e(e,t,r){if(this._needUpdate=!1,this.name=e,this._viewer=r,r){this._scene=r.getScene().core,this._camera=r.getCamera().core,this._cameras=[];for(var i=0;i<r.getCamera().cores.length;i++)this._cameras.push(r.getCamera().cores[i]);this._resourceManager=r.getResourceManager(),this._renderer=r.getRenderer()}else this._scene=null,this._camera=null,this._cameras=[],this._resourceManager=null,this._renderer=null;this._renderable=t,this._useEffect=!1,this._renderTargets=[],this._interactive=!0,this._enabled=!1,this._preventEffect=!1}return e.prototype.destroy=function(){this.name=null,delete this.name,this._viewer=null,delete this._viewer,this._scene=null,delete this._scene,this._camera=null,delete this._camera,this._cameras=null,delete this._cameras,this._renderer=null,delete this._renderer,this._resourceManager=null,delete this._resourceManager;for(var e=0;e<this._renderTargets.length;e++)this._renderTargets[e].destroy();this._renderTargets=null,delete this._renderTargets},e.prototype.doesSupportMobile=function(e){return!1},e.prototype.doesSupport3D=function(e){return!1},e.prototype.isEnabled=function(){return this._enabled},e.prototype.dump=function(){},e.prototype.setEnabled=function(e){e!==this._enabled&&(this._enabled=e,this._viewer.setProgressiveRendering(),this._onEnableChanged())},e.prototype._onEnableChanged=function(){},e.prototype.switchEnabled=function(){this._enabled=!this._enabled,this._viewer.setProgressiveRendering(),this._onEnableChanged()},e.prototype.setInteractive=function(e){this._interactive=e,this._viewer.setProgressiveRendering()},e.prototype.isInteractive=function(){return this._interactive&&this._enabled},e.prototype.denyEffect=function(){return this.isInteractive()&&this._preventEffect},e.prototype.addInput=function(e){},e.prototype.resize=function(e,t){for(var r=0;r<this._renderTargets.length;r++)this._renderTargets[r].resize(e,t)},e.prototype.needUpdate=function(){return this._enabled&&this._interactive&&this._needUpdate},e.prototype.renderNormally=function(){this._enabled&&this._interactive&&(this._render(),this._needUpdate=!1)},e.prototype.renderProgressively=function(){this._enabled&&this._interactive&&(this._renderProgressively(),this._needUpdate=!1)},e.prototype._render=function(){},e.prototype._renderProgressively=function(){},e.prototype.setUseEffect=function(e){this._useEffect=e},e.prototype.isUseEffect=function(){return this._useEffect},e.prototype.preventEffect=function(e){this._preventEffect=e},e.prototype.onSceneChanged=function(){},e.prototype._getRenderTarget=function(e){if(this._renderable&&this._viewer){var t=this._viewer.getRenderScene().getRenderTarget().getName(),r=this._viewer.getCamera().core,n=r.viewport[2],a=r.viewport[3],o=new i.a(t,this._resourceManager,n,a,e||{});return this._renderTargets.push(o),o}return null},e.prototype._getRenderTargetPR=function(e){if(!this._viewer)return null;if(!this._renderable)return null;var t=this._viewer.getRenderScene().getRenderTargetPR().getName(),r=this._viewer.getCamera().core,n=r.viewport[2],a=r.viewport[3],o=new i.a(t,this._resourceManager,n,a,e||{});return this._renderTargets.push(o),o},e.prototype._getDefaultShadow=function(){return this._viewer.getRenderScene()._shadow},e.prototype._isShadowEnabled=function(){return this._viewer.getRenderScene().isShadowEnabled()},e}();t.a=n},function(e,t,r){"use strict";var i=r(7),n=r(18),a=r(4),o=function(){function e(e){this.name=e,this.modelName="",this.layerName="",this.materialName="",this.transparent=!1,this.textureFullName="",this.textureTransparent=!1,this.hasMask=!1,this.hasTexture=!1,this.parameters={},this.reservedParameters={}}return e.prototype.destroy=function(){this.name=null,delete this.name,this.parameters=null,delete this.parameters,this.reservedParameters=null,delete this.reservedParameters},e.prototype.attachShader=function(e,t){if(e&&e.ready){for(var r in e.userUniforms)if(!this.parameters.hasOwnProperty(r))if(this.parameters[r]=new i.a,r.match(/uTexture\d/)){this.hasTexture=!0;var n=parseInt(r.substr(8));if(n>2){console.error("can't support >3 user textures. See shader '"+e.name+"'");continue}this.parameters[r].texUnit=n,this.parameters[r].upload=this.parameters[r].uploadTexture}else this.parameters[r].upload=this.parameters[r].uploadValue;var a;for(a in this.parameters)e.userUniforms[a]||delete this.parameters[a];for(a in this.reservedParameters)e.reservedUniforms[a]||delete this.reservedParameters[a];return e}},e.prototype.use=function(e){var t;for(t in this.reservedParameters){(r=e.reservedUniforms[t])&&this.reservedParameters[t].upload(r,e.getGL())}for(t in this.parameters){var r;(r=e.userUniforms[t])&&this.parameters[t].upload(r,e.getGL())}},e.prototype.absorb=function(e){var t;for(t in this.reservedParameters)this.reservedParameters[t].value=e.reservedParameters[t].value,this.reservedParameters[t].texUnit=e.reservedParameters[t].texUnit;for(t in this.parameters)this.parameters[t].value=e.parameters[t].value,this.parameters[t].texUnit=e.parameters[t].texUnit},e.prototype.restoreTransparency=function(){},e.prototype.hash=function(e){var t="";return t=t+e[0].toString()+e[1].toString()+e[2].toString()+e[3].toString()},e.prototype.setDiffuseTexture=function(e,t,r,i){var o=this,s=!1,l=t.gl;if(this.hasTexture||(s=!0,r.forEach(function(e){var r=t.getShader("texture",e.shader.flags),i=e.shader.shaderSource.name;if(!r.ready){var n=a.a.texture;if(r.createFromShaderSource(n,e.shader.flags),!r.ready)throw"modelo3d error at creating shader '"+i+"'!"}e.setShader(r)})),this.reservedParameters.m_uDiffuseTexture){var u=void 0;if(this.reservedParameters.m_uDiffuseTexture.value&&(u=this.reservedParameters.m_uDiffuseTexture.value.name),e instanceof n.a)s&&e.setWarp(l.REPEAT),this.reservedParameters.m_uDiffuseTexture.value=e;else if(e instanceof HTMLImageElement){var c=t.getTexture("texture-"+e),h=(f=this.reservedParameters.m_uDiffuseTexture.value)&&f._filter||c.getFilter(),d=f&&f._wrap||c.getWrap();s&&(d=l.REPEAT);var p=l.RGB;"png"===(_=e.src.split("."))[_.length-1]&&(p=l.RGBA),c.ready=!1,c.createFromImage(e,p,l.UNSIGNED_BYTE,h,d),this.reservedParameters.m_uDiffuseTexture.value=c}else{var f,m=t.getTexture("texture-"+e);h=(f=this.reservedParameters.m_uDiffuseTexture.value||m)&&f._filter||m.getFilter(),d=f&&f._wrap||m.getWrap();s&&(d=l.REPEAT);var _;p=l.RGB;"png"===(_=e.split("."))[_.length-1]&&(p=l.RGBA),m.ready=!1,m.createFromFile(e,p,h,d,function(){o.reservedParameters.m_uDiffuseTexture.value=m,i&&i(u)})}return this.hasTexture=!0,u}console.warn("can not set texture for "+this.name)},e.prototype.removeDiffuseTexture=function(){this.hasTexture=!1,this.reservedParameters.m_uDiffuseTexture.value=void 0},e.prototype.setTextureFullName=function(e){this.textureFullName=e},e.prototype.setModelName=function(e){this.modelName=e},e.prototype.setLayerName=function(e){this.layerName=e},e.prototype.setMaterialName=function(e){this.materialName=e},e}();t.a=o},function(e,t,r){"use strict";var i,n=new URL(window.location.href).searchParams.get("filePath"),a=new Map;!function(e){e.OpenImage=function(e,t){return{downloadFile:function(){var r=e;return new t(function(e,t){var i=new XMLHttpRequest;i.onload=function(t){var r=URL.createObjectURL(this.response),i=new Image;return i.setAttribute("crossorigin","anonymous"),i.onload=function(){e(i),URL.revokeObjectURL(r)},i.src=r,null},i.open("GET",r,!0),i.responseType="blob",i.send()})}}},e.OpenFile1=function(e,t,r,i){return{downloadFile:function(o){return new r(function(r,s){i&&a.forEach(function(e){e&&e.abort()});var l=new XMLHttpRequest;a.set(e,l),l.open("GET",(n||"")+e,!0),l||s("CORS not supported"),l.responseType=t,l.onerror=function(e){s(e)},l.setRequestHeader("Accept","*/*"),l.onload=function(){200===l.status||206===l.status?r({data:l.response}):s("fail to retrieve "+e+" http status error:"+l.status),a.delete(e)},l.onprogress=function(e){o&&o(e)},l.send()})},onProgress:function(){}}};var t=function(){function e(e){this._onProgress=e,this._currentDownload=0,this.totalDownload=0}return e.prototype.onProgress=function(e){this._currentDownload+=e,this._onProgress(Math.max(Math.min(this._currentDownload/this.totalDownload,1),0))},e.prototype.getSingleFileProgress=function(){var e=0,t=this;return function(r){var i=r-e;e=r,t.onProgress(i)}},e}();e.ProgressTracker=t,e.MakeIndividualOnProgress=function(e){var t=0;return function(r){var i=r-t;t=r,e.onprogress(i)}}}(i||(i={})),t.a=i},function(e,t,r){"use strict";var i;r.d(t,"a",function(){return i}),function(e){e.Family="family",e.Level="level",e.Element="element",e.Category="category",e.Type="type",e.File="file"}(i||(i={}))},function(e,t,r){"use strict";r.d(t,"d",function(){return n}),r.d(t,"g",function(){return a}),r.d(t,"b",function(){return o}),r.d(t,"e",function(){return s}),r.d(t,"f",function(){return l}),r.d(t,"a",function(){return i}),r.d(t,"c",function(){return u});var i,n=function(e){return function(t){return e.every(function(e){return e in t})}},a=function(e){return function(t){return e.includes(t)}};function o(e,t,r){if(!t(e)){var i=JSON.stringify(e,null,2);throw Error(r+" "+i||"validation of "+i+" failed")}}function s(e){var t=e.createElement("canvas");return null!==WebGLUtils.setupWebGL(t,{webgl2:!1})}function l(e){var t=e.createElement("canvas"),r=WebGLUtils.setupWebGL(t,{webgl2:!0});return!!r&&null!==r.getParameter(r.VERSION).match("WebGL 2.0")}function u(e){var t=e.split(".");return 1===t.length?null:t[t.length-1].toLowerCase()}!function(e){e[e.FRONT=0]="FRONT",e[e.BACK=1]="BACK",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e[e.TOP=4]="TOP",e[e.BOTTOM=5]="BOTTOM",e[e.WORLD=6]="WORLD"}(i||(i={}))},function(e,t,r){"use strict";var i=r(27),n=r(45),a=r(38),o=r.n(a),s=r(39),l=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},u=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},c=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o};var h=function(e,t,r){return l(void 0,void 0,void 0,function(){var t,i,n,a,l;return u(this,function(u){switch(u.label){case 0:if(!s.a.endpoint)throw Error("ModeloAPI needs to be initialized first. Call Modelo.init().");return t=function(e){return decodeURIComponent(escape(window.atob(e)))}(e),i=c(t.split(","),2),n=i[0],a=i[1],[4,o.a.post(s.a.endpoint+"/login",{username:n,password:a},{headers:r})];case 1:return l=u.sent(),localStorage.setItem("token",l.data.token),[2]}})})},d=function(){localStorage.removeItem("token")},p=r(41),f=r(47),m=r(23),_=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},v=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},y={};function g(e,t){return _(this,void 0,void 0,function(){var r,n,a,o,s,l,u,c,h,d,_,g,b;return v(this,function(v){switch(v.label){case 0:return y[e]?[2,y[e]]:t?[3,7]:[4,Object(i.e)(e)];case 1:if(r=v.sent(),!(u=r.convertedUrls.filter(function(e){return"bim.txt"===e.filename})[0]))throw new Error("this model does not contain bim tree information");if(!(c=r.convertedUrls.filter(function(e){return"reference.csv"===e.filename})[0]))throw new Error("this model does not contain reference.csv");return(h=r.convertedUrls.find(function(e){return"docModelId.json"===e.filename}))?[4,Object(p.a)(e,h)]:[3,3];case 2:return a=v.sent().data,[3,4];case 3:a=null,v.label=4;case 4:return n=a,[4,Object(p.a)(e,u)];case 5:return o=v.sent().data,[4,Object(p.a)(e,c)];case 6:return s=v.sent().data,b=Object(f.b)(e,o,s,{useElementIdAsId:!0,docModelId:n,modelId:e,prependModelId:!0}),y[e]=b,[2,b];case 7:return u=(l=t||"/"+e)+"/bim.txt",c=l+"/reference.csv",h=l+"/docModelId.json",[4,m.a.OpenFile1(u,"",Promise).downloadFile()];case 8:return d=v.sent(),[4,m.a.OpenFile1(c,"",Promise).downloadFile()];case 9:_=v.sent(),g=null,v.label=10;case 10:return v.trys.push([10,12,,13]),[4,m.a.OpenFile1(h,"json",Promise).downloadFile()];case 11:return g=v.sent(),[3,13];case 12:return v.sent(),[3,13];case 13:return b=Object(f.b)(e,d.data,_.data,{useElementIdAsId:!0,docModelId:g?g.data:null,modelId:e,prependModelId:!0}),y[e]=b,[2,b]}})})}var b=r(96),w=r.n(b),x=r(95),M=r.n(x),T=r(94),E=r.n(T),S=r(93),A=r.n(S),k=r(62),P=r.n(k),N=r(92),D=r.n(N),I=r(91),O=r.n(I),R=r(58),C=r(13),B=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},L=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},F=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},V=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(F(arguments[t]));return e},U=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},z=/(.*)\+(.*)\/(.*)/,j=function(e,t){return B(void 0,void 0,void 0,function(){var r,i,n,a;return L(this,function(o){switch(o.label){case 0:return[4,g(e)];case 1:return r=o.sent(),Object.keys(r.elements).map(function(e){return r.elements[e]}),i=V([t[0]],t).join("<>"),[4,Object(C.a)().mutate({mutation:A.a,variables:{modelId:e,property:"MODELO-STATUS@688",strValue:i}})];case 2:if(n=o.sent(),n.data,a=n.errors)throw Error(a[0].message);return[2]}})})},G=function(e){return B(void 0,void 0,void 0,function(){var t,r;return L(this,function(i){switch(i.label){case 0:return[4,g(e)];case 1:return t=i.sent(),r=Object.keys(t.elements).map(function(e){return t.elements[e]}),[4,Object(C.a)().mutate({mutation:P.a,variables:{modelId:e,docAndCatIdArr:r.map(function(e){return e.docAndCatId}),elementIdArr:r.map(function(e){return e.elementId}),propertyArr:r.map(function(e){return"MODELO-STATUS@688"})}})];case 2:return i.sent().data,[2]}})})},q=function(e,t,r,i){return B(void 0,void 0,void 0,function(){var n,a;return L(this,function(o){switch(o.label){case 0:return[4,g(e)];case 1:return n=o.sent(),a=t.map(function(e){return n.elements[e]}),[4,Object(C.a)().mutate({mutation:M.a,variables:{modelId:e,docAndCatIdArr:a.map(function(e){return e.docAndCatId}),elementIdArr:a.map(function(e){return e.elementId}),propertyArr:a.map(function(e){return r+"@689"}),strValueArr:a.map(function(e){return i})}})];case 2:return o.sent().data,[2,!0]}})})},Q=function(e,t,r,i){return B(void 0,void 0,void 0,function(){return L(this,function(n){return[2,q(e,[t],r,i)]})})},H=function(e,t,r){return B(void 0,void 0,void 0,function(){var i,n,a;return L(this,function(o){switch(o.label){case 0:if(!z.test(t))throw Error("elementId "+t+" seems not correct");return[4,$(e,t)];case 1:if(i=o.sent(),!(n=i.find(function(e){return"MODELO-STATUS"===e.name&&688===e.groupKey})))throw Error("status needs to be initialized first");return(a=n.strValue.split("<>"))[0]=r,[4,te(e,t,{name:"MODELO-STATUS",group:"MODELO",groupKey:688,strValue:a.join("<>")})];case 2:return o.sent(),[2,r]}})})},W=function(e,t,r){return B(void 0,void 0,void 0,function(){var i,n;return L(this,function(a){switch(a.label){case 0:return[4,g(e)];case 1:return i=a.sent(),n=t.map(function(e){return i.elements[e]}),[4,Object(C.a)().mutate({mutation:P.a,variables:{modelId:e,docAndCatIdArr:n.map(function(e){return e.docAndCatId}),elementIdArr:n.map(function(e){return e.elementId}),propertyArr:n.map(function(e){return r+"@689"})}})];case 2:return a.sent().data,[2,!0]}})})},Y=function(e,t,r){return B(void 0,void 0,void 0,function(){return L(this,function(i){return[2,W(e,[t],r)]})})},X=function(e,t,r){return B(void 0,void 0,void 0,function(){var i,n,a;return L(this,function(o){switch(o.label){case 0:return 0===t.length?[2]:1===t.length?[2,H(e,t[0],r)]:[4,$(e,t[0])];case 1:if(i=o.sent(),!(n=i.find(function(e){return"MODELO-STATUS"===e.name&&688===e.groupKey})))throw Error("status needs to be initialized first");return(a=n.strValue.split("<>"))[0]=r,[4,re(e,t,{name:"MODELO-STATUS",group:"MODELO",groupKey:688,strValue:a.join("<>")})];case 2:return o.sent(),[2,r]}})})},Z=function(e,t){return B(void 0,void 0,void 0,function(){var r,i;return L(this,function(n){switch(n.label){case 0:return[4,$(e,t)];case 1:if(r=n.sent(),!(i=r.find(function(e){return"MODELO-STATUS"===e.name&&688===e.groupKey})))throw Error("status needs to be initialized first");return[2,i.strValue.split("<>")[0]]}})})},K=function(e){return B(void 0,void 0,void 0,function(){var t,r,i,n;return L(this,function(a){switch(a.label){case 0:return[4,g(e)];case 1:return t=a.sent(),r=t.elements[Object.keys(t.elements)[0]],[4,$(e,r.id)];case 2:if(i=a.sent(),!(n=i.find(function(e){return"MODELO-STATUS"===e.name&&688===e.groupKey})))throw Error("status needs to be initialized first");return[2,n.strValue.split("<>").slice(1)]}})})},J=function(e,t){return B(void 0,void 0,void 0,function(){var r,i,n,a,o,s,l,u;return L(this,function(c){switch(c.label){case 0:return 0===t.length?[2,{}]:1!==t.length?[3,2]:[4,Z(e,t[0])];case 1:return r=c.sent(),[2,(u={},u[t[0]]=r,u)];case 2:return[4,g(e)];case 3:return i=c.sent(),n=t.map(function(e){return i.elements[e]}),[4,Object(C.a)().query({query:E.a,variables:{modelId:e,elementIdArr:n.map(function(e){return e.elementId}),propertyArr:n.map(function(e){return"MODELO-STATUS@688"})}})];case 4:if(a=c.sent(),o=a.data,s=a.errors)throw s[0];if(!o.batchGetElementProperties.properties[0].strValues)throw Error("status needs to be initialized first");return l={},o.batchGetElementProperties.elementIdArr.forEach(function(e,r){var i=t.find(function(t){return t.endsWith(e+"")}),n=o.batchGetElementProperties.properties[0].strValues[r];if(!n)throw Error("status needs to be initialized first");l[i]=n.split("<>")[0]}),[2,l]}})})},$=function(e,t,r){return B(void 0,void 0,void 0,function(){var i,n,a,o,s,l,u,c,h,d,p,_,v;return L(this,function(y){switch(y.label){case 0:if(!z.test(t))throw Error("elementId "+t+" seems not correct");return r?[3,4]:[4,g(e)];case 1:return i=y.sent(),[4,ie(e,"unit.json")];case 2:return n=y.sent(),a=i.elements[t],o=n[a.docId],[4,Object(C.a)().query({query:w.a,variables:{modelId:a.originModelId,docAndCatId:a.docAndCatId,elementId:a.elementId}})];case 3:return[2,y.sent().data.elementProperties.map(function(e){var t=e.property,r=e.numValue,i=e.strValue,n=F(t.split("@"),2),a=n[0],s=n[1];return{name:a,group:R[s],groupKey:parseInt(s),strValue:i,numValue:r,unit:o[a]||null}})];case 4:return[4,g(e,s=r||"/"+e)];case 5:return l=y.sent(),u=s+"/unit.json",[4,m.a.OpenFile1(u,"",Promise).downloadFile()];case 6:return c=y.sent(),h=JSON.parse(c.data),d=l.elements[t],p=h[d.docId],_=s+"/elementsInfo.csv",[4,m.a.OpenFile1(_,"",Promise).downloadFile()];case 7:return v=y.sent(),[2,Object(f.c)(t.split("/")[1],v.data).map(function(e){var t=e.property,r=e.numValue,i=e.strValue,n=F(t.split("@"),2),a=n[0],o=n[1];return{name:a,group:R[o],groupKey:parseInt(o),strValue:i,numValue:r,unit:p[a]||null}})]}})})},ee=function(e,t){return B(void 0,void 0,void 0,function(){var r,i,n,a,o,s,l,u,c,h,d;return L(this,function(p){switch(p.label){case 0:return 0===t.length?[2,[]]:1===t.length?[2,$(e,t[0])]:[4,g(e)];case 1:return r=p.sent(),i=t.map(function(e){if(!z.test(e))throw Error("elementId "+e+" seems not correct");return r.elements[e]}),[4,ie(e,"unit.json")];case 2:return p.sent(),[4,ie(e,"typeKeys.json")];case 3:n=p.sent(),a=[];try{for(o=U(i),s=o.next();!s.done;s=o.next())l=s.value,u=r.types[l.typeId],a=a.concat(n[l.docId][u.name]||[])}catch(e){h={error:e}}finally{try{s&&!s.done&&(d=o.return)&&d.call(o)}finally{if(h)throw h.error}}return c=V(new Set(a)).map(function(e){var t=F(e.split("@"),3),r=t[0],i=t[1],n=t[2];return{name:r,group:R[i],groupKey:parseInt(i),strValue:"2"===n?"multiple values":null,numValue:"1"===n?"multiple values":null}}),[2,new Promise(function(e){return e(c)})]}})})},te=function(e,t,r){return B(void 0,void 0,void 0,function(){var i,n;return L(this,function(a){switch(a.label){case 0:return ne(r),[4,g(e)];case 1:return i=a.sent(),n=i.elements[t],[4,Object(C.a)().mutate({mutation:D.a,variables:{modelId:e,docAndCatId:n.docAndCatId,elementId:n.elementId,property:r.name+"@"+r.groupKey,strValue:r.strValue,numValue:r.numValue}})];case 2:return a.sent(),[2,r]}})})},re=function(e,t,r){return B(void 0,void 0,void 0,function(){var i,n,a;return L(this,function(o){switch(o.label){case 0:return ne(r),[4,g(e)];case 1:return i=o.sent(),n=t.map(function(e){return i.elements[e]}),a={modelId:e,docAndCatIdArr:n.map(function(e){return e.docAndCatId}),elementIdArr:n.map(function(e){return e.elementId}),propertyArr:n.map(function(){return r}).map(function(e){return e.name+"@"+e.groupKey})},"string"==typeof r.strValue&&(a.strValueArr=n.map(function(){return r}).map(function(e){return e.strValue})),"number"==typeof r.numValue&&(a.numValueArr=n.map(function(){return r}).map(function(e){return e.numValue})),[4,Object(C.a)().mutate({mutation:O.a,variables:a})];case 2:return o.sent(),[2,r]}})})},ie=function(e,t){return B(void 0,void 0,void 0,function(){var r,n,a,o,s;return L(this,function(l){switch(l.label){case 0:return[4,Object(i.e)(e)];case 1:if(r=l.sent(),!(n=r.convertedUrls.find(function(e){return e.filename===t})))throw Error("this model does not contain "+t);return t.endsWith(".json")?[4,Object(p.a)(e,n)]:[3,3];case 2:return[2,a=l.sent().data];case 3:return t.endsWith(".csv")?[4,Object(p.a)(e,n)]:[3,5];case 4:return a=l.sent().data,o=a.split("\n").splice(1),s={},o.filter(function(e){return e}).forEach(function(e){var t=F(e.trim().split(","),3),r=t[0],i=t[1],n=t[2];s[i+"-"+n]=parseInt(r)}),[2,s];case 5:return[2,null]}})})},ne=function(e){if("number"!=typeof e.numValue&&"string"!=typeof e.strValue)throw Error("[strValue, numValue] should set one correct value");if("number"==typeof e.numValue&&"string"==typeof e.strValue)throw Error("[strValue, numValue] can only set one value");return!0},ae=r(44),oe=r(46),se=r(86),le=r.n(se),ue=r(85),ce=r.n(ue),he=r(84),de=r.n(he),pe=r(83),fe=r.n(pe),me=r(40),_e=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},ve=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},ye=function(e,t,r){return _e(void 0,void 0,void 0,function(){var i;return ve(this,function(n){switch(n.label){case 0:return[4,Object(C.a)().mutate({mutation:le.a,variables:{name:t,modelId:e,elementIds:r}})];case 1:return i=n.sent().data,[2,Object(me.c)(i.addModelSelectionSet)]}})})},ge=function(e){return _e(void 0,void 0,void 0,function(){return ve(this,function(t){switch(t.label){case 0:return[4,Object(C.a)().query({query:ce.a,variables:{modelId:e}})];case 1:return[2,t.sent().data.model.modelSelectionSets.map(function(e){return Object(me.c)(e)})]}})})},be=function(e,t,r){return _e(void 0,void 0,void 0,function(){var i;return ve(this,function(n){switch(n.label){case 0:return[4,Object(C.a)().mutate({mutation:de.a,variables:{id:e,name:t,elementIds:r}})];case 1:return i=n.sent().data,[2,Object(me.c)(i.updateModelSelectionSet)]}})})},we=function(e){return _e(void 0,void 0,void 0,function(){return ve(this,function(t){switch(t.label){case 0:return[4,Object(C.a)().mutate({mutation:fe.a,variables:{id:e}})];case 1:return t.sent(),[2,e]}})})},xe=r(82),Me=r.n(xe),Te=r(81),Ee=r.n(Te),Se=r(80),Ae=r.n(Se),ke=r(79),Pe=r.n(ke),Ne=function(){return(Ne=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},De=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},Ie=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};function Oe(e){return De(this,void 0,void 0,function(){var t,r,i;return Ie(this,function(n){switch(n.label){case 0:return[4,Object(C.a)().query({query:Me.a,variables:{modelId:e}})];case 1:if(t=n.sent(),r=t.data,i=t.errors)throw Error(i[0].message);return[2,r.model.settings]}})})}function Re(e,t){return De(this,void 0,void 0,function(){var r,i,n;return Ie(this,function(a){switch(a.label){case 0:return[4,Object(C.a)().mutate({mutation:Ee.a,variables:Ne({modelId:e},t)})];case 1:if(r=a.sent(),i=r.data,n=r.errors)throw Error(n[0].message);return[2,i]}})})}function Ce(e){return De(this,void 0,void 0,function(){var t,r,i;return Ie(this,function(n){switch(n.label){case 0:return[4,Object(C.a)().mutate({mutation:Ae.a,variables:{id:e}})];case 1:if(t=n.sent(),r=t.data,i=t.errors,!r)throw Error("render setting "+e+" does not exist");if(i)throw Error(i[0].message);return[2,e]}})})}function Be(e,t){return De(this,void 0,void 0,function(){var r,i,n;return Ie(this,function(a){switch(a.label){case 0:return[4,Object(C.a)().mutate({mutation:Pe.a,variables:Ne(Ne({},t),{id:e})})];case 1:if(r=a.sent(),i=r.data,n=r.errors,!i)throw Error("render setting "+e+" does not exist");if(n)throw Error(n[0].message);return[2,i.updateModelSettings]}})})}r.d(t,"h",function(){return i.d}),r.d(t,!1,function(){return i.e}),r.d(t,!1,function(){return i.a}),r.d(t,!1,function(){return i.h}),r.d(t,!1,function(){return i.g}),r.d(t,!1,function(){}),r.d(t,!1,function(){}),r.d(t,!1,function(){return i.f}),r.d(t,!1,function(){return i.b}),r.d(t,!1,function(){return i.c}),r.d(t,!1,function(){}),r.d(t,!1,function(){return n.d}),r.d(t,!1,function(){return n.a}),r.d(t,!1,function(){return n.b}),r.d(t,!1,function(){return n.c}),r.d(t,!1,function(){return h}),r.d(t,!1,function(){return d}),r.d(t,!1,function(){return j}),r.d(t,!1,function(){return G}),r.d(t,"b",function(){return q}),r.d(t,"a",function(){return Q}),r.d(t,!1,function(){return H}),r.d(t,"k",function(){return W}),r.d(t,"j",function(){return Y}),r.d(t,!1,function(){return X}),r.d(t,!1,function(){return Z}),r.d(t,!1,function(){return K}),r.d(t,!1,function(){return J}),r.d(t,"f",function(){return $}),r.d(t,"g",function(){return ee}),r.d(t,"l",function(){return te}),r.d(t,"m",function(){return re}),r.d(t,"e",function(){return g}),r.d(t,!1,function(){return ae.b}),r.d(t,!1,function(){return ae.a}),r.d(t,!1,function(){return oe.c}),r.d(t,!1,function(){return oe.b}),r.d(t,!1,function(){}),r.d(t,!1,function(){return oe.d}),r.d(t,!1,function(){return oe.a}),r.d(t,!1,function(){return ye}),r.d(t,!1,function(){return ge}),r.d(t,!1,function(){return be}),r.d(t,!1,function(){return we}),r.d(t,"i",function(){return Oe}),r.d(t,"c",function(){return Re}),r.d(t,"d",function(){return Ce}),r.d(t,"n",function(){return Be})},function(e,t,r){"use strict";r.d(t,"d",function(){return k}),r.d(t,"e",function(){return P}),r.d(t,"a",function(){return N}),r.d(t,"h",function(){return D}),r.d(t,"g",function(){return I}),r.d(t,"f",function(){return O}),r.d(t,"b",function(){return R}),r.d(t,"c",function(){return C});var i=r(57),n=r.n(i),a=r(117),o=r.n(a),s=r(116),l=r.n(s),u=r(115),c=r.n(u),h=r(114),d=r.n(h),p=r(113),f=r.n(p),m=(r(112),r(111)),_=r.n(m),v=r(110),y=r.n(v),g=r(109),b=r.n(g),w=r(38),x=r.n(w),M=r(13),T=r(44),E=r(41),S=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},A=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},k=function(e){return S(void 0,void 0,void 0,function(){var t,r,i;return A(this,function(a){switch(a.label){case 0:return[4,Object(M.a)().query({query:n.a,variables:{modelId:e}})];case 1:if(t=a.sent(),r=t.data,i=t.errors,!r||!r.model)throw Error("model does not exist");if(i)throw Error(i[0].message);return[2,B(r.model)]}})})},P=function(e){return S(void 0,void 0,void 0,function(){var t,r,i;return A(this,function(n){switch(n.label){case 0:return[4,Object(M.a)().query({query:o.a,variables:{modelId:e},fetchPolicy:"cache-first"})];case 1:if(t=n.sent(),r=t.data,i=t.errors,!r.model)throw Error("model does not exist");if(i)throw Error(i[0].message);return[2,r.model]}})})},N=function(e){return S(void 0,void 0,void 0,function(){var t;return A(this,function(r){switch(r.label){case 0:return[4,Object(M.a)().mutate({mutation:l.a,variables:{modelId:e},errorPolicy:"all"})];case 1:if(t=r.sent().errors)throw Error(t[0].message);return[2,e]}})})},D=function(e,t,r){return S(void 0,void 0,void 0,function(){var i,n,a,o,s;return A(this,function(l){switch(l.label){case 0:if(!Object(E.b)(e.name))throw Error("file format not valid");return[4,Object(T.b)()];case 1:return i=l.sent(),[4,Object(M.a)().mutate({mutation:c.a,variables:{folderId:i.id,name:e.name,filenames:[e.name],cvtOptions:t?"-comptex":""}})];case 2:return n=l.sent().data,a=n.uploadModel,o=a.id,s=a.uploadUrls,[4,x.a.put(s[0].url,e,{onUploadProgress:function(e){var t=e.loaded/e.total;r&&r(t)}})];case 3:return l.sent(),[4,Object(M.a)().mutate({mutation:d.a,variables:{modelId:o}})];case 4:return[2,B(l.sent().data.uploadModelSuccess)]}})})},I=function(e,t){return S(void 0,void 0,void 0,function(){return A(this,function(r){switch(r.label){case 0:return[4,Object(M.a)().mutate({mutation:f.a,variables:{modelId:e,name:t}})];case 1:return r.sent(),[2,e]}})})},O=function(e,t,r){return S(void 0,void 0,void 0,function(){var i,n;return A(this,function(a){switch(a.label){case 0:if(t.length<2)throw Error("merge model requires at least 2 models");if(i={modelFragments:t.map(function(e){return{modelId:e,tree:"*",transform:[]}})},r)for(n=0;n<r.length;n++)i.modelFragments[n].transform=r[n];return[4,function(e,t){return S(void 0,void 0,void 0,function(){var r;return A(this,function(i){switch(i.label){case 0:return[4,Object(T.b)()];case 1:return r=i.sent(),[4,Object(M.a)().mutate({mutation:_.a,variables:{name:e,query:t,folderId:r.id}})];case 2:return[2,i.sent().data.sliceModel.id]}})})}(e,JSON.stringify(i,null,0))];case 1:return[2,a.sent()]}})})},R=function(e){return S(void 0,void 0,void 0,function(){return A(this,function(t){switch(t.label){case 0:if(null===e||void 0===e)throw Error("Please enter a valid modelId");return[4,Object(M.a)().mutate({mutation:y.a,variables:{modelId:e}})];case 1:return[2,t.sent().data.modelStartConvertToPdf.assetId]}})})},C=function(e){return S(void 0,void 0,void 0,function(){return A(this,function(t){switch(t.label){case 0:return[4,Object(M.a)().query({query:b.a,variables:{assetId:e}})];case 1:return[2,t.sent().data.asset.downloadUrls[0].url]}})})};function B(e){var t,r;return e.downloadUrls&&e.downloadUrls.length&&(t=e.downloadUrls[0],r=e.downloadUrls.filter(function(t){return t.filename!==e.name})),{id:e.id,name:e.name,convertedUrls:e.convertedUrls?e.convertedUrls.map(function(e){return{filename:e.filename,url:e.url}}):null,downloadUrl:t?t.url:null,attachments:r,status:e.status,createdAt:e.createdAt}}},function(e,t,r){"use strict";var i,n=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},a=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};!function(e){e.Text="text",e.ArrayBuffer="arraybuffer",e.Image="blob",e.JSON="json",e.XML="text"}(i||(i={}));var o=(/Chrome/.test(navigator.userAgent)||/Safari/.test(navigator.userAgent))&&(/Google Inc/.test(navigator.vendor)||/Apple Computer, Inc/.test(navigator.vendor)),s={temporary:1073741824};function l(e,t){return n(this,void 0,void 0,function(){var r;return a(this,function(i){return r={create:t},[2,new Promise(function(t,i){(function(){return n(this,void 0,void 0,function(){return a(this,function(e){return[2,new Promise(function(e,t){o&&(window.requestFileSystem||window.webkitRequestFileSystem)?(window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,s.temporary,e,t)):t("FILESYSTEM_NOT_SUPPORTED")})]})})})().then(function(n){return n.root.getDirectory(e,r,t,i)}).catch(i)})]})})}function u(e,t,r){return n(this,void 0,void 0,function(){var i;return a(this,function(n){return i={create:t},[2,new Promise(function(n,a){l(e,t).then(function(e){return e.getFile(r,i,n,a)}).catch(a)})]})})}function c(e){var t=e.split("/").pop()||"";return{directory:e.replace(t,""),fileName:t}}function h(e,t){return n(this,void 0,void 0,function(){return a(this,function(r){return[2,function(e,t){return n(this,void 0,void 0,function(){var r,o,s,l,h,d;return a(this,function(p){switch(p.label){case 0:return r=c(e),o=r.directory,s=r.fileName,[4,u(o,!1,s)];case 1:return l=p.sent(),[4,new Promise(function(e,t){return l.file(e,t)})];case 2:if(0===(h=p.sent()).size)throw new Error("FILE_SIZE_ZERO");return[4,function(e,t){return n(this,void 0,void 0,function(){var r;return a(this,function(n){return r=new FileReader,[2,new Promise(function(n,a){switch(r.onloadend=function(){void 0!==r.result||null!==r.result?n(r.result):a(r.error)},e.type){case i.JSON:case i.XML:r.readAsText(t);break;case i.ArrayBuffer:case i.Image:r.readAsArrayBuffer(t);break;default:throw new Error("File has no type")}})]})})}(t,h)];case 3:return d=p.sent(),t.type===i.Image?[2,new Blob([d],{type:t.mime})]:t.type===i.JSON?[2,JSON.parse(d)]:[2,d]}})})}(e,t).then(function(e){return e}).catch(function(e){return null})]})})}function d(e,t,r){return n(this,void 0,void 0,function(){var o,s;return a(this,function(l){return t.type===i.JSON?(s=JSON.stringify(e),o=new Blob([s],{type:t.mime})):o=t.type===i.Image?e:new Blob([e],{type:t.mime}),[2,function(e,t,r){return n(this,void 0,void 0,function(){var r,i,n,o,s;return a(this,function(a){switch(a.label){case 0:return r=c(e),i=r.directory,n=r.fileName,[4,u(i,!0,n)];case 1:return o=a.sent(),[4,new Promise(function(e){return o.createWriter(e)})];case 2:return s=a.sent(),[2,new Promise(function(e,r){s.onerror=function(e){return r()},s.onwriteend=function(){return e()},s.write(t)})]}})})}(r,o)]})})}var p=r(57),f=r.n(p),m=r(13),_=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},v=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},y=function(e){return _(void 0,void 0,void 0,function(){var t,r,i;return v(this,function(n){switch(n.label){case 0:return[4,Object(m.a)().query({query:f.a,variables:{modelId:e}})];case 1:if(t=n.sent(),r=t.data,i=t.errors,!r||!r.model)throw Error("model does not exist");if(i)throw Error(i[0].message);return[2,function(e){var t,r;return e.downloadUrls&&e.downloadUrls.length&&(t=e.downloadUrls[0],r=e.downloadUrls.filter(function(t){return t.filename!==e.name})),{id:e.id,name:e.name,convertedUrls:e.convertedUrls?e.convertedUrls.map(function(e){return{filename:e.filename,url:e.url}}):null,downloadUrl:t?t.url:null,attachments:r,status:e.status,createdAt:e.createdAt}}(r.model)]}})})};r.d(t,"b",function(){return M}),r.d(t,"a",function(){return T});var g=function(){return(g=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},b=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},w=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},x={bin:{mime:"application/octet-binary",responseType:"arraybuffer",type:i.ArrayBuffer},xml:{mime:"application/xml",responseType:"text",type:i.XML},json:{mime:"application/json",responseType:"json",type:i.JSON},txt:{mime:"text/plain",responseType:"text",type:i.Text},csv:{mime:"text/plain",responseType:"text",type:i.Text},jpeg:{mime:"image/jpg",responseType:"blob",type:i.Image},jpg:{mime:"image/jpg",responseType:"blob",type:i.Image},png:{mime:"image/png",responseType:"blob",type:i.Image},gif:{mime:"image/gif",responseType:"blob",type:i.Image},bmp:{mime:"image/bmp",responseType:"blob",type:i.Image}};function M(e,t){return b(this,void 0,void 0,function(){var r,i,n,a=this;return w(this,function(o){switch(o.label){case 0:return r=[],t?(r=t,[3,3]):[3,1];case 1:return[4,y(e)];case 2:if(!(i=o.sent()))throw Error("model does not exist");r=i.convertedUrls,o.label=3;case 3:return n={},(r=r.map(function(e){return g(g({},e),{filename:e.filename.lastIndexOf(".gz")>=0?e.filename.replace(".gz",""):e.filename})})).forEach(function(t){var r,i=[],o=!1,s=function(e){o||i.forEach(function(t){t(e)})},l=new Promise(function(e,t){r=function(){o=!0,e()}});n[t.filename]={progressEvents:i,progressFn:s,cancel:r,filename:t.filename,downloadFile:function(){return b(a,void 0,void 0,function(){return w(this,function(r){return o?[2]:[2,E(e,t,s,l)]})})},onProgress:function(e){i.push(e)}}}),[2,n]}})})}function T(e,t){return E(e,t,function(){})}function E(e,t,r,i){return b(this,void 0,void 0,function(){var n,a;return w(this,function(o){switch(o.label){case 0:return n=function(e){var t=e.split(".").pop()||"";return x[t.toLowerCase()]}(t.filename),[4,h("model-"+e+"/"+t.filename,n)];case 1:return(a=o.sent())?[3,3]:[4,function(e,t,r,i){return b(this,void 0,void 0,function(){return w(this,function(n){return[2,new Promise(function(n,a){var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType=e.responseType,o.onload=function(){200===o.status||206===o.status?n({data:o.response}):a()},o.onprogress=function(e){r(e)},o.onerror=function(e){a(e)},i&&i.then(function(){o.abort()}),o.send()})]})})}(n,t.url,r,i)];case 2:return d(a=o.sent().data,n,"model-"+e+"/"+t.filename).then(function(){}),[3,4];case 3:new ProgressEvent("mesh"),r({loaded:a.byteLength||0,total:a.byteLength||1}),o.label=4;case 4:return"blob"!==n.responseType?[2,{data:a}]:[2,function(e,t){return b(this,void 0,void 0,function(){var r,i;return w(this,function(n){return r=window.URL||window.webkitURL,i=r.createObjectURL(e),[2,new Promise(function(e,r){var n=new Image;n.name=t,n.src=i,n.crossOrigin="",n.onload=function(){return e(n)},n.onerror=function(e){r("error downloading image:"+t)}})]})})}(a,t.filename)]}})})}},function(e,t,r){"use strict";var i=r(11),n=new(function(){function e(){this.sub=this.subtract,this.mul=this.multiply,this.div=this.divide,this.dist=this.distance,this.sqrDist=this.squaredDistance,this.len=this.length,this.sqrLen=this.squaredLength}return e.prototype.create=function(){var e=new i.a.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},e.prototype.clone=function(e){var t=new i.a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.prototype.fromValues=function(e,t,r,n){var a=new i.a.ARRAY_TYPE(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a},e.prototype.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.prototype.set=function(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e},e.prototype.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},e.prototype.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e},e.prototype.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},e.prototype.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e},e.prototype.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},e.prototype.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},e.prototype.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},e.prototype.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e},e.prototype.distance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+i*i+n*n+a*a)},e.prototype.squaredDistance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return r*r+i*i+n*n+a*a},e.prototype.length=function(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.sqrt(t*t+r*r+i*i+n*n)},e.prototype.squaredLength=function(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n},e.prototype.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},e.prototype.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},e.prototype.normalize=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r*r+i*i+n*n+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=i*o,e[2]=n*o,e[3]=a*o),e},e.prototype.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.prototype.lerp=function(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=t[3];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=o+i*(r[2]-o),e[3]=s+i*(r[3]-s),e},e.prototype.random=function(e,t){return t=t||1,e[0]=i.a.RANDOM(),e[1]=i.a.RANDOM(),e[2]=i.a.RANDOM(),e[3]=i.a.RANDOM(),n.normalize(e,e),n.scale(e,e,t),e},e.prototype.transformMat4=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*o,e[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*o,e[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*o,e[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*o,e},e.prototype.transformQuat=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*i+s*a-l*n,h=u*n+l*i-o*a,d=u*a+o*n-s*i,p=-o*i-s*n-l*a;return e[0]=c*u+p*-o+h*-l-d*-s,e[1]=h*u+p*-s+d*-o-c*-l,e[2]=d*u+p*-l+c*-s-h*-o,e[3]=t[3],e},e.prototype.forEach=function(e,t,r,i,a,o){var s,l,u=n.create();for(t||(t=4),r||(r=0),l=i?Math.min(i*t+r,e.length):e.length,s=r;s<l;s+=t)u[0]=e[s],u[1]=e[s+1],u[2]=e[s+2],u[3]=e[s+3],a(u,u,o),e[s]=u[0],e[s+1]=u[1],e[s+2]=u[2],e[s+3]=u[3];return e},e.prototype.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},e}());t.a=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.visit=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,l=void 0,u=Array.isArray(e),c=[e],h=-1,d=[],p=void 0,f=void 0,m=void 0,_=[],v=[],y=e;do{var g=++h===c.length,b=g&&0!==d.length;if(g){if(f=0===v.length?void 0:_[_.length-1],p=m,m=v.pop(),b){if(u)p=p.slice();else{for(var w={},x=0,M=Object.keys(p);x<M.length;x++){var T=M[x];w[T]=p[T]}p=w}for(var E=0,S=0;S<d.length;S++){var A=d[S][0],k=d[S][1];u&&(A-=E),u&&null===k?(p.splice(A,1),E++):p[A]=k}}h=l.index,c=l.keys,d=l.edits,u=l.inArray,l=l.prev}else{if(f=m?u?h:c[h]:void 0,null===(p=m?m[f]:y)||void 0===p)continue;m&&_.push(f)}var P=void 0;if(!Array.isArray(p)){if(!o(p))throw new Error("Invalid AST Node: "+(0,i.default)(p));var N=s(t,p.kind,g);if(N){if((P=N.call(t,p,f,m,_,v))===a)break;if(!1===P){if(!g){_.pop();continue}}else if(void 0!==P&&(d.push([f,P]),!g)){if(!o(P)){_.pop();continue}p=P}}}void 0===P&&b&&d.push([f,p]),g?_.pop():(l={inArray:u,index:h,keys:c,edits:d,prev:l},u=Array.isArray(p),c=u?p:r[p.kind]||[],h=-1,d=[],m&&v.push(m),m=p)}while(void 0!==l);0!==d.length&&(y=d[d.length-1][1]);return y},t.visitInParallel=function(e){var t=new Array(e.length);return{enter:function(r){for(var i=0;i<e.length;i++)if(!t[i]){var n=s(e[i],r.kind,!1);if(n){var o=n.apply(e[i],arguments);if(!1===o)t[i]=r;else if(o===a)t[i]=a;else if(void 0!==o)return o}}},leave:function(r){for(var i=0;i<e.length;i++)if(t[i])t[i]===r&&(t[i]=null);else{var n=s(e[i],r.kind,!0);if(n){var o=n.apply(e[i],arguments);if(o===a)t[i]=a;else if(void 0!==o&&!1!==o)return o}}}}},t.visitWithTypeInfo=function(e,t){return{enter:function(r){e.enter(r);var i=s(t,r.kind,!1);if(i){var n=i.apply(t,arguments);return void 0!==n&&(e.leave(r),o(n)&&e.enter(n)),n}},leave:function(r){var i,n=s(t,r.kind,!0);return n&&(i=n.apply(t,arguments)),e.leave(r),i}}},t.getVisitFn=s,t.BREAK=t.QueryDocumentKeys=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(r(125));var n={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]};t.QueryDocumentKeys=n;var a=Object.freeze({});function o(e){return Boolean(e&&"string"==typeof e.kind)}function s(e,t,r){var i=e[t];if(i){if(!r&&"function"==typeof i)return i;var n=r?i.leave:i.enter;if("function"==typeof n)return n}else{var a=r?e.leave:e.enter;if(a){if("function"==typeof a)return a;var o=a[t];if("function"==typeof o)return o}}}t.BREAK=a},function(e,t,r){"use strict";var i=r(70),n=r(141),a=Object.prototype.toString;function o(e){return"[object Array]"===a.call(e)}function s(e){return null!==e&&"object"==typeof e}function l(e){return"[object Function]"===a.call(e)}function u(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),o(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===a.call(e)},isBuffer:n,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===a.call(e)},isFile:function(e){return"[object File]"===a.call(e)},isBlob:function(e){return"[object Blob]"===a.call(e)},isFunction:l,isStream:function(e){return s(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function r(r,i){"object"==typeof t[i]&&"object"==typeof r?t[i]=e(t[i],r):t[i]=r}for(var i=0,n=arguments.length;i<n;i++)u(arguments[i],r);return t},extend:function(e,t,r){return u(t,function(t,n){e[n]=r&&"function"==typeof t?i(t,r):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,r){"use strict";var i=r(1),n=r(4),a=r(15),o=r(22),s=r(9),l=r(0),u=r(43),c=r(10),h=function(){function e(){this.origin=null,this.direction=null,this._tempDirect=c.a.create(),this._cameraWorldMatrix=u.a.create()}return e.prototype.set=function(e,t){this.origin=e,this.direction=t},e.prototype.setFromCamera=function(e,t,r){if(r.isPerspective())c.a.copy(this.origin,r.eye),this._tempDirect=r.unproject(e,t,.5),c.a.subtract(this.direction,this._tempDirect,this.origin),c.a.normalize(this.direction,this.direction);else if(r&&r.isOrthographicCamera){c.a.copy(this.origin,r.unproject(e,t,(r._znear+r._zfar)/(r._znear-r._zfar)));var i=c.a.fromValues(0,0,-1);u.a.invert(this._cameraWorldMatrix,r.viewMatrix),c.a.transformMat4(this.direction,i,this._cameraWorldMatrix)}},e.prototype.intersectBox=function(e){var t,r,i,n,a,o,s=1/this.direction[0],l=1/this.direction[1],u=1/this.direction[2],c=this.origin;return s>=0?(t=(e[0]-c[0])*s,r=(e[3]-c[0])*s):(t=(e[3]-c[0])*s,r=(e[0]-c[0])*s),l>=0?(i=(e[1]-c[1])*l,n=(e[4]-c[1])*l):(i=(e[4]-c[1])*l,n=(e[1]-c[1])*l),!(t>n||i>r)&&((i>t||t!=t)&&(t=i),(n<r||r!=r)&&(r=n),u>=0?(a=(e[2]-c[2])*u,o=(e[5]-c[2])*u):(a=(e[5]-c[2])*u,o=(e[2]-c[2])*u),!(t>o||a>r)&&((a>t||t!=t)&&(t=a),(o<r||r!=r)&&(r=o),!(r<0)))},e}(),d=function(){function e(e,t){this._scene=e,this._renderTarget=null,this._shaders=[null,null,null],this._ready=!1,this._phonyCamera=new a.a([0,0,1,1]),this._phonyCamera.enabledCull=!0,this._pickMatrix=l.a.create(),this._material=new o.a("depth-query"),this._gl=t.gl,this._ray=new h,this.recompileShader(t,[]),this._renderTarget=new s.a("query",t,5,5,{clearColor:[0,0,0,0]}),this._ready=this._renderTarget.ready}return e.prototype.destroy=function(){this._ready&&(this._material.destroy(),this._material=null,delete this._material,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._pickMatrix=null,delete this._pickMatrix,this._phonyCamera=null,delete this._phonyCamera)},e.prototype._begin=function(e,t,r,i,n,a){t=r.viewport[3]-1-t,this._pickMatrix[0]=r.viewport[2]/n,this._pickMatrix[5]=r.viewport[3]/a,this._pickMatrix[12]=(r.viewport[2]-2*e)/n,this._pickMatrix[13]=(r.viewport[3]-2*t)/a,l.a.multiply(this._phonyCamera.vpMatrix,this._pickMatrix,r.vpMatrix),this._phonyCamera.viewport[0]=r.viewport[0],this._phonyCamera.viewport[1]=r.viewport[1],this._phonyCamera.viewport[2]=n,this._phonyCamera.viewport[3]=a},e.prototype._end=function(e,t){var r=this._gl;if(e||t){s=new Uint8Array(e*t*4);r.readPixels(0,0,e,t,r.RGBA,r.UNSIGNED_BYTE,s);for(var i=Number.POSITIVE_INFINITY,n=e*t,a=0;a<n;a+=1)if(0!==s[4*a+0]||0!==s[4*a+1]||0!==s[4*a+2]||0!==s[4*a+3]){var o=s[4*a+0]/255*(1/16581375)+s[4*a+1]/255*(1/65025)+s[4*a+2]/255*(1/255)+s[4*a+3]/255;o<i&&(i=o)}return i===Number.POSITIVE_INFINITY?null:i}var s=new Uint8Array(100);return r.readPixels(2,2,1,1,r.RGBA,r.UNSIGNED_BYTE,s),0===s[0]&&0===s[1]&&0===s[2]&&0===s[3]?null:s[0]/255*(1/16581375)+s[1]/255*(1/65025)+s[2]/255*(1/255)+s[3]/255},e.prototype.unproject=function(e,t,r,n){if(!this._ready)return null;var a=this._gl;for(var o in e=Math.floor(e*i.a.devicePixelRatio),t=Math.floor(t*i.a.devicePixelRatio),this._renderTarget.resize(5,5),this._begin(e,t,n,r,5,5),this._phonyCamera.cullUpdate(this._scene.bbox),r.clear(this._renderTarget,a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this._scene.clipping.isEnabled()&&r.renderState.invalidateClip(),this._scene.models)r.drawDrawables(this._renderTarget,this._scene.models[o].drawables,this._phonyCamera,this._shaders,this._material,this._scene.clipping,null,null,!this._scene.needRenderDoubleSided()&&a.CCW);this._scene.terrain&&r.drawDrawables(this._renderTarget,this._scene.terrain.drawables,this._phonyCamera,this._shaders,this._material,this._scene.clipping,null,null,!this._scene.needRenderDoubleSided()&&a.CCW);var s=this._end();return null===s?null:this._getPosition(e,t,s,n)},e.prototype.getNearest=function(e,t,r,n,a,o){if(!this._ready)return null;var s=this._gl;e=Math.floor(e*i.a.devicePixelRatio),t=Math.floor(t*i.a.devicePixelRatio),r=Math.floor(r*i.a.devicePixelRatio),n=Math.floor(n*i.a.devicePixelRatio);var l=Math.floor((e+r)/2),u=Math.floor((t+n)/2),c=r-e,h=n-t;for(var d in this._renderTarget.resize(c,h),this._begin(l,u,o,a,c,h),this._phonyCamera.cullUpdate(this._scene.bbox),a.clear(this._renderTarget,s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),this._scene.clipping.isEnabled()&&a.renderState.invalidateClip(),this._scene.models)a.drawDrawables(this._renderTarget,this._scene.models[d].drawables,this._phonyCamera,this._shaders,this._material,this._scene.clipping,null,null,!this._scene.needRenderDoubleSided()&&s.CCW);this._scene.terrain&&a.drawDrawables(this._renderTarget,this._scene.terrain.drawables,this._phonyCamera,this._shaders,this._material,this._scene.clipping,null,null,!this._scene.needRenderDoubleSided()&&s.CCW);var p=this._end(c,h);return null===p?null:this._getPosition(l,u,p,o)},e.prototype._getPosition=function(e,t,r,i){var n=i.viewport[2],a=i.viewport[3],o=l.e.fromValues(2*(e/n-.5),2*((a-1-t)/a-.5),2*r-1,1),s=l.a.create();l.a.invert(s,i.vpMatrix);var u=l.e.create();return l.e.transformMat4(u,o,s),0!==u[3]?(o[0]=u[0]/u[3],o[1]=u[1]/u[3],o[2]=u[2]/u[3],o[3]=1):l.e.copy(o,u),o},e.prototype.recompileShader=function(e,t){var r=t.slice(0);r.push("ENCODE_DEPTH"),this._shaders[0]=e.getShader("depth-query",r),this._shaders[0].ready||this._shaders[0].createFromShaderSource(n.a.depth,r),r.push("MODEL_TRANSFORM"),this._shaders[1]=e.getShader("depth-query",r),this._shaders[1].ready||this._shaders[1].createFromShaderSource(n.a.depth,r),r.push("INSTANCING"),this._shaders[2]=e.getShader("depth-query",r),this._shaders[2].ready||this._shaders[2].createFromShaderSource(n.a.depth,r),this._material.attachShader(this._shaders[0])},e}();t.a=d},function(e,t,r){"use strict";var i=r(1),n=r(4),a=r(15),o=r(9),s=r(0),l=function(){function e(e,t){this._scene=e,this._material=null,this._shaders=[null,null,null],this._ready=!1,this._renderTarget=null,this._phonyCamera=new a.a([0,0,1,1]),this._pickMatrix=s.a.create(),this._gl=t.gl,this._material=e.materialManager.createMaterialAdhoc("pick-query"),this.recompileShader(t,[]),this._renderTarget=new o.a("query",t,5,5,{clearColor:[0,0,0,0]}),this._ready=this._renderTarget.ready}return e.prototype.destroy=function(){this._ready&&(this._material.destroy(),this._material=null,delete this._material,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget)},e.prototype._beginRegion=function(e,t,r,i,n){t=n.viewport[3]-1-t,i=n.viewport[3]-1-i;var a=Math.abs(r-e)+1,o=Math.abs(i-t)+1;a==this._renderTarget.getWidth()&&o==this._renderTarget.getHeight()||this._renderTarget.resize(a,o),this._pickMatrix[0]=n.viewport[2]/a,this._pickMatrix[5]=n.viewport[3]/o,this._pickMatrix[12]=(n.viewport[2]-e-r)/a,this._pickMatrix[13]=(n.viewport[3]-t-i)/o,s.a.multiply(this._phonyCamera.vpMatrix,this._pickMatrix,n.vpMatrix),this._phonyCamera.viewport[0]=n.viewport[0],this._phonyCamera.viewport[1]=n.viewport[1],this._phonyCamera.viewport[2]=a,this._phonyCamera.viewport[3]=o},e.prototype._endRegion=function(e,t){var r=this._gl,i=[],n=new Uint8Array(e*t*4);this._renderTarget.getFramebuffer().use(),r.readPixels(0,0,e,t,r.RGBA,r.UNSIGNED_BYTE,n);for(var a={},o=0;o<t;o+=2)for(var s=0;s<e;s+=2){var l=4*(o*e+s),u=n[l]+256*n[l+1]+256*n[l+2]*256+256*n[l+3]*256*256;u>0&&(a[u-=1]||(i.push(u),a[u]=1))}return i},e.prototype._changeMaterial=function(e,t){e+=1;var r=[0,0,0];r[0]=(.49+(255&e))/255,r[1]=(.49+(e>>8&255))/255,r[2]=(.49+(e>>16&255))/255;var i=(.49+(e>>24&255))/255;t.setDiffuse(r),t.setTransparent(i)},e.prototype.pickModel=function(e,t,r,i){for(var n=0,a=this._scene.models.length;n<a;n++)if(this.pickDrawable(e,t,r,i,this._scene.models[n].getDrawablesWithoutLine()))return n;return-1},e.prototype.pick=function(e,t,r,i){for(var n in this._scene.models){var a=this._scene.models[n],o=this.pickDrawable(e,t,r,i,a.getDrawablesWithoutLine());if(o)return o}return null},e.prototype.pickDrawable=function(e,t,r,n,a){e=Math.floor(e*i.a.devicePixelRatio),t=Math.floor(t*i.a.devicePixelRatio),this._scene.clipping.isEnabled()&&r.renderState.invalidateClip();var o=this._gl;this._beginRegion(e,t,e,t,n),r.clear(this._renderTarget,o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),r.drawDrawablesCustom(this._renderTarget,a,this._phonyCamera,this._shaders,this._material,this._scene.clipping,!1,this._changeMaterial);var s=this._endRegion(1,1);return 0===s.length?null:a[s[0]]},e.prototype.pickNodesInsideRegion=function(e,t,r,n,a,o,s){if(!this._ready)return[];e=Math.floor(e*i.a.devicePixelRatio),t=Math.floor(t*i.a.devicePixelRatio),r=Math.floor(r*i.a.devicePixelRatio),n=Math.floor(n*i.a.devicePixelRatio),this._scene.clipping.isEnabled()&&a.renderState.invalidateClip();var l=this._gl;this._beginRegion(e,t,r,n,o),a.clear(this._renderTarget,l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),a.drawDrawablesCustom(this._renderTarget,s,this._phonyCamera,this._shaders,this._material,this._scene.clipping,this._scene.needRenderDoubleSided(),this._changeMaterial);var u=this._endRegion(r-e+1,n-t+1);if(0===u.length)return[];var c=[];u.forEach(function(e){var t=s[e].nodes;t&&t.forEach(function(e){e.isVisible()&&c.push(e)})}),this._beginRegion(e,t,r,n,o),a.clear(this._renderTarget,l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),a.drawNodesCustom(this._renderTarget,c,this._phonyCamera,this._shaders,this._material,this._scene.clipping,this._scene.needRenderDoubleSided(),this._changeMaterial);var h=[];return this._endRegion(r-e+1,n-t+1).forEach(function(e){h.push(c[e])}),h},e.prototype.recompileShader=function(e,t){var r=[];t.section&&r.push("CLIPPING"),this._shaders[0]=e.getShader("constant",r),this._shaders[0].ready||this._shaders[0].createFromShaderSource(n.a.constant,r),r.push("MODEL_TRANSFORM"),this._shaders[1]=e.getShader("constant",r),this._shaders[1].ready||this._shaders[1].createFromShaderSource(n.a.constant,r),r.push("INSTANCING"),this._shaders[2]=e.getShader("constant",r),this._shaders[2].ready||this._shaders[2].createFromShaderSource(n.a.constant,r),this._material.attachShader(this._shaders[0]),this._material.setDiffuse(s.d.fromValues(0,0,0)),this._material.setTransparent(0)},e}();t.a=l},function(e,t,r){"use strict";var i=function(){function e(e){this.name=e,this._camera=null,this._saved=null}return e.prototype.bind=function(e,t){this._camera=e,(null==this._saved||t)&&(this._saved=this._camera.animator,this._camera.animator=this)},e.prototype.unbind=function(e){this._camera.animator=this._saved,this._saved=null,this._camera=null},e.prototype.destroy=function(){this._camera=null,delete this._camera},e.prototype.attach=function(e,t){void 0===t&&(t=!1),this._camera=e,(null==this._saved||t)&&(this._saved=this._camera.animator,this._camera.animator=this)},e.prototype.detach=function(){this._camera.animator=this._saved,this._saved=null,this._camera=null},e}();t.a=i},function(e,t,r){"use strict";var i=function(){function e(e,t){this._manager=t,this._ref=0,this.name=e,this.ready=!1}return e.prototype.ref=function(){this._ref++},e.prototype.destroy=function(){this.ready=!1,this._manager=null,delete this._manager,this.name=null,delete this.name},e.prototype.getGL=function(){return this._manager.gl},e.prototype.getManager=function(){return this._manager},e}();t.a=i},function(e,t,r){"use strict";var i=r(1),n=r(49),a=r(34),o=r(0),s=r(3),l=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),u=function(e){function t(t){var r=e.call(this,"transition")||this;return r._srcAt=o.d.create(),r._srcEye=o.d.create(),r._dstAt=o.d.create(),r._dstEye=o.d.create(),r._curAt=o.d.create(),r._curEye=o.d.create(),r._eventEmitter=t,r._srcTheta=0,r._dstTheta=0,r._srcPhi=0,r._dstPhi=0,r._curTheta=0,r._curPhi=0,r._srcDistance=0,r._dstDistance=0,r._startTime=0,r._duration=0,r._speed=1,r._isPano=!1,r}return l(t,e),t.prototype.update=function(){var e=((new Date).getTime()-this._startTime)/this._duration;return e>1?(this._updateCamera(this._dstEye,this._dstAt),this.stop(),!1):(e=Math.sin(e*Math.PI-Math.PI/2)/2+.5,n.a.linear.vec3(this._curAt,this._srcAt,this._dstAt,e),n.a.linear.vec3(this._curEye,this._srcEye,this._dstEye,e),this._updateCamera(this._curEye,this._curAt),!0)},t.prototype.stop=function(){var e=this._camera;e._targetDistance=e._distance;var t=e.eye[0]-e._at[0],r=e.eye[1]-e._at[1],i=e.eye[2]-e._at[2];e._targetPhi=e._phi=Math.asin(Math.min(i/e._targetDistance,1)),e._targetPhi>=.49999*Math.PI&&(e._targetPhi=.49999*Math.PI),e._targetPhi<=-.49999*Math.PI&&(e._targetPhi=-.49999*Math.PI),e._targetTheta=e._theta=Math.atan2(r,t),e._firstPerson&&(e._targetPhi=e._phi=-e._targetPhi,e._targetTheta=e._theta=e._targetTheta+Math.PI),this.detach(),this._eventEmitter&&(this._eventEmitter.emit("Comment-TransitionOver"),this._eventEmitter.emit("Camera-TransitionOver"),this._eventEmitter.emit("commentTransitionEnded"))},t.prototype.start=function(e,t,r,i){var n=this._camera;return t&&n.restore(e),this._setStartPoint(n._at,n.eye,n._distance,e.at,n._theta,n._phi),t||n.restore(e),this._setEndPoint(n._targetDistance,n._targetTheta,n._targetPhi,n._firstPerson,n._scene?n._scene.radius:100,r,i),o.d.copy(n._at,this._srcAt),o.d.copy(n.eye,this._srcEye),t?(this._updateCamera(this._dstEye,this._dstAt,this._dstTheta,this._dstPhi),!0):(this._startTime=(new Date).getTime(),this._updateCamera(this._srcEye,this._srcAt,this._srcTheta,this._srcPhi),!0)},t.prototype.startPano=function(e){var t,r,i=this._camera;this._isPano=!0,o.d.normalize(e,e),o.d.scale(e,e,15),o.d.copy(this._srcAt,i._at),o.d.copy(this._srcEye,i.eye),this._srcDistance=o.d.distance(i.eye,i._at),o.d.copy(this._dstAt,e),this._srcTheta=i._theta,this._srcPhi=i._phi,this._dstDistance=o.d.distance(i.eye,e),this._dstTheta=i._theta,this._dstPhi=i._phi,o.d.copy(this._dstEye,i.eye),t=o.d.distance(this._srcAt,this._dstAt),r=Math.abs(this._srcDistance-this._dstDistance);t=Math.ceil(t/100*450),r=Math.ceil(r/100*450);var n=Math.max(t,r);return n=Math.min(Math.max(n,1),266),this._duration=15*n/this._speed,this._startTime=(new Date).getTime(),this._updateCamera(this._srcEye,this._srcAt,this._srcTheta,this._srcPhi),!0},t.prototype._setStartPoint=function(e,t,r,i,n,a){o.d.copy(this._srcAt,e),o.d.copy(this._srcEye,t),this._srcDistance=r,o.d.copy(this._dstAt,i),this._srcTheta=n,this._srcPhi=a},t.prototype._setEndPoint=function(e,t,r,n,a,s,l){var u,c,h;this._dstDistance=e,this._dstTheta=t,this._dstPhi=r;var d,p,f,m,_,v=Math.sin(this._dstPhi),y=Math.cos(this._dstPhi),g=Math.sin(this._dstTheta);u=y*Math.cos(this._dstTheta),c=y*g,h=v,n&&(u=-u,c=-c,h=-h),this._dstEye[0]=this._dstAt[0]+u*this._dstDistance,this._dstEye[1]=this._dstAt[1]+c*this._dstDistance,this._dstEye[2]=this._dstAt[2]+h*this._dstDistance,d=o.d.distance(this._srcAt,this._dstAt),p=o.d.distance(this._srcEye,this._dstEye),f=Math.abs(this._srcDistance-this._dstDistance),m=Math.abs(this._srcTheta-this._dstTheta),_=Math.abs(this._srcPhi-this._dstPhi);var b=i.a.isMobile?300:450,w=s||266;d=Math.ceil(d/a*b),p=Math.ceil(p/a*b),f=Math.ceil(f/a*b),m=Math.ceil(m/Math.PI*90),_=Math.ceil(_/Math.PI*90);var x=Math.max(f,Math.max(d,p));x=Math.max(x,Math.max(m,_)),x=Math.min(Math.max(x,1),w);l=l||this._speed;this._duration=15*x/l},t.prototype._updateCamera=function(e,t,r,i){var n=this._camera;n.eye[0]=e[0],n.eye[1]=e[1],n.eye[2]=e[2],n._at[0]=t[0],n._at[1]=t[1],n._at[2]=t[2],r&&(n._targetTheta=r),i&&(n._targetPhi=i),n._distance=o.d.distance(n.eye,n._at),n._twoPointsPerpective?o.a.lookAt_correction(n.viewMatrix,n.eye,n._at,[0,0,1]):o.a.lookAt(n.viewMatrix,n.eye,n._at,[0,0,1]),n._yVanishFactor[0]=n.viewMatrix[8],n._yVanishFactor[1]=n.viewMatrix[9],n._yVanishFactor[2]=n.viewMatrix[10],n._yVanishFactor[3]=n.viewMatrix[11],n._scene&&n._updateProjection(),o.a.multiply(n.vpMatrix,n.projectMatrix,n.viewMatrix),n._cull.update()},t.prototype.setTransitionSpeed=function(e){this._speed=s.a.clamp(e,.01,Number.POSITIVE_INFINITY)},t.prototype._onEnd=function(){return!1},t.prototype._onStart=function(){return!1},t}(a.a);t.a=u},function(e,t,r){"use strict";var i,n,a,o,s,l,u,c,h,d,p,f;r.d(t,"c",function(){return i}),r.d(t,"b",function(){return n}),r.d(t,"k",function(){return a}),r.d(t,"j",function(){return o}),r.d(t,"d",function(){return s}),r.d(t,"e",function(){return l}),r.d(t,"h",function(){return u}),r.d(t,"g",function(){return c}),r.d(t,"i",function(){return h}),r.d(t,"f",function(){return d}),r.d(t,"a",function(){return p}),r.d(t,"l",function(){return f}),function(e){e.Init="INIT",e.Error="ERROR",e.Done="DONE"}(i||(i={})),function(e){e.Wbs="wbs",e.Img="img",e.File="file",e.Dwg="dwg",e.ModelConvertedPdf="modelConvertedPdf",e.Image360="image360"}(n||(n={})),function(e){e.Urgent="urgent",e.Critical="critical",e.Normal="normal"}(a||(a={})),function(e){e.Img="img",e.Txt="txt"}(o||(o={})),function(e){e.Urgent="urgent",e.Critical="critical",e.Normal="normal"}(s||(s={})),function(e){e.Open="open",e.InProgress="inProgress",e.Resolved="resolved",e.Bot="bot"}(l||(l={})),function(e){e.Normal="normal",e.Versioned="versioned",e.Partial="partial"}(u||(u={})),function(e){e.Error="ERROR",e.Init="INIT",e.Uploaded="UPLOADED",e.Converted="CONVERTED"}(c||(c={})),function(e){e.ElementId="elementId",e.Type="type",e.Family="family",e.Category="category",e.Level="level"}(h||(h={})),function(e){e.Architect="Architect",e.Product="Product"}(d||(d={})),function(e){e.Error="ERROR",e.Init="INIT",e.Uploaded="UPLOADED",e.Converted="CONVERTED"}(p||(p={})),function(e){e.Txt="txt",e.Img="img",e.File="file"}(f||(f={}))},function(e,t,r){e.exports=r(142)},function(e,t,r){"use strict";r.d(t,"b",function(){return n});r(25);var i={endpoint:"",appToken:"",headers:null},n=function(e){i.endpoint=e.endpoint,i.appToken=e.appToken,i.headers=e.headers};t.a=i},function(e,t,r){"use strict";function i(e){var t=Object.create(null);for(var r in e)"symbol"!=typeof e[r]&&"__typename"!==r&&(t[r]=e[r]);return t}function n(e){var t={id:e.id,renderData:JSON.parse(e.camera),createdAt:e.createdAt};return"{}"!==e.message&&(t.extData=JSON.parse(e.message)),t}function a(e){return e.map(function(e){return n(e)})}r.d(t,"c",function(){return i}),r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a})},function(e,t,r){"use strict";r.d(t,"b",function(){return a});var i=r(28);r.d(t,"a",function(){return i.a});var n=[".obj",".3dm",".skp",".stl",".m3d",".zip",".ifc",".rvt",".fbx",".rfa",".nwc",".nwd",".s3d",".max",".dgn"];function a(e){return n.some(function(t){return e.toLowerCase().endsWith(t)})}},function(e,t,r){"use strict";var i=r(15),n=r(34),a=r(0),o=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),s=function(e){function t(t){var r=e.call(this,"navigate")||this;return r._eventEmitter=t,r}return o(t,e),t.prototype.update=function(){var e=this._camera;e.eye[0]+=.15*(e._targetEye[0]-e.eye[0]),e.eye[1]+=.15*(e._targetEye[1]-e.eye[1]),e.eye[2]+=.15*(e._targetEye[2]-e.eye[2]),e._at[0]+=.15*(e._targetAt[0]-e._at[0]),e._at[1]+=.15*(e._targetAt[1]-e._at[1]),e._at[2]+=.15*(e._targetAt[2]-e._at[2]),e._distance=a.d.distance(e.eye,e._at),a.a.lookAt(e.viewMatrix,e.eye,e._at,[0,0,1]);var t=e._targetFov-e._fov;return i.a.prototype._setFov.apply(e,[e._fov+.15*t]),e._updateProjection(),a.a.multiply(e.vpMatrix,e.projectMatrix,e.viewMatrix),e._cull.update(),!0},t.prototype.stop=function(e){if(this._camera){var t=this._camera;if(!e){if(!t)return;var r=this;if(a.d.distance(t.eye,t._targetEye)>.001||a.d.distance(t._at,t._targetAt)>.001||Math.abs(t._targetFov-t._fov)>.001)return void window.setTimeout(function(){r.stop()},100)}t._distance=t._targetDistance;var i=t.eye[0]-t._at[0],n=t.eye[1]-t._at[1],o=t.eye[2]-t._at[2];t._targetPhi=t._phi=Math.asin(Math.min(o/t._targetDistance,1)),t._targetPhi>=.49999*Math.PI&&(t._targetPhi=.49999*Math.PI),t._targetPhi<=-.49999*Math.PI&&(t._targetPhi=-.49999*Math.PI),t._targetTheta=t._theta=Math.atan2(n,i),t._firstPerson&&(t._targetPhi=t._phi=-t._targetPhi,t._targetTheta=t._theta=t._targetTheta+Math.PI),this.detach(),this._eventEmitter&&this._eventEmitter.emit("Camera-Navigation-Over")}},t.prototype.start=function(e,t,r,i,n){var a=this._camera,o=t[0]-e[0],s=t[1]-e[1],l=t[2]-e[2],u=Math.sqrt(o*o+s*s+l*l);if(u>1e-6?(a._targetAt[0]=t[0],a._targetAt[1]=t[1],a._targetAt[2]=t[2]):(o=a._targetAt[0]-e[0],s=a._targetAt[1]-e[1],l=a._targetAt[2]-e[2],u=Math.sqrt(o*o+s*s+l*l)),a._targetEye[0]=e[0],a._targetEye[1]=e[1],a._targetEye[2]=e[2],r&&(a._targetTheta=r),i&&(a._targetPhi=i),n&&a.setTargetFov(n),a._targetDistance=u,u<.001*a._scene.radius){var c=.001*a._scene.radius/u;a._targetDistance=.001*a._scene.radius,a._targetAt[0]=c*o+a._targetEye[0],a._targetAt[1]=c*s+a._targetEye[1],a._targetAt[2]=c*l+a._targetEye[2]}},t.prototype._onEnd=function(){return!1},t.prototype._onStart=function(){return!1},t}(n.a);t.a=s},function(e,t,r){"use strict";var i=r(11),n=r(53),a=r(10),o=new(function(){function e(){this.mul=this.multiply}return e.prototype.fromValues=function(e,t,r,i,n,a,o,s,l,u,c,h,d,p,f,m){var _=new Float32Array(16);return _[0]=e,_[1]=t,_[2]=r,_[3]=i,_[4]=n,_[5]=a,_[6]=o,_[7]=s,_[8]=l,_[9]=u,_[10]=c,_[11]=h,_[12]=d,_[13]=p,_[14]=f,_[15]=m,_},e.prototype.create=function(){var e=new i.a.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.prototype.clone=function(e){var t=new i.a.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.prototype.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.prototype.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.prototype.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},e.prototype.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},e.prototype.scalarTranspose=function(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=a,e[11]=t[14],e[12]=n,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},e.prototype.simdTranspose=function(e,t){return e},e.prototype.transpose=function(e,t){return i.a.USE_SIMD?this.simdTranspose(e,t):this.scalarTranspose(e,t)},e.prototype.scalarInvert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],_=t[14],v=t[15],y=r*s-i*o,g=r*l-n*o,b=r*u-a*o,w=i*l-n*s,x=i*u-a*s,M=n*u-a*l,T=c*m-h*f,E=c*_-d*f,S=c*v-p*f,A=h*_-d*m,k=h*v-p*m,P=d*v-p*_,N=y*P-g*k+b*A+w*S-x*E+M*T;return N?(N=1/N,e[0]=(s*P-l*k+u*A)*N,e[1]=(n*k-i*P-a*A)*N,e[2]=(m*M-_*x+v*w)*N,e[3]=(d*x-h*M-p*w)*N,e[4]=(l*S-o*P-u*E)*N,e[5]=(r*P-n*S+a*E)*N,e[6]=(_*b-f*M-v*g)*N,e[7]=(c*M-d*b+p*g)*N,e[8]=(o*k-s*S+u*T)*N,e[9]=(i*S-r*k-a*T)*N,e[10]=(f*x-m*b+v*y)*N,e[11]=(h*b-c*x-p*y)*N,e[12]=(s*E-o*A-l*T)*N,e[13]=(r*A-i*E+n*T)*N,e[14]=(m*g-f*w-_*y)*N,e[15]=(c*w-h*g+d*y)*N,e):null},e.prototype.simdInvert=function(e,t){return e},e.prototype.invert=function(e,t){return i.a.USE_SIMD?this.simdInvert(e,t):this.scalarInvert(e,t)},e.prototype.scalarAdjoint=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],_=t[14],v=t[15];return e[0]=s*(d*v-p*_)-h*(l*v-u*_)+m*(l*p-u*d),e[1]=-(i*(d*v-p*_)-h*(n*v-a*_)+m*(n*p-a*d)),e[2]=i*(l*v-u*_)-s*(n*v-a*_)+m*(n*u-a*l),e[3]=-(i*(l*p-u*d)-s*(n*p-a*d)+h*(n*u-a*l)),e[4]=-(o*(d*v-p*_)-c*(l*v-u*_)+f*(l*p-u*d)),e[5]=r*(d*v-p*_)-c*(n*v-a*_)+f*(n*p-a*d),e[6]=-(r*(l*v-u*_)-o*(n*v-a*_)+f*(n*u-a*l)),e[7]=r*(l*p-u*d)-o*(n*p-a*d)+c*(n*u-a*l),e[8]=o*(h*v-p*m)-c*(s*v-u*m)+f*(s*p-u*h),e[9]=-(r*(h*v-p*m)-c*(i*v-a*m)+f*(i*p-a*h)),e[10]=r*(s*v-u*m)-o*(i*v-a*m)+f*(i*u-a*s),e[11]=-(r*(s*p-u*h)-o*(i*p-a*h)+c*(i*u-a*s)),e[12]=-(o*(h*_-d*m)-c*(s*_-l*m)+f*(s*d-l*h)),e[13]=r*(h*_-d*m)-c*(i*_-n*m)+f*(i*d-n*h),e[14]=-(r*(s*_-l*m)-o*(i*_-n*m)+f*(i*l-n*s)),e[15]=r*(s*d-l*h)-o*(i*d-n*h)+c*(i*l-n*s),e},e.prototype.simdAdjoint=function(e,t){return e},e.prototype.adjoint=function(e,t){return i.a.USE_SIMD?this.simdAdjoint(e,t):this.scalarAdjoint(e,t)},e.prototype.determinant=function(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],_=e[15];return(t*o-r*a)*(h*_-d*m)-(t*s-i*a)*(c*_-d*f)+(t*l-n*a)*(c*m-h*f)+(r*s-i*o)*(u*_-d*p)-(r*l-n*o)*(u*m-h*p)+(i*l-n*s)*(u*f-c*p)},e.prototype.simdMultiply=function(e,t,r){return e},e.prototype.scalarMultiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],_=t[13],v=t[14],y=t[15],g=r[0],b=r[1],w=r[2],x=r[3];return e[0]=g*i+b*s+w*h+x*m,e[1]=g*n+b*l+w*d+x*_,e[2]=g*a+b*u+w*p+x*v,e[3]=g*o+b*c+w*f+x*y,g=r[4],b=r[5],w=r[6],x=r[7],e[4]=g*i+b*s+w*h+x*m,e[5]=g*n+b*l+w*d+x*_,e[6]=g*a+b*u+w*p+x*v,e[7]=g*o+b*c+w*f+x*y,g=r[8],b=r[9],w=r[10],x=r[11],e[8]=g*i+b*s+w*h+x*m,e[9]=g*n+b*l+w*d+x*_,e[10]=g*a+b*u+w*p+x*v,e[11]=g*o+b*c+w*f+x*y,g=r[12],b=r[13],w=r[14],x=r[15],e[12]=g*i+b*s+w*h+x*m,e[13]=g*n+b*l+w*d+x*_,e[14]=g*a+b*u+w*p+x*v,e[15]=g*o+b*c+w*f+x*y,e},e.prototype.multiply=function(e,t,r){return i.a.USE_SIMD?this.simdMultiply(e,t,r):this.scalarMultiply(e,t,r)},e.prototype.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},e.prototype.getScaling=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[4],o=t[5],s=t[6],l=t[8],u=t[9],c=t[10];return e[0]=Math.sqrt(r*r+i*i+n*n),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(l*l+u*u+c*c),e},e.prototype.getRotation=function(e,t){var r=t[0]+t[5]+t[10],i=0;return r>0?(i=2*Math.sqrt(r+1),e[3]=.25*i,e[0]=(t[6]-t[9])/i,e[1]=(t[8]-t[2])/i,e[2]=(t[1]-t[4])/i):t[0]>t[5]&&t[0]>t[10]?(i=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/i,e[0]=.25*i,e[1]=(t[1]+t[4])/i,e[2]=(t[8]+t[2])/i):t[5]>t[10]?(i=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/i,e[0]=(t[1]+t[4])/i,e[1]=.25*i,e[2]=(t[6]+t[9])/i):(i=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/i,e[0]=(t[8]+t[2])/i,e[1]=(t[6]+t[9])/i,e[2]=.25*i),e},e.prototype.scalarTranslate=function(e,t,r){var i,n,a,o,s,l,u,c,h,d,p,f,m=r[0],_=r[1],v=r[2];return t===e?(e[12]=t[0]*m+t[4]*_+t[8]*v+t[12],e[13]=t[1]*m+t[5]*_+t[9]*v+t[13],e[14]=t[2]*m+t[6]*_+t[10]*v+t[14],e[15]=t[3]*m+t[7]*_+t[11]*v+t[15]):(i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=i,e[1]=n,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=i*m+s*_+h*v+t[12],e[13]=n*m+l*_+d*v+t[13],e[14]=a*m+u*_+p*v+t[14],e[15]=o*m+c*_+f*v+t[15]),e},e.prototype.simdTranslate=function(e,t,r){return e},e.prototype.translate=function(e,t,r){return i.a.USE_SIMD?this.simdTranslate(e,t,r):this.scalarTranslate(e,t,r)},e.prototype.scalarScale=function(e,t,r){var i=r[0],n=r[1],a=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.prototype.SIMDScale=function(e,t,r){return e},e.prototype.scale=function(e,t,r){return i.a.USE_SIMD?this.SIMDScale(e,t,r):this.scalarScale(e,t,r)},e.prototype.rotate=function(e,t,r,n){var a,o,s,l,u,c,h,d,p,f,m,_,v,y,g,b,w,x,M,T,E,S,A,k,P=n[0],N=n[1],D=n[2],I=Math.sqrt(P*P+N*N+D*D);return Math.abs(I)<i.a.EPSILON?null:(P*=I=1/I,N*=I,D*=I,a=Math.sin(r),s=1-(o=Math.cos(r)),l=t[0],u=t[1],c=t[2],h=t[3],d=t[4],p=t[5],f=t[6],m=t[7],_=t[8],v=t[9],y=t[10],g=t[11],b=P*P*s+o,w=N*P*s+D*a,x=D*P*s-N*a,M=P*N*s-D*a,T=N*N*s+o,E=D*N*s+P*a,S=P*D*s+N*a,A=N*D*s-P*a,k=D*D*s+o,e[0]=l*b+d*w+_*x,e[1]=u*b+p*w+v*x,e[2]=c*b+f*w+y*x,e[3]=h*b+m*w+g*x,e[4]=l*M+d*T+_*E,e[5]=u*M+p*T+v*E,e[6]=c*M+f*T+y*E,e[7]=h*M+m*T+g*E,e[8]=l*S+d*A+_*k,e[9]=u*S+p*A+v*k,e[10]=c*S+f*A+y*k,e[11]=h*S+m*A+g*k,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},e.prototype.scalarRotateX=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*n+u*i,e[5]=o*n+c*i,e[6]=s*n+h*i,e[7]=l*n+d*i,e[8]=u*n-a*i,e[9]=c*n-o*i,e[10]=h*n-s*i,e[11]=d*n-l*i,e},e.prototype.SIMDRotateX=function(e,t,r){return e},e.prototype.rotateX=function(e,t,r){return i.a.USE_SIMD?this.SIMDRotateX(e,t,r):this.scalarRotateX(e,t,r)},e.prototype.scalarRotateY=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n-u*i,e[1]=o*n-c*i,e[2]=s*n-h*i,e[3]=l*n-d*i,e[8]=a*i+u*n,e[9]=o*i+c*n,e[10]=s*i+h*n,e[11]=l*i+d*n,e},e.prototype.SIMDRotateY=function(e,t,r){return e},e.prototype.rotateY=function(e,t,r){return i.a.USE_SIMD?this.SIMDRotateY(e,t,r):this.scalarRotateY(e,t,r)},e.prototype.scalarRotateZ=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n+u*i,e[1]=o*n+c*i,e[2]=s*n+h*i,e[3]=l*n+d*i,e[4]=u*n-a*i,e[5]=c*n-o*i,e[6]=h*n-s*i,e[7]=d*n-l*i,e},e.prototype.SIMDRotateZ=function(e,t,r){return e},e.prototype.rotateZ=function(e,t,r){return i.a.USE_SIMD?this.SIMDRotateZ(e,t,r):this.scalarRotateZ(e,t,r)},e.prototype.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},e.prototype.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.prototype.fromRotation=function(e,t,r){var n,a,o,s=r[0],l=r[1],u=r[2],c=Math.sqrt(s*s+l*l+u*u);return Math.abs(c)<i.a.EPSILON?null:(s*=c=1/c,l*=c,u*=c,n=Math.sin(t),o=1-(a=Math.cos(t)),e[0]=s*s*o+a,e[1]=l*s*o+u*n,e[2]=u*s*o-l*n,e[3]=0,e[4]=s*l*o-u*n,e[5]=l*l*o+a,e[6]=u*l*o+s*n,e[7]=0,e[8]=s*u*o+l*n,e[9]=l*u*o-s*n,e[10]=u*u*o+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},e.prototype.fromXRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.prototype.fromYRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.prototype.fromZRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.prototype.fromRotationTranslation=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=i+i,l=n+n,u=a+a,c=i*s,h=i*l,d=i*u,p=n*l,f=n*u,m=a*u,_=o*s,v=o*l,y=o*u;return e[0]=1-(p+m),e[1]=h+y,e[2]=d-v,e[3]=0,e[4]=h-y,e[5]=1-(c+m),e[6]=f+_,e[7]=0,e[8]=d+v,e[9]=f-_,e[10]=1-(c+p),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},e.prototype.fromRotationTranslationScale=function(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=t[3],l=n+n,u=a+a,c=o+o,h=n*l,d=n*u,p=n*c,f=a*u,m=a*c,_=o*c,v=s*l,y=s*u,g=s*c,b=i[0],w=i[1],x=i[2];return e[0]=(1-(f+_))*b,e[1]=(d+g)*b,e[2]=(p-y)*b,e[3]=0,e[4]=(d-g)*w,e[5]=(1-(h+_))*w,e[6]=(m+v)*w,e[7]=0,e[8]=(p+y)*x,e[9]=(m-v)*x,e[10]=(1-(h+f))*x,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},e.prototype.fromRotationTranslationScaleOrigin=function(e,t,r,i,n){var a=t[0],o=t[1],s=t[2],l=t[3],u=a+a,c=o+o,h=s+s,d=a*u,p=a*c,f=a*h,m=o*c,_=o*h,v=s*h,y=l*u,g=l*c,b=l*h,w=i[0],x=i[1],M=i[2],T=n[0],E=n[1],S=n[2];return e[0]=(1-(m+v))*w,e[1]=(p+b)*w,e[2]=(f-g)*w,e[3]=0,e[4]=(p-b)*x,e[5]=(1-(d+v))*x,e[6]=(_+y)*x,e[7]=0,e[8]=(f+g)*M,e[9]=(_-y)*M,e[10]=(1-(d+m))*M,e[11]=0,e[12]=r[0]+T-(e[0]*T+e[4]*E+e[8]*S),e[13]=r[1]+E-(e[1]*T+e[5]*E+e[9]*S),e[14]=r[2]+S-(e[2]*T+e[6]*E+e[10]*S),e[15]=1,e},e.prototype.fromQuat=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r+r,s=i+i,l=n+n,u=r*o,c=i*o,h=i*s,d=n*o,p=n*s,f=n*l,m=a*o,_=a*s,v=a*l;return e[0]=1-h-f,e[1]=c+v,e[2]=d-_,e[3]=0,e[4]=c-v,e[5]=1-u-f,e[6]=p+m,e[7]=0,e[8]=d+_,e[9]=p-m,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.prototype.frustum=function(e,t,r,i,n,a,o){var s=1/(r-t),l=1/(n-i),u=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*l,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(n+i)*l,e[10]=(o+a)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*u,e[15]=0,e},e.prototype.perspective=function(e,t,r,i,n){var a=1/Math.tan(t/2),o=1/(i-n);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+i)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*n*i*o,e[15]=0,e},e.prototype.perspectiveFromFieldOfView=function(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(n+a);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(o-s)*l*.5,e[9]=(n-a)*u*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e},e.prototype.ortho=function(e,t,r,i,n,a,o){var s=1/(t-r),l=1/(i-n),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(n+i)*l,e[14]=(o+a)*u,e[15]=1,e},e.prototype.lookAt=function(e,t,r,n){var a,o,s,l,u,c,h,d,p,f,m=t[0],_=t[1],v=t[2],y=n[0],g=n[1],b=n[2],w=r[0],x=r[1],M=r[2];return Math.abs(m-w)<i.a.EPSILON&&Math.abs(_-x)<i.a.EPSILON&&Math.abs(v-M)<i.a.EPSILON?this.identity(e):(h=m-w,d=_-x,p=v-M,a=g*(p*=f=1/Math.sqrt(h*h+d*d+p*p))-b*(d*=f),o=b*(h*=f)-y*p,s=y*d-g*h,(f=Math.sqrt(a*a+o*o+s*s))?(a*=f=1/f,o*=f,s*=f):(a=0,o=0,s=0),l=d*s-p*o,u=p*a-h*s,c=h*o-d*a,(f=Math.sqrt(l*l+u*u+c*c))?(l*=f=1/f,u*=f,c*=f):(l=0,u=0,c=0),e[0]=a,e[1]=l,e[2]=h,e[3]=0,e[4]=o,e[5]=u,e[6]=d,e[7]=0,e[8]=s,e[9]=c,e[10]=p,e[11]=0,e[12]=-(a*m+o*_+s*v),e[13]=-(l*m+u*_+c*v),e[14]=-(h*m+d*_+p*v),e[15]=1,e)},e.prototype.lookAt_correction=function(e,t,r,n){var a,s,l,u,c,h,d,p,f,m,_=t[0],v=t[1],y=t[2],g=n[0],b=n[1],w=n[2],x=r[0],M=r[1],T=r[2];return Math.abs(_-x)<i.a.EPSILON&&Math.abs(v-M)<i.a.EPSILON&&Math.abs(y-T)<i.a.EPSILON?o.identity(e):(d=_-x,p=v-M,f=y-T,a=b*(f*=m=1/Math.sqrt(d*d+p*p+f*f))-w*(p*=m),s=w*(d*=m)-g*f,l=g*p-b*d,(m=Math.sqrt(a*a+s*s+l*l))?(a*=m=1/m,s*=m,l*=m):(a=0,s=0,l=0),u=p*l-f*s,c=f*a-d*l,h=d*s-p*a,(m=Math.sqrt(u*u+c*c+h*h))?(u*=m=1/m,c*=m,h*=m):(u=0,c=0,h=0),e[0]=a,e[1]=u,e[2]=d,e[3]=0,e[4]=s,e[5]=c,e[6]=p,e[7]=0,e[8]=0,e[9]=1,e[10]=0,e[11]=0,e[12]=-(a*_+s*v),e[13]=-(u*_+c*v+y),e[14]=-(d*_+p*v),e[15]=1,e)},e.prototype.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},e.prototype.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},e.prototype.setFromEuler=function(e,t,r,i){var n=Math.cos(t),a=Math.sin(t),o=Math.cos(r),s=Math.sin(r),l=Math.cos(i),u=Math.sin(i),c=n*l,h=n*u,d=a*l,p=a*u;return e[0]=o*l,e[4]=-o*u,e[8]=s,e[1]=h+d*s,e[5]=c-p*s,e[9]=-a*o,e[2]=p-c*s,e[6]=d+h*s,e[10]=n*o,e},e.prototype.getEuler=function(e){var t=e[0],r=e[4],i=e[8],n=(e[1],e[5]),a=e[9],o=(e[2],e[6]),s=e[10],l=[];return Math.max(-1,Math.min(1,i)),l[1]=Math.asin(Math.max(-1,Math.min(1,i))),Math.abs(i)<.9999999?(l[0]=Math.atan2(-a,s),l[2]=Math.atan2(-r,t)):(l[0]=Math.atan2(o,n),l[2]=0),l},e.prototype.extractTransform=function(e){var t=a.a.create(),r=n.a.create(),i=a.a.fromValues(e[0],e[4],e[8]),o=a.a.fromValues(e[1],e[5],e[9]),s=a.a.fromValues(e[2],e[6],e[10]),l=[a.a.length(i),a.a.length(o),a.a.length(s)],u=a.a.create();a.a.cross(u,o,s),a.a.dot(i,u)<0&&(l[0]=-l[0]),e[0]/=l[0],e[4]/=l[0],e[8]/=l[0],e[1]/=l[1],e[5]/=l[1],e[9]/=l[1],e[2]/=l[2],e[6]/=l[2],e[10]/=l[2],this.getRotation(r,e);var c=this.create();return c instanceof Float32Array&&(this.transpose(c,e),this.getRotation(r,c),this.getTranslation(t,c)),{position:t,rotation:r,scale:l}},e}());t.a=o},function(e,t,r){"use strict";r.d(t,"b",function(){return c}),r.d(t,"a",function(){return h});var i=r(13),n=r(103),a=r.n(n),o=r(102),s=r.n(o),l=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},u=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},c=function(){return l(void 0,void 0,void 0,function(){var e,t,r;return u(this,function(n){switch(n.label){case 0:return[4,Object(i.a)().query({query:a.a,variables:{}})];case 1:if(e=n.sent(),t=e.data,r=e.errors)throw Error(r[0].message);return[2,t.user.projects[0].modelFolder]}})})},h=function(){return l(void 0,void 0,void 0,function(){var e,t,r;return u(this,function(n){switch(n.label){case 0:return[4,Object(i.a)().query({query:s.a,variables:{}})];case 1:if(e=n.sent(),t=e.data,r=e.errors)throw Error(r[0].message);return[2,t.user.projects[0].assetFolder]}})})}},function(e,t,r){"use strict";r.d(t,"d",function(){return T}),r.d(t,"a",function(){return E}),r.d(t,"b",function(){return S}),r.d(t,"c",function(){return A});var i=r(101),n=r.n(i),a=r(38),o=r.n(a),s=r(56),l=r.n(s),u=r(100),c=r.n(u),h=r(99),d=r.n(h),p=r(98),f=r.n(p),m=r(97),_=r.n(m),v=r(13),y=r(44),g=r(25),b=r(37),w=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},x=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},M={dwg:b.b.Dwg},T=function(e,t,r){return w(void 0,void 0,void 0,function(){var i,a,s,l,u,h,d;return x(this,function(p){switch(p.label){case 0:return[4,Object(y.a)()];case 1:return i=p.sent(),a=t,t||(s=Object(g.c)(e.name),a=s&&M[s]?M[s]:b.b.File),[4,Object(v.a)().mutate({mutation:c.a,variables:{folderId:i.id,assetName:e.name,fileNames:[e.name],type:a}})];case 2:return l=p.sent().data,u=l.uploadAsset,h=u.id,d=u.uploadUrls,[4,o.a.put(d[0].url,e,{headers:{"Content-Type":n.a.getType(e.name)},onUploadProgress:function(e){var t=e.loaded/e.total;r&&r(t)}})];case 3:return p.sent(),[4,Object(v.a)().mutate({mutation:_.a,variables:{assetId:h}})];case 4:return[2,k(p.sent().data.uploadAssetSuccess)]}})})},E=function(e){return w(void 0,void 0,void 0,function(){var t;return x(this,function(r){switch(r.label){case 0:return[4,Object(v.a)().mutate({mutation:f.a,variables:{assetId:e}})];case 1:if(t=r.sent().errors)throw Error(t[0].message);return[2,e]}})})},S=function(e){return w(void 0,void 0,void 0,function(){var t,r,i;return x(this,function(n){switch(n.label){case 0:return[4,Object(v.a)().query({query:l.a,variables:{assetId:e}})];case 1:if(t=n.sent(),r=t.data,i=t.errors,!r.asset)throw Error("asset does not exist");if(i)throw Error(i[0].message);return[2,k(r.asset)]}})})},A=function(e,t){return w(void 0,void 0,void 0,function(){return x(this,function(r){switch(r.label){case 0:return[4,Object(v.a)().mutate({mutation:d.a,variables:{assetId:e,name:t}})];case 1:return r.sent(),[2,e]}})})};function k(e){if(!e.downloadUrls)throw Error("get download url for "+e.name+" failed");return{id:e.id,name:e.name,status:e.status,type:e.type,downloadUrl:e.downloadUrls[0].url,convertedUrls:e.convertedUrls?e.convertedUrls.map(function(e){return{filename:e.filename,url:e.url}}):null,panoConvertedUrl:e.panoConvertedUrl?e.panoConvertedUrl:null,updatedAt:e.updatedAt}}},function(e,t,r){"use strict";r.d(t,"c",function(){return y}),r.d(t,"b",function(){return g}),r.d(t,"d",function(){return b}),r.d(t,"a",function(){return w});var i=r(90),n=r.n(i),a=r(89),o=r.n(a),s=r(88),l=r.n(s),u=r(87),c=r.n(u),h=r(61),d=r.n(h),p=r(13),f=r(40),m=function(){return(m=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},_=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},v=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},y=function(e){return _(void 0,void 0,void 0,function(){var t,r,i;return v(this,function(a){switch(a.label){case 0:return[4,Object(p.a)().query({query:n.a,variables:{modelId:e}})];case 1:if(t=a.sent(),r=t.data,i=t.errors)throw Error(i[0].message);if(!r.modelComments)throw Error("model "+e+" does not exist");return[2,r.modelComments]}})})},g=function(e){return _(void 0,void 0,void 0,function(){var t,r,i;return v(this,function(n){switch(n.label){case 0:return[4,Object(p.a)().mutate({mutation:l.a,variables:{id:e}})];case 1:if(t=n.sent(),r=t.data,i=t.errors,!r)throw Error("comment "+e+" does not exist");if(i)throw Error(i[0].message);return[2,e]}})})},b=function(e,t){return _(void 0,void 0,void 0,function(){var r,i,n,a,s,l,u,h;return v(this,function(d){switch(d.label){case 0:return[4,Object(p.a)().query({query:o.a,variables:{commentId:e},fetchPolicy:"cache-first"})];case 1:if(r=d.sent(),i=r.data,n=r.errors,!i)throw Error("comment "+e+" does not exist");if(n)throw Error(n[0].message);return a=i.modelComment,s=m(m({},JSON.parse(a.message)),t),[4,Object(p.a)().mutate({mutation:c.a,variables:{id:e,message:JSON.stringify(s),plainText:"placeholder"}})];case 2:if(l=d.sent(),u=l.data,h=l.errors,!u)throw Error("comment "+e+" does not exist");if(h)throw Error(h[0].message);return[2,Object(f.a)(u.updateModelComment)]}})})},w=function(e,t,r){return _(void 0,void 0,void 0,function(){var i,n;return v(this,function(a){switch(a.label){case 0:return[4,Object(p.a)().mutate({mutation:d.a,variables:{modelId:e,plainText:"placeholder",message:JSON.stringify(r),camera:JSON.stringify(t)}})];case 1:return i=a.sent().data,n=i.addModelComment,[2,Object(f.a)(n)]}})})}},function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return o}),r.d(t,"c",function(){return s});var i=r(24),n=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},a=[{type:i.a.File,idLabel:"modelId",container:"models"},{type:i.a.Level,idLabel:"levelId",container:"levels"},{type:i.a.Category,idLabel:"categoryId",container:"categories"},{type:i.a.Family,idLabel:"familyId",container:"families"},{type:i.a.Type,idLabel:"typeId",container:"types"},{type:i.a.Element,idLabel:"elementId",container:"elements"}];function o(e,t,r,o){void 0===o&&(o={parseProps:!1,useElementIdAsId:!1,onlyDocNames:!1,ignoreElements:!1,modelId:null,docModelId:null,prependModelId:!1});var s={};r.split("\n").splice(1).forEach(function(e){var t=n(e.split(","),3),r=t[0],i=t[1],a=t[2];i&&a&&(s[i+"-"+a.trim()]=r)});var l=1,u=1,c=o.prependModelId?o.modelId+"+":"",h=(o.parseProps,!!o.useElementIdAsId),d={elements:{},types:{},families:{},levels:{},models:{},categories:{}},p=t.split("\n"),f=[null,null,null,null,null];if(o.onlyDocNames){for(var m=0;m<p.length;m++){var _=p[m];if(0!==_.length&&" "!==_.charAt(0)){var v=n(p[0].match(/(.*)\((\d)\)$/),3),y=v[0],g=(v[1],v[2]);d.models[c+g]={type:i.a.File,index:0,id:c+g,name:"地形环境",childrenNum:0,isTerrain:!0,levels:[],pathName:y+"("+g+")"}}}return d}return p.forEach(function(t){for(var r=0;" "===t.charAt(0)&&t.length>0;)r++,t=t.substr(1);t=t.trim();var p=a[r],m={type:p.type,index:u++,id:c+p.idLabel+"-"+l++,name:t||"undefined",pathName:t||"",childrenNum:0};if(p.type===i.a.File){if(!t)return;var _=(t=t.slice(0,-1)).lastIndexOf("(");if(-1===_)throw new Error("Not a valid bim.txt");var v=t.substring(_+1),y=n(o.docModelId?o.docModelId[v].split("_"):[null,null],2),g=y[0],b=y[1];m.id=c+v,m.docId=v,m.name=t.substring(0,_),m.originModelId=g||o.modelId,m.originDocId=b||v,m.pathName=m.name+"("+m.docId+")"}if(p.type===i.a.Element){if(o.ignoreElements)return;m.modelId=e,m.props="{}";var w=f[0],x=f[2];m.docId=w.docId;var M=n(o.docModelId?o.docModelId[m.docId].split("_"):[null,null],2);g=M[0],b=M[1];m.docAndCatId=parseInt(s[w.docId+"-"+x.name]),m.originModelId=g||o.modelId,m.originDocId=b||m.docId,h&&(m.id=c+(w.docId+"/")+t),m.elementId=""+t}else{m[a[r+1].container]=[]}if(p.type!==i.a.File){var T=a[r-1],E=f[r-1];E[p.container].push(m.id),E.childrenNum+=1,m[T.idLabel]=E.id}p.type===i.a.Family&&(m.levelId=f[1].id),f[r]=m,d[p.container][m.id]=m}),d}function s(e,t){var r=[],i=0;return(t=t.trim()).split("\n").forEach(function(t){if(t.indexOf(e)>-1){var n=t.split(","),a=void 0,o=void 0,s=void 0;0===i?(a=n[2].trim(),o=Number(n[3]),s=(s=n[4].trim()).length>0?s:null):(a=n[2].slice(1,n[2].length-1).trim(),o=Number(n[3]),s=(s=n[4].slice(1,n[4].length-1).trim()).length>0?s:null),i++,r.push({property:a,numValue:o,strValue:s,__typename:"ElementProperty"})}}),r}},function(e,t,r){"use strict";r.d(t,"c",function(){return c}),r.d(t,"b",function(){return h}),r.d(t,"a",function(){return i});var i,n=r(46),a=r(50),o=r(40),s=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},l=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},u={};function c(e,t,r){return s(this,void 0,void 0,function(){var i;return l(this,function(o){return i=function(e){var t=e.getTool("Comment");t||(t=e.addTool(new a.a(e)));return t.create()}(e),[2,new Promise(function(e,a){n.a(t,i,r||{}).then(function(t){return u[t.id]=t.renderData,e(t)}).catch(a)})]})})}function h(e,t){var r=e.getTool("Comment");r||(r=e.addTool(new a.a(e))),r.activate(u[t]),r.setEnabled(!0)}!function(e){e.get=function(e){return s(this,void 0,void 0,function(){return l(this,function(t){return[2,new Promise(function(t,r){n.c(e).then(function(e){var r=Object(o.b)(e);return r.forEach(function(e){u[e.id]=e.renderData}),t(r)}).catch(r)})]})})},e.remove=function(e){return s(this,void 0,void 0,function(){return l(this,function(t){return[2,new Promise(function(t,r){n.b(e).then(function(e){return delete u[e],t(e)}).catch(r)})]})})},e.update=function(e,t){return s(this,void 0,void 0,function(){return l(this,function(r){return[2,n.d(e,t)]})})}}(i||(i={}))},function(e,t,r){"use strict";var i;!function(e){!function(e){e.vec3=function(e,t,r,i){var n=1-i;e[0]=n*t[0]+i*r[0],e[1]=n*t[1]+i*r[1],e[2]=n*t[2]+i*r[2]},e.scalar=function(e,t,r){return(1-r)*e+r*t}}(e.linear||(e.linear={})),function(e){e.vec3=function(e,t,r,i){var n=1-(i=3*i*i-2*i*i*i);e[0]=n*t[0]+i*r[0],e[1]=n*t[1]+i*r[1],e[2]=n*t[2]+i*r[2]},e.scalar=function(e,t,r){return(1-(r=3*r*r-2*r*r*r))*e+r*t}}(e.cubic||(e.cubic={}))}(i||(i={})),t.a=i},function(e,t,r){"use strict";var i=r(3),n=r(17),a=r(36),o=r(42),s=r(32),l=r(33),u=r(21),c=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),h=function(e){function t(t){var r=e.call(this,"Comment",!1,t)||this;return r._pickQuery=new l.a(r._scene,r._resourceManager),r._depthQuery=new s.a(r._scene,r._resourceManager),r._animator=new a.a(t.getEventEmitter()),r._clippingEnabled=r._scene.clipping.isEnabled(),r._comments={},r}return c(t,e),t.prototype.destroy=function(){this._pickQuery.destroy(),this._pickQuery=null,delete this._pickQuery,this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery,this._comments=null,delete this._comments},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupport3D=function(e){return!0},t.prototype._recompileShader=function(){if(this._scene.clipping.isEnabled()!==this._clippingEnabled){this._clippingEnabled=this._scene.clipping.isEnabled();var e=[];n.a.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this._pickQuery.recompileShader(this._resourceManager,e),this._depthQuery.recompileShader(this._resourceManager,e)}},t.prototype.activate=function(e){var t=!1,r=this._scene.clipping.isEnabled(),n=!1;if(e.section){if(n=!0,r){var s=i.a.aabb.create(e.section.min,e.section.max);t=i.a.aabb.isEqual(this._scene.clipping.get(),s)}e.section.min&&e.section.max?this._scene.clipping.set(e.section.min,e.section.max):this._scene.clipping.set(e.section.planes,e.section.points)}else this._scene.clipping.reset(),n=!1;t=t||r!==n,(this._camera.animator instanceof a.a||this._camera.animator instanceof o.a)&&this._camera.animator.stop(!0),this._animator.attach(this._camera),this._animator.start(e.camera,!1)},t.prototype.setTransitionSpeed=function(e){this._animator.setTransitionSpeed(e)},t.prototype.create=function(){return{element:"",camera:this._camera.dump(),section:this._scene.clipping.isEnabled()?{planes:this._scene.clipping.getClippingPlanes(!0),points:this._scene.clipping.getClippingPoints(!0)}:null}},t.prototype.setComments=function(e){for(var t=0;t<e.length;t++)this._comments[e[t].id]=e[t].renderData},t.prototype.addComment=function(e){this._comments[e.id]=e.renderData},t.prototype.deleteComment=function(e){delete this._comments[e]},t.prototype._onEnableChanged=function(){if(this._recompileShader(),!this._enabled){for(var e={},t=0,r=this._comments.length;t<r;t++){e[this._comments[t].id]={x:-1,y:-1,visible:!1}}this._viewer.notifyEventListener("Comment-UpdateRenderStatus",e)}},t}(u.a);t.a=h},function(e,t,r){"use strict";var i=r(0),n=[0,0,0],a=function(){function e(e){this._default=i.a.create(),this._buffer=null,this.identity=!0,this.normalMatrix=null,e?(this.identity=!1,this.matrix=i.a.clone(e)):this.matrix=i.a.create(),i.a.copy(this._default,this.matrix),this._buffer=new Float32Array(32),this._updateMatrixBuffer()}return e.prototype.destroy=function(){this._buffer=null,delete this._buffer,this._default=null,delete this._default,this.matrix=null,delete this.matrix,this.identity=null,delete this.identity},e.prototype._updateMatrixBuffer=function(){this.identity?this.normalMatrix=i.a.create():(this.normalMatrix=i.a.create(),i.a.invert(this.normalMatrix,this.matrix),i.a.transpose(this.normalMatrix,this.normalMatrix));for(var e=0;e<16;e++)this._buffer[e]=this.matrix[e];for(e=0;e<16;e++)this._buffer[e+16]=this.normalMatrix[e]},e.prototype.use=function(e,t){var r=null,i=t.getGL();i.isWebGL2?(r=t.reservedUniforms.m_uPerNode)&&r.upload(this._buffer,i):((r=t.reservedUniforms["m_uPerNode.modelMatrix"])&&r.upload(this.matrix,i),(r=t.reservedUniforms["m_uPerNode.normalMatrix"])&&r.upload(this.normalMatrix,i))},e.prototype.setRotation=function(e,t){this._default===this.matrix&&(this._default=i.a.clone(this.matrix)),this.identity=!1;var r=[this.matrix[12],this.matrix[13],this.matrix[14]],n=this.getScaling();i.a.identity(this.matrix),this.setScaling(n[0],n[1],n[2]);var a=i.a.create(),o=i.b.create();i.b.setAxisAngle(o,[e[0],e[1],e[2]],t),i.a.fromQuat(a,o),this.multiply(a),this.matrix[12]=r[0],this.matrix[13]=r[1],this.matrix[14]=r[2],this._updateMatrixBuffer()},e.prototype.setRotationByQuat=function(e){this._default===this.matrix&&(this._default=i.a.clone(this.matrix)),this.identity=!1;var t=[this.matrix[12],this.matrix[13],this.matrix[14]],r=this.getScaling();i.a.identity(this.matrix),this.setScaling(r[0],r[1],r[2]);var n=i.a.create();i.a.fromQuat(n,e),this.multiply(n),this.matrix[12]=t[0],this.matrix[13]=t[1],this.matrix[14]=t[2],this._updateMatrixBuffer()},e.prototype.translate=function(e,t,r){this._default===this.matrix&&(this._default=i.a.clone(this.matrix)),this.identity=!1,this.matrix[12]+=e,this.matrix[13]+=t,this.matrix[14]+=r,this._updateMatrixBuffer()},e.prototype.setTranslation=function(e,t,r){this._default===this.matrix&&(this._default=i.a.clone(this.matrix)),this.identity=!1,this.matrix[12]=this._default[12]+e,this.matrix[13]=this._default[13]+t,this.matrix[14]=this._default[14]+r,this._updateMatrixBuffer()},e.prototype.setScaling=function(e,t,r){this.identity=!1;var n=[this.matrix[0],this.matrix[1],this.matrix[2]],a=[this.matrix[4],this.matrix[5],this.matrix[6]],o=[this.matrix[8],this.matrix[9],this.matrix[10]],s=e/Math.sqrt(i.d.dot(n,n)),l=t/Math.sqrt(i.d.dot(a,a)),u=r/Math.sqrt(i.d.dot(o,o));this.matrix[0]*=s,this.matrix[1]*=s,this.matrix[2]*=s,this.matrix[4]*=l,this.matrix[5]*=l,this.matrix[6]*=l,this.matrix[8]*=u,this.matrix[9]*=u,this.matrix[10]*=u,this._updateMatrixBuffer()},e.prototype.getScaling=function(){var e=[this.matrix[0],this.matrix[1],this.matrix[2]],t=[this.matrix[4],this.matrix[5],this.matrix[6]],r=[this.matrix[8],this.matrix[9],this.matrix[10]];return n[0]=Math.sqrt(i.d.dot(e,e)),n[1]=Math.sqrt(i.d.dot(t,t)),n[2]=Math.sqrt(i.d.dot(r,r)),n},e.prototype.set=function(e){e?(this.identity=!1,i.a.copy(this.matrix,e)):i.a.identity(this.matrix),i.a.copy(this._default,this.matrix),this._updateMatrixBuffer()},e.prototype.setTransform=function(e){e?(this.identity=!1,i.a.multiply(this.matrix,e,this._default)):i.a.identity(this.matrix),this._updateMatrixBuffer()},e.prototype.reset=function(){i.a.copy(this.matrix,this._default),this.identity=Math.abs(this.matrix[0]-1)<1e-5&&Math.abs(this.matrix[5]-1)<1e-5&&Math.abs(this.matrix[10]-1)<1e-5&&Math.abs(this.matrix[12])<1e-5&&Math.abs(this.matrix[13])<1e-5&&Math.abs(this.matrix[14])<1e-5,this._updateMatrixBuffer()},e.prototype.getInverted=function(e){i.a.invert(e,this.matrix)},e.prototype.multiply=function(e){this._default===this.matrix&&(this._default=i.a.clone(this.matrix)),this.identity?i.a.copy(this.matrix,e):i.a.multiply(this.matrix,e,this.matrix),this.identity=Math.abs(this.matrix[0]-1)<1e-5&&Math.abs(this.matrix[5]-1)<1e-5&&Math.abs(this.matrix[10]-1)<1e-5&&Math.abs(this.matrix[12])<1e-5&&Math.abs(this.matrix[13])<1e-5&&Math.abs(this.matrix[14])<1e-5,this._updateMatrixBuffer()},e.prototype.multiplyMatrices=function(e,t){i.a.multiply(this.matrix,e,t),this.identity=Math.abs(this.matrix[0]-1)<1e-5&&Math.abs(this.matrix[5]-1)<1e-5&&Math.abs(this.matrix[10]-1)<1e-5&&Math.abs(this.matrix[12])<1e-5&&Math.abs(this.matrix[13])<1e-5&&Math.abs(this.matrix[14])<1e-5,this._updateMatrixBuffer()},e}();t.a=a},function(e,t){var r,i,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var l,u=[],c=!1,h=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&p())}function p(){if(!c){var e=s(d);c=!0;for(var t=u.length;t;){for(l=u,u=[];++h<t;)l&&l[h].run();h=-1,t=u.length}l=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||c||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,r){"use strict";var i=r(11),n=r(54),a=r(43),o=r(10),s=r(29),l=new(function(){function e(){this.fromValues=s.a.fromValues,this.copy=s.a.copy,this.set=s.a.set,this.add=s.a.add,this.mul=this.multiply,this.scale=s.a.scale,this.dot=s.a.dot,this.lerp=s.a.lerp,this.length=s.a.length,this.len=this.length,this.squaredLength=s.a.squaredLength,this.sqrLen=this.squaredLength,this.normalize=s.a.normalize}return e.prototype.create=function(){var e=new i.a.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},e.prototype.rotationTo=function(e,t,r){var i=o.a.create(),n=o.a.fromValues(1,0,0),a=o.a.fromValues(0,1,0),s=o.a.dot(t,r);return s<-.999999?(o.a.cross(i,n,t),o.a.length(i)<1e-6&&o.a.cross(i,a,t),o.a.normalize(i,i),this.setAxisAngle(e,i,Math.PI),e):s>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(o.a.cross(i,t,r),e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=1+s,this.normalize(e,e))},e.prototype.toYXZ=function(e){var t=a.a.create();a.a.fromQuat(t,e);var r={_x:0,_y:0,_z:0},i=t[0],n=(t[4],t[8]),o=t[1],s=t[5],l=t[9],u=t[2],c=(t[6],t[10]);return r._x=Math.asin(-Math.max(-1,Math.min(1,l))),Math.abs(l)<.99999?(r._y=Math.atan2(n,c),r._z=Math.atan2(o,s)):(r._y=Math.atan2(-u,i),r._z=0),r},e.prototype.setAxes=function(e,t,r,i){var a=n.a.create();return a[0]=r[0],a[3]=r[1],a[6]=r[2],a[1]=i[0],a[4]=i[1],a[7]=i[2],a[2]=-t[0],a[5]=-t[1],a[8]=-t[2],this.normalize(e,this.fromMat3(e,a))},e.prototype.clone=function(e){var t=new i.a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.prototype.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},e.prototype.setAxisAngle=function(e,t,r){r*=.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e},e.prototype.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],l=r[1],u=r[2],c=r[3];return e[0]=i*c+o*s+n*u-a*l,e[1]=n*c+o*l+a*s-i*u,e[2]=a*c+o*u+i*l-n*s,e[3]=o*c-i*s-n*l-a*u,e},e.prototype.rotateX=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=i*l+o*s,e[1]=n*l+a*s,e[2]=a*l-n*s,e[3]=o*l-i*s,e},e.prototype.rotateY=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=i*l-a*s,e[1]=n*l+o*s,e[2]=a*l+i*s,e[3]=o*l-n*s,e},e.prototype.rotateZ=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=i*l+n*s,e[1]=n*l-i*s,e[2]=a*l+o*s,e[3]=o*l-a*s,e},e.prototype.fromYXZ=function(e,t,r,i){var n=Math.cos(r/2),a=Math.cos(t/2),o=Math.cos(i/2),s=Math.sin(r/2),l=Math.sin(t/2),u=Math.sin(i/2);return e[0]=s*a*o+n*l*u,e[1]=n*l*o-s*a*u,e[2]=n*a*u-s*l*o,e[3]=n*a*o+s*l*u,e},e.prototype.calculateW=function(e,t){var r=t[0],i=t[1],n=t[2];return e[0]=r,e[1]=i,e[2]=n,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),e},e.prototype.slerp=function(e,t,r,i){var n,a,o,s,l,u=t[0],c=t[1],h=t[2],d=t[3],p=r[0],f=r[1],m=r[2],_=r[3];return(a=u*p+c*f+h*m+d*_)<0&&(a=-a,p=-p,f=-f,m=-m,_=-_),1-a>1e-6?(n=Math.acos(a),o=Math.sin(n),s=Math.sin((1-i)*n)/o,l=Math.sin(i*n)/o):(s=1-i,l=i),e[0]=s*u+l*p,e[1]=s*c+l*f,e[2]=s*h+l*m,e[3]=s*d+l*_,e},e.prototype.sqlerp=function(e,t,r,i,n,a){var o=this.create(),s=this.create();return this.slerp(o,t,n,a),this.slerp(s,r,i,a),this.slerp(e,o,s,2*a*(1-a)),e},e.prototype.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r*r+i*i+n*n+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-i*s,e[2]=-n*s,e[3]=a*s,e},e.prototype.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},e.prototype.fromMat3=function(e,t){var r,i=t[0]+t[4]+t[8];if(i>0)r=Math.sqrt(i+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var a=(n+1)%3,o=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*a+a]-t[3*o+o]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*a+o]-t[3*o+a])*r,e[a]=(t[3*a+n]+t[3*n+a])*r,e[o]=(t[3*o+n]+t[3*n+o])*r}return e},e.prototype.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},e}());t.a=l},function(e,t,r){"use strict";var i=r(11),n=new(function(){function e(){this.mul=this.multiply}return e.prototype.create=function(){var e=new i.a.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.prototype.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},e.prototype.clone=function(e){var t=new i.a.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.prototype.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.prototype.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.prototype.transpose=function(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},e.prototype.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=c*o-s*u,d=-c*a+s*l,p=u*a-o*l,f=r*h+i*d+n*p;return f?(f=1/f,e[0]=h*f,e[1]=(-c*i+n*u)*f,e[2]=(s*i-n*o)*f,e[3]=d*f,e[4]=(c*r-n*l)*f,e[5]=(-s*r+n*a)*f,e[6]=p*f,e[7]=(-u*r+i*l)*f,e[8]=(o*r-i*a)*f,e):null},e.prototype.adjoint=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8];return e[0]=o*c-s*u,e[1]=n*u-i*c,e[2]=i*s-n*o,e[3]=s*l-a*c,e[4]=r*c-n*l,e[5]=n*a-r*s,e[6]=a*u-o*l,e[7]=i*l-r*u,e[8]=r*o-i*a,e},e.prototype.determinant=function(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*(u*a-o*l)+r*(-u*n+o*s)+i*(l*n-a*s)},e.prototype.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=r[0],p=r[1],f=r[2],m=r[3],_=r[4],v=r[5],y=r[6],g=r[7],b=r[8];return e[0]=d*i+p*o+f*u,e[1]=d*n+p*s+f*c,e[2]=d*a+p*l+f*h,e[3]=m*i+_*o+v*u,e[4]=m*n+_*s+v*c,e[5]=m*a+_*l+v*h,e[6]=y*i+g*o+b*u,e[7]=y*n+g*s+b*c,e[8]=y*a+g*l+b*h,e},e.prototype.translate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=r[0],p=r[1];return e[0]=i,e[1]=n,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=d*i+p*o+u,e[7]=d*n+p*s+c,e[8]=d*a+p*l+h,e},e.prototype.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=Math.sin(r),p=Math.cos(r);return e[0]=p*i+d*o,e[1]=p*n+d*s,e[2]=p*a+d*l,e[3]=p*o-d*i,e[4]=p*s-d*n,e[5]=p*l-d*a,e[6]=u,e[7]=c,e[8]=h,e},e.prototype.scale=function(e,t,r){var i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.prototype.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},e.prototype.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.prototype.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.prototype.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},e.prototype.fromQuat=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r+r,s=i+i,l=n+n,u=r*o,c=i*o,h=i*s,d=n*o,p=n*s,f=n*l,m=a*o,_=a*s,v=a*l;return e[0]=1-h-f,e[3]=c-v,e[6]=d+_,e[1]=c+v,e[4]=1-u-f,e[7]=p-m,e[2]=d-_,e[5]=p+m,e[8]=1-u-h,e},e.prototype.normalFromMat4=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],_=t[14],v=t[15],y=r*s-i*o,g=r*l-n*o,b=r*u-a*o,w=i*l-n*s,x=i*u-a*s,M=n*u-a*l,T=c*m-h*f,E=c*_-d*f,S=c*v-p*f,A=h*_-d*m,k=h*v-p*m,P=d*v-p*_,N=y*P-g*k+b*A+w*S-x*E+M*T;return N?(N=1/N,e[0]=(s*P-l*k+u*A)*N,e[1]=(l*S-o*P-u*E)*N,e[2]=(o*k-s*S+u*T)*N,e[3]=(n*k-i*P-a*A)*N,e[4]=(r*P-n*S+a*E)*N,e[5]=(i*S-r*k-a*T)*N,e[6]=(m*M-_*x+v*w)*N,e[7]=(_*b-f*M-v*g)*N,e[8]=(f*x-m*b+v*y)*N,e):null},e.prototype.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},e.prototype.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},e}());t.a=n},function(e,t,r){"use strict";var i=r(3),n=function(){function e(e){this._camera=e,this._scene=e._scene,this._frustum=i.a.frustum.createFromMatrix(e.vpMatrix),this._contain=!1,this._p=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],this._t=[0,0,0,0,0,0]}return e.prototype.isCulled=function(e){if(this._contain)return!1;var t=this._frustum,r=e.bbox;return r[this._p[0][0]]*t[0][0]+r[this._p[0][1]]*t[0][1]+r[this._p[0][2]]*t[0][2]>this._t[0]||r[this._p[1][0]]*t[1][0]+r[this._p[1][1]]*t[1][1]+r[this._p[1][2]]*t[1][2]>this._t[1]||r[this._p[2][0]]*t[2][0]+r[this._p[2][1]]*t[2][1]+r[this._p[2][2]]*t[2][2]>this._t[2]||r[this._p[3][0]]*t[3][0]+r[this._p[3][1]]*t[3][1]+r[this._p[3][2]]*t[3][2]>this._t[3]||r[this._p[4][0]]*t[4][0]+r[this._p[4][1]]*t[4][1]+r[this._p[4][2]]*t[4][2]>this._t[4]||r[this._p[5][0]]*t[5][0]+r[this._p[5][1]]*t[5][1]+r[this._p[5][2]]*t[5][2]>this._t[5]},e.prototype.update=function(e){this._frustum=i.a.frustum.createFromMatrix(this._camera.vpMatrix);for(var t=0;t<6;t++)this._p[t][0]=this._frustum[t][0]>0?0:3,this._p[t][1]=this._frustum[t][1]>0?1:4,this._p[t][2]=this._frustum[t][2]>0?2:5,this._t[t]=-this._frustum[t][3];this._contain=i.a.inside.aabb_frustum(e||this._scene.bbox,this._frustum)},e}();t.a=n},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"asset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filenames"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"convertedUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"panoConvertedUrl"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:333}};r.loc.source={body:"query GetAsset($assetId: Int!) {\r\n  asset(id: $assetId) {\r\n    id\r\n    name\r\n    type\r\n    status\r\n    filenames\r\n    createdBy {\r\n      id\r\n      username\r\n    }\r\n    createdAt\r\n    updatedAt\r\n    convertedUrls {\r\n      filename\r\n      url\r\n    }\r\n    downloadUrls {\r\n      filename\r\n      url\r\n    }\r\n    panoConvertedUrl\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetAsset=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetAsset")},function(e,t,r){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ModelInfo"},directives:[]},{kind:"Field",name:{kind:"Name",value:"versionedModels"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ModelInfo"},directives:[]}]}}]}}]}}],loc:{start:0,end:185}};i.loc.source={body:'#import "./ModelInfo.gql"\r\n\r\nquery GetModel($modelId: Id!) {\r\n    model(id: $modelId) {\r\n        ...ModelInfo\r\n        versionedModels {\r\n            ...ModelInfo\r\n        }\r\n    }\r\n}\r\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};i.definitions=i.definitions.concat(function(e){return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})}(r(143).definitions));var a={};function o(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}i.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),a[e.name.value]=t}}),e.exports=i,e.exports.GetModel=function(e,t){var r={kind:e.kind,definitions:[o(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var i=a[t]||new Set,n=new Set,s=new Set;for(i.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){n.has(e)||(n.add(e),(a[e]||new Set).forEach(function(e){s.add(e)}))})}return n.forEach(function(t){var i=o(e,t);i&&r.definitions.push(i)}),r}(i,"GetModel")},function(e){e.exports={0:"PG_IDENTITY_DATA",1:"PG_GEOMETRY",3:"PG_CONSTRUCTION",4:"PG_GRAPHICS",5:"PG_MATERIALS",6:"PG_UNDERLAY",7:"PG_STAIR_TREADS",8:"PG_STAIR_RISERS",9:"PG_STAIR_STRINGERS",10:"PG_ELECTRICAL",11:"PG_PLUMBING",12:"PG_STRUCTURAL",13:"PG_MECHANICAL",14:"PG_PHASING",19:"PG_CONSTRAINTS",20:"PG_PATTERN",21:"PG_VIEW_EXTENTS",22:"PG_VIEW_CAMERA",23:"PG_TEXT",24:"PG_ELECTRICAL_LIGHTING",25:"PG_ELECTRICAL_LOADS",26:"PG_MECHANICAL_LOADS",27:"PG_MECHANICAL_AIRFLOW",28:"PG_STRUCTURAL_ANALYSIS",29:"PG_ENERGY_ANALYSIS",30:"PG_AELECTRICAL",31:"PG_IFC",33:"PG_CURTAIN_GRID_VERT",34:"PG_CURTAIN_GRID_1",35:"PG_CURTAIN_GRID_HORIZ",36:"PG_CURTAIN_GRID_2",37:"PG_CURTAIN_MULLION_VERT",38:"PG_CURTAIN_MULLION_1",39:"PG_CURTAIN_MULLION_HORIZ",40:"PG_CURTAIN_MULLION_2",41:"PG_CURTAIN_GRID",43:"PG_REBAR_SYSTEM_LAYERS",44:"PG_REBAR_ARRAY",45:"PG_ANALYTICAL_MODEL",46:"PG_TRANSLATION_IN",47:"PG_ROTATION_ABOUT",48:"PG_FIRE_PROTECTION",49:"PG_TITLE",50:"PG_TRUSS_FAMILY_VERT_WEB",51:"PG_TRUSS_FAMILY_DIAG_WEB",52:"PG_TRUSS_FAMILY_TOP_CHORD",53:"PG_TRUSS_FAMILY_BOTTOM_CHORD",54:"PG_PROFILE",55:"PG_PROFILE_1",56:"PG_PROFILE_2",57:"PG_GREEN_BUILDING",58:"PG_PATTERN_APPLICATION",59:"PG_LIGHT_PHOTOMETRICS",60:"PG_SLAB_SHAPE_EDIT",61:"PG_ANALYSIS_RESULTS",62:"PG_DISPLAY",63:"PG_CURTAIN_GRID_U",64:"PG_CURTAIN_GRID_V",65:"PG_ADSK_MODEL_PROPERTIES",66:"PG_AREA",67:"PG_CONCEPTUAL_ENERGY_DATA",68:"PG_FITTING",69:"PG_ENERGY_ANALYSIS_DETAILED_AND_CONCEPTUAL_MODELS",70:"PG_ENERGY_ANALYSIS_DETAILED_MODEL",71:"PG_ENERGY_ANALYSIS_CONCEPTUAL_MODEL",72:"PG_FLEXIBLE",73:"PG_GENERAL",74:"PG_ELECTRICAL_CIRCUITING",75:"PG_DATA",76:"PG_CONCEPTUAL_ENERGY_DATA_BUILDING_SERVICES",77:"PG_RAILING_SYSTEM_FAMILY_TOP_RAIL",78:"PG_RAILING_SYSTEM_FAMILY_HANDRAILS",79:"PG_RAILING_SYSTEM_FAMILY_SEGMENT_PATTERN",80:"PG_RAILING_SYSTEM_SEGMENT_PATTERN_REPEAT",81:"PG_RAILING_SYSTEM_SEGMENT_PATTERN_REMAINDER",82:"PG_RAILING_SYSTEM_SEGMENT_POSTS",83:"PG_RAILING_SYSTEM_SEGMENT_U_GRID",84:"PG_RAILING_SYSTEM_SEGMENT_V_GRID",85:"PG_SUPPORT",86:"PG_VISIBILITY",87:"PG_OVERALL_LEGEND",88:"PG_INSULATION",89:"PG_LINING",90:"PG_SYSTEMTYPE_RISEDROP",91:"PG_ANALYTICAL_ALIGNMENT",92:"PG_ANALYTICAL_PROPERTIES",93:"PG_NODES",94:"PG_LENGTH",95:"PG_SPLIT_PROFILE_DIMENSIONS",96:"PG_STAIRS_CALCULATOR_RULES",97:"PG_STAIRS_TREADS_RISERS",98:"PG_TERMINTATION",99:"PG_RAILING_SYSTEM_SECONDARY_FAMILY_HANDRAILS",100:"PG_STAIRS_OPEN_END_CONNECTION",101:"PG_STAIRS_SUPPORTS",102:"PG_STAIRS_WINDERS",103:"PG_CONTINUOUSRAIL_BEGIN_BOTTOM_EXTENSION",104:"PG_CONTINUOUSRAIL_END_TOP_EXTENSION",105:"PG_SEGMENTS_FITTINGS",106:"PG_DIVISION_GEOMETRY",107:"PG_GEOMETRY_POSITIONING",108:"PG_REFERENCE",110:"PG_FABRICATION_PRODUCT_DATA",111:"PG_FORCES",112:"PG_MOMENTS",113:"PG_PRIMARY_END",114:"PG_SECONDARY_END",116:"PG_RELEASES_MEMBER_FORCES",117:"PG_ENERGY_ANALYSIS_ADVANCED",118:"PG_COUPLER_ARRAY",119:"PG_ENERGY_ANALYSIS_BUILDING_DATA",120:"PG_ENERGY_ANALYSIS_ROOM_SPACE_DATA",121:"PG_ENERGY_ANALYSIS_BLDG_CONS_MTL_THERMAL_PROPS",125:"PG_STRUCTURAL_SECTION_GEOMETRY",126:"PG_GEO_LOCATION",688:"MODELO_PROPERTIES",689:"MODELO_CUSTOM_PROPERTIES",888:"MODELO_CONNECTED_DATA","-1":"INVALID"}},function(e,t,r){"use strict";(function(t){var i=r(31),n=r(139),a={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function(){var e;return"undefined"!=typeof XMLHttpRequest?e=r(69):void 0!==t&&(e=r(69)),e}(),transformRequest:[function(e,t){return n(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],function(e){s.headers[e]={}}),i.forEach(["post","put","patch"],function(e){s.headers[e]=i.merge(a)}),e.exports=s}).call(this,r(52))},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddModelComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"plainText"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bimdata"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"camera"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Id"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addModelComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"plainText"},value:{kind:"Variable",name:{kind:"Name",value:"plainText"}}},{kind:"Argument",name:{kind:"Name",value:"bimdata"},value:{kind:"Variable",name:{kind:"Name",value:"bimdata"}}},{kind:"Argument",name:{kind:"Name",value:"camera"},value:{kind:"Variable",name:{kind:"Name",value:"camera"}}},{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bimdata"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"camera"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plainText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:383}};r.loc.source={body:"mutation AddModelComment($message: String!, $plainText: String!, $bimdata: String, $camera: String, $modelId: Id) {\r\n    addModelComment(message: $message, plainText: $plainText, bimdata: $bimdata, camera: $camera, modelId: $modelId) {\r\n        id\r\n        bimdata\r\n        camera\r\n        modelId\r\n        message\r\n        plainText\r\n        createdAt\r\n        updatedAt\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddModelComment=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddModelComment")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"BatchDeleteProperties"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"batchDeleteProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"docAndCatIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"elementIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"propertyArr"},value:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}}}],directives:[]}]}}],loc:{start:0,end:292}};r.loc.source={body:"mutation BatchDeleteProperties(\r\n  $modelId: Id!\r\n  $docAndCatIdArr: [Int]!\r\n  $elementIdArr: [Int]!\r\n  $propertyArr: [String]!\r\n) {\r\n  batchDeleteProperties(\r\n    modelId: $modelId\r\n    docAndCatIdArr: $docAndCatIdArr\r\n    elementIdArr: $elementIdArr\r\n    propertyArr: $propertyArr\r\n  )\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.BatchDeleteProperties=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"BatchDeleteProperties")},function(e,t){},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";r.d(t,"a",function(){return s});var i=Object.prototype,n=i.toString,a=i.hasOwnProperty,o=new Map;function s(e,t){try{return function e(t,r){if(t===r)return!0;var i=n.call(t);var o=n.call(r);if(i!==o)return!1;switch(i){case"[object Array]":if(t.length!==r.length)return!1;case"[object Object]":if(l(t,r))return!0;var s=Object.keys(t),u=Object.keys(r),c=s.length;if(c!==u.length)return!1;for(var h=0;h<c;++h)if(!a.call(r,s[h]))return!1;for(var h=0;h<c;++h){var d=s[h];if(!e(t[d],r[d]))return!1}return!0;case"[object Error]":return t.name===r.name&&t.message===r.message;case"[object Number]":if(t!=t)return r!=r;case"[object Boolean]":case"[object Date]":return+t==+r;case"[object RegExp]":case"[object String]":return t==""+r;case"[object Map]":case"[object Set]":if(t.size!==r.size)return!1;if(l(t,r))return!0;for(var p=t.entries(),f="[object Map]"===i;;){var m=p.next();if(m.done)break;var _=m.value,v=_[0],y=_[1];if(!r.has(v))return!1;if(f&&!e(y,r.get(v)))return!1}return!0}return!1}(e,t)}finally{o.clear()}}function l(e,t){var r=o.get(e);if(r){if(r.has(t))return!0}else o.set(e,r=new Set);return r.add(t),!1}},function(e,t,r){"use strict";function i(e){this.message=e}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,e.exports=i},function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,r){"use strict";var i=r(137);e.exports=function(e,t,r,n,a){var o=new Error(e);return i(o,t,r,n,a)}},function(e,t,r){"use strict";var i=r(31),n=r(138),a=r(136),o=r(135),s=r(134),l=r(68);e.exports=function(e){return new Promise(function(t,u){var c=e.data,h=e.headers;i.isFormData(c)&&delete h["Content-Type"];var d=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",f=e.auth.password||"";h.Authorization="Basic "+btoa(p+":"+f)}if(d.open(e.method.toUpperCase(),a(e.url,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in d?o(d.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:r,config:e,request:d};n(t,u,i),d=null}},d.onerror=function(){u(l("Network Error",e,null,d)),d=null},d.ontimeout=function(){u(l("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",d)),d=null},i.isStandardBrowserEnv()){var m=r(133),_=(e.withCredentials||s(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;_&&(h[e.xsrfHeaderName]=_)}if("setRequestHeader"in d&&i.forEach(h,function(e,t){void 0===c&&"content-type"===t.toLowerCase()?delete h[t]:d.setRequestHeader(t,e)}),e.withCredentials&&(d.withCredentials=!0),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){d&&(d.abort(),u(e),d=null)}),void 0===c&&(c=null),d.send(c)})}},function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return e.apply(t,r)}}},function(e,t,r){"use strict";var i,n,a=r(16),o=function(){function e(e,t){this.name=e,this._enabled=!1,this._canvas=t.getCanvas(),this._viewer=t,this._event=null}return e.prototype.destroy=function(){this._enabled=null,delete this._enabled,this.name=null,delete this.name,this._event=null,delete this._event,this._canvas=null,delete this._canvas},e.prototype.isAvailable=function(e){return!1},e.prototype.setEnabled=function(e){this._enabled=e},e}(),s=r(1),l=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),u=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},h=function(e){function t(t){var r=e.call(this,"mouse",t)||this;r.LEFT_BUTTON=0,r.MIDDLE_BUTTON=1,r.RIGHT_BUTTON=2,r._downListeners=new Map,r._moveListeners=new Map,r._upListeners=new Map,r._wheelListeners=new Map,r._dbClickListeners=new Map,r._x0=-1,r._y0=-1,r._lastWheelTime=0,r._eventQueue=[],r.x=-1,r.y=-1,r.dx=-1,r.dy=-1,r.pressed=!1,r.moved=!1,r.delta=0,r.button=r.LEFT_BUTTON,r.preUpDate=-201,r.nowUpDate=0;var i=0,n=r;function a(e){return function(t){if((t.relatedTarget||t.toElement||t.currentTarget)===n._canvas||"mouseup"===t.type)return t.offsetX_norm=void 0===t.offsetX?t.layerX:t.offsetX,t.offsetY_norm=void 0===t.offsetY?t.layerY:t.offsetY,"firefox"===s.a.browserName||"edge"===s.a.browserName?t.buttonDown=i:t.buttonDown=t.which,e.call(n,t)}}r._canvas.onwheel=a(r._onMouseWheel),r._canvas.onmousemove=a(r._onMouseMove),r._canvas.ondblclick=a(r._onMouseDblclick);var o=a(r._onMouseDown);r._canvas.onmousedown=function(e){i=e.which,o(e)};var l=a(r._onMouseUp);return r._mouseUp=function(e){l(e),i=0},r._onMouseLeave=function(e){i=0},document.addEventListener("mouseup",r._mouseUp,!1),document.addEventListener("mouseout",r._onMouseLeave,!1),r}return l(t,e),t.prototype.destroy=function(){this._canvas.onmousedown=null,this._canvas.onmouseleave=null,this._canvas.ondblclick=null,this._canvas.onwheel=null,this._canvas.onmousemove=null,document.removeEventListener("mouseup",this._mouseUp),document.removeEventListener("mouseout",this._onMouseLeave),this._downListeners=null,delete this._downListeners,this._upListeners=null,delete this._upListeners,this._moveListeners=null,delete this._moveListeners,this._wheelListeners=null,delete this._wheelListeners,this._dbClickListeners=null,delete this._dbClickListeners,this._enabled=null,delete this._eventQueue,e.prototype.destroy.call(this)},t.prototype.addMouseDownListener=function(e,t){t||(t="mouseDown "+a.a.generateUUID()),this._downListeners.set(t,e)},t.prototype.addMouseMoveListener=function(e,t){t||(t="mouseMove "+a.a.generateUUID()),this._moveListeners.set(t,e)},t.prototype.addMouseUpListener=function(e,t){t||(t="mouseUp "+a.a.generateUUID()),this._upListeners.set(t,e)},t.prototype.addMouseWheelListener=function(e,t){t||(t="mouseWheel "+a.a.generateUUID()),this._wheelListeners.set(t,e)},t.prototype.addMouseDbClickListener=function(e,t){t||(t="mouseDbClick "+a.a.generateUUID()),this._dbClickListeners.set(t,e)},t.prototype.isAvailable=function(e){return!e},t.prototype._onMouseDown=function(e){var t,r;if(this._enabled&&this._viewer.isRendering()){e.preventDefault(),this.pressed=!0;var i=e.offsetX_norm,n=e.offsetY_norm;this.dx=0,this.dy=0,this.x=i,this.y=n,this.moved=!1,this.button=e.button,this._x0=this.x,this._y0=this.y,this._event=e,this.isDoubleClick=!1;try{for(var a=u(this._downListeners.entries()),o=a.next();!o.done;o=a.next()){var s=c(o.value,2),l=s[0],h=s[1];if("CameraManipulator"!==l&&h(this))return}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}var d=this._downListeners.get("CameraManipulator");d&&d(this)}},t.prototype._onMouseUp=function(e){var t,r;if(this._enabled&&this._viewer.isRendering()){e.preventDefault(),this.nowUpDate=performance.now();var i=this.nowUpDate-this.preUpDate;this.isDoubleClick=i<200,this.preUpDate=performance.now(),this.pressed=!1;var n=e.offsetX_norm,a=e.offsetY_norm;this.dx=n-this.x,this.dy=a-this.y,this.x=n,this.y=a,this._event=e,this.button=e.button,this.moved=Math.abs(this.x-this._x0)>3||Math.abs(this.y-this._y0)>3;try{for(var o=u(this._upListeners.entries()),s=o.next();!s.done;s=o.next()){var l=c(s.value,2),h=l[0],d=l[1];if("CameraManipulator"!==h&&d(this))return}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}var p=this._upListeners.get("CameraManipulator");p&&p(this)}},t.prototype._onMouseMove=function(e){var t,r;if(this._enabled&&this._viewer.isRendering()){e.preventDefault();var i=e.offsetX_norm,n=e.offsetY_norm;this.dx=i-this.x,this.dy=n-this.y,this.x=i,this.y=n,this._event=e,this.moved=Math.abs(this.x-this._x0)>3||Math.abs(this.y-this._y0)>3;try{for(var a=u(this._moveListeners.entries()),o=a.next();!o.done;o=a.next()){var s=c(o.value,2),l=s[0],h=s[1];if("CameraManipulator"!==l&&h(this))return}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}var d=this._moveListeners.get("CameraManipulator");d&&d(this)}},t.prototype._onMouseWheel=function(e){var t,r;if(this._enabled&&this._viewer.isRendering()){e.preventDefault();var i=e.deltaY;this.delta=-Math.max(-1,Math.min(1,i)),"firefox"!==s.a.browserName&&(this.delta*=Math.min(i*i/2500,1));try{for(var n=u(this._wheelListeners.entries()),a=n.next();!a.done;a=n.next()){var o=c(a.value,2),l=o[0],h=o[1];if("CameraManipulator"!==l&&h(this))return}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}var d=this._wheelListeners.get("CameraManipulator");d&&d(this)}},t.prototype._onMouseDblclick=function(e){var t,r;if(this._enabled&&this._viewer.isRendering()){e.preventDefault();var i=e.offsetX_norm,n=e.offsetY_norm;this.dx=i-this.x,this.dy=n-this.y,this.x=i,this.y=n,this._event=e,(Math.abs(this.x-this._x0)>3||Math.abs(this.y-this._y0)>3)&&(this.moved=!0),this.isDoubleClick=!0;try{for(var a=u(this._dbClickListeners.entries()),o=a.next();!o.done;o=a.next()){var s=c(o.value,2),l=s[0],h=s[1];if("CameraManipulator"!==l&&h(this))return}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}var d=this._dbClickListeners.get("CameraManipulator");d&&d(this)}},t.prototype.getEvent=function(){return this._event},t}(o),d=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),p=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},m=function(e){function t(t){var r=e.call(this,"touch",t)||this;return r._startListeners=new Map,r._moveListeners=new Map,r._stopListeners=new Map,r._dbClickListeners=new Map,r.numCursors=0,r.x0=0,r.y0=0,r.cursors={},r.identifiers=[],r.lastCursor=null,r.clickTime=0,r.isDoubleClick=!1,r._onTouchStart=r._onTouchStart1.bind(r),r._onTouchMove=r._onTouchMove1.bind(r),r._onTouchStop=r._onTouchStop1.bind(r),r._canvas.addEventListener("touchstart",r._onTouchStart,!1),r._canvas.addEventListener("touchmove",r._onTouchMove,!1),r._canvas.addEventListener("touchend",r._onTouchStop,!1),r}return d(t,e),t.prototype.destroy=function(){this._canvas.removeEventListener("touchstart",this._onTouchStart),this._canvas.removeEventListener("touchmove",this._onTouchMove),this._canvas.removeEventListener("touchend",this._onTouchStop),this._startListeners=null,delete this._startListeners,this._moveListeners=null,delete this._moveListeners,this._stopListeners=null,delete this._stopListeners,this._dbClickListeners=null,delete this._dbClickListeners,e.prototype.destroy.call(this)},t.prototype.cursor=function(e){return e<this.identifiers.length?this.cursors[this.identifiers[e]]:null},t.prototype.addTouchMoveListener=function(e,t){t||(t="touchMove "+a.a.generateUUID()),this._moveListeners.set(t,e)},t.prototype.addTouchStartListener=function(e,t){t||(t="touchStart "+a.a.generateUUID()),this._startListeners.set(t,e)},t.prototype.addTouchStopListener=function(e,t){t||(t="touchStop "+a.a.generateUUID()),this._stopListeners.set(t,e)},t.prototype.addTouchDbClickListener=function(e,t){t||(t="touchDbclick "+a.a.generateUUID()),this._dbClickListeners.set(t,e)},t.prototype._onTouchStart1=function(e){var t,r,i,n;e.preventDefault(),this.numCursors=e.touches.length;for(var a=0;a<e.changedTouches.length;++a)this._addCursor(e.changedTouches[a]);var o="";for(var s in this.cursors)null!==this.cursors[s]&&(o=s);if(1===this.numCursors){var l=this.cursors[o],u=(new Date).getTime();this.lastCursor&&(u-this.clickTime<200&&Math.abs(this.lastCursor.x-l.x)<20&&Math.abs(this.lastCursor.y-l.y)<20?this.isDoubleClick=!0:this.isDoubleClick=!1),this.lastCursor=this.cursor(0),this.clickTime=u}else this.isDoubleClick=!1;try{for(var c=p(this._startListeners.entries()),h=c.next();!h.done;h=c.next()){var d=f(h.value,2),m=d[0],_=d[1];if("CameraManipulator"!==m){if(_(this))return;(b=this._startListeners.get("CameraManipulator"))&&b(this)}}}catch(e){t={error:e}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}if(this.isDoubleClick){try{for(var v=p(this._dbClickListeners.entries()),y=v.next();!y.done;y=v.next()){var g=f(y.value,2);m=g[0],_=g[1];if("CameraManipulator"!==m&&_(this))return}}catch(e){i={error:e}}finally{try{y&&!y.done&&(n=v.return)&&n.call(v)}finally{if(i)throw i.error}}var b;(b=this._dbClickListeners.get("CameraManipulator"))&&b(this)}},t.prototype._onTouchMove1=function(e){var t,r;e.preventDefault();this.numCursors=e.touches.length;for(var i=[],n=0;n<e.touches.length;n++)this.cursors[e.touches[n].identifier]||this._addCursor(e.touches[n]),i.push(e.touches[n].identifier);for(var a in this.cursors){var o=Number(a);-1===i.indexOf(o)&&this._removeCursor(o)}for(var s=this._canvas.getBoundingClientRect(),l=0;l<e.changedTouches.length;++l){var u=e.changedTouches[l].pageX-s.left,c=e.changedTouches[l].pageY-s.top,h=e.changedTouches[l].identifier;this.cursors[h].dx=u-this.cursors[h].x,this.cursors[h].dy=c-this.cursors[h].y,this.cursors[h].x=u,this.cursors[h].y=c,this.cursors[h].moved=!0}try{for(var d=p(this._moveListeners.entries()),m=d.next();!m.done;m=d.next()){var _=f(m.value,2),v=_[0],y=_[1];if("CameraManipulator"!==v&&y(this))return}}catch(e){t={error:e}}finally{try{m&&!m.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}var g=this._moveListeners.get("CameraManipulator");g&&g(this)},t.prototype._onTouchStop1=function(e){var t,r,i,n;e.preventDefault();try{for(var a=p(this._stopListeners.values()),o=a.next();!o.done;o=a.next()){if((m=o.value)(this))break}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}this.numCursors=e.touches.length;for(var s=0;s<e.changedTouches.length;s++){var l=e.changedTouches[s].identifier;this._removeCursor(l)}try{for(var u=p(this._stopListeners.entries()),c=u.next();!c.done;c=u.next()){var h=f(c.value,2),d=h[0],m=h[1];if("CameraManipulator"!==d&&m(this))return}}catch(e){i={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(i)throw i.error}}var _=this._stopListeners.get("CameraManipulator");_&&_(this)},t.prototype.isAvailable=function(e){return!0},t.prototype._removeCursor=function(e){var t=this.identifiers.indexOf(e);-1!==t&&this.identifiers.splice(t,1),delete this.cursors[e]},t.prototype._addCursor=function(e){var t=this._canvas.getBoundingClientRect(),r=e.identifier,i={x:e.pageX-t.left,y:e.pageY-t.top,dx:0,dy:0,moved:!1};this.cursors[r]=i,this.identifiers.push(r)},t}(o),_=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),v=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},y=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},g=function(e){function t(t){var r=e.call(this,"keyboard",t)||this;return r._upListeners=new Map,r._downListeners=new Map,r._enabled=!0,r.key="Dead",r.keyCode=-1,r._keyDownFn=r._keyDown.bind(r),r._keyUpFn=r._keyUp.bind(r),document.addEventListener("keydown",r._keyDownFn),document.addEventListener("keyup",r._keyUpFn),r}return _(t,e),t.prototype.destroy=function(){this._upListeners=null,delete this._upListeners,this._downListeners=null,delete this._downListeners,document.removeEventListener("keydown",this._keyDownFn),document.removeEventListener("keyup",this._keyUpFn),this._keyDownFn=null,delete this._keyDownFn,this._keyUpFn=null,delete this._keyUpFn,e.prototype.destroy.call(this)},t.prototype.isAvailable=function(e){return!e},t.prototype.addKeyUpListener=function(e,t){t||(t="keyDown "+a.a.generateUUID()),this._upListeners.set(t,e)},t.prototype.addKeyDownListener=function(e,t){t||(t="keyDown "+a.a.generateUUID()),this._downListeners.set(t,e)},t.prototype._keyDown=function(e){var t,r;if(this._doesCanvasHaveFocus()){e.preventDefault(),this.key=e.key,this.repeat=e.repeat,this.keyCode=e.keyCode;try{for(var i=v(this._downListeners.entries()),n=i.next();!n.done;n=i.next()){var a=y(n.value,2),o=a[0],s=a[1];if("CameraManipulator"!==o&&s(this))return}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}var l=this._downListeners.get("CameraManipulator");l&&l(this)}},t.prototype._keyUp=function(e){var t,r;if(this._doesCanvasHaveFocus()){e.preventDefault(),this.key=e.key,this.keyCode=e.keyCode;try{for(var i=v(this._upListeners.entries()),n=i.next();!n.done;n=i.next()){var a=y(n.value,2),o=a[0],s=a[1];if("CameraManipulator"!==o&&s(this))return}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}var l=this._upListeners.get("CameraManipulator");l&&l(this)}},t.prototype._doesCanvasHaveFocus=function(){if(!this._enabled)return!1;var e=document.activeElement,t=e&&e!==document.body;if(!t)return!0;if("tui-select-selection"===e.className)return!0;if("INPUT"===e.tagName){var r=e.type||e.getAttribute("type");t=!("password"!==r&&"text"!==r&&"number"!==r&&"search"!==r)}if("BUTTON"!==e.tagName&&"SELECT"!==e.tagName||(t=!1),t)return!1;var i="";return void 0!==window.getSelection?i=window.getSelection().toString():void 0!==document.selection&&"Text"===document.selection.type&&(i=document.selection.createRange().text),!i&&!t},t}(o),b=r(76),w=r(75),x=r.n(w),M=function(){return function(){this.vramSize=0,this.littleEndian=!0;var e=(new x.a).getResult(),t=(e.device.model||"").toLowerCase();switch(this.browserName=(e.browser&&e.browser.name||"").toLowerCase(),this.browserVersion=(e.browser&&e.browser.major||"").toLowerCase(),t){case"iphone":this.vramSize=1024;break;case"ipad":this.vramSize=2048;break;default:this.vramSize=4096}}}(),T=function(){function e(){this.events={}}return e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.events[e]&&this.events[e].forEach(function(e){return e.apply(null,t)})},e.prototype.on=function(e,t){var r=this;return this.events[e]||(this.events[e]=[]),this.events[e].push(t),function(){r.events[e]=r.events[e].filter(function(e){return e!==t})}},e.prototype.remove=function(e,t){if(this.events[e]){var r=this.events[e].indexOf(t);-1!==r&&this.events[e].splice(r,1)}},e.prototype.clear=function(){this.events={}},e}(),E=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},S=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(E(arguments[t]));return e};!function(e){e[e.INITIALIZED=-1]="INITIALIZED",e[e.UNINITIALIZED=-2]="UNINITIALIZED",e[e.RENDERING=-3]="RENDERING",e[e.INITIALIZED_PAUSED=-4]="INITIALIZED_PAUSED",e[e.RENDERING_PAUSED=-5]="RENDERING_PAUSED",e[e.TICK_PAUSED=-6]="TICK_PAUSED"}(i||(i={})),function(e){e[e.VIEW_NULL=-1]="VIEW_NULL",e[e.VIEW_360=0]="VIEW_360",e[e.VIEW_MODEL=1]="VIEW_MODEL"}(n||(n={}));var A,k=function(){function e(e,t,r,n){var a=this;if(void 0===t&&(t={isMobile:!1,initResize:!0}),this._nFramesTobeDrawnNormally=0,this._nFramesTobeDrawnProgressively=0,this.state=i.UNINITIALIZED,this._canvasId="ModeloCanvas-"+e,this._container=document.getElementById(e),!this._container)throw Error("The container '"+e+"' doesn't exist.");if(r&&n&&(this._container.style.width=r+"px",this._container.style.height=n+"px"),this.viewType=-1,0===this._container.clientHeight)throw Error("The container '"+e+"' should have height");if(this._canvas=document.getElementById(this._canvasId),this._canvas)throw Error("A viewer has already been created in container '"+this._canvas.parentElement.id+"'. Please call viewer.destroy() first.");this._canvas=document.createElement("canvas"),this._canvas.id=this._canvasId,this._canvas.style.display="block",this._container.appendChild(this._canvas),this._canvas.oncontextmenu=function(){return!1};var o=r||this._container.clientWidth,l=n||this._container.clientHeight;s.a.devicePixelRatio=t.devicePixelRatio||window.devicePixelRatio;var u=Math.floor(o*s.a.devicePixelRatio),c=Math.floor(l*s.a.devicePixelRatio);this._canvas.width=u,this._canvas.height=c,this._canvas.style.width=o+"px",this._canvas.style.height=l+"px";var h=new M;s.a.littleEndian=h.littleEndian,s.a.gpuMemory=Math.round(.5*h.vramSize),s.a.browserName=h.browserName,s.a.browserVersion=h.browserVersion,s.a.isMobile=t.isMobile,s.a.initResize=t.initResize,this._eventEmitter=new T,this._inputs=[],this._tools=[],t.initResize&&(this._ro=new b.a(function(e){e.forEach(function(e){var t=e.contentRect,r=t.width,i=t.height;a.resize(r,i)})}),this._ro.observe(this._container)),this.state=i.INITIALIZED}return e.prototype.resize=function(e,t){console.warn("canvas resize"),e=e||1,t=t||1;var r=Math.floor(e*s.a.devicePixelRatio),i=Math.floor(t*s.a.devicePixelRatio);this._canvas.width=r,this._canvas.height=i,this._canvas.style.width=e+"px",this._canvas.style.height=t+"px"},e.prototype.destroy=function(){this.state!==i.UNINITIALIZED&&(this._ro&&(this._ro.unobserve(this._container),this._ro=null,delete this._ro),this._inputs.forEach(function(e){e.destroy()}),this._inputs=null,delete this._inputs,this._tools.forEach(function(e){e.destroy()}),this._tools=null,delete this._tools,this._eventEmitter=null,delete this._eventEmitter,this.state=i.UNINITIALIZED,this._canvas.remove(),this._canvas=null,delete this._canvas,this._container=null,delete this._container,console.log("%cThe viewer gets destroyed","font-weight:bold;"))},e.prototype.pause=function(){},e.prototype.resume=function(){},e.prototype.invalidate=function(e){void 0===e&&(e=1),this._nFramesTobeDrawnNormally=e,this._nFramesTobeDrawnProgressively=0},e.prototype.addInput=function(e){if(!e.isAvailable(s.a.isMobile))return console.warn(e.name+" is not supported on current platform."),-1;for(var t=0;t<this._inputs.length;t++)if(this._inputs[t].name===e.name)return-1;e.setEnabled(!0);var r=this._inputs.length;return this._inputs.push(e),r},e.prototype.removeInput=function(e){var t=this._inputs[e];e>=0&&e<this._inputs.length&&this._inputs.slice(e,1),t.destroy()},e.prototype.getInput=function(e){return e>=0&&e<this._inputs.length?this._inputs[e]:null},e.prototype.addTool=function(e){if(!e.doesSupportMobile(s.a.isMobile))return null;for(var t=0;t<this._tools.length;t++)if(this._tools[t].name===e.name)return null;for(t=0;t<this._inputs.length;t++)e.addInput(this._inputs[t]);return this._tools.push(e),e},e.prototype.getTool=function(e){for(var t=0;t<this._tools.length;t++)if(this._tools[t].name===e)return this._tools[t];return null},e.prototype.removeTool=function(e){for(var t=0;t<this._tools.length;t++)if(this._tools[t].name===e){this._tools[t].destroy(),this._tools.splice(t,1);break}},e.prototype.getWidth=function(){return this._canvas.width},e.prototype.getHeight=function(){return this._canvas.height},e.prototype.getCanvas=function(){return this._canvas},e.prototype.getEventEmitter=function(){return this._eventEmitter},e.prototype.registerEventListener=function(e,t){this._eventEmitter.on(e,t)},e.prototype.removeEventListener=function(e,t){this._eventEmitter.remove(e,t)},e.prototype.notifyEventListener=function(e){for(var t,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];this._eventEmitter&&(t=this._eventEmitter).emit.apply(t,S([e],r))},e.prototype.getViewType=function(){return this.viewType},e.prototype.isRendering=function(){return this.state===i.RENDERING},e.prototype.isUninitialized=function(){return this.state===i.UNINITIALIZED},e.prototype.isPaused=function(){return this.state===i.TICK_PAUSED||this.state===i.RENDERING_PAUSED||this.state===i.INITIALIZED_PAUSED},e}(),P=r(3),N=r(4),D=r(18),I=r(14),O=r(22),R=r(7),C=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),B=[1,0,1,.1,100,0,0,0],L=[0,0,0],F=[1,1,0],V=function(e){function t(t,r){var i=e.call(this,t)||this;return i.originTextureUrl=null,i._resourceManager=null,i._materialParameters=new Float32Array(B),i._materialTextureOffset=null,i._materialTextureScale=null,i._reservedParameters2={},i._oldTransparency=1,i._oldDiffuse=[0,0,0],i._resourceManager=r,i}return C(t,e),t.prototype.destroy=function(){this._materialParameters=null,this._reservedParameters2=null,this._materialTextureScale=null,this._materialTextureOffset=null,this.textureTransparent=null,delete this._materialParameters,delete this._reservedParameters2,delete this._materialTextureScale,delete this._materialTextureOffset,e.prototype.destroy.call(this)},t.prototype.attachShader=function(t,r){if(!t&&!r)return null;if(!t){if(!(t=r.getShader("solid",[])).ready){var i=N.a.solid;if(t.createFromShaderSource(i,["MODEL_TRANSFORM"]),!t.ready)throw"modelo3d error at creating shader 'solid'!"}}if(!t||!t.ready)return null;for(var n in e.prototype.attachShader.call(this,t,r),t.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uDiffuseTexture"===n?(this.reservedParameters[n]=new R.a,this.hasTexture=!0,this.reservedParameters[n].texUnit=5,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uDiffuseTexture2"===n?(this.reservedParameters[n]=new R.a,this.hasTexture=!0,this.reservedParameters[n].texUnit=6,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):n.indexOf("m_uMaterial")>=0?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue,this.reservedParameters[n].value=this._materialParameters):"m_uTextureOffset"===n?(this._materialTextureOffset=new Float32Array(L),this.reservedParameters[n]=new R.a,this.reservedParameters[n].value=this._materialTextureOffset,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uTextureScale"===n&&(this._materialTextureScale=new Float32Array(F),this.reservedParameters[n]=new R.a,this.reservedParameters[n].value=this._materialTextureScale,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue));return t},t.prototype.equal=function(e){return this._materialParameters[0]===e[0]&&this._materialParameters[0]===e[0]&&this._materialParameters[2]===e[2]&&this._materialParameters[3]===e[3]},t.prototype.hash=function(){var e="",t=this._materialParameters;return e=e+t[0].toString()+t[1].toString()+t[2].toString()+t[3].toString()},t.prototype.setDiffuse=function(e){var t=this._materialParameters;t[0]=e[0],t[1]=e[1],t[2]=e[2],this._oldDiffuse[0]=t[0],this._oldDiffuse[1]=t[1],this._oldDiffuse[2]=t[2],e[3]&&(t[3]=e[3])},t.prototype.setTransparent=function(e){this._oldTransparency=this._materialParameters[3],this._materialParameters[3]=e,this.transparent=e<.99||!!this.textureTransparent},t.prototype.restoreTransparency=function(){this._materialParameters&&(this._materialParameters[3]=this._oldTransparency,this.transparent=this._oldTransparency<.99||!!this.textureTransparent)},t.prototype.adjustTransparency=function(e){this._materialParameters[3]=this._oldTransparency*e,this.transparent=this._materialParameters[3]<.99||!!this.textureTransparent},t.prototype.setDiffuseTexture=function(e){var t=this;if(this.reservedParameters.m_uDiffuseTexture)if(e instanceof D.a)this.reservedParameters.m_uDiffuseTexture.value=e;else{var r=this.reservedParameters.m_uDiffuseTexture.value,i=r.getFilter(),n=r.getWrap(),a=this._resourceManager.gl.RGB;if(e instanceof HTMLImageElement){var o=new D.a("texture-"+e.src,this._resourceManager);"png"===(s=e.src.split("."))[s.length-1]&&(a=this._resourceManager.gl.RGBA),o.createFromImage(e,a,this._resourceManager.gl.UNSIGNED_BYTE,i,n),this.reservedParameters.m_uDiffuseTexture.value=o}else{var s,l=new D.a("texture-"+e,this._resourceManager);a=this._resourceManager.gl.RGB;"png"===(s=e.split("."))[s.length-1]&&(a=this._resourceManager.gl.RGBA),l.createFromFile(e,a,i,n,function(){t.reservedParameters.m_uDiffuseTexture.value=l})}}else console.warn("can not set texture for "+this.name)},t.prototype.setSecondDiffuseTexture=function(e){this.reservedParameters.m_uDiffuseTexture2.value=e},t.prototype.getDiffuse=function(){return this._materialParameters},t.prototype.getTransparent=function(){return this._materialParameters[3]},t.prototype.getShininess=function(){return this._materialParameters[4]},t.prototype.getDiffuseTexture=function(){return this.hasTexture&&this.reservedParameters.m_uDiffuseTexture?this.reservedParameters.m_uDiffuseTexture.value:null},t.prototype.absorb=function(e){if(this.hasMask){var t=this.reservedParameters.m_uDiffuseTexture,r=e.reservedParameters.m_uDiffuseTexture;t&&r&&(t.value=r.value)}this.transparent&&this.setTransparent(e.getTransparent())},t.prototype.clone=function(e){var r=new t(e,this._resourceManager);if(this.reservedParameters){for(var i in this.reservedParameters)i.indexOf("m_uMaterial")>=0?(r.reservedParameters[i]=new R.a,r.reservedParameters[i].upload=this.reservedParameters[i].upload,r._materialParameters=new Float32Array(this.reservedParameters[i].value),r.reservedParameters[i].value=r._materialParameters):r.reservedParameters[i]=this.reservedParameters[i];r.transparent=this.transparent}return r},t.prototype.setTextureOffset=function(e){if(this.hasTexture){var t=this._materialTextureOffset;t[0]=e[0],t[1]=e[1],this._setTextureConfigured(!0)}},t.prototype._setTextureConfigured=function(e){this.hasTexture&&(this._materialTextureOffset[2]=e?1:0)},t.prototype.setTextureScale=function(e){if(this.hasTexture){var t=this._materialTextureScale;t[0]=e[0]>0?1/e[0]:t[0],t[1]=e[1]>0?1/e[1]:t[1],this._setTextureConfigured(!0)}},t.prototype.setTextureRotate=function(e){this.hasTexture&&(this._materialTextureScale[2]=e,this._setTextureConfigured(!0))},t.prototype.heighLight=function(){var e=this._materialParameters;e[0]=Math.min(1,1.3*this._oldDiffuse[0]),e[1]=Math.min(1,1.5*this._oldDiffuse[1]),e[2]=Math.min(1,1.1*this._oldDiffuse[2])},t.prototype.restoreDiffuse=function(){var e=this._materialParameters;e[0]=this._oldDiffuse[0],e[1]=this._oldDiffuse[1],e[2]=this._oldDiffuse[2]},t}(O.a),U=r(0);!function(e){e.sceneLengthUnit=function(){return"foot"},e.lengthUnitScale=function(e){void 0===e&&(e="mm");var t=1;return"mm"===e&&(t=.00328084),t}}(A||(A={}));var z=A.lengthUnitScale("mm"),j=U.a.create();j[0]=j[5]=j[10]=z;var G,q=function(){function e(e,t,r){this.materialDrawablesMap=new Map,this.drawables=[],this.name=e,this.bbox=null,this.originBBox=null,this._center=null,this.faces=1,this.isPopBuffer=!1,this.hasContours=!1,this.isBimCullingNeeded=!1,this._matrix=U.a.create(),this._invertMatrix=U.a.create(),this._drawableMatrx=U.a.create(),this._quat=U.b.create(),this.initMatrix=U.a.create(),this.position=[0,0,0],this.scale=[1,1,1],this.euler={_x:0,_y:0,_z:0},this.visible=!0,this._resourceManager=t,this._materialManager=r,this._rotate_matrix=U.a.create(),this._rotate_point=new Float32Array(3),this.skeletons=[]}return e.prototype.initlize=function(e){this._matrix=U.a.create(),this.initMatrix=U.a.create(),this.updateBBox(),this.initMatrix[12]=this._matrix[12]=.5*(this.bbox[0]+this.bbox[3]),this.initMatrix[13]=this._matrix[13]=.5*(this.bbox[1]+this.bbox[4]),this.initMatrix[14]=this._matrix[14]=.5*(this.bbox[2]+this.bbox[5]),this.originBBox=P.a.aabb.createFromArray(e)},e.prototype.destroy=function(){this.drawables.forEach(function(e){e.destroy()}),this.drawables=null,delete this.drawables,this.materialDrawablesMap=null,delete this.materialDrawablesMap,this.bbox=null,delete this.bbox,this.name=null,delete this.name,this.faces=null,delete this.faces,this.hasContours=null,delete this.hasContours,this._resourceManager=null,delete this._resourceManager,this._materialManager=null,delete this._materialManager,this.skeletons=null,delete this.skeletons},e.prototype.getCenter=function(){return this.getOriginBBox(),this._center=[],this._center[0]=.5*(this.originBBox[0]+this.originBBox[3]),this._center[1]=.5*(this.originBBox[1]+this.originBBox[4]),this._center[2]=.5*(this.originBBox[2]+this.originBBox[5]),this._center},e.prototype.getOriginBBox=function(){for(var e=P.a.aabb.createFromArray([Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE]),t=0,r=this.drawables.length;t<r;t++){var i=this.drawables[t];i.visible&&(0,P.a.aabb.union(e,i.originBBox,e))}this.isPopBuffer&&P.a.aabb.transform(e,e,j),this.originBBox=P.a.aabb.createFromArray(e)},e.prototype.setVisibility=function(e){this.visible!==e&&(this.visible=e,this.drawables.forEach(function(t){t.visible=e}))},e.prototype.setModelPosition=function(e,t){this.position=e,t&&this.setTransformMatrix(this.getModelTransformMatrix())},e.prototype.setModelScale=function(e,t){this.scale=e,t&&this.setTransformMatrix(this.getModelTransformMatrix())},e.prototype.updateModelRotation=function(e,t,r){this._tempRotation=e;var i=U.b.create();"rotate-yz"===t?U.b.rotateX(i,i,e):"rotate-xz"===t?U.b.rotateY(i,i,e):"rotate-xy"===t&&U.b.rotateZ(i,i,e),U.b.multiply(this._quat,i,this._quat),this.euler=U.b.toYXZ(this._quat),U.a.fromQuat(this._rotate_matrix,this._quat),r&&this.setTransformMatrix(this.getModelTransformMatrix())},e.prototype.setModelRotationFromEuler=function(e,t){var r=U.b.create(),i=e._x,n=e._y,a=e._z;this.euler=e,U.b.fromYXZ(r,n,i,a),this._quat=r,this._rotate_matrix=U.a.fromQuat(this._rotate_matrix,r),t&&this.setTransformMatrix(this.getModelTransformMatrix())},e.prototype.getModelTransformMatrix=function(){this._center||this.getCenter();var e=this._center,t=this.position||this._center,r=U.a.create(),i=1;this.isPopBuffer&&(i=z);var n=U.a.create();n[12]+=t[0],n[13]+=t[1],n[14]+=t[2],U.a.multiply(r,r,n),U.a.multiply(r,r,this._rotate_matrix);var a=U.a.create();return a[12]-=e[0],a[13]-=e[1],a[14]-=e[2],U.a.multiply(r,r,a),r=U.a.scale(r,r,[i*this.scale[0],i*this.scale[1],i*this.scale[2]])},e.prototype.addDrawable=function(e){this.materialDrawablesMap.has(e.material.name)?this.materialDrawablesMap.get(e.material.name).push(e):this.materialDrawablesMap.set(e.material.name,[e]),this.drawables.push(e)},e.prototype.updateBBox=function(){var e=this;this.bbox=P.a.aabb.create(),this.drawables.forEach(function(t){t.visible&&P.a.aabb.union(e.bbox,t.bbox,e.bbox)})},e.prototype.translate=function(e,t,r){this.drawables.forEach(function(i){i.translate(e,t,r)}),P.a.aabb.moveTo(this.bbox,this.bbox,[e,t,r])},e.prototype.rotate=function(e,t,r){var i=this;U.a.fromRotation(this._rotate_matrix,e,t),U.d.transformMat4(this._rotate_point,r,this._rotate_matrix),this._rotate_matrix[12]=r[0]-this._rotate_point[0],this._rotate_matrix[13]=r[1]-this._rotate_point[1],this._rotate_matrix[14]=r[2]-this._rotate_point[2],U.a.multiply(this._matrix,this._rotate_matrix,this._matrix),this.drawables.forEach(function(e){e.multiply(i._rotate_matrix)}),this.updateBBox()},e.prototype.getRotate=function(){var e=this._rotate_matrix,t=[];return t[0]=Math.atan2(e[9],e[10]),t[1]=Math.atan2(-e[8],Math.sqrt(e[9]*e[9]+e[10]*e[10])),t[2]=Math.atan2(e[4],e[0]),t},e.prototype.setTranslation=function(e,t,r){this._matrix[12]=e,this._matrix[13]=t,this._matrix[14]=r,this.drawables.forEach(function(i){i.setTranslation(e,t,r)}),P.a.aabb.moveTo(this.bbox,this.bbox,[e,t,r])},e.prototype.getTranslation=function(){return[this._matrix[12],this._matrix[13],this._matrix[14]]},e.prototype.setScaling=function(e,t,r){var i=this;U.a.scale(this._matrix,this._matrix,[e,t,r]),P.a.aabb.invalidate(this.bbox),this.drawables.forEach(function(n){n.recompileShader("MODEL_TRANSFORM",!0),n.setScaling(e,t,r),P.a.aabb.union(i.bbox,i.bbox,n.bbox)})},e.prototype.getScaling=function(){var e=U.d.create(),t=[this._matrix[0],this._matrix[1],this._matrix[2]],r=[this._matrix[4],this._matrix[5],this._matrix[6]],i=[this._matrix[8],this._matrix[9],this._matrix[10]];return e[0]=Math.sqrt(U.d.dot(t,t)),e[1]=Math.sqrt(U.d.dot(r,r)),e[2]=Math.sqrt(U.d.dot(i,i)),e},e.prototype.getTransformMatrix=function(){return this._matrix},e.prototype.getTransformArray=function(){U.a.invert(this._invertMatrix,this.initMatrix),U.a.multiply(this._drawableMatrx,this._matrix,this._invertMatrix);for(var e=[],t=0;t<12;t++)e[t]=this._drawableMatrx[t];var r=[this._matrix[12]-this.initMatrix[12],this._matrix[13]-this.initMatrix[13],this._matrix[14]-this.initMatrix[14]];return e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},e.prototype.setTransformMatrix=function(e){var t=this;U.a.copy(this._matrix,e),U.a.invert(this._invertMatrix,this.initMatrix),U.a.multiply(this._drawableMatrx,this._matrix,this._invertMatrix),this.drawables.forEach(function(e){e.recompileShader("SHADOW",!0),e.recompileShader("MODEL_TRANSFORM",!0),e.setTransformMatrix(t._drawableMatrx)}),this.updateBBox()},e.prototype.setTransfromArry=function(e){var t=[e[12],e[13],e[14]];U.a.multiply(this._matrix,this.initMatrix,e),this._matrix[12]=this.initMatrix[12]+t[0],this._matrix[13]=this.initMatrix[13]+t[1],this._matrix[14]=this.initMatrix[14]+t[2],this.setTransformMatrix(this._matrix)},e}(),Q=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),H=function(e){function t(t,r,i){var n=e.call(this,t,r,i)||this;return n.popUrl="",n}return Q(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.createSolidCube=function(e){void 0===e&&(e=[.5,.5,.5]);var t=this._resourceManager.getShader(this.name,["MODEL_TRANSFORM"]);t.ready||t.createFromShaderSource(N.a.solid,["MODEL_TRANSFORM"]);var r=this._materialManager.createMaterialAdhoc("pawn-material-"+this.name);r.attachShader(t,this._resourceManager),r.setDiffuse(e),r.setTransparent(1);var i=this._resourceManager.getMesh(this.name);i.createSolidCube(),this.addDrawable(new I.a(i,t,r,null,new Float32Array([-1,-1,-1,1,1,1]))),(t=this._resourceManager.getShader(this.name,["MODEL_TRANSFORM"])).ready||t.createFromShaderSource(N.a.plain,["MODEL_TRANSFORM"]),(r=this._materialManager.createMaterialAdhoc(this.name+"_line")).attachShader(t,this._resourceManager),r.setDiffuse([0,0,0]),r.setTransparent(1),(i=this._resourceManager.getMesh("pawn-material-"+this.name+"_line")).createWiredCube();var n=new Float32Array([-1,-1,-1,1,1,1]);P.a.aabb.scale(n,n,1.01);var a=new I.a(i,t,r,null,n);a.transform.setScaling(1.01,1.01,1.01),this.addDrawable(a),this.bbox?P.a.aabb.union(this.bbox,this.bbox,n):this.bbox=n},t.prototype.createTexturedQuad=function(e,t){void 0===t&&(t=!1),a.a.isArray(e)||(e=[e]);var r=["MODEL_TRANSFORM"];e.length>1&&r.push("SECOND_TEXTURE");var i=this._resourceManager.getShader(this.name,r);i.ready||i.createFromShaderSource(N.a.plain_texture,r);for(var n=Array(e.length),o=0;o<e.length;o++){var s=e[o];if(s instanceof D.a)n[o]=e[o];else{n[o]=this._resourceManager.getTexture(this.name+"_"+o);var l=this._resourceManager.gl,u=s.src.split(".");"png"!==u[u.length-1]&&"svg"!==u[u.length-1]?n[o].createFromImage(s,l.RGB,l.UNSIGNED_BYTE,l.LINEAR,l.CLAMP_TO_EDGE,t):n[o].createFromImage(s,l.RGBA,l.UNSIGNED_BYTE,l.LINEAR,l.CLAMP_TO_EDGE,t)}}var c=new V("pawn-material-"+this.name,this._resourceManager);c.attachShader(i,this._resourceManager),c.setDiffuse([1,1,1]),c.setTransparent(1),n[0]&&(c.setDiffuseTexture(n[0]),n[0].hasAlpha()&&(c.transparent=!0)),n[1]&&(c.setSecondDiffuseTexture(n[1]),n[1].hasAlpha()&&(c.transparent=!0));var h=this._resourceManager.getMesh(this.name);h.createQuad(!0,!0);var d=new Float32Array([-1,-1,0,1,1,0]);this.addDrawable(new I.a(h,i,c,null,d)),this.bbox?P.a.aabb.union(this.bbox,this.bbox,d):this.bbox=d},t.prototype.getSkeletons=function(){return this.skeletons},t.prototype.setDiffuseColor=function(e){this.drawables.forEach(function(t){t.material.setDiffuse(e)})},t.prototype.setOpacity=function(e){this.drawables.forEach(function(t){t.material.setTransparent(e)})},t.prototype.clone=function(e){var r=new t(e,this._resourceManager,this._materialManager);return this.drawables.forEach(function(e){r.addDrawable(e.clone())}),r.bbox=P.a.aabb.create(),P.a.aabb.copy(r.bbox,this.bbox),r.faces=this.faces,r.hasContours=this.hasContours,r},t.prototype.setTransformMatrix=function(e){this._matrix=e,this.drawables.forEach(function(t){t.setWorldMatrix(e)}),this.updateBBox()},t.prototype.getPawnInfo=function(){return{name:this.name,position:this.position,popUrl:this.popUrl,euler:this.euler,scale:this.scale,matrix:this._matrix}},t}(q),W=r(38),Y=r.n(W),X=r(2),Z=function(){return function(e,t,r,i){this.name=e,this.index=-1,this.type=t,this.offset=0,this.stride=0,this.size=i,this.normalized=!!r}}(),K=function(){function e(){this.values=[],this.hasNormal=!1,this.hasColor=!1,this.hasUV=!1,this.id=0,this.primitive=X.a.TRIANGLES,this.compressed=!1}return e.prototype._getSizeOfType=function(e){switch(e){case X.a.UNSIGNED_BYTE:case X.a.BYTE:return 1;case X.a.UNSIGNED_SHORT:case X.a.SHORT:return 2;case X.a.FLOAT:case X.a.INT:case X.a.UNSIGNED_INT:return 4;default:throw new Error("unknown GL type")}},e.prototype.builtin=function(e,t,r,i){var n=0,a=null;if(e&&((a=new Z("m_aPosition",e,!1,3)).index=0,a.offset=0,this.values.push(a),n=3*this._getSizeOfType(e)),t){var o=3,s=!1;o=3,s=!1,t!==X.a.FLOAT&&(s=!0,o=4),(a=new Z("m_aNormal",t,s,o)).index=1,a.offset=n,this.values.push(a),n+=o*this._getSizeOfType(t),this.hasNormal=!0}r&&((a=new Z("m_aTexCoord",r,!1,2)).index=4,a.offset=n,this.values.push(a),n+=2*this._getSizeOfType(r),this.hasUV=!0),i&&((a=new Z("m_aColor",i,!1,4)).index=5,a.offset=n,t!==X.a.FLOAT&&(a.normalized=!0),this.values.push(a),n+=4*this._getSizeOfType(i),this.hasColor=!0);for(var l=0,u=this.values.length;l<u;++l)this.values[l].stride=n;this.id=(e?16:0)+(t?8:0)+(r?4:0)+(i?2:0)},e.prototype.compress=function(){if(this.hasNormal&&!this.compressed){this.compressed=!0,this.id+=32;var e=[];e.push(this.values[0]);var t=null;(t=new Z("m_aNormal0",X.a.BYTE,!0,1)).index=1,t.offset=0,e.push(t),(t=new Z("m_aNormal1",X.a.BYTE,!0,1)).index=2,t.offset=4,e.push(t),(t=new Z("m_aNormal2",X.a.BYTE,!0,1)).index=3,t.offset=8,e.push(t);for(var r=2,i=this.values.length;r<i;r++)this.values[r].offset-=4,e.push(this.values[r]);var n=this.values[0].stride-4;for(r=0,i=e.length;r<i;++r)e[r].stride=n;this.values=e}},e.prototype.clone=function(){var t=new e;t.id=this.id,t.hasNormal=this.hasNormal,t.hasColor=this.hasColor,t.hasUV=this.hasUV,t.compressed=this.compressed,t.primitive=this.primitive,t.values=new Array(this.values.length);for(var r=0,i=this.values.length;r<i;r++){var n=this.values[r];t.values[r]=new Z(n.name,n.type,n.normalized,n.size),t.values[r].index=n.index,t.values[r].offset=n.offset,t.values[r].stride=n.stride}return t},e.prototype.add=function(e,t,r,i,n,a,o){if(!this.has(e)){var s=new Z(e,r,i,n);s.index=t,s.stride=a,s.offset=o,this.values.push(s)}},e.prototype.has=function(e){for(var t=0,r=this.values.length;t<r;++t)if(this.values[t].name===e)return!0;return!1},e.prototype.bindBuffer=function(e,t){t.bindBuffer(t.ARRAY_BUFFER,e);for(var r=0,i=this.values.length;r<i;r++){var n=this.values[r].index;t.vertexAttribPointer(n,this.values[r].size,this.values[r].type,this.values[r].normalized,this.values[r].stride,this.values[r].offset),t.enableVertexAttribArray(n)}},e.prototype.bindVbos=function(e,t){for(var r=0,i=e.length;r<i;r++){t.bindBuffer(t.ARRAY_BUFFER,e[r].buffer);var n=this.values[r].index;t.vertexAttribPointer(n,this.values[r].size,this.values[r].type,this.values[r].normalized,this.values[r].stride,this.values[r].offset),t.enableVertexAttribArray(n)}},e.prototype.bindBuffers=function(e,t){for(var r=0,i=e.length;r<i;r++){t.bindBuffer(t.ARRAY_BUFFER,e[r]);var n=this.values[r].index;t.vertexAttribPointer(n,this.values[r].size,this.values[r].type,this.values[r].normalized,this.values[r].stride,this.values[r].offset),t.enableVertexAttribArray(n)}},e.prototype.bind=function(e,t){t.disableVertexAttribArray(1),t.disableVertexAttribArray(2),t.disableVertexAttribArray(3),t.disableVertexAttribArray(4),t.disableVertexAttribArray(5),t.disableVertexAttribArray(6),t.bindBuffer(t.ARRAY_BUFFER,e);for(var r=0,i=this.values.length;r<i;r++){var n=this.values[r].index;t.vertexAttribPointer(n,this.values[r].size,this.values[r].type,this.values[r].normalized,this.values[r].stride,this.values[r].offset),t.enableVertexAttribArray(n)}},e}();!function(e){e[e.LINEAR=0]="LINEAR",e[e.STEP=1]="STEP",e[e.CATMULLROMSPLINE=2]="CATMULLROMSPLINE",e[e.CUBICSPLINE=3]="CUBICSPLINE"}(G||(G={}));var J=function(){function e(e,t,r){this._position=e||null,this._rotation=t||null,this._scale=r||null,this._interpolationMethod=G.LINEAR,this._matrix=U.a.create()}return e.prototype.getInterpolationMethod=function(){return this._interpolationMethod},e.prototype.setTranslation=function(e){this._position=e},e.prototype.getTranslation=function(){return this._position},e.prototype.setRotation=function(e){this._rotation=e},e.prototype.getRotation=function(){return this._rotation},e.prototype.setScale=function(e){this._scale=e},e.prototype.getScale=function(){return this._scale},e.prototype.setInterpolationMethod=function(e){this._interpolationMethod=e},e.interpolate=function(t,r,i){var n=new e(U.d.create(),U.b.create(),U.d.fromValues(1,1,1));return U.d.lerp(n._position,t._position,r._position,i),U.b.slerp(n._rotation,t._rotation,r._rotation,i),U.d.lerp(n._scale,t._scale,r._scale,i),n},e.prototype.getLocalTransform=function(){U.a.fromScaling(this._matrix,this._scale);var e=U.a.create();return U.a.fromQuat(e,this._rotation),U.a.multiply(this._matrix,e,this._matrix),this._matrix[12]=this._position[0],this._matrix[13]=this._position[1],this._matrix[14]=this._position[2],this._matrix},e}(),$=function(){function e(e){this._skeleton=e,this._animationTime=0}return e.prototype.doAnimation=function(e){this._animationTime=0,this._currentAnimation=e},e.prototype.update=function(){if(null!=this._currentAnimation){this._increaseAnimationTime();var e=this._calculateCurrentAnimationPose();this._applyPoseToJoints(e,this._skeleton.getRoot(),this._skeleton._rootMatrix)}},e.prototype._increaseAnimationTime=function(){this._animationTime+=this._currentAnimation.getSpeed(),this._animationTime>this._currentAnimation.getLength()&&(this._animationTime%=this._currentAnimation.getLength())},e.prototype._calculateCurrentAnimationPose=function(){var e=this._getPreviousAndNextFrames(),t=this._calculateProgression(e[0],e[1]);return this._interpolatePoses(e[0],e[1],t)},e.prototype._applyPoseToJoints=function(e,t,r){var i=this,n=e.get(t.getName());n||(n=U.a.create());var a=U.a.create();U.a.multiply(a,r,n),t.children.forEach(function(t){i._applyPoseToJoints(e,t,a)}),U.a.multiply(a,a,t.getInverseBindTransform()),t.setAnimationTransform(a)},e.prototype._getPreviousAndNextFrames=function(){for(var e=this._currentAnimation.getKeyFrames(),t=e[0],r=e[0],i=1;i<e.length&&!((r=e[i]).getTimeStamp()>this._animationTime);i++)t=e[i];return[t,r]},e.prototype._calculateProgression=function(e,t){var r=t.getTimeStamp()-e.getTimeStamp();return(this._animationTime-e.getTimeStamp())/r},e.prototype._interpolatePoses=function(e,t,r){var i=new Map,n=e.getJointKeyFrames(),a=t.getJointKeyFrames();return n.forEach(function(e,t){var n,o=a.get(t);n=e.getInterpolationMethod()==G.STEP?e:J.interpolate(e,o,r),i.set(t,n.getLocalTransform())}),i},e}(),ee=function(){function e(e,t){this._lastFrame=-1,this._animator=new $(this),this._rootJoint=e,this.joints=[],this._animations=[],t.gl.isWebGL2?this._transformTexture=null:(this._transformTexture=t.getTexture("skeleton-transform-"+e.getName()),t.gl.floatTextureExtension||console.warn("skeleton animation not supported in webgl1.0 without float texture extension!"),this._transformTexture.create(512,1,t.gl.RGBA32F,t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._transformTexture.use(4),this.gl=t.gl)}return e.prototype.use=function(e){var t,r=e.getGL();this._transformTexture?(this._transformTexture.update(this._jointMatrices),(t=e.reservedUniforms.m_uTransformTexture).upload(4,this.gl)):(t=e.reservedUniforms.m_uJointMatrix)&&t.upload(this._jointMatrices,r)},e.prototype.updateJointMatrices=function(){var e=this;return this._jointMatrices||(this._transformTexture?this._jointMatrices=new Float32Array(2048):this._jointMatrices=new Float32Array(16*this.joints.length)),this.joints.forEach(function(t,r){var i=t.getAnimatedTransform();e._jointMatrices.set(i,16*r)}),this._jointMatrices},e.prototype.setRootMatrix=function(e){this._rootMatrix=U.a.clone(e)},e.prototype.addJoint=function(e){this.joints.push(e)},e.prototype.getRoot=function(){return this._rootJoint},e.prototype.addAnimation=function(e){this._animations.push(e)},e.prototype.getAnimations=function(){return this._animations},e.prototype.doAnimation=function(e){this._animator.doAnimation(e)},e.prototype.update=function(){this._animator.update(),this.updateJointMatrices()},e}(),te=function(){function e(e,t,r){this._name=e,this._inverseBindMatrix=t,this.children=[],this._animatedTransform=U.a.create(),this._matrixWorld=r}return e.prototype.getName=function(){return this._name},e.prototype.addChild=function(e){this.children.push(e)},e.prototype.getAnimatedTransform=function(){return this._animatedTransform},e.prototype.setAnimationTransform=function(e){U.a.copy(this._animatedTransform,e)},e.prototype.getInverseBindTransform=function(){return this._inverseBindMatrix},e}(),re=function(){function e(e,t,r){this._name=e,this._keyFrames=r,this._length=t,this._speed=.0167}return e.prototype.getSpeed=function(){return this._speed},e.prototype.setSpeed=function(e){this._speed=e},e.prototype.getName=function(){return this._name},e.prototype.getLength=function(){return this._length},e.prototype.getKeyFrames=function(){return this._keyFrames},e}(),ie=function(){function e(e){this._timeStamp=e,this._pose=new Map}return e.prototype.getTimeStamp=function(){return this._timeStamp},e.prototype.getJointKeyFrames=function(){return this._pose},e}(),ne="data:image/png;base64,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",ae=100,oe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},se=function(){function e(e,t,r){e=e||U.d.fromValues(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),t=t||U.d.fromValues(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),void 0===r||!0===r?(this.min=U.d.clone(e),this.max=U.d.clone(t)):(this.min=e,this.max=t),this.transform=U.a.create()}return e.prototype.updateBoundingBox=function(e){U.d.min(this.min,this.min,e.min),U.d.max(this.max,this.max,e.max)},e.prototype.calculateTransform=function(){this.transform[0]=this.max[0]-this.min[0],this.transform[5]=this.max[1]-this.min[1],this.transform[10]=this.max[2]-this.min[2],this.transform[12]=this.min[0],this.transform[13]=this.min[1],this.transform[14]=this.min[2]},e.getAABBFromOBB=function(t,r){var i=U.d.create(),n=U.d.create(),a=U.d.create(),o=U.d.create(),s=U.d.create();U.d.set(i,r[0],r[1],r[2]),U.d.set(n,r[4],r[5],r[6]),U.d.set(a,r[8],r[9],r[10]);var l=U.d.fromValues(r[12],r[13],r[14]),u=U.d.clone(l);U.d.scale(o,i,t.min[0]),U.d.scale(s,i,t.max[0]),U.d.min(i,o,s),U.d.add(l,l,i),U.d.max(i,o,s),U.d.add(u,u,i),U.d.scale(o,n,t.min[1]),U.d.scale(s,n,t.max[1]),U.d.min(n,o,s),U.d.add(l,l,n),U.d.max(n,o,s),U.d.add(u,u,n),U.d.scale(o,a,t.min[2]),U.d.scale(s,a,t.max[2]),U.d.min(a,o,s),U.d.add(l,l,a),U.d.max(a,o,s),U.d.add(u,u,a);var c=new e(l,u,!1);return c.calculateTransform(),c},e}(),le=function(){function e(e,t){this.bufferView=t,this.componentType=e.componentType,this.byteOffset=void 0!==e.byteOffset?e.byteOffset:0,this.byteStride=t.byteStride,this.normalized=void 0!==e.normalized&&e.normalized,this.count=e.count,this.type=e.type,this.size=oe[this.type],this.min=e.min,this.max=e.max}return e.prototype._arrayBuffer2TypedArray=function(e,t,r,i){switch(i){case 5122:return new Int16Array(e,t,r);case 5123:return new Uint16Array(e,t,r);case 5124:return new Int32Array(e,t,r);case 5125:return new Uint32Array(e,t,r);case 5126:return new Float32Array(e,t,r);default:return null}},e.prototype.getAccessorData=function(){return this._arrayBuffer2TypedArray(this.bufferView.data,this.byteOffset,this.count*oe[this.type],this.componentType)},e}(),ue=function(){function e(e,t){this.byteLength=e.byteLength,this.byteOffset=void 0!==e.byteOffset?e.byteOffset:0,this.byteStride=void 0!==e.byteStride?e.byteStride:0,this.target=void 0!==e.target?e.target:null,this.data=t.slice(this.byteOffset,this.byteOffset+this.byteLength),this._glBuffer=null}return e.prototype.getBuffer=function(e,t){return this._glBuffer||(this._glBuffer=e.createBuffer(),e.bindBuffer(t,this._glBuffer),e.bufferData(t,this.data,e.STATIC_DRAW),e.bindBuffer(t,null)),this._glBuffer},e}(),ce=function(){function e(e,t,r){if(this.name=void 0!==t.name?t.name:null,this.nodeID=r,this.camera=void 0!==t.camera?t.camera:null,this.matrix=U.a.create(),t.hasOwnProperty("matrix")){for(var i=0;i<16;++i)this.matrix[i]=t.matrix[i];this.translation=U.d.create(),U.a.getTranslation(this.translation,this.matrix),this.rotation=U.b.create(),U.a.getRotation(this.rotation,this.matrix),this.scale=U.d.create(),U.a.getScaling(this.scale,this.matrix)}else this.getTransformMatrixFromTRS(t.translation,t.rotation,t.scale);this.children=t.children||[],this.mesh=void 0!==t.mesh?e.model.meshes[t.mesh]:null,this.skin=void 0!==t.skin?t.skin:null,this.inverseBindMatrix=null,this.weights=void 0!==t.weights?t.weights:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.aabb=null,this.bvh=new se}return e.prototype.traverse=function(e,t){t(this,e);for(var r=0,i=this.children.length;r<i;r++)this.children[r].traverse(this,t)},e.prototype.traversePostOrder=function(e,t){for(var r=0,i=this.children.length;r<i;r++)this.children[r].traversePostOrder(this,t);t(this,e)},e.prototype.traverseTwoExecFun=function(e,t,r){t(this,e);for(var i=0,n=this.children.length;i<n;i++)this.children[i].traverseTwoExecFun(this,t,r);r(this,e)},e.prototype.getTransformMatrixFromTRS=function(e,t,r){this.translation=void 0!==e?U.d.fromValues(e[0],e[1],e[2]):U.d.fromValues(0,0,0),this.rotation=void 0!==t?U.e.fromValues(t[0],t[1],t[2],t[3]):U.e.fromValues(0,0,0,1),this.scale=void 0!==r?U.d.fromValues(r[0],r[1],r[2]):U.d.fromValues(1,1,1),this.updateMatrixFromTRS()},e.prototype.updateMatrixFromTRS=function(){U.a.fromScaling(this.matrix,this.scale);var e=U.a.create();U.a.fromQuat(e,this.rotation),U.a.multiply(this.matrix,e,this.matrix),this.matrix[12]=this.translation[0],this.matrix[13]=this.translation[1],this.matrix[14]=this.translation[2]},e}(),he=function(){return function(e,t,r){var i,n;this.meshID=r,this.name=void 0!==t.name?t.name:null,this.primitives=[],this.boundingBox=null;for(var a=0,o=t.primitives.length;a<o;++a)i=t.primitives[a],n=new de(e.model,i,a),this.primitives.push(n),n.boundingBox&&(this.boundingBox||(this.boundingBox=new se),this.boundingBox.updateBoundingBox(n.boundingBox));this.boundingBox&&this.boundingBox.calculateTransform(),this.weights=void 0!==t.weights?t.weights:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null}}(),de=function(){return function(e,t,r){var i;for(i in this.index=r,this.attributes=t.attributes,this.indices=void 0!==t.indices?t.indices:null,null!==this.indices?(this.indicesComponentType=e.json.accessors[this.indices].componentType,this.indicesLength=e.json.accessors[this.indices].count,this.indicesOffset=e.json.accessors[this.indices].byteOffset||0):(this.drawArraysCount=e.json.accessors[this.attributes.POSITION].count,this.drawArraysOffset=e.json.accessors[this.attributes.POSITION].byteOffset||0),this.attributes)this.attributes[i]=e.accessors[this.attributes[i]];if(this.material=void 0!==t.material?e.materials[t.material]:null,this.mode=void 0!==t.mode?t.mode:4,this.targets=t.targets,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.vertexArray=null,this.vertexBuffer=null,this.indexBuffer=null,this.shader=null,this.boundingBox=null,void 0!==this.attributes.POSITION){var n=this.attributes.POSITION;n.max&&"VEC3"===n.type&&(this.boundingBox=new se(U.d.fromValues(n.min[0],n.min[1],n.min[2]),U.d.fromValues(n.max[0],n.max[1],n.max[2]),!1),this.boundingBox.calculateTransform())}}}(),pe=function(){function e(e,t){this.name=void 0!==t.name?t.name:null,this.sampler=void 0!==t.sampler?e.model.samplers[t.sampler]:null,this.source=void 0!==t.source?e.model.images[t.source]:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.texture=null}return e.prototype.createTexture=function(e){this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.source),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null)},e}(),fe=function(){function e(e){this.name=void 0!==e.name?e.name:null,this.magFilter=void 0!==e.magFilter?e.magFilter:null,this.minFilter=void 0!==e.minFilter?e.minFilter:null,this.wrapS=void 0!==e.wrapS?e.wrapS:10497,this.wrapT=void 0!==e.wrapT?e.wrapT:10497,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null,this.sampler=null}return e.prototype.createSampler=function(e){this.sampler=e.createSampler(),this.minFilter?e.samplerParameteri(this.sampler,e.TEXTURE_MIN_FILTER,this.minFilter):e.samplerParameteri(this.sampler,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_LINEAR),this.magFilter?e.samplerParameteri(this.sampler,e.TEXTURE_MAG_FILTER,this.magFilter):e.samplerParameteri(this.sampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.sampler,e.TEXTURE_WRAP_S,this.wrapS),e.samplerParameteri(this.sampler,e.TEXTURE_WRAP_T,this.wrapT)},e}(),me=function(){return function(e){this.index=e.index,this.texCoord=void 0!==e.texCoord?e.texCoord:0,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}(),_e=function(){return function(e){this.baseColorFactor=void 0!==e.baseColorFactor?e.baseColorFactor:[1,1,1,1],this.baseColorTexture=void 0!==e.baseColorTexture?new me(e.baseColorTexture):null,this.metallicFactor=void 0!==e.metallicFactor?e.metallicFactor:1,this.roughnessFactor=void 0!==e.roughnessFactor?e.roughnessFactor:1,this.metallicRoughnessTexture=void 0!==e.metallicRoughnessTexture?new me(e.metallicRoughnessTexture):null,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}(),ve=function(){return function(e){this.index=e.index,this.texCoord=void 0!==e.texCoord?e.texCoord:0,this.scale=void 0!==e.scale?e.scale:1,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}(),ye=function(){return function(e){this.index=e.index,this.texCoord=void 0!==e.texCoord?e.texCoord:0,this.strength=void 0!==e.strength?e.strength:1,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}(),ge=function(){return function(e){this.name=void 0!==e.name?e.name:null,this.pbrMetallicRoughness=void 0!==e.pbrMetallicRoughness?new _e(e.pbrMetallicRoughness):new _e({baseColorFactor:[1,1,1,1],metallicFactor:1,metallicRoughnessTexture:1}),this.normalTexture=void 0!==e.normalTexture?new ve(e.normalTexture):null,this.occlusionTexture=void 0!==e.occlusionTexture?new ye(e.occlusionTexture):null,this.emissiveTexture=void 0!==e.emissiveTexture?new me(e.emissiveTexture):null,this.emissiveFactor=void 0!==e.emissiveFactor?e.emissiveFactor:[0,0,0],this.alphaMode=void 0!==e.alphaMode?e.alphaMode:"OPAQUE",this.alphaCutoff=void 0!==e.alphaCutoff?e.alphaCutoff:.5,this.doubleSided=e.doubleSided||!1,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}(),be=function(){return function(e,t,r){var i,n,a;for(this.mySkeleton=null,this.name=void 0!==t.name?t.name:null,this.skinID=r,this.joints=new Array(t.joints.length),i=0,a=this.joints.length;i<a;i++)this.joints[i]=e.nodes[t.joints[i]];if(this.skeleton=void 0!==t.skeleton?e.nodes[t.skeleton]:null,this.inverseBindMatrices=void 0!==t.inverseBindMatrices?e.accessors[t.inverseBindMatrices]:null,this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.inverseBindMatrices)for(this.inverseBindMatricesData=this.inverseBindMatrices.getAccessorData(),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(16*ae),i=0,n=0,a=this.inverseBindMatricesData.length;i<a;i+=16,n++)this.joints[n].inverseBindMatrix=U.a.fromValues(this.inverseBindMatricesData[i],this.inverseBindMatricesData[i+1],this.inverseBindMatricesData[i+2],this.inverseBindMatricesData[i+3],this.inverseBindMatricesData[i+4],this.inverseBindMatricesData[i+5],this.inverseBindMatricesData[i+6],this.inverseBindMatricesData[i+7],this.inverseBindMatricesData[i+8],this.inverseBindMatricesData[i+9],this.inverseBindMatricesData[i+10],this.inverseBindMatricesData[i+11],this.inverseBindMatricesData[i+12],this.inverseBindMatricesData[i+13],this.inverseBindMatricesData[i+14],this.inverseBindMatricesData[i+15])}}(),we=function(){return function(e,t){this.name=void 0!==t.name?t.name:null,this.nodes=new Array(t.nodes.length);for(var r=0,i=t.nodes.length;r<i;r++)this.nodes[r]=e.nodes[t.nodes[r]];this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.boundingBox=null}}(),xe=function(){return function(e){this.nodeID=void 0!==e.node?e.node:null,this.path=e.path,this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}(),Me=function(){return function(e,t){this.sampler=t.samplers[e.sampler],this.target=new xe(e.target),this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}(),Te=function(){return function(e,t){this.input=e.accessors[t.input],this.output=e.accessors[t.output],this.inputTypedArray=this.input.getAccessorData(),this.outputTypedArray=this.output.getAccessorData(),this.interpolation=void 0!==t.interpolation?t.interpolation:"LINEAR",this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null,this.curIdx=0,this.curValue=U.e.create(),this.endT=this.inputTypedArray[this.inputTypedArray.length-1],this.inputMax=this.endT-this.inputTypedArray[0]}}(),Ee=function(){return function(e,t){var r,i;for(this.name=void 0!==t.name?t.name:null,this.samplers=[],r=0,i=t.samplers.length;r<i;r++)this.samplers[r]=new Te(e,t.samplers[r]);for(this.channels=[],r=0,i=t.channels.length;r<i;r++)this.channels[r]=new Me(t.channels[r],this);this.extensions=void 0!==t.extensions?t.extensions:null,this.extras=void 0!==t.extras?t.extras:null}}(),Se=function(){return function(e){this.json=e,this.defaultScene=void 0!==e.scene?e.scene:0,this.version=Number(e.asset.version),e.accessors&&(this.accessors=new Array(e.accessors.length)),e.bufferViews&&(this.bufferViews=new Array(e.bufferViews.length)),e.scenes&&(this.scenes=new Array(e.scenes.length)),e.nodes&&(this.nodes=new Array(e.nodes.length)),e.meshes&&(this.meshes=new Array(e.meshes.length)),e.materials&&(this.materials=new Array(e.materials.length)),e.textures&&(this.textures=new Array(e.textures.length)),e.samplers&&(this.samplers=new Array(e.samplers.length)),e.images&&(this.images=new Array(e.images.length)),e.skins&&(this.skins=new Array(e.skins.length)),e.animations&&(this.animations=new Array(e.animations.length)),e.cameras&&(this.cameras=new Array(e.cameras.length)),this.extensions=void 0!==e.extensions?e.extensions:null,this.extras=void 0!==e.extras?e.extras:null}}(),Ae=function(){function e(e,t,r){this._buffers=[],this._gltfModel=e,this._resourceManager=t,this._materialManager=r}return e.load=function(t,r,i,n){var a=new H(n,r,i),o=new e(a,r,i);return new Promise(function(e){o.load(t,function(){e(a)})})},e.prototype._parse=function(){var e,t,r,i,n,a,o;if(this.model.bufferViews)for(e=0,t=this.model.bufferViews.length;e<t;e++)this.model.bufferViews[e]=new ue(this.model.json.bufferViews[e],this._buffers[this.model.json.bufferViews[e].buffer]);if(this.model.accessors)for(e=0,t=this.model.accessors.length;e<t;e++)this.model.accessors[e]=new le(this.model.json.accessors[e],this.model.bufferViews[this.model.json.accessors[e].bufferView]);if(this.model.materials)for(e=0,t=this.model.materials.length;e<t;e++)this.model.materials[e]=new ge(this.model.json.materials[e]);if(this.model.samplers)for(e=0,t=this.model.samplers.length;e<t;e++)this.model.samplers[e]=new fe(this.model.json.samplers[e]);if(this.model.textures)for(e=0,t=this.model.textures.length;e<t;e++)this.model.textures[e]=new pe(this,this.model.json.textures[e]);for(e=0,t=this.model.meshes.length;e<t;e++)this.model.meshes[e]=new he(this,this.model.json.meshes[e],e);for(e=0,t=this.model.nodes.length;e<t;e++)this.model.nodes[e]=new ce(this,this.model.json.nodes[e],e);for(e=0,t=this.model.nodes.length;e<t;e++)for(r=0,i=(a=this.model.nodes[e]).children.length;r<i;r++)a.children[r]=this.model.nodes[a.children[r]];var s,l=new Array(this.model.nodes.length);for(e=0,t=l.length;e<t;e++)l[e]=U.a.create();function u(e,t){var r=l[e.nodeID];if(null!==t)U.a.mul(r,l[t.nodeID],e.matrix);else{U.a.mul(r,[1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1],e.matrix)}e.matrixWorld=U.a.clone(r),e.matrixParent=U.a.clone(null!==t?l[t.nodeID]:U.a.create())}function c(e,t){var r,i=l[e.nodeID];r=null!==t?t.bvh:n.boundingBox,e.mesh&&(o=e.mesh).boundingBox&&(e.aabb=se.getAABBFromOBB(o.boundingBox,i),0===e.children.length&&(U.d.copy(e.bvh.min,e.aabb.min),U.d.copy(e.bvh.max,e.aabb.max))),U.d.min(r.min,r.min,e.bvh.min),U.d.max(r.max,r.max,e.bvh.max)}for(e=0,t=this.model.scenes.length;e<t;e++){for((n=this.model.scenes[e]=new we(this.model,this.model.json.scenes[e])).boundingBox=new se,r=0,i=n.nodes.length;r<i;r++)(a=n.nodes[r]).traverseTwoExecFun(null,u,c);n.boundingBox.calculateTransform()}for(r=0,i=this.model.nodes.length;r<i;r++)null!==(a=this.model.nodes[r]).bvh&&a.bvh.calculateTransform();if(this.model.animations)for(e=0,t=this.model.animations.length;e<t;e++)this.model.animations[e]=new Ee(this.model,this.model.json.animations[e]);if(this.model.json.skins)for(e=0,t=this.model.skins.length;e<t;e++)for(this.model.skins[e]=new be(this.model,this.model.json.skins[e],e),r=0,i=(s=this.model.skins[e].joints).length;r<i;r++)s[r].jointID=r;for(e=0,t=this.model.nodes.length;e<t;e++)null!==(a=this.model.nodes[e]).skin&&"number"==typeof a.skin&&(a.skin=this.model.skins[a.skin])},e.prototype._createTexture=function(e){var t=this.model.textures[e.index],r=this._modelUrl+"-"+e.index;if(this._resourceManager.hasTexture(r))return this._resourceManager.getTexture(r);var i=this._resourceManager.getTexture(r),n=t.source,a=this._resourceManager.gl,o=a.LINEAR,s=a.REPEAT;return t.sampler&&t.sampler.minFilter&&(o=t.sampler.minFilter),t.sampler&&t.sampler.wrapS&&(s=t.sampler.wrapS),i.createFromImage(n,-1===n.src.indexOf(".png")?a.RGB:a.RGBA,a.UNSIGNED_BYTE,o,s),i},e.prototype._createShader=function(e,t){var r=[];r.push("MODEL_TRANSFORM");var i=e.material;i&&(i.pbrMetallicRoughness.baseColorTexture&&r.push("HAS_BASECOLORMAP"),i.pbrMetallicRoughness.metallicRoughnessTexture&&r.push("HAS_METALROUGHNESSMAP"),i.normalTexture&&r.push("HAS_NORMALMAP"),i.occlusionTexture&&r.push("HAS_OCCLUSIONMAP"),i.emissiveTexture&&r.push("HAS_EMISSIVEMAP"),t&&r.push("HAS_SKIN")),void 0!==e.attributes.TANGENT&&r.push("HAS_TANGENT");var n=this._resourceManager.getShader("pbr",r);if(!n.ready){var a=N.a.pbr;if(n.createFromShaderSource(a,r),!n.ready)throw"modelo3d error at creating shader 'pbr'!"}return n},e.prototype._createMaterial=function(e,t){var r,i=this._resourceManager.gl,n=e.material,a=this._materialManager.createMaterialPbr(this._modelUrl+"-"+e.material.name);if(a.attachShader(t,this._resourceManager),a.setBaseColor(n.pbrMetallicRoughness.baseColorFactor),a.setMetallic(n.pbrMetallicRoughness.metallicFactor),a.setRoughness(n.pbrMetallicRoughness.roughnessFactor),a.setEmissive(n.emissiveFactor),this._resourceManager.hasTexture("modelo-brdf-lut")?r=this._resourceManager.getTexture("modelo-brdf-lut"):(r=this._resourceManager.getTexture("modelo-brdf-lut")).createFromFile(ne,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,function(){}),a.setBrdfLut(r),n.pbrMetallicRoughness.baseColorTexture){var o=n.pbrMetallicRoughness.baseColorTexture,s=this._createTexture(o);a.setBaseColorTexture(s)}if(n.normalTexture){o=n.normalTexture,s=this._createTexture(o);a.setNormalTexture(s)}if(n.pbrMetallicRoughness.metallicRoughnessTexture){o=n.pbrMetallicRoughness.metallicRoughnessTexture,s=this._createTexture(o);a.setMetallicRoughnessTexture(s)}if(n.emissiveTexture){o=n.emissiveTexture,s=this._createTexture(o);a.setEmissiveTexture(s)}if(n.occlusionTexture){o=n.occlusionTexture,s=this._createTexture(o);a.setOcclusionTexture(s)}return a},e.prototype._createMesh=function(e,t){var r=this._resourceManager.gl,i=new K,n=[],a=t.attributes.POSITION;i.add("m_aPosition",0,a.componentType,a.normalized,a.size,a.byteStride,a.byteOffset),n.push(a.bufferView.getBuffer(r,r.ARRAY_BUFFER)),void 0!==t.attributes.NORMAL&&(a=t.attributes.NORMAL,i.add("m_aNormal",1,a.componentType,a.normalized,a.size,a.byteStride,a.byteOffset),n.push(a.bufferView.getBuffer(r,r.ARRAY_BUFFER))),void 0!==t.attributes.TEXCOORD_0&&(a=t.attributes.TEXCOORD_0,i.add("m_aTexCoord",4,a.componentType,a.normalized,a.size,a.byteStride,a.byteOffset),n.push(a.bufferView.getBuffer(r,r.ARRAY_BUFFER))),void 0!==t.attributes.TANGENT&&(a=t.attributes.TANGENT,i.add("m_aTangent",7,a.componentType,a.normalized,a.size,a.byteStride,a.byteOffset),n.push(a.bufferView.getBuffer(r,r.ARRAY_BUFFER))),void 0!==t.attributes.JOINTS_0&&(a=t.attributes.JOINTS_0,i.add("m_aJoint0",8,a.componentType,a.normalized,a.size,a.byteStride,a.byteOffset),n.push(a.bufferView.getBuffer(r,r.ARRAY_BUFFER))),void 0!==t.attributes.WEIGHTS_0&&(a=t.attributes.WEIGHTS_0,i.add("m_aWeight0",9,a.componentType,a.normalized,a.size,a.byteStride,a.byteOffset),n.push(a.bufferView.getBuffer(r,r.ARRAY_BUFFER)));var o=this._resourceManager.getMesh(this._modelUrl+"_"+e+"_"+t.index),s=(a=this.model.accessors[t.indices]).bufferView.getBuffer(r,r.ELEMENT_ARRAY_BUFFER);return o.createFromBufferObject(n,s,i,t.mode,t.indicesComponentType,t.indicesLength,a.byteOffset),o},e.prototype._createDrawable=function(e,t,r,i,n){var a=t.boundingBox,o=new I.a(r,i,n,null,new Float32Array([a.min[0],a.min[1],a.min[2],a.max[0],a.max[1],a.max[2]]));return o.transform.set(e.matrixWorld),this._gltfModel.addDrawable(o),o},e.prototype._traverseNode=function(e){var t=this;if(e.mesh&&e.mesh.primitives.forEach(function(r){var i=e.nodeID+"_"+e.mesh.meshID,n=t._createMesh(i,r),a=t._createShader(r,!!e.skin),o=t._createMaterial(r,a),s=t._createDrawable(e,r,n,a,o);e.skin&&(s.skeleton=e.skin.mySkeleton)}),e.children.length>0)for(var r=0;r<e.children.length;r++)this._traverseNode(e.children[r])},e.prototype._buildSkeleton=function(e,t,r){var i=this;t.children.forEach(function(t){var n=r.get(t.nodeID.toString());e.addChild(n),i._buildSkeleton(n,t,r)})},e.prototype._setupScene=function(){var e=this;this.model.skins&&this.model.skins.length>0&&(this.model.skins.forEach(function(t){var r=new Map,i=new te(e._modelUrl+(t.skeleton?t.skeleton.nodeID.toString():""),t.skeleton&&t.skeleton.inverseBindMatrix?t.skeleton.inverseBindMatrix:U.a.create(),t.skeleton?t.skeleton.matrixWorld:U.a.create());r.set(i.getName(),i);var n=new ee(i,e._resourceManager);n.setRootMatrix(t.skeleton?t.skeleton.matrixParent:U.a.create()),t.joints.forEach(function(e){var t=r.get(e.nodeID.toString());t||(t=new te(e.nodeID.toString(),e.inverseBindMatrix,e.matrixWorld),r.set(t.getName(),t)),n.addJoint(t)}),t.skeleton?e._buildSkeleton(i,t.skeleton,r):e._buildSkeleton(i,t.joints[0],r),e._gltfModel.skeletons.push(n),t.mySkeleton=n}),this.model.animations.forEach(function(t,r){var i=new Map,n=0,a=new Set;t.channels.forEach(function(e){var t=e.sampler,r=G.LINEAR;switch(t.interpolation){case"LINEAR":r=G.LINEAR;break;case"STEP":r=G.STEP;break;case"CATMULLROMSPLINE":r=G.CATMULLROMSPLINE;break;case"CUBICSPLINE":r=G.CUBICSPLINE}for(var o=0,s=0;s<t.inputTypedArray.length;s++){var l=t.inputTypedArray[s];l>n&&(n=l);var u=i.get(l);u||(u=new ie(l),i.set(l,u));for(var c=u.getJointKeyFrames(),h=t.output.size,d=[],p=0;p<h;p++)d[p]=t.outputTypedArray[o+p];var f=e.target.nodeID.toString();a.has(f)||a.add(f);var m=c.get(f);switch(m||(m=new J,c.set(f,m)),m.setInterpolationMethod(r),e.target.path){case"translation":m.setTranslation(d);break;case"rotation":m.setRotation(d);break;case"scale":m.setScale(d)}o+=h}});var o=Array.from(i.values());o.sort(function(e,t){return e.getTimeStamp()-t.getTimeStamp()}),o.forEach(function(t){t.getJointKeyFrames().forEach(function(t,r){var i=parseInt(r),n=e.model.nodes[i];null===t.getTranslation()&&t.setTranslation(n.translation),null===t.getRotation()&&t.setRotation(n.rotation),null===t.getScale()&&t.setScale(n.scale)})}),o[0].getJointKeyFrames().forEach(function(e,t){for(var r=1;r<o.length;r++)o[r].getJointKeyFrames().has(t)||o[r].getJointKeyFrames().set(t,e)});var s=new re(r.toString(),n,o);a.forEach(function(t){for(var r=0;r<e._gltfModel.skeletons.length;r++){var i=e._gltfModel.skeletons[r];if(-1!==i.joints.findIndex(function(e){return e.getName()===t})){i.addAnimation(s);break}}})})),this.model.scenes.forEach(function(t){t.nodes.forEach(function(t){e._traverseNode(t)})});var t=this.model.scenes[0].boundingBox;this._gltfModel.bbox=new Float32Array([t.min[0],t.min[1],t.min[2],t.max[0],t.max[1],t.max[2]])},e.prototype.load=function(e,t){var r=this;this._modelUrl=e,this._baseUrl=this._getBaseUrl(e),Y.a.get(e,{responseType:"json"}).then(function(e){var i=e.data;r.model=new Se(i);var n=[];i.images&&n.push(r._loadImages(i.images)),i.buffers&&n.push(r._loadArraybuffer(i.buffers)),Promise.all(n).then(function(){r._parse(),r._setupScene(),t()})})},e.prototype._loadImages=function(e){var t=this;return new Promise(function(r,i){for(var n=e.length,a=function(){var a=new Image;a.src=t._baseUrl+e[o].uri,a.onload=function(){0===--n&&r(!0)},a.onerror=function(){console.error("failed to load image: "+a.src),i()},t.model.images[o]=a},o=0;o<e.length;o++)a()})},e.prototype._loadArraybuffer=function(e){var t=this;return new Promise(function(r,i){for(var n=[],a=0;a<e.length;a++){var o=e[a].uri;if("data:application/octet-stream;base64,"===o.substring(0,37)){var s=o.substring(37),l=t.base64toArrayBuffer(s);t._buffers[a]=l.buffer}else{var u=t._baseUrl+e[a].uri,c=Y.a.get(u,{responseType:"arraybuffer"});n.push(c)}}Promise.all(n).then(function(e){e.forEach(function(e,r){t._buffers[r]=e.data}),r(!0)})})},e.prototype._getBaseUrl=function(e){var t="",r=e.lastIndexOf("/");return-1!==r&&(t=e.substring(0,r+1)),t},e.prototype.base64toArrayBuffer=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(t),i=new Uint8Array(r.length),n=0;n<r.length;++n)i[n]=r.charCodeAt(n);return i},e}(),ke=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Pe=function(e){function t(t,r){return e.call(this,t,r)||this}return ke(t,e),t.prototype.attachShader=function(t,r){var i=e.prototype.attachShader.call(this,t,r);if(!i)return null;for(var n in t.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uFontBitmap"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=6,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uTextureSize"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uColor"===n&&(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue));return i},t.prototype.setFontBitmap=function(e){this.reservedParameters.m_uFontBitmap&&(this.reservedParameters.m_uFontBitmap.value=e),this.reservedParameters.m_uTextureSize&&(this.reservedParameters.m_uTextureSize.value=[e.width,e.height])},t.prototype.setColor=function(e){this.reservedParameters.m_uColor&&(this.reservedParameters.m_uColor.value=e)},t}(V),Ne=r(35),De=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ie=function(e){function t(t){var r=e.call(this,"bitmap-font",t)||this;return r._asciiMap=new Map,r._bitmap=new D.a("bitmap-font",t),r.ready=!1,r._fontInfo={name:"Arial",size:32,bold:!1,italic:!1,width:1024,height:128,characters:{0:{x:288,y:42,width:27,height:35,originX:5,originY:29,advance:18},1:{x:630,y:42,width:21,height:35,originX:3,originY:29,advance:18},2:{x:120,y:42,width:28,height:35,originX:5,originY:29,advance:18},3:{x:315,y:42,width:27,height:35,originX:5,originY:29,advance:18},4:{x:148,y:42,width:28,height:35,originX:6,originY:29,advance:18},5:{x:176,y:42,width:28,height:35,originX:5,originY:28,advance:18},6:{x:342,y:42,width:27,height:35,originX:5,originY:29,advance:18},7:{x:735,y:42,width:27,height:34,originX:5,originY:28,advance:18},8:{x:204,y:42,width:28,height:35,originX:5,originY:29,advance:18},9:{x:232,y:42,width:28,height:35,originX:5,originY:29,advance:18}," ":{x:471,y:77,width:12,height:12,originX:6,originY:6,advance:9},"!":{x:672,y:42,width:16,height:35,originX:3,originY:29,advance:9},'"':{x:304,y:77,width:21,height:20,originX:5,originY:29,advance:11},"#":{x:393,y:0,width:30,height:36,originX:6,originY:29,advance:18},$:{x:197,y:0,width:27,height:40,originX:5,originY:30,advance:18},"%":{x:562,y:0,width:37,height:35,originX:4,originY:29,advance:28},"&":{x:361,y:0,width:32,height:36,originX:5,originY:29,advance:21},"'":{x:325,y:77,width:16,height:20,originX:5,originY:29,advance:6},"(":{x:85,y:0,width:20,height:42,originX:4,originY:29,advance:10},")":{x:105,y:0,width:20,height:42,originX:4,originY:29,advance:10},"*":{x:281,y:77,width:23,height:22,originX:5,originY:29,advance:12},"+":{x:143,y:77,width:28,height:27,originX:4,originY:24,advance:18},",":{x:341,y:77,width:16,height:19,originX:3,originY:9,advance:9},"-":{x:403,y:77,width:21,height:15,originX:5,originY:15,advance:10},".":{x:424,y:77,width:16,height:15,originX:3,originY:9,advance:9},"/":{x:478,y:0,width:21,height:36,originX:6,originY:29,advance:9},":":{x:127,y:77,width:16,height:28,originX:3,originY:22,advance:9},";":{x:762,y:42,width:16,height:33,originX:3,originY:22,advance:9},"<":{x:171,y:77,width:28,height:27,originX:4,originY:25,advance:18},"=":{x:253,y:77,width:28,height:22,originX:4,originY:22,advance:18},">":{x:199,y:77,width:28,height:27,originX:4,originY:25,advance:18},"?":{x:369,y:42,width:27,height:35,originX:5,originY:29,advance:18},"@":{x:0,y:0,width:42,height:42,originX:4,originY:29,advance:32},A:{x:599,y:0,width:34,height:35,originX:6,originY:29,advance:21},B:{x:0,y:42,width:30,height:35,originX:4,originY:29,advance:21},C:{x:328,y:0,width:33,height:36,originX:5,originY:29,advance:23},D:{x:799,y:0,width:32,height:35,originX:4,originY:29,advance:23},E:{x:30,y:42,width:30,height:35,originX:4,originY:29,advance:21},F:{x:260,y:42,width:28,height:35,originX:4,originY:29,advance:19},G:{x:294,y:0,width:34,height:36,originX:4,originY:29,advance:25},H:{x:831,y:0,width:31,height:35,originX:4,originY:29,advance:23},I:{x:688,y:42,width:16,height:35,originX:3,originY:29,advance:9},J:{x:583,y:42,width:25,height:35,originX:5,originY:29,advance:16},K:{x:862,y:0,width:31,height:35,originX:4,originY:29,advance:21},L:{x:396,y:42,width:27,height:35,originX:4,originY:29,advance:18},M:{x:633,y:0,width:34,height:35,originX:4,originY:29,advance:26},N:{x:893,y:0,width:31,height:35,originX:4,originY:29,advance:23},O:{x:259,y:0,width:35,height:36,originX:5,originY:29,advance:25},P:{x:60,y:42,width:30,height:35,originX:4,originY:29,advance:21},Q:{x:224,y:0,width:35,height:37,originX:5,originY:29,advance:25},R:{x:667,y:0,width:33,height:35,originX:4,originY:29,advance:23},S:{x:924,y:0,width:31,height:35,originX:5,originY:29,advance:21},T:{x:955,y:0,width:31,height:35,originX:5,originY:29,advance:19},U:{x:986,y:0,width:31,height:35,originX:4,originY:29,advance:23},V:{x:700,y:0,width:33,height:35,originX:6,originY:29,advance:21},W:{x:520,y:0,width:42,height:35,originX:6,originY:29,advance:30},X:{x:733,y:0,width:33,height:35,originX:6,originY:29,advance:21},Y:{x:766,y:0,width:33,height:35,originX:6,originY:29,advance:21},Z:{x:90,y:42,width:30,height:35,originX:5,originY:29,advance:19},"[":{x:159,y:0,width:19,height:41,originX:4,originY:29,advance:9},"\\":{x:499,y:0,width:21,height:36,originX:6,originY:29,advance:9},"]":{x:178,y:0,width:19,height:41,originX:6,originY:29,advance:9},"^":{x:227,y:77,width:26,height:24,originX:5,originY:29,advance:15},_:{x:440,y:77,width:31,height:14,originX:7,originY:1,advance:18},"`":{x:385,y:77,width:18,height:16,originX:5,originY:29,advance:10},a:{x:960,y:42,width:27,height:29,originX:5,originY:23,advance:18},b:{x:423,y:42,width:27,height:35,originX:4,originY:29,advance:18},c:{x:987,y:42,width:27,height:29,originX:5,originY:23,advance:16},d:{x:450,y:42,width:27,height:35,originX:5,originY:29,advance:18},e:{x:848,y:42,width:28,height:29,originX:5,originY:23,advance:18},f:{x:608,y:42,width:22,height:35,originX:6,originY:29,advance:9},g:{x:451,y:0,width:27,height:36,originX:5,originY:23,advance:18},h:{x:531,y:42,width:26,height:35,originX:4,originY:29,advance:18},i:{x:704,y:42,width:16,height:35,originX:4,originY:29,advance:7},j:{x:125,y:0,width:19,height:42,originX:8,originY:29,advance:7},k:{x:557,y:42,width:26,height:35,originX:4,originY:29,advance:16},l:{x:720,y:42,width:15,height:35,originX:4,originY:29,advance:7},m:{x:778,y:42,width:35,height:29,originX:4,originY:23,advance:26},n:{x:27,y:77,width:26,height:29,originX:4,originY:23,advance:18},o:{x:876,y:42,width:28,height:29,originX:5,originY:23,advance:18},p:{x:477,y:42,width:27,height:35,originX:4,originY:23,advance:18},q:{x:504,y:42,width:27,height:35,originX:5,originY:23,advance:18},r:{x:105,y:77,width:22,height:29,originX:4,originY:23,advance:10},s:{x:53,y:77,width:26,height:29,originX:5,originY:23,advance:16},t:{x:651,y:42,width:21,height:35,originX:6,originY:29,advance:9},u:{x:79,y:77,width:26,height:29,originX:4,originY:23,advance:18},v:{x:904,y:42,width:28,height:29,originX:6,originY:23,advance:16},w:{x:813,y:42,width:35,height:29,originX:6,originY:23,advance:23},x:{x:932,y:42,width:28,height:29,originX:6,originY:23,advance:16},y:{x:423,y:0,width:28,height:36,originX:6,originY:23,advance:16},z:{x:0,y:77,width:27,height:29,originX:6,originY:23,advance:16},"{":{x:42,y:0,width:22,height:42,originX:5,originY:29,advance:10},"|":{x:144,y:0,width:15,height:42,originX:3,originY:29,advance:8},"}":{x:64,y:0,width:21,height:42,originX:5,originY:29,advance:10},"~":{x:357,y:77,width:28,height:17,originX:5,originY:20,advance:18}}},r._init(),r}return De(t,e),t.prototype._init=function(){var e=this,t=this._manager.gl;this._bitmap.create(1024,128,t.RGB8,t.LINEAR,t.CLAMP_TO_EDGE);var r=new Image;r.onload=function(){e._bitmap.updateImage(r,t.RGB,t.UNSIGNED_BYTE,t.LINEAR,t.CLAMP_TO_EDGE)},r.src="data:image/png;base64,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"},t.prototype.getGlyphs=function(e){for(var t=[],r=0;r<e.length;r++){var i=e.charCodeAt(r),n=this._fontInfo.characters[e[r]];if(this._asciiMap.has(i))t.push(this._asciiMap.get(i));else{var a={x1:n.x/this._fontInfo.width,y1:(n.y+n.height)/this._fontInfo.height,x2:(n.x+n.width)/this._fontInfo.width,y2:n.y/this._fontInfo.height,size:n.advance/this._fontInfo.size,width:n.width/this._fontInfo.size,height:n.height/this._fontInfo.size,xoffset:n.originX/2/this._fontInfo.size,yoffset:n.originY/this._fontInfo.size};t.push(a),this._asciiMap.set(i,a)}}return t},t.prototype.getTexture=function(){return this._bitmap},t}(Ne.a),Oe=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Re=function(e){function t(t,r,i){var n=e.call(this,t,r,i)||this;return n._content="",void 0!==n._resourceManager.bitmapFont?n._bitmapFont=n._resourceManager.bitmapFont:(n._resourceManager.bitmapFont=new Ie(r),n._bitmapFont=n._resourceManager.bitmapFont),n}return Oe(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.setContent=function(e){if(e!==this._content){this._content=e;var t=this._bitmapFont.getGlyphs(e);if(this.drawables[0]&&this.drawables[0].mesh.ready)this.drawables[0].mesh.destroy(),this.drawables[0].mesh=this._resourceManager.getMesh("text3d-"+e),this.drawables[0].mesh.ready||this.drawables[0].mesh.createTextGrid(t);else{var r=this._resourceManager.getMesh("text3d-"+e);r.ready||r.createTextGrid(t);var i=this._resourceManager.getShader("text3d-"+this.name,["MODEL_TRANSFORM"]);i.ready||i.createFromShaderSource(N.a.df_text,["MODEL_TRANSFORM"]);var n=new Pe("text3d-material-"+this.name,this._resourceManager);n.attachShader(i,this._resourceManager),n.setFontBitmap(this._bitmapFont.getTexture()),n.setColor([0,0,0]),n.transparent=!0;var a=new Float32Array([-1,-1,0,1,1,0]);this.addDrawable(this._createDrawable(r,i,n,a)),this.bbox?P.a.aabb.union(this.bbox,this.bbox,a):this.bbox=a}}},t.prototype.setColor=function(e){this.drawables.forEach(function(t){t.material.setColor(e)})},t.prototype._createDrawable=function(e,t,r,i){return new I.a(e,t,r,null,i)},t}(q),Ce=r(51),Be=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Le=(U.d.fromValues(0,0,0),U.a.create(),function(e){function t(t){var r=e.call(this,t)||this;return r._up=U.d.create(),r._forward=U.d.create(),r._right=U.d.create(),r._translate=U.d.create(),r._transformMatrix=U.a.create(),r.matrix&&(U.a.copy(r._transformMatrix,r.matrix),U.a.copy(r.matrix,r.matrix)),r}return Be(t,e),t.prototype.setTranslation=function(t,r,i){U.a.copy(this.matrix,this._transformMatrix),e.prototype.setTranslation.call(this,t,r,i),U.a.copy(this._transformMatrix,this.matrix)},t.prototype.setScaling=function(t,r,i){U.a.copy(this.matrix,this._transformMatrix),e.prototype.setScaling.call(this,t,r,i),U.a.copy(this._transformMatrix,this.matrix)},t.prototype.setFaceCameraZ=function(e){this._faceCameraZ=e},t.prototype.update=function(e,t){this._up=U.d.create(),this._forward=U.d.create(),this._right=U.d.create(),this._faceCameraZ?(this._forward[0]=e._at[0]-e.eye[0],this._forward[1]=e._at[1]-e.eye[1],this._forward[2]=e._at[2]-e.eye[2]):(this._forward[0]=t[0]-e.eye[0],this._forward[1]=t[1]-e.eye[1],this._forward[2]=0),U.d.normalize(this._forward,this._forward),this._up[2]=1,U.d.cross(this._right,this._forward,this._up),U.d.normalize(this._right,this._right),U.d.cross(this._up,this._right,this._forward),U.d.normalize(this._up,this._up);var r=U.a.create();r[0]=this._right[0],r[1]=this._right[1],r[2]=this._right[2],r[3]=0,r[4]=this._forward[0],r[5]=this._forward[1],r[6]=this._forward[2],r[7]=0,r[8]=this._up[0],r[9]=this._up[1],r[10]=this._up[2],r[11]=0,this._translate=U.d.create(),this._translate[0]=this._transformMatrix[12],this._translate[1]=this._transformMatrix[13],this._translate[2]=this._transformMatrix[14],this._transformMatrix[12]=this._transformMatrix[13]=this._transformMatrix[14]=0,U.a.multiply(this.matrix,r,this._transformMatrix),this.matrix[12]=this._translate[0],this.matrix[13]=this._translate[1],this.matrix[14]=this._translate[2],this._transformMatrix[12]=this._translate[0],this._transformMatrix[13]=this._translate[1],this._transformMatrix[14]=this._translate[2],this._updateMatrixBuffer()},t}(Ce.a)),Fe=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ve=function(e){function t(t,r,i,n,a){var o=e.call(this,t,r,i,n,a)||this;return o.faceCamera=!0,o.transform=new Le(n),o.bbox=P.a.aabb.createFromSphere(o.bsphere),o._center=P.a.aabb.center(o.bbox),o}return Fe(t,e),t.prototype.destroy=function(){this._center=null,delete this._center,e.prototype.destroy.call(this)},t.prototype.isShadowCaster=function(){return!0},t.prototype.update=function(e){this.transform.update(e,this._center)},t.prototype.setTranslation=function(t,r,i){e.prototype.setTranslation.call(this,t,r,i),this._center=P.a.aabb.center(this.bbox)},t.prototype.translate=function(t,r,i){e.prototype.translate.call(this,t,r,i),this._center=P.a.aabb.center(this.bbox)},t.prototype.clone=function(){var e=new t(this.mesh,this.shader,this.material.clone(this.material.name+"-cloned"),this.transform.matrix,this.bbox);return e.faceCamera=this.faceCamera,e.bsphere=this.bsphere,e.distance=this.distance,e.nodes=this.nodes,e.hidables=this.hidables,e.originalMaterial=this.originalMaterial,e._center=this._center,e},t}(I.a),Ue=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ze=function(e){function t(t,r,i){return e.call(this,t,r,i)||this}return Ue(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype._createDrawable=function(e,t,r,i){return new Ve(e,t,r,null,i)},t.prototype.setFaceCameraZ=function(e){this.drawables.forEach(function(t){t.transform.setFaceCameraZ(e)})},t}(Re),je=function(){function e(e,t,r,i){this._sceneJson=e,this._sceneBin=t,this._modelJson=r,this._modelBin=i,this._samplersLocation=0,this._texturesLocation=0,this._materialsLocation=0,this._attributesLocation=0,this._meshesLocation=0,this._nodesLocation=0,this._initialize(e,t,r,i)}return e.prototype.destroy=function(){this._sceneBin=null,this._sceneJson=null,this._modelBin=null,this._modelJson=null,delete this._sceneBin,delete this._sceneJson,delete this._modelBin,delete this._modelJson,this._samplersLocation=null,this._texturesLocation=null,this._materialsLocation=null,this._attributesLocation=null,delete this._samplersLocation,delete this._texturesLocation,delete this._materialsLocation,delete this._attributesLocation,this._meshesLocation=null,this._nodesLocation=null,delete this._meshesLocation,delete this._nodesLocation},e.prototype._initialize=function(e,t,r,i){var n=0;e.samplers.length>0&&(this._samplersLocation=n,n+=4*e.samplers.length),e.textures.length>0&&(this._texturesLocation=n,n+=4*e.textures.length),e.materials.length>0&&(this._materialsLocation=n,n+=16*e.materials.length),e.attributes.length>0&&(this._attributesLocation=n),this._meshesLocation=8;var a=new Uint32Array(i,0,2);this._nodesLocation=20*a[0]+8},e.prototype.readSampler=function(e){return new Uint8Array(this._sceneBin,this._samplersLocation+1*e*4,4)},e.prototype.readTexture=function(e){return new Uint8Array(this._sceneBin,this._texturesLocation+1*e*4,4)},e.prototype.readMaterial=function(e){return new Uint8Array(this._sceneBin,this._materialsLocation+1*e*16,16)},e.prototype.readAttribute=function(e){return new Int8Array(this._sceneBin,this._attributesLocation+1*e*8,8)},e.prototype.readMesh=function(e){return new Uint32Array(this._modelBin,this._meshesLocation+4*e*5,5)},e.prototype.readNodeData=function(e){return new Uint32Array(this._modelBin,this._nodesLocation+4*e*21,3)},e.prototype.readNodeBBox=function(e){return new Float32Array(this._modelBin,this._nodesLocation+4*(21*e+3),6)},e.prototype.readNodeTransform=function(e){return new Float32Array(this._modelBin,this._nodesLocation+4*(21*e+9),12)},e.prototype.getBuffer=function(){return this._modelBin},e}(),Ge=r(28),qe=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},Qe=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},He=new Float32Array(16);var We=function(){function e(e,t,r,i,n){void 0===n&&(n=!1),this._pawn=e,this._modelId=t,this._resourceManager=r,this._materialManager=i,this._billboard=n,this._sceneJson=null,this._modelJson=null,this._binLoader=null,this.drawables=[]}return e.prototype.destroy=function(){this._pawn=null,delete this._pawn,this._modelId=null,delete this._modelId,this._resourceManager=null,delete this._resourceManager,this._materialManager=null,delete this._materialManager,this._sceneJson=null,delete this._sceneJson,this._modelJson=null,delete this._modelJson,this._binLoader.destroy(),this._binLoader=null,delete this._binLoader,this.drawables=null,delete this.drawables},e.prototype.load=function(){return qe(this,void 0,void 0,function(){var e=this;return Qe(this,function(t){return[2,Object(Ge.b)(this._modelId).then(function(t){return t["scene.json"].downloadFile().then(function(r){var i;if(i="string"==typeof r.data?JSON.parse(r.data):r.data,e._sceneJson=i,i.source){var n=e._sceneJson.source.split(".");switch(n[n.length-1]){case"skp":e._pawn.faces=2,e._pawn.hasContours=!0;break;case"rfa":case"rvt":e._pawn.faces=1,e._pawn.hasContours=!0;break;case"vgx":case"stl":case"max":e._pawn.faces=1;break;case"obj":case"3dm":case"nwd":e._pawn.faces=0;break;default:e._pawn.faces=1}}return e._load(t,i)})})]})})},e.prototype._load=function(e,t){return qe(this,void 0,void 0,function(){var r=this;return Qe(this,function(i){return this._sceneJson=t,[2,e["model.json"].downloadFile().then(function(i){return r._modelJson=i.data,r._pawn.bbox=new Float32Array(r._modelJson["model.bin"].bbox),e["scene.bin"].downloadFile().then(function(i){var n=i.data;return e["model.bin"].downloadFile().then(function(i){var a=i.data;return r._binLoader=new je(t,n,r._modelJson,a),r._loadTextures(e).then(function(){return r._loadMeshes(e)})})})})]})})},e.prototype._loadTextures=function(e){return qe(this,void 0,void 0,function(){var t,r,i,n,a,o,s,l=this;return Qe(this,function(u){if(0===this._sceneJson.textures.length)return[2,Promise.resolve("ok")];for(t=new Array(this._sceneJson.samplers.length),o=0,s=this._sceneJson.samplers.length;o<s;o++)t[o]={filter:X.a.LINEAR_MIPMAP_LINEAR,wrap:X.a.REPEAT},1===(r=this._binLoader.readSampler(o))[0]?t[o].filter=1===r[2]?X.a.LINEAR_MIPMAP_LINEAR:X.a.LINEAR:t[o].filter=1===r[2]?X.a.NEAREST_MIPMAP_NEAREST:X.a.NEAREST,t[o].wrap=1===r[1]?X.a.REPEAT:X.a.CLAMP_TO_EDGE;for(i={},Object.keys(e).forEach(function(t){var r=t.toLowerCase();i[r]=e[t]}),a=(n=function(e){var r=l._sceneJson.textures[e].name,n=r.toLowerCase();return i[n].downloadFile().then(function(i){var n=l._binLoader.readTexture(e),a=t[n[1]],o=l._resourceManager.getTexture(r),s=4===n[0]?X.a.RGBA:X.a.RGB;if(o.updateImage(i,s,X.a.UNSIGNED_BYTE,a.filter,a.wrap),!o.ready)return Promise.reject("modelo3d loader errors at creating texture object '"+r+"'.")})})(0),o=1,s=this._sceneJson.textures.length;o<s;o++)a=function(e){return a.then(function(){return n(e)})}(o);return[2,a]})})},e.prototype._loadMeshes=function(e){return qe(this,void 0,void 0,function(){var t,r,i,n,a,o,l,u,c,h,d,p,f,m,_,v,y,g,b,w,x,M,T,E,S,A,k,P,N,D,I,O,R,C=this;return Qe(this,function(B){for(t=new Array(this._sceneJson.attributes.length),r=[X.a.POINTS,X.a.LINES,X.a.LINES,X.a.LINES,X.a.TRIANGLES],i=[X.a.BYTE,X.a.UNSIGNED_BYTE,X.a.SHORT,X.a.UNSIGNED_SHORT,X.a.INT,X.a.UNSIGNED_INT,0,X.a.FLOAT,0],n=0,R=this._sceneJson.attributes.length;n<R;n++)t[n]=new K,this._sceneJson.attributes[n],a=this._binLoader.readAttribute(n),t[n].primitive=r[a[0]],o=a[1]>=0?i[a[1]]:null,l=a[2]>=0?i[a[2]]:null,u=a[3]>=0?i[a[3]]:null,t[n].builtin(X.a.FLOAT,o,l,u);for(c=this._modelJson["model.bin"].nodes,h=this._modelJson.buffers.length,d=0,m=0;m<h;m++)d+=this._modelJson.buffers[m].byteLength;if(d>1024*s.a.gpuMemory*1024)throw new Error("No enough GPU memory to load this model: "+d);for(p=new Array(h),f=0;f<h;f++)p[f]=[];for(m=0;m<c;m++)S=this._binLoader.readNodeData(m),_=this._binLoader.readMesh(S[1]),v=_[0]>>16,p[v].push(m);for(y=0,g=0,b=0,R=p.length;b<R;++b){for(w=p[b],x=0,M=0,T=0,E=w.length;T<E;T++)S=this._binLoader.readNodeData(w[T]),A=this._binLoader.readMesh(S[1]),k=A[2],P=A[4],x+=k=k+3&-4,M+=P=P+3&-4;y<x&&(y=x),g<M&&(g=M)}for(N=new ArrayBuffer(y),D=new ArrayBuffer(g),I=this._loadMesh(0,e["mesh0.bin"],p,N,D,t),O=1,R=this._modelJson.buffers.length;O<R;O++)I=function(r){return I.then(function(){var i="mesh"+r.toString()+".bin";return C._loadMesh(r,e[i],p,N,D,t)})}(O);return[2,I]})})},e.prototype._loadMesh=function(e,t,r,i,n,a){var o=this;return t.downloadFile().then(function(t){var s=t.data,l=r[e],u=o._resourceManager.getBuffer(o._modelId+"vmesh"+e+".bin"),c=o._resourceManager.getBuffer(o._modelId+"imesh"+e+".bin"),h=!1;u.ready||c.ready||(u.create(X.a.ARRAY_BUFFER,new Uint8Array(1)),c.create(X.a.ELEMENT_ARRAY_BUFFER,new Uint8Array(1)),h=!0);for(var d=0,p=0,f=0,m=l.length;f<m;++f){var _=l[f],v=o._binLoader.readNodeData(_),y=o._binLoader.readMesh(v[1]),g=y[0]>>8&255,b=a[g],w=null;if(o._resourceManager.hasMesh(o._modelId+v[1]))w=o._createDrawable(_,v,y,b,u,c,null,null);else{var x=new Uint8Array(i,d,y[2]),M=new Uint8Array(n,p,y[4]),T=new Uint8Array(s,y[1],y[2]);x.set(T);var E=new Uint8Array(s,y[3],y[4]);M.set(E),d=(d+=y[2])+3&-4,p=(p+=y[4])+3&-4,w=o._createDrawable(_,v,y,b,u,c,x,M)}o.drawables.push(w)}h&&(u.update(new Uint8Array(i,0,d)),c.update(new Uint8Array(n,0,p)))})},e.prototype._createDrawable=function(e,t,r,i,n,a,o,s){var l=255&r[0],u=this._createShaderObject(t,i);if(u){var c=this._createMaterialObject(t,u,i);if(c){var h=this._createMeshObject(t[1],i,l,o,s,n,a);if(h){var d=null;0==(1073741824&t[2])&&(d=function(e){return He[0]=e[0],He[1]=e[1],He[2]=e[2],He[3]=0,He[4]=e[3],He[5]=e[4],He[6]=e[5],He[7]=0,He[8]=e[6],He[9]=e[7],He[10]=e[8],He[11]=0,He[12]=e[9],He[13]=e[10],He[14]=e[11],He[15]=1,He}(this._binLoader.readNodeTransform(e)));var p=this._binLoader.readNodeBBox(e),f=void 0;return(f=this._billboard?new Ve(h,u,c,d,p):new I.a(h,u,c,d,p)).visible=!0,f}throw new Error("No enough GPU memory for new meshes.")}}},e.prototype._createMeshObject=function(e,t,r,i,n,a,o){var s=this._resourceManager.getMesh(this._modelId+e);if(!s.ready){for(var l=[X.a.UNSIGNED_BYTE,X.a.UNSIGNED_BYTE,X.a.UNSIGNED_SHORT,X.a.UNSIGNED_SHORT,X.a.UNSIGNED_INT],u=t.clone(),c=0,h=t.values.length;c<h;c++)u.values[c].offset+=i.byteOffset;s.createShared(u.primitive,u,i,n,l[r],a,o)}return s},e.prototype._createMaterialObject=function(e,t,r){var i=this._sceneJson.materials[65535&e[0]];r.primitive===X.a.LINES&&(i="mxLine-"+i);var n=this._materialManager.getMaterial(this._modelId+i);if(!n){var a=this._binLoader.readMaterial(65535&e[0]);(n=this._materialManager.createMaterialAdhoc(this._modelId+i)).attachShader(t);var o=[0,0,0];if(o[0]=a[0]/255,o[1]=a[1]/255,o[2]=a[2]/255,n.setDiffuse(o),n.setTransparent(a[3]/255),255!==a[4]){var s=a[5]<<8|a[4],l=this._modelId+this._sceneJson.textures[s].name,u=this._binLoader.readTexture(s);4===u[0]?1===u[2]?(n.hasMask=!0,n.transparent=!1):n.transparent=!0:n.transparent?n.transparent=!0:n.transparent=!1;var c=this._resourceManager.getTexture(l);n.setDiffuseTexture(c)}}return n},e.prototype._createShaderObject=function(e,t){var r=this._binLoader.readMaterial(65535&e[0]),i=255!==r[4],n="solid";t.primitive===X.a.LINES?n="plain":t.hasColor?n="color":i&&(n="texture");var a=[];if(e[2]>>30&1&&!this._billboard||a.push("MODEL_TRANSFORM"),i){var o=r[5]<<8|r[4];this._binLoader.readTexture(o)[2]&&a.push("ALPHATEST")}var s=this._resourceManager.getShader(n,a);if(!s.ready){var l=N.a[n];if(s.createFromShaderSource(l,a),!s.ready)throw"modelo3d error at creating shader '"+n+"'!"}return s},e}(),Ye=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Xe=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},Ze=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Ke=function(e){function t(t,r,i){return e.call(this,t,r,i)||this}return Ye(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.setFaceCameraZ=function(e){this.drawables.forEach(function(t){t.transform.setFaceCameraZ(e)})},t.prototype.load=function(e){return Xe(this,void 0,void 0,function(){var t,r=this;return Ze(this,function(i){return this.drawables.length>0?(console.error("Can't re-initialize pawn."),[2]):[2,(t=new We(this,e,this._resourceManager,this._materialManager,!0)).load().then(function(){t.drawables.forEach(function(e){r.addDrawable(e)}),t.destroy()}).catch(function(e){console.warn(e)})]})})},t.prototype.createSolidQuad=function(e){void 0===e&&(e=[.5,.5,.5]);var t=this._resourceManager.getShader(this.name,["MODEL_TRANSFORM"]);t.ready||t.createFromShaderSource(N.a.plain,["MODEL_TRANSFORM"]);var r=this._materialManager.createMaterialAdhoc("pawn-billboard-material-"+this.name);r.attachShader(t,this._resourceManager),r.setDiffuse(e);var i=this._resourceManager.getMesh(this.name);i.createQuad(!0,!0,!0),this.addDrawable(new Ve(i,t,r,null,new Float32Array([-1,0,-1,1,0,1])));var n=new Float32Array([-1,0,-1,1,0,1]);P.a.aabb.scale(n,n,1.01),this.bbox?P.a.aabb.union(this.bbox,this.bbox,n):this.bbox=n},t.prototype.createTexturedQuad=function(e){var t=this._resourceManager.getShader(this.name,["MODEL_TRANSFORM"]);t.ready||t.createFromShaderSource(N.a.plain_texture,["MODEL_TRANSFORM"]);var r=this._resourceManager.getTexture(this.name),i=this._resourceManager.gl,n=e.src.split(".");"png"!==n[n.length-1]&&"svg"!==n[n.length-1]?r.createFromImage(e,i.RGB,i.UNSIGNED_BYTE,i.LINEAR,i.CLAMP_TO_EDGE):r.createFromImage(e,i.RGBA,i.UNSIGNED_BYTE,i.LINEAR,i.CLAMP_TO_EDGE);var a=this._materialManager.createMaterialAdhoc("pawn-billboard-material-"+this.name);a.attachShader(t,this._resourceManager),a.setDiffuseTexture(r),a.setDiffuse([1,1,1]),r.hasAlpha()&&(a.transparent=!0);var o=this._resourceManager.getMesh(this.name);o.createQuad(!0,!0,!0),this.addDrawable(new Ve(o,t,a,null,new Float32Array([-1,0,-1,1,0,1])));var s=new Float32Array([-1,0,-1,1,0,1]);P.a.aabb.scale(s,s,1.01),this.bbox?P.a.aabb.union(this.bbox,this.bbox,s):this.bbox=s},t}(H),Je=function(){function e(){this._zAngle=0,this._target=U.d.create(),this.intensity=1.05,this.shinness=100,this.envmapMatrix=U.a.create(),this._initialDirection=U.d.clone([.81961,-.28627,-.49804]),this._latitude=Math.asin(-this._initialDirection[2]),this._longitude=Math.atan2(-this._initialDirection[1],-this._initialDirection[0]),this.direction=U.d.clone(this._initialDirection),this.basedirection=U.d.clone(this._initialDirection);var e=U.a.clone([1.586253,-.725169,.70441,-2.30068,-.725169,-1.586253,-.359456,1.623691,.70441,-.359456,-.237555,-.893975,-2.30068,1.623691,-.893975,6.141995]),t=U.a.clone([1.329145,-.730669,.591031,-2.126058,-.730669,-1.329145,-.403495,1.890295,.591031,-.403495,-.159067,-.888839,-2.126058,1.890295,-.888839,6.193693]),r=U.a.clone([.870924,-.654664,.433506,-1.748137,-.654664,-.870924,-.440849,2.254821,.433506,-.440849,-.109753,-.848042,-1.748137,2.254821,-.848042,6.301804]);U.a.multiplyScalar(e,e,.0299),U.a.multiplyScalar(t,t,.0587),U.a.multiplyScalar(r,r,.0114),U.a.add(this.envmapMatrix,e,t),U.a.add(this.envmapMatrix,this.envmapMatrix,r),this._constantEnvmapMatrix=U.a.clone(this.envmapMatrix),this._initialEnvmapMatrix=U.a.clone(this.envmapMatrix),this._initialDirection=U.d.clone([.81961,-.49804,.28627]),this._initialEnvmapMatrix=U.a.clone(this._constantEnvmapMatrix),this._setFlipYZ(!1),this.setLatitude(.17*Math.PI),this.setLongitude(1.78*Math.PI)}return e.prototype._setFlipYZ=function(e){if(this._flipYZ=e,e)this._initialDirection=U.d.clone([.81961,-.49804,.28627]),this._initialEnvmapMatrix=U.a.clone(this._constantEnvmapMatrix);else{this._initialDirection=U.d.clone([.81961,-.28627,-.49804]);var t=U.a.clone([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),r=U.a.create();U.a.transpose(r,t);var i=U.a.create();U.a.multiply(this._initialEnvmapMatrix,U.a.multiply(i,r,this._constantEnvmapMatrix),t)}},e.prototype.setIntensity=function(e){this.intensity=e},e.prototype.getIntensity=function(){return this.intensity},e.prototype.setSpecularShinness=function(e){this.shinness=e},e.prototype.setLatitude=function(e){this._latitude=e;var t=Math.cos(this._latitude);this.basedirection[0]=-t*Math.cos(this._longitude),this.basedirection[1]=t*Math.sin(this._longitude),this.basedirection[2]=-Math.sin(this._latitude),this._updateDirection(),this._updateEnvmapMatrix()},e.prototype.setZRotation=function(e){this._zAngle=e,this._updateDirection(),this._updateEnvmapMatrix()},e.prototype.setLongitude=function(e){this._longitude=e;var t=Math.cos(this._latitude);this.basedirection[0]=-t*Math.cos(this._longitude),this.basedirection[1]=t*Math.sin(this._longitude),this.basedirection[2]=-Math.sin(this._latitude),this._updateDirection(),this._updateEnvmapMatrix()},e.prototype.getLongitude=function(){return this._longitude},e.prototype.getLatitude=function(){return this._latitude},e.prototype.getDirection=function(){return this.direction},e.prototype._updateEnvmapMatrix=function(){var e=U.b.create(),t=U.d.create();U.d.cross(t,this.direction,this._initialDirection),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1+U.d.dot(this.direction,this._initialDirection),U.b.normalize(e,e);var r=U.a.create();U.a.fromQuat(r,e);var i=U.a.create();U.a.transpose(i,r);var n=U.a.create();U.a.multiply(this.envmapMatrix,U.a.multiply(n,i,this._initialEnvmapMatrix),r)},e.prototype._updateDirection=function(){U.d.rotateAxisZ(this.direction,this.basedirection,this._zAngle)},e}(),$e=function(){function e(e){this._enabled=!1,this._planes=[],this._bbox=P.a.aabb.createFromArray([-1,-1,-1,1,1,1]),this._clip=P.a.aabb.createFromArray([0,0,0,0,0,0]),this._planes=P.a.aabb.planes(this._clip),this._points=[U.d.create(),U.d.create(),U.d.create(),U.d.create(),U.d.create(),U.d.create(),U.d.create(),U.d.create()]}return e.prototype.initialize=function(e){this._bbox=P.a.aabb.createFromArray(e),this._bbox[0]-=2e-5,this._bbox[1]-=2e-5,this._bbox[2]-=2e-5,this._bbox[3]+=2e-5,this._bbox[4]+=2e-5,this._bbox[5]+=2e-5,this.reset()},e.prototype.reset=function(){var e=P.a.aabb.min(this._bbox),t=P.a.aabb.max(this._bbox);this._clip=P.a.aabb.create(e,t),this._points=P.a.aabb.points(this._clip),this._planes=P.a.aabb.planes(this._clip)},e.prototype.getCenter=function(){return P.a.aabb.center(this._clip)},e.prototype.getRadius=function(){return.5*P.a.aabb.len(this._clip)},e.prototype.get=function(){return this._clip},e.prototype.getBBox=function(){return this._bbox},e.prototype.getClippingPlanes=function(e){if(e){var t=[];return t.push(U.e.clone(this._planes[0])),t.push(U.e.clone(this._planes[1])),t.push(U.e.clone(this._planes[2])),t.push(U.e.clone(this._planes[3])),t.push(U.e.clone(this._planes[4])),t.push(U.e.clone(this._planes[5])),t}return this._planes},e.prototype.getClippingPoints=function(e){if(e){var t=[];return t.push(U.d.clone(this._points[0])),t.push(U.d.clone(this._points[1])),t.push(U.d.clone(this._points[2])),t.push(U.d.clone(this._points[3])),t.push(U.d.clone(this._points[4])),t.push(U.d.clone(this._points[5])),t.push(U.d.clone(this._points[6])),t.push(U.d.clone(this._points[7])),t}return this._points},e.prototype.getMin=function(){return P.a.aabb.min(this._clip)},e.prototype.getMax=function(){return P.a.aabb.max(this._clip)},e.prototype.update=function(e){for(var t=0;t<e.length;t++)U.d.copy(this._points[t],e[t]);P.a.aabb.createFromPoints(this._clip,e),U.e.copy(this._planes[0],P.a.plane.create(e[0],e[4],e[7])),U.e.copy(this._planes[1],P.a.plane.create(e[1],e[2],e[6])),U.e.copy(this._planes[2],P.a.plane.create(e[0],e[1],e[5])),U.e.copy(this._planes[3],P.a.plane.create(e[2],e[3],e[7])),U.e.copy(this._planes[4],P.a.plane.create(e[0],e[3],e[2])),U.e.copy(this._planes[5],P.a.plane.create(e[4],e[5],e[6]))},e.prototype.set=function(e,t){this._enabled=!0,"number"==typeof t[0]?(this._clip=P.a.aabb.create(e,t),this._points=P.a.aabb.points(this._clip),this._planes=P.a.aabb.planes(this._clip)):this.update(t)},e.prototype.isEnabled=function(){return this._enabled},e.prototype.setEnabled=function(e){this._enabled=e},e}(),et=r(20),tt=function(){function e(e){this._resourceManager=e,this.color=new Float32Array([1,1,1,1]),this.mode=et.a.SKYBOX_SOLIDCOLOR,this.skybox=null}return e.prototype.destroy=function(){null!==this.skybox&&this.skybox.destroy(),this.skybox=null,delete this.skybox,this.color=null,delete this.color},e.prototype.setColor=function(e){this.color[0]=e[0],this.color[1]=e[1],this.color[2]=e[2],this.color[3]=e[3]},e.prototype.getColor=function(){return[this.color[0],this.color[1],this.color[2],this.color[3]]},e.prototype.setImages=function(e){this.skybox||(this.skybox=new et.b(this._resourceManager)),this.skybox.setImage(e)},e.prototype.setMode=function(e){e!==et.a.SKYBOX_SOLIDCOLOR?(this.skybox||(this.skybox=new et.b(this._resourceManager)),this.skybox.setMode(e)):this.skybox,this.mode=e},e.prototype.setBackgroundDirection=function(e){this.mode!==et.a.SKYBOX_SOLIDCOLOR&&(this.skybox||(this.skybox=new et.b(this._resourceManager)),this.skybox.setDirection(e))},e}(),rt=r(19),it=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),nt=[1,0,1,1,.8,1,0,0,0,1],at=function(e){function t(t,r){var i=e.call(this,t)||this;return i._reservedParameters2={},i._materialParameters=null,i._resourceManager=r,i}return it(t,e),t.prototype.destroy=function(){this._reservedParameters2=null,delete this._reservedParameters2,this._materialParameters=null,delete this._materialParameters,e.prototype.destroy.call(this)},t.prototype.attachShader=function(t,r){if(!t&&!r)return null;if(!t){if(!(t=r.getShader("solid",[])).ready){var i=N.a.solid;if(t.createFromShaderSource(i,["MODEL_TRANSFORM"]),!t.ready)throw"modelo3d error at creating shader 'solid'!"}}if(!t||!t.ready)return null;for(var n in e.prototype.attachShader.call(this,t,r),t.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uSpecularEnvMap"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=4,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uBrdfLut"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=5,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uBaseColorTexture"===n?(this.reservedParameters[n]=new R.a,this.hasTexture=!0,this.reservedParameters[n].texUnit=8,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):n.indexOf("m_uMaterial")>=0?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue,this._materialParameters=new Float32Array(nt),this.reservedParameters[n].value=this._materialParameters):"m_uNormalTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=9,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uMetallicRoughnessTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=10,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uEmissiveTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=11,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uOcclusionTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=12,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uDiffuseEnvMap"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=13,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uTransformTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=14,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uTotalLod"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uReflectIntensity"===n&&(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue));return t},t.prototype.equal=function(e){return this._materialParameters[0]===e[0]&&this._materialParameters[0]===e[0]&&this._materialParameters[2]===e[2]&&this._materialParameters[3]===e[3]},t.prototype.hash=function(){var e="",t=this._materialParameters;return e=e+t[0].toString()+t[1].toString()+t[2].toString()+t[3].toString()},t.prototype.getBaseColor=function(){return[this._materialParameters[0],this._materialParameters[1],this._materialParameters[2],this._materialParameters[3]]},t.prototype.setBaseColor=function(e){var t=this._materialParameters;t[0]=e[0],t[1]=e[1],t[2]=e[2],void 0!==e[3]&&(t[3]=e[3])},t.prototype.setEmissive=function(e){var t=this._materialParameters;t[6]=e[0],t[7]=e[1],t[8]=e[2]},t.prototype.setTransparent=function(e){this._materialParameters[3]=e,this.transparent=e<.99},t.prototype.getTransparent=function(){return this._materialParameters[3]},t.prototype.getRoughness=function(){return this._materialParameters[4]},t.prototype.setRoughness=function(e){this._materialParameters[4]=e},t.prototype.getMetallic=function(){return this._materialParameters[5]},t.prototype.setMetallic=function(e){this._materialParameters[5]=e},t.prototype._reCreateTexture=function(e,t,r){var i=this.reservedParameters[t].value,n=i.getFilter(),a=i.getWrap(),o=this._resourceManager.gl.RGB;if(e instanceof HTMLImageElement){var s=new D.a("texture-"+e.src,this._resourceManager);return"png"===(l=e.src.split("."))[l.length-1]&&(o=this._resourceManager.gl.RGBA),i.destroy(),s.createFromImage(e,o,this._resourceManager.gl.UNSIGNED_BYTE,n,a),s}var l,u=new D.a("texture-"+e,this._resourceManager);o=this._resourceManager.gl.RGB;"png"===(l=e.split("."))[l.length-1]&&(o=this._resourceManager.gl.RGBA),u.createFromFile(e,o,n,a,function(){i.destroy(),r(u)})},t.prototype.getBaseColorTexture=function(){return this.reservedParameters.m_uBaseColorTexture?this.reservedParameters.m_uBaseColorTexture.value:null},t.prototype.setBaseColorTexture=function(e){var t=this;this.reservedParameters.m_uBaseColorTexture?e instanceof D.a?this.reservedParameters.m_uBaseColorTexture.value=e:this._reCreateTexture(e,"m_uBaseColorTexture",function(e){t.reservedParameters.m_uBaseColorTexture.value=e}):console.warn("can not set texture for "+this.name)},t.prototype.setNormalTexture=function(e){var t=this;this.reservedParameters.m_uNormalTexture||console.warn("can not set normal texture for "+this.name),e instanceof D.a?this.reservedParameters.m_uNormalTexture.value=e:(e=this._reCreateTexture(e,"m_uNormalTexture",function(e){t.reservedParameters.m_uNormalTexture.value=e}),this.reservedParameters.m_uNormalTexture.value=e)},t.prototype.setEmissiveTexture=function(e){var t=this;this.reservedParameters.m_uEmissiveTexture||console.warn("can not set emissive texture for "+this.name),e instanceof D.a?this.reservedParameters.m_uEmissiveTexture.value=e:(e=this._reCreateTexture(e,"m_uEmissiveTexture",function(e){t.reservedParameters.m_uEmissiveTexture.value=e}),this.reservedParameters.m_uEmissiveTexture.value=e)},t.prototype.setOcclusionTexture=function(e){var t=this;this.reservedParameters.m_uOcclusionTexture||console.warn("can not set occlusion texture for "+this.name),e instanceof D.a?this.reservedParameters.m_uOcclusionTexture.value=e:(e=this._reCreateTexture(e,"m_uOcclusionTexture",function(e){t.reservedParameters.m_uOcclusionTexture.value=e}),this.reservedParameters.m_uOcclusionTexture.value=e)},t.prototype.setMetallicRoughnessTexture=function(e){var t=this;this.reservedParameters.m_uMetallicRoughnessTexture||console.warn("can not set metallic roughness texture for "+this.name),e instanceof D.a?this.reservedParameters.m_uMetallicRoughnessTexture.value=e:(e=this._reCreateTexture(e,"m_uMetallicRoughnessTexture",function(e){t.reservedParameters.m_uMetallicRoughnessTexture.value=e}),this.reservedParameters.m_uMetallicRoughnessTexture.value=e)},t.prototype.setBrdfLut=function(e){this.reservedParameters.m_uBrdfLut.value=e},t.prototype.setEnvironmentMap=function(e){this.reservedParameters.m_uEnvironmentMap.value=e},t.prototype.setSpecularEnvMap=function(e){this.reservedParameters.m_uSpecularEnvMap.value=e;var t=Math.floor(Math.log2(Math.max(e.width,e.height)))+1;this.reservedParameters.m_uTotalLod.value=t},t.prototype.setReflectIntensity=function(e){e<0?console.error("intensity should be greater than 0"):this.reservedParameters.m_uSpecularEnvMap&&this.reservedParameters.m_uSpecularEnvMap.value&&(this._materialParameters[9]=e)},t.prototype.getDiffuseTexture=function(){return this.hasTexture&&this.reservedParameters.m_uDiffuseTexture?this.reservedParameters.m_uDiffuseTexture.value:null},t.prototype.clone=function(e){var r=new t(e,this._resourceManager);if(this.reservedParameters){for(var i in this.reservedParameters)i.indexOf("m_uMaterial")>=0?(r.reservedParameters[i]=new R.a,r.reservedParameters[i].upload=this.reservedParameters[i].upload,r._materialParameters=new Float32Array(this.reservedParameters[i].value),r.reservedParameters[i].value=r._materialParameters):r.reservedParameters[i]=this.reservedParameters[i];r.transparent=this.transparent}return r},t.prototype.getDiffuse=function(){return this._materialParameters},t}(O.a),ot=function(){return function(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.x=e,this.y=t,this.z=r}}(),st=function(){function e(e,t,r,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),this.west=e,this.south=t,this.east=r,this.north=i}return e.southwest=function(e,t){return t?(t.x=e.west,t.y=e.south,t.z=0,t):new ot(e.west,e.south)},e.northwest=function(e,t){return t?(t.x=e.west,t.y=e.north,t.z=0,t):new ot(e.west,e.north)},e.northeast=function(e,t){return t?(t.x=e.east,t.y=e.north,t.z=0,t):new ot(e.east,e.north)},e.southeast=function(e,t){return t?(t.x=e.east,t.y=e.south,t.z=0,t):new ot(e.east,e.south)},e.contains=function(e,t){var r=t.x,i=t.y,n=e.west,a=e.east;return a<n&&(a+=2*Math.PI,r<0&&(r+=2*Math.PI)),(r>n||Math.abs(r-n)<1e-14)&&(r<a||Math.abs(r-a)<1e-14)&&i>=e.south&&i<=e.north},e.computeWidth=function(e){return e.east-e.west},e.computeHeight=function(e){return e.north-e.south},e.center=function(e,t){var r=.5*(e.east+e.west),i=.5*(e.south+e.north);return t?(t.x=r,t.x=i,t.z=0,t):new ot(r,i)},e}(),lt=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.toCartesian3=function(){return new ot(this.x,this.y,0)},e}(),ut=function(){function e(){}return Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ellipsoid",{get:function(){return this._ellipsoid},enumerable:!1,configurable:!0}),e}(),ct=function(){function e(e,t,r){this.initialize(this,e,t,r)}return Object.defineProperty(e.prototype,"maximumRadius",{get:function(){return this._maximumRadius},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t,r,i){e._radii=new ot(t,r,i),e._radiiSquared=new ot(t*t,r*r,i*i),e._radiiToTheFourth=new ot(t*t*t*t,r*r*r*r,i*i*i*i),e._oneOverRadii=new ot(0===t?0:1/t,0===r?0:1/r,0===i?0:1/i),e._oneOverRadiiSquared=new ot(0===t?0:1/(t*t),0===r?0:1/(r*r),0===i?0:1/(i*i)),e._minimumRadius=Math.min(t,r,i),e._maximumRadius=Math.max(t,r,i),e._centerToleranceSquared=.1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)},e}(),ht=function(){function e(){this._ellipsoid=new ct(6378137,6378137,6356752.314245179)}return Object.defineProperty(e.prototype,"ellipsoid",{get:function(){return this._ellipsoid},enumerable:!1,configurable:!0}),e}(),dt=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),pt=function(e){function t(){var t=e.call(this)||this;return t._semimajorAxis=t.ellipsoid.maximumRadius,t._oneOverSemimajorAxis=1/t._semimajorAxis,t}return dt(t,e),t.mercatorAngleToGeodeticLatitude=function(e){return Math.PI/2-2*Math.atan(Math.exp(-e))},t.geodeticLatitudeToMercatorAngle=function(e){e>t.MaximumLatitude?e=t.MaximumLatitude:e<-t.MaximumLatitude&&(e=-t.MaximumLatitude);var r=Math.sin(e);return.5*Math.log((1+r)/(1-r))},t.prototype.project=function(e,r){var i=this._semimajorAxis,n=e.x*i,a=t.geodeticLatitudeToMercatorAngle(e.y)*i,o=e.z;return r?(r.x=n,r.y=a,r.z=o,r):new ot(n,a,o)},t.prototype.unProject=function(e,r){var i=this._oneOverSemimajorAxis,n=e.x*i,a=t.mercatorAngleToGeodeticLatitude(e.y*i),o=e.z;return r?(r.x=n,r.y=a,r.z=o,r):new ot(n,a,o)},t.MaximumLatitude=t.mercatorAngleToGeodeticLatitude(Math.PI),t}(ht),ft=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),mt=function(e){function t(){var t=e.call(this)||this;t._numberOfLevelZeroTilesX=1,t._numberOfLevelZeroTilesY=1,t._projection=new pt,t._ellipsoid=t._projection.ellipsoid;var r=t.ellipsoid.maximumRadius*Math.PI;t._rectangleSouthwestInMeters=new lt(-r,-r),t._rectangleNortheastInMeters=new lt(r,r);var i=t._projection.unProject(t._rectangleSouthwestInMeters.toCartesian3()),n=t._projection.unProject(t._rectangleNortheastInMeters.toCartesian3());return t._rectangle=new st(i.x,i.y,n.x,n.y),t}return ft(t,e),t.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},t.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},t.prototype.rectangleToNativeRectangle=function(e,t){var r=this._projection,i=r.project(st.southwest(e)),n=r.project(st.northeast(e));return t?(t.west=i.x,t.south=i.y,t.east=n.x,t.north=n.y,t):new st(i.x,i.y,n.x,n.y)},t.prototype.tileXYToNativeRectangle=function(e,t,r,i){var n=this.getNumberOfXTilesAtLevel(r),a=this.getNumberOfYTilesAtLevel(r),o=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/n,s=this._rectangleSouthwestInMeters.x+e*o,l=this._rectangleSouthwestInMeters.x+(e+1)*o,u=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/a,c=this._rectangleNortheastInMeters.y-t*u,h=this._rectangleNortheastInMeters.y-(t+1)*u;return i?(i.west=s,i.south=h,i.east=l,i.north=c,i):new st(s,h,l,c)},t.prototype.tileXYToRectangle=function(e,t,r,i){var n=this.tileXYToNativeRectangle(e,t,r,i),a=this._projection,o=a.unProject(new ot(n.west,n.south)),s=a.unProject(new ot(n.east,n.north));return n.west=o.x,n.south=o.y,n.east=s.x,n.north=s.y,n},t.prototype.positionToTileXY=function(e,t,r){var i=this._rectangle;if(st.contains(i,e)){var n=this.getNumberOfXTilesAtLevel(t),a=this.getNumberOfYTilesAtLevel(t),o=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/n,s=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/a,l=this._projection.project(e),u=l.x-this._rectangleSouthwestInMeters.x,c=this._rectangleNortheastInMeters.y-l.y,h=u/o|0;h>=n&&(h=n-1);var d=c/s|0;return d>=a&&(d=a-1),r?(r.x=h,r.y=d,r):new lt(h,d)}},t}(ut);function _t(){return!0}function vt(e,t){function r(){throw new Error(t)}for(var i in void 0===t&&(t="This object was destroyed, i.e., destroy() was called."),e)"function"==typeof e[i]?e[i]=r:e.hasOwnProperty(i)&&(e[i]=null);e.isDestroyed=_t}var yt=function(){function e(e,t,r,i,n){this.imageryProvider=e,this.x=t,this.y=r,this.level=i,this.viewer=n,this.ready=!1,this.drawn=!1,this.idString=this.x+"_"+this.y+"_"+this.level,this.image=new Image,this._resourceManager=n.getResourceManager()}return e.prototype.createTileXYTexture=function(){var e=document.createElement("canvas");e.setAttribute("width","256px"),e.setAttribute("height","256px");var t=e.getContext("2d");t.fillStyle="white",t.fillRect(0,0,256,256),t.lineWidth=6,t.strokeStyle="blue",t.beginPath(),t.rect(0,0,256,256),t.stroke(),t.fillStyle="red",t.font="24px serif",t.fillText("X: "+this.x,80,90),t.fillText("Y: "+this.y,80,120),t.fillText("LEVEL: "+this.level,70,150);var r=this._resourceManager.getTexture("imagery_"+this.idString),i=this._resourceManager.gl;return r.createFromCanvas(e,i.RGB,i.UNSIGNED_BYTE,i.LINEAR,i.CLAMP_TO_EDGE),r},e.prototype.createPawn=function(e,t,r){var i=this;return new Promise(function(n,a){i.pawn=new H("mapTile_"+i.imageryProvider.resource.url+"_"+i.idString,i.viewer.getResourceManager(),i.viewer.getMaterialManager()),i.imageryProvider.requestImage(i.x,i.y,i.level).then(function(a){i.pawn.createTexturedQuad([a],!0),i.pawn.setScaling(t/2,r/2,1),i.pawn.setTranslation(e.x,e.y,e.z),i.ready=!0,n(i)}).catch(function(e){a(e)})})},e.prototype.render=function(){this.viewer.getScene().addPawn(this.pawn,!1),this.drawn=!0},e.prototype.destroy=function(){return this.viewer.getScene().removePawn(this.pawn),vt(this)},e}(),gt=function(){function e(e,t,r,i,n,a,o){void 0===i&&(i=1e3),void 0===n&&(n=1e3),void 0===o&&(o=40),this.enabled=!0,this._mapTiles=[],this.level=t,this.center=r,this.width=i,this.height=n,this.viewer=a,this.imageryProvider=e,this.tilingScheme=new mt,this.centerInWebMercator=this.tilingScheme.projection.project(r);var s=this.centerInWebMercator.x-i/2,l=this.centerInWebMercator.y-n/2,u=this.centerInWebMercator.x+i/2,c=this.centerInWebMercator.y+n/2;this.extent=new st(s,l,u,c);var h=this.tilingScheme.projection.unProject(new ot(s,c));this.leftUpXY=this.tilingScheme.positionToTileXY(h,t);var d=this.tilingScheme.projection.unProject(new ot(u,l));this.rightDownXY=this.tilingScheme.positionToTileXY(d,t),this._maximumTilesNumber=o}return Object.defineProperty(e.prototype,"mapTiles",{get:function(){return this._mapTiles},enumerable:!1,configurable:!0}),e.prototype.preValidate=function(){return!((this.rightDownXY.x-this.leftUpXY.x+1)*(this.rightDownXY.y-this.leftUpXY.y+1)>this._maximumTilesNumber)||(console.warn("地图瓦片数量大于最大数量"+this._maximumTilesNumber+"，请减小level或者缩小范围"),this.enabled=!1,!1)},e.prototype.generateMapTiles=function(){var e=this,t=[];if(this.preValidate(),this.enabled){for(var r=new st,i=this.leftUpXY.x;i<=this.rightDownXY.x;i++)for(var n=this.leftUpXY.y;n<=this.rightDownXY.y;n++){var a=new yt(this.imageryProvider,i,n,this.level,this.viewer);this.tilingScheme.tileXYToNativeRectangle(i,n,this.level,r);var o=st.computeWidth(r),s=st.computeHeight(r),l=st.center(r);l.x-=this.centerInWebMercator.x,l.y-=this.centerInWebMercator.y;var u=a.createPawn(l,o,s);u.then(function(e){e.render()}),this._mapTiles.push(a),t.push(u)}return Promise.all(t).then(function(){return Promise.resolve(e)})}return Promise.reject("地图瓦片数量过多，请减小level或者缩小范围")},e.prototype.destroy=function(){return this.mapTiles.forEach(function(e){e.destroy()}),vt(this)},e}(),bt=function(){return(bt=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},wt=function(){function e(e){this._retryCount=0,this._retryAttempts=0,this._url=e.url,this._queryParameters=e.queryParameters?e.queryParameters:{},this._templateValues=e.templateValues?e.templateValues:{}}return Object.defineProperty(e.prototype,"url",{get:function(){return this.getUrlComponent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryParameters",{get:function(){return this._queryParameters},enumerable:!1,configurable:!0}),e.prototype.fetchImage=function(e){var t=this;return void 0===e&&(e=!0),new Promise(function(r,i){!function(e,t,r,i){void 0===t&&(t=!0);var n=new Image;n.onload=function(){r&&r(n)},n.onerror=function(e){i&&i(e)},t&&(n.crossOrigin="");n.src=e}(t.url,e,r,i)})},e.prototype.getDerived=function(t){var r=new e({url:this.url,queryParameters:bt(bt({},this._queryParameters),t.queryParameters),templateValues:bt(bt({},this._templateValues),t.templateValues)});return r._retryCount=this._retryCount,r},e.prototype.getUrlComponent=function(){var e=this._url.replace(/%7B/g,"{").replace(/%7D/g,"}"),t=this._templateValues;return e=e.replace(/{(.*?)}/g,function(e,r){var i=t[r];return i?encodeURIComponent(i):e})},e.fetchImage=function(t,r){return void 0===r&&(r=!0),new e({url:t}).fetchImage(r)},e}();var xt=function(){return(xt=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Mt=/{[^}]+}/g,Tt={x:function(e,t,r,i){return St(e,"{x}",t)},y:function(e,t,r,i){return St(e,"{y}",r)},z:function(e,t,r,i){return St(e,"{z}",i)},s:function(e,t,r,i){var n=(t+r+i)%e.subdomains.length;return e.subdomains[n]},reverseX:function(e,t,r,i){var n=e.tilingScheme.getNumberOfXTilesAtLevel(i)-t-1;return St(e,"{reverseX}",n)},reverseY:function(e,t,r,i){var n=e.tilingScheme.getNumberOfYTilesAtLevel(i)-r-1;return St(e,"{reverseY}",n)},reverseZ:function(e,t,r,i){var n=e.maximumLevel;return St(e,"{reverseZ}",n&&i<n?n-i-1:i)}},Et=function(){function e(e){this._resource=new wt({url:e.url}),this._tilingScheme=e.tilingScheme?e.tilingScheme:new mt,this._tags=e.customTags?xt(xt({},Tt),e.customTags):Tt,this._maximumLevel=e.maximumLevel,Array.isArray(e.subdomains)?this._subdomains=e.subdomains.slice():void 0!==e.subdomains&&e.subdomains.length>0?this._subdomains=e.subdomains.split(""):this._subdomains=["a","b","c"]}return Object.defineProperty(e.prototype,"tilingScheme",{get:function(){return this._tilingScheme},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maximumLevel",{get:function(){return this._maximumLevel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subdomains",{get:function(){return this._subdomains},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resource",{get:function(){return this._resource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tags",{get:function(){return this._tags},enumerable:!1,configurable:!0}),e.prototype.requestImage=function(e,t,r){return function(e,t,r,i){var n=e.resource,a=n.getUrlComponent(),o=e.tags,s={},l=a.match(Mt);l&&l.forEach(function(n){var a=n.substring(1,n.length-1);o[a]&&(s[a]=o[a](e,t,r,i))});return n.getDerived({templateValues:s})}(this,e,t,r).fetchImage()},e}();function St(e,t,r){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){var i=e.urlSchemeZeroPadding[t];if("string"==typeof i){var n=i.length;n>1&&(r=r.length>=n?r:new Array(n-r.toString().length+1).join("0")+r)}}return r}var At,kt=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Pt=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},Nt=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Pt(arguments[t]));return e},Dt=new Float32Array([1e10,1e10,1e10,-1e10,-1e10,-1e10]),It=function(){function e(e,t){this._exposure=1,this._faces=2,this._lights=[],this.models={},this.pawns={},this.maps=[],this.text3Ds=[],this.pawnInfo={},this.background=new tt(e),this.compressed=!1,this.materialManager=t,this.bbox=P.a.aabb.create(),this.originBox=P.a.aabb.create(),this.modelsBox=P.a.aabb.create(),this.scale=1,this.radius=1.732,this.hasCurveOrLine=!1,this.hasProfileLines=!1,this.isBimCullingNeeded=!1,this.visible=!0,this._lights[0]=new Je,this.clipping=new $e(this)}return e.prototype.dump=function(){var e,t,r,i;console.groupCollapsed("Scene"),console.groupCollapsed("models: "+Object.keys(this.models).length);try{for(var n=kt(Object.entries(this.models)),a=n.next();!a.done;a=n.next()){var o=Pt(a.value,2),s=o[0],l=o[1];console.log(s+": ",l)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}console.groupEnd(),console.groupCollapsed("pawns: "+Object.keys(this.pawns).length);try{for(var u=kt(Object.entries(this.pawns)),c=u.next();!c.done;c=u.next()){var h=Pt(c.value,2),d=h[0],p=h[1];console.log(d+": ",p)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}console.groupEnd(),console.log("bbbox: "+this.bbox),console.log("scale: "+this.scale),console.log("radius: "+this.radius),console.log("clipping: ",this.clipping),console.log("compressed: "+this.compressed),console.log("_needRenderDoubleSided: "+this._needRenderDoubleSided),console.log("_exposure: "+this._exposure),console.groupEnd()},e.prototype.destroy=function(){for(var e in this.background&&this.background.destroy(),this.background=null,delete this.background,this.models)this.models[e].destroy();for(var t in this.models=null,delete this.models,this.pawns)this.pawns[t].destroy();this.pawns=null,delete this.pawns,this.bbox=null,this.models=null,this.originBox=null,this._lights=null,this.clipping=null},e.prototype.updateBBox=function(e,t){var r;if(t=!0===t,e)P.a.aabb.union(this.bbox,this.bbox,e),r=this.bbox,t&&P.a.aabb.union(this.modelsBox,this.modelsBox,e);else{for(var i in r=P.a.aabb.create(),this.models){var n=this.models[i];n.updateBBox(),P.a.aabb.union(r,r,n.bbox),P.a.aabb.union(this.modelsBox,this.modelsBox,n.bbox)}for(var a in this.pawns){var o=this.pawns[a];o.updateBBox(),P.a.aabb.union(r,r,o.bbox)}}this.setBBox(r)},e.prototype.setLightingIntensity=function(e){this._lights[0].setIntensity(e)},e.prototype.setSpecularShinness=function(e){this._lights[0].setSpecularShinness(e)},e.prototype.setLightingLatitude=function(e){this._lights[0].setLatitude(e)},e.prototype.setLightingLongitude=function(e){this._lights[0].setLongitude(e)},e.prototype.setMainLight=function(e){this._lights[0]=e},e.prototype.getMainLight=function(){return this._lights[0]},e.prototype.setlightZRotation=function(e){this._lights[0].setZRotation(e)},e.prototype.setBBox=function(e){this.bbox=P.a.aabb.createFromArray(e),P.a.aabb.expand(this.bbox);var t=P.a.aabb.size(this.bbox);this.scale=.5*Math.max(t.width,Math.max(t.height,t.depth)),this.radius=.5*P.a.aabb.len(this.bbox),this.clipping.initialize(this.bbox)},e.prototype.setElementsVisibility=function(e,t,r){void 0!==r&&null!==r||(r=t);for(var i=[],n=0,a=e.length;n<a;n++){var o=e[n],s=o.split("+")[0],l=this.models[s].tree.elements[o];if(l){var u=l.getNodes();i.push.apply(i,Nt(u))}}for(var c=new Set,h=0;h<i.length;h++){var d=i[h];d.setVisibility(d.drawable.mesh.isLine()?r:t),c.add(d.drawable)}c.forEach(function(e){e.updateVisibility(!0,!0)})},e.prototype.isElementVisible=function(e){var t=e.split("+")[0],r=this.models[t].tree.elements[e];return!!r&&r.getNodes()[0].isVisible()},e.prototype.getElementBBox=function(e){var t=e.split("+")[0],r=this.models[t].tree.elements[e];return r?r.bbox:Dt},e.prototype.getElementMaterials=function(e){var t=e.split("+")[0],r=this.models[t].tree.elements[e];if(r){var i=new Set;return r.getNodes().forEach(function(e){i.has(e.drawable.material)||i.add(e.drawable.material)}),Array.from(i)}},e.prototype.getElementMaterialNames=function(e){var t=e.split("+")[0],r=this.models[t].tree.elements[e];if(r){var i=new Set;return r.getNodes().forEach(function(e){e.drawable.mesh.isLine()||i.has(e.drawable.material.name)||i.add(e.drawable.material.name)}),Array.from(i)}},e.prototype.getPawnMaterialNames=function(e){var t=new Set;return e.drawables.forEach(function(e){e.mesh.isLine()||t.has(e.material.name)||t.add(e.material.name)}),Array.from(t)},e.prototype.getPawn=function(e){return this.pawns.hasOwnProperty(e)?this.pawns[e]:null},e.prototype.getMaterialType=function(e){var t=this.materialManager.getMaterial(e);if(t)return t instanceof V?"MaterialAdhoc":t instanceof at?"MaterialPbr":void 0;console.warn("no material named "+e+" found!")},e.prototype.getModelMaterialNames=function(){var e={};for(var t in this.models)e[t]=[],this.models[t].materialDrawablesMap.forEach(function(r,i){for(var n=!1,a=0;a<r.length;a++)if(r[a].mesh.isLine()){n=!0;break}n||e[t].push(i)});return e},e.prototype.getAllDrawables=function(){var e=[];for(var t in this.models)e.push.apply(e,Nt(this.models[t].drawables));return e},e.prototype.getAllDrawablesWithoutLines=function(){var e=[];for(var t in this.models)e.push.apply(e,Nt(this.models[t].drawables.filter(function(e){return!e.mesh.isLine()})));return e},e.prototype.getDrawablesByMaterialName=function(e){var t=[];for(var r in this.models){var i=this.models[r].materialDrawablesMap;i.has(e)&&t.push.apply(t,Nt(i.get(e)))}return t},e.prototype.getElementNamesByMaterialName=function(e){var t=[];for(var r in this.models)if(this.models[r].materialDrawablesMap.has(e))return this.models[r].materialDrawablesMap.get(e).forEach(function(e){e.mesh.isLine()||e.nodes.forEach(function(e){var i=e.getElement(),n=r+"+"+i.getDocument().id+"/"+i.id;t.push(n)})}),t;return console.warn("no material named "+e+"was found!"),null},e.prototype.getMaterialParameter=function(e,t){var r=this.materialManager.getMaterial(e);switch(t){case"color":if(r instanceof V)return r.getDiffuse();if(r instanceof at)return r.getBaseColor();break;case"colorTexture":var i=null;return r instanceof V?i=r.getDiffuseTexture():r instanceof at&&(i=r.getBaseColorTexture()),i?i.url:null;case"opacity":if(r instanceof V||r instanceof at)return r.getTransparent();break;case"roughness":if(r instanceof at)return r.getRoughness();break;case"metallic":if(r instanceof at)return r.getMetallic()}console.warn("parameter name "+t+" does not exist in material: "+e)},e.prototype.setMaterialParameter=function(e,t,r){var i=this.materialManager.getMaterial(e);switch(t){case"color":i instanceof V?i.setDiffuse(r):i instanceof at?i.setBaseColor(r):console.warn("material "+e+" should be MaterialAhoc or MaterialPbr!");break;case"opacity":i instanceof V||i instanceof at?i.setTransparent(r):console.warn("material "+e+" should be MaterialAhoc or MaterialPbr!");break;case"colorTexture":for(var n=this.getDrawablesByMaterialName(i.name),a=0;a<n.length;a++)if(!n[a].mesh.attributes.hasUV)return void console.warn("A drawable using this material doesn't has uv coord.");for(a=0;a<n.length;a++)n[a].recompileShader("HAS_BASECOLORMAP",!0);null===r&&(r=i.originTextureUrl),i instanceof V?i.setDiffuseTexture(r):i instanceof at?i.setBaseColorTexture(r):console.warn("material "+e+" should be MaterialAhoc or MaterialPbr!");break;case"roughness":i instanceof at?i.setRoughness(r):console.warn("material "+e+" should be MaterialPbr!");break;case"metallic":i instanceof at?i.setMetallic(r):console.warn("material "+e+" should be MaterialPbr!");break;case"metallicRoughnessTexture":for(n=this.getDrawablesByMaterialName(i.name),a=0;a<n.length;a++)if(!n[a].mesh.attributes.hasUV)return void console.warn("A drawable using this material doesn't has uv coord.");for(a=0;a<n.length;a++)n[a].recompileShader("HAS_METALROUGHNESSMAP",!0);i instanceof at?i.setMetallicRoughnessTexture(r):console.warn("material "+e+" should be MaterialPbr");break;case"emissiveTexture":for(n=this.getDrawablesByMaterialName(i.name),a=0;a<n.length;a++)if(!n[a].mesh.attributes.hasUV)return void console.warn("A drawable using this material doesn't has uv coord.");for(a=0;a<n.length;a++)n[a].recompileShader("HAS_EMISSIVEMAP",!0);i instanceof at?i.setEmissiveTexture(r):console.warn("material "+e+" should be MaterialPbr");break;case"normalTexture":for(n=this.getDrawablesByMaterialName(i.name),a=0;a<n.length;a++)if(!n[a].mesh.attributes.hasUV)return void console.warn("A drawable using this material doesn't has uv coord.");for(a=0;a<n.length;a++)n[a].recompileShader("HAS_NORMALMAP",!0);i instanceof at?i.setNormalTexture(r):console.warn("material "+e+" should be MaterialPbr");break;case"reflectionIntensity":i instanceof at?i.setReflectIntensity(r):console.warn("Material type is not MaterialPbr;")}},e.prototype.getElementsBBox=function(e){var t=this,r=P.a.aabb.createFromArray([1/0,1/0,1/0,-1/0,-1/0,-1/0]);return e.forEach(function(e){var i=e.split("+")[0],n=t.models[i];if(n){var a=n.tree.elements[e];a&&P.a.aabb.union(r,r,a.bbox)}}),r},e.prototype.getElements=function(e,t){void 0===e&&(e=rt.a.ANY),void 0===t&&(t=!1);var r=[];for(var i in this.models){var n=this.models[i];for(var a in n.tree.elements){var o=n.tree.elements[a];e===rt.a.ANY?r.push(o):o.etype!==e||t?o.etype!==e&&t&&r.push(o):r.push(o)}}return r},e.prototype.getElementsNames=function(e,t){void 0===e&&(e=rt.a.ANY),void 0===t&&(t=!1);var r=[];for(var i in this.models){var n=this.models[i];for(var a in n.tree.elements){var o=n.tree.elements[a];e===rt.a.ANY?r.push(a):o.etype!==e||t?o.etype!==e&&t&&r.push(a):r.push(a)}}return r},e.prototype.setNodesColor=function(e,t,r){var i=this,n=new Map;e.forEach(function(e){var t,a=!e.material.transparent&&r[3]&&r[3]<.99?r[3]:1;if(e.isSingleton())return e.originalMaterial=null!==(t=e.originalMaterial)&&void 0!==t?t:e.material.clone(),e.material.setDiffuse(r),void e.material.setTransparent(a);var o=i.materialManager.addCustomColor([r[0],r[1],r[2],a]);i.materialManager.upload(),n.set(e,o)}),t.forEach(function(e){var t=e.drawable;t.isLine()||t.isSingleton()||e.setColorIndex(n.get(t))}),e.forEach(function(e){return e.updateColor()})},e.prototype.clearNodesColor=function(e){e.forEach(function(e){var t;e.isSingleton()?e.material=null!==(t=e.originalMaterial)&&void 0!==t?t:e.material:(e.nodes.forEach(function(e){return e.revertColor()}),e.updateColor())})},e.prototype.setElementsColor=function(e,t){var r=this._getDrawablesOfElements(e),i=this._getNodesOfElements(e);t?this._changeMatrialColorOfDrawables(r,t,i):this._revertMaterialColorOfDrawables(r,i)},e.prototype._getDrawablesOfElements=function(e){var t,r,i,n=new Array;try{for(var a=kt(e),o=a.next();!o.done;o=a.next()){var s=o.value,l=s.split("+")[0],u=null===(i=this.models[l])||void 0===i?void 0:i.tree.elements[s];u&&u.getNodes().forEach(function(e){var t=e.drawable;n.includes(t)||n.push(t)})}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return n},e.prototype._getNodesOfElements=function(e){var t,r,i,n=new Array;try{for(var a=kt(e),o=a.next();!o.done;o=a.next()){var s=o.value,l=s.split("+")[0],u=null===(i=this.models[l])||void 0===i?void 0:i.tree.elements[s];u&&n.push.apply(n,Nt(u.getNodes()))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return n},e.prototype._revertMaterialColorOfDrawables=function(e,t){e.forEach(function(e){if(1!==e.nodes.length)e.nodes.forEach(function(e){t.includes(e)&&e.revertColor()}),e.updateColor();else{e.material.setDiffuse(e.originalMaterial.getDiffuse()),e.material.setTransparent(e.originalMaterial.getTransparent());var r=e.nodes[0].clonedDrawable;r&&(r.material.setDiffuse(r.originalMaterial.getDiffuse()),r.material.setTransparent(r.originalMaterial.getTransparent()))}})},e.prototype._changeMatrialColorOfDrawables=function(e,t,r){var i=this;e.forEach(function(e){var n,a,o,s,l=!e.material.transparent&&t[3]&&t[3]<.99?t[3]:1;if(1!==e.nodes.length){var u=i.materialManager.addCustomColor([t[0],t[1],t[2],l]);if(u>=127)console.warn("color count out of index");else{i.materialManager.upload();try{for(var c=kt(e.nodes),h=c.next();!h.done;h=c.next()){var d=h.value;r.includes(d)&&d.setColorIndex(u)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}e.updateColor()}}else{e.originalMaterial=null!==(o=e.originalMaterial)&&void 0!==o?o:e.material.clone(),e.material.setDiffuse(t),e.material.setTransparent(l);var p=e.nodes[0].clonedDrawable;p&&(p.originalMaterial=null!==(s=p.originalMaterial)&&void 0!==s?s:p.material.clone(),p.material.setDiffuse(t),p.material.setTransparent(l))}})},e.prototype.setModelVisibility=function(e,t,r){void 0!==r&&null!==r||(r=t);var i=this.models[e];i?this.setElementsVisibility(Object.keys(i.tree.elements),t,r):console.warn("no model named "+i+" is found.")},e.prototype.addPawn=function(e){this.pawns[e.name]=e,this.updateBBox(e.bbox,!1)},e.prototype.addMap=function(e,t){var r=new Et(e.imageryProviderOptions),i=new gt(r,e.level,new ot(e.centerLongitude*Math.PI/180,e.centerLatitude*Math.PI/180,0),e.width,e.height,t,e.maximumTilesNumber);return this.maps.push(i),i.generateMapTiles()},e.prototype.removeMap=function(e){var t=this.maps.indexOf(e);-1!==t?(e.destroy(),this.maps.splice(t,1)):console.warn("Map is not found!")},e.prototype.addModel=function(e){this.models[e.name]?console.error("can not load same model twice: "+e.name+"!"):(this.models[e.name]=e,this.updateBBox(e.bbox,!0))},e.prototype.removePawn=function(e){this.pawns.hasOwnProperty(e.name)&&(delete this.pawns[e.name],this.updateBBox())},e.prototype.addText3D=function(e){this.text3Ds.push(e),this.updateBBox()},e.prototype.removeText3D=function(e){var t=this.text3Ds.indexOf(e);-1!==t?(this.text3Ds.splice(t,1),this.updateBBox()):console.warn("text3D is not found!")},e.prototype.needRenderDoubleSided=function(){for(var e in this._faces=2,this.models)this._faces=Math.min(this.models[e].faces,this._faces);return this._needRenderDoubleSided=this._faces<1||this._faces<=1&&this.clipping.isEnabled(),this._needRenderDoubleSided},e.prototype.setRenderDoubleSided=function(e){this._needRenderDoubleSided=e},e.prototype.hasContours=function(){for(var e in this.models)if(this.models[e].hasContours)return!0;return!1},e.prototype.setReflectionMap=function(e){if(e)for(var t in this.models){this.models[t].drawables.forEach(function(t){t.mesh.isLine()||(t.recompileShader("SPECULAR_ENV_MAP",!0),t.material.setSpecularEnvMap(e))})}else for(var t in this.models){this.models[t].drawables.forEach(function(e){e.mesh.isLine()||e.recompileShader("SPECULAR_ENV_MAP",!1)})}},e.prototype.setTempPawn=function(e){this.pawnInfo[e.popUrl]||(this.pawnInfo[e.popUrl]=e)},e.prototype.setToneMappingEnabled=function(e){var t=this;for(var r in this.models){this.models[r].drawables.forEach(function(r){r.recompileShader("TONE_MAPPING",e),r.material.parameters.uExposure.value=t._exposure})}this.background&&this.background.skybox&&(this.background.skybox.recompileShader("TONE_MAPPING",e),this.background.skybox.material.parameters.uExposure.value=this._exposure)},e.prototype.setToneMappingExposure=function(e){var t=this;for(var r in this._exposure=e,this.models){this.models[r].drawables.forEach(function(e){e.material.parameters.uExposure&&(e.material.parameters.uExposure.value=t._exposure)})}this.background&&this.background.skybox&&this.background.skybox.material.parameters.uExposure&&(this.background.skybox.material.parameters.uExposure.value=this._exposure)},e.prototype.setCompressedenable=function(e){this.compressed=e},e.prototype.getOriginModelBox=function(){for(var e in this.models){var t=this.models[e];P.a.aabb.union(this.originBox,this.originBox,t.originBBox)}return this.originBox},e.prototype.getModelBox=function(){return this.modelsBox},e.prototype.getSceneBox=function(){return this.bbox},e.prototype.getModel=function(e){return this.models[e]},e.prototype.setActiveView=function(e){},e.prototype.getFaces=function(){return this._faces},e.prototype.initBimCullingNeeded=function(){if(!(this.nodes<=1e5&&this.meshKbytes<=1e5))for(var e in this.models)this.models[e]&&(this.isBimCullingNeeded=this.isBimCullingNeeded||this.models[e].isBimCullingNeeded)},e.prototype.setVisibility=function(e){this.visible=e},e.prototype.getVisibility=function(){return this.visible},e}(),Ot=function(){function e(e){}return e.prototype.destroy=function(){},e}(),Rt=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ct=function(e){function t(t,r){var i=e.call(this,t)||this;return i.core=new It(t.getResourceManager(),r),i.cores=[],i.cores.push(i.core),i._viewer=t,i}return Rt(t,e),t.prototype.destroy=function(){for(var t=0;t<this.cores.length;t++)this.cores[t].destroy();this.cores=null,delete this.cores,this.core=null,delete this.core,e.prototype.destroy.call(this)},t.prototype.setElementsColor=function(e,t){this.core.setElementsColor(e,t),this._viewer.invalidate()},t.prototype.setElementsVisibility=function(e,t,r){this.core.setElementsVisibility(e,t,r),this._viewer.invalidate()},t.prototype.isElementVisible=function(e){return this.core.isElementVisible(e)},t.prototype.getElementsNames=function(e,t){return void 0===e&&(e=rt.a.ANY),void 0===t&&(t=!1),this.core.getElementsNames(e,t)},t.prototype.getElementsBBox=function(e){return this.core.getElementsBBox(e)},t.prototype.getElementBBox=function(e){return this.core.getElementBBox(e)},t.prototype.getElementMaterials=function(e){return this.core.getElementMaterials(e)},t.prototype.getElementMaterialNames=function(e){return this.core.getElementMaterialNames(e)},t.prototype.getPawnMaterialNames=function(e){return this.core.getPawnMaterialNames(e)},t.prototype.getMaterialType=function(e){return this.core.getMaterialType(e)},t.prototype.getModelMaterialNames=function(){return this.core.getModelMaterialNames()},t.prototype.getElementNamesByMaterialName=function(e){return this.core.getElementNamesByMaterialName(e)},t.prototype.getMaterialParameter=function(e,t){return this.core.getMaterialParameter(e,t)},t.prototype.setMaterialParameter=function(e,t,r){return this.core.setMaterialParameter(e,t,r)},t.prototype.setModelVisibility=function(e,t,r){this.core.setModelVisibility(e,t,r),this._viewer.invalidate()},t.prototype.getElementGuid=function(e){var t=e.split("+")[0],r=this.core.models[t].tree.elements[e];return void 0===r?(console.warn("elementName: "+e+" not found!"),null):r.guid},t.prototype.getElementNameByGuid=function(e){var t;for(var r in this.core.models)if(t=this.core.models[r].tree.guidElementMap[e])return t;return console.warn("guid: "+e+" not found!"),null},t.prototype.getClippingData=function(){return this.core.clipping.isEnabled()?{planes:this.core.clipping.getClippingPlanes(!0),points:this.core.clipping.getClippingPoints(!0)}:null},t.prototype.translateModel=function(e,t,r,i){var n=this.core.models[e];n&&(n.translate(t,r,i),this._viewer.invalidate())},t.prototype.rotateModel=function(e,t,r,i){var n=this.core.models[e];n&&(n.rotate(t,r,i),this._viewer.invalidate())},t.prototype.addPawn=function(e,t){var r=this;void 0===t&&(t=!0),this.core.addPawn(e),this._viewer.getCamera().core._updateProjection(),e.drawables.forEach(function(e){r._viewer._renderScene.addDrawable(e)}),e.skeletons.forEach(function(e){r._viewer._renderScene.addSkeleton(e)}),t&&this._viewer.getCamera().core.reset(!0),this._viewer.state=i.RENDERING,this._viewer.invalidate()},t.prototype.removePawn=function(e){var t=this;this.core.removePawn(e),e.drawables.forEach(function(e){t._viewer._renderScene.removeDrawable(e)}),e.skeletons.forEach(function(e){t._viewer._renderScene.removeSkeleton(e)}),this._viewer.invalidate()},t.prototype.addText3D=function(e,t){var r=this;void 0===t&&(t=!0),this.core.addText3D(e),e.drawables.forEach(function(e){r._viewer._renderScene.addDrawable(e)}),t&&this._viewer.getCamera().core.reset(!0),this._viewer.state=i.RENDERING,this._viewer.invalidate()},t.prototype.removeText3D=function(e){var t=this;this.core.removeText3D(e),e.drawables.forEach(function(e){t._viewer._renderScene.removeDrawable(e)}),this._viewer.invalidate()},t.prototype.addModel=function(e,t,r){var i=this;void 0===t&&(t=!0),this.core.addModel(e),e.drawables.forEach(function(e){i._viewer._renderScene.addDrawable(e)}),t&&(r?this._viewer.getCamera().core.reset(!0,r):this._viewer.getCamera().core.reset(!0)),this._viewer.invalidate()},t.prototype.removeModel=function(e){console.error("TBD")},t.prototype.addMap=function(e){return this.core.addMap(e,this._viewer)},t.prototype.removeMap=function(e){this.core.removeMap(e)},t.prototype.hasContours=function(){return this.core.hasContours()},t.prototype.addVisualize=function(e){e.addEffects(),this._viewer.getRenderScene().addVisualize(e),this._viewer.invalidate()},t.prototype.removeVisualize=function(e){e.removeEffects(),this._viewer.getRenderScene().removeVisualize(e),this._viewer.invalidate()},t.prototype.getVisualize=function(e,t){return void 0===t&&(t=0),this._viewer.getRenderScene().getVisualize(e,t)},t.prototype.getVisualizes=function(e){return this._viewer.getRenderScene().getVisualizes(e)},t.prototype.setBackgroundImage=function(e,t){void 0===t&&(t=!1),this.core.background.setImages(e),t&&this.core.setReflectionMap(this.core.background.skybox.getTexture())},t.prototype.setReflectionMap=function(e){var t=this,r=this._viewer.getResourceManager().getTexture("mx-reflection-map");if(!r.ready&&e||(r.destroy(),r=this._viewer.getResourceManager().getTexture("mx-reflection-map")),e){var i=this._viewer.getResourceManager().gl;if("string"==typeof e){var n=e.split(".");if("dds"!==n[n.length-1].toLowerCase())return void console.error("File format of"+e+"is not supported!");r.createFromDDS(e,function(){t.core.setReflectionMap(r),t._viewer.invalidate()})}else e[0]instanceof HTMLImageElement?(r.createFromImages(e,i.RGB,i.UNSIGNED_BYTE,i.LINEAR,i.CLAMP_TO_EDGE),r.generateCubeMapMipMap(),this.core.setReflectionMap(r),this._viewer.invalidate()):r.createFromFiles(e,i.RGB,i.LINEAR,i.CLAMP_TO_EDGE,function(){r.generateCubeMapMipMap(),t.core.setReflectionMap(r),t._viewer.invalidate()})}else this.core.setReflectionMap(null)},t.prototype.setToneMappingEnabled=function(e){this.core.setToneMappingEnabled(e)},t.prototype.setToneMappingExposure=function(e){this.core.setToneMappingExposure(e)},t.prototype.setlightZRotation=function(e){this.core.setlightZRotation(e)},t.prototype.setBackgroundFov=function(e){this.core.background.skybox?(this.core.background.skybox.setFov(e),this._viewer.invalidate()):console.warn("please use setBackgroundImage() before setBackgroundFov()!")},t.prototype.getOriginModelBox=function(){return this.core.getOriginModelBox()},t.prototype.getModelBox=function(){return this.core.getModelBox()},t.prototype.getSceneBox=function(){return this.core.getSceneBox()},t.prototype.clearPopModel=function(){var e=this;for(var t in this.core.pawns){var r=this.core.pawns[t];this.removePawn(r),r.drawables.forEach(function(t){e._viewer._renderScene.removeDrawable(t)})}this._viewer.invalidate()},t.prototype.setModelTransform=function(e,t){var r=this.core.models[e];r?(r.setTransfromArry(t),this.core.updateBBox(),this._viewer.invalidate()):console.warn("modelId:"+e+" is not exist")},t.prototype.getModelTransform=function(e){var t=this.core.models[e];if(t)return t.getTransformArray();console.warn("modelId:"+e+" is not exist")},t.prototype.getModel=function(e){return this.core.getModel(e)},t.prototype.getPawn=function(e){return this.core.getPawn(e)},t}(Ot),Bt=r(15),Lt=r(34),Ft=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Vt=function(e){function t(){var t=e.call(this,"normal")||this;return t._updateThreshold=1e-4,t._acceleration=.15,t}return Ft(t,e),t.prototype.update=function(){var e,t=this._camera,r=t._targetDistance-t._distance,i=t._targetTheta-t._theta,n=t._targetPhi-t._phi,a=t._targetFov-t._fov,o=0;if(!t._firstPerson){var s=t._targetAt[0]-t._at[0],l=t._targetAt[1]-t._at[1],u=t._targetAt[2]-t._at[2];t._at[0]+=s*this._acceleration,t._at[1]+=l*this._acceleration,t._at[2]+=u*this._acceleration,o=Math.abs(s)+Math.abs(l)+Math.abs(u)}return(e=(Math.abs(i)+Math.abs(n)>1e-4?1:0)+(Math.abs(r)+o>this._updateThreshold?2:0)+(Math.abs(a)>1e-4?4:0))&&(t._distance+=r*this._acceleration,t._theta+=i*this._acceleration,t._phi+=n*this._acceleration,t._phi>=.499999*Math.PI&&(t._phi=.499999*Math.PI),t._phi<=-.499999*Math.PI&&(t._phi=-.499999*Math.PI),Bt.a.prototype._setFov.apply(t,[t._fov+a*this._acceleration]),Bt.a.prototype.update.apply(t),t._scene&&t._updateProjection(),t._cull.update()),e>0},t.prototype._onEnd=function(){return!1},t.prototype._onStart=function(){return!1},t}(Lt.a),Ut=function(){function e(e){this._camera=e,this._scene=e._scene}return e.prototype.isCulled=function(e){if(!this._scene.clipping.isEnabled())return!1;var t=this._scene.clipping.get();return!!P.a.outside.aabb_aabb(e.bbox,t)},e}(),zt=r(55),jt=function(){function e(e){this._camera=e,this.enabled=!1}return e.prototype.update=function(){},e.prototype.isCulled=function(e,t){return!!this.enabled&&(e.hidables>0&&(t[1]=e.nodes[e.hidables].indicesOffset/e.mesh.indexSize),0===e.hidables)},e}(),Gt=function(){function e(e){this._clippingCull=new Ut(e),this._frustumCull=new zt.a(e),this._bimCull=new jt(e),this._enabled=!1}return e.prototype.destroy=function(){this._clippingCull=null,delete this._clippingCull,this._frustumCull=null,delete this._frustumCull,this._bimCull=null,delete this._bimCull},e.prototype.setEnabled=function(e){this._enabled=e},e.prototype.isCulled=function(e,t){return!!this._enabled&&!!(this._clippingCull.isCulled(e)||this._frustumCull.isCulled(e)||this._bimCull.isCulled(e,t))},e.prototype.update=function(){this._enabled&&(this._frustumCull.update(),this._bimCull.update())},e.prototype.setBimCullingEnabled=function(e){this._bimCull.enabled=e},e.prototype.isBimCullingEnabled=function(){return this._bimCull.enabled},e}(),qt=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Qt=U.d.create(),Ht=U.d.create(),Wt=[0,0,0],Yt=function(e){function t(t,r){var i=e.call(this,r)||this;return i._scene=t,i._targetAt=[0,0,0],i._targetEye=[0,0,0],i._targetFov=46,i._targetTheta=-Math.PI/4,i._targetPhi=Math.PI/18,i._targetDistance=15,i._initDistance=15,i._maxZoomOffset=.6,i._minZoomOffset=.15,i._maxZoomDistance=1/0,i._minZoomDistance=i._scene?.001*i._scene.scale:-1/0,i._yVanishFactor=U.e.create(),i.animator=new Vt,i.animator.attach(i),i._cull=new Gt(i),i.updated=!0,i._navigationSwitch=[!0,!0,!0,!0,!0,!0],i._prevUpdated=i.updated,i._updateStopListeners=[],i._minPitchAngle=-.499999*Math.PI,i._maxPitchAngle=.499999*Math.PI,i._maxTargetDistanceRatio=1/0,i._minTargetDistanceRatio=-1/0,i._minZnearRatio=.001,i._defaultCameraInfo=null,i}return qt(t,e),t.prototype.destroy=function(){this._cull.destroy(),this._cull=null,delete this._cull,this.animator.destroy(),this.animator=null,delete this.animator,this._targetAt=null,delete this._targetAt,this._targetEye=null,delete this._targetEye,this._updateStopListeners=null,delete this._updateStopListeners,e.prototype.destroy.call(this)},t.prototype.setDefaultCam=function(e){this._defaultCameraInfo=e},t.prototype.setMinPitchAngle=function(e){e=Math.max(e,-.499999*Math.PI),this._minPitchAngle=e},t.prototype.setMaxPitchAngle=function(e){e=Math.min(e,.499999*Math.PI),this._maxPitchAngle=e},t.prototype.setMaxTargetDistanceRatio=function(e){this._maxTargetDistanceRatio=e},t.prototype.setMinTargetDistanceRatio=function(e){this._minTargetDistanceRatio=e},t.prototype.setMinZnearRatio=function(e){this._minZnearRatio=e},t.prototype.setViewport=function(t){e.prototype.setViewport.call(this,t);for(var r=0;r<this._updateStopListeners.length;r++)this._updateStopListeners[r](this)},t.prototype.update=function(){if(this._prevUpdated=this.updated,this.updated=this.animator.update(),this._prevUpdated&&!this.updated&&this._scene&&this._scene.getVisibility())for(var e=0;e<this._updateStopListeners.length;e++)this._updateStopListeners[e](this);return this.updated},t.prototype.addUpdateStopListener=function(e){this._updateStopListeners.push(e)},t.prototype.removeUpdateStopListener=function(e){var t=this._updateStopListeners.indexOf(e);t>=0&&this._updateStopListeners.splice(t,1)},t.prototype.rotate=function(e,t){if(this._navigationSwitch[1]){this._firstPerson&&(t=-t);var r=this._targetTheta-(this._navigationSwitch[4]?.006*e:0);if(this._targetPhi+=this._navigationSwitch[5]?.006*t:0,this._rotateRangeEnable){var i=r%(2*Math.PI);i=i<0?i+2*Math.PI:i,this._startTheta<this._endTheta?i<this._endTheta&&i>this._startTheta&&(this._targetTheta=r):(i>0&&i<this._endTheta||i>this._startTheta&&i<2*Math.PI)&&(this._targetTheta=r)}else this._targetTheta=r;this._updatePhi()}},t.prototype._updatePhi=function(){this._targetPhi>=this._maxPitchAngle&&(this._targetPhi=this._maxPitchAngle),this._targetPhi<=this._minPitchAngle&&(this._targetPhi=this._minPitchAngle)},t.prototype.setCullingEnabled=function(e){this._cull.setEnabled(e),e&&this._cull.update()},t.prototype.setBimCullingEnabled=function(e){this._cull.setBimCullingEnabled(this._scene.isBimCullingNeeded&&e),this.isBimCullingEnabled()&&this._cull.update()},t.prototype.isBimCullingEnabled=function(){return this._scene.isBimCullingNeeded&&this._cull.isBimCullingEnabled()},t.prototype.setTargetAt=function(e){this._targetAt=e},t.prototype.setTargetFov=function(e){this._targetFov=e,this._targetFov>=179.9&&(this._targetFov=179.9),this._targetFov<=.1&&(this._targetFov=.1)},t.prototype.getTargetFov=function(){return this._targetFov},t.prototype.zoom=function(t,r,i){if(this._navigationSwitch[2]){var n=Math.abs(t*this._targetDistance*.35);this._targetDistance-=(t>0?1:-1)*Math.min(Math.max(n,this._minZoomOffset),this._maxZoomOffset),this._scene&&this._targetDistance<.001*this._scene.scale&&(this._targetDistance=.001*this._scene.scale),e.prototype._setHeight.call(this,this._targetDistance),this._targetDistance<this._minZoomDistance&&(this._distance=this._minZoomDistance,this._targetDistance=this._minZoomDistance),this._targetDistance>this._maxZoomDistance&&(this._distance=this._maxZoomDistance,this._targetDistance=this._maxZoomDistance)}},t.prototype.pan=function(e,t){if(this._navigationSwitch[0]){var r=.001*this._targetDistance;this._targetAt[0]+=-e*this.viewMatrix[0]*r+t*this.viewMatrix[1]*r,this._targetAt[1]+=-e*this.viewMatrix[4]*r+t*this.viewMatrix[5]*r,this._targetAt[2]+=-e*this.viewMatrix[8]*r+t*this.viewMatrix[9]*r}},t.prototype.setRotationRange=function(e,t,r){this._rotateRangeEnable=e,this._startTheta=t||0,this._endTheta=r||2*Math.PI},t.prototype.move=function(e,t){var r=this,i=[e*t[0],e*t[1],e*t[2]];this._targetAt.forEach(function(e,t){return r._targetAt[t]+=i[t]}),this.eye.forEach(function(e,t){return r.eye[t]+=i[t]})},t.prototype.moveLeft=function(e){var t=this.getViewDirection(),r=U.d.fromValues(t[0],t[1],t[2]),i=U.d.fromValues(0,0,1),n=U.d.create();U.d.cross(n,i,r),this.move(e,n)},t.prototype.moveRight=function(e){this.moveLeft(-e)},t.prototype.moveForward=function(e,t){void 0===t&&(t=!1);var r=this.getViewDirection();if(t){var i=U.d.fromValues(r[0],r[1],0);U.d.normalize(r,i)}this.move(e,r)},t.prototype.moveBackward=function(e,t){void 0===t&&(t=!1),this.moveForward(-e,t)},t.prototype.moveUp=function(e){this.move(e,[0,0,1])},t.prototype.moveDown=function(e){this.moveUp(-e)},t.prototype.forward=function(e,t){void 0===t&&((t=this.getViewDirection())[2]=0);var r=t[0]*e*this._scene.radius,i=t[1]*e*this._scene.radius,n=t[2]*e*this._scene.radius;this._targetAt[0]+=r,this._targetAt[1]+=i,this._targetAt[2]+=n,this.eye[0]+=r,this.eye[1]+=i,this.eye[2]+=n},t.prototype._updateProjection=function(){Ht=P.a.aabb.center(this._scene.bbox),Wt[0]=this._at[0]+this.viewMatrix[2]*this._targetDistance,Wt[1]=this._at[1]+this.viewMatrix[6]*this._targetDistance,Wt[2]=this._at[2]+this._yVanishFactor[2]*this._targetDistance,U.d.subtract(Qt,this.eye,Ht);var t=this.viewMatrix[2]*Qt[0]+this.viewMatrix[6]*Qt[1]+this._yVanishFactor[2]*Qt[2];U.d.subtract(Qt,Wt,Ht);var r=this.viewMatrix[2]*Qt[0]+this.viewMatrix[6]*Qt[1]+this._yVanishFactor[2]*Qt[2],i=Math.min(t,r)-1.1*this._scene.radius,n=Math.max(t,r)+1.03*this._scene.radius;this._perspective&&i<this._minZnearRatio*this._scene.radius&&(i=this._minZnearRatio*this._scene.radius),this._twoPointsPerpective&&(i=Math.max(i/2,.001),n*=1.3),e.prototype._updateProjection.call(this,i,n)},t.prototype.reset=function(t,r){this.animator.stop&&this.animator.stop(),this.animator=new Vt,this.animator.attach(this),r?(this._targetAt=P.a.aabb.center(this._scene.bbox),this._targetDistance=this._getViewDistance(),this._maxZoomOffset=.025*this._targetDistance,this._minZoomOffset=.0025*this._targetDistance,U.d.copy(this._targetAt,r.at),this._at[0]=this._targetAt[0],this._at[1]=this._targetAt[1],this._at[2]=this._targetAt[2],this._distance=this._targetDistance=r.distance,this.setTargetFov(r.fov),this.rotateTo(r.phi,r.theta),this._fov=this._targetFov,this._phi=this._targetPhi,this._theta=this._targetTheta,this._distance+=3*1e-4,this._initDistance=this._targetDistance,this.update()):(this._scene.clipping.isEnabled()?U.d.copy(this._targetAt,this._scene.clipping.getCenter()):this._targetAt=P.a.aabb.center(this._scene.bbox),this._targetDistance=this._getViewDistance(),this._initDistance=this._targetDistance,this._maxZoomOffset=.025*this._targetDistance,this._minZoomOffset=.0025*this._targetDistance,this.rotateTo(Math.PI/18,-Math.PI/4),t&&(this._defaultCameraInfo&&e.prototype.resetDefaultCam.call(this)||(this.rotateTo(Math.PI/18,-Math.PI/4),e.prototype.reset.call(this,t,r),U.d.copy(this._at,this._targetAt))))},t.prototype.rotateTo=function(e,t){var r=t-this._theta;(r%=2*Math.PI)>Math.PI?r-=2*Math.PI:r<-Math.PI&&(r+=2*Math.PI),this._targetTheta=this._theta+r,this._targetPhi=e},t.prototype.lookTo=function(t,r){if(this._navigationSwitch[3])if(this._targetAt[0]=t[0],this._targetAt[1]=t[1],this._targetAt[2]=t[2],void 0!==r)if(this._perspective)this._targetDistance=r/Math.sin(this._fov*Math.PI/360);else{var i=1.5*r;e.prototype._setHeight.call(this,i)}else{var n=this._targetAt[0]-this.eye[0],a=this._targetAt[1]-this.eye[1],o=this._targetAt[2]-this.eye[2];this._distance=Math.sqrt(n*n+a*a+o*o),this._targetDistance=Math.min(.35*this._scene.radius,this._distance)}},t.prototype.zoomTo=function(e,t,r){this._distance=e,this._targetDistance=t||e,r&&U.d.copy(this._targetAt,r)},t.prototype.zoomBy=function(t){if(!this._perspective){var r=this._height*t;e.prototype._setHeight.call(this,r),this._targetDistance-=t<1?15e-5:-15e-5}},t.prototype.dump=function(){var e,t;return this._firstPerson?(e=-this._targetPhi,t=this._targetTheta-Math.PI):(e=this._targetPhi,t=this._targetTheta),this._perspective?{fov:this._fov,distance:this._targetDistance,phi:e,theta:t,at:[this._at[0],this._at[1],this._at[2]],twoPointsPerpective:this._twoPointsPerpective}:{height:this._height,distance:this._targetDistance,phi:e,theta:t,at:[this._at[0],this._at[1],this._at[2]],twoPointsPerpective:!1}},t.prototype.restore=function(t){var r=t.height?1.2*this._scene.radius:t.distance;Math.abs(r-this._targetDistance),Math.max(r,this._targetDistance);if(this._distance=this._targetDistance=r,t.phi>=.49999*Math.PI&&(t.phi=.49999*Math.PI),t.phi<=-.49999*Math.PI&&(t.phi=-.49999*Math.PI),this._twoPointsPerpective=!!t.twoPointsPerpective,this._firstPerson){Math.abs(-t.phi-this._targetPhi),this._phi=this._targetPhi=-t.phi;var i,n,a,o=t.theta+Math.PI-this._theta;(o%=2*Math.PI)>Math.PI?o-=2*Math.PI:o<-Math.PI&&(o+=2*Math.PI),Math.abs(this._theta+o-this._targetTheta),this._targetTheta=this._theta+o,this._theta=this._targetTheta;var s=Math.sin(this._targetPhi),l=Math.cos(this._targetPhi),u=Math.sin(this._targetTheta);i=l*Math.cos(this._targetTheta),n=l*u,a=s,this.eye[0]=t.at[0]-i*this._targetDistance,this.eye[1]=t.at[1]-n*this._targetDistance,this.eye[2]=t.at[2]-a*this._targetDistance}else{Math.abs(t.phi-this._targetPhi),this._phi=this._targetPhi=t.phi;o=t.theta-this._theta;(o%=2*Math.PI)>Math.PI?o-=2*Math.PI:o<-Math.PI&&(o+=2*Math.PI),Math.abs(this._theta+o-this._targetTheta),this._targetTheta=this._theta+o,this._theta=this._targetTheta}this._at[0]=this._targetAt[0]=t.at[0],this._at[1]=this._targetAt[1]=t.at[1],this._at[2]=this._targetAt[2]=t.at[2],t.height?(e.prototype._setHeight.call(this,t.height),e.prototype.setPerspective.call(this,!1)):e.prototype.setPerspective.call(this,!0),this._scene&&this._updateProjection(),e.prototype.update.call(this),this._cull.update()},t.prototype.setparam=function(t){var r=t.height?1.2*this._scene.radius:t.distance;Math.abs(r-this._targetDistance),Math.max(r,this._targetDistance);if(this._distance=this._targetDistance=r,t.phi>=.49999*Math.PI&&(t.phi=.49999*Math.PI),t.phi<=-.49999*Math.PI&&(t.phi=-.49999*Math.PI),this._firstPerson){Math.abs(-t.phi-this._targetPhi),this._phi=this._targetPhi=-t.phi;var i,n,a,o=t.theta+Math.PI-this._theta;(o%=2*Math.PI)>Math.PI?o-=2*Math.PI:o<-Math.PI&&(o+=2*Math.PI),Math.abs(this._theta+o-this._targetTheta),this._targetTheta=this._theta+o,this._theta=this._targetTheta;var s=Math.sin(this._targetPhi),l=Math.cos(this._targetPhi),u=Math.sin(this._targetTheta);i=l*Math.cos(this._targetTheta),n=l*u,a=s,this.eye[0]=t.at[0]-i*this._targetDistance,this.eye[1]=t.at[1]-n*this._targetDistance,this.eye[2]=t.at[2]-a*this._targetDistance}else{Math.abs(t.phi-this._targetPhi),this._phi=this._targetPhi=t.phi;o=t.theta-this._theta;(o%=2*Math.PI)>Math.PI?o-=2*Math.PI:o<-Math.PI&&(o+=2*Math.PI),Math.abs(this._theta+o-this._targetTheta),this._targetTheta=this._theta+o,this._theta=this._targetTheta}this._at[0]=this._targetAt[0]=t.at[0],this._at[1]=this._targetAt[1]=t.at[1],this._at[2]=this._targetAt[2]=t.at[2],t.height?(e.prototype._setHeight.call(this,t.height),e.prototype.setPerspective.call(this,!1)):(this._setFov(t.fov),e.prototype.setPerspective.call(this,!0)),this._scene&&this._updateProjection(),e.prototype.update.call(this),this._cull.update()},t.prototype.transformProperty=function(e){var t=e.at,r=e.position,i=U.d.distance(t,r),n={theta:0,phi:0,at:t,eye:r,distance:i},a=[r[0]-t[0],r[1]-t[1],0],o=r[2]-t[2],s=U.d.angleTo([1,0,0],a);return n.phi=Math.asin(o/i),n.theta=s,n.distance=i,n},t.prototype.cull=function(e,t){return this._cull.isCulled(e,t)},t.prototype.setFirstPerson=function(t){this._firstPerson!==t&&(this._targetTheta=Math.PI+this._targetTheta,this._targetPhi=-this._targetPhi),t||(this._targetAt[0]=this._at[0],this._targetAt[1]=this._at[1],this._targetAt[2]=this._at[2],this._at[0]-=1e-6,this._at[1]-=1e-6,this._at[2]-=1e-6),e.prototype.setFirstPerson.call(this,t)},t.prototype.isFirstPerson=function(){return this._firstPerson},t.prototype.isPerspective=function(){return this._perspective},t.prototype._getViewDistance=function(){var e=this,t=-Number.MAX_VALUE,r=1/Math.sin(.00872665*this._fov),i=r/Math.cos(.00872665*this._fov),n=Math.tan(.00872665*this._fov),a=this.getTargetViewDirection(),o=U.d.create(),s=U.d.create(),l=function(t,l){U.d.subtract(o,l.bsphere,e._targetAt);var u=U.d.dot(o,a);U.d.scaleAndAdd(s,e._targetAt,a,u);var c=U.d.distance(s,l.bsphere),h=l.bsphere[3],d=u+(c*i+h*r-c*n),p=1.05*Math.max(h,d);return Math.max(t,p)};for(var u in this._scene.models){var c=this._scene.models[u];if(c.visible)for(var h=0,d=c.drawables.length;h<d;h++){var p=c.drawables[h];p.visible&&(t=l(t,p))}}for(var f in this._scene.pawns){var m=this._scene.pawns[f];for(h=0,d=m.drawables.length;h<d;h++)t=l(t,m.drawables[h])}if(this._scene.clipping.isEnabled()){var _=this._scene.clipping.getRadius(),v=_*r;t=Math.min(t,1.05*Math.max(_,v))}if(t<0){var y=this._scene.radius;v=y*r;t=1.05*Math.max(y,v)}return t},t.prototype.getTargetViewDirection=function(){var e=Math.sin(this._targetPhi),t=Math.cos(this._targetPhi),r=Math.sin(this._targetTheta),i=Math.cos(this._targetTheta),n=U.d.create();return n[0]=-t*i,n[1]=-t*r,n[2]=-e,this._firstPerson&&(n[0]=-n[0],n[1]=-n[1],n[2]=-n[2]),n},t.prototype.getRotation=function(){var e=this._theta;return{phi:this._phi,theta:e%=2*Math.PI}},t.prototype.setZoomMinMax=function(e){this._maxZoomOffset=.025*this._initDistance*e},t.prototype.setDistance=function(e){this._targetDistance=e},t.prototype.setZoomRange=function(e,t){this._minZoomDistance=e||.001*this._scene.scale,this._maxZoomDistance=t||1/0},t.prototype.enabledTwoPointsPerspective=function(t){t?(e.prototype.setPerspective.call(this,t),this._maxPitchAngle=.4*Math.PI,this._minPitchAngle=-.4*Math.PI):(this._maxPitchAngle=.499999*Math.PI,this._minPitchAngle=-.499999*Math.PI),this._updatePhi(),this._twoPointsPerpective=t,e.prototype.update.call(this),this._updateProjection()},t.prototype.setNavigationEnabled=function(e,t){switch(e){case"zoom":this._navigationSwitch[2]=t;break;case"pan":this._navigationSwitch[0]=t;break;case"rotate":this._navigationSwitch[1]=t;break;case"look":this._navigationSwitch[3]=t;break;case"rotatex":this._navigationSwitch[4]=t;break;case"rotatey":this._navigationSwitch[5]=t;break;default:console.warn("navigation params just support zoom,pan,rotate")}},t}(Bt.a),Xt=r(36),Zt=r(21),Kt=r(32),Jt=r(9),$t=function(){function e(e,t,r,i){this.queue=t.getQueue(i),this._renderQueueManager=t,this._resourceManager=e,this._overridedMaterial=null,this._overridedShaders=[null,null,null],this._needSort=r,this._cullFace=e.gl.CCW,this._visible=!0}return e.prototype.dump=function(e){console.groupCollapsed("RenderPass: "+e),this.queue.dump(),console.log("_overridedShaders: ",this._overridedShaders),console.log("_overridedMaterial: ",this._overridedMaterial),console.log("_needSort: "+this._needSort),console.log("_cullFace: "+this._cullFace),console.log("_visible: "+this._visible),console.groupEnd()},e.prototype.destroy=function(){this._overridedShaders=null,delete this._overridedShaders,this._overridedMaterial=null,delete this._overridedMaterial,this._resourceManager=null,delete this._resourceManager,this._renderQueueManager=null,delete this._renderQueueManager},e.prototype.setCullFace=function(e){this._cullFace=e},e.prototype.getCullFace=function(){return this._cullFace},e.prototype.getVisibility=function(){return this._visible},e.prototype.setVisibility=function(e){this._visible=e},e.prototype.render=function(e,t,r,i,n,a){this._visible&&this.queue.isValid()&&(this._needSort&&this.queue.sort(r),t.drawDrawables(e,this.queue.drawables,r,this._overridedShaders,this._overridedMaterial,n,a,i,null,this._cullFace))},e.prototype.renderMark=function(e,t,r,i,n,a){this._visible&&this.queue.isValid()&&t.drawMarks(e,this.queue.drawables,r,n,a,i,null,!1)},e.prototype.setOverridedMaterial=function(e){this._overridedMaterial=e,this._overridedMaterial&&this._overridedShaders[0]&&this._overridedMaterial.attachShader(this._overridedShaders[0])},e.prototype.getOverridedMaterial=function(){return this._overridedMaterial},e.prototype.getOverridedShaders=function(){return this._overridedShaders},e.prototype.setOverridedShader=function(e){if(this._overridedShaders[0]=e,this._overridedMaterial&&this._overridedShaders[0]&&this._overridedMaterial.attachShader(this._overridedShaders[0]),e&&e.shaderSource){var t=e.flags.concat("MODEL_TRANSFORM"),r=this._resourceManager.getShader(e.shaderSource.name,t);r.ready||r.createFromShaderSource(e.shaderSource,t),this._overridedShaders[1]=r;var i=t.concat("INSTANCING"),n=this._resourceManager.getShader(e.shaderSource.name,i);n.ready||n.createFromShaderSource(e.shaderSource,i),this._overridedShaders[2]=n}},e.prototype.recompileOverridedShader=function(e,t){for(var r=0;r<this._overridedShaders.length;r++){var i=this._overridedShaders[r];if(i){var n=i.flags.lastIndexOf(e),a=void 0,o=!1;if(t?-1===n&&(a=i.flags.concat(e),o=!0):-1!==n&&((a=i.flags.slice(0)).splice(n,1),o=!0),o){var s=i.shaderSource.name,l=this._resourceManager.getShader(s,a);if(!l.ready&&(l.createFromShaderSource(i.shaderSource,a),!l.ready))throw new Error("Failed to create shader '"+s+"'!");this._overridedShaders[r]=l}}}},e.prototype.addDrawable=function(e){return this.queue.addDrawable(e)},e.prototype.removeDrawable=function(e){return this.queue.removeDrawable(e)},e.prototype.createQueue=function(e,t){return this.queue.create(e,t)},e.prototype.optimize=function(){this.queue.optimize()},e}(),er=function(){function e(e,t,r,i,n){var a=e.gl;this._gl=a,this.renderTarget=new Jt.a("box-normal-depth",e,i,n,{colorFormat:a.RGBA32F,clearColor:[0,0,0,0],colorBuffer:0,depthFormat:a.isWebGL2?a.DEPTH24_STENCIL8:a.DEPTH_STENCIL,depthBuffer:0}),this.buffer=new Float32Array(i*n*4),this.bufferDirty=!0,this.bufferDirtyTime=0,this.normal=U.d.create(),this.position=U.d.create(),this.nearPlaneSize=null,this.isPerspective=!0,this.inversedViewMatrix=U.a.create(),this.renderPass=new $t(e,t,!1,{line:!1});var o=e.getShader("normaldepth",["WORLDSPACE_NORMAL"]);if(!o.ready){var s=N.a.normaldepth;o.createFromShaderSource(s,["WORLDSPACE_NORMAL"])}this.renderPass.setOverridedShader(o),this.renderPass.setOverridedMaterial(new O.a("box-normal-depth"))}return e.prototype.resize=function(e,t){this.renderTarget.resize(e,t),this.buffer=new Float32Array(e*t*4)},e.prototype.destroy=function(){this.buffer=null,this.normal=null,this.inversedViewMatrix=null,this.renderTarget.destroy(),this.renderPass.destroy()},e.prototype.render=function(e,t){var r=this._gl;e.invalidate(),e.clear(this.renderTarget,r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),this.renderPass.render(this.renderTarget,e,t),r.readPixels(0,0,this.renderTarget.getWidth(),this.renderTarget.getHeight(),r.RGBA,r.FLOAT,this.buffer),this.nearPlaneSize=t.getNearPlaneSize(),this.isPerspective=t.isPerspective(),U.a.invert(this.inversedViewMatrix,t.viewMatrix),this.bufferDirty=!1},e.prototype.getNormalDepth=function(e,t){var r=this.renderTarget.getWidth(),i=this.renderTarget.getHeight(),n=4*(e+(i-t)*r),a=this.buffer[n+3];return 0!==a&&(this.normal[0]=this.buffer[n],this.normal[1]=this.buffer[n+1],this.normal[2]=this.buffer[n+2],!(isNaN(this.normal[0])||isNaN(this.normal[1])||isNaN(this.normal[2]))&&(this.position[2]=a,this.isPerspective?(this.position[0]=2*this.nearPlaneSize[0]*(e/r-.5)*a/this.nearPlaneSize[2],this.position[1]=2*this.nearPlaneSize[1]*((i-1-t)/i-.5)*a/this.nearPlaneSize[2]):(this.position[0]=2*this.nearPlaneSize[0]*(e/r-.5),this.position[1]=2*this.nearPlaneSize[1]*((i-1-t)/i-.5)),U.d.transformMat4(this.position,this.position,this.inversedViewMatrix),!0))},e.prototype.dirtyAt=function(e){this.bufferDirty=!0,this.bufferDirtyTime=e},e.prototype.canUpdateAt=function(e){return this.bufferDirty&&this.bufferDirtyTime<e},e.prototype.isDirty=function(){return this.bufferDirty},e.prototype.addDrawable=function(e){this.renderPass.queue.addDrawable(e)},e.prototype.recompileShader=function(e){this.renderPass.recompileOverridedShader(e)},e.prototype.isValid=function(){return this.renderPass.queue.isValid()},e.prototype.getNormal=function(){return this.normal},e.prototype.getPosition=function(){return this.position},e}(),tr=r(17),rr=r(42),ir=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(e){e[e.Default=0]="Default",e[e.FirstPersonRoaming=1]="FirstPersonRoaming"}(At||(At={}));var nr=function(e){function t(t){var r=e.call(this,"CameraManipulator",!1,t)||this;return r._normalDepth=null,r._animatorTransition=null,r._animatorNavigation=null,r._dirUp=[0,0,1],r._dirDown=[0,0,-1],r._mode=At.Default,r._getIntersection=!1,r._firstStandPointSetted=!1,r._navigationNeedStop=!1,r.ORDINARY_PEOPLE_HEIGHT=5.5,r._viewer?(r._depthQuery=new Kt.a(r._scene,r._resourceManager),r._normalDepth=new er(r._resourceManager,r._viewer.getRenderScene().getRenderQueueManager(),r._scene,r._viewer.getWidth(),r._viewer.getHeight())):r._depthQuery=null,r._animatorTransition=new Xt.a(t.getEventEmitter()),r._animatorNavigation=new rr.a(t.getEventEmitter()),r._restricted=!1,r._clippingEnabled=!!r._scene&&r._scene.clipping.isEnabled(),r._touchPanSpeedScaling=1.86*s.a.devicePixelRatio,r._touchZoomSpeedScaling=.0596*Math.sqrt(s.a.devicePixelRatio),r._touchRotateSpeedScaling=.44*s.a.devicePixelRatio,r._mousePanSpeedScaling=.37,r._mouseZoomSpeedScaling=.278,r._mouseRotateSpeedScaling=.45,r._keyRotateSpeed=2,r._keyPanSpeed=1,r._keyForwardSpeed=.0092,r._eventEmitter=t.getEventEmitter(),r._pressed=!1,r._hasSavedFPV=!1,r._isFPV=!1,r._adjusting=!1,r._isPanorama=!1,r.isOrthoView=!1,r.keyboardEnable=!0,r._enableDblclick=!0,r._orientation=t.getOrientation(),r}return ir(t,e),t.prototype.destroy=function(){this._animatorTransition&&(this._animatorTransition.destroy(),delete this._animatorTransition,this._animatorTransition=null),this._animatorNavigation&&(this._animatorNavigation.destroy(),delete this._animatorNavigation,this._animatorNavigation=null),this._depthQuery&&(this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery)},t.prototype.isAvailable=function(e){return!0},t.prototype.isSupport3D=function(){return!0},t.prototype.addInput=function(e){switch(e.name){case"mouse":return this._registerMouseEvents(e);case"touch":return this._registerTouchEvents(e);case"keyboard":return this._registerKeyboardEvents(e)}},t.prototype._registerMouseEvents=function(e){var t=this;e.addMouseUpListener(function(e){return t._onMouseUp(e)},"CameraManipulator"),e.addMouseDownListener(function(e){return t._onMouseDown(e)},"CameraManipulator"),e.addMouseMoveListener(function(e){return t._onMouseMove(e)},"CameraManipulator"),e.addMouseWheelListener(function(e){return t._onMouseWheel(e)},"CameraManipulator"),e.addMouseDbClickListener(function(e){return t._onMouseDbClick(e)},"CameraManipulator")},t.prototype._registerTouchEvents=function(e){var t=this;e.addTouchMoveListener(function(e){return t._onTouchMove(e)},"CameraManipulator"),e.addTouchStartListener(function(e){return t._onTouchStart(e)},"CameraManipulator"),e.addTouchDbClickListener(function(e){return t._onTouchDbClick(e)},"CameraManipulator")},t.prototype._registerKeyboardEvents=function(e){var t=this;e.addKeyDownListener(function(e){return t._onKeyDown(e)},"CameraManipulator"),e.addKeyUpListener(function(e){return t._onKeyUp(e)},"CameraManipulator")},t.prototype._onMouseDown=function(e){return this._restoreFPV(),1===e.getEvent().buttonDown&&(this._exitTransit(),this._pressed=!0),this._stopNavigation(),!1},t.prototype._stopNavigation=function(){this._isFirstPersonRoaming()&&this._navigationNeedStop&&(this._animatorNavigation.stop(!0),this._navigationNeedStop=!1)},t.prototype._dealFirstPersonRoaming=function(e){if(!e.moved&&this._isFirstPersonRoaming()){this._normalDepth.render(this._renderer,this._camera);var t=Math.floor(e.x*s.a.devicePixelRatio),r=Math.floor(e.y*s.a.devicePixelRatio);if(this._normalDepth.getNormalDepth(t,r))if(this._normalDepth.getNormal()[2]<.88)this._viewer.notifyEventListener("unreacha");else{this._firstStandPointSetted||this.enterFirstPersonRoamingMode();var i=this._depthQuery.unproject(t,r,this._renderer,this._camera);i||(i=this._normalDepth.getPosition()),i[2]+=this.ORDINARY_PEOPLE_HEIGHT;var n=U.d.create();U.d.lerp(n,this._camera.eye,i,1.1),n[2]=i[2],this._animatorNavigation.attach(this._camera),this._animatorNavigation.start(i,n),this._animatorNavigation.stop(),this._navigationNeedStop=!0,this._normalDepth.dirtyAt(this._viewer.getElapsedFrames())}}},t.prototype.enterFirstPersonRoamingMode=function(){this.resetFirstPersonView(!0),this.setMode(At.FirstPersonRoaming),this._firstStandPointSetted=!0,this._camera.setFirstPerson(!0),this._restoreFPV(),this._viewer.notifyEventListener("enterFirstPersonRoamingMode")},t.prototype._onMouseMove=function(e){if(e.button===e.LEFT_BUTTON&&e.pressed){if(this._adjusting)return this._camera.rotate(-e.dx*this._mouseRotateSpeedScaling,0),this._viewer.notifyEventListener("getMapPosition"),!0;if(this._isPanorama){this._camera.rotate(-e.dx*this._mouseRotateSpeedScaling,-e.dy*this._mouseRotateSpeedScaling);for(var t=1;t<this._cameras.length;t++)this._cameras[t].rotate(-e.dx*this._mouseRotateSpeedScaling,-e.dy*this._mouseRotateSpeedScaling)}else{var r=this._isFirstPersonRoaming()&&this._firstStandPointSetted?.15*-e.dx:e.dx,i=this._isFirstPersonRoaming()&&this._firstStandPointSetted?.15*-e.dy:e.dy;this._camera.rotate(r*this._mouseRotateSpeedScaling,i*this._mouseRotateSpeedScaling);for(t=1;t<this._cameras.length;t++)this._cameras[t].rotate(r*this._mouseRotateSpeedScaling,i*this._mouseRotateSpeedScaling)}}else if(e.button===e.MIDDLE_BUTTON&&e.pressed&&!this._restricted){this._camera.zoom(.01*e.dx*s.a.devicePixelRatio);for(t=1;t<this._cameras.length;t++)this._cameras[t].zoom(.01*e.dx*s.a.devicePixelRatio)}else if(e.button===e.RIGHT_BUTTON&&e.pressed&&!this._restricted){this._saveFPV(!1),this._exitTransit(),this._camera.pan(e.dx*this._mousePanSpeedScaling,e.dy*this._mousePanSpeedScaling);for(t=1;t<this._cameras.length;t++)this._cameras[t].pan(e.dx*this._mousePanSpeedScaling,e.dy*this._mousePanSpeedScaling)}return 0!==e.getEvent().buttonDown&&this.isOrthoView&&(this._viewer.notifyEventListener("exitOrthoView"),this.isOrthoView=!1),this._isFirstPersonRoaming()&&this._onMouseMoveOfFPR(e),!1},t.prototype._onMouseMoveOfFPR=function(e){var t=e.getEvent().buttonDown,r=e.moved,i=t&&r,n=this._viewer.getElapsedFrames();if(i)this._normalDepth.dirtyAt(n);else{var a=!this._camera.updated,o=this._normalDepth.canUpdateAt(n);if(r&&a&&o)this._normalDepth.render(this._renderer,this._camera);else{var l=Math.floor(e.x*s.a.devicePixelRatio),u=Math.floor(e.y*s.a.devicePixelRatio),c=this._normalDepth.getNormalDepth(l,u);if(this._getIntersection!==c&&(this._viewer.notifyEventListener(c?"mouseEnterModel":"mouseLeaveModel"),this._getIntersection=c),c){var h=this._normalDepth.getNormal();this._viewer.notifyEventListener("gotStandPoint",h[2]>.88?"valid":"invalid")}}}},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupport3D=function(e){return!0},t.prototype._onMouseUp=function(e){return this._restoreFPV(),1===e.getEvent().buttonDown&&(this._pressed=!1),this._dealFirstPersonRoaming(e),!1},t.prototype._onMouseWheel=function(e){if(this._exitTransit(),this._restoreFPV(),this._isFirstPersonRoaming()&&(this._normalDepth.dirtyAt(this._viewer.getElapsedFrames()),this._firstStandPointSetted))return this._stopNavigation(),e.delta>0?this._moveForward(4):this._moveBackward(4),!0;this._saveFPV(!1);var t=e.delta*this._mouseZoomSpeedScaling;this._camera.zoom(t,e.x*s.a.devicePixelRatio,e.y*s.a.devicePixelRatio);for(var r=1;r<this._cameras.length;r++)this._cameras[r].zoom(t,e.x*s.a.devicePixelRatio,e.y*s.a.devicePixelRatio);return!1},t.prototype._onMouseDbClick=function(e){if(this._enableDblclick&&!this._isFirstPersonRoaming()&&(this._exitTransit(),!this._camera.isFirstPerson())){var t=this._depthQuery.unproject(e.x,e.y,this._renderer,this._camera);null!==t&&(this._camera.lookTo(t),this.isOrthoView&&(this._viewer.getEventEmitter().emit("exitOrthoView"),this.isOrthoView=!1))}},t.prototype._onTouchMove=function(e){var t,r,i=e.cursor(0);if(this._exitTransit(),1===e.numCursors)this._restoreFPV(),i=e.cursor(0),this._isPanorama?this._camera.rotate(-i.dx*this._touchRotateSpeedScaling,-i.dy*this._touchRotateSpeedScaling):this._camera.rotate(i.dx*this._touchRotateSpeedScaling,i.dy*this._touchRotateSpeedScaling);else if(2===e.numCursors){this._restoreFPV(),this._saveFPV(!1),i=e.cursor(0);var n=e.cursor(1);if(i.dx*n.dx+i.dy*n.dy>0)t=(i.dx+n.dx)*this._touchPanSpeedScaling,r=(i.dy+n.dy)*this._touchPanSpeedScaling,this._camera.pan(t,r);else{var a=i.x-i.dx,o=i.y-i.dy;t=a-(n.x-n.dx),r=o-(n.y-n.dy);var s=Math.sqrt(t*t+r*r);t=i.x-n.x,r=i.y-n.y;var l=Math.sqrt(t*t+r*r)-s,u=Math.sign(l)*this._touchZoomSpeedScaling;this._camera.zoom(u)}}else{this._restoreFPV(),this._saveFPV(!1),t=0,r=0;for(var c=0;c<e.numCursors;++c){var h=e.cursor(c);t+=h.dx,r+=h.dy}t/=e.numCursors,r/=e.numCursors,t*=this._touchPanSpeedScaling,r*=this._touchPanSpeedScaling,this._camera.pan(t,r)}return 0!==e.numCursors&&this.isOrthoView&&(this._eventEmitter&&this._eventEmitter.emit("exitOrthoView"),this.isOrthoView=!1),this._eventEmitter&&this._eventEmitter.emit("getMapPosition"),!1},t.prototype._onTouchStart=function(e){return e.isDoubleClick&&window.getSelection&&window.getSelection().removeAllRanges(),!1},t.prototype._onTouchDbClick=function(e){if(!this._enableDblclick)return!1;if(!this._camera.isFirstPerson()){this._exitTransit();var t=e.cursor(0),r=this._depthQuery.unproject(t.x,t.y,this._renderer,this._camera);return null!==r&&(this._camera.lookTo(r),this.isOrthoView&&(this._eventEmitter&&this._eventEmitter.emit("exitOrthoView"),this.isOrthoView=!1)),!0}return!1},t.prototype.setKeyboardEnable=function(e){this.keyboardEnable=e},t.prototype._rotateLeft=function(){this._saveFPV(!0),this._camera.rotate(-this._keyRotateSpeed,0)},t.prototype._rotateRight=function(){this._saveFPV(!0),this._camera.rotate(+this._keyRotateSpeed,0)},t.prototype._rotateUp=function(){this._saveFPV(!0),this._camera.rotate(0,-.5*this._keyRotateSpeed)},t.prototype._rotateDown=function(){this._saveFPV(!0),this._camera.rotate(0,.5*this._keyRotateSpeed)},t.prototype._moveForward=function(e){void 0===e&&(e=1),this._restricted||(this._saveFPV(!1),this._isFirstPersonRoaming()?this._camera.moveForward(this._keyPanSpeed*e,!0):this._camera.forward(this._keyForwardSpeed*e))},t.prototype._moveBackward=function(e){void 0===e&&(e=1),this._restricted||(this._saveFPV(!1),this._isFirstPersonRoaming()?this._camera.moveBackward(this._keyPanSpeed*e,!0):this._camera.forward(-this._keyForwardSpeed*e))},t.prototype._moveLeft=function(e){void 0===e&&(e=1),this._restricted||(this._saveFPV(!1),this._camera.moveLeft(this._keyPanSpeed*e))},t.prototype._moveRight=function(e){void 0===e&&(e=1),this._restricted||(this._saveFPV(!1),this._camera.moveRight(this._keyPanSpeed*e))},t.prototype._moveUp=function(){this._restricted||(this._saveFPV(!1),this._isFirstPersonRoaming()?this._camera.moveUp(this._keyPanSpeed):this._camera.forward(this._keyForwardSpeed,this._dirUp))},t.prototype._moveDown=function(){this._restricted||(this._saveFPV(!1),this._isFirstPersonRoaming()?this._camera.moveDown(this._keyPanSpeed):this._camera.forward(this._keyForwardSpeed,this._dirDown))},t.prototype._onKeyDown=function(e){return!!this.keyboardEnable&&(this._stopNavigation(),!!e.repeat&&(this._onFirstPersonRoaming(e.key),!1))},t.prototype._onKeyUp=function(e){return!!this.keyboardEnable&&(this._onSwitch(e.key)||this._onFirstPersonRoaming(e.key))},t.prototype._isFirstPersonRoaming=function(){return this._mode===At.FirstPersonRoaming},t.prototype._onSwitch=function(e){switch(e){case"m":this.setMode(At.Default);break;case"M":this.setMode(At.FirstPersonRoaming);break;default:return!1}return!0},t.prototype._onFirstPersonRoaming=function(e){switch(this._exitTransit(),this._restoreFPV(),this._normalDepth.dirtyAt(this._viewer.getElapsedFrames()),e){case"ArrowLeft":case"a":case"A":this._rotateLeft();break;case"ArrowRight":case"d":case"D":this._rotateRight();break;case"ArrowUp":case"w":case"W":this._moveForward();break;case"ArrowDown":case"s":case"S":this._moveBackward();break;case"e":case"E":this._moveUp();break;case"q":case"Q":this._moveDown();break;case"f":case"F":this._rotateDown();break;case"r":case"R":this._rotateUp();break;default:return!1}return!0},t.prototype._exitTransit=function(){this._restricted||this._camera.animator instanceof Xt.a&&this._camera.animator.stop()},t.prototype.setCamera=function(e,t){void 0===t&&(t=0),this._cameras=[];for(var r=0;r<e.length;r++)this._cameras.push(e[r]);this._camera=this._cameras[t]},t.prototype.exitOrthoView=function(){this.isOrthoView&&(this._eventEmitter.emit("exitOrthoView"),this.isOrthoView=!1)},t.prototype.setTransitionSpeed=function(e){this._animatorTransition.setTransitionSpeed(e)},t.prototype.setInputSensitivity=function(e){for(var t in e)switch(t){case"touchPan":this._touchPanSpeedScaling=e[t]*s.a.devicePixelRatio;break;case"touchZoom":this._touchZoomSpeedScaling=e[t]*Math.sqrt(s.a.devicePixelRatio);break;case"touchRotate":this._touchRotateSpeedScaling=e[t]*s.a.devicePixelRatio;break;case"mousePan":this._mousePanSpeedScaling=e[t];break;case"mouseZoom":this._mouseZoomSpeedScaling=e[t],this._camera.setZoomMinMax(e[t]);break;case"mouseRotate":this._mouseRotateSpeedScaling=e[t];break;case"keyPan":this._keyPanSpeed=e[t];break;case"keyForward":this._keyForwardSpeed=e[t]}},t.prototype.setInAppNaviAdjusting=function(e){this._adjusting=e},t.prototype.setPanoramaEnabled=function(e){this._isPanorama=e},t.prototype.setRestrictedViewEnabled=function(e){this._restricted=e},t.prototype.isRestrictedViewEnabled=function(){return this._restricted},t.prototype.recompileShader=function(e){if(this._scene){e.slice(0);e.push("CLIPPING"),tr.a.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this._depthQuery.recompileShader(this._resourceManager,e)}},t.prototype.unproject=function(e,t){return this._depthQuery.unproject(e,t,this._renderer,this._camera)},t.prototype.setZoomSpeed=function(e){this._mouseZoomSpeedScaling=e},t.prototype.setPanSpeed=function(e){this._mousePanSpeedScaling=e},t.prototype.resetFirstPersonView=function(e){this._isFPV=e,this._hasSavedFPV=!1,e||this.setMode(At.Default)},t.prototype.switchToUserView=function(e,t){this._restoreFPV(),e&&(this._scene.setActiveView(e.name),this._scene.clipping.reset(),this._camera.animator instanceof Xt.a&&this._camera.animator.stop(),this._animatorTransition.attach(this._camera),this._animatorTransition.start(e,t),this._orientation&&this._orientation.enabled&&this._orientation.reset(this._camera))},t.prototype._restoreFPV=function(){this._hasSavedFPV&&(this._hasSavedFPV=!1,this._camera.setFirstPerson(this._isFPV))},t.prototype.setDblclickEnabled=function(e){this._enableDblclick=e},t.prototype._saveFPV=function(e){this._hasSavedFPV||(this._isFPV=this._camera.isFirstPerson(),this._hasSavedFPV=!0,this._camera.setFirstPerson(e))},t.prototype.setMode=function(e){this._mode=e,this._firstStandPointSetted=!1,this._getIntersection=!1,this._isFirstPersonRoaming()&&(this._normalDepth.dirtyAt(0),this._camera.setFirstPerson(this._firstStandPointSetted))},t.prototype.resize=function(e,t){this._normalDepth&&this._normalDepth.resize(e,t)},t}(Zt.a),ar=r(25),or=function(){function e(e){this._viewer=e;var t=[0,0,this._viewer.getCanvas().width,this._viewer.getCanvas().height];this._viewer?this._scene=e.getScene():this._scene=null,this._manipulator=null,this._scene?this.core=new Yt(this._scene.core,t):this.core=new Yt(null,t),this._animator=new Xt.a(e.getEventEmitter()),this.cores=[],this.cores.push(this.core)}return e.prototype.destroy=function(){this.core=null,delete this.core;for(var e=0;e<this.cores.length;e++)this.cores[e].destroy();this.cores=null,delete this.cores,this._manipulator&&(this._manipulator.destroy(),this._manipulator=null,delete this._manipulator),this._viewer&&(this._viewer=null,delete this._viewer),this._scene=null,delete this._scene},e.prototype.update=function(){return this.core.update()},e.prototype.setFov=function(e){this.core.setTargetFov(e),this._viewer&&this._viewer.invalidate()},e.prototype.setFirstPersonViewEnabled=function(e){this.core.setFirstPerson(e)},e.prototype.isFirstPersonViewEnabled=function(){return this.core.isFirstPerson()},e.prototype.setRestrictedViewEnabled=function(e){this.core.setFirstPerson(e),this._manipulator.setRestrictedViewEnabled(e)},e.prototype.isRestrictedViewEnabled=function(){return this.core.isFirstPerson()&&this._manipulator.isRestrictedViewEnabled()},e.prototype.switchToTopView=function(){this.switchToView(4)},e.prototype.switchToBottomView=function(){this.switchToView(5)},e.prototype.switchToLeftView=function(){this.switchToView(2)},e.prototype.switchToRightView=function(){this.switchToView(3)},e.prototype.switchToFrontView=function(){this.switchToView(0)},e.prototype.switchToBackView=function(){this.switchToView(1)},e.prototype.switchToView=function(e){var t=[[0,-.5*Math.PI],[0,.5*Math.PI],[0,Math.PI],[0,0],[.49999*Math.PI,.49999*-Math.PI],[-.49999*Math.PI,.49999*-Math.PI]],r=null;if(e>=ar.a.FRONT&&e<=ar.a.BOTTOM){r=t[e];for(var i=0;i<this.cores.length;i++)this.cores[i].reset(!1),this.cores[i].rotateTo(r[0],r[1])}else{for(i=0;i<this.cores.length;i++)this.cores[i].setFirstPerson(!1),this.cores[i].setPerspective(!0);this._viewer.getEventEmitter().emit("orthoViewChanged",!0);for(i=0;i<this.cores.length;i++)this.cores[i].reset(!1);this.core.reset(!1)}},e.prototype.setSensitivity=function(e){this._manipulator.setInputSensitivity(e)},e.prototype.addInput=function(e){this._manipulator||(this._manipulator=new nr(this._viewer)),this._manipulator.addInput(e)},e.prototype.resize=function(e,t){for(var r=[0,0,e,t],i=0;i<this.cores.length;i++)this.cores[i].setViewport(r),this.cores[i].update()},e.prototype.transformToPerspective=function(){for(var e=0;e<this.cores.length;e++)this.cores[e].transformOrthogonalToPerspective();this._viewer&&(this._viewer.invalidate(),this._viewer.getEventEmitter().emit("orthoViewChanged",!1))},e.prototype.transformToOrthogonal=function(){for(var e=0;e<this.cores.length;e++)this.cores[e].transformPerspectiveToOrthogonal();this._viewer&&(this._viewer.invalidate(),this._viewer.getEventEmitter().emit("orthoViewChanged",!0))},e.prototype.getData=function(){return this.core.dump()},e.prototype.setData=function(e,t){void 0===t&&(t=!1),t?(this.core.animator instanceof Xt.a&&this.core.animator.stop(!0),this._animator.attach(this.core),this._animator.start(e,!1)):this.core.restore(e)},e.prototype.switchToWorldView=function(){for(var e=0;e<this.cores.length;e++)this.cores[e].setFirstPerson(!1),this.cores[e].setPerspective(!0);this._viewer.getEventEmitter().emit("orthoViewChanged",!1);for(e=0;e<this.cores.length;e++)this.cores[e].reset(!1)},e.prototype.project=function(e,t){return this.core.project(e,t)},e.prototype.unproject=function(e,t){return this._manipulator.unproject(e,t)},e.prototype.rotate=function(e,t){this.core.rotate(e,t)},e.prototype.getViewDirection=function(){return this.core.getViewDirection()},e.prototype.setMinPitchAngle=function(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMinPitchAngle(e)},e.prototype.setMaxPitchAngle=function(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMaxPitchAngle(e)},e.prototype.setMaxTargetDistanceRatio=function(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMaxTargetDistanceRatio(e)},e.prototype.setMinTargetDistanceRatio=function(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMinTargetDistanceRatio(e)},e.prototype.setNearPlaneDistanceRatio=function(e){for(var t=0;t<this.cores.length;t++)this.cores[t].setMinZnearRatio(e)},e.prototype.setMouseZoomSpeed=function(e){this._manipulator.setZoomSpeed(e)},e.prototype.setMousePanSpeed=function(e){this._manipulator.setPanSpeed(e)},e.prototype.setTransitionSpeed=function(e){this._manipulator.setTransitionSpeed(e)},e.prototype.calc360WorldPoint=function(e,t){return[e[0]-t[0],e[1]-t[1],t[2]-e[2]]},e.prototype.autoProductPanoramas=function(e,t,r){for(var i=[],n=r||[],a=0;a<e.length;a++){var o={visibleindexs:[],visiblePoints:[]},s=e[a];if(o.position=s,n[a]){var l=n[a].at,u=Math.sqrt((s[0]-l[0])*(s[0]-l[0])+(s[1]-l[1])*(s[1]-l[1])+(s[2]-l[2])*(s[2]-l[2]));o.cameraData360={phi:n[a].phi,theta:n[a].theta,fov:this.core._fov,at:[15*(s[0]-l[0])/u,15*(s[1]-l[1])/u,15*(l[2]-s[2])/u],distance:15}}o.name=t?t[a]:"360Panorama"+a;var c=s;if(a>0){var h=e[a-1],d=this.calc360WorldPoint(c,h);o.visibleindexs.push(a-1),o.visiblePoints.push(d)}if(a+1<e.length){var p=e[a+1];d=this.calc360WorldPoint(c,p);o.visibleindexs.push(a+1),o.visiblePoints.push(d)}i.push(o)}return i},e.prototype.getEye=function(){return this.core.eye},e.prototype.getRotation=function(){var e=this.core._theta;return{phi:this.core._phi,theta:e%=2*Math.PI}},e.prototype.setCameraGesture=function(e,t,r){this.core.rotateTo(t,r),this.core.setTargetAt(e),this._viewer.invalidate()},e.prototype.setZoomRange=function(e,t){this.core.setZoomRange(e,t),this._viewer.invalidate()},e.prototype.setTargetAt=function(e){this.core.setTargetAt(e),this._viewer.invalidate()},e.prototype.setDistance=function(e){this.core.setDistance(e),this._viewer.invalidate()},e.prototype.setNavigationTypeEnabled=function(e,t){this.core.setNavigationEnabled(e,t)},e.prototype.rotateTo=function(e,t){this.core.rotateTo(e,t),this._viewer.invalidate()},e.prototype.enabledTwoPointsPerspective=function(e){this.core.enabledTwoPointsPerspective(e)},e.prototype.setRotationRange=function(e,t,r){this.core.setRotationRange(e,t,r)},e.prototype.isPerspective=function(){return this.core.isPerspective()},e.prototype.setKeyboardEnable=function(e){this._manipulator.setKeyboardEnable(e)},e.prototype.switchToUserView=function(e,t){this._manipulator.switchToUserView(e,t)},e.prototype.setDblclickEnabled=function(e){this._manipulator.setDblclickEnabled(e)},e.prototype.transformProperty=function(e){return this.core.transformProperty(e)},e.prototype.getManipulator=function(){return this._manipulator},e}(),sr=r(33),lr=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ur=function(e){function t(t){return e.call(this,t)||this}return lr(t,e),t.prototype.attachShader=function(t,r){if(!t||!t.ready)return t;for(var i in e.prototype.attachShader.call(this,t,r),t.reservedUniforms)this.reservedParameters.hasOwnProperty(i)||("m_uBlitTexture"===i?(this.reservedParameters[i]=new R.a,this.hasTexture=!0,this.reservedParameters[i].texUnit=4,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uBlitDepthTexture"===i?(this.reservedParameters[i]=new R.a,this.hasTexture=!0,this.reservedParameters[i].texUnit=6,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture):"m_uInvResolution"===i?(this.reservedParameters[i]=new R.a,this.reservedParameters[i].upload=this.reservedParameters[i].uploadValue,this.reservedParameters[i].value=[1,1]):"m_uForeground"===i&&(this.reservedParameters[i]=new R.a,this.reservedParameters[i].texUnit=5,this.reservedParameters[i].upload=this.reservedParameters[i].uploadTexture));return t},t.prototype.setTexture=function(e){this.reservedParameters.m_uBlitTexture.value=e},t.prototype.setForegroundTexture=function(e){this.reservedParameters.m_uForeground.value=e},t.prototype.setDepthTexture=function(e){this.reservedParameters.m_uBlitDepthTexture.value=e},t.prototype.setInvResolution=function(e){this.reservedParameters.m_uInvResolution&&(this.reservedParameters.m_uInvResolution.value=e)},t}(O.a),cr=function(){function e(e,t,r){void 0===t&&(t=null),void 0===r&&(r=!1),this._resourceManager=e,t||(t=N.a.blit),this._shader=e.getShader(t.name,[]),this._shader.ready||this._shader.createFromShaderSource(t,r?["MOBILE"]:[]),this.ready=this._shader.ready,this.ready?(this._material=new ur(t.name),this._material.attachShader(this._shader)):this._material=null}return e.prototype.destroy=function(){this.ready&&(this._material.destroy(),this._material=null,delete this._material,this._shader.destroy(),this._shader=null,delete this._shader,this.ready=!1),this._resourceManager=null,delete this._resourceManager},e.prototype.setTexture=function(e){this._material.setTexture(e)},e.prototype.setForegroundTexture=function(e){this._material.setForegroundTexture(e)},e.prototype.setDepthTexture=function(e){this._material.setDepthTexture(e)},e.prototype.setParameter=function(e,t){this._material.parameters[e].value=t},e.prototype.render=function(e,t,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this.ready&&t.ready){var n=this._shader.getGL(),a=t.getOption("depthMask");t.setOption("depthMask",!1);var o=i?n.GREATER:n.ALWAYS,s=t.getOption("depthFunc");t.setOption("depthFunc",o);var l=t.getOption("blend");t.setOption("blend",r||!1);var u=[1/t.getWidth(),1/t.getHeight()];this._material.setInvResolution(u),t.always=!0,e.drawScreen(t,this._shader,this._material),t.setOption("depthMask",a),t.setOption("depthFunc",s),t.setOption("blend",l),e.renderState.blend(t.getOption("blend")),e.renderState.depthTest(t.getOption("depthTest"),t.getOption("clearDepth"),t.getOption("depthFunc")),e.renderState.depthMask(t.getOption("depthMask"));var c=this._material.parameters;for(var h in c)c[h].texUnit>=0&&(n.activeTexture(n.TEXTURE0+c[h].texUnit),n.bindTexture(n.TEXTURE_2D,null))}},e.prototype.recompile=function(e,t){var r,i=this._shader,n=i.flags.lastIndexOf(e),a=!1;if(t?-1===n&&(r=i.flags.concat(e),a=!0):-1!==n&&((r=i.flags.slice(0)).splice(n,1),a=!0),a){var o=i.shaderSource.name,s=this._resourceManager.getShader(o,r);if(!s.ready&&(s.createFromShaderSource(i.shaderSource,r),!s.ready))throw new Error("Failed to create shader '"+o+"'!");this._shader=s,this._material.attachShader(this._shader)}},e}(),hr=function(){function e(e,t,r,i){this._color=new Float32Array([1,0,0,1]),this._blitContour=null,this._blitOverlay=null,this._shaders=[null,null,null],this._material=null,this._ready=!1,this._rtDepth=null,this._rtColor=null,this._rtDefault=null,this._rtProgressively=null,this._rtContour=null,this._resourceManager=null,this._resourceManager=e;var n=e,a=n.gl,o=r,s=i;this._blitContour=new cr(e,N.a.contour),this._blitOverlay=new cr(e,N.a.contouroverlay),this._rtDepth=new Jt.a("contour-drawablesdepth",n,o,s,{depthBuffer:0,colorBuffer:0,colorMask:[0,0,0,0]}),this._rtColor=new Jt.a("contour-drawablescolor",n,o,s,{depthBuffer:0,colorBuffer:0,clearColor:[0,0,0,0],depthFunc:a.EQUAL}),this._rtContour=new Jt.a("contour",n,o,s,{depthBuffer:0,colorBuffer:1,clearColor:[1,0,0,0],depthTest:!1}),this._rtDefault=new Jt.a(a.isWebGL2?"pipeline":"default",n,o,s,{blend:!0,depthTest:!1}),this._rtProgressively=new Jt.a("pipeline-pr",n,o,s,{blend:!0,depthTest:!1}),this._ready=this._rtDepth.ready&&this._rtColor.ready&&this._rtContour.ready&&this._rtDefault.ready,this._ready?(this._material=t.materialManager.createMaterialAdhoc("contour"),this._blitContour.setTexture(this._rtColor.getColorBuffer()),this._blitOverlay.setTexture(this._rtContour.getColorBuffer()),this.recompileShader(e,{section:!1})):(this._rtDepth.destroy(),this._rtColor.destroy(),this._rtContour.destroy(),this._rtDefault.destroy(),this._blitContour.destroy(),this._blitOverlay.destroy(),this._material.destroy())}return e.prototype.destroy=function(){this._ready&&(this._rtColor.destroy(),this._rtDepth.destroy(),this._rtDefault.destroy(),this._rtContour.destroy(),this._blitContour.destroy(),this._blitOverlay.destroy(),this._material.destroy())},e.prototype.setColor=function(e){this._color[0]=e[0],this._color[1]=e[1],this._color[2]=e[2],this._color[3]=e[3]},e.prototype.resize=function(e,t){this._ready&&(this._rtColor.resize(e,t),this._rtDepth.resize(e,t),this._rtContour.resize(e,t),this._rtDefault.resize(e,t),this._ready=this._rtColor.ready&&this._rtDepth.ready&&this._rtContour.ready&&this._rtDefault.ready)},e.prototype.recompileShader=function(e,t){var r=[];t.section&&r.push("CLIPPING"),this._shaders[0]=e.getShader("constant",r),this._shaders[0].ready||this._shaders[0].createFromShaderSource(N.a.constant,r),r.push("MODEL_TRANSFORM"),this._shaders[1]=e.getShader("constant",r),this._shaders[1].ready||this._shaders[1].createFromShaderSource(N.a.constant,r),r.push("INSTANCING"),this._shaders[2]=e.getShader("constant",r),this._shaders[2].ready||this._shaders[2].createFromShaderSource(N.a.constant,r),this._material.attachShader(this._shaders[0],this._resourceManager),this._material.setDiffuse([1,0,0]),this._material.setTransparent(1)},e.prototype.render=function(e,t,r,i){this._ready&&(this._genContourOfSelectedDrawable(e,t,r,i),this._blitContourToDefaultFrameBuffer(e))},e.prototype.renderProgressively=function(e,t,r,i){this._ready&&(this._genContourOfSelectedDrawable(e,t,r,i),this._blitContourToPrFrameBuffer(e))},e.prototype._genContourOfSelectedDrawable=function(e,t,r,i){this._checkClipping(t,e),this._drawSceneDepth(t,e,i),this._drawSelectedDrawableWithRedColor(r,e,i,t.clipping),this._extractContourFromColorBuffer(e)},e.prototype._checkClipping=function(e,t){e.clipping.isEnabled()&&t.renderState.invalidateClip()},e.prototype._drawSceneDepth=function(e,t,r){var i=this._resourceManager.gl;for(var n in t.clear(this._rtDepth,i.DEPTH_BUFFER_BIT),e.models)t.drawDrawables(this._rtDepth,e.models[n].drawables,r,this._shaders,this._material,e.clipping,null,null,null,!1)},e.prototype._drawSelectedDrawableWithRedColor=function(e,t,r,i){var n=this._resourceManager.gl;t.clear(this._rtColor,n.COLOR_BUFFER_BIT),t.drawDrawables(this._rtColor,e,r,this._shaders,this._material,i,null,null,null,!1)},e.prototype._extractContourFromColorBuffer=function(e){var t=this._resourceManager.gl;e.clear(this._rtContour,t.COLOR_BUFFER_BIT),this._blitContour.render(e,this._rtContour)},e.prototype._blitContourToDefaultFrameBuffer=function(e){this._blitOverlay.setParameter("uColor",this._color),this._blitOverlay.render(e,this._rtDefault,!0)},e.prototype._blitContourToPrFrameBuffer=function(e){this._blitOverlay.setParameter("uColor",this._color),this._blitOverlay.render(e,this._rtProgressively,!0)},e.prototype.renderMark=function(e,t,r,i,n){if(this._ready){var a=this._resourceManager.gl;e.clear(this._rtDepth,a.DEPTH_BUFFER_BIT),t.clipping.isEnabled()&&e.renderState.invalidateClip(),n&&n.length&&e.drawDrawables(this._rtDepth,n,i,this._shaders,this._material,t.clipping,null,null,null,!1),e.clear(this._rtColor,a.COLOR_BUFFER_BIT),e.drawDrawables(this._rtColor,r,i,this._shaders,this._material,t.clipping,null,null,null,!1),e.clear(this._rtContour,a.COLOR_BUFFER_BIT),this._blitContour.render(e,this._rtContour),this._blitOverlay.setParameter("uColor",this._color),this._blitOverlay.render(e,this._rtDefault,!0)}},e}(),dr=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),pr=function(e){function t(t){var r=e.call(this,"ChangeMaterial",!0,t)||this;return r._savedColors={},r._savedTransparent={},r._pickedMaterial=null,r._hoveringMaterial=null,r._pickQuery=null,r._contour=null,r._settingMaterial=null,r._savedTexture={},r._savedTextureOption={},r._isSetting=!1,s.a.isMobile?r:(r._savedTexture={},r._savedTextureOption={},r._pickQuery=new sr.a(r._scene,r._resourceManager),r._contour=new hr(r._resourceManager,r._scene,r._viewer.getWidth(),r._viewer.getHeight()),r._contour.setColor([1,0,0,1]),r._preventEffect=!0,r)}return dr(t,e),t.prototype.doesSupportMobile=function(e){return!0},t.prototype.destroy=function(){s.a.isMobile||(this._contour.destroy(),this._pickQuery.destroy())},t.prototype.resize=function(e,t){s.a.isMobile||this._contour.resize(e,t)},t.prototype.recompileShader=function(e){s.a.isMobile||(this._pickQuery.recompileShader(this._resourceManager,e),this._contour.recompileShader(this._resourceManager,e))},t.prototype.addInput=function(e){switch(e.name){case"mouse":return this._registerMouseEvents(e);case"touch":return this._registerTouchEvents(e)}},t.prototype._registerMouseEvents=function(e){var t=this;e.addMouseMoveListener(function(e){return t._onMouseMove(e)},"ChangeMaterial"),e.addMouseUpListener(function(e){return t._onMouseUp(e)},"ChangeMaterial")},t.prototype._registerTouchEvents=function(e){},t.prototype._onMouseUp=function(e){return!(!this._enabled||e.moved)&&(this._onInputStop(),!0)},t.prototype._onMouseMove=function(e){return!!this._enabled&&((0===e.getEvent().buttonDown||!e.isCameraManipulated)&&(this._onInputStart(e.x,e.y),!1))},t.prototype._getCompatibleMaterialNameOf=function(e){var t=e.split("."),r=t[0];return(r=r.replace(/\:/g,"_"))+"."+t[1]},t.prototype.setMaterialColor=function(e,t){var r=this._getCompatibleMaterialNameOf(e),i=this._scene.materialManager.getModelMaterial(r);i&&(i.setDiffuse(t),this._needUpdate=!0)},t.prototype.setMaterialTransparency=function(e,t){var r=this._getCompatibleMaterialNameOf(e),i=this._scene.materialManager.getMaterial(r);return i?(this._needUpdate=!0,i.setTransparent(t),this._scene.getDrawablesByMaterialName(r)):null},t.prototype.restoreMaterials=function(){this._pickedMaterial=null,this._hoveringMaterial=null;var e=this._scene.materialManager.getModelMaterials(!0);for(var t in e){var r=e[t],i=this._scene.getDrawablesByMaterialName(this._settingMaterial);if(r instanceof V){if(this._savedTexture[t]){var n=this._resourceManager.getTexture(this._savedTexture[t].name);n.ready=!0,O.a.prototype.setDiffuseTexture.call(r,n,this._resourceManager,i)}else r.hasTexture&&r.removeDiffuseTexture();r.hasTexture&&(this._savedTextureOption[t]?(r.setTextureOffset(this._savedTextureOption[t].offset),r.setTextureScale(this._savedTextureOption[t].scale),r.setTextureRotate(this._savedTextureOption[t].scale[2])):(r.setTextureOffset(new Float32Array([0,0])),r.setTextureScale([1,1]),r.setTextureRotate(0)))}}if(this._savedColors){for(var t in this._savedColors){(r=this._scene.materialManager.getModelMaterial(t))instanceof V&&r.setDiffuse(this._savedColors[t])}for(var t in this._savedTransparent){(r=this._scene.materialManager.getModelMaterial(t)).getTransparent&&r.setTransparent(this._savedTransparent[t])}}},t.prototype.restoreMaterialColor=function(e){this._pickedMaterial=null,this._hoveringMaterial=null;var t=this._getCompatibleMaterialNameOf(e),r=this._scene.materialManager.getModelMaterial(t);this._savedColors[e]&&r instanceof V&&(r.setDiffuse(this._savedColors[t]),r.getTransparent&&r.setTransparent(this._savedTransparent[t]))},t.prototype.backupMaterials=function(){this._savedColors={},this._savedTransparent={},this._savedTexture={},this._savedTextureOption={};var e=this._scene.materialManager.getModelMaterials(!0);for(var t in e){var r=this._scene.materialManager.getModelMaterial(t);if(r&&r.getDiffuseTexture()){if(this._savedTexture[t]=r.getDiffuseTexture(),!(r instanceof V))continue;r._materialTextureOffset&&r._materialTextureOffset[2]&&(this._savedTextureOption[t]={offset:r._materialTextureOffset,scale:r._materialTextureScale})}r.getDiffuse()&&(this._savedColors[t]=r.getDiffuse().slice(0),r.getTransparent&&(this._savedTransparent[t]=r.getTransparent()))}},t.prototype._onEnableChanged=function(){this._pickedMaterial=null,this._hoveringMaterial=null},t.prototype._render=function(){if(this._settingMaterial){var e=this._scene.getDrawablesByMaterialName(this._settingMaterial);this._contour.setColor([.968,.322,.137,1]),this._contour.render(this._renderer,this._scene,e,this._camera)}if(null!==this._pickedMaterial){var t=this._scene.getDrawablesByMaterialName(this._pickedMaterial);this._contour.setColor([.968,.322,.137,1]),this._contour.render(this._renderer,this._scene,t,this._camera)}if(null!==this._hoveringMaterial&&this._hoveringMaterial!==this._pickedMaterial){var r=this._scene.getDrawablesByMaterialName(this._hoveringMaterial);this._contour.setColor([1,.565,.443,1]),this._contour.render(this._renderer,this._scene,r,this._camera)}},t.prototype._renderProgressively=function(){if(this._settingMaterial){var e=this._scene.getDrawablesByMaterialName(this._settingMaterial);this._contour.setColor([.968,.322,.137,1]),this._contour.renderProgressively(this._renderer,this._scene,e,this._camera)}if(null!==this._pickedMaterial){var t=this._scene.getDrawablesByMaterialName(this._pickedMaterial);this._contour.setColor([.968,.322,.137,1]),this._contour.renderProgressively(this._renderer,this._scene,t,this._camera)}if(null!==this._hoveringMaterial&&this._hoveringMaterial!==this._pickedMaterial){var r=this._scene.getDrawablesByMaterialName(this._hoveringMaterial);this._contour.setColor([1,.565,.443,1]),this._contour.renderProgressively(this._renderer,this._scene,r,this._camera)}},t.prototype._onInputStop=function(){if(this._needUpdate=this._hoveringMaterial!==this._pickedMaterial,this._needUpdate&&(this._pickedMaterial=this._hoveringMaterial,this._isSetting&&(this._settingMaterial=this._pickedMaterial,this._pickedMaterial=null,this._viewer.notifyEventListener("mateiralSetting",this._settingMaterial)),this._pickedMaterial)){var e=this._scene.materialManager.getModelMaterial(this._pickedMaterial);if(e){var t=e.getDiffuse(),r=function(e){var t=Number(parseInt(e,10));return t>=16?t.toString(16):"0"+t.toString(16)},i="#"+r(255*t[0])+r(255*t[1])+r(255*t[2]);this._viewer.setProgressiveRendering(),this._viewer.notifyEventListener("newMaterialPicked",e,i,e.getTransparent?e.getTransparent():null)}}},t.prototype._onInputStart=function(e,t){var r=this._viewer.isLineRenderingEnabled()?this._scene.getAllDrawables():this._scene.getAllDrawablesWithoutLines(),i=this._pickQuery.pickDrawable(e,t,this._renderer,this._camera,r);if(null===i){if(null===this._hoveringMaterial)return;return this._hoveringMaterial=null,this._viewer.notifyEventListener("nothingSelected"),void this._viewer.setProgressiveRendering()}this._hoveringMaterial!==i.material.name&&(this._hoveringMaterial=i.material.name,this._viewer.notifyEventListener(i.mesh.hasColor()?"textureSelected":"materialSelected"),this._viewer.notifyEventListener("materialHover",i.material),this._viewer.invalidate(10))},t.prototype.getPickedMaterial=function(){return this._pickedMaterial},t.prototype.setSettingEnabled=function(e){this._isSetting=e},t.prototype.setMaterialTexture=function(e,t){var r=this,i=this._getCompatibleMaterialNameOf(e),n=this._scene.materialManager.getModelMaterial(i);if(n&&n.setDiffuseTexture){var a=this._scene.getDrawablesByMaterialName(i);O.a.prototype.setDiffuseTexture.call(n,t,this._resourceManager,a,function(e){r._savedTexture[i]||r._resourceManager.removeTexture(e),r._needUpdate=!0})}else console.warn("There is not material name "+i)},t.prototype.restoreMaterialTexture=function(e){var t=this._getCompatibleMaterialNameOf(e);this._pickedMaterial=null,this._hoveringMaterial=null;var r=this._scene.materialManager.getModelMaterial(t);if(r instanceof V){if(this._savedTexture[e]){var i=this._resourceManager.getTexture(this._savedTexture[t].name);i.ready=!0;var n=this._scene.getDrawablesByMaterialName(t);O.a.prototype.setDiffuseTexture.call(r,i,this._resourceManager,n)}else r.hasTexture&&r.removeDiffuseTexture();r.hasTexture&&(this._savedTextureOption[e]?(r.setTextureOffset(this._savedTextureOption[t].offset),r.setTextureScale(this._savedTextureOption[t].scale),r.setTextureRotate(this._savedTextureOption[t].scale[2])):(r.setTextureOffset(new Float32Array([0,0])),r.setTextureScale([1,1]),r.setTextureRotate(0))),this._savedColors[e]&&(r.setDiffuse(this._savedColors[t]),r.getTransparent&&r.setTransparent(this._savedTransparent[t]),this._needUpdate=!0)}},t.prototype.setMaterialTextureRotate=function(e,t){var r=this._getCompatibleMaterialNameOf(e),i=this._scene.materialManager.getModelMaterial(r);i instanceof V&&(i&&i.setTextureRotate&&i.setTextureRotate(t),this._needUpdate=!0)},t.prototype.setMaterialTextureScale=function(e,t){var r=this._getCompatibleMaterialNameOf(e),i=this._scene.materialManager.getModelMaterial(r);i instanceof V&&(i&&i.setTextureScale&&i.setTextureScale(t),this._needUpdate=!0)},t.prototype.clearPickedMaterial=function(){this._pickedMaterial=null,this._needUpdate=!0},t.prototype.setHoveringMaterial=function(e){var t=this._getCompatibleMaterialNameOf(e);this._settingMaterial=t,this._needUpdate=!0},t.prototype.isInteractive=function(){return this._enabled},t}(Zt.a),fr=function(){function e(e){this._viewer=e,this._isSketchEnabled=!1,this._isSketchColorEnabled=!1}return e.prototype.onFocusElementEnabled=function(e){e?(this._isSketchEnabled=this._viewer.isEffectEnabled("Sketch"),this._viewer.setSketchEnabled(!1)):this._isSketchEnabled&&(this._viewer.setSketchEnabled(this._isSketchEnabled),this._viewer.setSketchColorEnabled(this._isSketchColorEnabled))},e.prototype.onSkechColorEnableChanged=function(e){this._isSketchColorEnabled=e},e.prototype.onSectionChanged=function(e){var t=this._viewer.getTool("ChangeMaterial");t instanceof pr&&(t.recompileShader({section:e}),this._viewer.getRenderer().renderState.invalidateClip())},e.prototype.onAllDrawablesCreated=function(e){var t=this._viewer.getTool("Section"),r=e.initSection;t&&r&&t.recompileSectionShader()},e}();var mr=function(){function e(){}return e.prototype.transform=function(e){if(this.attributes)for(var t=this.attributes.values[0].stride/4,r=this.attributes.hasNormal,i=[0,0,0,0],n=[0,0,0],a=0,o=this.vertices.length;a<o;a+=t)n[0]=this.vertices[a],n[1]=this.vertices[a+1],n[2]=this.vertices[a+2],U.d.transformMat4(i,n,e),this.vertices[a]=i[0],this.vertices[a+1]=i[1],this.vertices[a+2]=i[2],r&&(n[0]=this.vertices[a+3],n[1]=this.vertices[a+4],n[2]=this.vertices[a+5],n[3]=0,U.e.transformMat4(i,n,e),U.d.normalize(i,i),this.vertices[a+3]=i[0],this.vertices[a+4]=i[1],this.vertices[a+5]=i[2])},e.prototype.rotate=function(e,t,r){var i=U.a.create(),n=U.a.create();U.a.rotateZ(i,n,r),U.a.rotateY(n,i,t),U.a.rotateX(i,n,e),this.transform(i)},e.prototype.translate=function(e,t,r){var i=U.a.create();U.a.fromTranslation(i,[e,t,r]),this.transform(i)},e.prototype.scale=function(e,t,r){var i=U.a.create();U.a.fromScaling(i,[e,t,r]),this.transform(i)},e.prototype.merge=function(e,t){if(e.attributes.values[0].stride===t.attributes.values[0].stride){var r,i,n=new Float32Array(e.vertices.length+t.vertices.length);for(r=0;r<e.vertices.length;r++)n[r]=e.vertices[r];for(r=0,i=e.vertices.length;r<t.vertices.length;r++,i++)n[i]=t.vertices[r];var a=new Uint16Array(e.indices.length+t.indices.length);for(r=0;r<e.indices.length;r++)a[r]=e.indices[r];var o=e.vertices.length/(e.attributes.values[0].stride/4);for(r=0,i=e.indices.length;r<t.indices.length;r++,i++)a[i]=t.indices[r]+o;this.vertices=n,this.indices=a,this.attributes=e.attributes,this.indexType=X.a.UNSIGNED_SHORT}},e.prototype.createWiredCube=function(e){void 0===e&&(e=1);var t=new Float32Array(24),r=new Uint8Array(24);t[0]=-e,t[1]=-e,t[2]=-e,t[3]=e,t[4]=-e,t[5]=-e,t[6]=e,t[7]=e,t[8]=-e,t[9]=-e,t[10]=e,t[11]=-e,t[12]=-e,t[13]=-e,t[14]=e,t[15]=e,t[16]=-e,t[17]=e,t[18]=e,t[19]=e,t[20]=e,t[21]=-e,t[22]=e,t[23]=e,r[0]=0,r[1]=1,r[2]=1,r[3]=2,r[4]=2,r[5]=3,r[6]=3,r[7]=0,r[8]=0,r[9]=4,r[10]=1,r[11]=5,r[12]=2,r[13]=6,r[14]=3,r[15]=7,r[16]=4,r[17]=5,r[18]=5,r[19]=6,r[20]=6,r[21]=7,r[22]=7,r[23]=4,this.vertices=t,this.indices=r,this.indexType=X.a.UNSIGNED_BYTE,this.primitive=X.a.LINES,this.attributes=new K,this.attributes.builtin(X.a.FLOAT)},e.prototype.createWiredCubeField=function(e,t){var r,i=new ArrayBuffer(96*e*t),n=new Float32Array(i,0,24*e*t),a=e*t*8;r=a<256?new Uint8Array(24*e*t):a<65536?new Uint16Array(24*e*t):new Uint32Array(24*e*t);for(var o=0,s=0,l=0,u=1/e,c=1/t,h=0;h<e;h++)for(var d=0;d<t;d++){for(var p=u*(h+.5)*2-1,f=c*(d+.5)*2-1,m=0;m<8;m++)n[o]=p,n[o+1]=f,n[o+2]=0,o+=3;r[s+0]=0+l,r[s+1]=1+l,r[s+2]=1+l,r[s+3]=2+l,r[s+4]=2+l,r[s+5]=3+l,r[s+6]=0+l,r[s+7]=3+l,r[s+8]=4+l,r[s+9]=5+l,r[s+10]=5+l,r[s+11]=6+l,r[s+12]=6+l,r[s+13]=7+l,r[s+14]=4+l,r[s+15]=7+l,r[s+16]=0+l,r[s+17]=4+l,r[s+18]=1+l,r[s+19]=5+l,r[s+20]=2+l,r[s+21]=6+l,r[s+22]=3+l,r[s+23]=7+l,l+=8,s+=24}this.vertices=new Uint8Array(i),this.indices=r,this.primitive=X.a.LINES,this.attributes=new K,this.attributes.builtin(X.a.FLOAT),this.indexType=l<256?X.a.UNSIGNED_BYTE:l<65536?X.a.UNSIGNED_SHORT:X.a.UNSIGNED_INT},e.prototype.createSolidCubeField=function(e,t){var r,i=new ArrayBuffer(576*e*t),n=new Float32Array(i,0,144*e*t),a=e*t*24;r=a<256?new Uint8Array(36*e*t):a<65536?new Uint16Array(36*e*t):new Uint32Array(36*e*t);for(var o=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],s=0,l=0,u=0,c=1/e,h=1/t,d=0;d<e;d++)for(var p=0;p<t;p++)for(var f=c*(d+.5)*2-1,m=h*(p+.5)*2-1,_=0;_<6;_++){for(var v=0;v<4;v++)n[s+0]=f,n[s+1]=m,n[s+2]=0,n[s+3]=o[_][0],n[s+4]=o[_][1],n[s+5]=o[_][2],s+=6;_%2==0?(r[l+0]=0+u,r[l+1]=2+u,r[l+2]=1+u,r[l+3]=1+u,r[l+4]=2+u,r[l+5]=3+u):(r[l+0]=0+u,r[l+1]=1+u,r[l+2]=2+u,r[l+3]=2+u,r[l+4]=1+u,r[l+5]=3+u),u+=4,l+=6}this.vertices=new Uint8Array(i),this.indices=r,this.primitive=X.a.TRIANGLES,this.attributes=new K,this.attributes.builtin(X.a.FLOAT,X.a.FLOAT),this.indexType=u<256?X.a.UNSIGNED_BYTE:u<65536?X.a.UNSIGNED_SHORT:X.a.UNSIGNED_INT},e.prototype.createGrid=function(e,t){for(var r=new Float32Array((e+1)*(t+1)*5),i=new Uint32Array(6*e*t),n=0,a=0;a<e+1;a++)for(var o=a/e,s=2*(o-.5),l=0;l<t+1;l++){var u=l/t,c=2*(u-.5);r[0+n]=s,r[1+n]=c,r[2+n]=0,r[3+n]=o,r[4+n]=u,n+=5}var h=0,d=t+1;for(a=1;a<e+1;a++)for(l=0;l<t;l++){var p=[(a-1)*d+l,(a-1)*d+1+l,a*d+l,a*d+1+l];i[0+h]=p[0],i[1+h]=p[1],i[2+h]=p[2],i[3+h]=p[2],i[4+h]=p[1],i[5+h]=p[3],h+=6}this.vertices=r,this.indices=i,this.primitive=X.a.TRIANGLES,this.attributes=new K,this.attributes.builtin(X.a.FLOAT,null,X.a.FLOAT),this.indexType=X.a.UNSIGNED_INT},e.prototype.createSolidCube=function(e){void 0===e&&(e=1);var t,r,i=new Float32Array(144),n=new Uint8Array(36);r=0,i[(t=0)+0]=-e,i[t+1]=-e,i[t+2]=-e,i[t+3]=-1,i[t+4]=0,i[t+5]=0,i[t+6]=-e,i[t+7]=e,i[t+8]=-e,i[t+9]=-1,i[t+10]=0,i[t+11]=0,i[t+12]=-e,i[t+13]=-e,i[t+14]=e,i[t+15]=-1,i[t+16]=0,i[t+17]=0,i[t+18]=-e,i[t+19]=e,i[t+20]=e,i[t+21]=-1,i[t+22]=0,i[t+23]=0,n[r+0]=0,n[r+1]=2,n[r+2]=1,n[r+3]=1,n[r+4]=2,n[r+5]=3,r+=6,i[(t+=24)+0]=e,i[t+1]=-e,i[t+2]=-e,i[t+3]=1,i[t+4]=0,i[t+5]=0,i[t+6]=e,i[t+7]=e,i[t+8]=-e,i[t+9]=1,i[t+10]=0,i[t+11]=0,i[t+12]=e,i[t+13]=-e,i[t+14]=e,i[t+15]=1,i[t+16]=0,i[t+17]=0,i[t+18]=e,i[t+19]=e,i[t+20]=e,i[t+21]=1,i[t+22]=0,i[t+23]=0,n[r+0]=4,n[r+1]=5,n[r+2]=6,n[r+3]=5,n[r+4]=7,n[r+5]=6,r+=6,i[(t+=24)+0]=-e,i[t+1]=-e,i[t+2]=-e,i[t+3]=0,i[t+4]=-1,i[t+5]=0,i[t+6]=e,i[t+7]=-e,i[t+8]=-e,i[t+9]=0,i[t+10]=-1,i[t+11]=0,i[t+12]=-e,i[t+13]=-e,i[t+14]=e,i[t+15]=0,i[t+16]=-1,i[t+17]=0,i[t+18]=e,i[t+19]=-e,i[t+20]=e,i[t+21]=0,i[t+22]=-1,i[t+23]=0,n[r+0]=8,n[r+1]=9,n[r+2]=11,n[r+3]=11,n[r+4]=10,n[r+5]=8,r+=6,i[(t+=24)+0]=-e,i[t+1]=e,i[t+2]=-e,i[t+3]=0,i[t+4]=1,i[t+5]=0,i[t+6]=e,i[t+7]=e,i[t+8]=-e,i[t+9]=0,i[t+10]=1,i[t+11]=0,i[t+12]=-e,i[t+13]=e,i[t+14]=e,i[t+15]=0,i[t+16]=1,i[t+17]=0,i[t+18]=e,i[t+19]=e,i[t+20]=e,i[t+21]=0,i[t+22]=1,i[t+23]=0,n[r+0]=12,n[r+1]=14,n[r+2]=13,n[r+3]=13,n[r+4]=14,n[r+5]=15,r+=6,i[(t+=24)+0]=-e,i[t+1]=-e,i[t+2]=-e,i[t+3]=0,i[t+4]=0,i[t+5]=-1,i[t+6]=e,i[t+7]=-e,i[t+8]=-e,i[t+9]=0,i[t+10]=0,i[t+11]=-1,i[t+12]=-e,i[t+13]=e,i[t+14]=-e,i[t+15]=0,i[t+16]=0,i[t+17]=-1,i[t+18]=e,i[t+19]=e,i[t+20]=-e,i[t+21]=0,i[t+22]=0,i[t+23]=-1,n[r+0]=16,n[r+1]=19,n[r+2]=17,n[r+3]=19,n[r+4]=16,n[r+5]=18,r+=6,i[(t+=24)+0]=-e,i[t+1]=-e,i[t+2]=e,i[t+3]=0,i[t+4]=0,i[t+5]=1,i[t+6]=e,i[t+7]=-e,i[t+8]=e,i[t+9]=0,i[t+10]=0,i[t+11]=1,i[t+12]=-e,i[t+13]=e,i[t+14]=e,i[t+15]=0,i[t+16]=0,i[t+17]=1,i[t+18]=e,i[t+19]=e,i[t+20]=e,i[t+21]=0,i[t+22]=0,i[t+23]=1,n[r+0]=20,n[r+1]=21,n[r+2]=23,n[r+3]=23,n[r+4]=22,n[r+5]=20,this.vertices=i,this.indices=n,this.primitive=X.a.TRIANGLES,this.attributes=new K,this.attributes.builtin(X.a.FLOAT,X.a.FLOAT),this.indexType=X.a.UNSIGNED_BYTE},e.prototype.createTextGrid=function(e){var t,r=4*e.length,i=new Float32Array(5*r);r<256?(t=new Uint8Array(6*e.length),this.indexType=X.a.UNSIGNED_BYTE):r<65536?(t=new Uint16Array(6*e.length),this.indexType=X.a.UNSIGNED_SHORT):(t=new Uint32Array(6*e.length),this.indexType=X.a.UNSIGNED_INT);var n=0,a=0,o=0,s=0;e.forEach(function(e){s+=e.size}),s/=2,e.forEach(function(e,r){i[0+n]=-s+o-e.xoffset,i[1+n]=0,i[2+n]=e.yoffset-.5,i[3+n]=e.x1,i[4+n]=e.y2,i[0+(n+=5)]=-s+e.width+o-e.xoffset,i[1+n]=0,i[2+n]=e.yoffset-.5,i[3+n]=e.x2,i[4+n]=e.y2,i[0+(n+=5)]=-s+e.width+o-e.xoffset,i[1+n]=0,i[2+n]=-e.height+e.yoffset-.5,i[3+n]=e.x2,i[4+n]=e.y1,i[0+(n+=5)]=-s+o-e.xoffset,i[1+n]=0,i[2+n]=-e.height+e.yoffset-.5,i[3+n]=e.x1,i[4+n]=e.y1,n+=5,o+=e.size,t[0+a]=0+4*r,t[1+a]=2+4*r,t[2+a]=1+4*r,t[3+a]=0+4*r,t[4+a]=3+4*r,t[5+a]=2+4*r,a+=6}),this.vertices=i,this.indices=t,this.primitive=X.a.TRIANGLES,this.attributes=new K,this.attributes.builtin(X.a.FLOAT,null,X.a.FLOAT,null)},e.prototype.createQuad=function(e,t,r,i){var n=12,a=3;e&&(n+=8,a+=2),t&&(n+=12,a+=3),i&&(n+=16,a+=4);var o=new Float32Array(n),s=new Uint8Array(6),l=0;if(r?(o[0+l]=1,o[1+l]=0,o[2+l]=1,o[0+(l+=a)]=-1,o[1+l]=0,o[2+l]=1,o[0+(l+=a)]=-1,o[1+l]=0,o[2+l]=-1,o[0+(l+=a)]=1,o[1+l]=0,o[2+l]=-1):(o[0+l]=-1,o[1+l]=-1,o[2+l]=0,o[0+(l+=a)]=1,o[1+l]=-1,o[2+l]=0,o[0+(l+=a)]=1,o[1+l]=1,o[2+l]=0,o[0+(l+=a)]=-1,o[1+l]=1,o[2+l]=0),l=0,t){var u=[0,0,0];r?u[1]=1:u[2]=1;for(var c=0;c<4;c++)o[3+l]=u[0],o[4+l]=u[1],o[5+l]=u[2],l+=a}if(l=0,e){var h=a-2;r?(o[h+l]=1,o[h+1+l]=0,o[h+(l+=a)]=0,o[h+1+l]=0,o[h+(l+=a)]=0,o[h+1+l]=1,o[h+(l+=a)]=1,o[h+1+l]=1):(o[h+l]=0,o[h+1+l]=0,o[h+(l+=a)]=1,o[h+1+l]=0,o[h+(l+=a)]=1,o[h+1+l]=1,o[h+(l+=a)]=0,o[h+1+l]=1)}s[0]=0,s[1]=1,s[2]=2,s[3]=2,s[4]=3,s[5]=0,this.vertices=o,this.indices=s,this.primitive=X.a.TRIANGLES,this.attributes=new K;var d=null,p=null,f=null;t&&(d=X.a.FLOAT),e&&(p=X.a.FLOAT),i&&(f=X.a.FLOAT),this.attributes.builtin(X.a.FLOAT,d,p,f),this.indexType=X.a.UNSIGNED_BYTE},e.prototype.createPoint=function(){var e=new Float32Array(10),t=new Uint16Array(1);e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,t[0]=0,this.vertices=e,this.indices=t,this.primitive=X.a.POINTS,this.attributes=new K,this.attributes.builtin(X.a.FLOAT,null,null,null),this.indexType=X.a.UNSIGNED_SHORT},e.prototype.createSphere=function(e,t){for(var r=new Float32Array((e+1)*(t+1)*8),i=new Uint16Array(6*e*(t+1)),n=new Float32Array(3),a=Math.PI/e,o=2*Math.PI/t,s=0,l=0,u=0,c=0;c<=e;++c)for(var h=Math.sin(c*a),d=Math.cos(c*a),p=0;p<=t;++p){var f=h*Math.cos(p*o),m=h*Math.sin(p*o);r[u++]=f,r[u++]=m,r[u++]=d,n[0]=f,n[1]=m,n[2]=d,U.d.normalize(n,n),r[u++]=n[0],r[u++]=n[1],r[u++]=n[2],r[u++]=p/t,r[u++]=c/e,c!==e&&(i[s++]=l+t+1,i[s++]=l,i[s++]=l+t,i[s++]=l+t+1,i[s++]=l+1,i[s++]=l,l++)}this.vertices=r,this.indices=i,this.attributes=new K,this.attributes.builtin(X.a.FLOAT,X.a.FLOAT,X.a.FLOAT),this.primitive=X.a.TRIANGLES,this.indexType=X.a.UNSIGNED_SHORT},e.prototype.createLine=function(){var e=new Float32Array(6),t=new Uint8Array(2);e[0]=-.5,e[1]=0,e[2]=0,e[3]=.5,e[4]=0,e[5]=0,t[0]=0,t[1]=1,this.vertices=e,this.indices=t,this.attributes=new K,this.attributes.builtin(X.a.FLOAT),this.attributes.primitive=X.a.LINES,this.primitive=X.a.LINES,this.indexType=X.a.UNSIGNED_BYTE},e.prototype.createLineStrip=function(){var e=new Float32Array(6),t=new Uint8Array(2);e[0]=-.5,e[1]=0,e[2]=0,e[3]=.5,e[4]=0,e[5]=0,t[0]=0,t[1]=1,this.vertices=e,this.indices=t,this.attributes=new K,this.attributes.builtin(X.a.FLOAT),this.attributes.primitive=X.a.LINE_STRIP,this.primitive=X.a.LINE_STRIP,this.indexType=X.a.UNSIGNED_BYTE},e.prototype.createArc=function(e,t,r,i){for(var n=new Float32Array(3*(2*i+2)),a=new Uint16Array(2*i*3),o=r/i,s=0,l=[0,0,0],u=0;u<i+1;u++)l[0]=e*Math.sin(s),l[1]=e*Math.cos(s),n[6*u+0]=(e-t)*Math.sin(s),n[6*u+1]=(e-t)*Math.cos(s),n[6*u+2]=0,n[6*u+3]=(e+t)*Math.sin(s),n[6*u+4]=(e+t)*Math.cos(s),n[6*u+5]=0,s+=o;for(u=0;u<i;u++)a[6*u+0]=2*u+0,a[6*u+1]=2*u+1,a[6*u+2]=2*u+3,a[6*u+3]=2*u+0,a[6*u+4]=2*u+3,a[6*u+5]=2*u+2;this.attributes=new K,this.attributes.builtin(X.a.FLOAT),this.primitive=X.a.TRIANGLES,this.indexType=X.a.UNSIGNED_SHORT,this.vertices=n,this.indices=a},e.prototype.createTorus=function(e,t,r,i){var n,a,o=2*Math.PI,s=new Float32Array(i*r*8),l=new Uint16Array(i*r*2*3),u=0,c=[0,0],h=[0,0,0],d=[0,0,0];for(a=0;a<i;a++)for(n=0;n<r;n++){var p=n/r*o,f=a/i*o;c[0]=e*Math.cos(p),c[1]=e*Math.sin(p),h[0]=(e+t*Math.cos(f))*Math.cos(p),h[1]=(e+t*Math.cos(f))*Math.sin(p),h[2]=t*Math.sin(f),U.d.subtract(d,h,c),U.d.normalize(d,d),s[u+0]=h[0],s[u+1]=h[1],s[u+2]=h[2],s[u+3]=d[0],s[u+4]=d[1],s[u+5]=d[2],s[u+6]=n/e,s[u+7]=a/t,u+=8}for(u=0,a=0;a<i;a++)for(n=0;n<r;n++){var m=(n+1)%r,_=(a+1)%i,v=r*a+n,y=r*a+m,g=r*_+n,b=r*_+m;l[u]=v,l[u+1]=g,l[u+2]=y,l[u+3]=g,l[u+4]=b,l[u+5]=y,u+=6}this.vertices=s,this.indices=l,this.attributes=new K,this.attributes.builtin(X.a.FLOAT,X.a.FLOAT,X.a.FLOAT),this.primitive=X.a.TRIANGLES,this.indexType=X.a.UNSIGNED_SHORT},e.prototype.createCone=function(e,t,r){var i,n=2*Math.PI,a=new Float32Array(6*r*3+6),o=new Uint16Array(9*r),s=0,l=[0,0,0],u=e*t*t/(e*e+t*t),c=e*e*t/(e*e+t*t);for(i=0;i<r;i++){var h=i/r*n,d=Math.cos(h),p=Math.sin(h);a[s]=e*d,a[s+1]=e*p,a[s+2]=0,l[0]=u*d,l[1]=u*p,l[2]=c,U.d.normalize(l,l),a[s+3]=l[0],a[s+4]=l[1],a[s+5]=l[2],a[s+=6]=0,a[s+1]=0,a[s+2]=t,a[s+3]=l[0],a[s+4]=l[1],a[s+5]=l[2],a[s+=6]=0,a[s+1]=0,a[s+2]=t,a[s+3]=0,a[s+4]=0,a[s+5]=-1,s+=6}for(a[s+0]=0,a[s+1]=0,a[s+2]=0,s=0,i=0;i<r;i++){var f=(i+1)%r;o[s]=3*i+1,o[s+1]=3*i,o[s+2]=3*f,o[s+3]=3*f,o[s+4]=3*f+1,o[s+5]=3*i+1,s+=6}for(i=0;i<r;i++){f=(i+1)%r;o[s]=3*r,o[s+1]=3*f+2,o[s+2]=3*i+2,s+=3}this.vertices=a,this.indices=o,this.attributes=new K,this.attributes.builtin(X.a.FLOAT,X.a.FLOAT),this.primitive=X.a.TRIANGLES,this.indexType=X.a.UNSIGNED_SHORT},e.prototype.createCylinder=function(e,t,r){var i,n,a=2*Math.PI,o=new Float32Array(6*r*4+6),s=new Uint16Array(12*r),l=0;for(i=0;i<r;i++){var u=i/r*a,c=Math.cos(u),h=Math.sin(u);o[l]=e*c,o[l+1]=e*h,o[l+2]=0,o[l+3]=c,o[l+4]=h,o[l+5]=0,o[l+=6]=e*c,o[l+1]=e*h,o[l+2]=t,o[l+3]=c,o[l+4]=h,o[l+5]=0,o[l+=6]=e*c,o[l+1]=e*h,o[l+2]=0,o[l+3]=0,o[l+4]=0,o[l+5]=-1,o[l+=6]=e*c,o[l+1]=e*h,o[l+2]=t,o[l+3]=0,o[l+4]=0,o[l+5]=1,l+=6}for(o[l+0]=0,o[l+1]=0,o[l+2]=0,o[l+3]=0,o[l+4]=0,o[l+5]=t,l=0,i=0;i<r;i++)n=(i+1)%r,s[l]=4*i+1,s[l+1]=4*i,s[l+2]=4*n,s[l+3]=4*n,s[l+4]=4*n+1,s[l+5]=4*i+1,l+=6;for(i=0;i<r;i++)n=(i+1)%r,s[l]=4*r,s[l+1]=4*n+2,s[l+2]=4*i+2,s[l]=4*r+1,s[l+1]=4*n+3,s[l+2]=4*i+3,l+=6;this.vertices=o,this.indices=s,this.attributes=new K,this.attributes.builtin(X.a.FLOAT,X.a.FLOAT),this.primitive=X.a.TRIANGLES,this.indexType=X.a.UNSIGNED_SHORT},e.prototype.createArrow=function(t,r){var i=new e,n=new e;n.createCone(t,.1*r,8),i.createCylinder(.6*t,.9*r,8),n.translate(0,0,.9*r);var a=new e;a.merge(i,n),this.vertices=a.vertices,this.indices=a.indices,this.attributes=a.attributes,this.indexType=a.indexType,this.primitive=X.a.TRIANGLES},e.prototype.createSharePolygon=function(){var e=new Float32Array(9),t=new Uint8Array(3);e[0]=-.5,e[1]=0,e[2]=0,e[3]=.5,e[4]=0,e[5]=0,e[6]=0,e[7]=.5,e[8]=0,t[0]=0,t[1]=1,t[2]=2,this.vertices=e,this.indices=t,this.attributes=new K,this.attributes.builtin(X.a.FLOAT),this.attributes.primitive=X.a.TRIANGLES,this.primitive=X.a.TRIANGLES,this.indexType=X.a.UNSIGNED_BYTE},e}(),_r=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),vr=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._vao=null,i._vbos=[],i._ibo=null,i._primitive=4,i._type=r.gl.UNSIGNED_INT,i._vboBase=0,i._iboBase=0,i._shared=!1,i._vboBufferName=null,i._iboBufferName=null,i.attributes=null,i.length=0,i.bytes=0,i.indexSize=2,i.bufferIndex=-1,i}return _r(t,e),t.prototype.destroy=function(t){if(void 0===t&&(t=!1),t||(this._ref--,!(this._ref>0))){if(this.ready){var r,i=this._manager.gl;this._shared||(this._vbos.forEach(function(e){i.deleteBuffer(e)}),this._vbos=null,delete this._vbos,i.deleteBuffer(this._ibo),this._ibo=!1,delete this._ibo),this._vao&&(i.deleteVertexArray(this._vao),this._vao=!1,delete this._vao),(r=i.getError())!==i.NO_ERROR&&console.log("GL error in mesh.destroy(): "+r)}this._manager&&this._manager.deleteMesh(this.name),e.prototype.destroy.call(this)}},t.prototype.createShared=function(e,t,r,i,n,a,o){var s=this._manager.gl;this.ready||(this._primitive=e,this.attributes=t,this.bytes=r.byteLength+i.byteLength,this._type=n||s.UNSIGNED_SHORT,this._type===s.UNSIGNED_BYTE?(this.length=i.byteLength,this.indexSize=1):this._type===s.UNSIGNED_INT?(this.length=i.byteLength/4,this.indexSize=4):(this.length=i.byteLength/2,this.indexSize=2),this._vbos[0]=a.buffer,this._ibo=o.buffer,this._vboBufferName=a.name,this._iboBufferName=o.name,(s.isWebGL2||s.vaoExtension)&&(this._vao=s.createVertexArray(),s.bindVertexArray(this._vao),this.attributes.bindBuffer(this._vbos[0],s),s.bindVertexArray(null)),this._shared=!0,this._iboBase=i.byteOffset,this._vboBase=r.byteOffset,this.ready=a.ready&&o.ready)},t.prototype.createSharedPop=function(e,t,r,i,n,a,o,s){if(!this.ready){var l=this._manager.gl;this._primitive=e,this.attributes=t,this._type=a||l.UNSIGNED_SHORT,this._type===l.UNSIGNED_BYTE?this.indexSize=1:this._type===l.UNSIGNED_INT?this.indexSize=4:this.indexSize=2,this.length=n,this._vbos=o,this._ibo=s,(l.isWebGL2||l.vaoExtension)&&(this._vao=l.createVertexArray(),l.bindVertexArray(this._vao),this.attributes.bindVbos(this._vbos,l),l.bindVertexArray(null)),this._shared=!0,this._iboBase=i*this.indexSize,this.ready=!0}},t.prototype.create=function(e,t,r,i,n){if(!this.ready){var a=this._manager.gl;this._vbos[0]=a.createBuffer(),this._ibo=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this._vbos[0]),a.bufferData(a.ARRAY_BUFFER,r,a.STATIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this._ibo),a.bufferData(a.ELEMENT_ARRAY_BUFFER,i,a.STATIC_DRAW),this._primitive=e,this.attributes=t,(a.isWebGL2||a.vaoExtension)&&(this._vao=a.createVertexArray(),a.bindVertexArray(this._vao),this.attributes.bindBuffer(this._vbos[0],a),a.bindVertexArray(null)),this.bytes=r.byteLength+i.byteLength,this._type=n||a.UNSIGNED_SHORT,this._type===a.UNSIGNED_BYTE?(this.length=i.byteLength,this.indexSize=1):this._type===a.UNSIGNED_INT?(this.length=i.byteLength/4,this.indexSize=4):(this.length=i.byteLength/2,this.indexSize=2),a.getError()===a.NO_ERROR?this.ready=!0:(a.deleteBuffer(this._vbos[0]),a.deleteBuffer(this._ibo),this._vao&&a.deleteVertexArray(this._vao))}},t.prototype.createFromBufferObject=function(e,t,r,i,n,a,o){if(!this.ready){var s=this._manager.gl;this._vbos=e,this._ibo=t,this._iboBase=o,this._primitive=i,this.attributes=r,(s.isWebGL2||s.vaoExtension)&&(this._vao=s.createVertexArray(),s.bindVertexArray(this._vao),this.attributes.bindBuffers(this._vbos,s),s.bindVertexArray(null)),this._type=n,this.length=a,s.getError()===s.NO_ERROR?this.ready=!0:(this._vbos.forEach(function(e){s.deleteBuffer(e)}),s.deleteBuffer(this._ibo),this._vao&&s.deleteVertexArray(this._vao))}},t.prototype.createWiredCube=function(e){if(void 0===e&&(e=1),!this.ready){var t=new mr;t.createWiredCube(e),this.create(t.primitive,t.attributes,t.vertices,t.indices,t.indexType)}},t.prototype.createArrow=function(e,t){if(!this.ready){var r=new mr;r.createArrow(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}},t.prototype.createSolidCube=function(e){if(void 0===e&&(e=1),!this.ready){var t=new mr;t.createSolidCube(e),this.create(t.primitive,t.attributes,t.vertices,t.indices,t.indexType)}},t.prototype.createWiredCubeField=function(e,t){if(!this.ready){var r=new mr;r.createWiredCubeField(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}},t.prototype.createSolidCubeField=function(e,t){if(!this.ready){var r=new mr;r.createSolidCubeField(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}},t.prototype.createGrid=function(e,t){if(!this.ready){var r=new mr;r.createGrid(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}},t.prototype.createTextGrid=function(e){if(!this.ready){var t=new mr;t.createTextGrid(e),this.create(t.primitive,t.attributes,t.vertices,t.indices,t.indexType)}},t.prototype.createQuad=function(e,t,r,i){if(void 0===e&&(e=!0),void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),!this.ready){var n=new mr;n.createQuad(e,t,r,i),this.create(n.primitive,n.attributes,n.vertices,n.indices,n.indexType)}},t.prototype.createPoint=function(){if(!this.ready){var e=new mr;e.createPoint(),this.create(e.primitive,e.attributes,e.vertices,e.indices,e.indexType)}},t.prototype.createSphere=function(e,t){if(!this.ready){var r=new mr;r.createSphere(e,t),this.create(r.primitive,r.attributes,r.vertices,r.indices,r.indexType)}},t.prototype.createLine=function(){if(!this.ready){var e=new mr;e.createLine(),this.create(e.primitive,e.attributes,e.vertices,e.indices,e.indexType)}},t.prototype.createLineStrip=function(){if(!this.ready){var e=new mr;e.createLineStrip(),this.create(e.primitive,e.attributes,e.vertices,e.indices,e.indexType)}},t.prototype.createSharePolygon=function(){if(!this.ready){var e=new mr;e.createSharePolygon(),this.create(e.primitive,e.attributes,e.vertices,e.indices,e.indexType)}},t.prototype.createArc=function(e,t,r,i){if(!this.ready){var n=new mr;n.createArc(e,t,r,i),this.create(n.primitive,n.attributes,n.vertices,n.indices,n.indexType)}},t.prototype.createTorus=function(e,t,r,i){if(!this.ready){var n=new mr;n.createTorus(e,t,r,i),this.create(n.primitive,n.attributes,n.vertices,n.indices,n.indexType)}},t.prototype.render=function(){this._manager.gl.drawElements(this._primitive,this.length,this._type,this._iboBase)},t.prototype.renderSub=function(e,t){this._manager.gl.drawElements(this._primitive,t,this._type,e+this._iboBase)},t.prototype.renderInstanced=function(e){this._manager.gl.drawElementsInstanced(this._primitive,this.length,this._type,this._iboBase,e)},t.prototype.use=function(){if(this.ready){var e=this._manager.gl;this._vao?e.bindVertexArray(this._vao):this.attributes.bind(this._vbos,e),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._ibo)}else console.error("mesh "+this.name+" is not ready.")},t.prototype.update=function(e,t,r){var i=this._manager.gl;this.ready&&(i.deleteBuffer(this._vbos[0]),i.deleteBuffer(this._ibo),this._vao&&i.deleteVertexArray(this._vao),this._vbos=[i.createBuffer()],this._ibo=i.createBuffer(),this._vboBase=0,this._iboBase=0,i.bindBuffer(i.ARRAY_BUFFER,this._vbos[0]),i.bufferData(i.ARRAY_BUFFER,e,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._ibo),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t,i.STATIC_DRAW),(i.isWebGL2||i.vaoExtension)&&(this._vao=i.createVertexArray(),i.bindVertexArray(this._vao),this.attributes.bindBuffer(this._vbos[0],i),i.bindVertexArray(null)),i.getError()!==i.NO_ERROR&&(this.ready=!1),this._type=r||i.UNSIGNED_SHORT,this._type===i.UNSIGNED_BYTE?this.length=t.byteLength:this._type===i.UNSIGNED_SHORT?this.length=t.byteLength/2:this._type===i.UNSIGNED_INT&&(this.length=t.byteLength/4),this.bytes=e.byteLength+t.byteLength)},t.prototype.isTriangle=function(){return this._primitive>=this._manager.gl.TRIANGLES},t.prototype.isLine=function(){var e=this._manager.gl;return this._primitive===e.LINES||this._primitive===e.LINE_LOOP||this._primitive==e.LINE_STRIP},t.prototype.hasColor=function(){return this.attributes.hasColor},t.prototype.slice=function(e){var t=this._manager.gl;if(!t.isWebGL2)return console.error("createSubMesh is only supported in WebGL2"),this;for(var r=0,i=0,n=0,a=e.length;n<a;n++)r+=e[n].verticesBytes,i+=e[n].indicesBytes;var o=this._manager.getMesh((parseFloat(this.name)+Math.random()).toString());o._vbos=t.createBuffer(),o._ibo=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,o._vbos),t.bufferData(t.ARRAY_BUFFER,new Uint8Array(r),t.STATIC_DRAW);var s=0;t.bindBuffer(t.COPY_READ_BUFFER,this._vbos);for(n=0,a=e.length;n<a;n++)t.copyBufferSubData(t.COPY_READ_BUFFER,t.ARRAY_BUFFER,this._vboBase+e[n].verticesOffset,s,e[n].verticesBytes),s+=e[n].verticesBytes;var l=null,u=null;switch(this.indexSize){case 2:l=new Uint16Array(this.length),u=new Uint16Array(i/2);break;case 1:l=new Uint8Array(this.length),u=new Uint8Array(i);break;case 4:l=new Uint32Array(this.length),u=new Uint32Array(i/4)}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._ibo),t.getBufferSubData(t.ELEMENT_ARRAY_BUFFER,this._iboBase,l);var c=0,h=0;for(n=0,a=e.length;n<a;n++){for(var d=e[n].verticesOffset/this.attributes.values[0].stride,p=e[n].indicesBytes/this.indexSize,f=e[n].indicesOffset/this.indexSize,m=0;m<p;m++)u[m+c]=l[m+f]-d+h;c+=p,h+=e[n].verticesBytes/this.attributes.values[0].stride}return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o._ibo),t.bufferData(t.ELEMENT_ARRAY_BUFFER,u,t.STATIC_DRAW),o._primitive=this._primitive,o.attributes=this.attributes,(t.isWebGL2||t.vaoExtension)&&(o._vao=t.createVertexArray(),t.bindVertexArray(o._vao),o.attributes.bindBuffer(o._vbos[0],t),t.bindVertexArray(null)),o.bytes=i+r,o._type=this._type,o.indexSize=this.indexSize,o.length=i/o.indexSize,t.getError()===t.NO_ERROR?o.ready=!0:(t.deleteBuffer(o._vbos[0]),t.deleteBuffer(o._ibo),o._vao&&t.deleteVertexArray(o._vao)),o},t.prototype.ibSubData=function(e,t){var r=this._manager.gl;this.ready=!1,r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this._ibo),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,this._iboBase+e,t),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),r.getError()===r.NO_ERROR?this.ready=!0:(r.deleteBuffer(this._ibo),r.deleteBuffer(this._vbos[0]),this._vao&&(r.deleteVertexArray(this._vao),this._vao=!1,delete this._vao))},t.prototype.vbSubData=function(e,t){var r=this._manager.gl;this.ready=!1,r.bindBuffer(r.ARRAY_BUFFER,this._vbos[0]),r.bufferSubData(r.ARRAY_BUFFER,this._vboBase+e,t),r.bindBuffer(r.ARRAY_BUFFER,null),r.getError()===r.NO_ERROR?this.ready=!0:(r.deleteBuffer(this._ibo),r.deleteBuffer(this._vbos[0]),this._vao&&(r.deleteVertexArray(this._vao),this._vao=!1,delete this._vao))},t.prototype.getVBSubData=function(e,t){var r=this._manager.gl;r.bindBuffer(r.ARRAY_BUFFER,this._vbos[0]),r.getBufferSubData(r.ARRAY_BUFFER,this._vboBase+e,t),r.bindBuffer(r.ARRAY_BUFFER,null)},t.prototype.getIBSubData=function(e,t){var r=this._manager.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this._ibo),r.getBufferSubData(r.ELEMENT_ARRAY_BUFFER,this._iboBase+e,t),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null)},t.prototype.setBufferIndex=function(e){this.bufferIndex=e},t.prototype.destroyBuffer=function(e){if(this._vboBufferName||this._iboBufferName){var t=e.gl,r=e.getBuffer(this._vboBufferName),i=e.getBuffer(this._iboBufferName);this._vbos[0]&&r.buffer&&r.pause(),this._ibo&&i.buffer&&i.pause(),(t.isWebGL2||t.vaoExtension)&&this._vao&&(t.bindVertexArray(null),t.deleteVertexArray(this._vao)),this._vao=null,this._vbos=null,this._ibo=null}},t.prototype.restoreBuffer=function(e){if(this._vboBufferName||this._iboBufferName){var t=e.gl,r=e.getBuffer(this._vboBufferName),i=e.getBuffer(this._iboBufferName);this._vbos&&t.deleteBuffer(this._vbos[0]),this._ibo&&t.deleteBuffer(this._ibo),this._vao&&t.deleteVertexArray(this._vao),r.restart(),i.restart(),this._vbos=[],this._vbos[0]=r.buffer,this._ibo=i.buffer,(t.isWebGL2||t.vaoExtension)&&(this._vao=t.createVertexArray(),t.bindVertexArray(this._vao),this.attributes.bindBuffer(this._vbos[0],t),t.bindVertexArray(null)),t.getError()!==t.NO_ERROR?this.ready=!1:this.ready=!0}},t.prototype.getIndexType=function(){return this._type},t}(Ne.a),yr=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),gr=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},br=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},wr=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._framebuffer=null,i._colorBuffers=[],i._depthBuffer=null,i}return yr(t,e),t.prototype._bufferNotReady=function(e,t){for(var r=0;r<e.length;r++)if(!e[r].ready)return!0;return!(!t||t.ready)},t.prototype._alreadyCreated=function(){return this.ready},t.prototype._dumpBasicInfo=function(e,t){console.log("FrameBuffer.create: "+this.name),e.forEach(function(e){return console.log("colorBuffer: "+e.name)}),t&&console.log("depthBuffer: "+t.name)},t.prototype._storeBuffers=function(e,t){a.a.isArray(e)||(e=[e]),this._colorBuffers=e,this._depthBuffer=t},t.prototype._createGLFramebuffer=function(){var e=this._manager.gl;this._framebuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),this._framebuffer.__SPECTOR_Metadata={name:this.name,colorBuffer:this._colorBuffers.map(function(e){return e.name}).join(),depthBuffer:this._depthBuffer.name}},t.prototype._attachColorBuffer=function(e,t){var r=this._manager.gl;e._rbo?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0_WEBGL+t,r.RENDERBUFFER,e._texture):r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0_WEBGL+t,r.TEXTURE_2D,e._texture,0)},t.prototype._attachColorBuffers=function(){var e,t,r=this._manager.gl;if(r.isWebGL2||r.drawBuffers){var i=0,n=[];try{for(var a=gr(this._colorBuffers),o=a.next();!o.done;o=a.next()){var s=o.value;this._attachColorBuffer(s,i),n.push(r.COLOR_ATTACHMENT0_WEBGL+i),i++}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}r.drawBuffers(n)}else this._attachColorBuffer(this._colorBuffers[0],0)},t.prototype._attachDepthBuffer=function(){var e=this._manager.gl;if(this._depthBuffer){var t=this._depthBuffer._rbo,r=this._depthBuffer._format===e.DEPTH_COMPONENT?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;t?e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,this._depthBuffer._texture):e.framebufferTexture2D(e.FRAMEBUFFER,r,e.TEXTURE_2D,this._depthBuffer._texture,0)}else e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0)},t.prototype.create=function(e,t){this._alreadyCreated()||this._bufferNotReady(e,t)||(this._storeBuffers(e,t),this._createGLFramebuffer(),this._attachColorBuffers(),this._attachDepthBuffer(),this._checkCompleteness())},t.prototype._destroy=function(){var e,t=this._manager.gl;if(this.ready){t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,null,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,null,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,null),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,null);for(var r=0,i=t.isWebGL2||t.drawBuffers?this._colorBuffers.length:1;r<i;r++)t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0_WEBGL+r,t.TEXTURE_2D,null,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0_WEBGL+r,t.RENDERBUFFER,null);t.deleteFramebuffer(this._framebuffer),delete this._framebuffer}(e=t.getError())!==t.NO_ERROR&&console.log("GL error in framebuffer._destroy(): "+e)},t.prototype.destroy=function(t){void 0===t&&(t=!1),!t&&(this._ref--,this._ref>0)||(this.ready&&this._destroy(),this._manager&&this._manager.deleteFramebuffer(this.name),e.prototype.destroy.call(this))},t.prototype._notReady=function(){return!this.ready},t.prototype._sizeChanged=function(e,t){return e!==this.getWidth()||t!==this.getHeight()},t.prototype._limitMaxSize=function(e,t){return(e>4096||t>4096)&&(e>=t?(t=Math.floor(4096*t/e),e=4096):(e=Math.floor(4096*e/t),t=4096)),[e,t]},t.prototype._resizeColorBuffers=function(e,t){var r,i;try{for(var n=gr(this._colorBuffers),a=n.next();!a.done;a=n.next()){var o=a.value;if(o.resize(e,t),!o.ready)return this.destroy(),!1}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}return!0},t.prototype._resizeDepthBuffer=function(e,t){return this._depthBuffer.resize(e,t),!!this._depthBuffer.ready||(this.destroy(),!1)},t.prototype._rebindFrameBuffer=function(){var e=this._manager.gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)},t.prototype._reattachColorBuffers=function(){this._attachColorBuffers()},t.prototype._reattachDepthBuffer=function(){this._attachDepthBuffer()},t.prototype.resize=function(e,t){var r;return this.ready||(console.warn(" FBO named "+this.name+" is restore beffore resize"),this.restore()),e=(r=br(this._limitMaxSize(e,t),2))[0],t=r[1],this._rebindFrameBuffer(),this._resizeColorBuffers(e,t),this._resizeDepthBuffer(e,t),this._reattachColorBuffers(),this._reattachDepthBuffer(),this._checkCompleteness()},t.prototype._checkCompleteness=function(){var e=this._manager.gl,t=e.checkFramebufferStatus(e.FRAMEBUFFER);switch(this.ready=!1,t){case e.FRAMEBUFFER_COMPLETE:return this.ready=!0,!0;case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.warn("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.warn("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case e.FRAMEBUFFER_UNSUPPORTED:console.warn("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.warn("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;default:console.warn("Incomplete framebuffer: "+t)}return!1},t.prototype.getWidth=function(){return this.ready?this._colorBuffers[0].width:-1},t.prototype.getHeight=function(){return this.ready?this._colorBuffers[0].height:-1},t.prototype.use=function(){var e=this._manager.gl;this.ready?e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer):console.error("framebuffer "+this.name+" is not ready.")},t.prototype.getColorBufferNumber=function(){return this.ready?this._colorBuffers.length:null},t.prototype.getColorBuffer=function(e){return void 0===e&&(e=0),this.ready&&e<this._colorBuffers.length?this._colorBuffers[e]:null},t.prototype.getDepthBuffer=function(){return this.ready?this._depthBuffer:null},t.prototype.discard=function(){var e=this._manager.gl;if(this.ready){this._depthBuffer&&this._depthBuffer.discard();for(var t=0,r=this._colorBuffers.length;t<r;t++)this._colorBuffers[t].discard();e.deleteFramebuffer(this._framebuffer),this._framebuffer=null,this.ready=!1,console.log("frame buffer named "+this.name+" is discard")}},t.prototype.restore=function(){var e=this._manager.gl;if(!this.ready){if(!this._depthBuffer&&this._colorBuffers.length<1)return;this._depthBuffer&&this._depthBuffer.restore();for(var t=0,r=this._colorBuffers.length;t<r;t++)this._colorBuffers[t].restore();for(t=0,r=this._colorBuffers.length;t<r;t++)if(!this._colorBuffers[t].ready)return void console.warn("color buffer"+this._colorBuffers[t].name+"not ready");if(this._depthBuffer&&!this._depthBuffer.ready)return void console.warn("depth buffer"+this._depthBuffer.name+"not ready");this._framebuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer);var i=[];for(t=0,r=e.isWebGL2||e.drawBuffers?this._colorBuffers.length:1;t<r;t++)this._colorBuffers[t]._rbo?e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0_WEBGL+t,e.RENDERBUFFER,this._colorBuffers[t]._texture,0):e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0_WEBGL+t,e.TEXTURE_2D,this._colorBuffers[t]._texture,0),i.push(e.COLOR_ATTACHMENT0_WEBGL+t);(e.isWebGL2||e.drawBuffers)&&e.drawBuffers(i),this._depthBuffer?this._depthBuffer._rbo?this._depthBuffer._format===e.DEPTH_COMPONENT?e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this._depthBuffer._texture):e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this._depthBuffer._texture):this._depthBuffer._format===e.DEPTH_COMPONENT?e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this._depthBuffer._texture,0):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,this._depthBuffer._texture,0):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0),this._checkCompleteness()?console.log("frame buffer named "+this.name+" is restore success"):console.log("frame buffer named "+this.name+" is restore error")}},t.prototype.copy=function(e,t){if(this.name!==e.name){var r=this._manager.gl;if(r.isWebGL2){var i=this._colorBuffers[0].width,n=this._colorBuffers[0].height,a=r.getParameter(r.DRAW_FRAMEBUFFER_BINDING);r.bindFramebuffer(r.READ_FRAMEBUFFER,e._framebuffer),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this._framebuffer),r.blitFramebuffer(0,0,i,n,0,0,i,n,t,r.NEAREST),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,a)}else console.warn("Framebuffer.copy() only gets supported in WebGL 2.0 context.")}},t}(Ne.a),xr=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Mr=function(){function e(e){this.loc=e,this.upload=null}return e.prototype.initialize=function(e,t,r){this.uniforms=new Map;var i=r.getUniformBlockIndex(t,e);r.uniformBlockBinding(t,i,this.loc);var n=r.getActiveUniformBlockParameter(t,i,r.UNIFORM_BLOCK_DATA_SIZE);this.blockSize=0;for(var a=r.getActiveUniformBlockParameter(t,i,r.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES),o=0,s=a.length;o<s;o++){var l=r.getActiveUniform(t,a[o]),u=l.name.replace(/[_\w]+./,"");switch(this.uniforms[u]={type:l.type,size:l.size},l.type){case r.INT:case r.FLOAT:this.blockSize+=4*l.size;break;case r.INT_VEC2:case r.FLOAT_VEC2:this.blockSize+=8*l.size;break;case r.INT_VEC3:case r.FLOAT_VEC3:this.blockSize+=12*l.size;break;case r.INT_VEC4:case r.FLOAT_VEC4:this.blockSize+=16*l.size;break;case r.FLOAT_MAT4:this.blockSize+=64*l.size;break;case r.FLOAT_MAT3:this.blockSize+=48*l.size}}this.blockSize!==n&&console.warn("uniform block "+e+" has packing problem!"),r.isWebGL2&&(this.blockBuffer=null,this.blockBuffer=r.createBuffer(),r.bindBuffer(r.UNIFORM_BUFFER,this.blockBuffer),Tr=new Float32Array(this.blockSize),r.bufferData(r.UNIFORM_BUFFER,Tr,r.DYNAMIC_DRAW),r.bindBuffer(r.UNIFORM_BUFFER,null))},e.prototype.destroy=function(){this.uniforms=null,delete this.uniforms},e.prototype.UniformUpload1fv=function(e,t){t.uniform1fv(this.loc,e)},e.prototype.UniformUpload1f=function(e,t){t.uniform1f(this.loc,e)},e.prototype.UniformUpload2f=function(e,t){t.uniform2fv(this.loc,e)},e.prototype.UniformUpload3f=function(e,t){t.uniform3fv(this.loc,e)},e.prototype.UniformUpload4f=function(e,t){t.uniform4fv(this.loc,e)},e.prototype.UniformUpload1b=function(e,t){t.uniform1i(this.loc,e?1:0)},e.prototype.UniformUpload1i=function(e,t){t.uniform1i(this.loc,e)},e.prototype.UniformUpload2i=function(e,t){t.uniform2i(this.loc,e[0],e[1])},e.prototype.UniformUpload3i=function(e,t){t.uniform3i(this.loc,e[0],e[1],e[2])},e.prototype.UniformUpload4i=function(e,t){t.uniform4i(this.loc,e[0],e[1],e[2],e[3])},e.prototype.UniformUploadMat4=function(e,t){t.uniformMatrix4fv(this.loc,!1,e)},e.prototype.UniformUploadMat3=function(e,t){t.uniformMatrix3fv(this.loc,!1,e)},e.prototype.UniformBlockUpload=function(e,t){t.bindBufferBase(t.UNIFORM_BUFFER,this.loc,this.blockBuffer),t.bindBuffer(t.UNIFORM_BUFFER,this.blockBuffer),t.bufferSubData(t.UNIFORM_BUFFER,0,e,0,e.byteLength/4),t.bindBuffer(t.UNIFORM_BUFFER,null)},e}(),Tr=null,Er=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._program=null,i.reservedUniforms={},i.userUniforms={},i.shaderSource=null,i.flags=[],i.attributes={},i}return xr(t,e),t.prototype.destroy=function(t){if(void 0===t&&(t=!1),t||(this._ref--,!(this._ref>0))){if(this.ready){for(var r,i=this._manager.gl,n=0,a=this.reservedUniforms.length;n<a;n++)this.reservedUniforms[n].destroy();this.reservedUniforms=null,delete this.reservedUniforms;for(n=0,a=this.userUniforms.length;n<a;n++)this.userUniforms[n].destroy();this.userUniforms=null,delete this.userUniforms,this.shaderSource=null,delete this.shaderSource,this.attributes=null,delete this.attributes,i.deleteProgram(this._program),delete this._program,(r=i.getError())!==i.NO_ERROR&&console.log("GL error in shader.destroy(): "+r)}this._manager&&this._manager.deleteShader(this.name),e.prototype.destroy.call(this)}},t.prototype.createFromSource=function(e,t,r){this._manager.gl;if(!this.ready){this.flags=r?r.slice(0):[];var i=this._preprocess(e,r),n=this._preprocess(t,r);this._compile(i,n)}},t.prototype._preprocess=function(e,t){var r,i,n,o,s,l,u=[!0],c=!0,h=e.split("\n"),d=[];for(r=0,n=h.length;r<n;r++){var p=h[r];if(""!==p)if("#"===p[0]&&"v"!==p[1]){if("i"===p[1]&&"f"===p[2]){c=!0;var f=p.substr(4).replace(/^\s+|\s+$/g,"");if(s=null,-1!==f.indexOf("||"))for(c=!1,i=0,o=(s=f.split("||")).length;i<o;i++){var m=s[i].replace(/^\s+|\s+$/g,"");l=!1,"!"===m[0]&&(l=!0,m=m.substring(1)),-1!==a.a.indexOf(t,m)&&(c=!l)}else if(-1!==f.indexOf("&&")){for(c=!0,i=0,o=(s=f.split("&&")).length;i<o;i++)if("!"===(m=s[i].replace(/^\s+|\s+$/g,""))[0]){if(m=m.substring(1),-1!==a.a.indexOf(t,m)){c=!1;break}}else if(-1===a.a.indexOf(t,m)){c=!1;break}}else l=!1,"!"===f[0]&&(l=!0,f=f.substring(1)),c=-1!==a.a.indexOf(t,f)?!l:l;u.push(c)}else"e"===p[1]&&"l"===p[2]&&"s"===p[3]&&"e"===p[4]?u[u.length-1]=!u[u.length-1]:"e"===p[1]&&"n"===p[2]&&"d"===p[3]&&"i"===p[4]&&"f"===p[5]&&u.pop();for(c=!0,i=0,o=u.length;i<o&&(c=u[i]&&c);++i);}else c&&d.push(p)}return d.join("\n")},t.prototype.createFromShaderSource=function(e,t){var r=this._manager.gl;this.ready||(t=t||[],r.isWebGL2&&-1===t.indexOf("WEBGL2")&&t.push("WEBGL2"),this.shaderSource=e,this.shaderSource.ready?this.createFromSource(e.vsSource,e.fsSource,t):console.warn(name+"'s source is not ready"))},t.prototype._compile=function(e,t){var r=this._manager.gl;if(!this.ready){this.ready=!1,this._program&&r.deleteProgram(this._program),this._program=r.createProgram();var i=r.createShader(r.VERTEX_SHADER),n=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(i,e),r.compileShader(i),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(i,r.COMPILE_STATUS)){var a="failed to compile vertex shader "+this.name+"\n\n"+r.getShaderInfoLog(i);return console.log(e),console.error(a),r.deleteProgram(this._program),void r.deleteShader(i)}if(!r.getShaderParameter(n,r.COMPILE_STATUS)){a="failed to compile fragment shader "+this.name+"\n\n"+r.getShaderInfoLog(n);return console.log(t),console.error(a),r.deleteProgram(this._program),void r.deleteShader(n)}if(r.attachShader(this._program,i),r.attachShader(this._program,n),r.bindAttribLocation(this._program,0,"m_aPosition"),r.bindAttribLocation(this._program,1,"m_aNormal0"),r.bindAttribLocation(this._program,2,"m_aNormal1"),r.bindAttribLocation(this._program,3,"m_aNormal2"),r.bindAttribLocation(this._program,4,"m_aTexCoord"),r.bindAttribLocation(this._program,5,"m_aColor"),r.bindAttribLocation(this._program,6,"m_aMaterial"),r.bindAttribLocation(this._program,7,"m_aTangent"),r.bindAttribLocation(this._program,8,"m_aJoint0"),r.bindAttribLocation(this._program,9,"m_aWeight0"),r.bindAttribLocation(this._program,10,"m_aModelMatrix"),r.linkProgram(this._program),r.deleteShader(i),r.deleteShader(n),r.getError()===r.NO_ERROR){if(!r.getProgramParameter(this._program,r.LINK_STATUS)){var o=r.getProgramInfoLog(this._program);return console.log("%s linking error:\n"+o,this.name),void r.deleteProgram(this._program)}this.ready=!0;var s,l=r.getProgramParameter(this._program,r.ACTIVE_ATTRIBUTES);for(s=0;s<l;++s){var u=r.getActiveAttrib(this._program,s);this.attributes[u.name]=s}var c=r.getProgramParameter(this._program,r.ACTIVE_UNIFORMS);for(s=0;s<c;++s){var h=r.getActiveUniform(this._program,s),d=r.getUniformLocation(this._program,h.name),p=new Mr(d);if("m"===h.name[0]&&"_"===h.name[1]){if(null===d&&r.isWebGL2)continue;this.reservedUniforms[h.name]=p}else this.userUniforms[h.name]=p;switch(h.type){case r.FLOAT:h.size>1?p.upload=p.UniformUpload1fv:p.upload=p.UniformUpload1f;break;case r.FLOAT_VEC2:p.upload=p.UniformUpload2f;break;case r.FLOAT_VEC3:p.upload=p.UniformUpload3f;break;case r.FLOAT_VEC4:p.upload=p.UniformUpload4f;break;case r.BOOL:p.upload=p.UniformUpload1b;break;case r.INT:case r.SAMPLER_2D:case r.SAMPLER_CUBE:p.upload=p.UniformUpload1i;break;case r.INT_VEC2:case r.BOOL_VEC2:p.upload=p.UniformUpload2i;break;case r.INT_VEC3:case r.BOOL_VEC3:p.upload=p.UniformUpload3i;break;case r.INT_VEC4:case r.BOOL_VEC4:p.upload=p.UniformUpload4i;break;case r.FLOAT_MAT4:p.upload=p.UniformUploadMat4;break;case r.FLOAT_MAT3:p.upload=p.UniformUploadMat3;break;default:console.error("unsupported shader uniform type for "+h.name)}}if(r.isWebGL2)for(var f=r.getProgramParameter(this._program,r.ACTIVE_UNIFORM_BLOCKS),m=0;m<f;m++){var _=r.getActiveUniformBlockName(this._program,m),v=void 0;"m"===_[0]&&"_"===_[1]?((v=new Mr(m)).initialize(_,this._program,r),v.upload=v.UniformBlockUpload,_=_.replace(/m_b/,"m_u"),this.reservedUniforms[_]=v):((v=new Mr(m)).initialize(_,this._program,r),v.upload=v.UniformBlockUpload,this.userUniforms[_]=v)}}else r.deleteProgram(this._program)}},t.prototype.use=function(){this.ready?this._manager.gl.useProgram(this._program):console.error("shader "+this.name+" is not ready.")},t.prototype.usePlatte=function(){return-1!==this.flags.lastIndexOf("USE_PLATTE")},t}(Ne.a),Sr=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ar=function(e){function t(t,r){var i=e.call(this,t,r)||this,n=r.gl;return i._target=n.ARRAY_BUFFER,i.buffer=n.createBuffer(),i}return Sr(t,e),t.prototype.destroy=function(t){if(void 0===t&&(t=!1),t||(this._ref--,!(this._ref>0))){if(null!==this.buffer)this._manager.gl.deleteBuffer(this.buffer),this.buffer=null,delete this.buffer;this.ready&&this._manager&&(this._manager.deleteBuffer(this.name),this._manager=null),e.prototype.destroy.call(this)}},t.prototype.create=function(e,t,r,i,n){if(!this.ready){var a=this._manager.gl;this._target=e,this.offset=void 0!==r?r:-1,this.meshBufferIndex=void 0!==i?i:-1,this.bufferType=void 0!==n?n:-1,a.bindBuffer(e,this.buffer),a.bufferData(e,t,a.STATIC_DRAW),a.getError()===a.NO_ERROR?this.ready=!0:(a.deleteBuffer(this.buffer),this.buffer=null,this.ready=!1)}},t.prototype.update=function(e,t,r,i){var n=this._manager.gl;this.offset=void 0!==t?t:-1,this.meshBufferIndex=void 0!==r?r:-1,this.bufferType=void 0!==i?i:-1,n.bindBuffer(this._target,this.buffer),n.bufferData(this._target,e,n.STATIC_DRAW),n.getError()===n.NO_ERROR?this.ready=!0:(n.deleteBuffer(this.buffer),this.buffer=null,this.ready=!1)},t.prototype.pause=function(){var e=this._manager.gl;null!==this.buffer&&e.deleteBuffer(this.buffer),this.buffer=null,this.ready&&(this.ready=!1)},t.prototype.restart=function(){var e=this._manager.gl;if(!this.buffer||!this.ready){var t=this._manager.getSourceDatas(),r=null;0===this.bufferType?r=t.vertexs.get(this.meshBufferIndex):1===this.bufferType&&(r=t.indexs.get(this.meshBufferIndex)),e.bindBuffer(this._target,null),this.buffer=e.createBuffer(),e.bindBuffer(this._target,this.buffer),e.bufferData(this._target,r,e.STATIC_DRAW),e.getError()===e.NO_ERROR?this.ready=!0:this.ready=!1}},t}(Ne.a),kr=function(){function e(e){this._shaders=new Map,this._meshes=new Map,this._textures=new Map,this._framebuffers=new Map,this._buffers=new Map,this._attributes=new Map,this._sourceVertex=new Map,this._soucreIndex=new Map,this._sourceTexture=new Map,this.gl=e,this.gl||console.error("ResourceManager requires a valid gl context."),this._framebuffers.set("default",{ready:!0,manager:null,_name:"default",_framebuffer:null,_width:1,_height:1,destroy:function(){},use:function(){e.bindFramebuffer(e.FRAMEBUFFER,null)},resize:function(e,t){this._width=e,this._height=t},discard:function(){},restore:function(){},getWidth:function(){return this._width},getHeight:function(){return this._height},ref:function(){},copy:function(t,r){if(this._name!==t._name&&e.isWebGL2){var i=t._colorBuffers[0].width,n=t._colorBuffers[0].height,a=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.READ_FRAMEBUFFER,t._framebuffer),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.blitFramebuffer(0,0,i,n,0,0,i,n,r,e.NEAREST),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,a)}}})}return e.prototype.destroy=function(){this._meshes.forEach(function(e,t){e.destroy(!0)}),this._framebuffers.forEach(function(e,t){e.destroy(!0)}),this._textures.forEach(function(e,t){e.destroy(!0)}),this._shaders.forEach(function(e,t){e.destroy(!0)}),this._buffers.forEach(function(e,t){e.destroy(!0)}),this._textures=null,this._meshes=null,this._framebuffers=null,this._buffers=null,this._shaders=null,this._soucreIndex=null,this._sourceVertex=null,this._sourceTexture=null,delete this._textures,delete this._meshes,delete this._framebuffers,delete this._shaders,delete this._buffers,delete this._soucreIndex,delete this._sourceVertex,delete this._sourceTexture},e.prototype.getTexture=function(e){this._textures&&!this._textures.has(e)&&this._textures.set(e,new D.a(e,this));var t=this._textures.get(e);return t.ref(),t},e.prototype.removeTexture=function(e){this._textures.has(e)&&this._textures.get(e).destroy()},e.prototype.renameTexture=function(e,t){this._textures&&this._textures.has(e)&&(this._textures.set(t,this._textures.get(e)),this._textures.delete(e))},e.prototype.getFramebuffer=function(e){this._framebuffers.has(e)||this._framebuffers.set(e,new wr(e,this));var t=this._framebuffers.get(e);return t.ref(),t},e.prototype.getShader=function(e,t){(t=t||[]).sort(),t&&(e+=t.join("_")),this._shaders.has(e)||this._shaders.set(e,new Er(e,this));var r=this._shaders.get(e);return r.ref(),r},e.prototype.getBuffer=function(e){this._buffers.has(e)||this._buffers.set(e,new Ar(e,this));var t=this._buffers.get(e);return t.ref(),t},e.prototype.getMesh=function(e){this._meshes.has(e)||this._meshes.set(e,new vr(e,this));var t=this._meshes.get(e);return t.ref(),t},e.prototype.getMeshAttributes=function(e){return this._attributes[e]||(this._attributes[e]=new K),this._attributes[e]},e.prototype.hasTexture=function(e){return this._textures.has(e)},e.prototype.hasFramebuffer=function(e){return this._framebuffers.hasOwnProperty(e)},e.prototype.hasShader=function(e,t){return(t=t||[]).sort(),t&&(e+=t.join("_")),this._shaders.has(e)},e.prototype.hasBuffer=function(e){return this._buffers.has(e)},e.prototype.hasMesh=function(e){return this._meshes.has(e)},e.prototype.deleteTexture=function(e){this._textures.delete(e)},e.prototype.deleteFramebuffer=function(e){this._framebuffers.delete(e)},e.prototype.deleteShader=function(e){this._shaders.delete(e)},e.prototype.deleteBuffer=function(e){this._buffers.delete(e)},e.prototype.deleteMesh=function(e){this._meshes.delete(e)},e.prototype.discard=function(){this._framebuffers.forEach(function(e){e.discard()})},e.prototype.restore=function(){this._framebuffers.forEach(function(e){e.restore()})},e.prototype.getMemStats=function(e){e.textureKBytes=0,e.textureCount=0,this._textures.forEach(function(t){t.ready&&(e.textureKBytes+=t.getSize()/1024,e.textureCount++)}),e.meshKBytes=0,e.meshCount=0,this._meshes.forEach(function(t){t.ready&&(e.meshKBytes+=t.bytes/1024,e.meshCount++)}),e.framebufferCount=0,this._framebuffers.forEach(function(t){t.ready&&e.framebufferCount++}),e.shaderCount=0,this._shaders.forEach(function(t){t.ready&&e.shaderCount++})},e.prototype.addSourceBuffers=function(e,t,r){this._sourceVertex[e]||this._sourceVertex.set(e,t),this._soucreIndex[e]||this._soucreIndex.set(e,r)},e.prototype.addSourceImage=function(e,t){this._sourceTexture.set(t,{image:e,name:t})},e.prototype.getSourceDatas=function(){return{vertexs:this._sourceVertex,indexs:this._soucreIndex}},e.prototype.getSourceTextures=function(){return this._sourceTexture},e.prototype.destroyBuffers=function(){var e=this;this._meshes.forEach(function(t){t.destroyBuffer(e)}),this.gl.flush()},e.prototype.restoreBuffers=function(){var e=this;this._meshes.forEach(function(t){t.restoreBuffer(e)}),this.gl.flush()},e}(),Pr=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Nr=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._useTransparent=!0,i._useMaskTextue=!1,i._usediffuseTexture=!1,i.useDepthMask=!0,i}return Pr(t,e),t.prototype.setUseTransparent=function(e){this._useTransparent=e},t.prototype.setUsediffuseTexture=function(e){this._usediffuseTexture=e},t.prototype.setUsemaskTexture=function(e){this._useMaskTextue=e},t.prototype.setuseDepthMask=function(e){this.useDepthMask=e},t.prototype.absorb=function(e){var t=this.reservedParameters.m_uDiffuseTexture;if(this._useMaskTextue&&e.hasMask||this._usediffuseTexture&&e.hasTexture){var r=e.reservedParameters.m_uDiffuseTexture;t&&r&&(t.value=r.value)}this._useTransparent&&this.setTransparent(e.getTransparent())},t}(V),Dr=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ir=function(){function e(e){this._materials={},this._modelMaterials={},this._customColors={},this._customColorCount=0,this._scene=null,this._buffer=new Uint8Array(1024),this._resourceManager=e;var t=e.gl;this.texture=e.getTexture("texturemanager"),this.texture.create(256,1,t.RGBA8,t.NEAREST,t.CLAMP_TO_EDGE),this.texture.use(3)}return e.prototype.destroy=function(){for(var e in this._materials)this._materials[e].destroy();this._materials=null,delete this._materials,this._modelMaterials=null,delete this._modelMaterials,this.texture=null,delete this.texture,this._buffer=null,delete this._buffer},e.prototype.setScene=function(e){this._scene=e},e.prototype.createMaterialPbr=function(e){return this._materials[e]?this._materials[e]:(this._materials[e]=new at(e,this._resourceManager),this._materials[e])},e.prototype.createMaterialAdhoc=function(e){return this._materials[e]?this._materials[e]:(this._materials[e]=new V(e,this._resourceManager),this._materials[e])},e.prototype.createMaterialOverride=function(e){return this._materials[e]?this._materials[e]:(this._materials[e]=new Nr(e,this._resourceManager),this._materials[e])},e.prototype.addCustomColor=function(e){var t=e.map(function(e){return Math.round(255*e)}).toString();return this._customColors[t]||(this._customColorCount=(this._customColorCount+1)%127,this._customColors[t]={index:this._customColorCount,color:e}),this._customColors[t].index},e.prototype.getMaterial=function(e){return this._materials[e]},e.prototype.upload=function(){for(var e in this._customColors){var t=4*this._customColors[e].index;this._buffer[t]=Math.floor(255*this._customColors[e].color[0]),this._buffer[t+1]=Math.floor(255*this._customColors[e].color[1]),this._buffer[t+2]=Math.floor(255*this._customColors[e].color[2]),this._buffer[t+3]=Math.floor(255*this._customColors[e].color[3])}this.texture.update(this._buffer)},e.prototype.getAllMaterials=function(){return this._materials},e.prototype.addModelMaterial=function(e){var t;t=e.name,this._modelMaterials[t]=e},e.prototype.getModelMaterial=function(e){return this._modelMaterials[e]},e.prototype.getModelMaterials=function(e){var t,r;if(void 0===e&&(e=!1),e)return this._modelMaterials;var i={};for(var n in this._modelMaterials){var a=this._scene.getDrawablesByMaterialName(n);try{for(var o=(t=void 0,Dr(a)),s=o.next();!s.done;s=o.next()){s.value.mesh.isLine()||(i[n]=this._modelMaterials[n])}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}}return i},e}(),Or={_4X4:[9/16,9/16,.125,.75,.75,7/16,.5,1/16,.8125,.6875,1/16,0,.6875,3/16,5/16,.625,.375,.875,.25,.125,0,.5,.875,.9375,3/16,.375,.9375,.25,7/16,5/16,.625,.8125],_4x4_2D:[.524814,.56488,.74661,.664308,.694092,.462367,.623577,.267783,.340815,.790118,.247202,.532242,.36916,.311385,.825046,.312099,.72246,.905,.27684,.092381,.72246,.905,.943712,.7082,.019365,.400172,.03138,.65182,.995488,.433175,.637063,.021535,.412268,.984494],_8x8_2D_LIST:[]};function Rr(e,t){for(var r=0,i=1/e,n=t;n>0;n=Math.floor(n/e))r+=i*(n%e),i/=e;return r}for(var Cr=0;Cr<64;++Cr){var Br=Rr(2,Cr)*Math.PI,Lr=Rr(3,Cr);Or._8x8_2D_LIST[Cr]=[];for(var Fr=Math.cos(Br),Vr=Math.sin(Br),Ur=0;Ur<8;++Ur){var zr=(Ur+Lr+.125*Math.random())/8;Or._8x8_2D_LIST[Cr][2*Ur]=Fr*zr,Or._8x8_2D_LIST[Cr][2*Ur+1]=Vr*zr}}var jr,Gr=Or,qr=(new Float32Array(36),function(){function e(e){this.dirtyBits=-1,this._framebuffer=null,this._mesh=null,this._shader=null,this._clearColor=new Float32Array([1,1,1,0]),this._colorMask=new Int32Array([1,1,1,1]),this._depthTest=!0,this._clearDepth=1,this._depthFunc=e.LESS,this._viewport=new Int32Array([0,0,1,1]),this._planesArray=new Float32Array(24),this._blend=!1,this._stencilTest=!1,this._stencilOp=[e.KEEP,e.KEEP,e.REPLACE],this._stencilFunc=[e.ALWAYS,0,-1],this._stencilMask=0,this._blendFunc=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],this._gl=e,e.enable(e.CULL_FACE),e.frontFace(e.CCW),e.lineWidth(1),e.clearColor(this._clearColor[0],this._clearColor[1],this._clearColor[2],this._clearColor[3]),e.colorMask(this._colorMask[0],this._colorMask[1],this._colorMask[2],this._colorMask[3]),e.clearStencil(0),this._depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.clearDepth(this._clearDepth),e.depthFunc(this._depthFunc),this._blend?e.enable(e.BLEND):e.disable(e.BLEND),e.blendFuncSeparate(this._blendFunc[0],this._blendFunc[1],this._blendFunc[2],this._blendFunc[3]),this._stencilTest?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.stencilMask(this._stencilMask),e.stencilFunc(this._stencilFunc[0],this._stencilFunc[1],this._stencilFunc[2]),e.stencilOp(this._stencilOp[0],this._stencilOp[1],this._stencilOp[2]),e.viewport(this._viewport[0],this._viewport[1],this._viewport[2],this._viewport[3])}return e.prototype.useShader=function(t,r,i,n,a,o,s){if(t){t!==this._shader&&(this._shader=t,this._shader.use()),!a||this.dirtyBits&e.SHADOW_DIRTY_BIT||(this.dirtyBits|=e.SHADOW_DIRTY_BIT),!n||this.dirtyBits&e.LIGHT_DIRTY_BIT||(this.dirtyBits|=e.LIGHT_DIRTY_BIT),this.dirtyBits&&(this.dirtyBits&e.CLIP_DIRTY_BIT&&this._syncGlobalUniforms(t.reservedUniforms,i),this.dirtyBits&e.LIGHT_DIRTY_BIT&&this._syncLightUniforms(t.reservedUniforms,n),this.dirtyBits&e.SHADOW_DIRTY_BIT&&(this._syncShadowUniforms(t.reservedUniforms,a),this.dirtyBits&=~e.SHADOW_DIRTY_BIT),this.dirtyBits&e.PLATTE_DIRTY_BIT&&this._syncPlatteUniforms(t.reservedUniforms));var l,u=this._gl;if(u.isWebGL2){if(l=t.reservedUniforms.m_uPerFrame){if(r.uniformBlock.set(r.viewMatrix,0),r.uniformBlock.set(r.vpMatrix,16),r.isPerspective())r.uniformBlock[32]=r.eye[0],r.uniformBlock[33]=r.eye[1],r.uniformBlock[34]=r.eye[2],r.uniformBlock[35]=1;else{var c=r.getViewDirection();r.uniformBlock[32]=-c[0],r.uniformBlock[33]=-c[1],r.uniformBlock[34]=-c[2],r.uniformBlock[35]=0}l.upload(r.uniformBlock,u)}(l=t.reservedUniforms.m_uBaseVertexOffset)&&l.upload(s,u)}else if((l=t.reservedUniforms["m_uPerFrame.vpMatrix"])&&l.upload(r.vpMatrix,u),(l=t.reservedUniforms["m_uPerFrame.viewMatrix"])&&l.upload(r.viewMatrix,u),l=t.reservedUniforms["m_uPerFrame.cameraPosition"]){var h;if(r.isPerspective())h=r.getEye();else(c=r.getViewDirection())[0]=-c[0],c[1]=-c[1],c[2]=-c[2],h=c;l.upload(h,u)}}},e.prototype.useFramebuffer=function(e){this._framebuffer!==e&&(this._framebuffer=e,this._framebuffer.use())},e.prototype.useMesh=function(e){this._mesh!==e&&(this._mesh=e,this._mesh.use())},e.prototype.clearColor=function(e){e[0]===this._clearColor[0]&&e[1]===this._clearColor[1]&&e[2]===this._clearColor[2]&&e[3]===this._clearColor[3]||(this._clearColor[0]=e[0],this._clearColor[1]=e[1],this._clearColor[2]=e[2],this._clearColor[3]=e[3],this._gl.clearColor(this._clearColor[0],this._clearColor[1],this._clearColor[2],this._clearColor[3]))},e.prototype.colorMask=function(e){e[0]===this._colorMask[0]&&e[1]===this._colorMask[1]&&e[2]===this._colorMask[2]&&e[3]===this._colorMask[3]||(this._colorMask[0]=e[0],this._colorMask[1]=e[1],this._colorMask[2]=e[2],this._colorMask[3]=e[3],this._gl.colorMask(this._colorMask[0],this._colorMask[1],this._colorMask[2],this._colorMask[3]))},e.prototype.depthTest=function(e,t,r){var i=this._gl;this._depthTest!==e&&(this._depthTest=e,this._depthTest?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST)),this._clearDepth!==t&&(this._clearDepth=t,i.clearDepth(this._clearDepth)),this._depthFunc!==r&&(this._depthFunc=r,i.depthFunc(this._depthFunc))},e.prototype.depthMask=function(e){this._depthMask!==e&&(this._depthMask=e,this._gl.depthMask(this._depthMask))},e.prototype.viewport=function(e){e[0]===this._viewport[0]&&e[1]===this._viewport[1]&&e[2]===this._viewport[2]&&e[3]===this._viewport[3]||(this._viewport[0]=e[0],this._viewport[1]=e[1],this._viewport[2]=e[2],this._viewport[3]=e[3],this._gl.viewport(this._viewport[0],this._viewport[1],this._viewport[2],this._viewport[3]))},e.prototype.blendFunc=function(e){this._blendFunc[0]==e[0]&&this._blendFunc[1]==e[1]&&this._blendFunc[2]==e[2]&&this._blendFunc[3]==e[3]||(this._blendFunc[0]=e[0],this._blendFunc[1]=e[1],this._blendFunc[2]=e[2],this._blendFunc[3]=e[3],this._gl.blendFuncSeparate(this._blendFunc[0],this._blendFunc[1],this._blendFunc[2],this._blendFunc[3]))},e.prototype.blend=function(e){var t=this._gl;this._blend!==e&&(this._blend=e,this._blend?this._gl.enable(t.BLEND):this._gl.disable(t.BLEND))},e.prototype.stencilTest=function(e,t,r,i){var n=this._gl;this._stencil!==e&&(this._stencil=e,this._stencil?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST)),this._stencilFunc[0]===t[0]&&this._stencilFunc[1]===t[1]&&this._stencilFunc[2]===t[2]||(this._stencilFunc[0]=t[0],this._stencilFunc[1]=t[1],this._stencilFunc[2]=t[2],n.stencilFunc(t[0],t[1],t[2])),this._stencilOp[0]===r[0]&&this._stencilOp[1]===r[1]&&this._stencilOp[2]===r[2]||(this._stencilOp[0]=r[0],this._stencilOp[1]=r[1],this._stencilOp[2]=r[2],n.stencilOp(r[0],r[1],r[2])),this._stencilMask!==i&&(this._stencilMask=i,n.stencilMask(this._stencilMask))},e.prototype.invalidateStates=function(){this._mesh=null,this._framebuffer=null,this._shader=null},e.prototype.invalidateShadow=function(){this.dirtyBits|=e.SHADOW_DIRTY_BIT},e.prototype.invalidateLight=function(){this.dirtyBits|=e.LIGHT_DIRTY_BIT},e.prototype.invalidateClip=function(){this.dirtyBits|=e.CLIP_DIRTY_BIT},e.prototype.invalidatePlatte=function(){this.dirtyBits|=e.PLATTE_DIRTY_BIT},e.prototype.invalidateOther=function(){this.dirtyBits|=e.OTHER_DIRTY_BIT},e.prototype._syncGlobalUniforms=function(e,t){var r;if(t&&(r=e["m_uGlobal.clipPlanes[0]"])){var i=t.getClippingPlanes();this._planesArray[0]=i[0][0],this._planesArray[1]=i[0][1],this._planesArray[2]=i[0][2],this._planesArray[3]=-i[0][3],this._planesArray[4]=i[1][0],this._planesArray[5]=i[1][1],this._planesArray[6]=i[1][2],this._planesArray[7]=-i[1][3],this._planesArray[8]=i[2][0],this._planesArray[9]=i[2][1],this._planesArray[10]=i[2][2],this._planesArray[11]=-i[2][3],this._planesArray[12]=i[3][0],this._planesArray[13]=i[3][1],this._planesArray[14]=i[3][2],this._planesArray[15]=-i[3][3],this._planesArray[16]=i[4][0],this._planesArray[17]=i[4][1],this._planesArray[18]=i[4][2],this._planesArray[19]=-i[4][3],this._planesArray[20]=i[5][0],this._planesArray[21]=i[5][1],this._planesArray[22]=i[5][2],this._planesArray[23]=-i[5][3],r.upload(this._planesArray,this._gl)}},e.prototype._syncLightUniforms=function(e,t){var r;t&&((r=e["m_uSunLight.intensity"])&&r.upload(t.intensity,this._gl),(r=e["m_uSunLight.diffuseMatrix[0]"])&&r.upload(t.envmapMatrix,this._gl),(r=e["m_uSunLight.direction"])&&r.upload(t.direction,this._gl))},e.prototype._syncShadowUniforms=function(e,t){if(t&&t.shadowMaps){var r=e.m_uShadowSize;r&&(r.upload(t.size,this._gl),s.a.isMobile||(r=e.m_uShadowFine).upload(t.fine?1:0,this._gl)),(r=e.m_uShadowContrast)&&r.upload(t.contrast,this._gl);for(var i=0,n=t.shadowMaps.length;i<n;i++)(r=e["m_uShadowTexture"+i])&&(r.upload(6+i,this._gl),t.shadowMaps[i].use(6+i,this._gl)),(r=e["m_uSunLight.shadowMatrix"+i])&&r.upload(t.shadowMatrices[i],this._gl)}},e.prototype._syncPlatteUniforms=function(e){var t=e.m_uPlatteTexture;t&&t.upload(3,this._gl)},e.CLIP_DIRTY_BIT=1,e.LIGHT_DIRTY_BIT=2,e.SHADOW_DIRTY_BIT=4,e.RESERVED_BIT=8,e.PLATTE_DIRTY_BIT=16,e.OTHER_DIRTY_BIT=32,e.ALL_DIRTY_BIT=e.CLIP_DIRTY_BIT|e.LIGHT_DIRTY_BIT|e.SHADOW_DIRTY_BIT|e.RESERVED_BIT|e.PLATTE_DIRTY_BIT|e.OTHER_DIRTY_BIT,e}()),Qr=[0,0],Hr=function(){function e(e){this.renderState=new qr(e.gl),this._resourceManager=e,this._renderTarget=null,this._quadMesh=null,this._quadMesh=e.getMesh("quad"),this._quadMesh.createQuad(),this._canvasFrameBuffer=e.getFramebuffer("default")}return e.prototype.destroy=function(){this.renderState=null},e.prototype.drawDrawables=function(e,t,r,i,n,a,o,s,l,u){if(0===t.length)return 0;(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));var c=this._resourceManager.gl;if(u?(c.enable(c.CULL_FACE),c.frontFace(u)):c.disable(c.CULL_FACE),this.renderState.viewport(r.viewport),i&&null!==i[0])for(var h=0,d=t.length;h<d;h++){if((f=t[h]).visible&&(Qr[0]=0,Qr[1]=f.mesh.length,!r.cull(f,Qr))){f.faceCamera&&f.update(r);var p=null;p=f.transform.identity?i[0]:i[1],this.renderState.useShader(p,r,a,o,s,null,null),n?(n.absorb(f.material),n.use(p),n.restoreTransparency()):f.material.use(p),this.renderState.useMesh(f.mesh),f.render(r,p,Qr)}}else for(h=0,d=t.length;h<d;h++){var f;(f=t[h]).visible&&(Qr[0]=0,Qr[1]=f.mesh.length,r.cull(f,Qr)||(f.faceCamera&&f.update(r),this.renderState.useShader(f.shader,r,a,o,s,l),n?(n.absorb(f.material),n.use(f.shader),n.restoreTransparency()):f.material.use(f.shader),this.renderState.useMesh(f.mesh),f.render(r,f.shader,Qr)))}},e.prototype.drawMarks=function(e,t,r,i,n,a,o,s){if(0===t.length)return 0;(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));var l=this._resourceManager.gl;s?(l.enable(l.CULL_FACE),l.frontFace(s)):l.disable(l.CULL_FACE),this.renderState.viewport(r.viewport);for(var u=0,c=t.length;u<c;u++){var h=t[u];h.visible&&(Qr[0]=0,Qr[1]=h.mesh.length,r.cull(h,Qr)||(this.renderState.useShader(h.shader,r,i,n,a,o),h.material.use(h.shader),this.renderState.useMesh(h.mesh),h.render(r,h.shader,Qr)))}},e.prototype.drawLinesWithVertexIds=function(e,t,r,i,n,a){if(0===t.length)return 0;(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1)),this.renderState.viewport(r.viewport);for(var o=0,s=0,l=t.length;s<l;s++){var u=t[s];Qr[0]=0,Qr[1]=u.mesh.length;var c=null;c=u.transform.identity?i[0]:i[1],this.renderState.useShader(c,r,a,null,null,null,o),n.absorb(u.material),n.use(c),n.restoreTransparency(),this.renderState.useMesh(u.mesh),u.render(r,c,Qr),o+=u.mesh.length}},e.prototype.drawDrawable=function(e,t,r,i,n,a,o,s){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));var l=this._resourceManager.gl;o?(l.enable(l.CULL_FACE),l.frontFace(o)):l.disable(l.CULL_FACE),this.renderState.viewport(r.viewport),this.renderState.useShader(t.shader,r,i,n,a),t.material.use(t.shader),t.transform.use(r,t.shader),this.renderState.useMesh(t.mesh),s?t.mesh.renderSub(s[0],s[1]):t.mesh.render()},e.prototype.drawElements=function(e,t,r,i,n,a,o,s,l){if(0!==t.length){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));var u=this._resourceManager.gl;if(o?(u.enable(u.CULL_FACE),u.frontFace(o)):u.disable(u.CULL_FACE),this.renderState.viewport(r.viewport),s&&null!==s[0])for(var c=0,h=t.length;c<h;c++){if((f=(p=t[c]).drawable).visible){f.faceCamera&&f.update(r);var d=null;d=f.transform.identity?s[0]:s[1],this.renderState.useShader(d,r,i,n,a),l.absorb(f.material),l.use(d),this.renderState.useMesh(f.mesh),Qr[0]=p.indicesOffset,Qr[1]=p.indicesCount,f.render(r,d,Qr)}}else for(c=0,h=t.length;c<h;c++){var p,f;(f=(p=t[c]).drawable).visible&&(f.faceCamera&&f.update(r),this.renderState.useShader(f.shader,r,i,n,a),l?(l.absorb(f.material),l.use(f.shader),l.restoreTransparency()):f.material.use(f.shader),this.renderState.useMesh(f.mesh),Qr[0]=p.indicesOffset,Qr[1]=p.indicesCount,f.render(r,f.shader,Qr))}}},e.prototype.drawGizmo=function(e,t,r,i){this.drawDrawable(e,t,r,null,null,null,i)},e.prototype.drawScreen=function(e,t,r){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));var i=this._resourceManager.gl;i.disable(i.CULL_FACE),this.renderState.useShader(t),r.use(t),this.renderState.useMesh(this._quadMesh),this._quadMesh.render()},e.prototype.drawDrawablesCustom=function(e,t,r,i,n,a,o,s){if(0!==t.length){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));var l=this._resourceManager.gl;o?(l.enable(l.CULL_FACE),l.frontFace(l.CCW)):l.disable(l.CULL_FACE),this.renderState.viewport(r.viewport);for(var u=0,c=t.length;u<c;u++){var h=t[u];if(h.visible&&!r.cull(h,Qr)){Qr[0]=0,Qr[1]=h.mesh.length;var d=null;d=h.transform.identity?i[0]:i[1],this.renderState.useShader(d,r,a),s(u,n),n.use(d),this.renderState.useMesh(h.mesh),h.render(r,d,Qr)}}}},e.prototype.drawNodesCustom=function(e,t,r,i,n,a,o,s,l,u){if(0!==t.length){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));var c=this._resourceManager.gl;o?(c.enable(c.CULL_FACE),c.frontFace(c.CCW)):c.disable(c.CULL_FACE),this.renderState.viewport(r.viewport),t.sort(function(e,t){return e.drawable.name<t.drawable.name});for(var h=0,d=t.length;h<d;h++){var p=t[h],f=p.drawable;f.faceCamera&&f.update(r);var m=null;m=f.transform.identity?i[0]:i[1],this.renderState.useShader(m,r,a,l,u),s&&s(h,n),n.use(m),this.renderState.useMesh(f.mesh),Qr[0]=p.indicesOffset,Qr[1]=p.indicesCount,f.render(r,m,Qr)}}},e.prototype.drawSkybox=function(e,t,r){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1));var i=this._resourceManager.gl;i.disable(i.CULL_FACE),this.renderState.viewport(r.viewport),this.renderState.useShader(t.shader,r),t.material.use(t.shader),t.transform.use(r,t.shader),this.renderState.useMesh(t.mesh),t.mesh.render()},e.prototype.beginFrame=function(e){void 0===e&&(e=null),this._currentFrameBuffer=e,this.renderState.invalidateStates()},e.prototype.endFrame=function(){this.renderState.dirtyBits=0,this._present()},e.prototype.invalidate=function(){this._renderTarget=null,this.renderState.dirtyBits=qr.ALL_DIRTY_BIT},e.prototype.clear=function(e,t){(this._renderTarget!==e||this._renderTarget.always)&&(this._renderTarget=e,this._renderTarget.render(this.renderState),this._renderTarget.always&&(this._renderTarget.always=!1)),this._resourceManager.gl.clear(t)},e.prototype.restore=function(){},e.prototype.discard=function(){},e.prototype.present=function(e){var t=this._resourceManager.gl;t.isWebGL2&&this._resourceManager.getFramebuffer("default").copy(e,t.COLOR_BUFFER_BIT)},e.prototype._present=function(){var e=this._resourceManager.gl;e.isWebGL2&&null!==this._currentFrameBuffer&&this._canvasFrameBuffer.copy(this._currentFrameBuffer,e.COLOR_BUFFER_BIT)},e}(),Wr=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Yr=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},Xr=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Yr(arguments[t]));return e},Zr=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Kr=function(){function e(e){this.modelNodes=[],this.drawable=e.isSingleton()?e.drawable.clone():e.drawable,e.clonedDrawable=e.isSingleton()?this.drawable:null,this.indexSize=this.drawable.mesh.indexSize,this.indicesOffset=e.indicesOffset,this.indicesCount=e.indicesCount,this.modelNodes.push(e)}return e.prototype.destroy=function(){this.drawable=null,delete this.drawable,this.modelNodes=null,delete this.modelNodes},e}(),Jr=function(e){function t(t,r){var i=e.call(this,t,r,!1,{})||this;return i._lineColor=[0,0,0],i._queue=[],i}return Wr(t,e),t.prototype.destroy=function(){for(var t=0;t<this._queue.length;++t)this._queue[t].destroy();this._queue=null,delete this._queue,e.prototype.destroy.call(this)},t.prototype.clone=function(){var e=new t(this._resourceManager,this._renderQueueManager);e._queue=new Array(this._queue.length);for(var r=0;r<this._queue.length;r++)e._queue[r]=new Kr(this._queue[r].modelNodes[0]),e._queue[r].indicesCount=this._queue[r].indicesCount;return e._lineColor=this._lineColor.slice(0),e},t.prototype.render=function(e,t,r,i,n,a){0!==this._queue.length&&(null!==this._overridedMaterial&&this._overridedMaterial.transparent&&(e.always=!0),t.drawElements(e,this._queue,r,n,a,i,this._cullFace,this._overridedShaders,this._overridedMaterial),null!==this._overridedMaterial&&this._overridedMaterial.transparent&&(e.always=!0))},t.prototype.setLineColor=function(e){this._lineColor=e},t.prototype.isValid=function(){return this._queue.length>0},t.prototype.getNodes=function(){return this._queue},t.prototype.removeNodes=function(e){var t=this;e.forEach(function(e){var r=t._queue.findIndex(function(t){return t.modelNodes[0]===e});-1!==r&&t._queue.splice(r,1)})},t.prototype.getCurSelectedDrawables=function(){var e=[];return this._queue.forEach(function(t){t.drawable.isTriangle()&&e.push(t.drawable)}),e},t.prototype.getCurSelectedNodes=function(){var e=[];return this._queue.forEach(function(t){return e.push.apply(e,Xr(t.modelNodes))}),e},t.prototype.setCurSelectedNodes=function(e,t){void 0===t&&(t=!1),this.restorePreSelectedNodes(t),e&&(this._storeCurSelectedNodes(e),t&&this._hideDrawablesInfluencedBy(e))},t.prototype._storeCurSelectedNodes=function(e){var t,r;e.sort(function(e,t){var r=e.drawable.nodes[0].id-t.drawable.nodes[0].id,i=e.indicesOffset-t.indicesOffset;return 0!==r?r:i});var i=null;try{for(var n=Zr(e),a=n.next();!a.done;a=n.next()){var o=a.value,s=o.drawable;if(s.mesh.isTriangle()&&o.hide(),i!==s)s.mesh.isLine()&&s.material.setDiffuse([.96,.32,.14]),this._queue.push(new Kr(o)),i=s;else{var l=this._queue[this._queue.length-1];s.transform.count>1?l.indicesOffset+1===o.indicesOffset?(l.indicesCount+=1,l.modelNodes.push(o)):this._queue.push(new Kr(o)):l.indicesOffset+l.indicesCount*l.indexSize===o.indicesOffset?(l.indicesCount+=o.indicesCount,l.modelNodes.push(o)):this._queue.push(new Kr(o))}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},t.prototype._hideDrawablesInfluencedBy=function(e){var t=this._getDrawablesInfluencedBy(e);this._updateTriangleDrawablesVisibility(t)},t.prototype._getDrawablesInfluencedBy=function(e){var t=new Set;return e&&e.forEach(function(e){return t.add(e.drawable)}),t},t.prototype._updateTriangleDrawablesVisibility=function(e){e.forEach(function(e){e.mesh.isTriangle()&&e.updateVisibility(!1,!1)})},t.prototype.restorePreSelectedNodes=function(e){this._hasNoneSelectedNodes()||(this._revertPreSelectedNodes(),this._revertPreColoredNodes(e),e&&this._showDrawblesHidedByPreSelectedNodes(),this._clearPreSelectedNodes())},t.prototype._hasNoneSelectedNodes=function(){return this._queue&&0===this._queue.length},t.prototype._revertPreSelectedNodes=function(){var e,t,r=void 0;try{for(var i=Zr(this._queue),n=i.next();!n.done;n=i.next()){var a=n.value.drawable;r!==a.name&&a.mesh.isLine()&&(a.material.setDiffuse(this._lineColor),r=a.name)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype._revertPreColoredNodes=function(e){var t,r;void 0===e&&(e=!1);try{for(var i=Zr(this._queue),n=i.next();!n.done;n=i.next()){var a=n.value;a.drawable.mesh.isTriangle()&&a.modelNodes.forEach(function(t){t.show(),e&&t.revertColor()})}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype._showDrawblesHidedByPreSelectedNodes=function(){var e=this._getDrawablesHidedByPreSelectedNodes();this._updateTriangleDrawablesVisibility(e)},t.prototype._clearPreSelectedNodes=function(){this._queue.forEach(function(e){return e.destroy()}),this._queue=[]},t.prototype._getDrawablesHidedByPreSelectedNodes=function(){var e=new Set;return this._queue&&this._queue.forEach(function(t){return e.add(t.modelNodes[0].drawable)}),e},t.prototype.setCurSelectedNodesColor=function(e,t){this._queue.forEach(function(r){var i,n=r.drawable,a=!n.material.transparent&&e[3]&&e[3]<.99?e[3]:1;if(n.isSingleton())return n.originalMaterial=null!==(i=n.originalMaterial)&&void 0!==i?i:n.material.clone(),n.material.setDiffuse(e),void n.material.setTransparent(a);r.modelNodes.forEach(function(e){e.setColorIndex(t)}),n.updateColor()})},t.prototype.setNodes=function(e){for(var t="",r=0;r<this._queue.length;++r){t!==(a=this._queue[r].drawable).name&&a.mesh.isLine()&&(a.material.setDiffuse(this._lineColor),t=a.name),this._queue[r].destroy()}if(this._queue=[],e){e.sort(function(e,t){var r;return 0!==(r=e.drawable.nodes[0].id-t.drawable.nodes[0].id)?r:e.indicesOffset-t.indicesOffset});for(var i=null,n=(r=0,e.length);r<n;r++){var a,o=e[r];if(i!==(a=e[r].drawable))a.mesh.isLine()&&a.material.setDiffuse([.96,.32,.14]),this._queue.push(new Kr(o)),i=a;else{var s=this._queue[this._queue.length-1];a.transform.count>1?s.indicesOffset+1===o.indicesOffset?s.indicesCount+=1:this._queue.push(new Kr(o)):s.indicesOffset+s.indicesCount*s.indexSize===o.indicesOffset?s.indicesCount+=o.indicesCount:this._queue.push(new Kr(o))}}}},t}($t),$r=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},ei=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat($r(arguments[t]));return e};!function(e){e[e.LOW=0]="LOW",e[e.NORMAL=1]="NORMAL",e[e.HIGH=2]="HIGH",e[e.VERY_HIGH=3]="VERY_HIGH"}(jr||(jr={}));var ti=function(){function e(e,t,r){this.name=e,this.priority=t,this._renderScene=r,this._enabled=!1,this._ready=!1,this._ready=this._initialize(),this._ready||console.warn("RenderEffect "+e+" initialized failed!"),this._renderPasses=new Map}return e.prototype.destroy=function(){this._renderScene=null,delete this._renderScene,delete this._renderPasses,this._renderPasses=null,this._shader&&(this._shader.destroy(),delete this._shader,this._shader=null),this._ready=!1},e.prototype.setEnabled=function(e){this._ready&&(this._enabled=e)},e.prototype.doesSupportMobile=function(e){return!0},e.prototype.doesSupportWebGL1=function(){return!0},e.prototype.isEnabled=function(){return this._enabled},e.prototype.resize=function(e,t){},e.prototype.draw=function(e,t){void 0===t&&(t=-1)},e.prototype._initialize=function(){return!0},e.prototype.setParameter=function(e,t){},e.prototype.getParameter=function(e){},e.prototype.onSceneChanged=function(e){},e.prototype.recompileShader=function(e,t){},e.prototype._getELementNodes=function(e){for(var t=[],r=0,i=e.length;r<i;r++){var n=e[r],a=n.split("+")[0],o=this._renderScene.getScene().models[a].tree.elements[n];if(o)o.getNodes().forEach(function(e){e.drawable.mesh.isLine()||t.push(e)});else console.warn("Element: +"+n+" can not be found!")}return t},e.prototype.afterElementsAdded=function(e){},e.prototype.addElements=function(e,t){var r=t.emissiveColor||[1,1,1];if(e){var i=this._getELementNodes(e),n="emissive"+r,a=this._renderScene.getScene().materialManager.createMaterialOverride(n);if(a.attachShader(this._shader,this._renderScene.getResourceManager()),a.setDiffuse(r),a.setTransparent(1),this._renderPasses.has(n)){var o=this._renderPasses.get(n),s=o.renderPass,l=o.nodes;i.forEach(function(e){l.has(e)||l.add(e)}),s.setNodes(ei(l.keys()))}else{var u=new Jr(this._renderScene.getResourceManager(),this._renderScene.getRenderQueueManager());u.setOverridedShader(this._shader),u.setOverridedMaterial(a),u.setNodes(i),this._renderPasses.set(n,{renderPass:u,nodes:new Set(i)})}this.afterElementsAdded(a)}},e.prototype.removeElements=function(e){var t=this,r=this._getELementNodes(e),i=[];this._renderPasses.forEach(function(e,t){e.renderPass.removeNodes(r),r.forEach(function(t){e.nodes.has(t)&&e.nodes.delete(t)}),0===e.renderPass.getNodes().length&&i.push(t)}),i.forEach(function(e){t._renderPasses.delete(e)})},e.prototype.addDrawable=function(e){},e.prototype.removeDrawable=function(e){},e.prototype.addCustomDrawable=function(e){},e.prototype.removeCustomDrawable=function(e){},e.prototype.addPawn=function(e){},e.prototype.removePawn=function(e){},e}(),ri=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ii=function(e){function t(t){return e.call(this,"Sketch",jr.NORMAL,t)||this}return ri(t,e),t.prototype._initialize=function(){e.prototype._initialize.call(this);var t=this._renderScene.getResourceManager();this._color=[0,0,0],this._surfaceColor=[1,1,1,1],this._blit=new cr(t,N.a.sketch,s.a.isMobile);var r=this._renderScene.getScene().materialManager;this._material=r.createMaterialOverride("sketch-surface"),this.setParameter("contrast",30),this.setParameter("detail",2),this.setParameter("colored",!1),this.setParameter("color",[0,0,0]),this.setParameter("surfaceColor",[1,1,1,1]);var i=t.gl,n=this._renderScene.getCamera();if(s.a.isMobile?this._renderTarget=new Jt.a("sketch-position",t,n.viewport[2],n.viewport[3],{depthTest:!0,depthFunc:i.LEQUAL,colorFormat:i.RGBA8,clearColor:[.5,.5,1,0],colorFilter:i.NEAREST,depthFormat:i.DEPTH_COMPONENT24,colorBuffer:0,depthBuffer:0}):this._renderTarget=new Jt.a("sketch-position",t,n.viewport[2],n.viewport[3],{depthTest:!0,colorFormat:i.RGBA32F,clearColor:[0,0,1,0],colorFilter:i.NEAREST,colorBuffer:0,depthBuffer:0}),!this._renderTarget.ready)return this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._blit.destroy(),this._blit=null,delete this._blit,!1;this._opaques=new $t(t,this._renderScene.getRenderQueueManager(),!1,{transparent:!1,mask:!1,line:!1,uniqueId:"sketch"}),this._maskeds=new $t(t,this._renderScene.getRenderQueueManager(),!1,{mask:!0,uniqueId:"sketch"}),this._transparents=null,this._hasTransparents=!1;var a=[],o=this._renderScene.getScene();o.clipping.isEnabled()&&a.push("CLIPPING"),o.needRenderDoubleSided()&&a.push("DOUBLESIDED"),o.compressed&&a.push("COMPRESSION"),s.a.isMobile&&(a.push("ENCODE_NORMAL"),a.push("MOBILE"));var l=t.getShader("normaldepth",a);if(!l.ready){var u=N.a.normaldepth;l.createFromShaderSource(u,a)}if(this._opaques.setOverridedShader(l),a.push("ALPHATEST"),!(l=t.getShader("normaldepth",a)).ready){u=N.a.normaldepth;l.createFromShaderSource(u,a)}return this._maskeds.setOverridedShader(l),this._opaques.setOverridedMaterial(r.createMaterialAdhoc("sketch_opaques")),this._maskeds.setOverridedMaterial(r.createMaterialAdhoc("sketch_maskeds")),!0},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.destroy=function(){this._ready&&(this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._blit.destroy(),this._blit=null,delete this._blit,this._opaques.destroy(),this._opaques=null,delete this._opaques,this._maskeds.destroy(),this._maskeds=null,delete this._maskeds,this._transparents&&(this._transparents.destroy(),this._transparents=null,delete this._transparents),this._material.destroy(),this._material=null,delete this._material,this._surfaceColor=null,delete this._surfaceColor,this._color=null,delete this._color),e.prototype.destroy.call(this)},t.prototype.resize=function(e,t){this._ready&&(this._ready=!1,this._renderTarget.resize(e,t),this._ready=this._renderTarget.ready,this._ready||(this._ready=!0,this.destroy()))},t.prototype._recompileSurfaceShader=function(){var e=this._renderScene.getScene(),t=[];e.clipping.isEnabled()&&t.push("CLIPPING"),e.needRenderDoubleSided()&&t.push("DOUBLESIDED"),e.compressed&&t.push("COMPRESSION"),s.a.isMobile&&(t.push("ENCODE_NORMAL"),t.push("MOBILE"));var r=this._renderScene.getResourceManager().getShader("solid",t);r.ready||r.createFromShaderSource(N.a.solid,t),this._renderScene.setOverridedShaders(r),this._renderScene.setOverridedMaterials({all:this._material}),this._material.setDiffuse(this._surfaceColor),this._material.setTransparent(this._surfaceColor[3]),Vi.prototype.recompileShadow.call(this._renderScene)},t.prototype.setParameter=function(e,t){var r=this;switch(e){case"detail":var i=Math.min(Math.max(t,0),99.9)/100;this._threshold=.55*Math.sqrt(1-i*i),this._blit.setParameter("uThreshold",this._threshold),this._detailout=t;break;case"contrast":this._contrast=Math.min(Math.max(t,0),100),this._contrast=this._contrast/100,this._blit.setParameter("uContrast",.5*this._contrast),this._contrastout=t;break;case"colored":this._colored=t,this._colored?(this._renderScene.setOverridedShaders(null),this._renderScene.setOverridedMaterials(null)):this._recompileSurfaceShader();break;case"color":this._color[0]=t[0],this._color[1]=t[1],this._color[2]=t[2],this._blit.setParameter("uColor",this._color);break;case"surfaceColor":this._surfaceColor[0]=t[0],this._surfaceColor[1]=t[1],this._surfaceColor[2]=t[2],this._surfaceColor[3]=t[3],this._material.setDiffuse(this._surfaceColor),this._material.setTransparent(this._surfaceColor[3]);break;case"transparents":if(this._hasTransparents=t,this._hasTransparents&&!this._transparents){this._transparents=new $t(this._renderScene.getResourceManager(),this._renderScene.getRenderQueueManager(),!1,{transparent:!0,mask:!1,uniqueId:"sketch"});var n=this._renderScene.getScene();for(var a in n.models){n.models[a].drawables.forEach(function(e){r._transparents.queue.addDrawable(e)})}var o=this._renderScene.getTransparents();this._transparents.setCullFace(o.getCullFace());var s=this._opaques.getOverridedShaders();this._transparents.setOverridedShader(s[0]),this._transparents.setOverridedMaterial(this._opaques.getOverridedMaterial())}this._material.setUseTransparent(!1);break;case"useDepthMask":this._material.setuseDepthMask(t)}},t.prototype.getParameter=function(e){switch(e){case"detail":return this._detailout;case"contrast":return this._contrastout;case"colored":return this._colored;case"color":return this._color;case"surfaceColor":return this._surfaceColor}},t.prototype.draw=function(e,t){if(void 0===t&&(t=-1),this._ready&&this._enabled){var r=this._renderScene.getCamera(),i=this._renderScene.getRenderer(),n=this._renderScene.getScene().getMainLight(),a=this._renderScene.getScene().clipping,o=this._renderScene.getResourceManager().gl;i.clear(this._renderTarget,o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),this._opaques.render(this._renderTarget,i,r,null,a,n),this._maskeds.render(this._renderTarget,i,r,null,a,n),this._hasTransparents&&this._transparents.render(this._renderTarget,i,r,null,a,n),this._blit.setParameter("uNearAxis",r.getNearPlaneSize()),this._blit.setParameter("uIsPerspective",r.isPerspective()),this._blit.setTexture(this._renderTarget.getColorBuffer()),s.a.isMobile&&(this._blit.setParameter("uNearFar",[r._znear,r._zfar]),this._blit.setDepthTexture(this._renderTarget.getDepthBuffer())),i.renderState.viewport([0,0,e.getWidth(),e.getHeight()]),this._blit.render(i,e,!0)}},t.prototype.onSceneChanged=function(e){var t=this;if(this._ready){this._opaques.queue.removeDrawables(),this._maskeds.queue.removeDrawables(),this._hasTransparents&&this._transparents.queue.removeDrawables();var r=this._renderScene.getScene();for(var i in r.models){r.models[i].drawables.forEach(function(e){t._opaques.queue.addDrawable(e)||t._maskeds.queue.addDrawable(e),t._hasTransparents&&t._transparents.queue.addDrawable(e)})}var n=this._renderScene.getOpaques(),a=this._renderScene.getMaskeds();if(this._opaques.setCullFace(n.getCullFace()),this._maskeds.setCullFace(a.getCullFace()),this._hasTransparents){var o=this._renderScene.getTransparents();this._transparents.setCullFace(o.getCullFace())}}},t.prototype.recompileShader=function(e,t){this._ready&&(this._opaques.recompileOverridedShader(e,t),this._maskeds.recompileOverridedShader(e,t),this._hasTransparents&&this._transparents.recompileOverridedShader(e,t))},t.prototype.setEnabled=function(t){e.prototype.setEnabled.call(this,t),this._ready&&(t?this.setParameter("colored",this._colored):(this._renderScene.setOverridedShaders(null),this._renderScene.setOverridedMaterials(null)))},t.prototype.addDrawable=function(e){this._opaques.queue.addDrawable(e)||this._maskeds.queue.addDrawable(e),this._hasTransparents&&this._transparents.queue.addDrawable(e)},t.prototype.removeDrawable=function(e){this._opaques.queue.removeDrawable(e)||this._maskeds.queue.removeDrawable(e),this._hasTransparents&&this._transparents.queue.removeDrawable(e)},t.prototype.isTransParent=function(){return this._enabled&&this._hasTransparents},t}(ti),ni=r(12),ai=function(){function e(e,t,r){this.ready=!1,this.result=null;var i="blurx-"+t,n="blury-"+t;if(!N.a[i]||!N.a[n]){var a,o=[],s=0;for(a=-t;a<=t;++a){var l=a/t*1.5,u=Math.exp(-l*l*r);o.push(u),s+=u}for(a=0;a<2*t+1;++a)o[a]/=s}var c=e.gl;if(!N.a[i]){for(var h="vec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\n{\n    vec4 value = vec4(0);\n    float kernel["+(2*t+1)+"];\n",d=0;d<2*t+1;++d)h+="   kernel["+d+"] = "+o[d]+";\n";h+="    for (int i = -"+t+"; i <= "+t+"; i++)\n",c.isWebGL2?h+="        value += texture(tex, (gl_FragCoord.xy + vec2(float(i), 0.0)) * invResolution) * kernel[i + "+t+"];\n":h+="        value += texture2D(tex, (gl_FragCoord.xy + vec2(float(i), 0.0)) * invResolution) * kernel[i + "+t+"];\n",h+="    return value;\n}\n",N.a[i]=new ni.a(i,"blit.vs",["blit.fs",h],{highPrecision:!0,position:!0,uv:!0})}if(!N.a[n]){for(var p="vec4 shade(in sampler2D tex, in vec2 uv, in vec2 invResolution)\n{\n    vec4 value = vec4(0);\n    float kernel["+(2*t+1)+"];\n",f=0;f<2*t+1;++f)p+="   kernel["+f+"] = "+o[f]+";\n";p+="    for (int i = -"+t+"; i <= "+t+"; i++)\n",c.isWebGL2?p+="        value += texture(tex, (gl_FragCoord.xy + vec2(0.0, float(i))) * invResolution) * kernel[i + "+t+"];\n":p+="        value += texture2D(tex, (gl_FragCoord.xy + vec2(0.0, float(i))) * invResolution) * kernel[i + "+t+"];\n",p+="    return value;\n} ",N.a[n]=new ni.a(n,"blit.vs",["blit.fs",p],{highPrecision:!0,position:!0,uv:!0})}this._blitx=new cr(e,N.a[i]),this._blity=new cr(e,N.a[n]),this.ready=this._blitx.ready&&this._blity.ready}return e.prototype.destroy=function(){this.ready&&(this._blitx.destroy(),this._blitx=null,delete this._blitx,this._blity.destroy(),this._blity=null,delete this._blity,this.ready=!1)},e.prototype.smooth=function(e,t,r,i){if(!this.ready)return console.error("'blur' is not ready."),null;e.getWidth()==t.getWidth()&&e.getHeight()==t.getHeight()||console.error("'blur' requires two render targets in the same size.");var n,a=[e,t],o=0;for(n=0;n<i;++n)this._blitx.setTexture(a[o].getColorBuffer()),this._blitx.render(r,a[1-o]),o=1-o,this._blity.setTexture(a[o].getColorBuffer()),this._blity.render(r,a[1-o]),o=1-o;return this.result=a[o].getColorBuffer(),this.result},e}(),oi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),si=function(e){function t(t){return e.call(this,"SSAO",jr.HIGH,t)||this}return oi(t,e),t.prototype._initialize=function(){e.prototype._initialize.call(this),this._radius=5;var t=this._renderScene.getResourceManager(),r=t.gl;if(s.a.isMobile?this._rt0=new Jt.a("ssao-rt0",t,1,1,{depthTest:!0,colorFormat:r.RGBA8,clearColor:[0,0,1,-1e10],colorBuffer:2,colorFilter:r.NEAREST,depthFormat:r.DEPTH24_STENCIL8,depthBuffer:1}):this._rt0=new Jt.a("ssao-rt0",t,1,1,{depthTest:!0,colorFormat:r.RGBA32F,clearColor:[0,0,1,0],colorFilter:r.LINEAR,depthBuffer:0}),this._rt1=new Jt.a("ssao-rt1",t,1,1,{colorFormat:r.RGBA8,colorFilter:r.LINEAR,colorBuffer:0,depthBuffer:0,depthTest:!1}),this._rt2=new Jt.a("ssao-rt2",t,1,1,{colorFormat:r.RGBA8,colorFilter:r.LINEAR,colorBuffer:1,depthBuffer:0,depthTest:!1}),!this._rt0.ready||!this._rt1.ready||!this._rt2.ready)return!1;this._opaques=new $t(t,this._renderScene.getRenderQueueManager(),!1,{mask:!1,transparent:!1,line:!1,uniqueId:"ssao"}),this._maskeds=new $t(t,this._renderScene.getRenderQueueManager(),!1,{mask:!0,uniqueId:"ssao"}),this._transparents=null,this._hasTransparents=!1;var i=[],n=this._renderScene.getScene();n.clipping.isEnabled()&&i.push("CLIPPING"),n.needRenderDoubleSided()&&i.push("DOUBLESIDED"),n.compressed&&i.push("COMPRESSION"),s.a.isMobile&&i.push("ENCODE_NORMAL");var a=t.getShader("normaldepth",i);if(!a.ready){var o=N.a.normaldepth;a.createFromShaderSource(o,i)}this._opaques.setOverridedShader(a),i.push("ALPHATEST");var l=t.getShader("normaldepth",i);if(!l.ready){o=N.a.normaldepth;l.createFromShaderSource(o,i)}return this._maskeds.setOverridedShader(l),this._opaques.setOverridedMaterial(n.materialManager.createMaterialAdhoc("ssao")),this._maskeds.setOverridedMaterial(n.materialManager.createMaterialAdhoc("ssao")),this._blur=new ai(t,1,.8),this._blit=new cr(t,N.a.ssao,s.a.isMobile),this._blit.setTexture(this._rt0.getColorBuffer()),this._bitblit=new cr(t),this._blur.ready},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.destroy=function(){this._ready&&(this._rt0.destroy(),this._rt0=null,delete this._rt0,this._rt1.destroy(),this._rt1=null,delete this._rt1,this._rt2.destroy(),this._rt2=null,delete this._rt2,this._blur.destroy(),this._blur=null,delete this._blur,this._blit.destroy(),this._blit=null,delete this._blit,this._maskeds.destroy(),this._maskeds=null,delete this._maskeds,this._transparents&&(this._transparents.destroy(),this._transparents=null,delete this._transparents),this._opaques.destroy(),this._opaques=null,delete this._opaques),e.prototype.destroy.call(this)},t.prototype.recompileShader=function(e,t){this._ready&&(this._opaques.recompileOverridedShader(e,t),this._maskeds.recompileOverridedShader(e,t),this._hasTransparents&&this._transparents.recompileOverridedShader(e,t))},t.prototype.resize=function(e,t){this._ready&&(this._ready=!1,this._rt0.resize(e,t),this._rt1.resize(e,t),this._rt2.resize(e,t),this._ready=this._rt0.ready&&this._rt1.ready&&this._rt2.ready,this._ready||(this._ready=!0,this.destroy()))},t.prototype.draw=function(e,t){if(void 0===t&&(t=-1),this._ready&&this._enabled&&t&&!(t<1)){t-=1;var r=this._renderScene.getRenderer(),i=this._renderScene.getScene().getMainLight(),n=this._renderScene.getScene().clipping,a=this._renderScene.getCamera();if(!a._twoPointsPerpective){var o=this._renderScene.getResourceManager().gl;this.resize(a.viewport[2],a.viewport[3]),r.clear(this._rt0,o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),this._opaques.render(this._rt0,r,a,null,n,i),this._maskeds.render(this._rt0,r,a,null,n,i),this._hasTransparents&&this._transparents.render(this._rt0,r,a,null,n,i),this._blit.setParameter("uNearAxis",a.getNearPlaneSize()),this._blit.setParameter("uIsPerspective",a.isPerspective()),this._blit.setParameter("uTexTransform",[a.viewport[2]/this._rt0.getWidth(),a.viewport[0]/this._rt0.getWidth()]),this._blit.setParameter("uRadius",this._radius),this._blit.setParameter("uTexSizeAndInv",[this._rt0.getWidth(),this._rt0.getHeight(),1/this._rt0.getWidth(),1/this._rt0.getHeight()]),s.a.isMobile&&(this._blit.setParameter("uNearFar",[a._znear,a._zfar]),this._blit.setDepthTexture(this._rt0.getDepthBuffer())),this._blit.setParameter("uFrameCount",t),this._blit.setParameter("SAMPLES[0]",Gr._8x8_2D_LIST[t]),r.renderState.viewport([0,0,this._rt1.getWidth(),this._rt1.getHeight()]),this._blit.render(r,this._rt1);var l=this._blur.smooth(this._rt1,this._rt2,r,1);this._bitblit.setTexture(l),o.blendFuncSeparate(o.ZERO,o.SRC_COLOR,o.ZERO,o.ONE),r.renderState.viewport([0,0,e.getWidth(),e.getHeight()]),this._bitblit.render(r,e,!0,!0),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA)}}},t.prototype.onSceneChanged=function(e){if(this._ready){var t=this._renderScene.getOpaques(),r=this._renderScene.getMaskeds();if(this._opaques.queue.copy(t.queue,e),this._opaques.queue.drawables=this._opaques.queue.drawables.filter(function(e){return!e.popLodInfo}),this._maskeds.queue.copy(r.queue,e),this._opaques.setCullFace(t.getCullFace()),this._maskeds.setCullFace(r.getCullFace()),this._hasTransparents){var i=this._renderScene.getTransparents();this._transparents.queue.copy(i.queue,e),this._transparents.setCullFace(i.getCullFace())}}},t.prototype.setParameter=function(e,t){switch(e){case"radius":this._radius=t;break;case"transparents":if(this._hasTransparents=t,this._hasTransparents&&!this._transparents){this._transparents=new $t(this._renderScene.getResourceManager(),this._renderScene.getRenderQueueManager(),!1,{transparent:!0,mask:!1});var r=this._opaques.getOverridedShaders();this._transparents.setOverridedShader(r[0]),this._transparents.setOverridedMaterial(this._opaques.getOverridedMaterial());var i=this._renderScene.getTransparents();this._transparents.queue.copy(i.queue,-1),this._transparents.setCullFace(i.getCullFace())}}},t.prototype.addDrawable=function(e){e.popLodInfo||(this._opaques.queue.addDrawable(e)||this._maskeds.queue.addDrawable(e),this._hasTransparents&&this._transparents.queue.addDrawable(e))},t.prototype.removeDrawable=function(e){this._opaques.queue.removeDrawable(e)||this._maskeds.queue.removeDrawable(e),this._hasTransparents&&this._transparents.queue.removeDrawable(e)},t}(ti),li=function(){function e(e,t){this._resourceManager=e,this._renderQueueManager=t;var r=this._resourceManager.gl;r.isWebGL2||r.drawBuffers?(this._renderTarget=new Jt.a("woit-accum",e,1,1,{colorFormat:r.RGBA16F,colorBuffer:1,colorBuffers:[{colorFormat:r.R16F,index:2}],blend:!0,depthMask:!0,depthBuffer:0,depthTest:!0,depthFunc:r.LEQUAL,clearColor:[0,0,0,1]}),this._renderQueueSolid=this._renderQueueManager.getQueue({texture:!1,color:!1,line:!1,uniqueId:"OIT"}),this._renderQueueTexture=this._renderQueueManager.getQueue({texture:!0,color:!1,line:!1,uniqueId:"OIT"}),this._renderQueueColor=this._renderQueueManager.getQueue({texture:!1,color:!0,line:!1,uniqueId:"OIT"}),this._blit=new cr(e,N.a.woit_reveal),this._shadersSolid=new Array(3),this._shadersTexture=new Array(3),this._shadersColor=new Array(3),this._recompileShader(e,["MRT_OIT"]),this._overridedMaterial=null):console.warn("OIT is not supported in WebGL1.0 context")}return e.prototype.destroy=function(){this._blit.destroy(),this._blit=null,delete this._blit,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget;for(var e=0;e<this._shadersSolid.length;e++)this._shadersSolid[e].destroy();this._shadersSolid=null,delete this._shadersSolid;for(e=0;e<this._shadersTexture.length;e++)this._shadersTexture[e].destroy();this._shadersTexture=null,delete this._shadersTexture;for(e=0;e<this._shadersColor.length;e++)this._shadersColor[e].destroy();this._shadersColor=null,delete this._shadersColor},e.prototype._recompileShader=function(e,t){var r={woit_accum_solid:this._shadersSolid,woit_accum_texture:this._shadersTexture,woit_accum_color:this._shadersColor};for(var i in r){r[i][0]=e.getShader(i,t),r[i][0].ready||r[i][0].createFromShaderSource(N.a[i],t);var n=r[i][0],a=n.flags.concat("MODEL_TRANSFORM"),o=this._resourceManager.getShader(n.shaderSource.name,a);o.ready||o.createFromShaderSource(n.shaderSource,a),r[i][1]=o;var s=a.concat("INSTANCING"),l=this._resourceManager.getShader(n.shaderSource.name,s);l.ready||l.createFromShaderSource(n.shaderSource,s),r[i][2]=l}},e.prototype.resize=function(e,t){this._renderTarget.resize(e,t)},e.prototype.addDrawable=function(e){return!(e.material.getTransparent()>.99&&(null===this._overridedMaterial||this._overridedMaterial.getTransparent()>.99))&&(this._renderQueueSolid.addDrawable(e)||this._renderQueueTexture.addDrawable(e)||this._renderQueueColor.addDrawable(e))},e.prototype.removeDrawable=function(e){return this._renderQueueSolid.removeDrawable(e)||this._renderQueueTexture.removeDrawable(e)||this._renderQueueColor.removeDrawable(e)},e.prototype.createQueue=function(e,t){this._renderQueueSolid.create(e,t),this._renderQueueTexture.create(e,t),this._renderQueueColor.create(e,t)},e.prototype.setOverridedMaterial=function(e){this._overridedMaterial=null!==e?e:null},e.prototype.render=function(e,t,r,i,n,a){var o=this._resourceManager.gl;this.resize(r.viewport[2],r.viewport[3]),t.renderState.invalidateLight(),this._renderTarget.setOption("depthMask",!0),t.clear(this._renderTarget,o.COLOR_BUFFER_BIT),this._renderTarget.setOption("blendFunc",[o.ONE,o.ONE,o.ZERO,o.ONE_MINUS_SRC_ALPHA]),this._renderTarget.setOption("blend",!0),this._renderTarget.setOption("depthMask",!1),this._renderTarget.always=!0,this._renderTarget.render(t.renderState),o.clearBufferfv(o.COLOR,1,new Float32Array([0,0,0,1])),this._renderTarget.getFramebuffer().copy(e.getFramebuffer(),o.DEPTH_BUFFER_BIT),t.drawDrawables(this._renderTarget,this._renderQueueSolid.drawables,r,this._shadersSolid,this._overridedMaterial,n,a,i,null),t.drawDrawables(this._renderTarget,this._renderQueueTexture.drawables,r,this._shadersTexture,this._overridedMaterial,n,a,i,null),t.drawDrawables(this._renderTarget,this._renderQueueColor.drawables,r,this._shadersColor,this._overridedMaterial,n,a,i,null),e.setOption("blendFunc",[o.ONE_MINUS_SRC_ALPHA,o.SRC_ALPHA,o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA]),this._blit.setTexture(this._renderTarget.getColorBuffer(0)),this._blit.setParameter("uTexture1",this._renderTarget.getColorBuffer(1)),this._blit.render(t,e,!0)},e}(),ui=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ci=function(e){function t(t,r,i,n){var a=e.call(this,t,r,i,n)||this;return a._oitEnabled=!1,a._oit=null,a}return ui(t,e),t.prototype.destroy=function(){this._oitEnabled=null,delete this._oitEnabled,this._oit&&(this._oit.destroy(),this._oit=null,delete this._oit),e.prototype.destroy.call(this)},t.prototype.setOITEnabled=function(e){var t=this;this._oitEnabled=e,this._oitEnabled&&!this._oit&&(this._oit=new li(this._resourceManager,this._renderQueueManager),this.queue.drawables.forEach(function(e){t._oit.addDrawable(e)}))},t.prototype.resize=function(e,t){this._oit&&this._oit.resize(e,t)},t.prototype.setOverridedMaterial=function(t){e.prototype.setOverridedMaterial.call(this,t),this._oit&&this._oit.setOverridedMaterial(t)},t.prototype.setOverridedShader=function(t){if(null!==t){if(this._overridedMaterial){var r=this._overridedMaterial;this._overridedMaterial=this._overridedMaterial.clone("overridedMaterial")}e.prototype.setOverridedShader.call(this,t),r&&(this._overridedMaterial=r)}else e.prototype.setOverridedShader.call(this,t)},t.prototype.addDrawable=function(t){return this._oit&&this._oit.addDrawable(t),e.prototype.addDrawable.call(this,t)},t.prototype.removeDrawable=function(t){return this._oit&&this._oit.removeDrawable(t),e.prototype.removeDrawable.call(this,t)},t.prototype.createQueue=function(t,r){this._oit&&this._oit.createQueue(t,r),e.prototype.createQueue.call(this,t,r)},t.prototype.render=function(t,r,i,n,a,o){if(this._oitEnabled&&this._oit)this._oit.render(t,r,i,n,a,o);else{var s=this._resourceManager.gl;t.setOption("blend",!0),t.setOption("depthMask",!1),t.always=!0,t.setOption("blendFunc",[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA]),this._overridedMaterial&&this._overridedMaterial.useDepthMask&&t.setOption("depthMask",!0),e.prototype.render.call(this,t,r,i,n,a,o),t.setOption("blend",!1),t.setOption("depthMask",!0),t.always=!0}},t}($t),hi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),di=function(e){function t(t){var r=e.call(this,"Glow",jr.NORMAL,t)||this;r._radius=32,r._intensity=.5;var i=[],n=r._renderScene.getScene();if(n.clipping.isEnabled()&&i.push("CLIPPING"),n.needRenderDoubleSided()&&i.push("DOUBLESIDED"),n.compressed&&i.push("COMPRESSION"),s.a.isMobile&&i.push("ENCODE_NORMAL"),i.push("VISIBILITY"),r._shader=t.getResourceManager().getShader("plain",i),!r._shader.ready){var a=N.a.plain;r._shader.createFromShaderSource(a,i)}return r._blur=new ai(t.getResourceManager(),r._radius,3),r._renderPasses=new Map,r._opaques=new $t(t.getResourceManager(),t.getRenderQueueManager(),!1,{line:!1,transparent:!1,mask:!1,uniqueId:"glow"}),r._transparents=new ci(t.getResourceManager(),t.getRenderQueueManager(),!0,{line:!1,transparent:!0,uniqueId:"glow"}),r}return hi(t,e),t.prototype.destroy=function(){this._blit.destroy(),this._blit=null,delete this._blit,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._renderTarget2.destroy(),this._renderTarget2=null,delete this._renderTarget2,e.prototype.destroy.call(this)},t.prototype._initialize=function(){var e=this._renderScene.getResourceManager(),t=e.gl;if(!t.isWebGL2)return console.warn("Glow effect needs webGL2.0 support!"),this._ready=!1,!1;this._blit=new cr(e,N.a.blit_glow,s.a.isMobile),this._blit.setParameter("offset",0);var r=this._renderScene.getCamera();return s.a.isMobile?(this._renderTarget=new Jt.a("glow-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],depthFunc:t.LEQUAL,colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:0,depthBuffer:0,depthFilter:t.NEAREST,depthTest:!0}),this._renderTarget2=new Jt.a("glow-blur-rt",e,r.viewport[2],r.viewport[3],{clearColor:[1,1,1,0],colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:2})):(this._renderTarget=new Jt.a("glow-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],depthFunc:t.LEQUAL,colorFilter:t.NEAREST,colorBuffer:1,depthBuffer:0,depthFilter:t.NEAREST,depthTest:!0}),this._renderTarget2=new Jt.a("glow-blur-rt",e,r.viewport[2],r.viewport[3],{clearColor:[1,1,1,0],colorFilter:t.NEAREST,colorBuffer:2})),this._blit.ready&&this._renderTarget.ready&&this._renderTarget2},t.prototype.resize=function(e,t){this._ready&&(this._ready=!1,this._renderTarget.resize(e,t),this._renderTarget2.resize(e,t),this._ready=this._renderTarget.ready&&this._renderTarget2.ready)},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupportWebGL1=function(){return!1},t.prototype.onSceneChanged=function(e){this._ready},t.prototype.setParameter=function(e,t){switch(e){case"intensity":this._intensity=t,this._blit.setParameter("intensity",t)}},t.prototype.afterElementsAdded=function(e){e.setUseTransparent(!1)},t.prototype.addCustomDrawable=function(e){this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)},t.prototype.removeCustomDrawable=function(e){this._opaques.queue.removeDrawable(e)||this._transparents.queue.addDrawable(e)},t.prototype.addPawn=function(e){var t=this;e.drawables.forEach(function(e){t._opaques.queue.addDrawable(e)||t._transparents.queue.addDrawable(e)})},t.prototype.removePawn=function(e){var t=this;e.drawables.forEach(function(e){t._opaques.queue.removeDrawable(e)||t._transparents.queue.removeDrawable(e)})},t.prototype.draw=function(e,t){var r=this;if(void 0===t&&(t=-1),this._enabled&&this._ready){var i=this._renderScene.getCamera(),n=this._renderScene.getRenderer(),a=this._renderScene.getScene().getMainLight(),o=this._renderScene.getScene().clipping;this.resize(i.viewport[2],i.viewport[3]);var s=this._renderScene.getResourceManager().gl;t<0&&!e.getOption("stencilTest")&&this._renderTarget.getFramebuffer().copy(e.getFramebuffer(),s.DEPTH_BUFFER_BIT),n.clear(this._renderTarget,s.COLOR_BUFFER_BIT),s.enable(s.POLYGON_OFFSET_FILL),s.polygonOffset(-1,-1),this._renderPasses.forEach(function(e){e.renderPass.render(r._renderTarget,n,i,null,o,a)}),this._opaques.render(this._renderTarget,n,i,null,o,a),this._transparents.render(this._renderTarget,n,i,null,o,a),s.disable(s.POLYGON_OFFSET_FILL);var l=this._blur.smooth(this._renderTarget,this._renderTarget2,n,1);this._blit.setTexture(l);var u=this._renderTarget.getOption("blendFunc");e.setOption("blendFunc",[s.ONE,s.ONE,s.ONE,s.ONE]),this._blit.render(n,e,!0),e.setOption("blendFunc",u)}},t}(ti),pi=function(){function e(e,t){this.ready=!1,this.result=null,this._blitx=new cr(e,N.a.glow_blur,s.a.isMobile),this._blitx.setParameter("radius",t),this._blitx.setParameter("direction",[1,0]),this._blitx.setParameter("weights[0]",[.05,.1,.2,.3,.2,.1,.05]),this._blity=new cr(e,N.a.glow_blur,s.a.isMobile),this._blity.setParameter("radius",t),this._blity.setParameter("direction",[0,1]),this._blity.setParameter("weights[0]",[.05,.1,.2,.3,.2,.1,.05]),this.ready=this._blitx.ready&&this._blity.ready}return e.prototype.destroy=function(){this.ready&&(this._blitx.destroy(),this._blitx=null,delete this._blitx,this._blity.destroy(),this._blity=null,delete this._blity,this.ready=!1)},e.prototype.setRadius=function(e){this._blitx.setParameter("radius",e),this._blity.setParameter("radius",e)},e.prototype.smooth=function(e,t,r){return this.ready?(e.getWidth()==t.getWidth()&&e.getHeight()==t.getHeight()||console.error("'blur' requires two render targets in the same size."),this._blitx.setTexture(e.getColorBuffer()),this._blitx.render(r,t),this._blity.setTexture(t.getColorBuffer()),this._blity.render(r,e),this.result=e.getColorBuffer(),this.result):(console.error("'blur' is not ready."),null)},e}(),fi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),mi=function(e){function t(t){var r=e.call(this,"Highlight",jr.NORMAL,t)||this;r._radius=2,r._intensity=.5,r._innerGlow=!1,r._outerGlow=!0;var i=[],n=r._renderScene.getScene();if(n.clipping.isEnabled()&&i.push("CLIPPING"),n.needRenderDoubleSided()&&i.push("DOUBLESIDED"),n.compressed&&i.push("COMPRESSION"),s.a.isMobile&&i.push("MOBILE"),i.push("VISIBILITY"),r._shader=t.getResourceManager().getShader("plain",i),!r._shader.ready){var a=N.a.plain;r._shader.createFromShaderSource(a,i)}return r._blur=new pi(t.getResourceManager(),r._radius),r._renderPasses=new Map,r._opaques=new $t(t.getResourceManager(),t.getRenderQueueManager(),!1,{line:!1,transparent:!1,mask:!1,uniqueId:"highlight"}),r._transparents=new ci(t.getResourceManager(),t.getRenderQueueManager(),!0,{line:!1,transparent:!0,uniqueId:"highlight"}),r}return fi(t,e),t.prototype.destroy=function(){this._blit.destroy(),this._blit=null,delete this._blit,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._renderTarget2.destroy(),this._renderTarget2=null,delete this._renderTarget2,e.prototype.destroy.call(this)},t.prototype._initialize=function(){var e=this._renderScene.getResourceManager(),t=e.gl;this._blit=new cr(e,N.a.blit_glow,s.a.isMobile);var r=this._renderScene.getCamera();return s.a.isMobile?(this._renderTarget=new Jt.a("highlight-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],depthFunc:t.LEQUAL,colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:0,depthBuffer:0,depthFilter:t.NEAREST,depthTest:!0,stencilTest:!0}),this._renderTarget2=new Jt.a("highlight-blur-rt",e,r.viewport[2],r.viewport[3],{clearColor:[1,1,1,0],colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:2})):(this._renderTarget=new Jt.a("highlight-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],depthFunc:t.LEQUAL,colorFilter:t.NEAREST,colorBuffer:1,depthBuffer:0,depthFilter:t.NEAREST,depthTest:!0,stencilTest:!0}),this._renderTarget2=new Jt.a("highlight-blur-rt",e,r.viewport[2],r.viewport[3],{clearColor:[1,1,1,0],colorFilter:t.NEAREST,colorBuffer:2})),this._blit.setParameter("intensity",this._intensity),this._blit.ready&&this._renderTarget.ready&&this._renderTarget2},t.prototype.resize=function(e,t){this._ready&&(this._ready=!1,this._renderTarget.resize(e,t),this._renderTarget2.resize(e,t),this._ready=this._renderTarget.ready&&this._renderTarget2.ready)},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.onSceneChanged=function(e){this._ready},t.prototype.setParameter=function(e,t){switch(e){case"intensity":this._intensity=t,this._blit.setParameter("intensity",this._intensity);break;case"radius":this._radius=t,this._blur.setRadius(this._radius);break;case"innerGlow":this._innerGlow=!0}},t.prototype.afterElementsAdded=function(e){e.setUseTransparent(!1)},t.prototype.addCustomDrawable=function(e){this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)},t.prototype.removeCustomDrawable=function(e){this._opaques.queue.removeDrawable(e)||this._transparents.queue.addDrawable(e)},t.prototype.draw=function(e,t){var r=this;if(void 0===t&&(t=-1),this._enabled&&this._ready){var i=this._renderScene.getCamera(),n=this._renderScene.getRenderer(),a=this._renderScene.getScene().getMainLight(),o=this._renderScene.getScene().clipping;this.resize(i.viewport[2],i.viewport[3]);var s=this._renderScene.getResourceManager().gl;this._renderScene.getRenderer().clear(this._renderTarget,s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT|s.STENCIL_BUFFER_BIT);var l=e.getOption("stencilFunc"),u=e.getOption("stencilOp"),c=e.getOption("colorMask");e.setOption("colorMask",[!1,!1,!1,!1]),e.setOption("stencilFunc",[s.ALWAYS,1,255]),e.setOption("stencilOp",[s.KEEP,s.KEEP,s.REPLACE]),e.setOption("depthTest",!1),e.setOption("stencilMask",!0),e.always=!0,n.clear(e,s.STENCIL_BUFFER_BIT),this._renderPasses.forEach(function(t){t.renderPass.render(r._renderTarget,n,i,null,o,a),t.renderPass.render(e,n,i,null,o,a)}),this._opaques.render(this._renderTarget,n,i,null,o,a),this._transparents.render(this._renderTarget,n,i,null,o,a),this._opaques.render(e,n,i,null,o,a),this._transparents.render(e,n,i,null,o,a);var h=this._blur.smooth(this._renderTarget,this._renderTarget2,n);this._blit.setTexture(h),e.setOption("colorMask",c),e.setOption("depthTest",!0),this._outerGlow&&(this._blit.setParameter("offset",0),e.setOption("stencilFunc",[s.NOTEQUAL,1,255]),this._blit.render(n,e,!0)),this._innerGlow&&(this._blit.setParameter("offset",1),e.setOption("stencilFunc",[s.EQUAL,1,255]),this._blit.render(n,e,!0)),e.setOption("stencilFunc",l),e.setOption("stencilOp",u),e.setOption("stencilMask",!1),e.always=!0}},t}(ti),_i=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),vi={Sketch:ii,SSAO:si,Glow:di,Highlight:mi,DepthOfField:function(e){function t(t){var r=e.call(this,"DepthOfField",jr.LOW,t)||this;r._opaques=new $t(t.getResourceManager(),t.getRenderQueueManager(),!1,{line:!1,transparent:!1,mask:!1,uniqueId:"DepthOfField"}),r._transparents=new $t(t.getResourceManager(),t.getRenderQueueManager(),!1,{line:!1,transparent:!0,uniqueId:"DepthOfField"}),r._useDepth=!1;var i,n=[],a=r._renderScene.getScene();if(a.clipping.isEnabled()&&n.push("CLIPPING"),a.needRenderDoubleSided()&&n.push("DOUBLESIDED"),a.compressed&&n.push("COMPRESSION"),n.push("ENCODE_DEPTH"),n.push("VISIBILITY"),!(i=t.getResourceManager().getShader("depth",n)).ready){var o=N.a.depth;i.createFromShaderSource(o,n)}r._opaques.setOverridedShader(i),r._transparents.setOverridedShader(i);var s=new V("dof-depth",t.getResourceManager());return r._opaques.setOverridedMaterial(s),r._transparents.setOverridedMaterial(s),r}return _i(t,e),t.prototype.destroy=function(){this._blit.destroy(),this._blit=null,delete this._blit,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,e.prototype.destroy.call(this)},t.prototype._initialize=function(){var e=this._renderScene.getResourceManager(),t=e.gl;this._blit=new cr(e,N.a.blit_dof,s.a.isMobile),this._blit.setParameter("maxblur",1),this._blit.setParameter("aperture",1e-5),this._blit.setParameter("focus",5e3);var r=this._renderScene.getCamera();return t.isWebGL2?(s.a.isMobile?this._renderTarget=new Jt.a("DepthOfField-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],colorFormat:t.RGBA8,colorFilter:t.NEAREST,colorBuffer:3}):this._renderTarget=new Jt.a("DepthOfField-rt",e,r.viewport[2],r.viewport[3],{clearColor:[0,0,0,0],colorFilter:t.NEAREST,colorBuffer:3}),this._blit.ready&&this._renderTarget.ready):(this._colorBuffer=this._renderScene.getResourceManager().getTexture("DOF-color-buffer"),this._colorBuffer.create(r.viewport[2],r.viewport[3],t.wbFormat,t.NEAREST,t.CLAMP_TO_EDGE),this._blit.ready&&this._colorBuffer.ready)},t.prototype.resize=function(e,t){this._ready&&(this._ready=!1,this._renderScene.getResourceManager().gl.isWebGL2?(this._renderTarget.resize(e,t),this._ready=this._renderTarget.ready):(this._colorBuffer.resize(e,t),this._ready=this._colorBuffer.ready),this._renderTarget2&&this._renderTarget2.ready&&(this._renderTarget2.resize(e,t),this._ready=this._ready&&this._renderTarget2.ready))},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.onSceneChanged=function(e){var t=this;if(this._ready){this._opaques.queue.removeDrawables(),this._transparents.queue.removeDrawables();var r=this._renderScene.getScene();for(var i in r.models){r.models[i].drawables.forEach(function(e){t._opaques.queue.addDrawable(e)||t._transparents.queue.addDrawable(e)})}var n=this._renderScene.getOpaques();this._opaques.setCullFace(n.getCullFace());var a=this._renderScene.getTransparents();this._transparents.setCullFace(a.getCullFace())}},t.prototype.setParameter=function(e,t){switch(e){case"depth":var r=this._renderScene.getResourceManager().getTexture("dof-depth"),i=this._renderScene.getResourceManager().gl,n=t.split("."),a=i.RGB;"png"===n[n.length-1]&&(a=i.RGBA),r.createFromFile(t,a,i.NEAREST,i.CLAMP_TO_EDGE,function(){}),this._blit.setDepthTexture(r);break;case"useDepth":if(this._useDepth=t,!this._renderTarget2&&t){i=this._renderScene.getResourceManager().gl;var o=this._renderScene.getCamera();this._renderTarget2=new Jt.a("dof-depth",this._renderScene.getResourceManager(),o.viewport[2],o.viewport[3],{clearColor:[0,0,0,1],colorFormat:i.RGBA8,colorFilter:i.NEAREST,colorBuffer:4})}if(this._blit.setParameter("useDepth",t),t)this._blit.setDepthTexture(this._renderTarget2.getColorBuffer());else(r=this._renderScene.getResourceManager().getTexture("dof-depth"))&&r.ready&&this._blit.setDepthTexture(r);break;case"aperture":this._blit.setParameter("aperture",t);break;case"focus":this._blit.setParameter("focus",t)}},t.prototype.addDrawable=function(e){this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)},t.prototype.removeDrawable=function(e){this._opaques.queue.removeDrawable(e)||this._transparents.queue.removeDrawable(e)},t.prototype.addCustomDrawable=function(e){this._opaques.queue.addDrawable(e)||this._transparents.queue.addDrawable(e)},t.prototype.removeCustomDrawable=function(e){this._opaques.queue.removeDrawable(e)||this._transparents.queue.addDrawable(e)},t.prototype.draw=function(e,t){if(void 0===t&&(t=-1),this._enabled&&this._ready){var r=this._renderScene.getCamera(),i=this._renderScene.getRenderer(),n=this._renderScene.getScene().getMainLight(),a=this._renderScene.getScene().clipping,o=this._renderScene.getResourceManager().gl;this._useDepth&&(i.clear(this._renderTarget2,o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),this._opaques.render(this._renderTarget2,i,r,null,a,n),this._transparents.render(this._renderTarget2,i,r,null,a,n)),this._blit.setParameter("nearFar",[r._znear,r._zfar]),o.isWebGL2?(this._renderTarget.getFramebuffer().copy(e.getFramebuffer(),o.COLOR_BUFFER_BIT),this._blit.setTexture(this._renderTarget.getColorBuffer())):(i.renderState.useFramebuffer(e.getFramebuffer()),this._colorBuffer.copy(),this._blit.setTexture(this._colorBuffer)),this._blit.render(i,e)}},t}(ti)},yi=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},gi=function(){function e(e,t){this._nDrawalbes=0,this.name=e,this.drawables=[],this._lastUpdated=-1.01,this._setSelector(t)}return e.prototype.dump=function(){var e,t;console.groupCollapsed("RenderQueue: "+this.name),console.groupCollapsed("Drawables: "+this.drawables.length);try{for(var r=yi(this.drawables),i=r.next();!i.done;i=r.next()){i.value.dump()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}console.groupEnd(),console.log("_lastUpdated: "+this._lastUpdated),console.groupEnd()},e.prototype.destroy=function(){this.drawables=null,delete this.drawables},e.prototype.removeDrawables=function(){this.drawables=[]},e.prototype.removeDrawable=function(e){for(var t=this.drawables.length-1;t>=0;t--)if(this.drawables[t]===e)return this.drawables.splice(t,1),!0;return!1},e.prototype.addDrawable=function(t){return!(!this._selector(t)||-1!=this.drawables.indexOf(t))&&(this._nDrawalbes++,e._nTotalDrawables++,this.drawables.push(t),!0)},e.prototype.create=function(e,t){if(!(this._lastUpdated>=t)){for(var r in this.drawables=[],e.models)for(var i=e.models[r],n=0,a=i.drawables.length;n<a;n++)this.addDrawable(i.drawables[n]);if(null!=e.terrain)for(var o=e.terrain,s=0,l=o.tiles.length;s<l;s++)this.addDrawable(o.tiles[s].drawable);this._lastUpdated=t,this.optimize()}},e.prototype.isValid=function(){return this.drawables.length>0},e.prototype.optimize=function(){0!==this.drawables.length&&this.drawables.sort(function(e,t){return e.shader.name.localeCompare(t.shader.name)})},e.prototype._setSelector=function(e){this._selector=function(t){return!e||(void 0===e.line||e.line===t.mesh.isLine())&&((void 0===e.texture||e.texture===t.material.hasTexture)&&((void 0===e.color||e.color===t.mesh.attributes.hasColor)&&((void 0===e.mask||e.mask===t.material.hasMask)&&((void 0===e.transparent||e.transparent===t.material.transparent)&&(void 0===e.shadowCaster||e.shadowCaster===t.isShadowCaster())))))}},e.prototype.sort=function(e){if(this.isValid()){for(var t=e.getViewDirection(),r=U.d.create(),i=0,n=this.drawables.length;i<n;++i){var a=this.drawables[i];U.d.subtract(r,a.bsphere,e.eye),a.distance=U.d.dot(r,t)}this.drawables.sort(function(e,t){return t.distance-e.distance})}},e.prototype.copy=function(e,t){if(this.name!==e.name&&!(this._lastUpdated>=t&&t>0)){this.drawables=[];for(var r=0;r<e.drawables.length;r++){var i=e.drawables[r];this._selector(i)&&this.drawables.push(i)}t>0&&(this._lastUpdated=t)}},e._nTotalDrawables=0,e}(),bi=function(){function e(){this._queues=new Map}return e.prototype.destroy=function(){this._queues.clear(),this._queues=null,delete this._queues},e.prototype.getQueue=function(e){var t="";return e?(t+=void 0===e.line?"":e.line?"_Line_":"_Not_Line_",t+=void 0===e.texture?"":e.texture?"_Texture_":"_Not_Texture_",t+=void 0===e.color?"":e.color?"_Color_":"_Not_Color_",t+=void 0===e.mask?"":e.mask?"_Mask_":"_Not_Mask_",t+=void 0===e.transparent?"":e.transparent?"_Transparent_":"_Not_Transparent_",t+=void 0===e.shadowCaster?"":e.shadowCaster?"_ShadowCaster_":"_Not_ShadowCaster_",t+=void 0===e.uniqueId?"":e.uniqueId):t="default",this._queues.has(t)||this._queues.set(t,new gi(t,e)),this._queues.get(t)},e}(),wi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),xi=function(e){function t(t,r,i){return e.call(this,t,r,i,null)||this}return wi(t,e),t.prototype.setOverridedMaterial=function(t){e.prototype.setOverridedMaterial.call(this,t)},t.prototype.setOverridedShader=function(t){if(null!==t){if(this._overridedMaterial){var r=this._overridedMaterial;this._overridedMaterial=this._overridedMaterial.clone("overridedMaterial")}e.prototype.setOverridedShader.call(this,t),r&&(this._overridedMaterial=r)}else e.prototype.setOverridedShader.call(this,t)},t.prototype.addDrawable=function(t){return e.prototype.addDrawable.call(this,t)},t.prototype.removeDrawable=function(t){return e.prototype.removeDrawable.call(this,t)},t.prototype.createQueue=function(t,r){e.prototype.createQueue.call(this,t,r)},t.prototype.render=function(t,r,i,n,a,o){this._resourceManager.gl;t.setOption("blend",!0),t.setOption("depthTest",!1),t.always=!0,e.prototype.renderMark.call(this,t,r,i,n,a,o),t.setOption("blend",!1),t.setOption("depthTest",!0),t.always=!0},t}($t),Mi=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ti=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},Ei=function(){function e(e,t,r,i,n){this._effects={},this._sortedEffects=[],this._hasModel=!1,this._flags={},this._overridedMaterials={},this._scene=e,this._camera=t,this._resourceManager=r,this._renderer=i,this.previous=null,this._effects={},this._sortedEffects=[],this._visualizes=[],this._renderQueueManager=new bi,this._opaques=new $t(r,this._renderQueueManager,!1,{line:!1,transparent:!1,mask:!1}),this._maskeds=new $t(r,this._renderQueueManager,!1,{line:!1,transparent:!1,mask:!0}),this._transparents=new ci(r,this._renderQueueManager,!0,{line:!1,transparent:!0}),this._lines=new $t(r,this._renderQueueManager,!1,{line:!0}),this._bbox=new $t(r,this._renderQueueManager,!1,{line:!0,transparent:!1}),this._marks=new xi(r,this._renderQueueManager,!1),this._nodes=new Jr(r,this._renderQueueManager),this._renderPassAll=new ci(r,this._renderQueueManager,!1,{line:!1}),this._skeletons=[],this._flags={doubleSided:!1,clipping:!1,line:!1,oit:!1,overridedMaterial:!1};var a=this._resourceManager.gl;a.isWebGL2?(this._renderTarget=new Jt.a("pipeline",this._resourceManager,t.viewport[2],t.viewport[3],{stencilTest:!!n,samples:a.wbSamples,depthFunc:a.LEQUAL,colorFilter:a.NEAREST,colorFormat:a.wbFormat,colorBuffer:0,depthBuffer:0,depthFilter:a.NEAREST}),this._renderTarget.ready||(console.warn("Can't create multisamples render buffer for 'pipeline' and use single-sample render buffer now."),this._renderTarget=new Jt.a("pipeline",this._resourceManager,t.viewport[2],t.viewport[3],{stencilTest:!!n,samples:1,depthFunc:a.LEQUAL,colorFilter:a.NEAREST,colorFormat:a.wbFormat,colorBuffer:0,depthBuffer:0,depthFilter:a.NEAREST}))):this._renderTarget=new Jt.a("default",this._resourceManager,t.viewport[2],t.viewport[3],{stencilTest:!!n,depthFunc:a.LEQUAL,colorFilter:a.NEAREST,colorFormat:a.wbFormat,colorBuffer:0,depthBuffer:0,depthFilter:a.NEAREST})}return e.prototype.dump=function(){console.groupCollapsed("RenderScene"),this._dumpScene(),this._dumpRenderPasses(),this._dumpEffects(),this._dumpFlags(),this._dumpOveridedMaterials(),this._dumpOveridedShader(),console.groupEnd()},e.prototype._dumpScene=function(){this._scene.dump()},e.prototype._dumpRenderPasses=function(){this._opaques.dump("_opaques"),this._transparents.dump("_transparents"),this._maskeds.dump("_maskeds"),this._lines.dump("_lines"),this._bbox.dump("_bbox"),this._nodes.dump("_nodes"),this._renderPassAll.dump("_renderPassAll")},e.prototype._dumpEffects=function(){var e,t;console.groupCollapsed("Effects: "+Object.keys(this._effects).length);try{for(var r=Mi(Object.entries(this._effects)),i=r.next();!i.done;i=r.next()){var n=Ti(i.value,2),a=n[0],o=n[1];console.log(a+": ",o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}console.groupEnd()},e.prototype._dumpFlags=function(){var e,t;console.groupCollapsed("Flags: "+Object.keys(this._flags).length);try{for(var r=Mi(Object.entries(this._flags)),i=r.next();!i.done;i=r.next()){var n=Ti(i.value,2),a=n[0],o=n[1];console.log(a+": "+o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}console.groupEnd()},e.prototype._dumpOveridedMaterials=function(){var e,t;console.groupCollapsed("OveridedMaterials: "+Object.keys(this._overridedMaterials).length);try{for(var r=Mi(Object.entries(this._overridedMaterials)),i=r.next();!i.done;i=r.next()){var n=Ti(i.value,2),a=n[0],o=n[1];console.log(a+": ",o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}console.groupEnd()},e.prototype._dumpOveridedShader=function(){console.log("OveridedShader: ",this._overridedShader)},e.prototype.destroy=function(){for(var e in this._scene=null,delete this._scene,this._camera=null,delete this._camera,this._resourceManager=null,delete this._resourceManager,this._renderer=null,delete this._renderer,this._effects)this._effects[e].destroy();this._effects=null,delete this._effects,this._sortedEffects=null,delete this._sortedEffects,this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,this._opaques.destroy(),this._opaques=null,delete this._opaques,this._maskeds.destroy(),this._maskeds=null,delete this._maskeds,this._transparents.destroy(),this._transparents=null,delete this._transparents,this._lines.destroy(),this._lines=null,delete this._lines,this._bbox.destroy(),this._bbox=null,delete this._bbox,this._nodes.destroy(),this._nodes=null,delete this._nodes,this._flags=null,delete this._flags,this.previous=null,delete this.previous,this._renderQueueManager.destroy(),this._renderQueueManager=null,delete this._renderQueueManager},e.prototype.draw=function(e){return void 0===e&&(e=!1),!1},e.prototype.drawHD=function(){},e.prototype.resize=function(e,t){for(var r in this._effects)this._effects[r].resize(e,t);this._scene.background.skybox&&this._scene.background.skybox.resize(e,t),this._transparents.resize(e,t),this._visualizes.forEach(function(r){r.resize(e,t)})},e.prototype.addEffect=function(e){if(!this._effects.hasOwnProperty(e)){var t=new vi[e](this);if(!t.doesSupportMobile(s.a.isMobile))return t.destroy(),void console.warn("Effect "+e+" is not supported on mobile!");this._effects[t.name]=t;for(var r=this._sortedEffects.length,i=0,n=this._sortedEffects.length;i<n;i++)if(this._sortedEffects[i].priority<t.priority){r=i;break}this._sortedEffects.length===r?this._sortedEffects.push(t):this._sortedEffects.splice(r,0,t),t.onSceneChanged()}},e.prototype.removeEffect=function(e){if(this._effects.hasOwnProperty(e)){var t=this._effects[e],r=this._sortedEffects.indexOf(t);this._sortedEffects.splice(r,1),t.destroy(),delete this._effects[e]}},e.prototype.getEffect=function(e){return this._effects.hasOwnProperty(e)?this._effects[e]:(console.warn("Effect '"+e+"' does not exist!"),null)},e.prototype.isEffectEnabled=function(e){return!!this._effects[e]&&this._effects[e].isEnabled()},e.prototype.setEffectEnabled=function(e,t){this._effects.hasOwnProperty(e)||this.addEffect(e),this._effects[e].setEnabled(t)},e.prototype.addVisualize=function(e){return s.a.isMobile&&!e.doesSupportMobile(s.a.isMobile)?(e.destroy(),void console.warn("Visualize "+name+" is not supported on mobile!")):this._resourceManager.gl.isWebGL2||e.doesSupportWebGL1()?void this._visualizes.push(e):(e.destroy(),void console.warn("Visualize "+name+" is not supported in webgl 1.0 context!"))},e.prototype.removeVisualize=function(e){var t=this._visualizes.indexOf(e);-1!==t&&this._visualizes.splice(t,1)},e.prototype.getVisualize=function(e,t){for(var r=0,i=0;i<this._visualizes.length;i++)if(-1!==this._visualizes[i].name.indexOf(e)){if(t===r)return this._visualizes[i];r++}return null},e.prototype.getVisualizes=function(e){for(var t=[],r=0;r<this._visualizes.length;r++)-1!==this._visualizes[r].name.indexOf(e)&&t.push(this._visualizes[r]);return t},e.prototype.getAllVisualizes=function(){return this._visualizes},e.prototype.setOverridedMaterials=function(e){if(this._overridedMaterials=e,!e)return this._removeOverridedMaterials();this._overrideAllRenderPassMaterial(e.all),this._overrideSpecificRenderPassMaterial(e)},e.prototype._removeOverridedMaterials=function(){this._flags.overridedMaterial=!1,this._lines.setOverridedMaterial(null),this._opaques.setOverridedMaterial(null),this._transparents.setOverridedMaterial(null),this._maskeds.setOverridedMaterial(null),this._renderPassAll.setOverridedMaterial(null),this._renderPassAll.createQueue(this._scene,performance.now())},e.prototype._getOnePixelDummyWhiteTexture=function(){var e=this._resourceManager.getTexture("white");if(e.ready)return e;var t=this._resourceManager.gl;return e.create(1,1,t.RGBA8,t.NEAREST,t.CLAMP_TO_EDGE),e.update(new Uint8Array([255,255,255,255])),e},e.prototype._getDefaultTextureShader=function(){var e=this._resourceManager.getShader("texture",[]);if(e.ready)return e;var t=N.a.texture;return e.createFromShaderSource(t,[]),e},e.prototype._attachDummyTextureTo=function(e){e.hasTexture||(e.attachShader(this._getDefaultTextureShader(),this._resourceManager),e.setDiffuseTexture(this._getOnePixelDummyWhiteTexture()))},e.prototype._overrideAllRenderPassMaterial=function(e){e&&(this._flags.overridedMaterial=!0,this._attachDummyTextureTo(e),this._renderPassAll.setOverridedMaterial(e),this._renderPassAll.createQueue(this._scene,performance.now()),this._lines.setOverridedMaterial(e),this._opaques.setOverridedMaterial(e),this._transparents.setOverridedMaterial(e),this._maskeds.setOverridedMaterial(e))},e.prototype._overrideSpecificRenderPassMaterial=function(e){this._overrideLinesMaterial(e.lines),this._overrideMaskedsMaterial(e.maskeds),this._overrideOpaquesMaterial(e.opaques),this._overrideTransparentsMaterial(e.transparents)},e.prototype._overrideLinesMaterial=function(e){e&&this._lines.setOverridedMaterial(e)},e.prototype._overrideMaskedsMaterial=function(e){e&&this._maskeds.setOverridedMaterial(e)},e.prototype._overrideOpaquesMaterial=function(e){e&&(this._attachDummyTextureTo(e),this._opaques.setOverridedMaterial(e))},e.prototype._overrideTransparentsMaterial=function(e){e&&(this._attachDummyTextureTo(e),this._transparents.setOverridedMaterial(e))},e.prototype.getOverridedMaterials=function(){return this._overridedMaterials},e.prototype.setOverridedShaders=function(e){null!==e?this._overrideShaders(e):this._clearOverridedShaders()},e.prototype._clearOverridedShaders=function(){this._overridedShader=null,this._renderPassAll.setOverridedShader(null),this._lines.setOverridedShader(null),this._opaques.setOverridedShader(null),this._transparents.setOverridedShader(null),this._maskeds.setOverridedShader(null)},e.prototype._overrideShaders=function(e){this._renderPassAll.setOverridedShader(e),this._lines.setOverridedShader(e),this._opaques.setOverridedShader(e),this._transparents.setOverridedShader(e);var t=this._attachAlphaTestFlagTo(e);this._maskeds.setOverridedShader(t)},e.prototype._attachFlagsTo=function(e){var t=[];this._scene.needRenderDoubleSided()&&t.push("DOUBLESIDED"),this._flags.section&&t.push("CLIPPING"),this._flags.base?t.push("BASE"):(this._flags.shadow&&t.push("SHADOW"),this._flags.specular&&t.push("SPECULAR")),this._flags.gamma&&t.push("GAMMA"),s.a.isMobile&&t.push("MOBILE"),this._scene.compressed&&t.push("COMPRESSION");var r=e.shaderSource.name,i=this._resourceManager.getShader(r,t);if(!i.ready){var n=N.a[r];i.createFromShaderSource(n,t)}return i},e.prototype._attachAlphaTestFlagTo=function(e){var t=e.shaderSource.name,r=e.flags.concat("ALPHATEST"),i=this._resourceManager.getShader(t,r);if(!i.ready){var n=N.a[t];i.createFromShaderSource(n,r)}return i},e.prototype.getOverridedShader=function(){return this._overridedShader},e.prototype.restorePreSelectedNodes=function(e){void 0===e&&(e=!1),this._nodes.restorePreSelectedNodes(e)},e.prototype.getDrawablesInfluencedByCurSelectedNodes=function(){return this._nodes.getCurSelectedDrawables()},e.prototype.getCurSelectedNodes=function(){return this._nodes.getCurSelectedNodes()},e.prototype.setCurSelectedNodesColor=function(e,t){this._nodes.setCurSelectedNodesColor(e,t)},e.prototype.renderElements=function(e,t,r){var i,n;if(void 0===t&&(t=!1),e){var a=[];try{for(var o=Mi(e),s=o.next();!s.done;s=o.next()){var l=s.value,u=l.split("+")[0],c=this._scene.models[u].tree.elements[l];if(c)c.getNodes().forEach(function(e){!t&&e.drawable.mesh.isLine()||a.push(e)});else console.warn("Element: +"+l+" can not be found!")}}catch(e){i={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}this._nodes.setCurSelectedNodes(a,r)}else this._nodes.setCurSelectedNodes(null,r)},e.prototype.onOpacityChanged=function(e){var t=this;if(0!==e.length){var r=e[0].material.getTransparent()<.99;e.forEach(function(e){r?(t._opaques.removeDrawable(e),t._transparents.addDrawable(e)):(t._opaques.addDrawable(e),t._transparents.removeDrawable(e))})}},e.prototype.onSceneChanged=function(e){var t,r;this._lines.createQueue(this._scene,e),this._opaques.createQueue(this._scene,e),this._maskeds.createQueue(this._scene,e),this._transparents.createQueue(this._scene,e),this._renderPassAll.createQueue(this._scene,e),this._lines.queue.removeDrawables(),this._opaques.queue.removeDrawables(),this._maskeds.queue.removeDrawables(),this._transparents.queue.removeDrawables();var i=this._scene.models;for(var n in i)for(var a=0,o=(l=i[n]).drawables.length;a<o;a++)this._lines.queue.addDrawable(l.drawables[a]),this._opaques.queue.addDrawable(l.drawables[a]),this._maskeds.queue.addDrawable(l.drawables[a]),this._transparents.queue.addDrawable(l.drawables[a]);var s=this._scene.pawns;for(var n in s){var l;for(a=0,o=(l=s[n]).drawables.length;a<o;a++)this._lines.queue.addDrawable(l.drawables[a]),this._opaques.queue.addDrawable(l.drawables[a]),this._maskeds.queue.addDrawable(l.drawables[a]),this._transparents.queue.addDrawable(l.drawables[a])}try{for(var u=Mi(this._scene.text3Ds),c=u.next();!c.done;c=u.next()){var h=c.value;for(a=0,o=h.drawables.length;a<o;a++)this._lines.queue.addDrawable(h.drawables[a]),this._opaques.queue.addDrawable(h.drawables[a]),this._maskeds.queue.addDrawable(h.drawables[a]),this._transparents.queue.addDrawable(h.drawables[a])}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}if(this._opaques.queue.optimize(),this._maskeds.queue.optimize(),this._lines.queue.optimize(),this._scene.needRenderDoubleSided())this._opaques.setCullFace(!1),this._maskeds.setCullFace(!1),this._transparents.setCullFace(!1),this._renderPassAll.setCullFace(!1),this._nodes.setCullFace(!1);else{var d=this._resourceManager.gl;this._opaques.setCullFace(d.CCW),this._maskeds.setCullFace(d.CCW),this._transparents.setCullFace(d.CCW),this._renderPassAll.setCullFace(d.CCW),this._nodes.setCullFace(d.CCW)}for(var p in this._effects)this._effects[p].onSceneChanged(e)},e.prototype.setDoubleFaceEnabled=function(e){if(this._scene.setRenderDoubleSided(e),e)this._opaques.setCullFace(!1),this._maskeds.setCullFace(!1),this._transparents.setCullFace(!1);else{var t=this._resourceManager.gl;this._opaques.setCullFace(t.CCW),this._maskeds.setCullFace(t.CCW),this._transparents.setCullFace(t.CCW)}},e.prototype.optimize=function(){if(this._lines.optimize(),this._opaques.optimize(),this._maskeds.optimize(),this._transparents.optimize(),this._scene.needRenderDoubleSided())this._opaques.setCullFace(!1),this._maskeds.setCullFace(!1),this._transparents.setCullFace(!1);else{var e=this._resourceManager.gl;this._opaques.setCullFace(e.CCW),this._maskeds.setCullFace(e.CCW),this._transparents.setCullFace(e.CCW)}},e.prototype._recompileShaders=function(e,t){for(var r in this._effects)this._effects[r].recompileShader(e,t);for(var i in this._scene.models)this._scene.models[i].drawables.forEach(function(r){r.visible&&r.recompileShader(e,t)});this._opaques.recompileOverridedShader(e,t),this._lines.recompileOverridedShader(e,t),this._transparents.recompileOverridedShader(e,t),this._maskeds.recompileOverridedShader(e,t),this._renderPassAll.recompileOverridedShader(e,t),this._renderer.invalidate()},e.prototype.refreshRendering=function(e){void 0===e&&(e=1)},e.prototype.getScene=function(){return this._scene},e.prototype.getRenderQueueManager=function(){return this._renderQueueManager},e.prototype.getResourceManager=function(){return this._resourceManager},e.prototype.setCamera=function(e){this._camera=e},e.prototype.getCamera=function(){return this._camera},e.prototype.getRenderer=function(){return this._renderer},e.prototype.getRenderTarget=function(){return this._renderTarget},e.prototype.isLineRendering=function(e){return this._flags.line},e.prototype.setLineRendering=function(e){this._flags.line=e},e.prototype.addDrawable=function(e){for(var t in this._opaques.addDrawable(e)||this._maskeds.addDrawable(e)||this._lines.addDrawable(e)||this._transparents.addDrawable(e),this._renderPassAll.addDrawable(e),this._effects)this._effects[t].addDrawable(e)},e.prototype.addModelDrawabled=function(e){for(var t in this._opaques.addDrawable(e)||this._maskeds.addDrawable(e)||this._lines.addDrawable(e)||this._transparents.addDrawable(e),this._renderPassAll.addDrawable(e),this._effects)this._effects[t].addDrawable(e);this._hasModel=!0},e.prototype.addBboxDrawable=function(e){this._bbox.addDrawable(e)},e.prototype.addMarkDrawable=function(e){this._marks.addDrawable(e)},e.prototype.removeMarkDrawable=function(e){this._marks.removeDrawable(e)},e.prototype.getSkeletons=function(){return this._skeletons},e.prototype.addSkeleton=function(e){this._skeletons.push(e)},e.prototype.removeSkeleton=function(e){var t=this._skeletons.indexOf(e);-1!==t&&this._skeletons.splice(t,1)},e.prototype.removeDrawable=function(e){for(var t in this._opaques.removeDrawable(e)||this._maskeds.removeDrawable(e)||this._lines.removeDrawable(e)||this._transparents.removeDrawable(e),this._effects)this._effects[t].removeDrawable(e)},e.prototype.getOpaques=function(){return this._opaques},e.prototype.getMaskeds=function(){return this._maskeds},e.prototype.getLines=function(){return this._lines},e.prototype.getTransparents=function(){return this._transparents},e.prototype.getMarks=function(){return this._marks},e.prototype.setNodesLineColor=function(e){this._nodes.setLineColor(e)},e.prototype.setOITEnabled=function(e){this._transparents.setOITEnabled(e)},e.prototype.isOITEnabled=function(){return this._flags.oit},e.prototype.haseModel=function(){return this._hasModel},e.prototype.isShadowEnabled=function(){return this._flags.shadow},e}(),Si=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ai=function(e){function t(t,r,i,n,a){var o=e.call(this,t,r,i,n,a)||this;return o._flags={doubleSided:!1,clipping:!1,shadow:!1,specular:!1,line:!1,base:!1,bbox:!1,gamma:!1},o._shadow=null,o}return Si(t,e),t.prototype.destroy=function(){this._shadow&&(this._shadow.destroy(),this._shadow=null,delete this._shadow),e.prototype.destroy.call(this)},t.prototype.draw=function(){var e=this._resourceManager.gl;return this._scene.background.mode===et.a.SKYBOX_SOLIDCOLOR&&this._renderTarget.setClearColor(this._scene.background.color),this._scissor&&(e.enable(e.SCISSOR_TEST),e.scissor(this._camera.viewport[0],this._camera.viewport[1],this._camera.viewport[2],this._camera.viewport[3])),this._drawFrame(this._renderTarget),this._scissor&&e.disable(e.SCISSOR_TEST),!0},t.prototype.drawHD=function(){this.draw(),this._renderer.present(this._renderTarget.getFramebuffer())},t.prototype._drawFrame=function(e){var t=this._resourceManager.gl;this._renderer.clear(e,t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);for(var r=this._scene.clipping,i=this._scene.getMainLight(),n=0;n<this._skeletons.length;n++)this._skeletons[n].update();this._nodes.isValid()&&(e.always=!0,this._nodes.render(e,this._renderer,this._camera,this._shadow,r,i),e.always=!0),this._flags.line&&this._lines.render(e,this._renderer,this._camera,this._shadow,r,i),this._flags.overridedMaterial&&this._renderPassAll.getOverridedMaterial().transparent?(this._drawSkybox(e),this._renderPassAll.render(e,this._renderer,this._camera,this._shadow,r,i),this._drawVisualize(e)):(this._opaques.render(e,this._renderer,this._camera,this._shadow,r,i),this._maskeds.render(e,this._renderer,this._camera,this._shadow,r,i),this._drawVisualize(e),this._drawSkybox(e),this._transparents.render(e,this._renderer,this._camera,this._shadow,r,i)),this._flags.bbox&&this._bbox.render(e,this._renderer,this._camera,this._shadow,r,i),this._flags.mark&&this._marks.render(e,this._renderer,this._camera,null,r,i)},t.prototype._drawSkybox=function(e){this._scene.background.skybox&&this._scene.background.skybox.visible&&(this._scene.background.skybox.update(this._camera.viewMatrix),this._renderer.drawSkybox(e,this._scene.background.skybox,this._scene.background.skybox.camera))},t.prototype._drawView=function(e,t){for(var r=this._scene.clipping,i=this._scene.getMainLight(),n=0;n<this._skeletons.length;n++)this._skeletons[n].update();this._flags.line&&this._lines.render(e,this._renderer,t,this._shadow,r,i),this._flags.overridedMaterial?(this._renderPassAll.render(e,this._renderer,t,this._shadow,r,i),this._drawVisualize(e)):(this._opaques.render(e,this._renderer,t,this._shadow,r,i),this._maskeds.render(e,this._renderer,t,this._shadow,r,i),this._drawVisualize(e),this._scene.background.skybox&&this._scene.background.skybox.visible&&(this._scene.background.skybox.update(t.viewMatrix),this._renderer.drawSkybox(e,this._scene.background.skybox,this._scene.background.skybox.camera)),this._transparents.render(e,this._renderer,t,this._shadow,r,i)),this._flags.bbox&&this._bbox.render(e,this._renderer,t,this._shadow,r,i)},t.prototype._drawEffects=function(e,t){void 0===t&&(t=-1);for(var r=0;r<this._sortedEffects.length;r++)this._sortedEffects[r].draw(e,t)},t.prototype._drawVisualize=function(e){var t=this._scene.clipping,r=this._scene.getMainLight();e.setOption("blend",!0),e.always=!0;for(var i=0;i<this._visualizes.length;i++)this._visualizes[i].draw(this._renderer,this._camera,t,r,this._shadow,e);e.setOption("blend",!1),e.always=!0},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this._renderTarget.resize(t,r)},t.prototype.isLineRendering=function(){return this._flags.line},t.prototype.setLineRendering=function(e){this._flags.line=e},t.prototype.setBaseRenderingEnabled=function(e){this._flags.base!==e&&(this._flags.base=e,this._recompileShaders("BASE",e))},t.prototype.recompileSpecular=function(){this._recompileShaders("SPECULAR",this._flags.specular)},t.prototype.setBBoxEnabled=function(e){this._flags.bbox=e},t.prototype.setMarkEnabled=function(e){this._flags.mark=e},t.prototype.isShadowEnabled=function(){return this._flags.shadow},t.prototype.recompileClipping=function(e){for(var t in this._flags.clipping=e,this._recompileShaders("CLIPPING",e),this._shadow&&(this._shadow.recompileShader("CLIPPING",e),this._shadow.draw(null)),this._effects)this._effects[t].recompileShader("CLIPPING",e)},t.prototype.setClippingEnabled=function(e){this._flags.clipping!==e&&this.recompileClipping(!0)},t.prototype.isClippingEnabled=function(){return this._flags.clipping},t.prototype.onSceneChanged=function(t){e.prototype.onSceneChanged.call(this,t),this._shadow&&this._shadow.onSceneChanged(t),this._flags.doubleSided=this._scene.needRenderDoubleSided()},t.prototype.setSpecularEnabled=function(e){this._flags.specular=e,this._recompileShaders("SPECULAR",e)},t.prototype.setGammaEnabled=function(e){this._flags.gamma=e,this._recompileShaders("GAMMA",e)},t.prototype.refreshRendering=function(e){void 0===e&&(e=1)},t.prototype.setScissorEnabled=function(e){this._scissor=e},t}(Ei),ki=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Pi=function(e){function t(t,r){var i=e.call(this,r)||this;return i._scene=t,i._cull=new Gt(i),i._perspective=!1,U.a.ortho(i.projectMatrix,-1,1,-1,1,-100,100),U.a.multiply(i.vpMatrix,i.projectMatrix,i.viewMatrix),i}return ki(t,e),t.prototype.createFromLight=function(e,t,r){this._at=P.a.aabb.center(t),this._distance=P.a.aabb.len(t),this.eye=U.d.create(),this.eye[0]=-e[0]*this._distance+this._at[0],this.eye[1]=-e[1]*this._distance+this._at[1],this.eye[2]=-e[2]*this._distance+this._at[2],r?U.a.lookAt(this.viewMatrix,this.eye,this._at,r):U.a.lookAt(this.viewMatrix,this.eye,this._at,[0,0,1]);var i=.505*this._distance,n=i,a=i;this._znear=this._distance-1.02*i,this._zfar=this._distance+1.02*i,this._height=a,this._aspect=1,this._perspective=!1,U.a.ortho(this.projectMatrix,-n,n,-a,a,this._znear,this._zfar),U.a.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},t.prototype.createFromLightTight=function(e,t,r){var i,n=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],a=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],o=U.d.create();for(i=0;i<r.length;i++)U.d.min(n,n,r[i]),U.d.max(a,a,r[i]);var s=P.a.aabb.create(n,a),l=P.a.aabb.points(s);U.d.lerp(this._at,n,a,.5),this._distance=P.a.aabb.len(t);var u=.505*this._distance;for(this.eye=U.d.create(),this.eye[0]=-e[0]*this._distance+this._at[0],this.eye[1]=-e[1]*this._distance+this._at[1],this.eye[2]=-e[2]*this._distance+this._at[2],U.a.lookAt(this.viewMatrix,this.eye,this._at,[0,0,1]),n=[Number.MAX_VALUE,Number.MAX_VALUE],a=[-Number.MAX_VALUE,-Number.MAX_VALUE],i=0;i<l.length;i++)null!==l[i]&&(o[0]=this.viewMatrix[0]*l[i][0]+this.viewMatrix[4]*l[i][1]+this.viewMatrix[8]*l[i][2]+this.viewMatrix[12],o[1]=this.viewMatrix[1]*l[i][0]+this.viewMatrix[5]*l[i][1]+this.viewMatrix[9]*l[i][2]+this.viewMatrix[13],U.c.min(n,n,o),U.c.max(a,a,o));this._znear=this._distance-1.02*u,this._zfar=this._distance+1.02*u,this._aspect=1,this._perspective=!1,U.a.ortho(this.projectMatrix,n[0],a[0],n[1],a[1],this._znear,this._zfar),U.a.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},t.prototype.setCullingEnabled=function(e){this._cull.setEnabled(e),e&&this._cull.update()},t.prototype.setBimCullingEnabled=function(e){this._cull.setBimCullingEnabled(this._scene.isBimCullingNeeded&&e),this.isBimCullingEnabled()&&this._cull.update()},t.prototype.isBimCullingEnabled=function(){return this._scene.isBimCullingNeeded&&this._cull.isBimCullingEnabled()},t.prototype.cull=function(e,t){return this._cull.isCulled(e,t)},t}(Bt.a),Ni=function(){function e(e){this._renderScene=e;var t=this._renderScene.getCamera(),r=t.viewport[2],i=t.viewport[3];this.smSize=r<512&&i<512?1024:2048;var n=this._renderScene.getScene(),a=this._renderScene.getResourceManager();this._opaques=new $t(a,this._renderScene.getRenderQueueManager(),!1,{shadowCaster:!0,mask:!1}),this._maskeds=new $t(a,this._renderScene.getRenderQueueManager(),!1,{shadowCaster:!0,mask:!0});var o=["VISIBILITY","ONLY_DEPTH"];n.clipping.isEnabled()&&o.push("CLIPPING"),n.compressed&&o.push("COMPRESSION");var s=a.getShader("normaldepth",o);if(!s.ready){var l=N.a.normaldepth;s.createFromShaderSource(l,o)}this._opaques.setOverridedShader(s),o.push("ALPHATEST");var u=a.getShader("normaldepth",o);if(!u.ready){l=N.a.normaldepth;u.createFromShaderSource(l,o)}this._maskeds.setOverridedShader(u),this._opaques.setOverridedMaterial(n.materialManager.createMaterialAdhoc("shadow")),this._maskeds.setOverridedMaterial(n.materialManager.createMaterialAdhoc("shadow")),this._lightCamera=new Pi(this._renderScene.getScene(),[0,0,this.smSize,this.smSize]),this._lightCamera.setCullingEnabled(!0),this._renderTargets=[],this.shadowMaps=[],this.shadowMatrices=[],this.shadowSplit=1e4,this._ready=!0}return e.prototype.destroy=function(){this._opaques.destroy(),this._opaques=null,delete this._opaques,this._maskeds.destroy(),this._maskeds=null,delete this._maskeds,this._lightCamera.destroy(),this._lightCamera=null,delete this._lightCamera,this._renderScene=null,delete this._renderScene;for(var e=0;e<this._renderTargets.length;e++)this._renderTargets[e].destroy();this._renderTargets=null,delete this._renderTargets,this.shadowMatrices=null,delete this.shadowMatrices,this.shadowMaps=null,delete this.shadowMaps},e.prototype.recompileShader=function(e,t){this._opaques.recompileOverridedShader(e,t),this._maskeds.recompileOverridedShader(e,t)},e.prototype.doesSupportMobile=function(e){return!0},e.prototype.draw=function(e){void 0===e&&(e=-1),this._ready},e.prototype.onSceneChanged=function(e){if(this._ready){var t=this._renderScene.getOpaques(),r=this._renderScene.getMaskeds();this._opaques.queue.copy(t.queue,e),this._maskeds.queue.copy(r.queue,e),this._opaques.setCullFace(t.getCullFace()),this._maskeds.setCullFace(r.getCullFace())}},e.prototype.addDrawable=function(e){this._opaques.queue.addDrawable(e)||this._maskeds.queue.addDrawable(e)},e.prototype.removeDrawable=function(e){this._opaques.queue.removeDrawable(e)||this._maskeds.queue.removeDrawable(e)},e}();function Di(e,t,r){var i=P.a.frustum.createFromMatrix(t.vpMatrix),n=P.a.intersect.aabb_frustum(e.clipping.get(),i),a=U.d.create();U.d.copy(a,e.getMainLight().direction);Math.min(.005+e.radius/t._distance*.01,.01);var o=U.d.create();Math.abs(a[0])>Math.abs(a[2])?U.d.set(o,-a[1],a[0],0):U.d.set(o,0,-a[2],a[1]),U.d.normalize(o,o);var s=U.d.create();U.d.cross(s,a,o),U.d.normalize(s,s),U.d.normalize(a,a),r.createFromLightTight(a,e.clipping.get(),n),r._cull.update()}var Ii,Oi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ri=function(e){function t(t){var r=e.call(this,t)||this;if(!r._ready)return r;r.shadowMatrices.push(U.a.create());var i=r._renderScene.getResourceManager(),n=i.gl;return r._renderTargets.push(new Jt.a("shadowesm-depth",i,r.smSize,r.smSize,{colorMask:[0,0,0,0],colorFormat:n.isWebGL2?n.R8:n.RGB,colorBuffer:0,depthFilter:n.NEAREST,depthFormat:n.DEPTH_COMPONENT24,depthBuffer:0})),s.a.isMobile?(r.shadowMaps.push(r._renderTargets[0].getDepthBuffer()),r._ready=r._renderTargets[0].ready):(r._renderTargets.push(new Jt.a("shadowesm-smooth",i,r.smSize,r.smSize,{colorFormat:n.isWebGL2?n.R32F:"firefox"===s.a.browserName?n.RGBA32F:n.RGB32F,colorFilter:n.NEAREST,depthTest:!1,depthBufer:0})),r._blit=new cr(i,N.a.shadowsmooth),r._blit.setTexture(r._renderTargets[0].getDepthBuffer()),r.shadowMaps.push(r._renderTargets[1].getColorBuffer()),r._ready=r._blit.ready&&r._renderTargets[0].ready&&r._renderTargets[1].ready),r}return Oi(t,e),t.prototype.destroy=function(){this._blit&&(this._blit.destroy(),this._blit=null,delete this._blit),e.prototype.destroy.call(this)},t.prototype.draw=function(e){if(void 0===e&&(e=-1),this._ready){!function(e,t){t.createFromLight(e.getMainLight().direction,e.clipping.get()),t._cull.update()}(this._renderScene.getScene(),this._lightCamera),U.a.copy(this.shadowMatrices[0],this._lightCamera.vpMatrix),this._lightCamera.setBimCullingEnabled(this._renderScene.getCamera().isBimCullingEnabled());var t=this._renderScene.getRenderer(),r=this._renderScene.getScene().getMainLight(),i=this._renderScene.getScene().clipping,n=this._renderScene.getResourceManager().gl;t.renderState.invalidateClip(),t.clear(this._renderTargets[0],n.DEPTH_BUFFER_BIT),this._opaques.render(this._renderTargets[0],t,this._lightCamera,null,i,r),this._maskeds.render(this._renderTargets[0],t,this._lightCamera,null,i,r),s.a.isMobile||this._blit.render(t,this._renderTargets[1])}},t}(Ni),Ci=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Bi=function(e){function t(t){var r=e.call(this,t)||this;if(!r._ready)return r;r._partitions=1,r.smSize=r.smSize/r._partitions;var i=r._renderScene.getResourceManager();r.shadowMaps=new Array(r._partitions),r.shadowMatrices=new Array(r._partitions),r._renderTargets=new Array(r._partitions),r._lightCameras=new Array(r._partitions),r._sceneCameras=new Array(r._partitions);for(var n=i.gl,a=[0,0,r.smSize,r.smSize],o=0;o<r._partitions;o++)r._renderTargets[o]=new Jt.a("shadowcsm-depth"+o,i,r.smSize,r.smSize,{colorMask:[0,0,0,0],colorFormat:n.R8,colorBuffer:0,depthFilter:n.NEAREST,depthFormat:n.DEPTH_COMPONENT24,depthBuffer:o}),r.shadowMaps[o]=r._renderTargets[o].getDepthBuffer(),r.shadowMatrices[o]=U.a.create(),r._ready=r._ready&&r._renderTargets[o].ready,r._lightCameras[o]=new Pi(t.getScene(),a),r._sceneCameras[o]=new Bt.a(a);return r}return Ci(t,e),t.prototype.destroy=function(){this._lightCameras=null,delete this._lightCameras,this._sceneCameras=null,delete this._sceneCameras,e.prototype.destroy.call(this)},t.prototype.draw=function(e){if(void 0===e&&(e=-1),this._ready){if(1===e){for(var t=this._renderScene.getCamera(),r=this._renderScene.getScene(),i=t.split(this._partitions,this._sceneCameras),n=0;n<this._partitions;n++)Di(r,this._sceneCameras[n],this._lightCameras[n]),this._lightCameras[n].setViewport([0,0,this.smSize,this.smSize]);this.shadowSplit=.5*(-t.projectMatrix[10]+t.projectMatrix[14]/i[0]+1),this._renderScene.getRenderer().renderState.invalidateClip()}e-=1;var a=Gr._4x4_2D[2*e]-.5,o=Gr._4x4_2D[2*e+1]-.5,s=this._renderScene.getRenderer(),l=this._renderScene.getScene().getMainLight(),u=this._renderScene.getScene().clipping,c=this._renderScene.getResourceManager().gl;for(n=0;n<this._partitions;n++)this._lightCameras[n].jitter(a/this.smSize,o/this.smSize),s.renderState.invalidateOther(),s.clear(this._renderTargets[n],c.DEPTH_BUFFER_BIT),this._opaques.render(this._renderTargets[n],s,this._lightCameras[n],null,u,l),this._maskeds.render(this._renderTargets[n],s,this._lightCameras[n],null,u,l),U.a.copy(this.shadowMatrices[n],this._lightCameras[n].vpMatrix),this._lightCameras[n].jitter(-a/this.smSize,-o/this.smSize)}},t}(Ni),Li=function(){function e(e){this.contrast=.5,this.fine=!1,this._enabled=!1,this._enabledCSM=!0,this._renderScene=e,this._coarseShadow=new Ri(e),this._fineShadow=new Bi(e),this._enabledCSM=!0,this.size=this._coarseShadow.smSize,this.shadowSplit=this._coarseShadow.shadowSplit,this.contrast=.5}return e.prototype.destroy=function(){this.shadowMaps=null,delete this.shadowMaps,this.shadowMatrices=null,delete this.shadowMatrices,this._fineShadow.destroy(),this._fineShadow=null,delete this._fineShadow,this._coarseShadow.destroy(),this._coarseShadow=null,delete this._coarseShadow},e.prototype.recompileShader=function(e,t){this._fineShadow.recompileShader(e,t),this._coarseShadow.recompileShader(e,t)},e.prototype.onSceneChanged=function(e){this._fineShadow.onSceneChanged(e),this._coarseShadow.onSceneChanged(e)},e.prototype.draw=function(e){void 0===e&&(e=-1),this._enabled&&this._renderScene.isVisible()&&(this.fine=e>0,this.fine?(this._fineShadow.draw(e),this.shadowMaps=this._fineShadow.shadowMaps,this.shadowMatrices=this._fineShadow.shadowMatrices,this.size=this._fineShadow.smSize,this.shadowSplit=this._fineShadow.shadowSplit):(this._coarseShadow.draw(e),this.shadowMaps=this._coarseShadow.shadowMaps,this.shadowMatrices=this._coarseShadow.shadowMatrices,this.size=this._coarseShadow.smSize,this.shadowSplit=this._coarseShadow.shadowSplit))},e.prototype.setEnabled=function(e){this._enabled=e},e.prototype.addDrawalbe=function(e){this._fineShadow&&this._fineShadow.addDrawable(e),this._coarseShadow.addDrawable(e)},e.prototype.removeDrawable=function(e){this._fineShadow&&this._fineShadow.removeDrawable(e),this._coarseShadow.removeDrawable(e)},e.prototype.isCSMEnabled=function(){return this._enabledCSM},e.prototype.setContrast=function(e){this.contrast=e},e}(),Fi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Vi=function(e){function t(t,r,i,n,a,o){var s=e.call(this,t,r,i,n,o)||this;s._animationStart=!0,s._alwaysUpdate=!1,s._prFrame=0,s._prSkipFrames=4,s._PR_MAX_FRAMES=16,s._prEnabled=!0,s._needUpdate=0,s._eventEmitter=a,s._alwaysUpdate=!1,s._flags={progressive:!1,doubleSided:!1,clipping:!1,shadow:!1,specular:!1,line:!1,smartCulling:!0};var l=s._resourceManager.gl;return s._prRenderTargets=[new Jt.a("pipeline-pr",s._resourceManager,r.viewport[2],r.viewport[3],{depthFunc:l.LEQUAL,colorFilter:l.NEAREST,colorFormat:l.RGBA8,depthBuffer:0,stencilTest:!!o}),new Jt.a("pipeline-pr1",s._resourceManager,r.viewport[2],r.viewport[3],{depthTest:!1,colorFilter:l.NEAREST,colorFormat:l.RGBA8,depthBuffer:0,stencilTest:!!o}),new Jt.a("pipeline-pr2",s._resourceManager,r.viewport[2],r.viewport[3],{depthTest:!1,colorFilter:l.NEAREST,colorFormat:l.RGBA8,depthBuffer:0,stencilTest:!!o})],s._prBlit=new cr(s._resourceManager,N.a.accumulate),s._endBlit=new cr(s._resourceManager,N.a.blit),s._blit=new cr(s._resourceManager),s._visible=!0,s._onCameraUpdateStopped=function(){s._startProgressivelyDraw(),s._camera.setBimCullingEnabled(!1)},s}return Fi(t,e),t.prototype.destroy=function(){this._prRenderTargets[0].destroy(),this._prRenderTargets[1].destroy(),this._prRenderTargets[2].destroy(),this._prRenderTargets=null,delete this._prRenderTargets,this._prBlit.destroy(),this._prBlit=null,delete this._prBlit,this._resourceManager.gl.isWebGL2||(this._blit.destroy(),this._blit=null,delete this._blit),e.prototype.destroy.call(this)},t.prototype._drawNormally=function(){this._clearSkybox(),this._animationStart&&(this._eventEmitter.emit("modelo3dAnimationStart"),this._animationStart=!1),this._flags.progressive=!1,this._drawFrame(this._renderTarget)},t.prototype._startProgressivelyDraw=function(){this._prEnabled&&(this._flags.progressive=!0,this._prFrame=1,this._renderer.invalidate(),this._flags.shadow&&this._renderer.renderState.invalidateShadow())},t.prototype.drawProgressively=function(e){this.updateShadow(e);var t=this._resourceManager.gl;t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0+2),t.bindTexture(t.TEXTURE_2D,null),this._drawFrame(this._prRenderTargets[0])},t.prototype.drawEffectsProgressively=function(e){this._drawEffects(this._prRenderTargets[0],e)},t.prototype.drawEffectsNormally=function(){this._drawEffects(this._renderTarget,-1)},t.prototype.accumulateCurrentFrame=function(e){this._renderer.renderState.viewport(this._camera.viewport),this._prBlit.setTexture(this._prRenderTargets[1+e%2].getColorBuffer()),this._prBlit.setParameter("uTexture0",this._prRenderTargets[0].getColorBuffer()),this._prBlit.setParameter("uFrameCount",e),this._prBlit.render(this._renderer,this._prRenderTargets[2-e%2]),e>1&&(this._blit.setTexture(this._prRenderTargets[2-e%2].getColorBuffer()),this._blit.render(this._renderer,this._renderTarget))},t.prototype._clearSkybox=function(){this._scene.background.mode===et.a.SKYBOX_SOLIDCOLOR&&(this._renderTarget.setClearColor(this._scene.background.color),this._prRenderTargets[0].setClearColor(this._scene.background.color))},t.prototype.drawVR=function(e,t){this._renderer.clear(this._renderTarget,this._resourceManager.gl.COLOR_BUFFER_BIT|this._resourceManager.gl.DEPTH_BUFFER_BIT),this._drawView(this._renderTarget,e),this._renderer.endFrame(),this._renderer.beginFrame(),this._drawView(this._renderTarget,t)},t.prototype.drawHD=function(){for(console.log("RenderScenePR.drawHD"),this._scene.background.mode===et.a.SKYBOX_SOLIDCOLOR&&this._prRenderTargets[0].setClearColor(this._scene.background.color),this.refresh(),this._prFrame=1;this._prFrame<=16;)this._prFrame++;this._resourceManager.gl.isWebGL2&&this._renderer.present(this._prRenderTargets[1+this._prFrame%2].getFramebuffer()),this._flags.progressive=!1,this._prFrame=1},t.prototype._drawEffects=function(e,t){for(var r=0;r<this._sortedEffects.length;r++)this._sortedEffects[r].draw(e,t)},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this._prRenderTargets[0].resize(t,r),this._prRenderTargets[1].resize(t,r),this._prRenderTargets[2].resize(t,r)},t.prototype.isProgressiveRenderingEnabled=function(){return this._prEnabled},t.prototype.setProgressiveRenderingEnabled=function(e){this._prEnabled=e,this._flags.progressive=e,this._prFrame=e?1:0,this._camera.setBimCullingEnabled(!1)},t.prototype.setProgressiveRenderingLatency=function(e){this._prSkipFrames>=this._PR_MAX_FRAMES&&(this._prSkipFrames=15),this._prSkipFrames<0&&(this._prSkipFrames=4)},t.prototype._onAnimationStart=function(){this._camera.setBimCullingEnabled(this._flags.smartCulling)},t.prototype._onAnimationEnd=function(){if(this._flags.progressive)this._needUpdate=0;else{if(this._needUpdate+=1.01,this._needUpdate>1&&(this._needUpdate=.9999),this._prFrame<=0&&this._camera.isBimCullingEnabled())return this._camera.setBimCullingEnabled(!1),void this._renderer.invalidate();this._prFrame=1,this._flags.progressive=!0,this._renderer.clear(this._prRenderTargets[1],this._resourceManager.gl.COLOR_BUFFER_BIT),this._renderer.clear(this._prRenderTargets[2],this._resourceManager.gl.COLOR_BUFFER_BIT),this._flags.shadow&&this._renderer.renderState.invalidateShadow()}},t.prototype.setSmartCullingEnabled=function(e){this._flags.smartCulling=e},t.prototype.isSmartCullingEnabled=function(){return this._flags.smartCulling},t.prototype.getRenderTarget=function(){return this._prFrame>this._PR_MAX_FRAMES?this._prRenderTargets[1+this._prFrame%2]:this._renderTarget},t.prototype.getRenderTargetPR=function(){return this._prRenderTargets[0]},t.prototype.refresh=function(){this._flags.progressive=!1,this._prFrame=0,this._onAnimationStart()},t.prototype.refreshRendering=function(e){void 0===e&&(e=1),this._flags.progressive&&(this._flags.progressive=!1,this._onAnimationStart(),this._prFrame=0),this._needUpdate+=1.01*e,this._needUpdate>20.01&&(this._needUpdate=20.01)},t.prototype.drawBilt=function(e,t){this._endBlit.setTexture(t.getColorBuffer()),this._endBlit.render(this._renderer,e,!0)},t.prototype.onSceneChanged=function(t){void 0===t&&(t=-1),this._visible&&(e.prototype.onSceneChanged.call(this,t),this.updateShadow(),this._startProgressivelyDraw())},t.prototype.updateShadow=function(e){void 0===e&&(e=-1),this._shadow&&this._flags.shadow&&(this._shadow.draw(e),this._renderer.renderState.invalidateShadow())},t.prototype.setShadowEnabled=function(e){this._flags.shadow!==e&&(this._flags.shadow=e,this._flags.shadow&&null===this._shadow&&(this._shadow=new Li(this),this._shadow.onSceneChanged(-1)),this._shadow.setEnabled(e),this._recompileShaders("SHADOW",e),this._shadow.isCSMEnabled()&&this._recompileShaders("SHADOW_PARTITION",e),this.updateShadow())},t.prototype.recompileShadow=function(){if(this._shadow){var e=this._flags.shadow;this._recompileShaders("SHADOW",e),this._shadow.isCSMEnabled()&&this._recompileShaders("SHADOW_PARTITION",e),this.updateShadow()}},t.prototype.setVisible=function(e){this._visible=e,this.recompileShadow()},t.prototype.isVisible=function(){return this._visible},t.prototype.removeEventListener=function(){this._camera.removeUpdateStopListener(this._onCameraUpdateStopped)},t.prototype.retoreEventListener=function(){this._camera.addUpdateStopListener(this._onCameraUpdateStopped)},t.prototype.setShadowContrast=function(e){this._shadow&&this._shadow.setContrast(e)},t}(Ai),Ui=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),zi=function(e){function t(t,r){var i=e.call(this,r)||this;return i._scene=t,i._cull=new Gt(i),i._centerOffset=[.5,.5],i}return Ui(t,e),Object.defineProperty(t.prototype,"centerOffset",{get:function(){return this._centerOffset},enumerable:!1,configurable:!0}),t.prototype.update=function(e,t,r){U.a.copy(this.viewMatrix,e.viewMatrix),U.a.copy(this.projectMatrix,e.projectMatrix),this._phi=e._phi,this._theta=e._theta,this._at=e._at,this.eye=e.eye,this._distance=e._distance,this._fov=e._fov,this._znear=e._znear,this._zfar=e._zfar,this._aspect=e._aspect,this._perspective=e._perspective,r*=.001,this.projectMatrix[0]=2*this.projectMatrix[0],this.projectMatrix[8]=r/e._zfar,this.projectMatrix[12]=r,this.projectMatrix[8]-=.1*t,this._centerOffset[0]=.5+.5*t*.1,U.a.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix),this._cull.update()},t.prototype.getNearPlaneSize=function(){return Bt.a.prototype.getNearPlaneSize.apply(this)},t.prototype.isPerspective=function(){return this._perspective},t.prototype.setViewport=function(e){var t=e[2],r=e[3];(t>4096||r>4096)&&(t>=r?(r=Math.floor(4096*r/t),t=4096):(t=Math.floor(4096*t/r),r=4096)),this.viewport[0]=e[0],this.viewport[1]=e[1],this.viewport[2]=t,this.viewport[3]=r},t.prototype.setBimCullingEnabled=function(e){},t.prototype.cull=function(e,t){return this._cull.isCulled(e,t)},t.prototype.setCullingEnabled=function(e){this._cull.setEnabled(e)},t}(Bt.a),ji=function(){function e(e,t,r){this.enabled=!1,this._scene=r,this._ready=!1,this._resourceManager=t,this._warpMaterial=null,this._screenRenderTarget=null,this._resolveRenderTarget=null,this._renderTargets=[],this._hmdWarpParam=[],this._warpScaleParam=[],this._needWarp=!1,this._cameras=[],this._convergence=-.15,this._separation=55,this._blit=new cr(t,N.a.vr_wrap),this._viewer=e;var i=e.getWidth(),n=e.getHeight(),a=[0,0,i,n];this._cameras[0]=new zi(r,a),this._cameras[1]=new zi(r,a),this._cameras[0].setCullingEnabled(!0),this._cameras[1].setCullingEnabled(!0),this._cameras[0].setViewport(new Int32Array([0,0,i/2,n])),this._cameras[1].setViewport(new Int32Array([i/2,0,i/2,n])),this._ready=!0}return e.prototype.destroy=function(){this._ready&&this._screenRenderTarget&&(this._screenRenderTarget.destroy(),this._renderTargets[0].destroy(),this._renderTargets[1].destroy(),this._renderTargets[2].destroy(),this._renderTargets[3].destroy(),this._warpMaterial.destroy())},e.prototype.setEnabled=function(e){this.enabled=e},e.prototype.resize=function(e,t){if(this._ready){var r=e,i=t;this._renderTargets[0]&&(this._renderTargets[0].resize(r,i),this._renderTargets[1].resize(r,i),this._renderTargets[2].resize(r,i),this._renderTargets[3].resize(r,i),this._ready=this._renderTargets[0].ready&&this._renderTargets[1].ready&&this._renderTargets[2].ready&&this._renderTargets[3].ready,this.resetWarpParam()),this._cameras[0].setViewport(new Int32Array([0,0,r/2,i])),this._cameras[1].setViewport(new Int32Array([r/2,0,r/2,i]))}},e.prototype.draw=function(e,t,r){this._ready?(this._cameras[0].update(e,-this._convergence,.5*-this._separation),this._cameras[1].update(e,this._convergence,.5*this._separation),this._needWarp?(t.drawVR(this._cameras[0],this._cameras[1],this._renderTargets),this._blit.setParameter("uLeftCenterOffset",this._cameras[0].centerOffset),this._blit.setParameter("uRightCenterOffset",this._cameras[1].centerOffset),r.renderState.viewport([0,0,this.viewer.getWidth(),this.viewer.getHeight()]),this._blit.render(r,this._screenRenderTarget)):t.drawVR(this._cameras[0],this._cameras[1])):console.error("VR is not ready.")},e.prototype.resetWarpParam=function(){this._hmdWarpParam=[1,.18,.2];var e=this._hmdWarpParam[0]+this._hmdWarpParam[1]+this._hmdWarpParam[2],t=this.viewer.getWidth()/2/this.viewer.getHeight();this._warpScaleParam=[2*t,2,.5/t/e,.5/e],this._blit.setParameter("uHmdWarpParam",this._hmdWarpParam),this._blit.setParameter("uWarpScaleParam",this._warpScaleParam)},e.prototype.setConvergence=function(e){this._convergence=e},e.prototype.setSeparation=function(e){this._separation=e},e.prototype.setCalibrationEnabled=function(e){e?this._blit.setParameter("uCalibration",!0):this._blit.setParameter("uCalibration",!1)},e}(),Gi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),qi=U.d.create(),Qi=function(e){function t(t,r){var i=e.call(this,r)||this;return i.setVi=function(e,t){},i.viewport=U.e.clone(r),i.viewMatrix=U.a.create(),i.projectMatrix=U.a.create(),i.vpMatrix=U.a.create(),i.eye=U.d.create(),i._aspect=1,i._znear=.1,i._zfar=1024,i._scene=t,i._perspective=!0,i._centerOfScene=null,i._sceneBoxDiagHalfLen=0,i}return Gi(t,e),t.prototype._updateProjection=function(e,t){if(this._scene){this._centerOfScene=P.a.aabb.center(this._scene.bbox),this._sceneBoxDiagHalfLen=.5*P.a.aabb.len(this._scene.bbox),U.d.subtract(qi,t.eye,this._centerOfScene);var r=U.d.length(qi),i=Math.max(r-this._sceneBoxDiagHalfLen,.1),n=1.1*Math.min(r+this._sceneBoxDiagHalfLen,1024);this._znear=i,this._zfar=n}},t.prototype.update=function(e,t,r){this._scene=e._scene,this._at=e._at,U.d.add(this.eye,e.eye,t.offset),this._distance=e._distance,this._fov=Math.max(t.fieldOfView.downDegrees,t.fieldOfView.upDegrees,t.fieldOfView.leftDegrees,t.fieldOfView.rightDegrees),U.a.multiply(this.viewMatrix,r,e.viewMatrix),this._updateProjection(this.projectMatrix,e),U.a.perspectiveFromFieldOfView(this.projectMatrix,t.fieldOfView,this._znear,this._zfar),U.a.multiply(this.vpMatrix,this.projectMatrix,this.viewMatrix)},t.prototype.getNearPlaneSize=function(){return Bt.a.prototype.getNearPlaneSize.apply(this)},t.prototype.isPerspective=function(){return this._perspective},t.prototype.setViewport=function(e){Bt.a.prototype.setViewport.apply(this,e)},t.prototype.getViewRightDirection=function(){var e=[];return e[0]=this.viewMatrix[0],e[1]=this.viewMatrix[4],e[2]=this.viewMatrix[8],e},t.prototype.cull=function(e){return!1},t}(Bt.a),Hi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Wi=function(e){function t(){return e.call(this,"instant")||this}return Hi(t,e),t.prototype.update=function(){var e=this._camera;e._distance=e._targetDistance,e._theta=e._targetTheta,e._phi=e._targetPhi,e._fov=e._targetFov,e._phi>=.49999*Math.PI&&(e._phi=.49999*Math.PI),e._phi<=-.49999*Math.PI&&(e._phi=-.49999*Math.PI),e._firstPerson||(e._at[0]=e._targetAt[0],e._at[1]=e._targetAt[1],e._at[2]=e._targetAt[2]);return e._invTanFov=1/Math.tan(.00872665*e._fov),e._perspective&&(e.projectMatrix[0]=e._invTanFov/e._aspect,e.projectMatrix[5]=e._invTanFov),e._scene&&e._updateProjection(),Bt.a.prototype.update.apply(e),e._cull.update(),!0},t.prototype._onEnd=function(){return!1},t.prototype._onStart=function(){return!1},t}(Lt.a),Yi=null,Xi=[0,0,0,0],Zi=function(){function e(e,t,r,i){if(this.enabled=!1,this._ready=!1,this._resourceManager=t,this._eventEmitter=i,this._cameras=[],this._vrDisplay=null,this._canvas=null,this._canvasResizeCB=null,this._screenWidth=null,this._screenHeight=null,this._resizeBind=this.resize.bind(this),this._viewer=e,this._defaultViewerHeight=1.65,this._poseMat=U.a.create(),this._prevFrameDataTimeStamp=-.1,navigator.getVRDisplays){var n=this;navigator.getVRDisplays().then(function(e){var t,r,i=e.length;for(t=0;t<i;t++)if((r=e[t]).isConnected&&r.capabilities.canPresent){console.log("VR display: "+r.displayName+" is selected."),n._vrDisplay=r,Yi=new VRFrameData;break}});var a=[0,0,e.getWidth(),e.getHeight()];this._cameras[0]=new Qi(r,a),this._cameras[1]=new Qi(r,a),this._animator=new Wi,this._ready=!0}else console.log("Your browser does not support WebVR latest version. VR is disabled.")}return e.prototype.destroy=function(){},e.prototype.switchPresent=function(e,t,r){if(this._vrDisplay&&this._ready){var i=this;if(this._vrDisplay.isPresenting)this.enabled=!1,this._deactivateVR(),this._canvas=null,this._canvasResizeCB=null,this._vrDisplay.exitPresent().then(function(){modelo3d.debug("VR exit present succeeded"),n._animator.unbind(r),window.removeEventListener("resize",i._resizeBind),i._eventEmitter.emit("webvrOff")},function(){console.error("VR exit present failed")});else{this.enabled=!0,this._canvas=e,this._canvasResizeCB=t,this._activateVR();var n=this;this._vrDisplay.requestPresent([{source:e}]).then(function(){modelo3d.debug("VR request present succeeded"),n._animator.bind(r),i._eventEmitter.emit("webvrOn"),window.addEventListener("resize",i._resizeBind)},function(){console.error("VR request present failed")})}}else this.enabled=!1},e.prototype.isPresenting=function(){return this._ready&&this.enabled&&this._vrDisplay&&this._vrDisplay.isPresenting},e.prototype._activateVR=function(){if(modelo3d.debug("WebVR Debug: enter activateVR"),this._vrDisplay&&this._ready){var e=this._vrDisplay.getEyeParameters("left"),t=this._vrDisplay.getEyeParameters("right"),r=2*Math.max(e.renderWidth,t.renderWidth),i=Math.max(e.renderHeight,t.renderHeight);this._screenWidth=this._canvas.width,this._screenHeight=this._canvas.height,this._canvas&&(this._canvas.width=r,this._canvas.height=i),Xi[0]=0,Xi[1]=0,Xi[2]=r/2,Xi[3]=i,this._cameras[0].setViewport(Xi),Xi[0]=r/2,this._cameras[1].setViewport(Xi)}},e.prototype._deactivateVR=function(){this._canvasResizeCB&&this._canvasResizeCB(this._screenWidth,this._screenHeight)},e.prototype.resize=function(){this._screenWidth=window.innerWidth,this._screenHeight=window.innerHeight},e.prototype.getPoseMatrix=function(e,t){var r=t.orientation,i=t.position;r||(r=[0,0,0,1]),i||(i=[0,0,0]),this._vrDisplay.stageParameters?(i[1]-=this._defaultViewerHeight,U.a.fromRotationTranslation(e,r,i),U.a.multiply(e,this._vrDisplay.stageParameters.sittingToStandingTransform,e)):U.a.fromRotationTranslation(e,r,i)},e.prototype.draw=function(e,t,r){if(this._ready&&this._vrDisplay){this._vrDisplay.getFrameData(Yi);var i,n=navigator.getGamepads();(i=n[0])&&(i.buttons[1].pressed&&(e.forward(.01,this._cameras[0].getViewDirection()),e.update()),i.buttons[2].pressed&&(e.forward(.01,this._cameras[0].getViewRightDirection()),e.update())),(i=n[1])&&(i.buttons[1].pressed&&(e.forward(-.01,this._cameras[0].getViewDirection()),e.update()),i.buttons[2].pressed&&(e.forward(-.01,this._cameras[0].getViewRightDirection()),e.update())),this._cameras[0].update(e,this._vrDisplay.getEyeParameters("left"),Yi.leftViewMatrix),this._cameras[1].update(e,this._vrDisplay.getEyeParameters("right"),Yi.rightViewMatrix),t.draw(this._cameras[0],this._cameras[1],null),this._vrDisplay.submitFrame()}else console.error("VR is not ready.")},e.prototype.drawSkybox=function(e,t,r,i,n){this._ready&&this._vrDisplay?(this._vrDisplay.getFrameData(Yi),this._cameras[0].update(e,this._vrDisplay.getEyeParameters("left"),Yi.leftViewMatrix),this._cameras[1].update(e,this._vrDisplay.getEyeParameters("right"),Yi.rightViewMatrix),i.drawSkybox(n,t,this._cameras[0]),i.drawSkybox(n,r,this._cameras[1]),this._vrDisplay.submitFrame()):console.error("VR is not ready.")},e}(),Ki=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ji=function(e){function t(t,r,i,n,a,o){var s=e.call(this,t,i,n,a,o)||this;s._alwaysUpdate=!0,s._nodesBatch=[],s._nodesBatchTransparent=[],s._cameraBatch=[],s._translations=null,s._animationBeginAt=0,s._animationDuration=0,s._animationDirection=1,s._animationCurrent=0,s._animationDone=null,s._overridedMaterials=null,s._overridedShader=null;var l=r.getOverridedMaterials();if(l)if(Object.keys(l).length<=4)for(var u in s._overridedMaterials={},l)s._overridedMaterials[u]=l[u].clone(u+"explodedView");else s._overridedMaterials=l.clone(l.name+"explodedView");for(var u in r.getAllVisualizes().forEach(function(e){s._visualizes.push(e)}),r.getSkeletons().forEach(function(e){s.addSkeleton(e)}),t.pawns)t.pawns[u].drawables.forEach(function(e){s.addDrawable(e)});for(var c in t.text3Ds.forEach(function(e){e.drawables.forEach(function(e){s.addDrawable(e)})}),s._overridedShader=r.getOverridedShader()||null,s._flags={},r._flags)s._flags[c]=r._flags[c];return s._alwaysUpdate=!0,s}return Ki(t,e),t.prototype.destroy=function(){for(var t=0;t<this._nodesBatch.length;t++)this._nodesBatch[t].destroy(),this._nodesBatchTransparent[t].destroy(),this._cameraBatch[t].destroy();this._nodesBatch=null,delete this._nodesBatch,this._nodesBatchTransparent=null,delete this._nodesBatchTransparent,this._cameraBatch=null,delete this._cameraBatch,this._translations=null,delete this._translations,this._animationDone=null,delete this._animationDone,e.prototype.destroy.call(this)},t.prototype.renderElements=function(t,r){void 0===r&&(r=!1),e.prototype.renderElements.call(this,t,r,!0);var i=new Yt(this._scene,this._camera.viewport);this._cameraBatch.push(i);var n=this._nodes.clone(),a=new Jr(this._resourceManager,this._renderQueueManager),o=new Jr(this._resourceManager,this._renderQueueManager);this._overridedMaterials&&0!==Object.keys(this._overridedMaterials).length&&(a.setOverridedShader(this._overridedShader),a.setOverridedMaterial(this._overridedMaterials),o.setOverridedShader(this._overridedShader),o.setOverridedMaterial(this._overridedMaterials)),n.getNodes().forEach(function(e){e.drawable.material.getTransparent()<.99?o._queue.push(e):a._queue.push(e)}),this._nodesBatch.push(a),this._nodesBatchTransparent.push(o)},t.prototype._drawFrame=function(e){var t=this._resourceManager.gl;this._renderer.clear(e,t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);for(var r=this._scene.clipping,i=this._scene.getMainLight(),n=0;n<this._skeletons.length;n++)this._skeletons[n].update();var a=[0,0,0];this._animationCurrent=Date.now()-this._animationBeginAt;var o=Math.min(this._animationCurrent/this._animationDuration,1);this._animationDirection<0&&(o=1-o);for(var s=U.a.create(),l=0;l<this._nodesBatch.length;l++)a[0]=this._translations[l][0]*o,a[1]=this._translations[l][1]*o,a[2]=this._translations[l][2]*o,s=U.a.fromTranslation(s,a),U.a.multiply(this._cameraBatch[l].viewMatrix,this._camera.viewMatrix,s),U.a.multiply(this._cameraBatch[l].vpMatrix,this._camera.projectMatrix,this._cameraBatch[l].viewMatrix),U.d.subtract(this._cameraBatch[l].eye,this._camera.eye,a),this._renderer.invalidate(),this._nodesBatch[l].render(e,this._renderer,this._cameraBatch[l],this._shadow,r,i);this._opaques.render(e,this._renderer,this._camera,this._shadow,r,i),this._maskeds.render(e,this._renderer,this._camera,this._shadow,r,i),this._flags.line&&this._lines.render(e,this._renderer,this._camera,this._shadow,r,i),e.always=!0,this._drawVisualize(e),this._transparents.render(e,this._renderer,this._camera,this._shadow,r,i);for(var u=0;u<this._nodesBatch.length;u++)e.always=!0,e.setOption("blend",!0),this._nodesBatchTransparent[u].render(e,this._renderer,this._cameraBatch[u],this._shadow,r,i),e.always=!0,e.setOption("blend",!1);this._scene.background.skybox&&this._scene.background.skybox.visible&&(this._scene.background.skybox.update(this._camera.viewMatrix),this._renderer.drawSkybox(e,this._scene.background.skybox,this._camera)),(o<=0&&this._animationDirection<0||o>=1&&this._animationDirection>0)&&(this._prEnabled=!0,this._animationDone?(this._alwaysUpdate=!1,this._animationDone()):this._alwaysUpdate=!0)},t.prototype.renderElementsTranslations=function(e){this._translations=e},t.prototype.enter=function(e){this._animationBeginAt=Date.now(),this._animationCurrent=0,this._animationDuration=e,this._animationDirection=1,this._prEnabled=!1,this._flags.specular&&(this._nodesBatch.forEach(function(e){e.recompileOverridedShader("SPECULAR",!0)}),this._nodesBatchTransparent.forEach(function(e){e.recompileOverridedShader("SPECULAR",!0)}),this._renderer.invalidate())},t.prototype.setProgressiveRenderingEnabled=function(e){this._flags.progressive=!1},t.prototype.quit=function(e){this._animationBeginAt=Date.now(),this._animationCurrent=0,this._animationDirection=-1,this._prEnabled=!1,this._flags.progressive=!1,this._animationDone=e},t}(Vi),$i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function en(e){return e===Ii.BYTE||e===Ii.UNSIGNED_BYTE?1:e===Ii.FLOAT||e===Ii.UNSIGNED_INT?4:e===Ii.HALF_FLOAT||e===Ii.UNSIGNED_SHORT?2:void 0}function tn(e){return["glass","glazing","玻璃","透明"].some(function(t){return e.toLowerCase().includes(t)})}function rn(e){return["metal","aluminium","steel","bronze","金属","铝","钢","铜"].some(function(t){return e.toLowerCase().includes(t)})}function nn(e){return["water","水面","湖面","海面"].some(function(t){return e.toLowerCase().includes(t)})}!function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.FLOAT=5126]="FLOAT",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT"}(Ii||(Ii={}));var an,on=function(){function e(e,t,r){this._scene=e,this._resourceManager=t,this._materialManager=r}return e.prototype.export=function(e){var t,r,i,n,a=e.drawables,o=[],s=this._resourceManager.getSourceDatas(),l={materials:{},geometrys:o,vertexData:s.vertexs,indexData:s.indexs,faces:this._scene.getFaces()>=1?2:1};try{for(var u=$i(a),c=u.next();!c.done;c=u.next()){var h=c.value,d=h.mesh,p=d.attributes.values,f={},m=d.attributes.primitive,_={bufferIndex:d.bufferIndex,box:h.bbox,attribute:f,transfrom:U.a.clone(h.transform.matrix),materialName:h.material.name,primitive:m,indexType:d.getIndexType(),iboBase:d._iboBase,vboBase:d._vboBase,length:d.length,id:h.getId()};try{for(var v=(i=void 0,$i(p)),y=v.next();!y.done;y=v.next()){var g=y.value,b={bufferIndex:_.bufferIndex,type:g.type,bytePerNumber:en(g.type),offset:g.offset,size:g.size,stride:g.stride};f[g.name]=b}}catch(e){i={error:e}}finally{try{y&&!y.done&&(n=v.return)&&n.call(v)}finally{if(i)throw i.error}}_.attribute=f,o.push(_)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}return l.materials=this.exportMaterials(),l},e.prototype.exportMaterials=function(){var e=this._materialManager.getModelMaterials(!0),t=this._resourceManager.getSourceTextures(),r={};for(var i in e){var n=!0,a={opacityMask:!1,useMxType:!0,diffuse:[1,1,1],reflect:[1,1,1],refract:[1,1,1],gloss:1},o=e[i];a.opacityMask=o.hasMask;var s=o.getTransparent(),l=t.get(o.textureFullName);if(tn(o.name)){if(a.diffuse=[0,0,0],a.reflect=[0,0,0],a.refract=[.2,.2,.2],a.gloss=1,!o.hasTexture)if(o.transparent){var u=1-s;a.refract=[u,u,u]}else a.refract=[0,0,0];o.textureTransparent&&(a.refract={value:l.name,image:l.image,scale:[1,1,0]})}else if(rn(o.name))a.diffuse=[.72,.72,.72],a.reflect=[1,1,1],a.refract=[0,0,0],a.gloss=.85;else if(nn(o.name))a.reflect=[.1,.1,.1],a.refract=[.6,.6,.6],a.gloss=1;else if(o.transparent||s>0&&s<1){if(a.diffuse=[0,0,0],a.reflect=[0,0,0],a.refract=[.2,.2,.2],a.gloss=1,!o.hasTexture)if(o.transparent){u=1-s;a.refract=[u,u,u]}else a.refract=[0,0,0]}else{var c=o.getDiffuse();a.diffuse=[c[0],c[1],c[2]],a.refract=[0,0,0],a.reflect=[0,0,0],a.gloss=1,n=!1}if(o.hasTexture&&l&&a.diffuse&&(a.diffuse={value:l.name,image:l.image,scale:[1,1,0]}),n&&a.diffuse){c=o.getDiffuse();a.diffuse=[c[0],c[1],c[2]]}a.useMxType=n,r[i]=a}return r},e}(),sn=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ln=function(e){function t(t,r,i){var n=e.call(this,t,null,null,null,i)||this;n.name=null;var a=r.getShader("gizmo",["MODEL_TRANSFORM"]);a.ready||a.createFromShaderSource(N.a.constant,["MODEL_TRANSFORM"]);var o=new V("",r);return o.attachShader(a,r),n.shader=a,n.material=o,n}return sn(t,e),t.prototype.setColor=function(e){this.material.setDiffuse(e)},t.prototype.setTransparent=function(e){this.material.setTransparent(e)},t}(I.a),un=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),cn=function(e){function t(t,r){return e.call(this,t,r,!1,{line:!0})||this}return un(t,e),t.prototype.render=function(e,t,r,i,n,a){if(this.queue.isValid()){if(null!==this._overridedMaterial&&this._overridedMaterial.transparent){var o=e.getOption("blend");e.setOption("blend",!0),e.always=!0}t.drawLinesWithVertexIds(e,this.queue.drawables,r,this._overridedShaders,this._overridedMaterial,n),null!==this._overridedMaterial&&this._overridedMaterial.transparent&&(e.setOption("blend",o),e.always=!0)}},t}($t),hn=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1],[2,-1],[2,0],[2,1],[2,2],[1,2],[0,2],[-1,2],[-2,2],[-2,1],[-2,0],[-2,-1],[-2,-2],[-1,-2],[0,-2],[1,-2],[2,-2],[3,-2],[3,-1],[3,0],[3,1],[3,2],[3,3],[2,3],[1,3],[0,3],[-1,3],[-2,3],[-3,3],[-3,2],[-3,1],[-3,0],[-3,-1],[-3,-2],[-3,-3],[-2,-3],[-1,-3],[0,-3],[1,-3],[2,-3],[3,-3],[4,-3],[4,-2],[4,-1],[4,0],[4,1],[4,2],[4,3],[4,4],[3,4],[2,4],[1,4],[0,4],[-1,4],[-2,4],[-3,4],[-4,4],[-4,3],[-4,2],[-4,1],[-4,0],[-4,-1],[-4,-2],[-4,-3],[-4,-4],[-3,-4],[-2,-4],[-1,-4],[0,-4],[1,-4],[2,-4],[3,-4],[4,-4],[5,-4],[5,-3],[5,-2],[5,-1],[5,0],[5,1],[5,2],[5,3],[5,4],[5,5],[4,5],[3,5],[2,5],[1,5],[0,5],[-1,5],[-2,5],[-3,5],[-4,5],[-5,5],[-5,4],[-5,3],[-5,2],[-5,1],[-5,0],[-5,-1],[-5,-2],[-5,-3],[-5,-4],[-5,-5],[-4,-5],[-3,-5],[-2,-5],[-1,-5],[0,-5],[1,-5],[2,-5],[3,-5],[4,-5],[5,-5],[6,-5],[6,-4],[6,-3],[6,-2],[6,-1],[6,0],[6,1],[6,2],[6,3],[6,4],[6,5],[6,6],[5,6],[4,6],[3,6],[2,6],[1,6],[0,6],[-1,6],[-2,6],[-3,6],[-4,6],[-5,6],[-6,6],[-6,5],[-6,4],[-6,3],[-6,2],[-6,1],[-6,0],[-6,-1],[-6,-2],[-6,-3],[-6,-4],[-6,-5],[-6,-6],[-5,-6],[-4,-6],[-3,-6],[-2,-6],[-1,-6],[0,-6],[1,-6],[2,-6],[3,-6],[4,-6],[5,-6],[6,-6],[7,-6],[7,-5],[7,-4],[7,-3],[7,-2],[7,-1],[7,0],[7,1],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7],[6,7],[5,7],[4,7],[3,7],[2,7],[1,7],[0,7],[-1,7],[-2,7],[-3,7],[-4,7],[-5,7],[-6,7],[-7,7],[-7,6],[-7,5],[-7,4],[-7,3],[-7,2],[-7,1],[-7,0],[-7,-1],[-7,-2],[-7,-3],[-7,-4],[-7,-5],[-7,-6],[-7,-7],[-6,-7],[-5,-7],[-4,-7],[-3,-7],[-2,-7],[-1,-7],[0,-7],[1,-7],[2,-7],[3,-7],[4,-7],[5,-7],[6,-7],[7,-7],[8,-7],[8,-6],[8,-5],[8,-4],[8,-3],[8,-2],[8,-1],[8,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],[7,8],[6,8],[5,8],[4,8],[3,8],[2,8],[1,8],[0,8],[-1,8],[-2,8],[-3,8],[-4,8],[-5,8],[-6,8],[-7,8],[-8,8],[-8,7],[-8,6],[-8,5],[-8,4],[-8,3],[-8,2],[-8,1],[-8,0],[-8,-1],[-8,-2],[-8,-3],[-8,-4],[-8,-5],[-8,-6],[-8,-7],[-8,-8],[-7,-8],[-6,-8],[-5,-8],[-4,-8],[-3,-8],[-2,-8],[-1,-8],[0,-8],[1,-8],[2,-8],[3,-8],[4,-8],[5,-8],[6,-8],[7,-8],[8,-8],[9,-8],[9,-7],[9,-6],[9,-5],[9,-4],[9,-3],[9,-2],[9,-1],[9,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[9,9],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,9],[-1,9],[-2,9],[-3,9],[-4,9],[-5,9],[-6,9],[-7,9],[-8,9],[-9,9],[-9,8],[-9,7],[-9,6],[-9,5],[-9,4],[-9,3],[-9,2],[-9,1],[-9,0],[-9,-1],[-9,-2],[-9,-3],[-9,-4],[-9,-5],[-9,-6],[-9,-7],[-9,-8],[-9,-9],[-8,-9],[-7,-9],[-6,-9],[-5,-9],[-4,-9],[-3,-9],[-2,-9],[-1,-9],[0,-9],[1,-9],[2,-9],[3,-9],[4,-9],[5,-9],[6,-9],[7,-9],[8,-9],[9,-9],[10,-9],[10,-8],[10,-7],[10,-6],[10,-5],[10,-4],[10,-3],[10,-2],[10,-1],[10,0],[10,1],[10,2],[10,3],[10,4],[10,5],[10,6],[10,7],[10,8],[10,9],[10,10],[9,10],[8,10],[7,10],[6,10],[5,10],[4,10],[3,10],[2,10],[1,10],[0,10],[-1,10],[-2,10],[-3,10],[-4,10],[-5,10],[-6,10],[-7,10],[-8,10],[-9,10],[-10,10],[-10,9],[-10,8],[-10,7],[-10,6],[-10,5],[-10,4],[-10,3],[-10,2],[-10,1],[-10,0],[-10,-1],[-10,-2],[-10,-3],[-10,-4],[-10,-5],[-10,-6],[-10,-7],[-10,-8],[-10,-9],[-10,-10],[-9,-10],[-8,-10],[-7,-10],[-6,-10],[-5,-10],[-4,-10],[-3,-10],[-2,-10],[-1,-10],[0,-10],[1,-10],[2,-10],[3,-10],[4,-10],[5,-10],[6,-10],[7,-10],[8,-10],[9,-10],[10,-10],[11,-10],[11,-9],[11,-8],[11,-7],[11,-6],[11,-5],[11,-4],[11,-3],[11,-2],[11,-1],[11,0],[11,1],[11,2],[11,3],[11,4],[11,5],[11,6],[11,7],[11,8],[11,9],[11,10],[11,11],[10,11],[9,11],[8,11],[7,11],[6,11],[5,11],[4,11],[3,11],[2,11],[1,11],[0,11],[-1,11],[-2,11],[-3,11],[-4,11],[-5,11],[-6,11],[-7,11],[-8,11],[-9,11],[-10,11],[-11,11],[-11,10],[-11,9],[-11,8],[-11,7],[-11,6],[-11,5],[-11,4],[-11,3],[-11,2],[-11,1],[-11,0],[-11,-1],[-11,-2],[-11,-3],[-11,-4],[-11,-5],[-11,-6],[-11,-7],[-11,-8],[-11,-9],[-11,-10],[-11,-11],[-10,-11],[-9,-11],[-8,-11],[-7,-11],[-6,-11],[-5,-11],[-4,-11],[-3,-11],[-2,-11],[-1,-11],[0,-11],[1,-11],[2,-11],[3,-11],[4,-11],[5,-11],[6,-11],[7,-11],[8,-11],[9,-11],[10,-11],[11,-11]];!function(e){e[e.NONE=-1]="NONE",e[e.VERTEX=0]="VERTEX",e[e.EDGE=1]="EDGE",e[e.EDGEMIDPOINT=2]="EDGEMIDPOINT"}(an||(an={}));var dn,pn=[0,0,0],fn=function(){function e(e,t,r,i){var n=r.gl;if(this._gl=n,n.isWebGL2){this._rendering=!1,this._camera=t,this._edgeIndex=-1,this._radius=5,this._edgePass=new cn(r,i),this._notEdgePass=new $t(r,i,!1,{line:!1});var a=r.getMesh("edge");a.createLine(),this._edge=new ln(a,r),this._edge.setColor([1,177/255,0]);var o=r.getMesh("snapping-dot");o.ready||o.createSphere(16,32),this._dot=new ln(o,r),this._dot.setColor([1,177/255,0]),this._dot.transform.matrix[0]=.1,this._dot.transform.matrix[5]=.1,this._dot.transform.matrix[10]=.1;var s=r.getShader("mark",[]);if(!s.ready){var l=N.a.mark;s.createFromShaderSource(l,[])}this._edgePass.setOverridedShader(s),this._edgePass.setOverridedMaterial(new O.a("edgemap")),this._notEdgePass.setCullFace(n.CCW);var u=t.viewport[2],c=t.viewport[3];if(this._rtEdge=new Jt.a("rtEdge",r,u,c,{depthTest:!0,colorFormat:n.RGBA8,colorFilter:n.NEAREST,depthBuffer:0,colorBuffer:0,clearColor:[1,1,1,1]}),this._rtNotEdge=new Jt.a("rtNotEdge",r,u,c,{depthTest:!0,colorFormat:n.RGBA8,colorFilter:n.NEAREST,depthBuffer:0,colorBuffer:0,colorMask:[0,0,0,0],clearColor:[1,1,1,1]}),this._rtDefault=new Jt.a("default",r,u,c,{depthFunc:n.LEQUAL}),!this._edgePass.queue.isValid())for(var h=0,d=e.models.length;h<d;++h)for(var p=0,f=(m=e.models[h].drawables).length;p<f;p++)this._edgePass.queue.addDrawable(m[p]);if(!this._notEdgePass.queue.isValid())for(h=0,d=e.models.length;h<d;++h){var m;for(p=0,f=(m=e.models[h].drawables).length;p<f;p++)this._notEdgePass.queue.addDrawable(m[p])}this._edgeBuffer=new Float32Array(6),this.resize(u,c)}else console.warn("Snapping requires a WebGL 2.0 context")}return e.prototype.destroy=function(){this._edge.mesh.destroy(),this._edge.destroy(),this._edge=null,delete this._edge,this._dot.destroy(),this._dot=null,delete this._dot,this._edgeBuffer=null,delete this._edgeBuffer,this._edgesBuffer=null,delete this._edgesBuffer,this._rtEdge.destroy(),this._rtEdge=null,delete this._rtEdge,this._rtNotEdge.destroy(),this._rtNotEdge=null,delete this._rtNotEdge,this._rtDefault.destroy(),this._rtDefault=null,delete this._rtDefault,this._edgePass.destroy(),this._edgePass=null,delete this._edgePass,this._notEdgePass.destroy(),this._notEdgePass=null,delete this._notEdgePass},e.prototype.recompileShader=function(e,t){this._edgePass.recompileOverridedShader(t)},e.prototype.setSnappingRadius=function(e){this._radius=Math.max(Math.min(e,11),0)},e.prototype.setRenderingEnabled=function(e){this._rendering=e},e.prototype.resize=function(e,t){this._rtEdge.resize(e,t),this._edgesBuffer=new Uint8Array(e*t*4)},e.prototype.render=function(e,t){this._rendering},e.prototype.snap=function(e,t){var r=this._rtEdge.getWidth(),i=this._rtEdge.getHeight(),n=Math.floor(e[0]*s.a.devicePixelRatio),a=Math.floor(i-1-e[1]*s.a.devicePixelRatio),o=!1,l=this._edgeIndex;this._edgeIndex=-1;for(var u=this._radius*this._radius-1,c=0;c<u;c++){var h=n+hn[c][0],d=a+hn[c][1];if(!(h<1||h>r-1||d<1||d>i-1)){var p=4*(h+d*r),f=this._edgesBuffer[p+0],m=this._edgesBuffer[p+1],_=this._edgesBuffer[p+2],v=this._edgesBuffer[p+3];if(255!==f||255!==m||255!==_||255!==v){var y=v<<24|_<<16|m<<8|f;this._edgeIndex=-2&y,o=!0,e[0]=Math.floor(h/s.a.devicePixelRatio),e[1]=Math.floor((i-1-d)/s.a.devicePixelRatio);break}}}if(this._edgeIndex!==l&&o)for(var g=0,b=(h=0,this._edgePass.queue.drawables.length);h<b;h++){var w=this._edgePass.queue.drawables[h],x=w.mesh,M=x.length;if(this._edgeIndex>=g&&this._edgeIndex<g+M){if(x.getVBSubData(12*(this._edgeIndex-g),this._edgeBuffer),!w.transform.identity){var T=w.transform.matrix;U.d.transformMat4(this._edgeBuffer,this._edgeBuffer,T),pn[0]=this._edgeBuffer[3],pn[1]=this._edgeBuffer[4],pn[2]=this._edgeBuffer[5],U.d.transformMat4(pn,pn,T),this._edgeBuffer[3]=pn[0],this._edgeBuffer[4]=pn[1],this._edgeBuffer[5]=pn[2]}this._rendering&&this._edge.mesh.update(this._edgeBuffer,new Uint16Array([0,1]));break}g+=M}return o?(t=t||[0,0,0],this._snapToMidPoint(e,t)?an.EDGEMIDPOINT:this._snapToVertex(e,t)?an.VERTEX:(this._snapToEdge(e,t),an.EDGE)):-1},e.prototype.update=function(e,t,r){var i=this._gl;e.invalidate(),e.clear(this._rtEdge,i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),this._notEdgePass.render(this._rtNotEdge,e,r),this._edgePass.render(this._rtEdge,e,r),i.readPixels(0,0,this._rtEdge.getWidth(),this._rtEdge.getHeight(),i.RGBA,i.UNSIGNED_BYTE,this._edgesBuffer)},e.prototype._snapToEdge=function(e,t){var r=[this._edgeBuffer[0],this._edgeBuffer[1],this._edgeBuffer[2]],i=[this._edgeBuffer[3],this._edgeBuffer[4],this._edgeBuffer[5]],n=this._camera.eye,a=this._camera.unproject(e[0],e[1]),o=U.d.create(),s=U.d.create(),l=U.d.create(),u=U.d.create();U.d.sub(o,i,r),U.d.sub(s,a,n),U.d.sub(l,n,r),U.d.cross(l,l,s),U.d.cross(u,o,s);var c=U.d.dot(l,u)/U.d.squaredLength(u);return U.d.lerp(t,r,i,c),!0},e.prototype._snapToMidPoint=function(e,t){var r=this._camera.project([.5*(this._edgeBuffer[0]+this._edgeBuffer[3]),.5*(this._edgeBuffer[1]+this._edgeBuffer[4]),.5*(this._edgeBuffer[2]+this._edgeBuffer[5])]),i=r[0]-e[0],n=r[1]-e[1];return i*i+n*n<this._radius*this._radius&&(e[0]=r[0],e[1]=r[1],t[0]=.5*(this._edgeBuffer[0]+this._edgeBuffer[3]),t[1]=.5*(this._edgeBuffer[1]+this._edgeBuffer[4]),t[2]=.5*(this._edgeBuffer[2]+this._edgeBuffer[5]),this._rendering&&(this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),!0)},e.prototype._snapToVertex=function(e,t){var r=this._camera.project(this._edgeBuffer),i=this._camera.project([this._edgeBuffer[3],this._edgeBuffer[4],this._edgeBuffer[5]]),n=r[0]-e[0],a=r[1]-e[1],o=i[0]-e[0],s=i[1]-e[1],l=n*n+a*a,u=o*o+s*s,c=this._radius*this._radius;return l<c&&l<u?(e[0]=r[0],e[1]=r[1],t[0]=this._edgeBuffer[0],t[1]=this._edgeBuffer[1],t[2]=this._edgeBuffer[2],this._rendering&&(this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),!0):u<c&&u<l&&(e[0]=i[0],e[1]=i[1],t[0]=this._edgeBuffer[3],t[1]=this._edgeBuffer[4],t[2]=this._edgeBuffer[5],this._rendering&&(this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),!0)},e}(),mn=[0,0,0],_n=[0,0,0],vn=[0,0,0],yn=[0,0,0],gn=[0,0,0],bn=function(){function e(e,t,r,i){this._normalDepthPass=new $t(r,i,!1,{line:!1}),this._rendering=!1,this._camera=t;var n=t.viewport[2],a=t.viewport[3],o=r.gl;this._gl=o,this._rtNormalDepth=new Jt.a(name+"_depth",r,n,a,{colorFormat:o.RGBA32F,colorFilter:o.NEAREST,colorBuffer:0,depthBuffer:0,clearColor:[0,0,0,0]}),this._rtDefault=new Jt.a("default",r,n,a,{depthFunc:o.LEQUAL});var s=r.getShader("normaldepth",["WORLDSPACE_NORMAL"]);if(!s.ready){var l=N.a.normaldepth;s.createFromShaderSource(l,["WORLDSPACE_NORMAL"])}this._normalDepthPass.setOverridedShader(s),this._normalDepthPass.setOverridedMaterial(new O.a("ruler-position-depth")),this._radius=10,this.resize(n,a);var u=r.getMesh("snapping-dot");if(u.ready||u.createSphere(16,32),this._dot=new ln(u,r),this._dot.setColor([1,177/255,0]),this._dot.transform.matrix[0]=.1,this._dot.transform.matrix[5]=.1,this._dot.transform.matrix[10]=.1,!this._normalDepthPass.queue.isValid())for(var c=0,h=e.models.length;c<h;++c)for(var d=e.models[c].drawables,p=0,f=d.length;p<f;p++)this._normalDepthPass.queue.addDrawable(d[p])}return e.prototype.destroy=function(){this._normalDepthPass.destroy(),this._normalDepthPass=null,delete this._normalDepthPass,this._dot.destroy(),this._dot=null,delete this._dot,this._rtNormalDepth.destroy(),this._rtNormalDepth=null,delete this._rtNormalDepth,this._rtDefault.destroy(),this._rtDefault=null,delete this._rtDefault,this._normalDepthBuffer=null,delete this._normalDepthBuffer},e.prototype.setSnappingRadius=function(e){this._radius=Math.max(Math.min(e,11),0)},e.prototype.snap=function(e,t){e[0],e[1];var r=this._rtNormalDepth.getWidth(),i=this._rtNormalDepth.getHeight(),n=Math.floor(e[0]*s.a.devicePixelRatio),a=Math.floor(i-1-e[1]*s.a.devicePixelRatio);if(t=t||[0,0,0],this._fetchNormal(n,a))for(var o=0;o<this._radius*this._radius-1;o++){var l=n+hn[o][0],u=a+hn[o][1];if(!(l<0||l>r-1||u<0||u>i-1)&&this._detectEdge(l,u))return e[0]=Math.floor(l/s.a.devicePixelRatio),e[1]=Math.floor((i-1-u)/s.a.devicePixelRatio),this._fetchPosition(l,u,t),this._rendering&&(this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),an.EDGE}return this._rendering&&(this._fetchPosition(n,a,t),this._dot.transform.matrix[12]=t[0],this._dot.transform.matrix[13]=t[1],this._dot.transform.matrix[14]=t[2]),-1},e.prototype._fetchNormal=function(e,t,r){var i=4*(e+t*this._rtNormalDepth.getWidth()),n=this._normalDepthBuffer[i],a=this._normalDepthBuffer[i+1],o=this._normalDepthBuffer[i+2];return n*n+a*a+o*o>.01&&(r&&(r[0]=n,r[1]=a,r[2]=o,U.d.normalize(r,r)),!0)},e.prototype._fetchPosition=function(e,t,r){var i=this._rtNormalDepth.getWidth(),n=this._rtNormalDepth.getHeight(),a=4*(e+t*i),o=this._normalDepthBuffer[a],l=this._normalDepthBuffer[a+1],u=this._normalDepthBuffer[a+2];if(o*o+l*l+u*u<.01)return!1;var c=e/s.a.devicePixelRatio,h=(n-1-t)/s.a.devicePixelRatio,d=this._normalDepthBuffer[a+3],p=this._camera.unproject(c,h,-d);return r[0]=p[0],r[1]=p[1],r[2]=p[2],!0},e.prototype._detectEdge=function(e,t){this._fetchNormal(e-1,t,mn),this._fetchPosition(e-1,t,vn),this._fetchNormal(e+1,t,_n),this._fetchPosition(e+1,t,yn),U.d.subtract(gn,vn,yn),U.d.normalize(gn,gn);var r=Math.max(Math.abs(U.d.dot(gn,mn)),Math.abs(U.d.dot(gn,_n)));this._fetchNormal(e,t-1,mn),this._fetchPosition(e,t-1,vn),this._fetchNormal(e,t+1,_n),this._fetchPosition(e,t+1,yn),U.d.subtract(gn,vn,yn),U.d.normalize(gn,gn);var i=Math.max(Math.abs(U.d.dot(gn,mn)),Math.abs(U.d.dot(gn,_n)));return r*r+i*i>.25},e.prototype.resize=function(e,t){this._rtNormalDepth.resize(e,t),this._normalDepthBuffer=new Float32Array(e*t*4)},e.prototype.update=function(e,t,r){var i=this._gl;e.invalidate(),e.clear(this._rtNormalDepth,i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),this._normalDepthPass.render(this._rtNormalDepth,e,r),i.readPixels(0,0,this._rtNormalDepth.getWidth(),this._rtNormalDepth.getHeight(),i.RGBA,i.FLOAT,this._normalDepthBuffer)},e.prototype.render=function(e,t){this._rendering&&e.drawGizmo(this._rtDefault,this._dot,t)},e.prototype.setRenderingEdgeEnabled=function(e){this._rendering=e},e}(),wn=function(){function e(){this.enabled=!1,this.modulate=!1,this._initialViewMatrix=U.a.create(),this._rotationMatrix=U.a.create(),this._tmpMatrix=U.a.create(),this._camera=null,this._initAlpha=null,this._flip=!1,this._deviceOrientation={alpha:0,beta:0,gamma:0},this._screenOrientation=window.orientation||0,this._quatRotate=U.b.create(),this._quatOrient=U.b.create(),this._prevValues=null,this._medianValues=null,window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent.bind(this)),window.DeviceOrientationEvent?window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent.bind(this)):console.warn("Your enviroment not support deviceOrientation")}return e.prototype.destroy=function(){this.detach(),window.removeEventListener("orientationchange",this.onScreenOrientationChangeEvent,!1),window.removeEventListener("deviceorientation",this.onDeviceOrientationChangeEvent,!1)},e.prototype.attach=function(e){this.onScreenOrientationChangeEvent(),this._camera=e,this.reset(e)},e.prototype.reset=function(e,t){void 0===t&&(t=!1),t||(e._theta=e._targetTheta,e._distance=e._targetDistance,e._phi=0,Bt.a.prototype.update.apply(e)),U.a.copy(this._initialViewMatrix,e.viewMatrix),this._medianValues=null,this._prevValues=null},e.prototype.detach=function(){this._initAlpha=null,this.enabled=!1,this._camera=null,this._prevValues=null,this._medianValues=null},e.prototype.onDeviceOrientationChangeEvent=function(e){if(this.enabled&&e.alpha){this._deviceOrientation.alpha=e.alpha,this._deviceOrientation.beta=e.beta,this._deviceOrientation.gamma=e.gamma;var t=Math.PI/180,r=this._deviceOrientation.alpha?t*this._deviceOrientation.alpha:0,i=this._deviceOrientation.beta?t*this._deviceOrientation.beta:0,n=this._deviceOrientation.gamma?t*this._deviceOrientation.gamma:0,a=this._screenOrientation?t*this._screenOrientation:0;if(null===this._initAlpha){var o,s,l;switch(Math.sign(a)){case-1:o=r,s=r+Math.PI/2,l=r+Math.PI;break;case 0:o=r-Math.PI/2,s=r,l=r+Math.PI/2;break;case 1:o=r-Math.PI,s=r-Math.PI/2,l=r}this._initAlpha={"-1":o,0:s,1:l},0!=Math.sign(a)&&Math.abs(i)>Math.PI/2&&(this._flip=!0)}r=r+Math.sign(a)*Math.PI/2-this._initAlpha[Math.sign(a).toString()],r=this._flip?r+Math.PI:r,U.b.setAxisAngle(this._quatOrient,[0,0,1],-a),U.b.fromYXZ(this._quatRotate,r,i,-n),U.b.multiply(this._quatRotate,this._quatRotate,[-Math.sqrt(.5),0,0,Math.sqrt(.5)]),U.b.multiply(this._quatRotate,this._quatRotate,this._quatOrient),U.b.invert(this._quatRotate,this._quatRotate),U.a.fromQuat(this._rotationMatrix,this._quatRotate),this._antiJitterValues(this._rotationMatrix)}},e.prototype.update=function(){this.modulate?(U.a.multiply(this._tmpMatrix,this._rotationMatrix,this._camera.viewMatrix),U.a.copy(this._camera.viewMatrix,this._tmpMatrix)):U.a.multiply(this._camera.viewMatrix,this._rotationMatrix,this._initialViewMatrix),U.a.multiply(this._camera.vpMatrix,this._camera.projectMatrix,this._camera.viewMatrix)},e.prototype.onScreenOrientationChangeEvent=function(){this._screenOrientation=window.orientation||0},e.prototype._antiJitterValues=function(e){if(null===this._medianValues){this._medianValues=new Array(16);for(var t=0;t<16;t++){this._medianValues[t]=new Array(10);for(var r=0;r<10;r++)this._medianValues[t][r]=e[t]}}if(null===this._prevValues){this._prevValues=new Array(16);for(t=0;t<16;t++)this._prevValues[t]=e[t]}new Array(10);for(var i=0;i<16;i++){for(t=9;t>0;t--)this._medianValues[i][t]=this._medianValues[i][t-1];this._medianValues[i][0]=e[i];for(var n,a=0,o=0;o<this._medianValues[i].length;o++)a+=this._medianValues[i][o];n=a/this._medianValues[i].length,e[i]=n,this._prevValues[i]=e[i]}},e.prototype.setEnabled=function(e){this.enabled=e},e}(),xn="3.8.14-build",Mn=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Tn=function(){return(Tn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},En=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Sn=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},An={isMobile:!1,transparent:!1,stencil:!1,samples:4},kn=function(e){function t(t,r,i,n){var a=e.call(this,t,r,i,n)||this;a.initialLoaded=!0,a._onCameraUpdateStopped=null,console.log("["+a._canvas.id+"] %cmodeloapi version: "+xn,"font-weight:bold;"),a._elapsedFrames=0;var o=a._setupGL(Tn(Tn({},An),r));return a._resourceManager=new kr(o),a._renderer=new Hr(a._resourceManager),a._materialManager=new Ir(a._resourceManager),a._scene=new Ct(a,a._materialManager),a._camera=new or(a),a._renderScene=new Vi(a._scene.core,a._camera.core,a._resourceManager,a._renderer,a._eventEmitter,r&&r.stencil),a._snapping=null,a.stateManager=new fr(a),a._onContextLostFn=null,a._onContextRestoreFn=null,a._canvas.addEventListener("webglcontextlost",a._onGLContextLost.bind(a),!1),a._canvas.addEventListener("webglcontextrestored",a._onGLContextRestore.bind(a),!1),a.getEventEmitter().on("refresh",a._renderScene.refresh),a._onUpdate=null,a._animationFn=a._requestAnimationFrame.bind(a),a._animationId=window.requestAnimationFrame(a._animationFn),a._vr=new ji(a,a._resourceManager,a._scene.core),a._webvr=new Zi(a,a._resourceManager,a._scene.core,a._eventEmitter),a.orientation=s.a.isMobile?new wn:null,a._renderModelFirst=!0,a._materialManager.setScene(a._scene.core),a._renderScene.retoreEventListener(),a._initCanvasHub(),a._update(),a.viewType=1,a._isProgressive=!0,a._onCameraUpdateStopped=function(){a.setProgressiveRendering(),a.disableBimCulling()},a._restoreCameraEventListener(),a._initStates={initSection:!1},a}return Mn(t,e),t.prototype.destroy=function(){if(this.state!==i.UNINITIALIZED){this._vr&&(this._vr.destroy(),this._vr=null,delete this._vr),this._webvr&&(this._webvr.destroy(),this._webvr=null,delete this._webvr),this.cancelAnimationFrame(),this._canvas.removeEventListener("webglcontextlost",this._onGLContextLost.bind(this),!1),this._canvas.removeEventListener("webglcontextrestored",this._onGLContextRestore.bind(this),!1),this._renderScene.destroy(),this._renderScene=null,delete this._renderScene,this._renderer.destroy(),this._renderer=null,delete this._renderer,this._scene.destroy(),this._scene=null,delete this._scene;var t=this._resourceManager.gl;this._resourceManager.destroy(),this._resourceManager=null,delete this._resourceManager,this._camera&&(this._camera.destroy(),this._camera=null,delete this._camera),this._snapping&&(this._snapping.destroy(),this._snapping=null,delete this._snapping),this._contextHud=null,this._canvasHud=null,this._destroyGL(t),e.prototype.destroy.call(this),this.viewType=-1}},t.prototype._initCanvasHub=function(){if(this._canvasHud=document.getElementById("canvas_model_comments"),this._canvasHud){var e=this.getWidth(),t=this.getHeight();this._canvasHud.oncontextmenu=function(){return!1},this._contextHud=this._canvasHud.getContext("2d"),this._canvasHud.style.width=e+"px",this._canvasHud.style.height=t+"px",this._canvasHud.width=e,this._canvasHud.height=t}},t.prototype.invalidate=function(t){void 0===t&&(t=1),this._renderer.invalidate(),this._renderScene.setProgressiveRenderingEnabled(!1),e.prototype.invalidate.call(this,t)},t.prototype.resize=function(t,r){if(e.prototype.resize.call(this,t,r),this.state!==i.UNINITIALIZED&&this.state!==i.INITIALIZED_PAUSED&&this.state!==i.RENDERING_PAUSED){t=this._canvas.width,r=this._canvas.height,this._camera.resize(t,r),this._renderScene.resize(t,r),this._vr.resize(t,r),null!==this._snapping&&this._snapping.resize(t,r);for(var n=0;n<this._tools.length;n++)this._tools[n].resize(t,r);this._renderScene.refresh(),this.invalidate()}},t.prototype.setDefaultCam=function(e){this._camera.core.setDefaultCam(e)},t.prototype.cancelAnimationFrame=function(e){var t=e||this._animationId;window.cancelAnimationFrame(t),this._animationId=-1},t.prototype._requestAnimationFrame=function(){this._update(),this._animationId=0,this._webvr.isPresenting()?this._animationId=this._webvr._vrDisplay.requestAnimationFrame(this._animationFn):this._animationId=window.requestAnimationFrame(this._animationFn)},t.prototype._recompileShadow=function(){this._renderScene.recompileShadow()},t.prototype._recompileSpecular=function(){this._renderScene.recompileSpecular()},t.prototype._needUpdate=function(){return!this._inactived()&&(!!this._cameraUpdated()||(!!this._toolNeedUpdate()||(!!this._visualizeUpdate()||(!!this._vr.enabled||(!!this._webvr.enabled||(this._nFramesTobeDrawnNormally>0||this._nFramesTobeDrawnProgressively>0))))))},t.prototype._inactived=function(){return this.state!=i.RENDERING},t.prototype._toolNeedUpdate=function(){return this._tools.some(function(e){return e.needUpdate()})},t.prototype._visualizeUpdate=function(){var e,t,r=this._renderScene.getAllVisualizes();try{for(var i=En(r),n=i.next();!n.done;n=i.next()){if(n.value.isNeedUpdate())return this._renderScene.setProgressiveRenderingEnabled(!1),!0}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return!1},t.prototype._cameraUpdated=function(){var e=this._camera.update();return e&&(this.notifyEventListener("cameraUpdated"),this.notifyEventListener("cameraRotate",this._camera.core.getRotation()),this._renderScene.refresh(),this._nFramesTobeDrawnProgressively=0),e},t.prototype._updateCurrentFrame=function(){this._beginFrame(),this._drawFrame(),this._endFrame()},t.prototype._beginFrame=function(){this._renderer.beginFrame(this._renderScene.getRenderTarget().getFramebuffer()),this._renderScene.haseModel()&&this._renderModelFirst&&(this._eventEmitter.emit("firstMeshReady"),this._renderModelFirst=!1)},t.prototype._drawFrame=function(){this.getRenderScene().isVisible()&&(this._nFramesTobeDrawnProgressively>0?this._drawFrameProgressively(17-this._nFramesTobeDrawnProgressively):this._drawFrameNormally())},t.prototype._drawFrameNormally=function(){this._drawSceneNormally(),this._drawToolsNormally(),this._drawEffectsNormally()},t.prototype._drawFrameProgressively=function(e){this._jitterCamera(e),this._drawSceneProgressively(e),this._drawToolsProgressively(),this._drawEffectsProgressively(e),this._restoreCamera(e),this._accumulateCurrentFrame(e)},t.prototype._jitterCamera=function(e){var t=Sn(this._getJitterValuesOfFrame(e),2),r=t[0],i=t[1];this._camera.core.jitter(r,i)},t.prototype._restoreCamera=function(e){var t=Sn(this._getJitterValuesOfFrame(e),2),r=t[0],i=t[1];this._camera.core.jitter(-r,-i),this._camera.core.jitter(0,0)},t.prototype._getJitterValuesOfFrame=function(e){var t=Gr._4X4[2*(e-1)]-.5,r=Gr._4X4[2*(e-1)+1]-.5;return[t/this._camera.core.viewport[2],r/this._camera.core.viewport[3]]},t.prototype._drawSceneProgressively=function(e){this._renderScene.drawProgressively(e)},t.prototype._drawEffectsProgressively=function(e){this._renderScene.drawEffectsProgressively(e)},t.prototype._drawEffectsNormally=function(){this._renderScene.drawEffectsNormally()},t.prototype._drawToolsProgressively=function(){this._tools.forEach(function(e){return e.renderProgressively()})},t.prototype._accumulateCurrentFrame=function(e){this._renderScene.accumulateCurrentFrame(e)},t.prototype._drawSceneNormally=function(){return this._webvr&&this._webvr.isPresenting()?this._webvr.draw(this.getSceneCamera(),this._renderScene,this._renderer):this._vr.enabled?(this.getTool("InAppNavigation").isEnabled()&&(this.getSceneCamera().update(),this.orientation.modulate=this.getSceneCamera().animator instanceof rr.a),this.orientation.update(),this._vr.draw(this.getSceneCamera(),this._renderScene,this._renderer)):void this._renderScene._drawNormally()},t.prototype._drawToolsNormally=function(){this._tools.forEach(function(e){return e.renderNormally()})},t.prototype._endFrame=function(){this._renderer.endFrame(),this._elapsedFrames++;var e=1===this._nFramesTobeDrawnNormally;(this._nFramesTobeDrawnNormally>0&&this._nFramesTobeDrawnNormally--,e)?this.setProgressiveRendering():(this._nFramesTobeDrawnProgressively--,0===this._nFramesTobeDrawnProgressively&&(this._renderScene.updateShadow(),this.notifyEventListener("ProgressiveRenderEnd")))},t.prototype._dumpTools=function(){var e,t;try{for(var r=En(this._tools),i=r.next();!i.done;i=r.next()){var n=i.value;n.isEnabled()&&n.dump()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype._update=function(){this._needUpdate()&&(this._onUpdate&&this._onUpdate(),this.notifyEventListener("before-rendering"),this._updateCurrentFrame(),this.notifyEventListener("after-rendering"))},t.prototype.pause=function(){this.state!==i.INITIALIZED&&this.state!==i.RENDERING||(this.state=this.state===i.INITIALIZED?i.INITIALIZED_PAUSED:i.RENDERING_PAUSED,this._resourceManager.discard(),this.cancelAnimationFrame()),e.prototype.pause.call(this)},t.prototype.resume=function(){this.state!==i.INITIALIZED_PAUSED&&this.state!==i.RENDERING_PAUSED||(this._resourceManager.restore(),this.state=this.state===i.INITIALIZED_PAUSED?i.INITIALIZED:i.RENDERING);var t=parseInt(this._canvas.style.width.replace("px","")),r=parseInt(this._canvas.style.height.replace("px",""));this.resize(t,r),this.invalidate(),this._requestAnimationFrame(),e.prototype.resume.call(this)},t.prototype.dumpScreen=function(e,t,r,i){var n=this._scene.core.background.getColor();e||t?t||(t=e*this._canvas.height/this._canvas.width):(e=this._canvas.width,t=this._canvas.height);var a=Math.floor(this._canvas.width/s.a.devicePixelRatio),o=Math.floor(this._canvas.height/s.a.devicePixelRatio),l=Math.floor(e/s.a.devicePixelRatio),u=Math.floor(t/s.a.devicePixelRatio);r&&this.setBackgroundColor(r),l!==a||u!==o?this.resize(l,u):this.invalidate();var c=this._tools.find(function(e){return"ArchDesign"===e.name});c&&c.disableRenderingOfHoverAndSelectedNodes(),this.drawHD(),c&&c.enableRenderingOfHoverAndSelectedNodes(),this._dumpTools(),this.setBackgroundColor(n);var h="";return i?(i&&this._contextHud.filter&&(this._contextHud.filter=i),this._contextHud.clearRect(0,0,this._canvasHud.width,this._canvasHud.height),this._contextHud.drawImage(this._canvas,0,0),h=this._canvasHud.toDataURL("image/jpg"),i&&this._contextHud.filter&&(this._contextHud.filter="none")):h=this._canvas.toDataURL("image/jpg"),l!==a||u!==o?this.resize(a,o):this.invalidate(),h},t.prototype.drawNormally=function(){this._renderScene.draw()},t.prototype.get360Screenshots=function(e,t){console.log("get360Screenshots");var r=e?1600:800,i=e?1600:800,n=Math.floor(this.getCanvas().width/s.a.devicePixelRatio),a=Math.floor(this.getCanvas().height/s.a.devicePixelRatio),o=Math.floor(r/s.a.devicePixelRatio),l=Math.floor(i/s.a.devicePixelRatio),u=this.getCamera().core;o===n&&l===a||this.resize(o,l);var c={distance:u._distance,phi:u._phi,theta:u._theta,at:[u._at[0],u._at[1],u._at[2]],eye:[u.eye[0],u.eye[1],u.eye[2]],aspect:u._aspect,fov:u._fov},h=this._scene.core.background.mode,d=u.eye,p={aspect:1};p.distance=u._distance,p.phi=0,p.theta=0,p.eye=[],p.at=d,p.fov=90;var f=document.createElement("canvas"),m=document.createElement("canvas");m.width=f.width=6*r,m.height=f.height=i;var _=m.getContext("2d"),v=f.getContext("2d");this._scene.core.background.setMode(2),this._scene.setBackgroundFov(90);for(var y=0;y<6;y++){switch(y){case 0:p.phi=0,p.theta=.5*Math.PI,p.at=[d[0],d[1]-c.distance,d[2]];break;case 1:p.phi=0,p.theta=-.5*Math.PI,p.at=[d[0],d[1]+c.distance,d[2]];break;case 2:p.phi=.5*Math.PI,p.theta=-Math.PI/2,p.at=[d[0],d[1],d[2]-c.distance];break;case 3:p.phi=-.5*Math.PI,p.theta=-Math.PI/2,p.at=[d[0],d[1],d[2]+c.distance];break;case 4:p.phi=0,p.theta=Math.PI,p.at=[d[0]+c.distance,d[1],d[2]];break;case 5:p.phi=0,p.theta=0,p.at=[d[0]-c.distance,d[1],d[2]]}u.setparam(p),this._renderer.invalidate(),this.drawHD(),_.drawImage(this._canvas,y*r,0),this._renderer.invalidate()}o===n&&l===a||this.resize(n,a),u.eye[0]=c.eye[0],u.eye[1]=c.eye[1],u.eye[2]=c.eye[2],u.setparam(c),this._scene.core.background.setMode(h),this._scene.setBackgroundFov(c.fov),v.translate(6*r,0),v.scale(-1,1),v.drawImage(m,0,0);var g=f.toDataURL("image/jpg");if(t){var b=document.createElement("a");b.href=g,b.download="360Panorama.jpg",b.click()}return g},t.prototype.autoProductPanoramas=function(e,t,r){return this._camera.autoProductPanoramas(e,t,r)},t.prototype.drawPanorama=function(e,t){var r={image:""},i=t?2048:1024,n=t?2048:1024,a=Math.floor(this.getCanvas().width/s.a.devicePixelRatio),o=Math.floor(this.getCanvas().height/s.a.devicePixelRatio),l=Math.floor(i/s.a.devicePixelRatio),u=Math.floor(n/s.a.devicePixelRatio),c=this.getCamera().core;l===a&&u===o||this.resize(l,u);var h={distance:c._distance,phi:c._phi,theta:c._theta,at:[c._at[0],c._at[1],c._at[2]],eye:[c.eye[0],c.eye[1],c.eye[2]],aspect:c._aspect,fov:c._fov},d=this._scene.core.background.mode,p=e;c.eye[0]=e[0],c.eye[1]=e[1],c.eye[2]=e[2];var f={aspect:1};f.distance=c._distance,f.phi=0,f.theta=0,f.eye=[],f.at=[],f.fov=90;var m=document.createElement("canvas"),_=document.createElement("canvas");_.width=m.width=6*i,_.height=m.height=n;var v=_.getContext("2d"),y=m.getContext("2d");this._scene.core.background.setMode(2),this._scene.setBackgroundFov(90);for(var g=0;g<6;g++){switch(g){case 0:f.phi=0,f.theta=.5*Math.PI,f.at=[p[0],p[1]-h.distance,p[2]];break;case 1:f.phi=0,f.theta=-.5*Math.PI,f.at=[p[0],p[1]+h.distance,p[2]];break;case 2:f.phi=.5*Math.PI,f.theta=-Math.PI/2,f.at=[p[0],p[1],p[2]-h.distance];break;case 3:f.phi=-.5*Math.PI,f.theta=-Math.PI/2,f.at=[p[0],p[1],p[2]+h.distance];break;case 4:f.phi=0,f.theta=Math.PI,f.at=[p[0]+h.distance,p[1],p[2]];break;case 5:f.phi=0,f.theta=0,f.at=[p[0]-h.distance,p[1],p[2]]}c.setparam(f),this._renderer.invalidate(),this.drawHD(),v.drawImage(this._canvas,g*i,0),this._renderer.invalidate()}return l===a&&u===o||this.resize(a,o),c.eye[0]=h.eye[0],c.eye[1]=h.eye[1],c.eye[2]=h.eye[2],c.setparam(h),this._scene.core.background.setMode(d),this._scene.setBackgroundFov(h.fov),y.translate(6*i,0),y.scale(-1,1),y.drawImage(_,0,0),r.image=m.toDataURL("image/jpg"),r},t.prototype.setLightingLatitude=function(e){this._scene.core.setLightingLatitude(e),this._renderScene.updateShadow(),this.invalidate(16)},t.prototype.setLightingLongitude=function(e){this._scene.core.setLightingLongitude(e),this._renderScene.updateShadow(),this.invalidate(16)},t.prototype.setClipping=function(e,t){this._scene.core.clipping.set(e,t)},t.prototype.setLightingIntensity=function(e){this._scene.core.setLightingIntensity(e),this.invalidate(16)},t.prototype.setRenderingLinesEnabled=function(e){this._renderScene.setLineRendering(e),this.invalidate()},t.prototype.isLineRenderingEnabled=function(){return this._renderScene.isLineRendering()},t.prototype.setBaseRenderingEnabled=function(e){this._renderScene.setBaseRenderingEnabled(e),this.invalidate()},t.prototype.setSpecularEnabled=function(e){this._renderScene.setSpecularEnabled(e),this.invalidate()},t.prototype.setShadowEnabled=function(e){this._renderScene.setShadowEnabled(e),this._renderScene.onSceneChanged(-1),this.invalidate()},t.prototype.addInput=function(t){var r=e.prototype.addInput.call(this,t);return this._camera.addInput(t),r},t.prototype.getMouse=function(){for(var e=0;e<this._inputs.length;e++)if("mouse"===this._inputs[e].name)return this._inputs[e];return null},t.prototype.getKeyboard=function(){for(var e=0;e<this._inputs.length;e++)if("keyboard"===this._inputs[e].name)return this._inputs[e];return null},t.prototype._setupGL=function(e){var t=e.isMobile,r=e.stencil,i=e.samples,n=s.a.browserName,a=s.a.browserVersion,o=!!e.useWebGL2,l=!0;"chrome"===n&&"62"===a&&(l=!1),"mobile safari"===n&&(o=!1),t&&512===s.a.gpuMemory&&(o=!1);var u=function(e,t){t.antialias=!t.webgl2&&t.samples>1,t.depth=!t.webgl2&&t.depth;var r=WebGLUtils.setupWebGL(e,t);r.version=r.getParameter(r.VERSION);var i=null!==r.version.match("WebGL 2.0");if(i)r.floatTextureExtension=r.getExtension("EXT_color_buffer_float"),r.floatTextureExtension2=r.getExtension("OES_texture_float_linear"),r.instancingExtension=t.instancing,r.COLOR_ATTACHMENT0_WEBGL=r.COLOR_ATTACHMENT0;else{t.instancing&&(r.instancingExtension=r.getExtension("ANGLE_instanced_arrays")),r.instancingExtension?(t.vao&&console.warn("Instance drawing and VAO cannot use at same time. Turn off VAO."),r.drawElementsInstanced=function(e,t,i,n,a){r.instancingExtension.drawElementsInstancedANGLE(e,t,i,n,a)},r.vertexAttribDivisor=function(e,t){r.instancingExtension.vertexAttribDivisorANGLE(e,t)}):(t.vao&&(r.vaoExtension=r.getExtension("OES_vertex_array_object")),r.vaoExtension&&(r.deleteVertexArray=function(e){return r.vaoExtension.deleteVertexArrayOES(e)},r.bindVertexArray=function(e){return r.vaoExtension.bindVertexArrayOES(e)},r.createVertexArray=function(){return r.vaoExtension.createVertexArrayOES()})),r.floatTextureExtension=(r.getExtension("OES_texture_float")||r.getExtension("WEBGL_color_buffer_float"))&&r.getExtension("OES_texture_float_linear"),r.depthTextureExtension=r.getExtension("WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture"),r.uintIBOExtension=r.getExtension("OES_element_index_uint");var n=r.getExtension("WEBGL_draw_buffers");r.COLOR_ATTACHMENT0_WEBGL=n?n.COLOR_ATTACHMENT0_WEBGL:r.COLOR_ATTACHMENT0,r.s3tcExtension=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),r.halfFloatExtension=r.getExtension("OES_texture_half_float"),r.halfFloatLinearExtension=r.getExtension("OES_texture_half_float_linear")}var a=new Uint8Array(4);return r.syncGPU=function(){"chrome"===s.a.browserName?r.readPixels(0,0,1,1,r.RGBA,r.UNSIGNED_BYTE,a):r.finish()},r.isWebGL2=i,r.isWebGL2||(r.RGBA8=r.RGBA,r.RGB8=r.RGB,r.DEPTH24_STENCIL8=r.DEPTH_STENCIL,r.DEPTH_COMPONENT24=r.DEPTH_COMPONENT,r.RGBA32F=34836,r.RGB32F=34837),r.wbSamples=t.samples,r.wbFormat=t.alpha?r.RGBA8:r.RGB8,r.wbDepthFormat=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,r}(this._canvas,{depth:!0,alpha:!0,premultipliedAlpha:!1,samples:i,stencil:r,preserveDrawingBuffer:!1,vao:l,instancing:!1,webgl2:o});if(null!==u){var c=u.isWebGL2?"2.0":"1.0";console.group("["+this._canvas.id+"] A WebGL "+c+" context created"),console.log("color: RGBA, depth: enabled, stencil: "+(r?"enabled":"disabled")),console.log("  VAO: "+(l?"enabled":"disabled")),console.log("  Instancing: "+(u.instancingExtension?"enabled":"disabled")),console.groupEnd()}return u},t.prototype._destroyGL=function(e){if(e){var t=e.isWebGL2?"2.0":"1.0";console.group("A WebGL "+t+" context is destroyed");var r=e.getExtension("WEBGL_lose_context");null!==r&&r.loseContext(),e=void 0,console.groupEnd()}},t.prototype.setBackgroundColor=function(e){this._scene&&(this._scene&&this._scene.core.background.setColor(e),this.invalidate())},t.prototype.setBackgroundImage=function(e,t){void 0===t&&(t=!1),this._scene&&(this._scene.setBackgroundImage(e,t),this.invalidate())},t.prototype.setReflectionImages=function(e){this._scene.setReflectionMap(e),this.invalidate()},t.prototype.setBackgroundMode=function(e){if(this._scene&&this._scene.core&&this._scene.core.background){if(this._scene.core.background.setMode(e),this._scene.core.background.skybox){var t=Sn([this.getWidth(),this.getHeight()],2),r=t[0],i=t[1];this._scene.core.background.skybox.resize(r,i)}this.invalidate()}},t.prototype.setBackgroundDirection=function(e){this._scene&&this._scene.core&&this._scene.core.background&&(this._scene.core.background.setBackgroundDirection(e),this.invalidate())},t.prototype.getScene=function(){return this._scene},t.prototype.getSnapping=function(){return null===this._snapping&&(this._resourceManager.gl.isWebGL2&&this.getScene().hasContours()?this._snapping=new fn(this._scene.core,this._camera.core,this._resourceManager,this._renderScene.getRenderQueueManager()):(this._snapping=new bn(this._scene.core,this._camera.core,this._resourceManager,this._renderScene.getRenderQueueManager()),this._snapping.setSnappingRadius(8))),this._snapping},t.prototype.getResourceManager=function(){return this._resourceManager},t.prototype.getMaterialManager=function(){return this._materialManager},t.prototype.getRenderer=function(){return this._renderer},t.prototype.getRenderScene=function(){return this._renderScene},t.prototype.getCamera=function(){return this._camera},t.prototype.setLazyRenderingEnabled=function(e){this._isProgressive=e,this._renderScene.setProgressiveRenderingEnabled(e)},t.prototype._onGLContextLost=function(){this.cancelAnimationFrame(),this._onContextLostFn&&this._onContextLostFn(),this.notifyEventListener("webglcontextlost")},t.prototype._onGLContextRestore=function(){this._onContextRestoreFn&&this._onContextRestoreFn(),this.notifyEventListener("webglcontextrestored")},t.prototype.setContextLostCbk=function(e){this._onContextLostFn=e},t.prototype.setContextRestoreCbk=function(e){this._onContextRestoreFn=e},t.prototype.setUpdateCallback=function(e){this._onUpdate=e},t.prototype.setSmartCullingEnabled=function(e){this._renderScene.setSmartCullingEnabled(e),this._scene.core.isBimCullingNeeded=!0,this._scene.core.nodes<=1e5&&this._scene.core.meshKbytes<=1e5&&console.warn("The model is too small to be used SmartCulling")},t.prototype.isSmartCullingEnabled=function(){return this._renderScene.isSmartCullingEnabled()},t.prototype.setEffectEnabled=function(e,t){this._renderScene.setEffectEnabled(e,t),this._renderScene.onSceneChanged(-1),this.invalidate()},t.prototype.setEffectParameter=function(e,t,r){this._renderScene.getEffect(e).setParameter(t,r),this.invalidate()},t.prototype.isEffectEnabled=function(e){return this._renderScene.isEffectEnabled(e)},t.prototype.enterExplodedView=function(e,t){if(!(this._renderScene instanceof Ji)){this._removeCameraEventListener();var r=new Ji(this._scene.core,this._renderScene,this._camera.core,this._resourceManager,this._renderer,this._eventEmitter);r.previous=this._renderScene,this._renderScene=r;for(var i=0;i<e.length;i++)r.renderElements(e[i]);r.renderElementsTranslations(t),r.enter(2e3),this.invalidate()}},t.prototype.quitExplodedView=function(){var e=this;this._renderScene instanceof Ji&&(this._renderScene.quit(function(){var t=e._renderScene;e._renderScene=t.previous,e._restoreCameraEventListener(),t.destroy(),e.invalidate()}),this.invalidate())},t.prototype.setOverrideColor=function(e){var t,r=this._materialManager.createMaterialOverride("override");this._resourceManager.hasShader("solid",[])&&(t=this._resourceManager.getShader("solid",[])),this._resourceManager.hasShader("texture",[])&&(t=this._resourceManager.getShader("texture",[])),this._resourceManager.hasShader("dark",[])&&(t=this._resourceManager.getShader("dark",[])),r.attachShader(t),r.setDiffuse(e),r.setTransparent(e[3]),e[3]<.99&&r.setUseTransparent(!1),r.setUsediffuseTexture(!1),r.setUsemaskTexture(!1),this._renderScene.setOverridedMaterials({opaques:r}),this.invalidate()},t.prototype.setOITEnabled=function(e){this._renderScene.setOITEnabled(e),this.invalidate()},t.prototype.focusElements=function(e,t){if(void 0===t&&(t=1),null!=e&&0!=e.length){var r=this._scene.getElementsBBox(e);P.a.aabb.len(r)>=1/0||this._camera.cores.forEach(function(e){e.lookTo(P.a.aabb.center(r),t*P.a.aabb.len(r)/2)})}},t.prototype.getSelectedElements=function(){var e=this.getTool("SelectElement");return e?e.getSelectedElements():[]},t.prototype.getElapsedFrames=function(){return this._elapsedFrames},t.prototype.setMaterialParameter=function(e,t,r){this._scene.setMaterialParameter(e,t,r),"opacity"===t&&this._renderScene.onOpacityChanged(this._scene.core.getDrawablesByMaterialName(e)),this.invalidate()},t.prototype.getMaterialParameter=function(e,t){return this._scene.getMaterialParameter(e,t)},t.prototype.setToneMappingEnabled=function(e){this._scene.setToneMappingEnabled(e),this.invalidate()},t.prototype.setToneMappingExposure=function(e){e<=0?console.warn("Exposure should be greater than 0!"):(this._scene.setToneMappingExposure(e),this.invalidate())},t.prototype.enabledTwoPointsPerspective=function(e){this._camera.enabledTwoPointsPerspective(e),this.invalidate()},t.prototype.setCullingEnabled=function(e){this._camera.core.setCullingEnabled(e)},t.prototype.setSketchEnabled=function(e){this.setEffectEnabled("Sketch",e),this.setEffectParameter("Sketch","transparents",e),this.invalidate()},t.prototype.setSketchColorEnabled=function(e){this.setEffectParameter("Sketch","colored",e),this._recompileShadow(),this.invalidate(),this.stateManager.onSkechColorEnableChanged(e)},t.prototype.setSketchDetailLevel=function(e){this.setEffectParameter("Sketch","detail",e),this._recompileShadow(),this.invalidate(16)},t.prototype.setSketchContrast=function(e){this.setEffectParameter("Sketch","contrast",e),this._recompileShadow(),this.invalidate(16)},t.prototype.setlightZRotation=function(e){this._scene.setlightZRotation(e),this._recompileShadow(),this.invalidate(16)},t.prototype.setFov=function(e){this._camera.setFov(e)},t.prototype.getSceneCameraData=function(){return this._camera.getData()},t.prototype.getSceneCamera=function(){return this._camera.core},t.prototype.getSceneClippingData=function(){if(this._scene.core.clipping.isEnabled()){return{planes:this._scene.core.clipping.getClippingPlanes(!0),points:this._scene.core.clipping.getClippingPoints(!0)}}return null},t.prototype.getAllMaterials=function(){return this._materialManager.getAllMaterials()},t.prototype.getModelMaterials=function(e){return void 0===e&&(e=!1),this._materialManager.getModelMaterials(e)},t.prototype.getOriginModelBox=function(){return this._scene.getOriginModelBox()},t.prototype.getModelBox=function(){return this._scene.getModelBox()},t.prototype.getSceneBox=function(){return this._scene.getSceneBox()},t.prototype.clearPopModel=function(){this._scene.clearPopModel()},t.prototype.setModelTransform=function(e,t){this._scene.setModelTransform(e,t),this._eventEmitter.emit("modelTransformUpdate",e)},t.prototype.getModelTransform=function(e){return this._scene.getModelTransform(e)},t.prototype.hasProfileLines=function(){var e=this.getScene().core;for(var t in e.models)e.hasProfileLines=e.hasProfileLines||e.models[t].hasProfileLines;return e.hasProfileLines},t.prototype.hasCurveOrLine=function(){var e=this.getScene().core;for(var t in e.models)e.hasCurveOrLine=e.hasCurveOrLine||e.models[t].hasCurveOrLine;return e.hasCurveOrLine},t.prototype.setGammaEnabled=function(e){this._renderScene.setGammaEnabled(e),this.invalidate()},t.prototype.removePawn=function(e){this._scene.removePawn(this._scene.getPawn(e)),this._renderScene.onSceneChanged(-1)},t.prototype.getPawn=function(e){return this._scene.getPawn(e)},t.prototype.setCameraManipulatorEnabled=function(e){var t=this.getMouse();t&&(t.isCameraManipulated=e)},t.prototype.setSceneVisible=function(e){this._scene.core.setVisibility(e),this._renderScene.setVisible(e),this.invalidate()},t.prototype.destroyBuffers=function(){this._resourceManager.destroyBuffers()},t.prototype.restoreBuffers=function(){this._resourceManager.restoreBuffers()},t.prototype.setElementsColor=function(e,t){this._scene.setElementsColor(e,t)},t.prototype.switchToUserView=function(e,t){e.distance||(e.distance=e.cameraDistance),this.getCamera().switchToUserView(e,t||this._vr.enabled),e&&(e.nodes.length>0&&this._renderScene.onSceneChanged(-1),this.invalidate())},t.prototype.getSceneMainLight=function(){return this._scene.core.getMainLight()},t.prototype.getLightingIntensity=function(){return this._scene.core.getMainLight().getIntensity()},t.prototype.requestAnimationFrame=function(e){if(this.state===i.UNINITIALIZED)return 0;return window.requestAnimationFrame(e)},t.prototype.clobber=function(){this.setSceneVisible(!1),this._resourceManager.discard(),this._renderer.discard(),this._resourceManager.gl=null},t.prototype.hide=function(){this.setSceneVisible(!1),this._resourceManager.discard()},t.prototype.show=function(){this._resourceManager.restore(),this.state!==i.RENDERING&&this.state!==i.INITIALIZED||this.setSceneVisible(!0),this._renderScene.onSceneChanged(-1),this._renderScene.setProgressiveRenderingEnabled(this._isProgressive),this.invalidate()},t.prototype.startRendering=function(){this._animationId<0&&(this.requestAnimationFrame(this._animationFn),this._renderScene.onSceneChanged(-1),this._recompileShadow())},t.prototype.stopRendering=function(){this._animationId>0&&this.cancelAnimationFrame()},t.prototype.restoreCamera=function(e,t){this._camera.setData(e,t)},t.prototype.setDblclickEnabled=function(e){this.getCamera().setDblclickEnabled(e)},t.prototype.getLayerData=function(e){var t=e&&this._scene.getModel(e);return t?t.getLayerJsonData():[]},t.prototype.setLayersVisible=function(e,t,r){var i=this._scene.getModel(e);i&&(t.forEach(function(e){return i.showLayer(e)}),r.forEach(function(e){return i.hideLayer(e)}),this.invalidate())},t.prototype.restoreLayersDefaultSetting=function(e){var t=this._scene.getModel(e);t&&t.restoreLayersDefaultSetting()},t.prototype.showAllLayers=function(e){var t=this._scene.getModel(e);t&&t.showAllLayers()},t.prototype.showLayers=function(e,t){var r=this._scene.getModel(e);r&&(t.forEach(function(e){return r.showLayer(e)}),this._scene.core.updateBBox(),this._camera.core._updateProjection(),this.invalidate())},t.prototype.getBimData=function(e){var t=this._scene.getModel(e);if(t)return t.getBimDataForDAM()},t.prototype.isBimModel=function(e){var t=this._scene.getModel(e);if(t)return t.hasBimInfo()},t.prototype.hideLayers=function(e,t){var r=this._scene.getModel(e);r&&(t.forEach(function(e){return r.hideLayer(e)}),this._scene.core.updateBBox(),this._camera.core._updateProjection(),this.invalidate())},t.prototype.getViewsData=function(e){return this._scene.getModel(e).getViewsData()},t.prototype.getDrawableIdsFromLayerIndices=function(e,t){var r=this._scene.getModel(e);if(r){var i=[];return t.forEach(function(e){i=i.concat(r.getDrawableIdsFromLayerIndex(e))}),i}},t.prototype.getOrientation=function(){return this.orientation},t.prototype.pauseTick=function(){this.state=i.TICK_PAUSED},t.prototype.restorTick=function(){this.state=i.RENDERING},t.prototype.setShadowContrast=function(e){this._renderScene.setShadowContrast(e),this.invalidate(16)},t.prototype.onSceneChanged=function(){this._renderScene.onSceneChanged(-1),this._recompileShadow(),this._recompileSpecular(),this._renderScene.optimize(),this._tools.forEach(function(e){e.onSceneChanged()})},t.prototype.exportMX3=function(e){var t=this.getScene().getModel(e);return new on(this._scene.core,this._resourceManager,this._materialManager).export(t)},t.prototype.exportMaterials=function(){return new on(this._scene.core,this._resourceManager,this._materialManager).exportMaterials()},t.prototype.setProgressiveRendering=function(e){void 0===e&&(e=16),this._nFramesTobeDrawnProgressively=Math.min(e,16)},t.prototype.disableBimCulling=function(){this._camera.core.setBimCullingEnabled(!1)},t.prototype._removeCameraEventListener=function(){this._camera.core.removeUpdateStopListener(this._onCameraUpdateStopped)},t.prototype._restoreCameraEventListener=function(){this._camera.core.addUpdateStopListener(this._onCameraUpdateStopped)},t.prototype.drawHD=function(e){void 0===e&&(e=16),e=Math.min(e,16);for(var t=1;t<=e;)this._drawFrameProgressively(t),t++;this._resourceManager.gl.isWebGL2&&this._renderer.present(this._renderScene.getRenderTarget().getFramebuffer())},t}(k),Pn=function(){function e(e){this.nodes=[],this.nodeBBoxes=null,this.root=null,this.elements={},this.elementsNum=0,this.model=e,this.guidElementMap={}}return e.prototype.destroy=function(){this.nodes=null,delete this.nodes,this.elements=null,delete this.elements,this.nodeBBoxes=null,delete this.nodeBBoxes,this.root=null,delete this.root,this.guidElementMap=null,delete this.guidElementMap},e.prototype.createNodes=function(e){this.nodes=new Array(e),this.nodeBBoxes=new Float32Array(6*e)},e.prototype.getNodeBBox=function(e,t){var r=6*e;t[0]=this.nodeBBoxes[r],t[1]=this.nodeBBoxes[r+1],t[2]=this.nodeBBoxes[r+2],t[3]=this.nodeBBoxes[r+3],t[4]=this.nodeBBoxes[r+4],t[5]=this.nodeBBoxes[r+5]},e.prototype.getElementPaths=function(e){var t=[];for(var r in e){var i=this.getElementPath(e[r]);i&&t.push(i)}return t},e.prototype.getElementPath=function(e){var t={elementId:0,docId:0,modelId:""};t.elementId=e.id;var r=e.getDocument();return r?(t.docId=r.id,t.modelId=this.model.name,t):(console.warn("element '"+t.elementId+"' doesn't belong to any doc"),null)},e.prototype.getElementPathString=function(e){var t=e.getDocument();return t?this.model.name+"+"+t.id+"/"+e.id:(console.warn("element '"+e.id+"' doesn't belong to any doc"),"")},e}(),Nn=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Dn=function(){function e(e,t,r,i){this._name="default",this._index=-1,this._level=0,this._visibility=!0,this._color=[1,1,1],this._nodeIndices=[],this._nodes=[],this._drawables=[],this._parent=null,this._children=[],this._name=e,this._index=null!==t&&void 0!==t?t:-1,this._visibility=null===r||void 0===r||r,this._color=null!==i&&void 0!==i?i:[1,1,1]}return e.prototype.addNodeIndex=function(e,t){this._nodeIndices.push(e),t.addLayerOfNode(e,this)},e.prototype.addNode=function(e){this._nodes.push(e)},e.prototype.getNodes=function(){return this._nodes},e.prototype.hasNode=function(){return this._nodeIndices.length>0},e.prototype.getName=function(){return this._name},e.prototype.getFullName=function(){return 1==this._level?this._name:this._parent.getFullName()+"_"+this._name},e.prototype.getIndex=function(){return this._index},e.prototype.setIndex=function(e){this._index=e},e.prototype.getColor=function(){return this._color},e.prototype.getNodeIndices=function(){return this._nodeIndices},e.prototype.getChildren=function(){return this._children},e.prototype.getVisibility=function(){return this._visibility},e.prototype.addDrawable=function(e){this._visibility?e.show():e.hide(),this._drawables.push(e)},e.prototype.show=function(){this._showSelf(),this._showChildren()},e.prototype.setTransparent=function(e){this._drawables.forEach(function(t){t.material.adjustTransparency(e)}),this.setChildrenTransparent(e)},e.prototype.setChildrenTransparent=function(e){this._children.forEach(function(t){t.setTransparent(e)})},e.prototype.hide=function(){this._hideChildren(),this._hideSelf()},e.prototype._showSelf=function(){this._visibility=!0},e.prototype._showChildren=function(){this._visibility&&(this._showDrawables(),this._children.forEach(function(e){return e._showChildren()}))},e.prototype._showDrawables=function(){this._drawables.forEach(function(e){return e.show()})},e.prototype._hideSelf=function(){this._visibility=!1},e.prototype._hideChildren=function(){this._visibility&&(this._hideDrawables(),this._children.forEach(function(e){return e._hideChildren()}))},e.prototype._hideDrawables=function(){this._drawables.forEach(function(e){return e.hide()})},e.prototype.dump=function(){console.groupCollapsed("Layer: "+this._name),console.log("index: "+this._index),console.log("level: "+this._level),console.log("nodes: ",this._nodeIndices),console.log("drawables: ",this._drawables),console.groupEnd()},e.prototype._addChild=function(e){e._level=this._level+1,e._parent=this,this._children.push(e)},e.prototype.parseFrom=function(t,r,i,n){var a,o,s,l,u,c;try{for(var h=Nn(t),d=h.next();!d.done;d=h.next()){var p=d.value,f=null!==(s=p.name)&&void 0!==s?s:"default",m=null!==(l=p.index)&&void 0!==l?l:-1,_=new e(f,m,null===(u=p.visible)||void 0===u||u,null!==(c=p.color)&&void 0!==c?c:[1,1,1]);-1===m&&(i.push(p),n.push(_)),this._addChild(_),r.addLayer(_),p.layers&&_.parseFrom(p.layers,r,i,n)}}catch(e){a={error:e}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}},e.prototype.restoreVisibilityFrom=function(e){var t,r,i,n=0;try{for(var a=Nn(e),o=a.next();!o.done;o=a.next()){var s=o.value,l=this._children[n++];l._visibility=null===(i=s.visible)||void 0===i||i,l._visibility?l._showDrawables():l._hideDrawables(),s.layers&&l.restoreVisibilityFrom(s.layers)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}},e.prototype.supplyIndexToLayerHasZeroNode=function(e,t){-1===this._index&&this._level>0&&(this._index=t[0]++,e.addLayer(this)),this._children.forEach(function(r){return r.supplyIndexToLayerHasZeroNode(e,t)})},e.prototype.getDrawableIds=function(){return this._drawables.map(function(e){return e.getId()})},e}(),In=function(){function e(e){this._jsonData=null,this._rootLayer=new Dn("root"),this._totalLayers=[],this._layerOfNode=null,this._nLayersHasNode=0,this._currentTransparency=1,this._layerOfNode=new Array(e)}return e.prototype.getLayerJsonData=function(){return this._jsonData},e.prototype.getLayer=function(e){return this._totalLayers[e]},e.prototype.addLayer=function(e){-1!==e.getIndex()&&(this._totalLayers[e.getIndex()]=e)},e.prototype.addLayerOfNode=function(e,t){this._layerOfNode[e]=t},e.prototype.getLayerOfNode=function(e){return this._layerOfNode[e]},e.prototype.parseFrom=function(e){if(null!==e){this._jsonData=e;var t=[],r=[];this._rootLayer.parseFrom(e,this,t,r),this._nLayersHasNode=this._totalLayers.length;for(var i=0,n=t.length;i<n;i++){var a=t[i];a.index=this._nLayersHasNode,a.visible=!0;var o=r[i];o.setIndex(this._nLayersHasNode),this.addLayer(o),this._nLayersHasNode++}}},e.prototype.dump=function(){this._totalLayers.forEach(function(e){return e.dump()})},e.prototype.restoreDefaultSetting=function(){this._rootLayer.restoreVisibilityFrom(this._jsonData)},e.prototype.showAll=function(){this._totalLayers.forEach(function(e){return e.show()})},e.prototype.showLayer=function(e){e>=this._totalLayers.length||this._totalLayers[e].show()},e.prototype.setLayerTransparent=function(e,t){var r=this;return!(e.length>this._totalLayers.length)&&(Math.abs(t-this._currentTransparency)>.01&&(e.forEach(function(e){r._totalLayers[e].setTransparent(t)}),this._currentTransparency=t,!0))},e.prototype.hideLayer=function(e){e>=this._totalLayers.length||this._totalLayers[e].hide()},e.prototype.getDrawableIds=function(e){return this._totalLayers[e]?this._totalLayers[e].getDrawableIds():(console.warn("layerIndex: "+e+" is not exist in totalLayers"),[])},e}(),On=function(){function e(e){this._viewDatas=null,this._viewDatas=[]}return e.prototype.parseFrom=function(e){this._viewDatas=e},e.prototype.getViewsData=function(){return this._viewDatas},e}(),Rn=function(){function e(){this._name=null,this._elements=null,this._families=null,this._levels=null,this._rooms=null,this._units=null,this._links=null,this.Document={},this.Element={}}return e.prototype.loadFrom=function(e){},e.prototype.dam2Build=function(e){},e}(),Cn=r(47),Bn=r(24),Ln=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},Fn=function(){function e(){this._room=null,this._unitInfo=null,this._levelInfo=null,this._bimTxt=null,this._familyPropData=null,this._typeKeys=null,this._reference=null,this._elementsInfo=null}return e.prototype.loadFrom=function(e){this._bimTxt=e.filter(function(e){return"bim.txt"===e.filename})[0].data,this._familyPropData=e.filter(function(e){return"categoryCommonKeys.json"===e.filename})[0].data,this._reference=e.filter(function(e){return"reference.csv"===e.filename})[0].data,this._elementsInfo=e.filter(function(e){return"elementsInfo.csv"===e.filename})[0].data,this._levelInfo=e.filter(function(e){return"level.json"===e.filename})[0].data,this._unitInfo=e.filter(function(e){return"unit.json"===e.filename})[0].data},e.prototype.build2DAM=function(e,t){var r=this,i=this.loadProperties(this._elementsInfo),n={};this._reference.split("\n").splice(1).forEach(function(e){var t=Ln(e.split(","),3),r=t[0],i=t[1],a=t[2];i&&a&&(n[i+"-"+a.trim()]=r)});var a,o,s,l,u,c,h,d,p,f,m,_,v,y,g={};this._bimTxt.split("\n").forEach(function(b){var w=0;if(0==b.length)return!0;for(;" "===b.charAt(0)&&b.length>0;)w++,b=b.substr(1);b=b.trim();var x=Cn.a[w];if(x.type===Bn.a.File){a=b.slice(0,b.lastIndexOf("(")),h=b.substring(b.lastIndexOf("(")+1,b.length-1);var M=r._unitInfo[h];void 0==M&&(M=r._unitInfo[a]),_={name:a,roomes:{},families:{},levelElements:{},units:M},t.Document[a]=_,v={},t.Element[a]=v,g[a]={}}else if(x.type===Bn.a.Level)o=b,p=r._levelInfo[h][o],m={height:p,elements:{}},_.levelElements[o]=m,y={},v[o]=y;else if(x.type===Bn.a.Category)s=b.trim(),g[a][s]||(g[a][s]={});else if(x.type===Bn.a.Family)l=b,g[a][s][l]?f=g[a][s][l]:(f=g[a][s][l]={name:l,bim:"",elements:[]},_.families[l]=f);else if(x.type===Bn.a.Type)u=b;else if(x.type===Bn.a.Element){c=b;var T=n[h+"-"+s],E=i[T][c],S=JSON.stringify(E);d={P:S,C:s,F:l,T:u,N:[]};var A=e+"+"+h+"/"+b;y[A]=d,f.elements.push(d),m.elements[A]=d}})},e.prototype.loadFamilyProperty=function(e,t,r){var i=Object.values(r[t])[0],n="{";return e.forEach(function(t,r){var a=t.split("@")[0],o=i[a];r==e.length-1?n+='"'+a+'":"'+o+'"}':n+='"'+a+'":"'+o+'",'}),n},e.prototype.loadProperties=function(e){var t={};return e.split("\n").splice(1).forEach(function(e){var r=Ln(e.split(","),5),i=r[0],n=r[1],a=r[2],o=r[3],s=r[4];if(!i||!n)return!0;var l=n;'"'===l[0]&&(l=l.substring(1,l.length-1));var u=a.split("@")[0];if('"'===u[0]&&(u=u.slice(1)),"GUID"==u)return!0;var c,h=o?Number(o):function(e){return'"'==e[0]&&'"'==e[e.length-1]?e.slice(1,e.length-1):e}(s),d=t[i];d?(c=d[l])?c[u]=h:(d[l]={})[u]=h:(t[i]={},(c=t[i][l]={})[u]=h)}),t},e}(),Vn=function(){function e(){this._bimInfoDAM=new Rn,this._bimInfoBuild=new Fn}return e.prototype.loadFromDAM=function(e){this._bimInfoDAM.loadFrom(e),this._bimInfoDAM.dam2Build(this._bimInfoBuild)},e.prototype.loadFromBuild=function(e,t){this._bimInfoBuild.loadFrom(t),this._bimInfoBuild.build2DAM(e,this._bimInfoDAM)},e.prototype.getDataForDAM=function(){return{elements:this._bimInfoDAM.Element,documents:this._bimInfoDAM.Document}},e.prototype.getDataForBuild=function(){return this._bimInfoBuild},e}(),Un=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),zn=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},jn=function(e){function t(t,r,i,n,a,o){void 0===a&&(a=!1);var s=e.call(this,t,i,n)||this;s.isMatrixIdentity=!0,s.usePbr=!1,s.hasProfileLines=!1,s.hasCurveOrLine=!1,s._layers=null,s._views=null,s._bimInfo=null,s.tree=new Pn(s),s.source="",s._matrix=r;for(var l=0;l<s._matrix.length;l++)if(0===l||5===l||10===l||15===l){if(Math.abs(s._matrix[l]-1)>1e-6){s.isMatrixIdentity=!1;break}}else if(Math.abs(s._matrix[l])>1e-6){s.isMatrixIdentity=!1;break}return s.usePbr=a,s.local=o,s}return Un(t,e),t.prototype.destroy=function(){this.tree.destroy(),this.tree=null,delete this.tree,this.source=null,delete this.source,e.prototype.destroy.call(this)},t.prototype.initLayers=function(e){this._layers=new In(e)},t.prototype.initViews=function(e){this._views=new On(e)},t.prototype.initTree=function(e){this.tree.createNodes(e)},t.prototype.setLayerJsonData=function(e){this._layers.parseFrom(e)},t.prototype.bindLayerNode=function(e,t){this._layers.getLayer(e).addNodeIndex(t,this._layers)},t.prototype.setViewsData=function(e){this._views.parseFrom(e)},t.prototype.setBimInfoData=function(e){null===this._bimInfo&&(this._bimInfo=new Vn),this._bimInfo.loadFromBuild(this.name,e)},t.prototype.getLayerJsonData=function(){return this._layers.getLayerJsonData()},t.prototype.restoreLayersDefaultSetting=function(){this._layers.restoreDefaultSetting(),this.updateBBox()},t.prototype.showAllLayers=function(){this._layers.showAll(),this.updateBBox()},t.prototype.showLayer=function(e){this._layers.showLayer(e),this.updateBBox()},t.prototype.setLayerTransparent=function(e,t){return this._layers.setLayerTransparent(e,t)},t.prototype.hideLayer=function(e){this._layers.hideLayer(e),this.updateBBox()},t.prototype.getLayerOfNode=function(e){return this._layers.getLayerOfNode(e)},t.prototype.addDrawableToLayerByNodeIndex=function(e,t){var r=this._layers.getLayerOfNode(e);r&&r.addDrawable(t)},t.prototype.getBimDataForDAM=function(){var e;return null===(e=this._bimInfo)||void 0===e?void 0:e.getDataForDAM()},t.prototype.hasBimInfo=function(){return!!this._bimInfo},t.prototype.getDrawableIdsFromLayerIndex=function(e){return this._layers.getDrawableIds(e)},t.prototype.dump=function(){this._layers.dump()},t.prototype.getViewsData=function(){return this._views?this._views.getViewsData():[]},t.prototype.setDefaultView=function(e){this.defaultView=e},t.prototype.getDrawablesWithoutLine=function(){var e,t,r=[];try{for(var i=zn(this.drawables),n=i.next();!n.done;n=i.next()){var a=n.value;a.mesh.isLine()||r.push(a)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},t}(q),Gn=r(23),qn=new Float32Array(6),Qn=function(){function e(e){this._model=e}return e.prototype.destroy=function(){this._model=null,delete this._model},e.prototype.load=function(e,t){var r=this;return e["uuid.bin"]?(e["modelgraph.bin"].onProgress(function(e){}),e["modelgraph.bin"].downloadFile().then(function(t){var i=t.data;return e["uuid.bin"].onProgress(function(e){}),e["uuid.bin"].downloadFile().then(function(e){r._parse(i,e.data)})})):(e["modelgraph.bin"].onProgress(function(e){}),e["modelgraph.bin"].downloadFile().then(function(e){r._parse(e.data,null)}))},e.prototype._parse=function(e,t){var r=this._model.tree,i=new rt.b(rt.a.ROOT,-1,this._model,this._model.name);r.root=i;var n,a,o,s=e.byteLength,l=0,u=[];u.push(i);for(var c=0;l<e.byteLength;){var h=new Uint8Array(e,l,9);for(n=h[3]<<24|h[2]<<16|h[1]<<8|h[0],a=h[7]<<24|h[6]<<16|h[5]<<8|h[4],o=h[8];u.length>0&&u[u.length-1].id!==a;)u.pop();if(0===u.length)return void console.warn("father of "+n+" is wrong");var d=u[u.length-1];if(o===rt.a.NODE){var p=r.nodes[n];p.father=d,d.children.push(p)}else{o===rt.a.LINK&&(c=n);var f=this._model.name+"+"+c+"/"+n,m=new rt.b(o,n,this._model,f);if(o!==rt.a.ELEMENT&&o!==rt.a.ROOM&&o!==rt.a.AREA||(r.elements[f]=m,r.elementsNum++),t&&o===rt.a.ELEMENT){var _=new Uint8Array(t,l/9*16,16);m.guid+=_[3]<16?"0"+_[3].toString(16):_[3].toString(16),m.guid+=_[2]<16?"0"+_[2].toString(16):_[2].toString(16),m.guid+=_[1]<16?"0"+_[1].toString(16):_[1].toString(16),m.guid+=_[0]<16?"0"+_[0].toString(16):_[0].toString(16),m.guid+="-",m.guid+=_[5]<16?"0"+_[5].toString(16):_[5].toString(16),m.guid+=_[4]<16?"0"+_[4].toString(16):_[4].toString(16),m.guid+="-",m.guid+=_[7]<16?"0"+_[7].toString(16):_[7].toString(16),m.guid+=_[6]<16?"0"+_[6].toString(16):_[6].toString(16),m.guid+="-",m.guid+=_[8]<16?"0"+_[8].toString(16):_[8].toString(16),m.guid+=_[9]<16?"0"+_[9].toString(16):_[9].toString(16),m.guid+="-",m.guid+=_[10]<16?"0"+_[10].toString(16):_[10].toString(16),m.guid+=_[11]<16?"0"+_[11].toString(16):_[11].toString(16),m.guid+=_[12]<16?"0"+_[12].toString(16):_[12].toString(16),m.guid+=_[13]<16?"0"+_[13].toString(16):_[13].toString(16),m.guid+=_[14]<16?"0"+_[14].toString(16):_[14].toString(16),m.guid+=_[15]<16?"0"+_[15].toString(16):_[15].toString(16),r.guidElementMap[m.guid]=f}m.father=d,d.children.push(m),u.push(m)}l+=9}var v=0;for(s=i.children.length;v<s;v++)this._computeBBox(i.children[v])},e.prototype._printTree=function(e,t){for(var r="",i=0;i<e;i++)r+=" ";if(t.hasOwnProperty("id"))r+="n id="+t.id,console.log(r);else{r+=["root","i","g","e","n","l"][t.type]+" name="+t.name,console.log(r);i=0;for(var n=t.children.length;i<n;i++)this._printTree(e+1,t.children[i])}},e.prototype._computeBBox=function(e){for(var t=0,r=e.children.length;t<r;t++){var i=e.children[t],n=void 0;i.hasOwnProperty("region")?(this._model.tree.getNodeBBox(i.id,qn),n=qn):(this._computeBBox(i),n=i.bbox),P.a.aabb.union(e.bbox,e.bbox,n)}},e}();!function(e){e[e.STRUCTURE=0]="STRUCTURE",e[e.STRUCTURE_INTERIOR=4]="STRUCTURE_INTERIOR",e[e.INTERIOR=8]="INTERIOR",e[e.MEP=12]="MEP",e[e.LANDSCAPE=15]="LANDSCAPE"}(dn||(dn={}));var Hn=function(){function e(e){this._visible=!0,this._layer=null,this.id=e,this.region=dn.STRUCTURE,this.father=null,this.indicesOffset=0,this.indicesCount=0,this.verticesCount=0,this.drawable=null,this.clonedDrawable=null,this._platteIndex=127,this._visible=!0}return e.prototype.getInstance=function(){for(var e=this.father;e.etype!==rt.a.INSTANCE&&null!==(e=e.father););return e},e.prototype.getGroup=function(){for(var e=this.father;e.etype!==rt.a.GROUP&&null!==(e=e.father););return e},e.prototype.getElement=function(){for(var e=this.father;e.etype!==rt.a.ELEMENT&&e.etype!==rt.a.ROOM&&e.etype!==rt.a.AREA&&null!==(e=e.father););return e},e.prototype.getComponent=function(){for(var e=this.father;e.etype!==rt.a.GROUP&&e.etype!==rt.a.INSTANCE&&null!==(e=e.father););return e},e.prototype.usePlatte=function(){return 127!=(127&this._platteIndex)},e.prototype.revertColor=function(){this.setColorIndex(127)},e.prototype.setColorIndex=function(e){this._platteIndex&=128,this._platteIndex|=e},e.prototype.show=function(){this._visible&&(this._platteIndex&=127)},e.prototype.hide=function(){this._platteIndex|=128},e.prototype.setVisibility=function(e){this._visible=e,e?this.show():this.hide()},e.prototype.getVisibility=function(){return this._visible},e.prototype.isVisible=function(){return 0==(128&this._platteIndex)},e.prototype.getPlatteIndex=function(){return this._platteIndex},e.prototype.isMerged=function(){return this.drawable.isMerged()},e.prototype.isSingleton=function(){return this.drawable.isSingleton()},e.prototype.getLayer=function(){return this._layer},e.prototype.setLayer=function(e){this._layer=e},e.prototype.getAllNodesWithinSameLayer=function(){return this._layer?this._layer.getNodes():null},e}(),Wn=function(){function e(e,t,r,i,n,a){this._tempVector31=new Float32Array(3),this._tempVector32=new Float32Array(3),this._resourceManager=e,this._sceneJson=t,this._modelBin=r,this._modelJson=i,this._attributesData=n,this._maxVertexNumber=s.a.isMobile?65536:1e9,this._meshes=0,this._nodesInfo=null,this._buffersNodes=[],this._verticesBinary=new Map,this._indicesBinary=new Map,this._model=a,this._initialize()}return e.prototype.destroy=function(){this._attributesData=null,delete this._attributesData,this._sceneJson=null,delete this._sceneJson,this._modelBin=null,delete this._modelBin,this._nodesInfo=null,delete this._nodesInfo,this._buffersNodes=null,delete this._buffersNodes,this._verticesBinary=null,delete this._verticesBinary,this._indicesBinary=null,delete this._indicesBinary,this._model=null,delete this._model},e.prototype._initialize=function(){if(null===this._nodesInfo){for(var e=this._modelJson["model.bin"].nodes,t=this._modelJson.buffers.length,r=0,i=0;i<t;i++)r+=this._modelJson.buffers[i].byteLength,this._meshes+=this._modelJson.buffers[i].meshes;if(r>1024*s.a.gpuMemory*1024)throw new Error("No enough GPU memory to load this model: "+r);this._buffersNodes=new Array(t);for(i=0;i<t;i++)this._buffersNodes[i]=[];this._nodesInfo=new Int32Array(9*e);for(i=0;i<e;i++){var n=new Int32Array(this._nodesInfo.buffer,9*i*4,9),a=this._modelBin.readNodeData(i),o=this._modelBin.readMesh(a[1]);n[0]=i,n[1]=a[1],n[2]=65535&a[0],n[2]|=2147483648,n[2]|=a[2]>>30&1?1073741824:0,n[2]|=(a[2]>>25&15)<<24,n[2]|=a[2]>>31&1?8388608:0,n[3]=-1,n[4]=o[2],n[5]=o[4],n[8]=65535&o[0];var l=o[0]>>16;this._buffersNodes[l].push(i);var u=a[0]>>16;this._model.bindLayerNode(u,i)}i=0;for(var c=t;i<c;i++)this._groupNodesByMaterial(this._buffersNodes[i]);if(this._createMerges(new Uint32Array(t),1024*s.a.gpuMemory*1024),!s.a.isMobile)for(i=0,c=this._buffersNodes.length;i<c;++i){for(var h,d,p=0,f=0,m=this._buffersNodes[i],_=0,v=0,y=m.length;v<y;v++){if(2147483648&(n=new Int32Array(this._nodesInfo.buffer,4*m[v]*9,9))[2])if(n[3]>=0){var g=this._attributesData[n[8]>>8&255];_=(_+=n[4]+n[5]-n[7]+n[4]/g.values[0].stride)+3&-4}else _=(_+=n[7])+3&-4}h=_+this._modelJson.buffers[i].byteLength,d=_+this._modelJson.buffers[i].byteLength,p<h&&(p=h),f<d&&(f=d),this._verticesBinary.set(i,new ArrayBuffer(p)),this._indicesBinary.set(i,new ArrayBuffer(f))}}},e.prototype._groupNodesByMaterial=function(e){if(!(e.length<=1)){var t=this;e.sort(function(e,r){var i=9*e,n=9*r,a=8388608&t._nodesInfo[i+2],o=8388608&t._nodesInfo[n+2];if(a!==o)return a-o;var s=65535&t._nodesInfo[i+2],l=65535&t._nodesInfo[n+2];if(s!==l)return s-l;var u=t._model.getLayerOfNode(e),c=t._model.getLayerOfNode(r);if(u&&c){var h=u.getIndex(),d=c.getIndex();if(h!==d)return h-d}return(t._nodesInfo[i+8]>>8&255)-(t._nodesInfo[n+8]>>8&255)});var r=9*e[0],i=65535&this._nodesInfo[r+2],n=this._nodesInfo[r+8]>>8&255,a=0,o=this._model.getLayerOfNode(e[0]);a=o?o.getIndex():0;for(var s=[e[0]],l=1,u=e.length;l<u;++l){r=9*e[l];var c=65535&this._nodesInfo[r+2],h=8388608&this._nodesInfo[r+2],d=this._nodesInfo[r+8]>>8&255,p=255&this._nodesInfo[r+8],f=this._model.getLayerOfNode(e[l]),m=0;f&&(m=f.getIndex()),h||p>2||c!==i||d!==n||m!==a?(this._splitNodesGroup(s),s=[e[l]],i=c,n=d,a=m):s.push(e[l])}this._splitNodesGroup(s)}},e.prototype._splitNodesGroup=function(e){if(e.length>1){var t=e[0],r=t,i=t,n=9*t;this._nodesInfo[n+2]|=2147483648;for(var a=this._nodesInfo[n+4],o=this._nodesInfo[n+8]>>8&255,s=this._attributesData[o].values[0].stride*this._maxVertexNumber,l=1,u=e.length;l<u;++l){t=e[l];var c=this._nodesInfo[9*t+4];a+c>s?(this._nodesInfo[9*t+2]|=2147483648,i=t,a=c):(this._nodesInfo[9*t+2]&=2147483647,this._nodesInfo[9*r+3]=t,this._nodesInfo[9*i+6]++,a+=c),r=t}}},e.prototype._computeMergeInfo=function(e,t){var r=9*e,i=this._nodesInfo[r+8]>>8&255,n=255&this._nodesInfo[r+8],a=this._attributesData[i].values[0].stride,o=0,s=this._nodesInfo[r+4],l=this._nodesInfo[r+5],u=this._nodesInfo[r+1];t[u]||(t[u]=1,o+=s+l);for(var c=s,h=l/n,d=this._nodesInfo[r+3];d>=0;)r=9*d,s=this._nodesInfo[r+4],l=this._nodesInfo[r+5],n=255&this._nodesInfo[r+8],t[u=this._nodesInfo[r+1]]||(t[u]=1,o+=s+l),c+=s,h+=l/n,d=this._nodesInfo[r+3];var p=c/a;n=1,p>65536?n=4:p>256&&(n=2),r=9*e,this._nodesInfo[r+4]=c,this._nodesInfo[r+5]=h*n,this._nodesInfo[r+7]=o,this._nodesInfo[r+8]=4294967040&this._nodesInfo[r+8]|n},e.prototype._deleteMergeInfo=function(e,t){var r=e,i=new Int32Array(this._nodesInfo.buffer,9*r*4,9),n=9*r,a=this._modelBin.readMesh(i[1]);for(this._nodesInfo[n+4]=a[2],this._nodesInfo[n+5]=a[4],this._nodesInfo[n+6]=0,this._nodesInfo[n+8]=a[0];r>=0;){n=9*r;var o=this._nodesInfo[n+3];this._nodesInfo[n+2]|=2147483648,this._nodesInfo[n+3]=-1,r=o}},e.prototype._createMerges=function(e,t){for(var r=[],i=0,n=1073741824,a=new Uint8Array(this._meshes),o=new Uint8Array(this._meshes),s=0,l=this._buffersNodes.length;s<l;s++)for(var u=this._buffersNodes[s],c=e[s],h=u.length;c<h;++c){var d=u[c],p=9*d;if(2147483648&this._nodesInfo[p+2]){if(this._nodesInfo[p+3]>=0){this._computeMergeInfo(d,a);var f=this._nodesInfo[p+4]+this._nodesInfo[p+5]-this._nodesInfo[p+7],m=this._nodesInfo[p+4]+this._nodesInfo[p+5];f<13e4?t-=m:(n>f&&(n=f),t-=this._nodesInfo[p+7],r.push(d),i+=f)}else{var _=this._nodesInfo[p+1];o[_]||(a[_]?this._nodesInfo[p+7]=this._nodesInfo[p+4]+this._nodesInfo[p+5]:a[_]=1,t-=this._nodesInfo[p+4]+this._nodesInfo[p+5],o[_]=1)}if(t<0)throw console.log("No enough GPU memory to load this model."),new Error("No enough GPU memory to load this model.")}}if(t<i){var v=r.length,y=Math.ceil(t/n),g=new Uint32Array((v+1)*(y+1));for(s=1;s<=v;s++){var b=Math.floor((this._nodesInfo[9*r[s-1]+4]+this._nodesInfo[9*r[s-1]+5]-this._nodesInfo[9*r[s-1]+7])/n),w=this._nodesInfo[9*r[s-1]+6];for(c=1;c<=y;c++){var x=s*(y+1)+c,M=(s-1)*(y+1)+c;if(c<b)g[x]=g[M];else{var T=(s-1)*(y+1)+c-b;g[M]>g[T]+w?g[x]=g[M]:g[x]=g[T]+w}}}for(var E=new Uint8Array(r.length),S=v,A=y;S>0;){b=Math.floor((this._nodesInfo[9*r[S-1]+4]+this._nodesInfo[9*r[S-1]+5]-this._nodesInfo[9*r[S-1]+7])/n),w=this._nodesInfo[9*r[S-1]+6];g[S*(y+1)+A]===g[(S-1)*(y+1)+A]?S--:A-b>=0&&g[S*(y+1)+A]===g[(S-1)*(y+1)+A-b]+w&&(E[S-1]=1,S--,A-=b)}var k=new Uint8Array(this._meshes);for(s=0,l=E.length;s<l;s++)E[s]||this._deleteMergeInfo(r[s],k)}},e.prototype.load=function(e,t,r){var i=this._buffersNodes[e],n=null,a=null,o=null,l=null;s.a.isMobile||(o=this._verticesBinary.get(e),l=this._indicesBinary.get(e),n=this._resourceManager.getBuffer(this._model.name+"-vmesh"+e+".bin"),a=this._resourceManager.getBuffer(this._model.name+"-imesh"+e+".bin"),n.create(X.a.ARRAY_BUFFER,new Uint8Array(1)),a.create(X.a.ELEMENT_ARRAY_BUFFER,new Uint8Array(1)));for(var u=0,c=0,h=0,d=i.length;h<d;++h){var p=i[h],f=new Int32Array(this._nodesInfo.buffer,4*p*9,9);if(2147483648&f[2])if(f[3]<0){var m=this._modelBin.readMesh(f[1]);if(this._resourceManager.hasMesh(f[1]>=0?this._model.name+"/"+f[1].toString():this._model.name+"/"+-f[0].toString()))r(f,null,null,this._nodesInfo,n,a);else{var _=this._attributesData[f[8]>>8&255],v=(m[0],m[2]/4),y=m[2]/_.values[0].stride;tr.a.compressNormals&&_.hasNormal&&(v-=m[2]/_.values[0].stride);var g=s.a.isMobile?new Float32Array(v):new Float32Array(o,u,v),b=s.a.isMobile?new Uint8Array(m[4]):new Uint8Array(l,c,m[4]),w=new Float32Array(t,m[1],m[2]/4);this.UncompressVertices(g,w,_,tr.a.compressNormals);var x=new Uint8Array(t,m[3],m[4]);this.UncompressIndices(b,x,m[4],0),f[4]=y,f[7]=m[4]/(255&m[0]),u=(u+=4*v)+3&-4,c=(c+=m[4])+3&-4,r(f,g,b,this._nodesInfo,n,a)}}else{g=null,b=null;if(s.a.isMobile){var M=this._populateMergedNodeloneLy(f,t);r(f,M.verticesBinary,M.indicesBinary,this._nodesInfo)}else{var T={verticesBinary:o,indicesBinary:l,verticesOffset:u,indicesOffset:c},E=u,S=c;f=this._populateMergedNode(f,t,T);var A=(u=T.verticesOffset)-E,k=(c=T.indicesOffset)-S;u=u+3&-4,c=c+3&-4,r(f,g=new Uint8Array(o,E,A),b=new Uint8Array(l,S,k),this._nodesInfo,n,a)}}}if(!s.a.isMobile){var P=new Uint8Array(o,0,u),N=new Uint8Array(l,0,c);this._resourceManager.addSourceBuffers(e,P.slice(0),N.slice(0)),n.update(P,0,e,0),a.update(N,0,e,1),this._verticesBinary.delete(e),this._indicesBinary.delete(e)}},e.prototype.IsTranslationMatrix=function(e){return Math.abs(e[0]-1)<1e-6&&Math.abs(e[1])<1e-6&&Math.abs(e[2])<1e-6&&Math.abs(e[3])<1e-6&&Math.abs(e[4]-1)<1e-6&&Math.abs(e[5])<1e-6&&Math.abs(e[6])<1e-6&&Math.abs(e[7])<1e-6&&Math.abs(e[8]-1)<1e-6},e.prototype.IsTranslationScalingMatrix=function(e){return Math.abs(e[1])<1e-6&&Math.abs(e[2])<1e-6&&Math.abs(e[3])<1e-6&&Math.abs(e[5])<1e-6&&Math.abs(e[6])<1e-6&&Math.abs(e[7])<1e-6},e.prototype.UnionBBox=function(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])},e.prototype.TransformUncompressVertices1=function(e,t,r,i,n){var a,o=t.byteLength/r.values[0].stride|0,s=(0|r.values[0].stride)>>2|0,l=(0|s)*(0|o)|0;if(4===r.primitive)if(n){var u=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),c=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);for(a=0;a<o;a++){var h=a*s;e[d=a*(s-1)]=t[h]+i[0],e[d+1]=t[h+1]+i[1],e[d+2]=t[h+2]+i[2],h<<=2,u[d<<=2]=c[h+12],u[d+4]=c[h+13],u[d+8]=c[h+14]}if(r.values.length>2)if(4===r.values[2].index)for(a=0;a<o;a++){h=6*a+4;e[d=5*a+3]=t[h],e[d+1]=t[h+1]}else for(a=0;a<o;a++){var d;h=5*a+4;e[d=4*a+3]=t[h]}}else{for(a=0;a<l;a+=s)e[a]=t[a]+i[0],e[a+1]=t[a+1]+i[1],e[a+2]=t[a+2]+i[2],e[a+3]=t[a+3];if(r.values.length>2)if(4===r.values[2].index)for(a=4;a<l;a+=s)e[a]=t[a],e[a+1]=t[a+1];else for(a=4;a<l;a+=s)e[a]=t[a]}else for(a=0;a<l;a+=3)e[a]=t[a]+i[0],e[a+1]=t[a+1]+i[1],e[a+2]=t[a+2]+i[2]},e.prototype.TransformUncompressVertices2=function(e,t,r,i,n,a){var o=t.byteLength/r.values[0].stride|0,s=(0|r.values[0].stride)>>2|0,l=(0|s)*(0|o)|0,u=0,c=0;if(4===r.primitive){var h=new Int8Array(e.buffer,e.byteOffset,e.byteLength),d=new Int8Array(t.buffer,t.byteOffset,t.byteLength);if(i[0]===i[1]&&i[1]===i[2])if(a)for(u=0;u<o;u++){var p=u*s;e[b=u*(s-1)]=t[p]*i[0]+n[0],e[b+1]=t[p+1]*i[1]+n[1],e[b+2]=t[p+2]*i[2]+n[2],p<<=2,h[b<<=2]=d[p+12],h[b+4]=d[p+13],h[b+8]=d[p+14]}else for(u=0;u<l;u+=s)e[u]=t[u]*i[0]+n[0],e[u+1]=t[u+1]*i[1]+n[1],e[u+2]=t[u+2]*i[2]+n[2],e[u+3]=t[u+3];else{var f=this._tempVector31,m=this._tempVector32;if(m[0]=1/i[0],m[1]=1/i[1],m[2]=1/i[2],a)for(u=0;u<o;u++){p=u*s;e[b=u*(s-1)]=t[p]*i[0]+n[0],e[b+1]=t[p+1]*i[1]+n[1],e[b+2]=t[p+2]*i[2]+n[2],b<<=2;var _=d[(p<<=2)+12],v=d[p+13],y=d[p+14];f[0]=_*m[0],f[1]=v*m[1],f[2]=y*m[2];var g=127/Math.sqrt(f[0]*f[0]+f[1]*f[1]+f[2]*f[2]);c=u<<2,h[b]=f[0]*g,h[b+4]=f[1]*g,h[b+8]=f[2]*g}else for(u=0;u<l;u+=s){e[u]=t[u]*i[0]+n[0],e[u+1]=t[u+1]*i[1]+n[1],e[u+2]=t[u+2]*i[2]+n[2];_=d[c=12+(u<<2)],v=d[c+1],y=d[c+2];f[0]=_*m[0],f[1]=v*m[1],f[2]=y*m[2];g=127/Math.sqrt(f[0]*f[0]+f[1]*f[1]+f[2]*f[2]);h[c]=f[0]*g,h[c+1]=f[1]*g,h[c+2]=f[2]*g}}if(r.values.length>2)if(a)if(4===r.values[2].index)for(u=0;u<o;u++){p=6*u+4;e[b=5*u+3]=t[p],e[b+1]=t[p+1]}else for(u=0;u<o;u++){var b;p=5*u+4;e[b=4*u+3]=t[p]}else if(4===r.values[2].index)for(u=4;u<l;u+=s)e[u]=t[u],e[u+1]=t[u+1];else for(u=4;u<l;u+=s)e[u]=t[u]}else for(u=0;u<l;u+=3)e[u]=t[u]*i[0]+n[0],e[u+1]=t[u+1]*i[1]+n[1],e[u+2]=t[u+2]*i[2]+n[2]},e.prototype.TransformUncompressVertices3=function(e,t,r,i,n){var a=t.byteLength/r.values[0].stride|0,o=(0|r.values[0].stride)>>2|0,s=(0|o)*(0|a)|0,l=i[0],u=i[1],c=i[2],h=i[3],d=i[4],p=i[5],f=i[6],m=i[7],_=i[8],v=i[9],y=i[10],g=i[11],b=0;if(4===r.primitive){var w=this._tempVector31,x=new Int8Array(t.buffer,t.byteOffset,4*s),M=new Int8Array(e.buffer,e.byteOffset,e.byteLength);if(n){for(b=0;b<a;b++){var T=b*(o-1),E=l*(R=t[I=b*o])+h*(C=t[I+1])+f*(B=t[I+2])+v,S=u*R+d*C+m*B+y,A=c*R+p*C+_*B+g;e[T]=E,e[T+1]=S,e[T+2]=A,T<<=2;var k=x[(I<<=2)+12],P=x[I+13],N=x[I+14];w[0]=l*k+h*P+f*N,w[1]=u*k+d*P+m*N,w[2]=c*k+p*P+_*N;var D=127/Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]);M[T]=w[0]*D,M[T+4]=w[1]*D,M[T+8]=w[2]*D}if(r.values.length>2)if(4===r.values[2].index)for(b=0;b<a;b++){var I=6*b+4;e[T=5*b+3]=t[I],e[T+1]=t[I+1]}else for(b=0;b<a;b++){I=5*b+4;e[T=4*b+3]=t[I]}}else{for(b=0;b<s;b+=o){E=l*(R=t[b])+h*(C=t[b+1])+f*(B=t[b+2])+v,S=u*R+d*C+m*B+y,A=c*R+p*C+_*B+g;e[b]=E,e[b+1]=S,e[b+2]=A;var O=12+(b<<2);k=x[O],P=x[O+1],N=x[O+2];w[0]=l*k+h*P+f*N,w[1]=u*k+d*P+m*N,w[2]=c*k+p*P+_*N;D=127/Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]);M[O]=w[0]*D,M[O+1]=w[1]*D,M[O+2]=w[2]*D}if(r.values.length>2)if(4===r.values[2].index)for(b=4;b<s;b+=o)e[b]=t[b],e[b+1]=t[b+1];else for(b=4;b<s;b+=o)e[b]=t[b]}}else for(b=0;b<s;b+=3){var R,C,B;E=l*(R=t[b])+h*(C=t[b+1])+f*(B=t[b+2])+v,S=u*R+d*C+m*B+y,A=c*R+p*C+_*B+g;e[b]=E,e[b+1]=S,e[b+2]=A}},e.prototype.UncompressIndices=function(e,t,r,i){for(var n=0;n<r;n++)e[n]=t[n]+(0|i)},e.prototype.UncompressVertices=function(e,t,r,i){var n=t.byteLength/r.values[0].stride|0,a=(0|r.values[0].stride)>>2|0,o=(0|a)*(0|n)|0;if(4===r.primitive&&i){for(var s=new Int8Array(t.buffer,t.byteOffset,t.byteLength),l=new Int8Array(e.buffer,e.byteOffset,e.byteLength),u=0,c=0;c<o;c+=a,u+=a-1){e[u]=t[c],e[u+1]=t[c+1],e[u+2]=t[c+2];var h=u<<2,d=c<<2;l[h]=s[d+12],l[h+4]=s[d+13],l[h+8]=s[d+14]}if(r.values.length>2)if(4===r.values[2].index)for(u=3,c=4;c<o;u+=5,c+=6)e[u]=t[c],e[u+1]=t[c+1];else for(u=3,c=4;c<o;u+=4,c+=5)e[u]=t[c]}else e.set(t,0,o)},e.prototype._populateMergedNodeloneLy=function(e,t){for(var r=this._attributesData[e[8]>>8&255],i=e[8],n=this._modelBin.readNodeBBox(e[0]),a=255&e[8],o=[],s=e[0];s>=0;)o.push(s),s=this._nodesInfo[9*s+3];var l=this;o.sort(function(e,t){return(l._nodesInfo[9*e+2]>>24&15)-(l._nodesInfo[9*t+2]>>24&15)});for(var u=new Float32Array([0,0,0]),c=new Float32Array([0,0,0]),h=0,d=0,p=0,f=0,m=o.length;f<m;f++){var _=new Int32Array(this._nodesInfo.buffer,36*o[f],9),v=(P=this._modelBin.readMesh(_[1]))[2]/4;p+=P[2]/r.values[0].stride,tr.a.compressNormals&&r.hasNormal&&(v-=P[2]/r.values[0].stride),h+=v;var y=0;switch(255&P[0]){case 4:y=P[4]/4;break;case 2:y=P[4]/2;break;default:y=P[4]}d+=y}var g=new Float32Array(h+p),b=null;switch(a){case 4:b=new Uint32Array(d);break;case 2:b=new Uint16Array(d);break;default:b=new Uint8Array(d)}for(var w={verticesBinary:g,indicesBinary:b},x=0,M=0,T=0,E=0,S=o.length;E<S;E++){_=new Int32Array(this._nodesInfo.buffer,36*o[E],9);var A=this._modelBin.readNodeTransform(_[0]),k=this._modelBin.readNodeBBox(_[0]),P=this._modelBin.readMesh(_[1]),N=new Float32Array(t,P[1],P[2]/4);v=P[2]/4;tr.a.compressNormals&&r.hasNormal&&(v-=P[2]/r.values[0].stride);var D=new Float32Array(g.buffer,x,v);0==(1073741824&_[2])?this.IsTranslationMatrix(A)?(u[0]=A[9],u[1]=A[10],u[2]=A[11],this.TransformUncompressVertices1(D,N,r,u,tr.a.compressNormals)):this.IsTranslationScalingMatrix(A)?(u[0]=A[9],u[1]=A[10],u[2]=A[11],c[0]=A[0],c[1]=A[4],c[2]=A[8],this.TransformUncompressVertices2(D,N,r,c,u,tr.a.compressNormals)):this.TransformUncompressVertices3(D,N,r,A,tr.a.compressNormals):this.UncompressVertices(D,N,r,tr.a.compressNormals),x+=4*v,this.UnionBBox(n,k);var I=null,O=null;y=0;switch(255&P[0]){case 4:y=P[4]/4,O=new Uint32Array(t,P[3],y);break;case 2:y=P[4]/2,O=new Uint16Array(t,P[3],y);break;default:y=P[4],O=new Uint8Array(t,P[3],y)}switch(a){case 4:I=new Uint32Array(b.buffer,M,y);break;case 2:I=new Uint16Array(b.buffer,M,y);break;default:I=new Uint8Array(b.buffer,M,y)}this.UncompressIndices(I,O,y,T),_[6]=M-0,_[7]=y,_[4]=P[2]/r.values[0].stride,T+=_[4],M+=y*a}new Uint8Array(g.buffer,x,T).fill(0);var R=0,C=0,B=o.length-1;for(C=0;C<B;C++)R=o[C],this._nodesInfo[9*R+3]=o[C+1];R=o[C],this._nodesInfo[9*R+3]=-1;var L=this._modelBin.readNodeBBox(e[0]);return L[0]=n[0],L[1]=n[1],L[2]=n[2],L[3]=n[3],L[4]=n[4],L[5]=n[5],e[8]=i,e[1]=-1,e[2]|=1073741824,w},e.prototype._populateMergedNode=function(e,t,r){for(var i=this._attributesData[e[8]>>8&255],n=r.indicesOffset,a=e[8],o=this._modelBin.readNodeBBox(e[0]),s=255&e[8],l=[],u=e[0];u>=0;)l.push(u),u=this._nodesInfo[9*u+3];var c=this;l.sort(function(e,t){return(c._nodesInfo[9*e+2]>>24&15)-(c._nodesInfo[9*t+2]>>24&15)});for(var h=new Float32Array([0,0,0]),d=new Float32Array([0,0,0]),p=0,f=0,m=l.length;f<m;f++){var _=new Int32Array(this._nodesInfo.buffer,36*l[f],9),v=this._modelBin.readNodeTransform(_[0]),y=this._modelBin.readNodeBBox(_[0]),g=this._modelBin.readMesh(_[1]),b=new Float32Array(t,g[1],g[2]/4),w=g[2]/4;tr.a.compressNormals&&i.hasNormal&&(w-=g[2]/i.values[0].stride);var x=new Float32Array(r.verticesBinary,r.verticesOffset,w);0==(1073741824&_[2])?this.IsTranslationMatrix(v)?(h[0]=v[9],h[1]=v[10],h[2]=v[11],this.TransformUncompressVertices1(x,b,i,h,tr.a.compressNormals)):this.IsTranslationScalingMatrix(v)?(h[0]=v[9],h[1]=v[10],h[2]=v[11],d[0]=v[0],d[1]=v[4],d[2]=v[8],this.TransformUncompressVertices2(x,b,i,d,h,tr.a.compressNormals)):this.TransformUncompressVertices3(x,b,i,v,tr.a.compressNormals):this.UncompressVertices(x,b,i,tr.a.compressNormals),r.verticesOffset+=4*w,this.UnionBBox(o,y);var M=null,T=null,E=0;switch(255&g[0]){case 4:E=g[4]/4,T=new Uint32Array(t,g[3],E);break;case 2:E=g[4]/2,T=new Uint16Array(t,g[3],E);break;default:E=g[4],T=new Uint8Array(t,g[3],E)}switch(s){case 4:M=new Uint32Array(r.indicesBinary,r.indicesOffset,E);break;case 2:M=new Uint16Array(r.indicesBinary,r.indicesOffset,E);break;default:M=new Uint8Array(r.indicesBinary,r.indicesOffset,E)}this.UncompressIndices(M,T,E,p),_[6]=r.indicesOffset-n,_[7]=E,_[4]=g[2]/i.values[0].stride,p+=_[4],r.indicesOffset+=E*s}new Uint8Array(r.verticesBinary,r.verticesOffset,p).fill(0),r.verticesOffset+=p;var S=0,A=0,k=l.length-1;for(A=0;A<k;A++)S=l[A],this._nodesInfo[9*S+3]=l[A+1];S=l[A],this._nodesInfo[9*S+3]=-1,e=new Int32Array(this._nodesInfo.buffer,9*l[0]*4,9);var P=this._modelBin.readNodeBBox(e[0]);return P[0]=o[0],P[1]=o[1],P[2]=o[2],P[3]=o[3],P[4]=o[4],P[5]=o[5],e[8]=a,e[1]=-1,e[2]|=1073741824,e},e}(),Yn=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},Xn=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Zn=[1,1,1,1],Kn=[X.a.POINTS,X.a.LINES,X.a.LINES,X.a.LINES,X.a.TRIANGLES],Jn=[X.a.BYTE,X.a.UNSIGNED_BYTE,X.a.SHORT,X.a.UNSIGNED_SHORT,X.a.INT,X.a.UNSIGNED_INT,0,X.a.FLOAT,0],$n=new Float32Array(16);var ea=function(){function e(e,t,r,i){this._resourceManager=e,this._materialManager=t,this._model=r,this._attributes=null,this._sceneJson=null,this._modelJson=null,this._binLoader=null,this._meshBinLoader=null,this._renderScene=i}return e.prototype.destroy=function(){this._resourceManager=null,delete this._resourceManager,this._model=null,delete this._model,this._sceneJson=null,delete this._sceneJson,this._modelJson=null,delete this._modelJson,this._binLoader=null,delete this._binLoader,this._meshBinLoader.destroy(),this._meshBinLoader=null,delete this._meshBinLoader,this._attributes=null,delete this._attributes},e.prototype.load=function(e,t,r,i,n,a){return Yn(this,void 0,void 0,function(){var o,s,l,u,c,h,d,p,f=this;return Xn(this,function(m){for(this._sceneJson=t,this._modelJson=r,this._binLoader=i,o=new Array(t.attributes.length),s=0,l=t.attributes.length;s<l;s++)o[s]=new K,u=this._binLoader.readAttribute(s),o[s].primitive=Kn[u[0]],c=u[1]>=0?Jn[u[1]]:null,h=u[2]>=0?Jn[u[2]]:null,d=u[3]>=0?Jn[u[3]]:null,o[s].builtin(X.a.FLOAT,c,h,d);for(this._attributes=o,this._meshBinLoader=new Wn(this._resourceManager,t,this._binLoader,r,this._attributes,this._model),p=this._loadMesh(0,e["mesh0.bin"],n,a),s=1,l=r.buffers.length;s<l;s++)p=function(t){return p.then(function(){var r="mesh"+t.toString()+".bin";return f._loadMesh(t,e[r],n,a)})}(s);return[2,p]})})},e.prototype._loadMesh=function(e,t,r,i){return Yn(this,void 0,void 0,function(){var n,a,o=this;return Xn(this,function(l){return n=r.getSingleFileProgress(),t.onProgress(function(e){return n(e.loaded)}),a=function(t,r,n,a,l,u){var c=o._createShaderObject(t);if(!c)throw new Error("create shader failed");var h=o._createMaterialObject(t,c);if(!h)throw new Error("create material failed");o._materialManager.addModelMaterial(h);var d=s.a.isMobile?o._createMeshLonely(t,r,n):o._createMeshObject(t,r,n,l,u);if(d.setBufferIndex(e),!d)throw new Error("create mesh failed");var p=o._createDrawableObject(t,d,c,h,a);if(!p)throw new Error("create drawable failed");i(p)},[2,t.downloadFile().then(function(t){t.data.byteLength===o._modelJson.buffers[e].byteLength?(o._meshBinLoader.load(e,t.data,a),console.log("meshbin index: "+e+" loaded success")):console.warn("meshbin index: "+e+" load failed")})]})})},e.prototype._createShaderObject=function(e){var t=this._binLoader.readMaterial(65535&e[2]),r=this._attributes[e[8]>>8&255],i=255!==t[4],n="solid";r.primitive===X.a.LINES?n="plain":r.hasColor?n="color":i&&(n="texture"),this._model.usePbr&&r.primitive!==X.a.LINES&&(n="pbr");var a=[];805306368&e[2]&&a.push("INSTANCING"),1073741824&e[2]||a.push("MODEL_TRANSFORM");var o=t[3]<250&&!i;if(this._model.faces<1&&!o&&a.push("DOUBLESIDED"),s.a.isMobile&&a.push("MOBILE"),i){var l=t[5]<<8|t[4];this._binLoader.readTexture(l)[2]&&a.push("ALPHATEST"),a.push("HAS_BASECOLORMAP")}tr.a.compressNormals&&a.push("COMPRESSION"),this._model.isMatrixIdentity||a.push("MODEL_TRANSFORM");var u=this._resourceManager.getShader(n,a);if(!u.ready){var c=N.a[n];if(u.createFromShaderSource(c,a),!u.ready)throw"modelo3d error at creating shader '"+n+"'!"}return u},e.prototype._createMeshLonely=function(e,t,r){var i=null;if(!(i=this._resourceManager.getMesh(e[1]>=0?this._model.name+"/"+e[1].toString():this._model.name+"/-"+e[0].toString())).ready){var n=[X.a.UNSIGNED_BYTE,X.a.UNSIGNED_BYTE,X.a.UNSIGNED_SHORT,X.a.UNSIGNED_SHORT,X.a.UNSIGNED_INT],a=e[8]>>8&255,o=this._attributes[a];o=o.clone(),tr.a.compressNormals&&o.compress();for(var s=t.byteLength/(o.values[0].stride+(e[3]>=0?4:0)),l=0,u=o.values.length;l<u;l++)o.values[l].offset+=t.byteOffset;if(e[3]>=0){o.add("m_aMaterial",6,X.a.UNSIGNED_BYTE,!0,1);var c=o.values[o.values.length-1];c.index=6,c.offset=o.values[0].offset+s*o.values[0].stride,c.stride=1}i.create(o.primitive,o,t,r,n[255&e[8]])}return i},e.prototype._createMeshObject=function(e,t,r,i,n){var a=null;if(!(a=this._resourceManager.getMesh(e[1]>=0?this._model.name+"/"+e[1].toString():this._model.name+"/-"+e[0].toString())).ready){var o=[X.a.UNSIGNED_BYTE,X.a.UNSIGNED_BYTE,X.a.UNSIGNED_SHORT,X.a.UNSIGNED_SHORT,X.a.UNSIGNED_INT],s=e[8]>>8&255,l=this._attributes[s];l=l.clone(),tr.a.compressNormals&&l.compress();for(var u=t.byteLength/(l.values[0].stride+(e[3]>=0?1:0)),c=0,h=l.values.length;c<h;c++)l.values[c].offset+=t.byteOffset;if(e[3]>=0){l.add("m_aMaterial",6,X.a.UNSIGNED_BYTE,!0,1);var d=l.values[l.values.length-1];d.index=6,d.offset=l.values[0].offset+u*l.values[0].stride,d.stride=1}a.createShared(l.primitive,l,t,r,o[255&e[8]],i,n)}return a},e.prototype._createDrawableObject=function(e,t,r,i,n){this._attributes[e[8]>>8&255];var a=null;0==(1073741824&e[2])?(a=function(e){return $n[0]=e[0],$n[1]=e[1],$n[2]=e[2],$n[3]=0,$n[4]=e[3],$n[5]=e[4],$n[6]=e[5],$n[7]=0,$n[8]=e[6],$n[9]=e[7],$n[10]=e[8],$n[11]=0,$n[12]=e[9],$n[13]=e[10],$n[14]=e[11],$n[15]=1,$n}(this._binLoader.readNodeTransform(e[0])),this._model.isMatrixIdentity||U.a.multiply(a,this._model.getTransformMatrix(),a)):this._model.isMatrixIdentity||(a=this._model.getTransformMatrix());var o=this._binLoader.readNodeBBox(e[0]);this._model.isMatrixIdentity||P.a.aabb.transform(o,o,this._model.getTransformMatrix());var s=null;(s=!!(8388608&e[2])?new Ve(t,r,i,a,o):new I.a(t,r,i,a,o)).visible=!0,this._model.addDrawable(s),this._model.addDrawableToLayerByNodeIndex(e[0],s),this._renderScene.addModelDrawabled(s);for(var l=dn.STRUCTURE,u=e[0],c=0;u>=0;){var h=this._model.tree.nodes[u],d=n[9*u+2]>>24&15;s.nodes.push(h),h.region=d,h.drawable=s;var p=this._model.getLayerOfNode(u);p.addNode(h),h.setLayer(p),805306368&n[9*u+2]?(h.indicesOffset=1,h.indicesCount=1):(h.indicesOffset=n[9*u+6],h.indicesCount=n[9*u+7]),0===h.indicesOffset&&0===h.indicesCount&&(h.indicesCount=e[5]/t.indexSize),h.verticesCount=n[9*u+4],l!==d&&(l=d,d>=dn.STRUCTURE_INTERIOR&&s.hidables<0&&(s.hidables=c)),u=n[9*u+3],c++}return 805306368&e[2]&&(s.hidables=(e[2]>>24&15)>=dn.STRUCTURE_INTERIOR?0:-1),s},e.prototype._createMaterialObject=function(e,t){var r=e[0],i=65535&e[2],n=this._sceneJson.materials[i],a=this._model.getLayerOfNode(r),o="defaultLayer";a&&(o=a.getFullName());var s=this._attributes[e[8]>>8&255].primitive===X.a.LINES;s&&(n="mxLine-"+n),!s&&this._model.usePbr&&(n="mxPbr-"+n);var l=o+"."+n,u=this._materialManager.getMaterial(l);if(!u){var c,h=this._binLoader.readMaterial(i);if((u=!s&&this._model.usePbr?this._materialManager.createMaterialPbr(l):this._materialManager.createMaterialAdhoc(l)).setModelName(this._model.name),u.setLayerName(o),u.setMaterialName(n),u.attachShader(t,this._resourceManager),Zn[0]=h[0]/255,Zn[1]=h[1]/255,Zn[2]=h[2]/255,Zn[3]=h[3]/255,u instanceof V)u.setDiffuse(Zn);else u.setBaseColor(Zn),this._resourceManager.hasTexture("modelo-brdf-lut")?c=this._resourceManager.getTexture("modelo-brdf-lut"):(c=this._resourceManager.getTexture("modelo-brdf-lut")).createFromFile(ne,X.a.RGBA,X.a.LINEAR,X.a.CLAMP_TO_EDGE,function(){}),u.setBrdfLut(c);if(u.setTransparent(h[3]/255),u.getTransparent()<.98&&(u.transparent=!0),255!==h[4]){var d=h[5]<<8|h[4],p=this._model.name+"-"+this._sceneJson.textures[d].name.toLowerCase(),f=this._binLoader.readTexture(d);4===f[0]?1===f[2]?(u.hasMask=!0,u.transparent=!1):(u.transparent=!0,u.textureTransparent=!0):u.transparent?(u.transparent=!0,u.textureTransparent=!0):u.transparent=!1;var m=this._resourceManager.getTexture(p);u instanceof V?(u.setDiffuseTexture(m),u.originTextureUrl=m.url):u.setBaseColorTexture(m),u.setTextureFullName(p)}}return u},e}(),ta=r(74),ra=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},ia=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},na=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},aa=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(na(arguments[t]));return e},oa=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},sa=function(){function e(e,t,r,i){this._model=e,this._resourceManager=t,this._materialManager=r,this._renderScene=i,this._binLoader=null,this._filePromises=[],this._modelJson=null,this._sceneJson=null,this._progressTracker=null}return e.prototype.destroy=function(){this._model=null,delete this._model,this._resourceManager=null,delete this._resourceManager,this._binLoader.destroy(),this._binLoader=null,delete this._binLoader,this._filePromises=null,delete this._filePromises,this._filePromises=null,delete this._filePromises,this._sceneJson=null,delete this._sceneJson,this._modelJson=null,delete this._modelJson,this._progressTracker=null,delete this._progressTracker},e.prototype._saveFilePromises=function(e){var t=this;Object.keys(e).forEach(function(r){t._filePromises[r.toLowerCase()]=e[r]}),console.log("filePromises: ",this._filePromises)},e.prototype._initProgressTracker=function(e){this._progressTracker=new Gn.a.ProgressTracker(e)},e.prototype._loadSceneJson=function(){return ra(this,void 0,void 0,function(){var e,t;return ia(this,function(r){switch(r.label){case 0:if(!this._filePromises["scene.json"])throw new Error("scene.json not exist");return[4,this._filePromises["scene.json"].downloadFile()];case 1:if(!(e=r.sent()))throw new Error("scene.json is empty");return this._sceneJson="string"==typeof e.data?JSON.parse(e.data):e.data,this._judgeDoubleSided(),t=this._getDefaultView(this._model.getViewsData(),this._sceneJson.scene.defaultView),this._model.setDefaultView(t),console.log("mx version: "+this._sceneJson.version),[2]}})})},e.prototype._loadModelJson=function(){return ra(this,void 0,void 0,function(){var e,t,r;return ia(this,function(i){switch(i.label){case 0:if(!this._filePromises["model.json"])throw new Error("model.json not exist");return[4,this._filePromises["model.json"].downloadFile()];case 1:if(!(e=i.sent()))throw new Error("model.json is empty");if(this._modelJson=e.data,0===this._modelJson.buffers.length)throw new Error("empty model( no mesh buffer )");return this._model.bbox=P.a.aabb.createFromArray(this._modelJson["model.bin"].bbox),t=this._modelJson["model.bin"].nodes,this._model.initLayers(t),this._model.initViews(t),this._model.initTree(t),r=this._modelJson.buffers.reduce(function(e,t){return e+t.meshes},0),console.log("numOfNodes: "+t),console.log("numOfMeshes: "+r),[2]}})})},e.prototype._setProgressTracker=function(){var e=0;this._sceneJson.textures&&this._sceneJson.textures.forEach(function(t){return e+=t.byteLength});var t=0;this._modelJson.buffers&&this._modelJson.buffers.forEach(function(e){return t+=e.byteLength});var r=this._modelJson["model.bin"].byteLength,i=this._modelJson["modelgraph.bin"].byteLength,n=this._modelJson["uuid.bin"]?this._modelJson["uuid.bin"].byteLength:0;this._progressTracker.totalDownload=e+t+r+i+n},e.prototype._loadLayers=function(){return ra(this,void 0,void 0,function(){var e,t;return ia(this,function(r){switch(r.label){case 0:return e=null,this._filePromises["layers.json"]?[3,1]:(e=this._createLayerData(),console.log("has no layers: create default layer"),[3,3]);case 1:return[4,this._filePromises["layers.json"].downloadFile()];case 2:t=r.sent(),e=t.data,r.label=3;case 3:return this._model.setLayerJsonData(e),[2]}})})},e.prototype._loadViews=function(){return ra(this,void 0,void 0,function(){var e;return ia(this,function(t){switch(t.label){case 0:return this._filePromises["views.json"]?[4,this._filePromises["views.json"].downloadFile()]:(console.log("has no views"),[2]);case 1:return e=t.sent(),this._model.setViewsData(e.data),[2]}})})},e.prototype._loadSceneBin=function(){return ra(this,void 0,void 0,function(){var e;return ia(this,function(t){switch(t.label){case 0:if(!this._filePromises["scene.bin"])throw new Error("scene.bin not exist");return[4,this._filePromises["scene.bin"].downloadFile()];case 1:if(!(e=t.sent()))throw new Error("scene.bin is empty");return this._sceneBin=e.data,[2]}})})},e.prototype._loadModelBin=function(){return ra(this,void 0,void 0,function(){var e,t;return ia(this,function(r){switch(r.label){case 0:if(!this._filePromises["model.bin"])throw new Error("model.bin not exist");return e=this._progressTracker.getSingleFileProgress(),this._filePromises["model.bin"].onProgress(function(t){return e(t.loaded)}),[4,this._filePromises["model.bin"].downloadFile()];case 1:if(!(t=r.sent()))throw new Error("model.bin is empty");return this._modelBin=t.data,[2]}})})},e.prototype._prepareBinLoader=function(){this._binLoader=new je(this._sceneJson,this._sceneBin,this._modelJson,this._modelBin)},e.prototype._loadNodesAABB=function(){for(var e=this._model.tree,t=e.nodes.length,r=0;r<t;r++){e.nodes[r]=new Hn(r);var i=this._binLoader.readNodeBBox(r),n=new Float32Array(e.nodeBBoxes.buffer,24*r,6);P.a.aabb.copy(n,i)}},e.prototype._loadTextures=function(){return ra(this,void 0,void 0,function(){return ia(this,function(e){switch(e.label){case 0:return 0===this._sceneJson.textures.length?[2]:(this._collectSamplers(),this._hasOldDiscretedTextures()?[4,this._loadDiscretedTextures()]:[3,2]);case 1:return e.sent(),[3,4];case 2:return[4,this._loadZipTextures(this._sceneJson.textures)];case 3:e.sent(),e.label=4;case 4:return console.log("load texture ready"),[2]}})})},e.prototype._loadMeshes=function(e){return ra(this,void 0,void 0,function(){return ia(this,function(t){switch(t.label){case 0:return this._model.isMatrixIdentity||P.a.aabb.transform(this._model.bbox,this._model.bbox,this._model.getTransformMatrix()),[4,new ea(this._resourceManager,this._materialManager,this._model,this._renderScene).load(this._filePromises,this._sceneJson,this._modelJson,this._binLoader,this._progressTracker,e)];case 1:return t.sent(),this._model.initlize(this._model.bbox),[2]}})})},e.prototype._loadModelGraph=function(){return ra(this,void 0,void 0,function(){return ia(this,function(e){if(!this._filePromises["modelgraph.bin"])throw new Error("modelgraph.bin not exist!");return new Qn(this._model).load(this._filePromises,this._progressTracker),[2]})})},e.prototype._createLayerData=function(){return[{name:this._model.name,visible:!0,color:[1,1,1],nodes:[]}]},e.prototype._judgeDoubleSided=function(){if(this._sceneJson.source){var e=[];this._sceneJson.source.split("/").forEach(function(t){return e.push.apply(e,aa(t.split(".")))});var t=e[e.length-1];switch(this._model.faces=1,t){case"skp":this._model.faces=s.a.isOrbital?0:2,this._model.hasContours=!0,this._model.isBimCullingNeeded=!0;break;case"mpd":this._model.faces=0,this._model.isBimCullingNeeded=!0;break;case"rfa":case"rvt":this._model.faces=0,this._model.hasProfileLines=!0,this._model.hasContours=!0,this._model.isBimCullingNeeded=!0;break;case"vgx":case"stl":case"max":this._model.faces=1;break;case"obj":case"3dm":this._model.faces=0,this._model.hasCurveOrLine=!0;break;case"nwd":this._model.faces=0;break;default:this._model.faces=1}this._model.source=t}},e.prototype._collectSamplers=function(){var e=this._sceneJson.samplers.length;this._samplers=new Array(e);for(var t=0;t<e;t++){this._samplers[t]=new Object;var r=this._binLoader.readSampler(t);this._samplers[t].wrap=1===r[1]?X.a.REPEAT:X.a.CLAMP_TO_EDGE,this._samplers[t].filter=1===r[0]?1===r[2]?X.a.LINEAR_MIPMAP_LINEAR:X.a.LINEAR:1===r[2]?X.a.NEAREST_MIPMAP_NEAREST:X.a.NEAREST}},e.prototype._hasOldDiscretedTextures=function(){var e=this._sceneJson.textures[0].name.toLowerCase();return!!this._filePromises[e]},e.prototype._loadDiscretedTextures=function(){return ra(this,void 0,void 0,function(){var e,t=this;return ia(this,function(r){switch(r.label){case 0:return console.log("use old texture promise"),e=this._sceneJson.textures.map(function(e,r){return ra(t,void 0,void 0,function(){return ia(this,function(t){return this._loadSingleTextureImage(e.name.toLowerCase(),r),[2]})})}),[4,Promise.all(e)];case 1:return r.sent(),[2]}})})},e.prototype._loadSingleTextureImage=function(e,t){return ra(this,void 0,void 0,function(){var r;return ia(this,function(i){switch(i.label){case 0:if(!this._filePromises[e])throw new Error(e+" not exist");return[4,this._filePromises[e].downloadFile()];case 1:return r=i.sent(),this._createTexture(r,e,t),[2]}})})},e.prototype._hasNextZipTexture=function(e){var t="textures"+e.toString()+".zip";return!!this._filePromises[t]},e.prototype._loadZipTextures=function(e){return ra(this,void 0,void 0,function(){var t;return ia(this,function(r){switch(r.label){case 0:if(!this._hasNextZipTexture(0))throw new Error("textures0.zip not exist");console.log("use zip textures"),t=0,r.label=1;case 1:return this._hasNextZipTexture(t)?[4,this._loadZipTexture(t,e)]:[3,3];case 2:return r.sent(),t++,[3,1];case 3:return[2]}})})},e.prototype._loadZipTexture=function(e,t){return ra(this,void 0,void 0,function(){var r,i,n,a,o,s,l,u,c,h,d,p,f,m=this;return ia(this,function(_){switch(_.label){case 0:return r="textures"+e.toString()+".zip",[4,this._filePromises[r].downloadFile()];case 1:i=_.sent(),_.label=2;case 2:return _.trys.push([2,4,,5]),[4,Object(ta.a)(i.data)];case 3:return a=_.sent(),n=a.entries,[3,5];case 4:throw _.sent(),new Error("unzip "+r+" failed");case 5:o=function(e,r){var i,a,o,s,l,u;return ia(this,function(r){switch(r.label){case 0:i=e.split(".")[1],a="png","jpg"===i&&(a="jpeg"),o=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n[e].blob("image/"+a)];case 2:return o=r.sent(),[3,4];case 3:throw r.sent(),new Error(e+" image to blob failed");case 4:for(s=0,l=0;l<t.length;l++)t[l].name===e&&(s=l);return(u=new Image).src=URL.createObjectURL(o),u.onload=function(){return m._createTexture(u,e.toLowerCase(),s)},[2]}})},_.label=6;case 6:_.trys.push([6,11,12,13]),s=oa(Object.entries(n)),l=s.next(),_.label=7;case 7:return l.done?[3,10]:(u=na(l.value,2),c=u[0],h=u[1],[5,o(c,h)]);case 8:_.sent(),_.label=9;case 9:return l=s.next(),[3,7];case 10:return[3,13];case 11:return d=_.sent(),p={error:d},[3,13];case 12:try{l&&!l.done&&(f=s.return)&&f.call(s)}finally{if(p)throw p.error}return[7];case 13:return[2]}})})},e.prototype._createTexture=function(e,t,r){var i=this._model.name+"-"+t;this._resourceManager.addSourceImage(e,i);var n=this._binLoader.readTexture(r),a=this._samplers[n[1]],o=this._resourceManager.gl,s=4===n[0]?o.RGBA:o.RGB,l=this._resourceManager.getTexture(i);l.url=e.src,l.updateImage(e,s,o.UNSIGNED_BYTE,a.filter,a.wrap)},e.prototype._getDefaultView=function(e,t){var r,i;if(!e||!t)return null;try{for(var n=oa(e),a=n.next();!a.done;a=n.next()){var o=a.value;if(o.name===t)return!0===o.perspective?o:null}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}},e}(),la=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ua=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},ca=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return la(t,e),t.prototype.load=function(e,t,r,i,n,a,o){return ua(this,void 0,void 0,function(){var s=this;return ca(this,function(l){return[2,this._generatePromises(this._model.name,t,r,e).then(function(t){return ua(s,void 0,void 0,function(){var r=this;return ca(this,function(s){switch(s.label){case 0:return console.group("Loading model: "+this._model.name),console.time("ModelLoading: "),this._saveFilePromises(t),this._initProgressTracker(e),[4,this._loadSceneJson()];case 1:return s.sent(),[4,this._loadModelJson()];case 2:return s.sent(),this._setProgressTracker(),[4,this._loadLayers()];case 3:return s.sent(),[4,this._loadViews()];case 4:return s.sent(),[4,this._loadSceneBin()];case 5:return s.sent(),[4,this._loadModelBin()];case 6:return s.sent(),i(this._modelJson["model.bin"]),this._prepareBinLoader(),this._loadNodesAABB(),[4,this._loadTextures()];case 7:return s.sent(),[4,this._loadMeshes(o)];case 8:return s.sent(),[4,this._loadModelGraph()];case 9:return s.sent(),e(1),n(this._sceneJson),[2,new Qn(this._model).load(this._filePromises,this._progressTracker).then(function(){a(r._modelJson)})]}})})})]})})},t.prototype._generatePromisesLocal=function(e,t){return ua(this,void 0,void 0,function(){var r,i,n;return ca(this,function(a){return r={},n=(i=e||"./localmodel")+"/scene.json",r["scene.json"]=Gn.a.OpenFile1(n,"json",Promise),[2,r["scene.json"].downloadFile(function(e){t(e.loaded/e.total*.05)}).then(function(e){for(var t,n=e.data,a=0,o=n.textures.length;a<o;a++){var s=n.textures[a].name;t=i+"/"+s,r[s]=Gn.a.OpenImage(t,Promise)}return t=i+"/scene.bin",r["scene.bin"]=Gn.a.OpenFile1(t,"arraybuffer",Promise),t=i+"/model.bin",r["model.bin"]=Gn.a.OpenFile1(t,"arraybuffer",Promise),t=i+"/modelgraph.bin",r["modelgraph.bin"]=Gn.a.OpenFile1(t,"arraybuffer",Promise),t=i+"/uuid.bin",r["uuid.bin"]=Gn.a.OpenFile1(t,"arraybuffer",Promise),t=i+"/model.json",r["model.json"]=Gn.a.OpenFile1(t,"json",Promise),r["model.json"].downloadFile()}).then(function(e){for(var t=0,n=e.data.buffers.length;t<n;t++){var a=i+"/mesh"+t+".bin";r["mesh"+t+".bin"]=Gn.a.OpenFile1(a,"arraybuffer",Promise)}return Promise.resolve(r)})]})})},t.prototype._generatePromises=function(e,t,r,i){return ua(this,void 0,void 0,function(){return ca(this,function(n){return r instanceof Array?[2,Object(Ge.b)(e,r)]:t?[2,this._generatePromisesLocal(r,i)]:[2,Object(Ge.b)(e)]})})},t}(sa),da=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),pa=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},fa=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},ma=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return da(t,e),t.prototype.load=function(e,t,r,i,n,a,o,s,l){return pa(this,void 0,void 0,function(){return fa(this,function(e){return[2,new ha(this,this._resourceManager,this._materialManager,t).load(r,i,n,a,o,s,l)]})})},t}(jn),_a=r(48),va=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ya=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},ga=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};var ba=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return va(t,e),t.prototype.loadModel=function(e,t,r,i,n){return ya(this,void 0,void 0,function(){var a,o,s,l,u,c;return ga(this,function(h){return a=!1,function(e){return"object"==typeof e&&null!==e}(t)?(a=t.usePbr,r=r||t.changeCamera,o=t.cameraInfo,s=t.onProgress,c=void 0===s?function(){}:s,l=t.initialTransform,u=void 0===l?[]:l,[2,this._load(e,u,c,r,a,o,i,n)]):(c=t||function(){},[2,this._load(e,[],c,r,a,null,i,n)])})})},t.prototype._load=function(e,t,r,n,a,o,s,l){return ya(this,void 0,void 0,function(){var n,u,c,h=this;return ga(this,function(d){return n=new ma(e,t,this._resourceManager,this._materialManager,a,s),t&&0!==t.length||(t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),u=this,c=this.getEventEmitter(),u.invalidate(),u.state=i.RENDERING,u._elapsedFrames=1,[2,n.load(e,this._renderScene,r,s,l,function(){o&&(o.fov=o.fov||46,u.setDefaultCam(o)),Object.getOwnPropertyNames(u._scene.core.models).length>0&&(u.initialLoaded=!1),u._scene.addModel(n,u.initialLoaded,o),n.defaultView&&u._camera.core.restore(n.defaultView),c.emit("loadingPhase1Done")},function(){u.hasProfileLines()&&u.setRenderingLinesEnabled(!1),u.hasCurveOrLine()&&u.setRenderingLinesEnabled(!0),u.onSceneChanged();var e=function(){u._camera.core.setCullingEnabled(!0),u._camera.core.removeUpdateStopListener(e)};u._camera.core.addUpdateStopListener(e),c.emit("loadingPhase2Done")},function(e){c.emit("BIMloaded");for(var t=e["model.bin"].nodes,r=0,i=0,n=e.buffers.length;i<n;i++)r+=e.buffers[i].byteLength;u._scene.core.nodes=t,u._scene.core.meshKbytes=Math.round(r/1024*100)/100,u._scene.core.initBimCullingNeeded()},function(e){u.invalidate(),u._renderScene.refresh(),u._camera.core._updateProjection()}).then(function(){return _a.a.create=_a.c.bind(null,h),_a.a.activate=_a.b.bind(null,h),Promise.resolve(e)})]})})},t}(kn),wa=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),xa=function(e){function t(t){var r=e.call(this,"morphing")||this;return r._speed=0,r._eventEmitter=t,r}return wa(t,e),t.prototype.update=function(){var e=this._camera;return Math.abs(e._targetFov-e._fov)<Math.abs(this._speed)?(Bt.a.prototype._setFov.apply(e,[e._targetFov]),Bt.a.prototype.update.apply(e),e._cull.update(),this.detach(),this._eventEmitter&&this._eventEmitter.emit("Tour360-MorphingOver"),!1):(Bt.a.prototype._setFov.apply(e,[e._fov+this._speed]),Bt.a.prototype.update.apply(e),e._cull.update(),!0)},t.prototype.start=function(e,t,r,i){var n=this._camera;e&&(n._phi=n._targetPhi=e),t&&(n._theta=n._targetTheta=t),null!=r&&(r=P.a.clamp(r,1,170),n._fov=r),i&&(n._targetFov=i),this._fovDiff=n._targetFov-n._fov,this._speed=(n._targetFov-n._fov)/50},t.prototype.getProgress=function(){var e=this._camera;return(e._targetFov-e._fov)/this._fovDiff},t.prototype._onEnd=function(){return!1},t.prototype._onStart=function(){return!1},t}(Lt.a),Ma=r(49),Ta=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ea=function(e){function t(t){var r=e.call(this,"panorama")||this;return r._srcAt=U.d.create(),r._dstAt=U.d.create(),r._srcTheta=0,r._dstTheta=0,r._srcPhi=0,r._dstPhi=0,r._curTheta=0,r._curPhi=0,r._eventEmitter=t,r._startTime=0,r._duration=0,r._speed=15,r}return Ta(t,e),t.prototype.update=function(){var e=(new Date).getTime()-this._startTime;if(e>=this._duration)return e>3*this._duration?(this.stop(),this._eventEmitter&&this._eventEmitter.emit("Tour360-TransitionOver")):this._updateCamera(this._dstTheta,this._dstPhi)||(this.stop(),this._eventEmitter&&this._eventEmitter.emit("Tour360-TransitionOver")),!0;var t=e/this._duration;return this._curPhi=Ma.a.linear.scalar(this._srcPhi,this._dstPhi,t),this._curTheta=Ma.a.linear.scalar(this._srcTheta,this._dstTheta,t),this._updateCamera(this._curTheta,this._curPhi)},t.prototype.stop=function(){var e=this._camera;e._targetDistance=e._distance;var t=e.eye[0]-e._at[0],r=e.eye[1]-e._at[1],i=e.eye[2]-e._at[2];e._targetPhi=e._phi=Math.asin(Math.min(i/e._targetDistance,1)),e._targetPhi>=.49999*Math.PI&&(e._targetPhi=.49999*Math.PI),e._targetPhi<=-.49999*Math.PI&&(e._targetPhi=-.49999*Math.PI),e._targetTheta=e._theta=Math.atan2(r,t),e._firstPerson&&(e._targetPhi=e._phi=-e._targetPhi,e._targetTheta=e._theta=e._targetTheta+Math.PI),this.detach()},t.prototype.start=function(e){var t=this._camera;U.d.normalize(t._at,t._at),U.d.scale(t._at,t._at,15);var r=Math.atan2(t._at[1],t._at[0]);r<0&&(r+=2*Math.PI),t._targetTheta=t._theta=r,U.d.copy(this._srcAt,t._at);var i=U.d.clone(e);U.d.normalize(i,i),U.d.scale(i,i,15),U.d.copy(this._dstAt,i),this._srcTheta=t._theta,this._srcPhi=t._phi,this._dstTheta=Math.atan2(i[1],i[0]),this._dstTheta<0&&(this._dstTheta+=2*Math.PI);var n,a,o=this._dstTheta-this._srcTheta;Math.abs(o)>Math.PI&&(this._dstTheta-=2*Math.PI*Math.sign(o)),this._dstPhi=Math.asin(Math.min(i[2]/15,1)),this._dstPhi>=.49999*Math.PI&&(this._dstPhi=.49999*Math.PI),this._dstPhi<=-.49999*Math.PI&&(this._dstPhi=-.49999*Math.PI),n=Math.abs(this._srcTheta-this._dstTheta),a=Math.abs(this._srcPhi-this._dstPhi),n=Math.ceil(n/Math.PI*90),a=Math.ceil(a/Math.PI*90);var s=Math.max(n,a);return this._duration=s*this._speed,this._startTime=(new Date).getTime(),!0},t.prototype._updateCamera=function(e,t){var r=this._camera,i=Math.sin(t),n=Math.cos(t),a=Math.sin(e),o=Math.cos(e);r._targetAt[0]=n*o*r._distance,r._targetAt[1]=n*a*r._distance,r._targetAt[2]=i*r._distance,r._targetTheta=e,r._targetPhi=t;r._targetTheta,r._theta,r._targetPhi,r._phi;var s=r._targetEye[0]-r.eye[0],l=r._targetEye[1]-r.eye[1],u=r._targetEye[2]-r.eye[2],c=r._targetAt[0]-r._at[0],h=r._targetAt[1]-r._at[1],d=r._targetAt[2]-r._at[2],p=Math.abs(s)+Math.abs(l)+Math.abs(u)+Math.abs(c)+Math.abs(h)+Math.abs(d)>1e-4;return r.eye[0]+=.15*s,r.eye[1]+=.15*l,r.eye[2]+=.15*u,r._at[0]+=.15*c,r._at[1]+=.15*h,r._at[2]+=.15*d,r._distance=U.d.distance(r.eye,r._at),U.a.lookAt(r.viewMatrix,r.eye,r._at,[0,0,1]),U.a.multiply(r.vpMatrix,r.projectMatrix,r.viewMatrix),p},t.prototype.setTransitionSpeed=function(e){this._speed=e},t.prototype._onEnd=function(){return!1},t.prototype._onStart=function(){return!1},t}(Lt.a),Sa=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Aa=function(e){function t(t,r){var i=e.call(this,t)||this,n=[0,0,i._viewer.getCanvas().width,i._viewer.getCanvas().height];return i.cores.push(new Yt(null,n)),i.cores[0].setFirstPerson(!0),U.d.set(i.cores[0].eye,0,0,0),i.cores[1].setFirstPerson(!0),U.d.set(i.cores[1].eye,0,0,0),i._fov=78,i._FOV_CHANGE_SPEED=.3,i.cores[0].setTargetFov(i._fov),i.cores[0]._targetPhi=0,i.cores[0]._targetTheta=0,i.cores[1].setTargetFov(i._fov),i.cores[1]._targetPhi=0,i.cores[1]._targetTheta=0,i._animators=new Array(2),i._eventEmitter=r,i._animators[0]=new xa(i._eventEmitter),i._animators[1]=new xa(i._eventEmitter),i._transition=new Ea(i._eventEmitter),i._transition.setTransitionSpeed(80),i}return Sa(t,e),t.prototype.destroy=function(){this._animators[0].destroy(),this._animators[1].destroy(),this._animators=null,delete this._animators,e.prototype.destroy.call(this)},t.prototype.setFov=function(e){this.cores[0].setTargetFov(e),this.cores[1].setTargetFov(e),this._viewer&&this._viewer.invalidate()},t.prototype.resize=function(e,t){this.cores[0].setViewport([0,0,e,t]),this.cores[0].update(),this.cores[1].setViewport([0,0,e,t]),this.cores[1].update()},t.prototype.update=function(){var e=this.cores[0].update(),t=this.cores[1].update();return e||t},t.prototype.addInput=function(t){var r=this;(e.prototype.addInput.call(this,t),this._manipulator.addInput(t),this._manipulator.setCamera(this.cores),this._manipulator.setPanoramaEnabled(!0),"mouse"===t.name)&&t.addMouseWheelListener(function(e){var t=-e.delta*r._FOV_CHANGE_SPEED;return r._fov+=t,r._fov>180&&(r._fov=179.99999),r._fov<0&&(r._fov=.001),r.cores[0].setTargetFov(r._fov),r.cores[1].setTargetFov(r._fov),!0},"Camera360")},t.prototype.transit=function(e,t){var r=this.cores[e],i=this.cores[1-e],n=this._animators[e],a=this._animators[1-e];n.attach(r),n.start(null,null,null,10),a.attach(i),t?(i._targetFov=i._fov=t.fov,i._targetPhi=i._phi=t.phi,i._targetTheta=i._theta=t.theta,a.start(null,null,140,t.fov)):a.start(null,null,140,78),this._manipulator.setCamera(this.cores,1-e)},t.prototype.setView=function(e,t){var r=this.cores[e],i=this.cores[1-e];r._targetPhi=t.phi,r._phi=t.phi+.001,r._targetTheta=r._theta=t.theta,i._targetPhi=t.phi,i._phi=t.phi+.001,i._targetTheta=i._theta=t.theta},t.prototype.getCameraInfo=function(e){return{fov:this.cores[e]._targetFov,phi:this.cores[e]._targetPhi,theta:this.cores[e]._targetTheta,position:U.d.clone(this.cores[e]._at)}},t.prototype.moveTo=function(e,t){var r=new Ea(this._eventEmitter);r.setTransitionSpeed(300),r.attach(this.cores[e]),r.start(t)},t}(or),ka=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Pa=function(){return function(e){this.id=e,this.ray={start:U.d.create(),direction:U.d.create()}}}(),Na=function(e){function t(t,r,i,n){var a=e.call(this,t,r,i,n)||this;a._convergence=.1,a._separation=1,a._data={},a._leftSkyboxes=[],a._rightSkyboxes=[],a._morphingAnimators=[],a.morphing=!1,a._renderTarget=null,a._viewDirection=U.d.create(),a._current=0,a._currentAssetId="",a.orientation=s.a.isMobile?new wn:null,a._stereo=!1,a._convergence=.1,a._separation=1,a._camera=new Aa(a,a._eventEmitter),a._morphingAnimators[0]=new xa(a.getEventEmitter()),a._morphingAnimators[1]=new xa(a.getEventEmitter()),s.a.isMobile?(a._camera.cores[0]._targetFov=a._camera.cores[0]._fov=78,a._camera.cores[0]._targetPhi=a._camera.cores[0]._phi=0,a._camera.cores[0]._targetTheta=a._camera.cores[0]._theta=0,a._camera.cores[0].animator=new Wi,a._camera.cores[0].animator.bind(a._camera.cores[0]),a._camera.cores[1].animator=new Wi,a._camera.cores[1].animator.bind(a._camera.cores[1])):(a._camera.cores[0].setTargetFov(78),a._camera.cores[0]._targetPhi=0,a._camera.cores[0]._targetTheta=0);var o=a.getWidth(),l=a.getHeight(),u=new Int32Array([0,0,o/2,l]),c=new Int32Array([0,0,o/2,l]);return a._leftCamera=new zi(null,u),a._rightCamera=new zi(null,c),a._renderTarget=new Jt.a("default",a._resourceManager,a._canvas.width,a._canvas.height,{blend:!0,depthTest:!1}),a._leftCamera.setCullingEnabled(!1),a._rightCamera.setCullingEnabled(!1),a._leftSkyboxes[0]=new et.b(a._resourceManager),a._leftSkyboxes[0].setMode(et.a.SKYBOX_CUBEMAP),a._leftSkyboxes[1]=new et.b(a._resourceManager),a._leftSkyboxes[1].setMode(et.a.SKYBOX_CUBEMAP),a._rightSkyboxes[0]=new et.b(a._resourceManager),a._rightSkyboxes[0].setMode(et.a.SKYBOX_CUBEMAP),a._rightSkyboxes[1]=new et.b(a._resourceManager),a._rightSkyboxes[1].setMode(et.a.SKYBOX_CUBEMAP),a}return ka(t,e),t.prototype.destroy=function(){this.state!==i.UNINITIALIZED&&(this.pause(),this._renderTarget.destroy(),this._renderTarget=null,delete this._renderTarget,s.a.isMobile&&(this.orientation.detach(),this.orientation.destroy(),this.orientation=null),this._data=null,delete this._data,this._leftSkyboxes[0].destroy(),this._leftSkyboxes[1].destroy(),this._leftSkyboxes=null,delete this._leftSkyboxes,this._rightSkyboxes[0].destroy(),this._rightSkyboxes[1].destroy(),this._rightSkyboxes=null,delete this._rightSkyboxes,e.prototype.destroy.call(this))},t.prototype.switchPanorama=function(e,t,r){void 0===r&&(r=!0),this.state=i.INITIALIZED,r&&this._resetScene(t),this._currentAssetId=e,this._leftSkyboxes[this._current].setImage(this._data[this._currentAssetId].images),this.state=i.RENDERING},t.prototype.moveTo=function(e){this._camera.moveTo(this._current,e)},t.prototype.getCameraInfo=function(){return this._camera.getCameraInfo(this._current)},t.prototype.getCurrentCamera=function(){return this._camera.cores[this._current]},t.prototype.dumpScreen=function(e,t){e||t?t||(t=e*this._canvas.height/this._canvas.width):(e=this._canvas.width,t=this._canvas.height);var r=Math.floor(this._canvas.width/s.a.devicePixelRatio),i=Math.floor(this._canvas.height/s.a.devicePixelRatio),n=Math.floor(e/s.a.devicePixelRatio),a=Math.floor(t/s.a.devicePixelRatio);n===r&&a===i||this.resize(n,a),this._update(!0);var o=this._canvas.toDataURL("image/jpeg",.75);return n!==r||a!==i?this.resize(r,i):this.invalidate(),o},t.prototype._resetScene=function(e){var t=this._camera;s.a.isMobile&&e&&(e.phi=0),this.morphing?t.transit(this._current,e):t.setView(this._current,e),this._current=1-this._current},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this._camera.resize(this._canvas.width,this._canvas.height),this._renderTarget.resize(this._canvas.width,this._canvas.height),s.a.isMobile&&this.orientation.reset(this._camera.cores[this._current]),this.invalidate()},t.prototype._drawScene=function(){var e=this._camera,t=this.getWidth(),r=this.getHeight();this._stereo?(this._draw360VR(e.cores[this._current],t,r),this._detectVRIndicator(this._leftCamera,this._rightCamera)):(e.cores[this._current].animator instanceof xa?(this._renderer.drawSkybox(this._renderTarget,this._leftSkyboxes[1-this._current],e.cores[1-this._current]),this._renderer.endFrame(),this._renderer.beginFrame(),this._leftSkyboxes[this._current].setTransparency(1-e.cores[this._current].animator.getProgress())):this.detectIndicator(e.cores[this._current]),e.cores[this._current].setViewport(new Int32Array([0,0,t,r])),this._renderer.drawSkybox(this._renderTarget,this._leftSkyboxes[this._current],e.cores[this._current]))},t.prototype.detectIndicator=function(e){},t.prototype._draw360VR=function(e,t,r){this._leftCamera.update(e,-this._convergence,.5*-this._separation),this._leftCamera.setViewport(new Int32Array([0,0,t/2,r])),this._renderer.drawSkybox(this._renderTarget,this._leftSkyboxes[this._current],this._leftCamera),this._rightCamera.update(e,this._convergence,.5*this._separation),this._rightCamera.setViewport(new Int32Array([t/2,0,t/2,r])),this._renderer.drawSkybox(this._renderTarget,this._rightSkyboxes[this._current],this._rightCamera)},t.prototype._update=function(e){void 0===e&&(e=!1),this.state===i.RENDERING&&(s.a.isMobile?this._stereo?this.orientation.update():(this._camera.cores[this._current].update(),this.orientation.update()):(this._camera.cores[0].update(),this._camera.cores[1].update()),this._renderer.beginFrame(),this._drawScene(),this._renderer.endFrame())},t.prototype.setOrientationEnable=function(e){this.orientation.setEnabled(e)},t.prototype.setVREnabled=function(e){this._stereo!==e&&(this._stereo=e,s.a.isMobile&&(this.orientation.setEnabled(e),this.orientation.modulate=!this._stereo))},t.prototype.setVRConvergence=function(e){this._convergence=e},t.prototype._setVRSeparation=function(e){this._separation=e},t.prototype._detectVRIndicator=function(e,t){var r=this._detect(e,.99),i=this._detect(t,.99);this._eventEmitter.emit("updatePanoramaVRIndicator",r,i)},t.prototype._detect=function(e,t){void 0===t&&(t=.607),U.d.set(this._viewDirection,-e.viewMatrix[2],-e.viewMatrix[6],-e.viewMatrix[10]);var r=[];for(var i in this._data){var n=(h=this._data[i]).ray?U.d.dot(h.ray.direction,this._viewDirection):0,a=h.ray?e.project(h.ray.start):[0,0];r.push({id:h.id,screenPosition:[a[0],a[1]],angle:n,visible:!!(n>t&&a[2]),focus:!1})}for(var o=-1,l=0,u=0,c=r.length;u<c;u++){var h;(h=r[u]).visible=h.visible&&h.screenPosition[0]>e.viewport[0]/s.a.devicePixelRatio&&h.screenPosition[0]<(e.viewport[0]+e.viewport[2])/s.a.devicePixelRatio&&h.screenPosition[1]>e.viewport[1]/s.a.devicePixelRatio&&h.screenPosition[1]<(e.viewport[1]+e.viewport[3])/s.a.devicePixelRatio,h.visible&&l<h.angle&&(l=h.angle,o=u)}return o>-1&&(r[o].focus=!0),r},t.prototype._setIndicators=function(e){this._data={};for(var t=0;t<e.length;t++){var r=e[t].id;this._data[r]=new Pa(r),U.d.copy(this._data[r].ray.start,e[t].position),U.d.normalize(this._data[r].ray.direction,this._data[r].ray.start)}},t}(kn),Da=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},Ia=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Oa=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ra=function(){function e(e,t){this._data=e,this._viewer=t}return e.prototype.load=function(e,t,r,i,n,a){return Da(this,void 0,void 0,function(){var e,t,o,s,l,u,c,h,d,p,f,m,_;return Ia(this,function(v){switch(v.label){case 0:console.group("Loading panoramas "),e=1,v.label=1;case 1:v.trys.push([1,6,7,8]),t=Oa(r),o=t.next(),v.label=2;case 2:if(o.done)return[3,5];if(s=o.value,(l=this._data[s]).ready)return[2];if("cubemaps"!==l.type)throw Error("Unsupported panorama file types!");for(u=[],c=0;c<l.imageUrls.length;c++)h=l.imageUrls[c].split("/"),d={filename:h[h.length-1],url:l.imageUrls[c]},u.push(Object(Ge.a)(s,d));return[4,Promise.all(u)];case 3:if(p=v.sent(),l.images=p.slice(0),l.ready=!0,a(e/r.length,s),i(),this._viewer.isUninitialized())return[2];if(this._viewer.isPaused())return[2];e++,v.label=4;case 4:return o=t.next(),[3,2];case 5:return[3,8];case 6:return f=v.sent(),m={error:f},[3,8];case 7:try{o&&!o.done&&(_=t.return)&&_.call(t)}finally{if(m)throw m.error}return[7];case 8:return n(),[2]}})})},e}(),Ca=r(13),Ba=r(56),La=r.n(Ba);var Fa=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},Va=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Ua=function(e){return Fa(void 0,void 0,void 0,function(){var t,r,i;return Va(this,function(n){switch(n.label){case 0:return[4,Object(Ca.a)().query({query:La.a,variables:{assetId:e}})];case 1:if(t=n.sent(),r=t.data,i=t.errors,!r.asset)throw Error("asset does not exist");if(i)throw Error(i[0].message);return[2,function(e){if(!e.downloadUrls)throw Error("get download url for "+e.name+" failed");return{id:e.id,name:e.name,status:e.status,type:e.type,downloadUrl:e.downloadUrls[0].url,convertedUrls:e.convertedUrls?e.convertedUrls.map(function(e){return{filename:e.filename,url:e.url}}):null,panoConvertedUrl:e.panoConvertedUrl?e.panoConvertedUrl:null,updatedAt:e.updatedAt}}(r.asset)]}})})},za=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ja=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},Ga=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};var qa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return za(t,e),t.prototype.loadPanos=function(e,t){return ja(this,void 0,void 0,function(){var r,i,n,a,o,s,l=this;return Ga(this,function(u){switch(u.label){case 0:return!function(e){return"object"==typeof e&&null!==e}(t)?r=t:(r=t.onProgress,i=t.onIndicatorsUpdate,n=t.resolution),r||(r=function(){}),e.indicators||(e.indicators=[]),e.annotations||(e.annotations=[]),[4,Promise.all(e.panoIds.map(function(e){return Ua(e)}))];case 1:return(a=u.sent()).forEach(function(e){if(!e.panoConvertedUrl)throw Error("asset "+e.id+" is not a panorama image")}),[4,Promise.all(a.map(function(e){return Y.a.get(e.panoConvertedUrl)}))];case 2:return o=u.sent(),s={},o.forEach(function(e,t){var r=[],i=e.data,o=Object.keys(i);o.forEach(function(e){if(e.startsWith("1024_left")?r.push(1024):e.startsWith("2048_left")?r.push(2048):e.startsWith("4096_left")&&r.push(4096),!r.length)throw Error("asset "+a[t].id+" image urls error");if(n&&!r.includes(n))throw Error("resolution not valid");n||(n=r[r.length-1]),s[a[t].id]={imageUrls:o.filter(function(e){return e.startsWith(n+"")}).map(function(e){return i[e]}),images:[],name:a[t].name,ready:!1,toAssets:[],type:"cubemaps"}})}),e.indicators.forEach(function(e,t){s[e.from].toAssets.push({id:"indicator-"+t,type:"panorama",assetId:e.to,camera:e.camera,position:e.position,fromAsset:e.from})}),e.annotations.forEach(function(e,t){s[e.from].toAssets.push({id:"annotation-"+t,type:"annotation",fromAsset:e.from,position:e.position})}),this.getEventEmitter().on("updatePanoramaIndicator",function(t){i&&i(t.map(function(t,r){return t.annotation?{position:t.screenPosition,visible:t.visible,annotation:t.annotation}:{from:e.indicators[r].from,to:t.assetId,camera:e.indicators[r].camera,position:t.screenPosition,visible:t.visible,name:t.name||s[t.assetId].name}}))}),[2,new Promise(function(t,i){l._load360(s,e.panoIds,t,i,r)})]}})})},t.prototype.loadPano=function(e,t){return ja(this,void 0,void 0,function(){return Ga(this,function(r){return[2,this.loadPanos({panoIds:[e],indicators:[],annotations:[]},t)]})})},t.prototype._load360=function(e,t,r,n,a){var o=this;this._data=e,new Ra(this._data,this).load(null,{},t,function(){var e=t[0];o._data[e].ready&&(o._currentAssetId=t[0],o._leftSkyboxes[0].setImage(o._data[e].images)),o.state=i.RENDERING},function(){o.invalidate(),r()},function(e,t){a(e,t)}).catch(function(e){n(e)})},t.prototype.detectIndicator=function(e,t){if(void 0===t&&(t=.607),U.d.set(this._viewDirection,-e.viewMatrix[2],-e.viewMatrix[6],-e.viewMatrix[10]),this._data[this._currentAssetId]){for(var r=[],i=0;i<this._data[this._currentAssetId].toAssets.length;i++)if(this._data[this._currentAssetId].ready){var n=this._data[this._currentAssetId].toAssets[i],a=U.d.clone(n.position);U.d.normalize(a,a);var o=U.d.dot(a,this._viewDirection),s=e.project(n.position);"panorama"===n.type?r.push({assetId:n.assetId,name:this._data[n.assetId].name,screenPosition:[s[0],s[1]],visible:!!(o>t&&s[2])}):r.push({annotation:n,screenPosition:[s[0],s[1]],visible:!!(o>t&&s[2])})}this._eventEmitter.emit("updatePanoramaIndicator",r)}},t}(Na),Qa=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ha=function(e){function t(t){var r=e.call(this,t,t.getMaterialManager())||this;return r.cores.push(new It(t.getResourceManager(),t.getMaterialManager())),r}return Qa(t,e),t.prototype.addPawnViewport=function(e,t){var r=this;this.cores[e].addPawn(t),t.drawables.forEach(function(t){r._viewer._renderScenes[e].addDrawable(t)}),this._viewer.invalidate()},t.prototype.addModelViewport=function(e,t){var r=this;this.cores[e].addModel(t),t.drawables.forEach(function(t){r._viewer._renderScenes[e].addDrawable(t)}),this._viewer.invalidate()},t}(Ct),Wa=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ya=function(e){function t(t){var r=e.call(this,t)||this;return r._horizontal=!0,r._percentage=.5,r._viewports=new Array(2),r._viewports[0]=new Uint32Array(4),r._viewports[1]=new Uint32Array(4),r.cores.push(new Yt(r._scene.cores[1],r._viewports[1])),r._updateViewports(),r}return Wa(t,e),t.prototype.destroy=function(){this._viewports=null,delete this._viewports,e.prototype.destroy.call(this)},t.prototype.setSplitPercentage=function(e){this._percentage=e,this._updateViewports()},t.prototype.setSplitHorizontal=function(e){this._horizontal=e,this._updateViewports()},t.prototype.setFov=function(e){this.cores[0].setTargetFov(e),this.cores[1].setTargetFov(e),this._viewer&&this._viewer.invalidate()},t.prototype.resize=function(e,t){this._updateViewports(),this.cores[0].setViewport(this._viewports[0]),this.cores[0].update(),this.cores[1].setViewport(this._viewports[1]),this.cores[1].update()},t.prototype.update=function(){var e=this.cores[0].update(),t=this.cores[1].update();return e||t},t.prototype.addInput=function(t){e.prototype.addInput.call(this,t),this._manipulator||(this._manipulator=new nr(this._viewer)),this._manipulator.setCamera(this.cores),this._manipulator.addInput(t)},t.prototype.transformToPerspective=function(){this.cores[0].transformOrthogonalToPerspective(),this.cores[1].transformOrthogonalToPerspective(),this._viewer&&this._viewer.invalidate()},t.prototype.transformToOrthogonal=function(){this.cores[0].transformPerspectiveToOrthogonal(),this.cores[1].transformPerspectiveToOrthogonal(),this._viewer&&this._viewer.invalidate()},t.prototype._updateViewports=function(){var e=this._viewer.getCanvas().width,t=this._viewer.getCanvas().height;this._horizontal?(this._viewports[0][0]=0,this._viewports[0][1]=0,this._viewports[0][2]=Math.round(e*this._percentage),this._viewports[0][3]=t,this._viewports[1][0]=this._viewports[0][2],this._viewports[1][1]=0,this._viewports[1][2]=Math.round(e*(1-this._percentage)),this._viewports[1][3]=t):(this._viewports[0][0]=0,this._viewports[0][1]=0,this._viewports[0][2]=e,this._viewports[0][3]=Math.round(t*this._percentage),this._viewports[1][0]=0,this._viewports[1][1]=this._viewports[0][3],this._viewports[1][2]=e,this._viewports[1][3]=Math.round(t*(1-this._percentage))),this.cores[0].setViewport(this._viewports[0]),this.cores[1].setViewport(this._viewports[1])},t}(or),Xa=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Za=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},Ka=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};var Ja=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._scene=new Ha(i),i._camera=new Ya(i),i._renderScenes=[],i._renderScenes.push(new Ai(i._scene.cores[0],i._camera.cores[0],i._resourceManager,i._renderer)),i._renderScenes.push(new Ai(i._scene.cores[1],i._camera.cores[1],i._resourceManager,i._renderer)),i._renderScenes[0].setScissorEnabled(!0),i._renderScenes[1].setScissorEnabled(!0),i._material=i._materialManager.createMaterialOverride("select-elements-other"),i._material.setUseTransparent(!1),i._update(!0),i}return Xa(t,e),t.prototype.destroy=function(){this._renderScenes[0].destroy(),this._renderScenes[1].destroy(),this._renderScenes=null,delete this._renderScenes,this._camera.destroy(),this._camera=null,delete this._camera,e.prototype.destroy.call(this)},t.prototype.resize=function(t,r){this._paused||(e.prototype.resize.call(this,t,r),this.invalidate())},t.prototype.loadModelAtViewport=function(e,t,r){return Za(this,void 0,void 0,function(){var i,n,a,o;return Ka(this,function(s){return((t=t||0)<0||t>1)&&console.error("Invalid viewport index. Maximum 2 viewports are supported."),function(e){return"object"==typeof e&&null!==e}(r)?(i=r.onProgress,o=void 0===i?function(){}:i,n=r.initialTransform,a=void 0===n?[]:n,[2,this._loadToViewport(e,t,a,o)]):(o=r||function(){},[2,this._loadToViewport(e,t,[],o)])})})},t.prototype._loadToViewport=function(e,t,r,n){return Za(this,void 0,void 0,function(){var a,o,s,l=this;return Ka(this,function(u){return r&&0!==r.length||(r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),a=new ma(e,r,this._resourceManager,this._materialManager),o=this,s=this._renderScenes[t],[2,a.load(e,s,n,!1,null,function(){o._scene.addModelViewport(t,a)},function(){o.hasProfileLines()&&o.setRenderingLinesEnabled(!1),o.hasCurveOrLine()&&o.setRenderingLinesEnabled(!0),s.onSceneChanged(-1),s.optimize();var e=function(){o._camera.core.setCullingEnabled(!0),o._camera.core.removeUpdateStopListener(e)};o._camera.core.addUpdateStopListener(e)},function(e){for(var t=e["model.bin"].nodes,r=0,i=0,n=e.buffers.length;i<n;i++)r+=e.buffers[i].byteLength;o._scene.core.nodes=t,o._scene.core.meshKbytes=Math.round(r/1024*100)/100,o._scene.core.initBimCullingNeeded()},function(e){o.invalidate(),o._renderScene.refresh(),o._camera.core._updateProjection()}).then(function(){return l.state=i.RENDERING,l._elapsedFrames=1,l._renderScenes[t].optimize(),l._camera.cores[t].setCullingEnabled(!0),Promise.resolve(e)})]})})},t.prototype._update=function(e){void 0===e&&(e=!1),!e&&this.state!==i.RENDERING||void 0===this._renderScenes||(this._camera.update()&&(this._renderScenes[0].refreshRendering(1),this._renderScenes[1].refreshRendering(1)),this._renderer.beginFrame(),this._renderer.invalidate(),this._renderScenes[0].draw(),this._renderer.invalidate(),this._renderScenes[1].draw(),this._renderer.present(this._renderScene.getRenderTarget().getFramebuffer()),this._renderer.endFrame(),this._elapsedFrames++)},t.prototype.focusElementsInViewport=function(e,t,r,i){this._renderScenes[e].setOverridedMaterials({all:this._material}),this._material.setDiffuse([1,1,1]),this._material.setTransparent(.4),this._renderScenes[e].renderElements(t,i,!1),r&&this.focusElements(t)},t}(kn),$a=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),eo=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},to=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},ro=function(e){function t(t,r){return e.call(this,t,r)||this}return $a(t,e),t.prototype.loadModel=function(t,r,i,n,a){return eo(this,void 0,void 0,function(){var o=this;return to(this,function(s){return[2,e.prototype.loadModel.call(this,t,r,i,n,a).then(function(e){o.setBackgroundColor([26/255,26/255,55/255,1]);var t=o._resourceManager.getShader("dark",[]);if(!t.ready){var r=N.a.dark;t.createFromShaderSource(r,[])}return o._renderScene.setOverridedShaders(t),o.setEffectEnabled("Sketch",!0),o.setEffectParameter("Sketch","color",[81/255,185/255,1]),o.setEffectParameter("Sketch","colored",!1),o.setEffectParameter("Sketch","surfaceColor",[.2,145/255,1,.2]),o.setEffectParameter("Sketch","transparents",!0),o.setEffectParameter("Sketch","useDepthMask",!1),o.setSpecularEnabled(!0),o.setEffectEnabled("SSAO",!0),o.setEffectParameter("SSAO","transparents",!0),Promise.resolve(e)})]})})},t}(ba),io=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),no=function(e){function t(t,r){var i=e.call(this,t,null,null,null,null)||this;i._resourceManager=r;var n=r.getShader("gizmo2d",[]);n.ready||n.createFromShaderSource(N.a.constant2d,[]);var a=new ur("");return a.attachShader(n,i._resourceManager),i.shader=n,i.material=a,i._textured=!1,i}return io(t,e),t.prototype.destroy=function(){this._textured=null,delete this._textured,this._resourceManager=null,delete this._resourceManager,e.prototype.destroy.call(this)},t.prototype.setColor=function(e){this._textured&&(this.shader=this._resourceManager.getShader("gizmo2d",[]),this.shader.ready||this.shader.createFromShaderSource(N.a.constant2d,[]),this.material.attachShader(this.shader),this._textured=!1),this.material.parameters.uColor.value=e},t.prototype.setTransparent=function(e){console.warn("not supported yet."),this._textured&&(this.shader=this._resourceManager.getShader("gizmo2d",[]),this.shader.ready||this.shader.createFromShaderSource(N.a.constant2d,[]),this.material.attachShader(this.shader),this._textured=!1)},t.prototype.setTexture=function(e){this._textured||(this.shader=this._resourceManager.getShader("blit",["MODEL_TRANSFORM"]),this.shader.ready||this.shader.createFromShaderSource(N.a.blit,["MODEL_TRANSFORM"]),this.material.attachShader(this.shader),this._textured=!0),this.material.setTexture(e)},t}(I.a),ao=function(){function e(e,t,r,i){this._dashed=i,this._lineWidth=Math.floor(3*s.a.devicePixelRatio);var n=t.getMesh("line_mesh_"+e);if(n.createQuad(!1),this._drawable=new no(n,t),this._drawable.setColor(r),this._dashed){this._vertices=new Float32Array(240),this._indices=new Uint8Array(120);for(var a=0;a<20;++a)this._indices[0+6*a]=0+4*a,this._indices[1+6*a]=1+4*a,this._indices[2+6*a]=2+4*a,this._indices[3+6*a]=2+4*a,this._indices[4+6*a]=3+4*a,this._indices[5+6*a]=0+4*a}else this._vertices=new Float32Array(12),this._indices=new Uint8Array(6),this._indices[0]=0,this._indices[1]=1,this._indices[2]=2,this._indices[3]=2,this._indices[4]=3,this._indices[5]=0;for(a=0;a<this._vertices.length;++a)this._vertices[a]=-1e6;this._drawable.mesh.update(this._vertices,this._indices,X.a.UNSIGNED_BYTE)}return e.prototype.render=function(e,t,r){t.drawDrawable(e,this._drawable,r,null,null,null,!1)},e.prototype._addQuad=function(e,t,r,i,n,a,o){var s=r-e,l=i-t,u=Math.atan2(s,l),c=Math.sign(s*l)||1,h=Math.sin(u)*this._lineWidth*.5/o*c,d=Math.cos(u)*this._lineWidth*.5/a*c;e=e/a*2-1,r=r/a*2-1,t=t/o*2-1,i=i/o*2-1,this._vertices[0+n]=e-d,this._vertices[1+n]=t+h,this._vertices[3+n]=e+d,this._vertices[4+n]=t-h,this._vertices[6+n]=r+d,this._vertices[7+n]=i-h,this._vertices[9+n]=r-d,this._vertices[10+n]=i+h,this._vertices[2+n]=0,this._vertices[5+n]=0,this._vertices[8+n]=0,this._vertices[11+n]=0},e.prototype.updateVertices=function(e,t,r,i,n,a){var o=e,l=r,u=t,c=i;o*=s.a.devicePixelRatio,u=a-1-u*s.a.devicePixelRatio;var h=(l*=s.a.devicePixelRatio)-o,d=(c=a-1-c*s.a.devicePixelRatio)-u;if(this._dashed)for(var p=0;p<20;p++){var f=o+h/39*2*p,m=u+d/39*2*p,_=f+h/39,v=m+d/39;this._addQuad(f,m,_,v,12*p,n,a)}else this._addQuad(o,u,l,c,0,n,a);this._drawable.mesh.update(this._vertices,this._indices,X.a.UNSIGNED_BYTE)},e.prototype.setLineWidth=function(e){this._lineWidth=Math.floor(Math.min(e,1)*s.a.devicePixelRatio)},e.prototype.destroy=function(){this._drawable.destroy(),this._vertices=null,this._indices=null},e}();function oo(e){void 0===e&&(e="#6092e2");var t=document.createElement("div");return t.style.width="16px",t.style.width="16px",t.style.height="16px",t.style.borderRadius="100%",t.style.pointerEvents="none",t.style.backgroundColor=e,t.style.position="absolute",t.style.top="-8px",t.style.left="-10px",t.style.transform="translate(0, 0)",t.style.borderWidth="3px",t.style.display="none",t.style.borderColor=e,t}function so(e,t){t?(e.style.display="block",e.style.transform="translate("+t.pos[0]+"px, "+t.pos[1]+"px)","boolean"==typeof t.isSnapped&&(t.isSnapped?(e.style.backgroundColor="transparent",e.style.border="3px solid #f75223"):e.style.backgroundColor="#f75223")):e.style.display="none"}function lo(e){void 0===e&&(e="red");var t=document.createElement("div");return t.style.fontSize="14px",t.style.lineHeight="14px",t.style.height="14px",t.style.width="60px",t.style.pointerEvents="none",t.style.position="absolute",t.style.color=e,t.style.transformOrigin="center",t.style.left="0",t.style.top="-7px",t.style.padding="0 10px",t}function uo(e,t){t?(t.pos?(e.style.display="block",e.style.transform="translate("+t.pos[0]+"px, "+t.pos[1]+"px)"):e.style.display="none",t.value&&(e.innerText=t.value),t.color&&(e.style.color=t.color)):e.style.display="none"}var co,ho=function(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2,(e[2]+t[2])/2]},po=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),fo=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},mo=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(fo(arguments[t]));return e},_o=function(e){function t(t,r){var i=e.call(this,t,!0,r)||this;i._rtLine=null,i._rtLinePR=null,i._vertices=[],i._lines=[],i._subLines=[],i._snapCoord=[0,0],i._depthQuery=new Kt.a(i._scene,i._resourceManager),i._rtLine=i._getRenderTarget({depthTest:!1}),i._rtLinePR=i._getRenderTargetPR({depthTest:!1}),i._clippingEnabled=i._scene.clipping.isEnabled(),i._snappingEnabled=!s.a.isMobile,i._snapping=null,i._lineColor=[.969,.398,.238],i._clicks=0,i._finished=!1,i._smartCullingEnabled=!1,i._unit="feet",i._scaling=1,i._lastEventName="",i._lastEventObject=null,i._lastAnchorUpdates=[],i._preventEffect=!0;r.getCanvas();return i._overlays=function(){var e=document.createElement("div");return e.style.position="relative",e.style.left="0px",e.style.top="-100%",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="none",e.style.overflow="hidden",e}(),i._mouseAnchor=oo("#f75223"),i._anchorPoints=[oo(),oo(),oo()],i._anchorValues=[lo(),lo(),lo()],i._overlays.appendChild(i._mouseAnchor),i}return po(t,e),t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupport3D=function(e){return!0},t.prototype.destroy=function(){this._rtLine=null,delete this._rtLine,this._rtLinePR=null,delete this._rtLine;for(var e=0;e<this._lines.length;e++)this._lines[e].destroy();this._lines=null,delete this._lines;for(e=0;e<this._subLines.length;e++)this._subLines[e].destroy();this._subLines=null,delete this._subLines,this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery,this._vertices=null,delete this._vertices,this._overlays.remove(),this._overlays=null,delete this._overlays,this._anchorPoints=null,delete this._anchorPoints,this._anchorValues=null,delete this._anchorValues,this._mouseAnchor=null,delete this._mouseAnchor,this._lastEventObject=null,delete this._lastEventObject,this._lastAnchorUpdates=null,delete this._lastAnchorUpdates},t.prototype.resize=function(e,t){this._snapping&&this._snapping.resize(e,t)},t.prototype._reset=function(){this._needUpdate=!0;for(var e=0;e<this._lines.length;e++)this._lines[e]._drawable.mesh.destroy(),this._lines[e].destroy();this._lines=[],this._vertices=[],this._clicks=0,this._finished=!1,this._notifyResult("Measure-Update",{distance:0,x:0,y:0,z:0,angle:0,area:0})},t.prototype._recompileShader=function(){if(this._scene.clipping.isEnabled()!==this._clippingEnabled){this._clippingEnabled=this._scene.clipping.isEnabled();var e=[];tr.a.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this._depthQuery.recompileShader(this._resourceManager,e),this._snapping&&this._snapping.recompileShader(this._resourceManager,e)}},t.prototype._updateMouseAnchor=function(e){this._needUpdate=!0,so(this._mouseAnchor,e)},t.prototype._hideMouseAnchor=function(){this._needUpdate=!0,so(this._mouseAnchor,null)},t.prototype._updateAnchorPoints=function(e){if(void 0===e&&(e=[]),this._needUpdate=!0,e.length>this._anchorPoints.length){var t=oo();this._overlays.appendChild(t),this._anchorPoints.push(t)}this._anchorPoints.forEach(function(t,r){e[r]?so(t,{pos:e[r]}):so(t,null)})},t.prototype._hideAnchorPoints=function(){this._needUpdate=!0,this._anchorPoints.forEach(function(e){so(e,null)})},t.prototype._updateAnchorValues=function(e){void 0===e&&(e=[]),this._needUpdate=!0,this._anchorValues.forEach(function(t,r){e[r]&&uo(t,e[r])});var t=e.filter(function(e){return!!e.value}).map(function(e){return{value:e.value}});t.length>0&&(this._lastAnchorUpdates=t)},t.prototype._hideAnchorValues=function(){this._needUpdate=!0,this._anchorValues.forEach(function(e){uo(e,null)})},t.prototype._updateSnapping=function(){this._needUpdate=!0,this._snapping&&this._snapping.update(this._renderer,this._scene,this._camera)},t.prototype._projectLineSegmentToScreen=function(e,t,r,i){var n=this._camera.getViewDirection(),a=-U.d.dot(n,this._camera.eye);U.d.copy(r,e),U.d.copy(i,t);var o=U.d.dot(r,n)+a,s=U.d.dot(i,n)+a,l=U.d.create();if(o>0||s>0){if(o<0){U.d.subtract(l,r,i);var u=(.001-a-U.d.dot(i,n))/U.d.dot(l,n);U.d.scaleAndAdd(r,i,l,u)}if(s<0){U.d.subtract(l,i,r);u=(.001-a-U.d.dot(r,n))/U.d.dot(l,n);U.d.scaleAndAdd(i,r,l,u)}var c=this._camera.project(r);r[0]=c[0],r[1]=c[1];var h=this._camera.project(i);return i[0]=h[0],i[1]=h[1],!0}return!1},t.prototype.setSnappingEnabled=function(e){e&&s.a.isMobile?console.warn("Sanpping is not support on mobile."):(this._snappingEnabled=e,this._needUpdate=!0)},t.prototype._onEnableChanged=function(){var e=this;if(!this._enabled)return this._camera.removeUpdateStopListener(this._updateSnapping.bind(this)),this._reset(),this._viewer.setSmartCullingEnabled(this._smartCullingEnabled),this._overlays.remove(),void mo(this._anchorPoints,this._anchorValues).forEach(function(e){e.remove()});this._snapping=s.a.isMobile?null:this._viewer.getSnapping(),this._camera.addUpdateStopListener(this._updateSnapping.bind(this)),this._recompileShader(),this._camera.setBimCullingEnabled(!1),this._updateSnapping(),this._smartCullingEnabled=this._viewer.isSmartCullingEnabled(),this._viewer.setSmartCullingEnabled(!1),this._viewer.getCanvas().insertAdjacentElement("afterend",this._overlays),mo(this._anchorPoints,this._anchorValues).forEach(function(t){e._overlays.appendChild(t)})},t.prototype.setLineColor=function(e){this._lineColor[0]=e[0],this._lineColor[1]=e[1],this._lineColor[2]=e[2]},t.prototype.addInput=function(e){switch(e.name){case"mouse":return this._registerMouseEvents(e);case"touch":return this._registerTouchEvents(e);case"keyboard":return this._registerKeyboardEvents(e)}},t.prototype._registerMouseEvents=function(e){var t=this;e.addMouseDownListener(function(e){return t._onMouseDown(e)},this.name),e.addMouseWheelListener(function(e){return t._onMouseWheel(e)},this.name),e.addMouseMoveListener(function(e){return t._onMouseMove(e)},this.name),e.addMouseUpListener(function(e){return t._onMouseUp(e)},this.name)},t.prototype._registerTouchEvents=function(e){var t=this;e.addTouchMoveListener(function(e){return t._onTouchMove(e)},this.name),e.addTouchStopListener(function(e){return t._onTouchStop(e)},this.name),e.addTouchStartListener(function(e){return t._onTouchStart(e)},this.name)},t.prototype._registerKeyboardEvents=function(e){var t=this;e.addKeyUpListener(function(e){return t._onKeyUp(e)},this.name)},t.prototype.setUnit=function(e){var t=this,r=e!==this._unit,i=this._scaling;switch(e){case"m":this._unit="m",this._scaling=.3048;break;case"cm":this._unit="cm",this._scaling=30.48;break;case"feet":this._unit="feet",this._scaling=1;break;case"inches":this._unit="inches",this._scaling=12;break;default:console.log('Unsupported length unit! Please use either "feet", "inches", "cm" or "m"')}if(r&&""!==this._lastEventName){var n=this._scaling/i,a=this._lastEventObject;a.distance&&(a.distance*=n,a.distance=a.distance.toFixed(2)),a.x&&(a.x*=n,a.x=a.x.toFixed(2)),a.y&&(a.y*=n,a.y=a.y.toFixed(2)),a.z&&(a.z*=n,a.z=a.z.toFixed(2)),this._viewer.getEventEmitter().emit(this._lastEventName,a),this._anchorValues.forEach(function(e,r){if(t._lastAnchorUpdates[r]){var i=t._lastAnchorUpdates[r];i.value&&(i.value*=n,i.value=i.value.toFixed(2)),uo(e,i)}})}},t.prototype.getUnit=function(){return this._unit},t.prototype._convertArea=function(e){return e*(this._scaling*this._scaling)},t.prototype._convertLength=function(e){return e*this._scaling},t.prototype._onKeyUp=function(e){return!1},t.prototype._onMouseDown=function(e){return!!this._enabled&&(this._recompileShader(),!0)},t.prototype._onMouseWheel=function(e){return this._enabled,!1},t.prototype._onMouseMove=function(e){return!1},t.prototype._onMouseUp=function(e){return!1},t.prototype._onTouchStart=function(e){return!1},t.prototype._onTouchMove=function(e){return!1},t.prototype._onTouchStop=function(e){return!1},t.prototype._notifyResult=function(e,t){this._viewer.getEventEmitter().emit(e,t),this._lastEventName=e,this._lastEventObject=t},t}(Zt.a),vo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),yo=[0,0],go=[0,0],bo=function(e){function t(t){var r=e.call(this,"MeasureLine",t)||this;return r._perimeter=0,r}return vo(t,e),t.prototype.destory=function(){e.prototype.destroy.call(this)},t.prototype.setEnabled=function(t){e.prototype.setEnabled.call(this,t)},t.prototype.getPerimeter=function(){return this._perimeter},t.prototype._onMouseWheel=function(e){return!!this._enabled&&(this._clicks%2==1&&U.d.copy(this._vertices[1],this._vertices[0]),this._hideMouseAnchor(),!1)},t.prototype._onMouseMove=function(t){if(!this._enabled)return!1;if(e.prototype._onMouseMove.call(this,t),t.pressed)return this._clicks%2==1&&U.d.copy(this._vertices[1],this._vertices[0]),this._hideMouseAnchor(),!1;if(t.moved){var r=t.x,i=t.y;if(this._snappingEnabled){if(this._snapCoord[0]=r,this._snapCoord[1]=i,!t.pressed&&!this._camera.updated){var n=this._snapping.snap(this._snapCoord);this._updateMouseAnchor({pos:this._snapCoord,isSnapped:n!==an.NONE})}r=this._snapCoord[0],i=this._snapCoord[1]}if(this._clicks%2==1){var a=this._camera.unproject(r,i);this._vertices.length>0&&U.d.copy(this._vertices[1],a)}this._needUpdate=!!(this._clicks%2)}return!0},t.prototype._onMouseUp=function(t){if(!this._enabled||t.moved)return!1;if(e.prototype._onMouseUp.call(this,t),this._needUpdate=!0,t.button===t.RIGHT_BUTTON)return this._perimeter=0,this._reset(),!1;0===this._clicks&&this._viewer.getEventEmitter().emit("rulerupdate",{distance:0,x:0,y:0,z:0}),this._clicks++;var r=t.x,i=t.y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLine(r,i,n),!0):t.button===t.LEFT_BUTTON?(this._perimeter=0,this._reset(),!1):(this._clicks--,!1)},t.prototype._updateLine=function(e,t,r){if(this._clicks%2==0){U.d.copy(this._vertices[1],r),this._vertices[2][0]=this._vertices[0][0],this._vertices[2][1]=this._vertices[0][1],this._vertices[2][2]=this._vertices[1][2],this._vertices[3][0]=this._vertices[0][0],this._vertices[3][1]=this._vertices[1][1],this._vertices[3][2]=this._vertices[1][2],this._perimeter=U.d.distance(this._vertices[0],this._vertices[1]);var i=this._convertLength(this._vertices[1][0]-this._vertices[0][0]),n=this._convertLength(this._vertices[1][1]-this._vertices[0][1]),a=this._convertLength(this._vertices[1][2]-this._vertices[0][2]);this._notifyResult("Measure-Update",{distance:this._convertLength(this._perimeter),x:Math.abs(i),y:Math.abs(n),z:Math.abs(a)}),this._updateAnchorValues([{value:i,color:"red"},{value:n,color:"limegreen"},{value:a,color:"blue"}].map(function(e){return{value:Math.abs(e.value).toFixed(2),color:e.color}}))}else{this._vertices=[];for(var o=0;o<4;o++)this._vertices[o]=U.d.clone(r);this._lines[0]=new ao("line_0",this._resourceManager,this._lineColor,!1),this._lines[1]=new ao("line_1",this._resourceManager,[0,0,1],!0),this._lines[2]=new ao("line_2",this._resourceManager,[0,1,0],!0),this._lines[3]=new ao("line_3",this._resourceManager,[1,0,0],!0),this._notifyResult("Measure-Update",{distance:0,x:0,y:0,z:0})}},t.prototype._onTouchStop=function(t){if(!this._enabled||1!==t.numCursors)return!1;if(e.prototype._onTouchStop.call(this,t),Math.abs(t.cursor(0).dx)>1e-4||Math.abs(t.cursor(0).dy)>1e-4)return!1;this._clicks++;var r=t.cursor(0).x,i=t.cursor(0).y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLine(r,i,n),!0):(this._clicks--,!1)},t.prototype._render=function(){if(0===this._vertices.length)return this._hideAnchorPoints(),void this._hideAnchorValues();this._projectLineSegmentToScreen(this._vertices[0],this._vertices[1],yo,go)&&(this._lines[0].updateVertices(yo[0],yo[1],go[0],go[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[0].render(this._rtLine,this._renderer,this._camera)),this._clicks%2==0&&(this._projectLineSegmentToScreen(this._vertices[0],this._vertices[2],yo,go)&&(this._lines[1].updateVertices(yo[0],yo[1],go[0],go[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[1].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[2],this._vertices[3],yo,go)&&(this._lines[2].updateVertices(yo[0],yo[1],go[0],go[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[2].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[3],this._vertices[1],yo,go)&&(this._lines[3].updateVertices(yo[0],yo[1],go[0],go[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[3].render(this._rtLine,this._renderer,this._camera)));for(var e=[],t=this._clicks%2==0?this._vertices.length:1,r=0;r<t;++r)e.push(this._camera.project(this._vertices[r]));this._updateAnchorPoints([e[0],e[1]]),4===e.length?this._updateAnchorValues([{pos:ho(e[1],e[3])},{pos:ho(e[2],e[3])},{pos:ho(e[2],e[0])}]):this._hideAnchorValues()},t.prototype._renderProgressively=function(){if(0===this._vertices.length)return this._hideAnchorPoints(),void this._hideAnchorValues();this._projectLineSegmentToScreen(this._vertices[0],this._vertices[1],yo,go)&&(this._lines[0].updateVertices(yo[0],yo[1],go[0],go[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[0].render(this._rtLinePR,this._renderer,this._camera)),this._clicks%2||(this._projectLineSegmentToScreen(this._vertices[0],this._vertices[2],yo,go)&&(this._lines[1].updateVertices(yo[0],yo[1],go[0],go[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[1].render(this._rtLinePR,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[2],this._vertices[3],yo,go)&&(this._lines[2].updateVertices(yo[0],yo[1],go[0],go[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[2].render(this._rtLinePR,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[3],this._vertices[1],yo,go)&&(this._lines[3].updateVertices(yo[0],yo[1],go[0],go[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[3].render(this._rtLinePR,this._renderer,this._camera)))},t}(_o),wo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),xo=[0,0],Mo=[0,0],To=function(e){function t(t){var r=e.call(this,"MeasureLines",t)||this;return r._perimeter=0,r}return wo(t,e),t.prototype.destory=function(){e.prototype.destroy.call(this)},t.prototype.setEnabled=function(t){e.prototype.setEnabled.call(this,t)},t.prototype.getPerimeter=function(){return this._perimeter},t.prototype._onKeyUp=function(e){if(!this._enabled||this._finished)return!1;"Escape"!==e.key&&"Enter"!==e.key||(this._clicks%2==1&&(this._vertices.pop(),this._lines.pop()),this._finished=!0)},t.prototype._onMouseWheel=function(e){return!!this._enabled&&(this._finished||this._clicks%2==1&&U.d.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1)},t.prototype._onMouseMove=function(t){if(!this._enabled)return!1;if(e.prototype._onMouseMove.call(this,t),t.pressed)return this._finished||this._clicks%2==1&&U.d.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1;if(t.moved){var r=t.x,i=t.y;if(this._snappingEnabled){if(this._snapCoord[0]=r,this._snapCoord[1]=i,!t.pressed&&!this._camera.updated){var n=this._snapping.snap(this._snapCoord);this._finished?this._hideMouseAnchor():this._updateMouseAnchor({pos:this._snapCoord,isSnapped:n!==an.NONE})}r=this._snapCoord[0],i=this._snapCoord[1]}if(this._clicks%2==1){var a=this._camera.unproject(r,i);this._vertices.length>0&&!this._finished&&U.d.copy(this._vertices[this._vertices.length-1],a)}}return this._viewer.invalidate(),!0},t.prototype._onMouseUp=function(t){if(!this._enabled||t.moved)return!1;if(e.prototype._onMouseUp.call(this,t),t.button===t.RIGHT_BUTTON)return this._perimeter=0,this._reset(),!1;this._finished&&this._reset(),this._clicks++;var r=t.x,i=t.y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks--,!1)},t.prototype._onTouchStop=function(t){if(!this._enabled||1!==t.numCursors)return!1;if(e.prototype._onTouchStop.call(this,t),Math.abs(t.cursor(0).dx)>1e-4||Math.abs(t.cursor(0).dy)>1e-4)return!1;this._finished&&this._reset(),this._clicks++;var r=t.cursor(0).x,i=t.cursor(0).y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks--,!1)},t.prototype._updateLines=function(e,t,r){if(this._clicks%2==0){U.d.copy(this._vertices[this._vertices.length-1],r),this._perimeter=0;for(var i=0;i<this._vertices.length;i+=2)this._perimeter+=U.d.distance(this._vertices[i],this._vertices[i+1]);var n=this._convertLength(this._perimeter);this._notifyResult("Measure-Update",{distance:n}),this._updateAnchorValues([{value:n.toFixed(2),color:"red"}])}else this._vertices.push(U.d.clone(r)),this._vertices.push(U.d.clone(r)),this._lines.push(new ao("measure-lines-"+this._lines.length,this._resourceManager,this._lineColor,!1))},t.prototype._render=function(){for(var e=0;e<this._lines.length;e++){var t=this._vertices[2*e],r=this._vertices[2*e+1];this._projectLineSegmentToScreen(t,r,xo,Mo)&&(this._lines[e].updateVertices(xo[0],xo[1],Mo[0],Mo[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[e].render(this._rtLine,this._renderer,this._camera))}var i=[];for(e=0;e<this._vertices.length;++e)i.push(this._camera.project(this._vertices[e]));this._finished||this._clicks%2!=1||i.pop(),this._updateAnchorPoints(i),i.length>0&&i.length%2==0?this._updateAnchorValues([{pos:ho(i[i.length-2],i[i.length-1])}]):this._hideAnchorValues()},t}(_o),Eo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),So=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},Ao=[0,0],ko=[0,0],Po=function(e){function t(t){var r=e.call(this,"MeasureLineFan",t)||this;return r._perimeter=0,r}return Eo(t,e),t.prototype.destory=function(){e.prototype.destroy.call(this)},t.prototype.setEnabled=function(t){e.prototype.setEnabled.call(this,t)},t.prototype.getPerimeter=function(){return this._perimeter},t.prototype._onKeyUp=function(e){if(!this._enabled||this._finished)return!1;"Escape"!==e.key&&"Enter"!==e.key||(U.d.copy(this._vertices[2],this._vertices[0]),this._finished=!0)},t.prototype._onMouseWheel=function(e){return!!this._enabled&&(this._clicks>0&&U.d.copy(this._vertices[2],this._vertices[0]),this._hideMouseAnchor(),!1)},t.prototype._onMouseMove=function(t){if(!this._enabled)return!1;if(e.prototype._onMouseMove.call(this,t),t.pressed)return this._clicks>0&&U.d.copy(this._vertices[2],this._vertices[0]),this._hideMouseAnchor(),!1;if(t.moved){var r=t.x,i=t.y;if(this._snappingEnabled){if(this._snapCoord[0]=r,this._snapCoord[1]=i,!t.pressed&&!this._camera.updated){var n=this._snapping.snap(this._snapCoord);this._finished?this._hideMouseAnchor():this._updateMouseAnchor({pos:this._snapCoord,isSnapped:n!==an.NONE})}r=this._snapCoord[0],i=this._snapCoord[1]}var a=this._camera.unproject(r,i);this._vertices.length>0&&!this._finished&&U.d.copy(this._vertices[2],a)}return this._viewer.invalidate(),!0},t.prototype._onMouseUp=function(t){if(!this._enabled||t.moved)return!1;if(e.prototype._onMouseUp.call(this,t),t.button===t.RIGHT_BUTTON)return this._perimeter=0,this._reset(),!1;this._finished&&this._reset(),this._clicks++;var r=t.x,i=t.y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks--,!1)},t.prototype._onTouchStop=function(t){if(!this._enabled||1!==t.numCursors)return!1;if(e.prototype._onTouchStop.call(this,t),Math.abs(t.cursor(0).dx)>1e-4||Math.abs(t.cursor(0).dy)>1e-4)return!1;this._finished&&this._reset(),this._clicks++;var r=t.cursor(0).x,i=t.cursor(0).y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks--,!1)},t.prototype._updateLines=function(e,t,r){var i=this;if(1===this._clicks){for(var n=0;n<5;n++)this._vertices.push(U.d.clone(r));this._lines[0]=new ao("measure-linefan-0",this._resourceManager,this._lineColor,!1),this._lines[1]=new ao("measure-linefan-1",this._resourceManager,this._lineColor,!1),this._lines[2]=new ao("measure-linefan-x",this._resourceManager,[0,0,1],!0),this._lines[3]=new ao("measure-linefan-y",this._resourceManager,[0,1,0],!0),this._lines[4]=new ao("measure-linefan-z",this._resourceManager,[1,0,0],!0)}else{U.d.copy(this._vertices[1],r),U.d.copy(this._vertices[2],r),this._vertices[3][0]=this._vertices[0][0],this._vertices[3][1]=this._vertices[0][1],this._vertices[3][2]=this._vertices[1][2],this._vertices[4][0]=this._vertices[0][0],this._vertices[4][1]=this._vertices[1][1],this._vertices[4][2]=this._vertices[1][2],this._perimeter=U.d.distance(this._vertices[0],this._vertices[1]);this._vertices[1][0],this._vertices[0][0];var a=this._vertices[1][1]-this._vertices[0][1],o=this._vertices[1][2]-this._vertices[0][2],s=So([o,a,o].map(function(e){return i._convertLength(e)}),3),l=s[0],u=s[1],c=s[2];this._notifyResult("Measure-Update",{x:l,y:u,z:c,distance:this._convertLength(this._perimeter)}),this._updateAnchorValues([{value:l,color:"red"},{value:u,color:"limegreen"},{value:c,color:"blue"}].map(function(e){return{value:Math.abs(e.value).toFixed(2),color:e.color}}))}},t.prototype._render=function(){if(0===this._vertices.length)return this._hideAnchorPoints(),void this._hideAnchorValues();this._projectLineSegmentToScreen(this._vertices[0],this._vertices[1],Ao,ko)&&(this._lines[0].updateVertices(Ao[0],Ao[1],ko[0],ko[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[0].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[0],this._vertices[2],Ao,ko)&&(this._lines[1].updateVertices(Ao[0],Ao[1],ko[0],ko[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[1].render(this._rtLine,this._renderer,this._camera)),this._clicks>1&&(this._projectLineSegmentToScreen(this._vertices[0],this._vertices[3],Ao,ko)&&(this._lines[2].updateVertices(Ao[0],Ao[1],ko[0],ko[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[2].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[3],this._vertices[4],Ao,ko)&&(this._lines[3].updateVertices(Ao[0],Ao[1],ko[0],ko[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[3].render(this._rtLine,this._renderer,this._camera)),this._projectLineSegmentToScreen(this._vertices[4],this._vertices[1],Ao,ko)&&(this._lines[4].updateVertices(Ao[0],Ao[1],ko[0],ko[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[4].render(this._rtLine,this._renderer,this._camera)));for(var e=[],t=this._clicks>1?this._vertices.length:1,r=0;r<t;++r)2!==r&&e.push(this._camera.project(this._vertices[r]));this._updateAnchorPoints([e[0],e[1]]),4===e.length&&this._updateAnchorValues([{pos:ho(e[1],e[3])},{pos:ho(e[2],e[3])},{pos:ho(e[2],e[0])}])},t}(_o),No=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Do=[0,0],Io=[0,0],Oo=function(e){function t(t){var r=e.call(this,"MeasureLineStrip",t)||this;return r._perimeter=0,r}return No(t,e),t.prototype.destory=function(){e.prototype.destroy.call(this)},t.prototype.setEnabled=function(t){e.prototype.setEnabled.call(this,t)},t.prototype.getPerimeter=function(){return this._perimeter},t.prototype._onKeyUp=function(e){if(!this._enabled||this._finished)return!1;"Escape"!==e.key&&"Enter"!==e.key||(this._vertices.pop(),this._lines.pop(),this._finished=!0)},t.prototype._onMouseWheel=function(e){return!!this._enabled&&(this._finished||this._clicks>0&&U.d.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1)},t.prototype._onMouseMove=function(t){if(!this._enabled)return!1;if(e.prototype._onMouseMove.call(this,t),t.pressed)return this._finished||this._clicks>0&&U.d.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1;if(t.moved){var r=t.x,i=t.y;if(this._snappingEnabled){if(this._snapCoord[0]=r,this._snapCoord[1]=i,!t.pressed&&!this._camera.updated){var n=this._snapping.snap(this._snapCoord);this._finished?this._hideMouseAnchor():this._updateMouseAnchor({pos:this._snapCoord,isSnapped:n!==an.NONE})}r=this._snapCoord[0],i=this._snapCoord[1]}var a=this._camera.unproject(r,i);this._vertices.length>0&&!this._finished&&U.d.copy(this._vertices[this._vertices.length-1],a)}return this._viewer.invalidate(),!0},t.prototype._onMouseUp=function(t){if(!this._enabled||t.moved)return!1;if(e.prototype._onMouseUp.call(this,t),t.button===t.RIGHT_BUTTON)return this._perimeter=0,this._reset(),!1;this._finished&&this._reset(),this._clicks++;var r=t.x,i=t.y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks--,!1)},t.prototype._onTouchStop=function(t){if(!this._enabled||1!==t.numCursors)return!1;if(e.prototype._onTouchStop.call(this,t),Math.abs(t.cursor(0).dx)>1e-4||Math.abs(t.cursor(0).dy)>1e-4)return!1;this._finished&&this._reset(),this._clicks++;var r=t.cursor(0).x,i=t.cursor(0).y;this._snappingEnabled&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks--,!1)},t.prototype._updateLines=function(e,t,r){if(this._lines.push(new ao("measure-linestrip-"+this._lines.length,this._resourceManager,this._lineColor,!1)),1===this._clicks)this._vertices.push(U.d.clone(r)),this._vertices.push(U.d.clone(r));else{U.d.copy(this._vertices[this._vertices.length-1],r),this._vertices.push(U.d.clone(r)),this._perimeter=0;for(var i=0;i<this._vertices.length-1;i++)this._perimeter+=U.d.distance(this._vertices[i],this._vertices[i+1]);var n=this._convertLength(this._perimeter);this._notifyResult("Measure-Update",{distance:n}),this._updateAnchorValues([{value:n.toFixed(2),color:"red"}])}},t.prototype._render=function(){for(var e=0;e<this._lines.length;e++){var t=this._vertices[e],r=this._vertices[e+1];this._projectLineSegmentToScreen(t,r,Do,Io)&&(this._lines[e].updateVertices(Do[0],Do[1],Io[0],Io[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[e].render(this._rtLine,this._renderer,this._camera))}var i=[];for(e=0;e<this._vertices.length;++e)i.push(this._camera.project(this._vertices[e]));this._finished||i.pop(),this._updateAnchorPoints(i),i.length>=2?this._updateAnchorValues([{pos:ho(i[i.length-2],i[i.length-1])}]):this._hideAnchorValues()},t}(_o),Ro=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Co=[0,0],Bo=[0,0],Lo=function(e){function t(t){var r=e.call(this,"MeasureAngle",t)||this;return r._angle=0,r._radians=!1,r}return Ro(t,e),t.prototype.destory=function(){e.prototype.destroy.call(this)},t.prototype._onMouseWheel=function(e){return!!this._enabled&&(this._clicks>0&&3!==this._clicks&&U.d.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1)},t.prototype.getAngle=function(){return this._angle},t.prototype._onMouseMove=function(t){if(!this._enabled)return!1;if(e.prototype._onMouseMove.call(this,t),t.pressed)return this._clicks>0&&3!==this._clicks&&U.d.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1;if(t.moved){var r=t.x,i=t.y;if(this._snappingEnabled){if(this._snapCoord[0]=r,this._snapCoord[1]=i,!t.pressed&&!this._camera.updated){var n=this._snapping.snap(this._snapCoord);this._updateMouseAnchor({pos:this._snapCoord,isSnapped:n!==an.NONE})}r=this._snapCoord[0],i=this._snapCoord[1]}var a=this._camera.unproject(r,i);this._vertices.length>0&&this._clicks<3&&U.d.copy(this._vertices[this._vertices.length-1],a)}return this._viewer.invalidate(),!0},t.prototype._onMouseUp=function(t){if(!this._enabled||t.moved)return!1;if(e.prototype._onMouseUp.call(this,t),t.button===t.RIGHT_BUTTON)return this._angle=0,this._reset(),!1;var r=this._clicks;this._clicks=this._clicks%3+1;var i=t.x,n=t.y;this._snappingEnabled&&(i=this._snapCoord[0],n=this._snapCoord[1]);var a=this._depthQuery.unproject(i,n,this._renderer,this._camera);return a?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,a),this._updateLines(i,n,a),!0):(this._clicks=r,!1)},t.prototype._onTouchStop=function(t){if(!this._enabled||1!==t.numCursors)return!1;if(Math.abs(t.cursor(0).dx)>1e-4||Math.abs(t.cursor(0).dy)>1e-4)return!1;e.prototype._onTouchStop.call(this,t);var r=this._clicks;this._clicks=this._clicks%3+1;var i=t.cursor(0).x,n=t.cursor(0).y;this._snappingEnabled&&(i=this._snapCoord[0],n=this._snapCoord[1]);var a=this._depthQuery.unproject(i,n,this._renderer,this._camera);return a?(this._snappingEnabled&&!this._camera.updated&&this._snapping.snap(this._snapCoord,a),this._updateLines(i,n,a),!0):(this._clicks=r,!1)},t.prototype._updateLines=function(e,t,r){if(1===this._clicks)this._reset(),this._vertices.push(U.d.clone(r)),this._vertices.push(U.d.clone(r)),this._lines.push(new ao("measure-angle-"+this._lines.length,this._resourceManager,this._lineColor,!1)),this._clicks=1,this._viewer.getEventEmitter().emit("Measure-Update",{angle:0});else if(U.d.copy(this._vertices[this._vertices.length-1],r),this._vertices.length<3&&(this._vertices.push(U.d.clone(r)),this._lines.push(new ao("measure-angle-"+this._lines.length,this._resourceManager,this._lineColor,!1))),3===this._clicks){var i=U.d.create(),n=U.d.create();U.d.sub(i,this._vertices[0],this._vertices[1]),U.d.sub(n,this._vertices[2],this._vertices[1]),this._angle=U.d.angle(i,n);var a=this._radians?this._angle:this._angle/Math.PI*180;this._viewer.getEventEmitter().emit("Measure-Update",{angle:a}),this._updateAnchorValues([{value:a.toFixed(2)+(this._radians?"":"°"),color:"red"}]);var o=U.d.length(i),s=U.d.length(n),l=Math.min(o,s);U.d.lerp(i,this._vertices[1],this._vertices[0],.1*l/o),U.d.lerp(n,this._vertices[1],this._vertices[2],.1*l/s),this._vertices.push(n),this._vertices.push(i),this._lines.push(new ao("measure-angle-"+this._lines.length,this._resourceManager,this._lineColor,!1)),this._lines.push(new ao("measure-angle-"+this._lines.length,this._resourceManager,this._lineColor,!1))}},t.prototype._render=function(){for(var e=0;e<this._lines.length;e++){var t=this._vertices[e],r=this._vertices[e+1];this._projectLineSegmentToScreen(t,r,Co,Bo)&&(this._lines[e].updateVertices(Co[0],Co[1],Bo[0],Bo[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[e].render(this._rtLine,this._renderer,this._camera))}var i=[],n=this._vertices.length-1;3===this._clicks&&(n=3);for(e=0;e<n;++e)i.push(this._camera.project(this._vertices[e]));this._updateAnchorPoints(i),3===i.length?this._updateAnchorValues([{pos:ho(Co,Bo)}]):this._hideAnchorValues()},t.prototype.useRadians=function(e){if(this._radians!==e){var t=e?this._angle:this._angle/Math.PI*180;this._updateAnchorValues([{value:t.toFixed(2)+(this._radians?"":"°"),color:"red"}]),this._viewer.getEventEmitter().emit("Measure-Update",{angle:t})}this._radians=e},t.prototype.isRadians=function(){return this._radians},t}(_o),Fo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Vo=[0,0],Uo=[0,0],zo=function(e){function t(t){var r=e.call(this,"MeasureArea",t)||this;return r._area=0,r._subLines.push(new ao("area_subline_0",r._resourceManager,r._lineColor,!0)),r._subLines.push(new ao("area_subline_1",r._resourceManager,r._lineColor,!0)),r}return Fo(t,e),t.prototype.setEnabled=function(t){e.prototype.setEnabled.call(this,t)},t.prototype._onKeyUp=function(e){if(!this._enabled||this._finished)return!1;"Escape"!==e.key&&"Enter"!==e.key||(this._vertices.pop(),this._finished=!0)},t.prototype._onMouseWheel=function(e){return!!this._enabled&&(this._finished||this._clicks>0&&U.d.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1)},t.prototype._onMouseMove=function(t){if(!this._enabled)return!1;if(e.prototype._onMouseMove.call(this,t),t.pressed)return this._finished||this._clicks>0&&U.d.copy(this._vertices[this._vertices.length-1],this._vertices[this._vertices.length-2]),this._hideMouseAnchor(),!1;if(t.moved){var r=t.x,i=t.y;if(this._snapping){if(this._snapCoord[0]=r,this._snapCoord[1]=i,!t.pressed&&!this._camera.updated){var n=this._snapping.snap(this._snapCoord);this._finished?this._hideMouseAnchor():this._updateMouseAnchor({pos:this._snapCoord,isSnapped:n!==an.NONE})}r=this._snapCoord[0],i=this._snapCoord[1]}var a=this._camera.unproject(r,i);this._vertices.length>0&&!this._finished&&U.d.copy(this._vertices[this._vertices.length-1],a)}return!0},t.prototype._onMouseUp=function(t){if(!this._enabled||t.moved)return!1;if(e.prototype._onMouseUp.call(this,t),t.button===t.RIGHT_BUTTON)return this._reset(),!1;this._finished&&this._reset(),this._clicks++;var r=t.x,i=t.y;this._snapping&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snapping&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks--,!1)},t.prototype._onTouchStop=function(t){if(!this._enabled||1!==t.numCursors)return!1;if(e.prototype._onTouchStop.call(this,t),Math.abs(t.cursor(0).dx)>1e-4||Math.abs(t.cursor(0).dy)>1e-4)return!1;this._finished&&this._reset(),this._clicks++;var r=t.cursor(0).x,i=t.cursor(0).y;this._snapping&&(r=this._snapCoord[0],i=this._snapCoord[1]);var n=this._depthQuery.unproject(r,i,this._renderer,this._camera);return n?(this._snapping&&!this._camera.updated&&this._snapping.snap(this._snapCoord,n),this._updateLines(r,i,n),!0):(this._clicks--,!1)},t.prototype._updateLines=function(e,t,r){if(1===this._clicks?this._vertices.push(U.d.clone(r)):U.d.copy(this._vertices[this._vertices.length-1],r),this._vertices.push(U.d.clone(r)),this._lines.push(new ao("measure-area-"+this._lines.length,this._resourceManager,this._lineColor,!1)),this._lines.length>=3){var i=this._lines.length,n=U.d.create(),a=U.d.create(),o=U.d.create(),s=U.d.create(),l=U.d.create();U.d.sub(n,this._vertices[1],this._vertices[0]),U.d.sub(a,this._vertices[2],this._vertices[1]),U.d.cross(l,n,a),U.d.normalize(l,l);for(var u=0;u<i;u++)U.d.sub(n,this._vertices[(u+1)%i],this._vertices[u%i]),U.d.sub(a,this._vertices[(u+2)%i],this._vertices[(u+1)%i]),U.d.cross(o,n,a),U.d.add(s,s,o);this._area=Math.abs(.5*U.d.dot(l,s));var c=this._convertArea(this._area);this._notifyResult("Measure-Update",{area:c}),this._updateAnchorValues([{value:c.toFixed(2),color:"red"}])}},t.prototype._render=function(){if(this._clicks<1)return this._hideAnchorPoints(),void this._hideAnchorValues();for(var e=this._lines.length,t=Math.max(e,2),r=0;r<e;r++){var i=this._vertices[r%t],n=this._vertices[(r+1)%t];this._projectLineSegmentToScreen(i,n,Vo,Uo)&&(this._lines[r].updateVertices(Vo[0],Vo[1],Uo[0],Uo[1],this._viewer.getWidth(),this._viewer.getHeight()),this._lines[r].render(this._rtLine,this._renderer,this._camera))}if(this._clicks>1&&!this._finished){n=this._vertices[this._vertices.length-1],i=this._vertices[0];this._projectLineSegmentToScreen(i,n,Vo,Uo)&&(this._subLines[0].updateVertices(Vo[0],Vo[1],Uo[0],Uo[1],this._viewer.getWidth(),this._viewer.getHeight()),this._subLines[0].render(this._rtLine,this._renderer,this._camera)),i=this._vertices[this._vertices.length-2],this._projectLineSegmentToScreen(i,n,Vo,Uo)&&(this._subLines[1].updateVertices(Vo[0],Vo[1],Uo[0],Uo[1],this._viewer.getWidth(),this._viewer.getHeight()),this._subLines[1].render(this._rtLine,this._renderer,this._camera))}var a=[0,0,0],o=[],s=this._finished?this._vertices.length:this._vertices.length-1;for(r=0;r<this._vertices.length;++r)a[0]+=this._vertices[r][0],a[1]+=this._vertices[r][1],a[2]+=this._vertices[r][2],o.push(this._camera.project(this._vertices[r]));a[0]/=s,a[1]/=s,a[2]/=s,this._updateAnchorPoints(o.slice(0,o.length-1)),this._updateAnchorValues([{pos:this._camera.project(a)}])},t.prototype.setUnit=function(e){var t=this,r=e!==this._unit,i=this._scaling;switch(e){case"m":this._unit="m",this._scaling=.3048;break;case"cm":this._unit="cm",this._scaling=30.48;break;case"feet":this._unit="feet",this._scaling=1;break;case"inches":this._unit="inches",this._scaling=12;break;default:console.log('Unsupported length unit! Please use either "feet", "inches", "cm" or "m"')}if(r&&""!==this._lastEventName){var n=this._scaling/i,a=this._lastEventObject;a.area&&(a.area*=n*n,a.area=a.area.toFixed(2)),this._viewer.getEventEmitter().emit(this._lastEventName,a),this._anchorValues.forEach(function(e,r){if(t._lastAnchorUpdates[r]){var i=t._lastAnchorUpdates[r];i.value&&(i.value*=n*n,i.value=i.value.toFixed(2)),uo(e,i)}})}},t}(_o),jo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Go=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},qo=new Uint8Array([0,1,1,2,2,3,3,0,0,4,1,5,2,6,3,7,4,5,5,6,6,7,7,4]);!function(e){e[e.X_NEGATIVE=0]="X_NEGATIVE",e[e.Y_NEGATIVE=1]="Y_NEGATIVE",e[e.Z_NEGATIVE=2]="Z_NEGATIVE",e[e.X_POSITIVE=3]="X_POSITIVE",e[e.Y_POSITIVE=4]="Y_POSITIVE",e[e.Z_POSITIVE=5]="Z_POSITIVE"}(co||(co={}));var Qo,Ho=function(e){function t(t){var r=e.call(this,"Section",!0,t)||this;r._normalDepth=null,r._cube=null,r._plane=null,r._sensitivity=.005,r._smartCullingEnabled=!1,r._vertices=new Float32Array(24),r._indices=[],r._indices[0]=new Uint16Array([0,4,7,7,3,0]),r._indices[1]=new Uint16Array([0,1,5,5,4,0]),r._indices[2]=new Uint16Array([0,3,2,2,1,0]),r._indices[3]=new Uint16Array([5,1,2,2,6,5]),r._indices[4]=new Uint16Array([6,2,3,3,7,6]),r._indices[5]=new Uint16Array([4,5,6,6,7,4]),r._cubeRT=r._getRenderTarget(),r._planeRT=r._getRenderTarget({depthTest:!1,blend:!0});var i=r._resourceManager.getMesh("wiredcube");i.createWiredCube(),r._cube=new ln(i,r._resourceManager),r._cube.setColor([.2,.2,.2]),r._cube.setTransparent(1);var n=r._resourceManager.gl,a=new K;a.builtin(n.FLOAT),(i=r._resourceManager.getMesh("cliplane")).create(n.TRIANGLES,a,r._vertices,r._indices[0]),r._plane=new ln(i,r._resourceManager),r._plane.setColor([.969,.322,.137]),r._plane.setTransparent(.19),r._gizmoPlaneIndex=null,r._rotate=!1,r._rotateMatrix=U.a.create(),r._invertedRotateMatrix=U.a.create(),r._bbox=P.a.aabb.create(),r._sectionedBBox=P.a.aabb.create(),r._points=P.a.aabb.points(r._scene.clipping.getBBox());var o=r._viewer.getCamera().core,s=o.viewport[2],l=o.viewport[3];return r._normalDepth=new er(r._resourceManager,r._viewer.getRenderScene().getRenderQueueManager(),r._scene,s,l),r._preventEffect=!0,r}return jo(t,e),t.prototype.destroy=function(){this._vertices=null,this._indices=null,this._plane.destroy(),this._cube.destroy(),s.a.isMobile||this._normalDepth.destroy()},t.prototype.setSectionBox=function(e){this._sectionedBBox=e,this._updatePoints(),this.updateGeometry(),this._renderer.renderState.invalidateClip(),this._needUpdate=!0},t.prototype.getSectionBox=function(){return this._sectionedBBox},t.prototype.resize=function(e,t){this._cubeRT.resize(e,t),this._planeRT.resize(e,t),s.a.isMobile||this._normalDepth.resize(e,t)},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupport3D=function(e){return!0},t.prototype.isEnabled=function(){return this._enabled},t.prototype.updateGeometry=function(e){var t=this._resourceManager.gl;this._vertices[0]=this._points[0][0],this._vertices[1]=this._points[0][1],this._vertices[2]=this._points[0][2],this._vertices[3]=this._points[1][0],this._vertices[4]=this._points[1][1],this._vertices[5]=this._points[1][2],this._vertices[6]=this._points[2][0],this._vertices[7]=this._points[2][1],this._vertices[8]=this._points[2][2],this._vertices[9]=this._points[3][0],this._vertices[10]=this._points[3][1],this._vertices[11]=this._points[3][2],this._vertices[12]=this._points[4][0],this._vertices[13]=this._points[4][1],this._vertices[14]=this._points[4][2],this._vertices[15]=this._points[5][0],this._vertices[16]=this._points[5][1],this._vertices[17]=this._points[5][2],this._vertices[18]=this._points[6][0],this._vertices[19]=this._points[6][1],this._vertices[20]=this._points[6][2],this._vertices[21]=this._points[7][0],this._vertices[22]=this._points[7][1],this._vertices[23]=this._points[7][2],this._cube.mesh.update(this._vertices,qo,t.UNSIGNED_BYTE),e&&e.renderState.invalidateClip()},t.prototype._render=function(){var e=this._resourceManager.gl;this._renderer.drawGizmo(this._cubeRT,this._cube,this._camera,e.CCW),this._renderer.clear(this._renderer._renderTarget,e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),null!==this._gizmoPlaneIndex&&this._renderer.drawGizmo(this._planeRT,this._plane,this._camera,e.CCW)},t.prototype._renderProgressively=function(){var e=this._resourceManager.gl;this._renderer.drawGizmo(this._getRenderTargetPR(),this._cube,this._camera,e.CCW),this._renderer.clear(this._renderer._renderTarget,e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),null!==this._gizmoPlaneIndex&&this._renderer.drawGizmo(this._getRenderTargetPR({depthTest:!1,blend:!0}),this._plane,this._camera,e.CCW)},t.prototype.reset=function(e){this._rotate=!1,this._updateBBox([0,-1,0]),this._updatePoints(),this.updateGeometry(e),s.a.isMobile||this._normalDepth.dirtyAt(0),this._viewer.stateManager.onSectionChanged(this._enabled),this._viewer.getRenderScene().updateShadow(),this._needUpdate=!0},t.prototype.setClipRanges=function(e,t){if(this._scene.clipping.set(e,t),"number"==typeof t[0])this._updateBBox([0,-1,0]);else{this._updateBBox(e[5]);for(var r=0;r<this._points.length;r++)U.d.copy(this._points[r],t[r])}for(r=0;r<this._points.length;r++)U.d.transformMat4(this._points[r],this._points[r],this._rotateMatrix);P.a.aabb.createFromPoints(this._sectionedBBox,this._points),this._updatePoints(),this.updateGeometry(),this._gizmoPlaneIndex=null},t.prototype._onEnableChanged=function(){var e=this;if(this._scene.clipping.setEnabled(this._enabled),this._viewer.getRenderScene().setClippingEnabled(this._enabled),this._viewer.getRenderScene().refresh(),this._viewer.getRenderScene().onSceneChanged(-1),this._enabled){if(this._scene.clipping.initialize(this._scene.bbox),this._needUpdate=!0,this._updateBBox([0,-1,0]),this._updatePoints(),this.updateGeometry(this._renderer),this._smartCullingEnabled=this._camera.isBimCullingEnabled(),this._viewer.setSmartCullingEnabled(!1),this._normalDepth&&!this._normalDepth.isValid())for(var t in this._scene.models){this._scene.models[t].drawables.forEach(function(t){e._normalDepth.addDrawable(t)})}}else this.reset(this._renderer),this._viewer.getEventEmitter().emit("leavingSectionPlane"),this._gizmoPlaneIndex=null,this._viewer.setSmartCullingEnabled(this._smartCullingEnabled),this._scene.updateBBox(),this._camera.update();this.recompileSectionShader(),this._viewer.stateManager.onSectionChanged(this._enabled)},t.prototype.recompileSectionShader=function(){this._viewer.getRenderScene().recompileClipping(!0);var e=[];this._scene.clipping.isEnabled()&&e.push("CLIPPING"),tr.a.compressNormals&&e.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&e.push("DOUBLESIDED"),this._recompileShader(e)},t.prototype.setRotatable=function(e){this._rotate=e,e&&(this._gizmoPlaneIndex=null),this._needUpdate=!0},t.prototype.isRotatable=function(){return this._rotate},t.prototype.setInteractEnabled=function(e){this.setInteractive(e)},t.prototype.getInteractEnabled=function(){return this._interactive},t.prototype.setEnabled=function(t){e.prototype.setEnabled.call(this,t)},t.prototype.addInput=function(e){switch(e.name){case"mouse":return this._registerMouseEvents(e);case"touch":return this._registerTouchEvents(e)}},t.prototype._registerMouseEvents=function(e){var t=this;e.addMouseDownListener(function(e){return t._onMouseDown(e)},"Section"),e.addMouseWheelListener(function(e){return t._onMouseWheel(e)},"Section"),e.addMouseMoveListener(function(e){return t._onMouseMove(e)},"Section"),e.addMouseUpListener(function(e){return t._onMouseUp(e)},"Section")},t.prototype._registerTouchEvents=function(e){var t=this;e.addTouchMoveListener(function(e){return t._onTouchMove(e)},"Section"),e.addTouchStartListener(function(e){return t._onTouchStart(e)},"Section"),e.addTouchStopListener(function(e){return t._onTouchStop(e)},"Section")},t.prototype._onTouchStart=function(e){if(!this._enabled||!this._interactive||1!==e.numCursors)return!1;var t=e.cursor(0),r=t.x,i=t.y;return this._needUpdate=!0,this._focusPlane(r,i)},t.prototype._onTouchMove=function(e){if(!this._enabled||!this._interactive||1!==e.numCursors)return!1;var t=e.cursor(0);return this._renderer.renderState.invalidateClip(),this._needUpdate=!0,this._dragPlaneAlongNormal(t.dx,t.dy)},t.prototype._onTouchStop=function(e){return!(!this._enabled||!this._interactive)&&(this._gizmoPlaneIndex=null,this._needUpdate=!0,!0)},t.prototype._onMouseDown=function(e){return this._enabled&&this._interactive},t.prototype._onMouseWheel=function(e){return!!this._enabled&&(this._rotate&&this._normalDepth.dirtyAt(this._viewer.getElapsedFrames()),!1)},t.prototype._onMouseMove=function(e){if(!this._enabled)return!1;if(!this._interactive)return!1;var t=e.getEvent().buttonDown,r=e.moved,i=t&&r,n=this._rotate,a=this._viewer.getElapsedFrames();if(n&&i)return this._normalDepth.dirtyAt(a),!1;var o=!this._camera.updated,s=this._normalDepth.canUpdateAt(a);return r&&o&&s?(this._normalDepth.render(this._renderer,this._camera),!1):(this._renderer.renderState.invalidateClip(),e.pressed?this._dragPlaneAlongNormal(e.dx,e.dy):n?this._updateCube(e,[.5,.5,.5]):this._focusPlane(e.x,e.y))},t.prototype._onMouseUp=function(e){if(!this._enabled||!this._interactive)return!1;this._rotate&&!this._normalDepth.isDirty()&&(this._updateCube(e,[.2,.2,.2])&&(this._viewer.getEventEmitter().emit("Section-RotateFacePicked"),this._viewer.getEventEmitter().emit("rotateSectionFacePicked")));return this._gizmoPlaneIndex=null,this._renderer.renderState.invalidateClip(),this._viewer.setProgressiveRendering(),!0},t.prototype._cutByFaceClicked=function(){var e=U.d.create(),t=U.d.create();U.d.transformMat4(e,this._normalDepth.getNormal(),this._rotateMatrix),U.d.transformMat4(t,t,this._rotateMatrix),U.d.sub(e,e,t);for(var r=P.a.aabb.planes(this._sectionedBBox),i=0;i<6;++i)if(Math.abs(U.d.dot(e,r[i])-1)<1e-6){this._gizmoPlaneIndex=i;break}U.d.transformMat4(e,this._normalDepth.getPosition(),this._rotateMatrix),U.d.scaleAndAdd(e,e,r[this._gizmoPlaneIndex],1),this._dragPlaneAlongNormal(null,null,e[2])},t.prototype._updateCube=function(e,t){var r=this._normalDepth.getNormalDepth(Math.floor(e.x*s.a.devicePixelRatio),Math.floor(e.y*s.a.devicePixelRatio));return r&&(this._updateBBox(this._normalDepth.getNormal()),this._cube.setColor(t),this.updateGeometry(),this._scene.radius=this._scene.clipping.getRadius(),this._camera._updateProjection(),this._viewer.getRenderScene().onSceneChanged(-1)),this._needUpdate=!0,r},t.prototype.setSensitivity=function(e){this._sensitivity=e,this._needUpdate=!0},t.prototype._worldToView=function(e){var t=U.e.create();return U.e.transformMat4(t,e,this._rotateMatrix),U.e.transformMat4(t,e,this._camera.viewMatrix),t},t.prototype._dragPlaneAlongNormal=function(e,t,r){var i=this._gizmoPlaneIndex;if(null===i)return!1;var n=i%3,a=i>2?1:0,o=0===a?this._bbox[n]+.002:this._sectionedBBox[n]+.002,s=0===a?this._sectionedBBox[3+n]-.002:this._bbox[3+n]-.002,l=r;if(!r){var u=Go(this._worldToView(this._planeNormal(i)),3),c=u[0],h=u[1],d=u[2],p=h>0?1:-1,f=+e*c+-t*Math.sqrt(h*h+d*d)*p,m=this._scene.bbox[i]-this._scene.bbox[(i+3)%6];l=this._sensitivity*f*m}return this._sectionedBBox[i]=P.a.clamp(this._sectionedBBox[i]+l,o,s),this._updatePoints(),this.updateGeometry(),this._plane.mesh.update(this._vertices,this._indices[i]),this._needUpdate=!0,!0},t.prototype._planeNormal=function(e){switch(e){case co.X_POSITIVE:return this._direction(this._points[0],this._points[1]);case co.Y_POSITIVE:return this._direction(this._points[0],this._points[3]);case co.Z_POSITIVE:return this._direction(this._points[0],this._points[4]);case co.X_NEGATIVE:return this._direction(this._points[1],this._points[0]);case co.Y_NEGATIVE:return this._direction(this._points[3],this._points[0]);case co.Z_NEGATIVE:return this._direction(this._points[4],this._points[0])}},t.prototype._direction=function(e,t){var r=U.d.clone(e),i=U.d.clone(t),n=U.e.create();return U.d.sub(n,i,r),U.d.normalize(n,n),n},t.prototype._focusPlane=function(e,t){var r=U.d.create(),i=U.d.create();if(this._camera.isPerspective())U.d.copy(r,this._camera.eye),i=this._camera.unproject(e,t);else{r=this._camera.unproject(e,t);var n=this._camera.getViewDirection();U.d.add(i,r,n)}U.d.transformMat4(r,r,this._rotateMatrix),U.d.transformMat4(i,i,this._rotateMatrix);var a=[];a[0]=i[0]-r[0],a[1]=i[1]-r[1],a[2]=i[2]-r[2];var o=P.a.intersect.ray_aabb(r,a,this._sectionedBBox);if(null===o)return null!==this._gizmoPlaneIndex&&(this._viewer.notifyEventListener("leavingSectionPlane"),this._viewer.setProgressiveRendering(),this._gizmoPlaneIndex=null),!1;for(var s=P.a.aabb.planes(this._sectionedBBox),l=0;l<6;++l)if(!(Math.abs(U.d.dot(o,s[l])+s[l][3])>1e-6))return this._gizmoPlaneIndex!==l&&(this._gizmoPlaneIndex=l,this._plane.mesh.update(this._vertices,this._indices[l]),this._viewer.notifyEventListener("hoveringSectionPlane"),this._viewer.setProgressiveRendering(),!0);return!1},t.prototype._updateBBox=function(e){var t=P.a.aabb.center(this._scene.bbox),r=U.d.create();U.d.scaleAndAdd(r,t,e,this._scene.radius),Math.abs(e[2])>.9999?U.a.lookAt(this._rotateMatrix,r,t,[0,1,0]):U.a.lookAt(this._rotateMatrix,r,t,[0,0,1]),U.a.invert(this._invertedRotateMatrix,this._rotateMatrix);var i=this._scene.clipping.getBBox();if(tr.a.compressNormals){i[0]-=1e-4,i[1]-=1e-4,i[2]-=1e-4,i[3]+=1e-4,i[4]+=1e-4,i[5]+=1e-4}P.a.aabb.points2(i,this._points);for(var n=0,a=this._points.length;n<a;n++)U.d.transformMat4(this._points[n],this._points[n],this._rotateMatrix);P.a.aabb.createFromPoints(this._bbox,this._points),P.a.aabb.copy(this._sectionedBBox,this._bbox),this._updatePoints()},t.prototype._updatePoints=function(){P.a.aabb.points2(this._sectionedBBox,this._points),U.d.transformMat4(this._points[0],this._points[0],this._invertedRotateMatrix),U.d.transformMat4(this._points[1],this._points[1],this._invertedRotateMatrix),U.d.transformMat4(this._points[2],this._points[2],this._invertedRotateMatrix),U.d.transformMat4(this._points[3],this._points[3],this._invertedRotateMatrix),U.d.transformMat4(this._points[4],this._points[4],this._invertedRotateMatrix),U.d.transformMat4(this._points[5],this._points[5],this._invertedRotateMatrix),U.d.transformMat4(this._points[6],this._points[6],this._invertedRotateMatrix),U.d.transformMat4(this._points[7],this._points[7],this._invertedRotateMatrix),this._scene.clipping.update(this._points)},t.prototype._recompileShader=function(e){e.push("WORLDSPACE_NORMAL"),this._normalDepth&&this._normalDepth.recompileShader(e)},t}(Zt.a),Wo="data:image/png;base64,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",Yo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Xo=function(e){function t(t){var r=e.call(this,"MagnifyGlass",!0,t)||this;r._depthQuery=new Kt.a(r._scene,t.getResourceManager()),r._animator=new Xt.a,r._renderTarget=r._getRenderTarget({depthTest:!1}),r._lineWidth=1,r._dashLength=1;var i=r._resourceManager.getMesh("magnify");i.createQuad(),r._drawable=new no(i,r._resourceManager);var n=t.getResourceManager().gl;r._preventEffect=!0,r._resourceManager.getTexture("magnify").createFromFile(Wo,n.RGB,n.LINEAR,n.REPEAT,function(e){r._drawable.setTexture(e),r._dashLength=e.width}),r._vertices=new Float32Array(80),r._indices=new Uint8Array(24);for(var a=0;a<4;++a)r._indices[0+6*a]=0+4*a,r._indices[1+6*a]=1+4*a,r._indices[2+6*a]=2+4*a,r._indices[3+6*a]=2+4*a,r._indices[4+6*a]=3+4*a,r._indices[5+6*a]=0+4*a;return r._resetVertices(),r}return Yo(t,e),t.prototype.destroy=function(){this._animator.destroy(),this._animator=null,delete this._animator,this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery,this._drawable.destroy(),this._drawable=null,delete this._drawable,this._vertices=null,delete this._vertices,this._indices=null,delete this._indices,e.prototype.destroy.call(this)},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupport3D=function(e){return!0},t.prototype.setEnabled=function(e){this._enabled=e,this._enabled||(this._startX=0,this._startY=0,this._endX=0,this._endY=0)},t.prototype._render=function(){this._renderer.drawDrawable(this._renderTarget,this._drawable,this._camera,null,null,null,!1)},t.prototype.addInput=function(e){switch(e.name){case"mouse":return this._registerMouseEvents(e);case"touch":return this._registerTouchEvents(e)}},t.prototype._registerMouseEvents=function(e){var t=this;e.addMouseDownListener(function(e){return t._onMouseDown(e)},"MagnifyGlass"),e.addMouseMoveListener(function(e){return t._onMouseMove(e)},"MagnifyGlass"),e.addMouseUpListener(function(e){return t._onMouseUp(e)},"MagnifyGlass")},t.prototype._registerTouchEvents=function(e){var t=this;e.addTouchMoveListener(function(e){return t._onTouchMove(e)},"MagnifyGlass"),e.addTouchStartListener(function(e){return t._onTouchStart(e)},"MagnifyGlass"),e.addTouchStopListener(function(e){return t._onTouchStop(e)},"MagnifyGlass")},t.prototype._onMouseDown=function(e){return!(!this._enabled||e.button!==e.LEFT_BUTTON)&&(this._startX=e.x,this._startY=e.y,this._endX=this._startX,this._endY=this._startY,!0)},t.prototype._onMouseMove=function(e){return!(!this._enabled||e.button!==e.LEFT_BUTTON||!e.pressed)&&(this._endX+=e.dx,this._endY+=e.dy,this._updateVertices(),!0)},t.prototype._onMouseUp=function(e){return!(!this._enabled||e.button!==e.LEFT_BUTTON)&&(this._inputStop(),this._viewer.getEventEmitter().emit("MagnifyGlass-Selected"),!0)},t.prototype._onTouchStart=function(e){if(!this._enabled||1!==e.numCursors)return!1;var t=e.cursor(0);return this._startX=t.x,this._startY=t.y,this._endX=this._startX,this._endY=this._startY,!0},t.prototype._onTouchMove=function(e){if(!this._enabled||1!==e.numCursors)return!1;var t=e.cursor(0);return this._endX+=t.dx,this._endY+=t.dy,this._updateVertices(),!0},t.prototype._onTouchStop=function(e){return!(!this._enabled||1!==e.numCursors)&&(this._inputStop(),!0)},t.prototype._inputStop=function(){var e=this._renderer,t=this._viewer.getCamera().core,r=t.viewport[2],i=t.viewport[3];if(this._resetVertices(),this._startX>this._endX){var n=this._startX;this._startX=this._endX,this._endX=n}if(this._startY>this._endY){n=this._startY;this._startY=this._endY,this._endY=n}if(this._startX===this._endX||this._startY===this._endY)return this.setEnabled(!1),this._viewer.getEventEmitter().emit("magnificationSelected");var a=this._depthQuery.getNearest(this._startX,this._startY,this._endX,this._endY,e,this._camera);if(null===a)return this.setEnabled(!1),this._viewer.getEventEmitter().emit("magnificationSelected");var o=U.d.create();U.d.subtract(o,a,this._camera.eye);var s=U.d.length(o);if(s<.01*this._scene.radius)return this.setEnabled(!1),this._viewer.getEventEmitter().emit("magnificationSelected");var l=Math.max(Math.abs(this._endX-this._startX)/r,Math.abs(this._endY-this._startY)/i);if(this._camera.isPerspective()){var u={fov:this._camera._fov,theta:this._camera._theta,phi:this._camera._phi,at:[a[0],a[1],a[2]],distance:l*s};this._animator.attach(this._camera),this._animator.start(u,!1,50)}else this._camera.zoomBy(l);return this.setEnabled(!1),this._viewer.getEventEmitter().emit("magnificationSelected"),this._viewer.getRenderScene().refresh(),null},t.prototype.resize=function(t,r){this._renderTarget.resize(t,r),e.prototype.resize.call(this,t,r)},t.prototype.setLineWidth=function(e){this._lineWidth=e},t.prototype._updateVertices=function(){var e=this._startX,t=this._endX,r=this._startY,i=this._endY;this._startX>this._endX&&(e=this._endX,t=this._startX),this._startY>this._endY&&(r=this._endY,i=this._startY);var n=this._viewer.getCamera().core.viewport[3];e=Math.floor(e*s.a.devicePixelRatio),r=Math.floor(n-1-r*s.a.devicePixelRatio);var a=(t=Math.floor(t*s.a.devicePixelRatio))-e,o=r-(i=Math.floor(n-1-i*s.a.devicePixelRatio)),l=Math.floor(this._lineWidth*s.a.devicePixelRatio);this._addQuad(e,r,e+l,i,0,0,o,o,0),this._addQuad(e,r,t,r+l,0,a,a,0,20),this._addQuad(t-l,r,t,i,0,0,o,o,40),this._addQuad(e,i-l,t,i,0,a,a,0,60);var u=this._viewer.getResourceManager().gl;this._drawable.mesh.update(this._vertices,this._indices,u.UNSIGNED_BYTE),this._needUpdate=!0},t.prototype._addQuad=function(e,t,r,i,n,a,o,s,l){var u=this._viewer.getCamera().core,c=u.viewport[2],h=u.viewport[3];e=e/c*2-1,r=r/c*2-1,t=t/h*2-1,i=i/h*2-1,this._vertices[0+l]=e,this._vertices[1+l]=t,this._vertices[2+l]=0,this._vertices[3+l]=n/this._dashLength,this._vertices[4+l]=.5,this._vertices[5+l]=r,this._vertices[6+l]=t,this._vertices[7+l]=0,this._vertices[8+l]=a/this._dashLength,this._vertices[9+l]=.5,this._vertices[10+l]=r,this._vertices[11+l]=i,this._vertices[12+l]=0,this._vertices[13+l]=o/this._dashLength,this._vertices[14+l]=.5,this._vertices[15+l]=e,this._vertices[16+l]=i,this._vertices[17+l]=0,this._vertices[18+l]=s/this._dashLength,this._vertices[19+l]=.5},t.prototype._resetVertices=function(){for(var e=0;e<80;++e)this._vertices[e]=-1e6;var t=this._viewer.getResourceManager().gl;this._drawable.mesh.update(this._vertices,this._indices,t.UNSIGNED_BYTE)},t}(Zt.a),Zo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ko=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},Jo=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ko(arguments[t]));return e},$o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(e){e[e.SELECT_OUT_LINE=0]="SELECT_OUT_LINE",e[e.SELECT_HIGH_LIGHT=1]="SELECT_HIGH_LIGHT"}(Qo||(Qo={}));var es,ts,rs,is=function(e){function t(t){var r=e.call(this,"SelectElement",!0,t)||this;r._dashLength=1,r._lineWidth=1,r._elementNames=[],r._selectMode=0,r._renderScene=t.getRenderScene(),r._multiselect=!1,r._elements={},r._pickQuery=null,r._depthQuery=null,r._regionSelectEnabled=!1,r._interactive=!1,r._closeup=!0,r._highlight=!0,r._bbox=P.a.aabb.create(),r._renderScene=t.getRenderScene(),r._renderTarget=r._getRenderTarget({depthTest:!1}),r._material=r._scene.materialManager.createMaterialOverride("select-elements-other"),r._material.setUseTransparent(!1),r._overridedColor=[1,1,1,.4],r._clearselect=!0,r._clearPreState=!1,r._selectMode=Qo.SELECT_OUT_LINE,r._selectElements=[];var i=[],n=r._renderScene.getScene();if(n.clipping.isEnabled()&&i.push("CLIPPING"),n.needRenderDoubleSided()&&i.push("DOUBLESIDED"),n.compressed&&i.push("COMPRESSION"),s.a.isMobile&&i.push("ENCODE_NORMAL"),i.push("VISIBILITY"),r._shader=r._renderScene.getResourceManager().getShader("solid",i),!r._shader.ready){var a=N.a.solid;r._shader.createFromShaderSource(a,i)}r._smartCullingEnabled=!1,r._startX=-1,r._startY=-1,r._endX=-1,r._endY=-1,r._vertices=new Float32Array(80),r._indices=new Uint8Array(24);for(var o=0;o<4;++o)r._indices[0+6*o]=0+4*o,r._indices[1+6*o]=1+4*o,r._indices[2+6*o]=2+4*o,r._indices[3+6*o]=2+4*o,r._indices[4+6*o]=3+4*o,r._indices[5+6*o]=0+4*o;r._clippingEnabled=r._scene.clipping.isEnabled();var l=r._viewer.getResourceManager().gl,u=r._resourceManager.getMesh("region-select");return u.createQuad(),r._drawable=new no(u,r._resourceManager),r._drawable.setColor([.969,.398,.238]),r._resourceManager.getTexture("regionSelect").createFromFile(Wo,l.RGB,l.LINEAR,l.REPEAT,function(e){r._drawable.setTexture(e),r._dashLength=e.width}),r._resetVertices(),r}return Zo(t,e),t.prototype.destroy=function(){this._pickQuery&&(this._pickQuery.destroy(),this._pickQuery=null,delete this._pickQuery),this._depthQuery&&(this._depthQuery.destroy(),this._depthQuery=null,delete this._depthQuery),this._bbox=null,delete this._bbox,this._elements=null,delete this._elements,this._vertices=null,delete this._vertices,this._indices=null,delete this._indices,this._renderScene=null,delete this._renderScene,this._material.destroy(),this._material=null,delete this._material,e.prototype.destroy.call(this)},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupport3D=function(e){return!0},t.prototype.setSelectionRectangleColor=function(e){this._drawable.setColor(e),this._drawable.setTransparent(e[3])},t.prototype._onEnableChanged=function(){this._enabled&&(null===this._pickQuery&&(this._pickQuery=new sr.a(this._scene,this._resourceManager)),null===this._depthQuery&&(this._depthQuery=new Kt.a(this._scene,this._resourceManager)))},t.prototype._render=function(){Math.abs(this._endX-this._startX)<2||Math.abs(this._endY-this._startY)<2||this._regionSelectEnabled&&this._renderer.drawDrawable(this._renderTarget,this._drawable,this._camera,null,null,null,!1)},t.prototype.addInput=function(e){switch(e.name){case"mouse":return this._registerMouseEvents(e);case"touch":return this._registerTouchEvents(e);case"keyboard":return this._registerKeyboardEvents(e)}},t.prototype._registerMouseEvents=function(e){var t=this;e.addMouseDownListener(function(e){return t._onMouseDown(e)},"SelectElemets"),e.addMouseMoveListener(function(e){return t._onMouseMove(e)},"SelectElemets"),e.addMouseUpListener(function(e){return t._onMouseUp(e)},"SelectElemets")},t.prototype._registerTouchEvents=function(e){var t=this;e.addTouchStartListener(function(e){return t._onTouchStart(e)},"SelectElemets"),e.addTouchMoveListener(function(e){return t._onTouchMove(e)},"SelectElemets"),e.addTouchStopListener(function(e){return t._onTouchStop(e)},"SelectElemets")},t.prototype._registerKeyboardEvents=function(e){var t=this;e.addKeyDownListener(function(e){return t._onKeyDown(e)},"SelectElemets"),e.addKeyUpListener(function(e){return t._onKeyUp(e)},"SelectElemets")},t.prototype.setRegionSelectEnabled=function(e){this._regionSelectEnabled!=e&&(this._regionSelectEnabled=e,e?(this._smartCullingEnabled=this._viewer.isSmartCullingEnabled(),this._viewer.setSmartCullingEnabled(!1)):this._viewer.setSmartCullingEnabled(this._smartCullingEnabled),this._interactive=e,this._viewer.invalidate())},t.prototype.setCloseUpEnabled=function(e){this._closeup=e},t.prototype.setHighlightEnabled=function(e){this._highlight=e},t.prototype._onKeyDown=function(e){return"Control"===e.key&&this.setMultiselectEnabled(!0),!1},t.prototype._onKeyUp=function(e){return"Control"===e.key&&this.setMultiselectEnabled(!1),!1},t.prototype._onTouchStart=function(e){if(!this._enabled||Object.keys(e.cursors).length>1)return!1;if(document.activeElement.blur(),this._startX=e.cursor(0).x,this._startY=e.cursor(0).y,this._endX=this._startX,this._endY=this._startY,this._scene.clipping.isEnabled()&&!this._clippingEnabled){this._clippingEnabled=!0;var t=["VISIBILITY","CLIPPING"];tr.a.compressNormals&&t.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&t.push("DOUBLESIDED"),this.recompileShader(t)}else if(!this._scene.clipping.isEnabled()&&!this._clippingEnabled){this._clippingEnabled=!1;t=["VISIBILITY"];tr.a.compressNormals&&t.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&t.push("DOUBLESIDED"),this.recompileShader(t)}return this._regionSelectEnabled&&this._updateVertices(),!1},t.prototype._onTouchMove=function(e){return!(!this._enabled||Object.keys(e.cursors).length>1||!this._regionSelectEnabled)&&(!this._regionSelectEnabled||(this._endX+=e.cursor(0).dx,this._endY+=e.cursor(0).dy,this._updateVertices(),!0))},t.prototype._onTouchStop=function(e){if(!this._enabled||Object.keys(e.cursors).length>1||e.isDoubleClick)return!1;if(this._endX=e.cursor(0).x,this._endY=e.cursor(0).y,Math.abs(e.cursor(0).dx)<=1e-4&&Math.abs(e.cursor(0).dy)<=1e-4)this._select();else if(this._regionSelectEnabled){if(this._startX>this._endX){var t=this._startX;this._startX=this._endX,this._endX=t}if(this._startY>this._endY){t=this._startY;this._startY=this._endY,this._endY=t}this._selectRegion(),this._resetVertices(),this._viewer.getEventEmitter().emit("SelectElemets-Disabled")}return!0},t.prototype._onMouseDown=function(e){if(!this._enabled||e.button!==e.LEFT_BUTTON)return!1;if(document.activeElement.blur(),this._startX=e.x,this._startY=e.y,this._endX=this._startX,this._endY=this._startY,this._scene.clipping.isEnabled()&&!this._clippingEnabled){this._clippingEnabled=!0;var t=["VISIBILITY","CLIPPING"];tr.a.compressNormals&&t.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&t.push("DOUBLESIDED"),this.recompileShader(t)}else if(!this._scene.clipping.isEnabled()&&!this._clippingEnabled){this._clippingEnabled=!1;t=["VISIBILITY"];tr.a.compressNormals&&t.push("COMPRESSION"),this._scene.needRenderDoubleSided()&&t.push("DOUBLESIDED"),this.recompileShader(t)}return this._regionSelectEnabled&&this._updateVertices(),!0},t.prototype._onMouseMove=function(e){return!!(this._enabled&&e.button===e.LEFT_BUTTON&&e.pressed&&this._regionSelectEnabled)&&(!!this._regionSelectEnabled&&(this._endX+=e.dx,this._endY+=e.dy,this._updateVertices(),this._viewer.invalidate(),!0))},t.prototype._restorePreSelectedNodes=function(){var e=this._renderScene.getDrawablesInfluencedByCurSelectedNodes();this._viewer.getScene().core.clearNodesColor(e),this._renderScene.restorePreSelectedNodes(this._clearPreState)},t.prototype._onMouseUp=function(e){if(!this._enabled||e.button!==e.LEFT_BUTTON||e.isDoubleClick)return!1;if(this._endX=e.x,this._endY=e.y,Math.abs(this._endX-this._startX)<1||Math.abs(this._endY-this._startY)<1)this._clearselect&&this._clearPreState&&this._restorePreSelectedNodes(),this._selectMode===Qo.SELECT_OUT_LINE?this.pickElement(this._endX,this._endY,this._renderer,this._camera):this._select();else if(this._regionSelectEnabled){if(this._startX>this._endX){var t=this._startX;this._startX=this._endX,this._endX=t}if(this._startY>this._endY){t=this._startY;this._startY=this._endY,this._endY=t}this._selectRegion(),this._resetVertices(),this._viewer.getEventEmitter().emit("onRegionSelectFinished")}return!0},t.prototype.setMultiselectEnabled=function(e){this._multiselect=e},t.prototype.setClearselectEnabled=function(e){this._clearselect=e},t.prototype.recompileShader=function(e){this._enabled&&(this._pickQuery&&this._pickQuery.recompileShader(this._resourceManager,e),this._depthQuery&&this._depthQuery.recompileShader(this._resourceManager,e))},t.prototype._select=function(){var e=this._endX,t=this._endY;this._viewer.invalidate();var r=this._pickQuery.pickNodesInsideRegion(e,t,e,t,this._renderer,this._camera,this._getPickables()),i=null,n=null;if(r.length>0&&(n=(i=r[0].getElement()).model.name+"+"+i.getDocument().id+"/"+i.id,this._viewer.getEventEmitter().emit("onPointPicked",Jo(this._depthQuery.unproject(this._endX,this._endY,this._renderer,this._camera).slice(0,3)))),i)this._multiselect?this._elements[n]?delete this._elements[n]:this._elements[n]=i:(this._elements={},this._elements[n]=i,this._closeup&&this._camera.lookTo(P.a.aabb.center(i.bbox),P.a.aabb.len(i.bbox)/2)),this._highlight&&(this._highlightElements(Object.keys(this._elements)),this._viewer.invalidate());else{if(!this._clearselect)return;this._multiselect||(this._elements={},this._highlight&&(this._viewer.invalidate(),this._highlightElements(null)))}this._viewer.getEventEmitter().emit("onElementSelected",Object.keys(this._elements))},t.prototype._getPickables=function(){if(!this._pickables){var e=new gi("pickQueue",{line:!1});for(var t in this._scene.models)this._scene.models[t].drawables.forEach(function(t){e.addDrawable(t)});this._pickables=e.drawables}return this._pickables},t.prototype._selectRegion=function(){var e={};this._viewer.invalidate();var t=this._pickQuery.pickNodesInsideRegion(this._startX,this._startY,this._endX,this._endY,this._renderer,this._camera,this._getPickables());if(t.length>0){t.forEach(function(t){var r=t.getElement(),i=r.model.name+"+"+r.getDocument().id+"/"+r.id;e[i]||(e[i]=r)});var r=P.a.aabb.create();for(var i in e)t=t.concat(e[i].getNodes()),P.a.aabb.union(r,r,e[i].bbox);this._closeup&&this._camera.lookTo(P.a.aabb.center(r),P.a.aabb.len(r)/2),this._elements=e,this._highlight&&this._highlightElements(Object.keys(this._elements))}else this._elements={},this._highlight&&this._highlightElements(null);this._highlight&&this._viewer.invalidate();var n=Object.keys(this._elements);this._viewer.getEventEmitter().emit("onElementSelected",n)},t.prototype._highlightElements=function(e){e?(this._renderScene.setOverridedMaterials({all:this._material}),this._renderScene.setOverridedShaders(this._shader),this._material.setDiffuse(this._overridedColor),this._material.setTransparent(this._overridedColor[3]),this._renderScene.renderElements(e,!0,this._clearPreState)):(this._renderScene.setOverridedMaterials(null),this._renderScene.setOverridedShaders(null),this._renderScene.renderElements(null,!1,this._clearPreState))},t.prototype.pick=function(e,t){this._enabled&&(!e||0===e.length?this._resetPreviousSelections():(t&&this._focusToSelections(e),this._updateSelections(e),this._highlightSelections()))},t.prototype._resetPreviousSelections=function(){this._elements={},this._highlight&&(this._highlightElements(null),this._viewer.invalidate())},t.prototype._focusToSelections=function(e){var t=this;if(this._closeup){var r=!1;this._bbox=P.a.aabb.createFromArray([1/0,1/0,1/0,-1/0,-1/0,-1/0]),e.forEach(function(e){var i=e.split("+")[0],n=t._scene.models[i].tree.elements[e];n&&(P.a.aabb.union(t._bbox,t._bbox,n.bbox),r=!0)}),r&&this._camera.lookTo(P.a.aabb.center(this._bbox),P.a.aabb.len(this._bbox)/2)}},t.prototype._updateSelections=function(e){var t,r,i,n,a=Object.keys(this._elements),o=e.length!==a.length;if(!o)try{for(var s=$o(e),l=s.next();!l.done;l=s.next()){var u=l.value;if(!a.includes(u)){o=!0;break}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}if(!o)return!1;this._elements={};try{for(var c=$o(e),h=c.next();!h.done;h=c.next()){var d=(u=h.value).split("+")[0],p=this._scene.models[d].tree.elements[u];p&&(this._elements[u]=p)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(i)throw i.error}}return!0},t.prototype._highlightSelections=function(){this._highlight&&(this._highlightElements(Object.keys(this._elements)),this._viewer.invalidate())},t.prototype._updateVertices=function(){var e=this._startX,t=this._endX,r=this._startY,i=this._endY;this._startX>this._endX&&(e=this._endX,t=this._startX),this._startY>this._endY&&(r=this._endY,i=this._startY);var n=this._viewer.getCamera().core.viewport[3];e=Math.floor(e*s.a.devicePixelRatio),r=Math.floor(n-1-r*s.a.devicePixelRatio);var a=(t=Math.floor(t*s.a.devicePixelRatio))-e,o=r-(i=Math.floor(n-1-i*s.a.devicePixelRatio)),l=Math.floor(this._lineWidth*s.a.devicePixelRatio);this._addQuad(e,r,e+l,i,0,0,o,o,0),this._addQuad(e,r,t,r+l,0,a,a,0,20),this._addQuad(t-l,r,t,i,0,0,o,o,40),this._addQuad(e,i-l,t,i,0,a,a,0,60);var u=this._viewer.getResourceManager().gl;this._drawable.mesh.update(this._vertices,this._indices,u.UNSIGNED_BYTE)},t.prototype._addQuad=function(e,t,r,i,n,a,o,s,l){var u=this._viewer.getCamera().core.viewport[2],c=this._viewer.getCamera().core.viewport[3];e=e/u*2-1,r=r/u*2-1,t=t/c*2-1,i=i/c*2-1,this._vertices[0+l]=e,this._vertices[1+l]=t,this._vertices[2+l]=0,this._vertices[3+l]=n/this._dashLength,this._vertices[4+l]=.5,this._vertices[5+l]=r,this._vertices[6+l]=t,this._vertices[7+l]=0,this._vertices[8+l]=a/this._dashLength,this._vertices[9+l]=.5,this._vertices[10+l]=r,this._vertices[11+l]=i,this._vertices[12+l]=0,this._vertices[13+l]=o/this._dashLength,this._vertices[14+l]=.5,this._vertices[15+l]=e,this._vertices[16+l]=i,this._vertices[17+l]=0,this._vertices[18+l]=s/this._dashLength,this._vertices[19+l]=.5},t.prototype._resetVertices=function(){for(var e=0;e<80;++e)this._vertices[e]=-1e6;this._drawable.mesh.update(this._vertices,this._indices,this._viewer.getResourceManager().gl.UNSIGNED_BYTE)},t.prototype.setLineColor=function(e){this._renderScene.setNodesLineColor(e)},t.prototype.setOverridedColor=function(e){this._overridedColor[0]=e[0],this._overridedColor[1]=e[1],this._overridedColor[2]=e[2],void 0!==e[3]&&(this._overridedColor[3]=e[3])},t.prototype.setElementsColor=function(e,t){var r=this._viewer.getScene().core,i=this._renderScene.getDrawablesInfluencedByCurSelectedNodes(),n=this._renderScene.getCurSelectedNodes();r.setNodesColor(i,n,t),this._viewer.invalidate(16)},t.prototype.clearElementColor=function(){this._viewer.getScene().core.setElementsColor(this._elementNames),this._elementNames=[]},t.prototype.pickElement=function(e,t,r,i){var n,a;this._multiselect||(this._selectElements=[]);var o=this._pickQuery.pickNodesInsideRegion(e,t,e,t,r,i,this._getPickables()),s=[],l=!1;if(o.length>0){var u=o[0].getElement().name;this._viewer.getEventEmitter().emit("onPointPicked",Jo(this._depthQuery.unproject(e,t,this._renderer,this._camera).slice(0,3)));for(var c=0,h=this._selectElements.length;c<h;c++){u===(f=this._selectElements[c]).element?(this._selectElements.splice(c,1),c--,h--,l=!0):s.push(f.element)}l||(this._selectElements.push({element:u}),s.push(u)),this.pick(s,!0),this._viewer.getEventEmitter().emit("onElementSelectedDAM",this._selectElements)}else{if(!this._clearselect)return;this._selectElements=[],this.pick(null,!0),this._viewer.getEventEmitter().emit("onElementSelectedDAM",null)}this._elements={};try{for(var d=$o(this._selectElements),p=d.next();!p.done;p=d.next()){var f=p.value;this._elements[f.element]=!0}}catch(e){n={error:e}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}this._viewer.getEventEmitter().emit("onElementSelected",Object.keys(this._elements)),this._viewer.invalidate()},t.prototype.setSelectMode=function(e){this._selectMode=e},t.prototype.setClearPreState=function(e){this._clearPreState=e},t.prototype.onSceneChanged=function(){this._pickables=null,this._getPickables()},t}(Zt.a),ns=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),as=function(){return function(){this.eye=U.d.create(),this.at=U.d.create(),this.angleDiff=0}}(),os=function(e){function t(t){var r=e.call(this,"CameraNavigator",!1,t)||this;return r._rotationDuration=100,r._update=function(){if(r._animating){r._currentStep++;for(var e=r._currentStep*r._speed,t=0;t<r._keyPoints.length&&!(r._distances[t]>e);t++);if(t===r._keyPoints.length){var i=r._keyPoints[r._keyPoints.length-1];r._moveTo(i.eye,i.at),r.stop()}else{var n=(e-r._distances[t-1])/(r._distances[t]-r._distances[t-1]);U.d.lerp(r._tmpKeypoint.eye,r._keyPoints[t-1].eye,r._keyPoints[t].eye,n),U.d.rotateZ(r._tmpKeypoint.at,r._keyPoints[t-1].at,r._keyPoints[t-1].eye,r._keyPoints[t].angleDiff*n),U.d.subtract(r._tmpKeypoint.at,r._tmpKeypoint.at,r._keyPoints[t-1].eye),U.d.add(r._tmpKeypoint.at,r._tmpKeypoint.at,r._tmpKeypoint.eye),r._moveTo(r._tmpKeypoint.eye,r._tmpKeypoint.at)}}},r._keyPoints=[],r._distances=[],r._speed=.5,r._animator=new rr.a(t.getEventEmitter()),r._animating=!1,r._currentStep=0,r._tmpKeypoint=new as,r._viewer.getEventEmitter().on("before-rendering",r._update),r}return ns(t,e),t.prototype.destroy=function(){this._keyPoints=null,delete this._keyPoints,this._distances=null,delete this._distances,this._speed=null,delete this._speed,this._animator=null,delete this._animator,this._animating=null,delete this._animating,this._currentStep=null,delete this._currentStep,this._tmpKeypoint=null,delete this._tmpKeypoint,this._viewer.getEventEmitter().remove("before-rendering",this._update),e.prototype.destroy.call(this)},t.prototype.setRotationDuration=function(e){this._rotationDuration=e},t.prototype.clearKeyPoints=function(){this._keyPoints.length=0},t.prototype._reCalculateKeyPoints=function(){var e=[];this._distances.length=0;var t=this._keyPoints.length;for(t=1;t<this._keyPoints.length;t++){var r=this._keyPoints[t-1],i=this._keyPoints[t],n=U.d.distance(i.eye,r.eye);if(1==t)this._distances.push(0),this._distances.push(n),r.at=U.d.clone(i.eye),U.d.subtract(i.at,r.at,r.eye),U.d.add(i.at,i.at,i.eye),e.push(r),e.push(i);else{var a=new as;a.eye=U.d.clone(r.eye),U.d.subtract(a.at,i.eye,r.eye),U.d.add(a.at,a.eye,a.at),U.d.subtract(i.at,a.at,a.eye),U.d.add(i.at,i.at,i.eye);var o=U.d.create(),s=U.d.create();U.d.subtract(o,a.at,a.eye),U.d.subtract(s,r.at,r.eye),U.d.normalize(o,o),U.d.normalize(s,s);var l=Math.acos(U.d.dot(o,s)),u=U.d.create();U.c.cross(u,s,o),l=u[2]>=0?l:-l,a.angleDiff=l,this._distances.push(this._distances[this._distances.length-1]+Math.abs(l)*this._rotationDuration),this._distances.push(this._distances[this._distances.length-1]+n),e.push(a),e.push(i)}}this._keyPoints=e},t.prototype.addKeyPoint=function(e){var t=new as;t.eye=e,this._keyPoints.push(t)},t.prototype.setSpeed=function(e){this._speed=e},t.prototype.start=function(){this._keyPoints.length<2||(this._reCalculateKeyPoints(),this._camera.eye=U.d.clone(this._keyPoints[0].eye),this._camera._at=U.d.clone(this._keyPoints[0].at),this._animating=!0,this._currentStep=0)},t.prototype.stop=function(){this._animating=!1},t.prototype.resume=function(){this._animating=!0},t.prototype._moveTo=function(e,t){this._animator.attach(this._camera),this._animator.start(e,t),this._animator.stop()},t}(Zt.a),ss=function(){function e(e,t,r){void 0===t&&(t=[0,0,1]),this.path=e,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(var i=0;i<e.length;i++)this._curve[i]=U.d.clone(e[i]);this._useDefaultUpVector=r,this._compute(t)}return e.prototype.getCurve=function(){return this._curve},e.prototype.getTangents=function(){return this._tangents},e.prototype.getNormals=function(){return this._normals},e.prototype.getBinormals=function(){return this._binormals},e.prototype.getDistances=function(){return this._distances},e.prototype.update=function(e,t,r){for(var i=0;i<e.length;i++)this._curve[i].x=e[i].x,this._curve[i].y=e[i].y,this._curve[i].z=e[i].z;return this._useDefaultUpVector=r,this._compute(t),this},e.prototype._compute=function(e){var t=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),U.d.normalize(this._tangents[0],this._tangents[0]),this._tangents[t-1]=U.d.create(),U.d.subtract(this._tangents[t-1],this._curve[t-1],this._curve[t-2]),U.d.normalize(this._tangents[t-1],this._tangents[t-1]);var r,i,n,a=this._tangents[0],o=this._normalVector(a,e);this._normals[0]=o,U.d.normalize(this._normals[0],this._normals[0]),this._binormals[0]=U.d.create(),U.d.cross(this._binormals[0],a,this._normals[0]),U.d.normalize(this._binormals[0],this._binormals[0]),this._distances[0]=0;for(var s=U.d.create(),l=1;l<t;l++)r=this._getLastNonNullVector(l),l<t-1&&(i=this._getFirstNonNullVector(l),this._tangents[l]=U.d.create(),this._tangents[l]=i,U.d.normalize(this._tangents[l],this._tangents[l])),this._distances[l]=this._distances[l-1]+U.d.length(r),n=this._tangents[l],this._binormals[l-1],this._normals[l]=U.d.create(),U.d.cross(s,n,this._normals[l-1]),U.d.cross(this._normals[l],s,n),U.d.normalize(this._normals[l],this._normals[l]),this._binormals[l]=U.d.create(),U.d.cross(this._binormals[l],n,this._normals[l]),U.d.normalize(this._binormals[l],this._binormals[l])},e.prototype._getFirstNonNullVector=function(e){var t=1,r=U.d.create();for(U.d.subtract(r,this._curve[e+t],this._curve[e]),this._useDefaultUpVector&&(r[2]=0);0===U.d.length(r)&&e+t+1<this._curve.length;)t++,U.d.subtract(r,this._curve[e+t],this._curve[e]),this._useDefaultUpVector&&(r[2]=0);return 0===U.d.length(r)&&(r=U.d.fromValues(0,1,0)),r},e.prototype._getLastNonNullVector=function(e){var t=1,r=U.d.create();for(U.d.subtract(r,this._curve[e],this._curve[e-t]),this._useDefaultUpVector&&(r[2]=0);0===U.d.length(r)&&e>t+1;)t++,r=this._curve[e].subtract(this._curve[e-t]),this._useDefaultUpVector&&(r[2]=0);return 0===U.d.length(r)&&(r=U.d.fromValues(0,1,0)),r},e.prototype._normalVector=function(e,t){var r,i=U.d.create(),n=U.d.length(e);(0===n&&(n=1),void 0===t||null===t)?(r=Math.abs(Math.abs(e.y)/n-1)>.001?[0,-1,0]:Math.abs(Math.abs(e.x)/n-1)>.001?[1,0,0]:Math.abs(Math.abs(e.z)/n-1)>.001?[0,0,1]:U.d.create(),U.d.cross(i,e,r)):(U.d.cross(i,e,t),U.d.cross(i,i,e));return U.d.normalize(i,i),i},e}(),ls=function(){function e(e,t,r){var i=this;void 0===r&&(r=!0),this._update=function(){if(i._playing){var e=i._speed*i._frameNumber;if(e>i._distances[i._distances.length-1]){if(!i._loop)return void(i._playing=!1);e=0,i._frameNumber=0}for(var t=0;t<i._distances.length-2&&!(e>=i._distances[t]&&e<i._distances[t+1]);t++);var r=(e-i._distances[t])/(i._distances[t+1]-i._distances[t]);U.d.lerp(i._currentPosition,i._points[t],i._points[t+1],r),i._currentPoseMatrix=[i._binormals[t][0],i._binormals[t][1],i._binormals[t][2],0,i._tangents[t][0],i._tangents[t][1],i._tangents[t][2],0,i._normals[t][0],i._normals[t][1],i._normals[t][2],0,i._currentPosition[0],i._currentPosition[1],i._currentPosition[2],1];for(var n=0;n<i._pawns.length;n++)U.a.copy(i._currentMatrix,i._pawns[n].getTransformMatrix()),i._currentMatrix[12]=0,i._currentMatrix[13]=0,i._currentMatrix[14]=0,U.a.multiply(i._currentMatrix,i._currentPoseMatrix,i._currentMatrix),i._pawns[n].drawables.forEach(function(e){e.transform.set(i._currentMatrix),e.updateBBox()});i._frameNumber++}},this._useDefaultUpVector=r;var n=new ss(t,[0,0,1],r);this._points=n.getCurve(),this._normals=n.getNormals(),this._tangents=n.getTangents(),this._binormals=n.getBinormals(),this._distances=n.getDistances(),this._pawns=[],this._speed=.1,this._frameNumber=0,this._currentPoseMatrix=U.a.create(),this._currentMatrix=U.a.create(),this._playing=!1,this._currentPosition=U.d.create(),this._loop=!0,this._viewer=e,e.getEventEmitter().on("before-rendering",this._update)}return e.prototype.destroy=function(){this._useDefaultUpVector=null,delete this._useDefaultUpVector,this._points=null,delete this._points,this._normals=null,delete this._normals,this._tangents=null,delete this._tangents,this._binormals=null,delete this._binormals,this._distances=null,delete this._distances,this._pawns=null,delete this._pawns,this._speed=null,delete this._speed,this._frameNumber=null,delete this._frameNumber,this._currentPoseMatrix=null,delete this._currentPoseMatrix,this._currentMatrix=null,delete this._currentMatrix,this._playing=null,delete this._playing,this._currentPosition=null,delete this._currentPosition,this._viewer=null,delete this._viewer,this._viewer.getEventEmitter().remove("before-rendering",this._update)},e.prototype.isInteractive=function(){return!0},e.prototype.doesSupportMobile=function(e){return!0},e.prototype.addPawn=function(e){this._pawns.push(e)},e.prototype.start=function(){this._playing=!0,this._frameNumber=0},e.prototype.stop=function(){this._playing=!1},e.prototype.resume=function(){this._playing=!0},e.prototype.setSpeed=function(e){this._speed=e},e.prototype.setLoop=function(e){this._loop=e},e}(),us=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),cs={"axis-x":U.e.fromValues(1,0,0,1),"axis-y":U.e.fromValues(0,1,0,1),"axis-z":U.e.fromValues(0,0,1,1),"rotate-xy":U.e.fromValues(0,0,1,1),"rotate-yz":U.e.fromValues(1,0,0,1),"rotate-xz":U.e.fromValues(0,1,0,1),picked:U.e.fromValues(1,1,0,1)},hs=function(e){function t(t,r,i){void 0===i&&(i=1);var n=e.call(this,"TransformGizmo",!0,t)||this;if(n._useForModel=!0,n._needAdsorb=!0,n._blockRotate=!1,n._transformMatrix=U.a.create(),r){if(n._model=t.getScene().core.models[r],!n._model)return console.warn("No modelId "+r+" is found!"),n.destroy(),n;n._model.updateBBox(),n._model.isMatrixIdentity&&(n._model.drawables.forEach(function(e){e.recompileShader("MODEL_TRANSFORM",!0)}),t.invalidate()),n._transformMatrix[12]=.5*(n._model.bbox[0]+n._model.bbox[3]),n._transformMatrix[13]=.5*(n._model.bbox[1]+n._model.bbox[4]),n._transformMatrix[14]=.5*(n._model.bbox[2]+n._model.bbox[5]),n._useForModel=!0}return n._rtDefault=n._getRenderTarget({depthTest:!0}),n._rtProgressively=n._getRenderTargetPR({depthTest:!0}),n._picked=null,n._drawables=[],n._scale=.15*i,n._scaleMatrix=U.a.create(),n._tempMat=U.a.create(),n._preventEffect=!0,n._needAdsorb=!0,n._blockRotate=!1,n._keyOperation=[],n._mouseCumulative=U.c.create(),n._viewer.getEventEmitter().on("modelTransformUpdate",function(e){n._updateGizmo(e)}),n}return us(t,e),t.prototype.setModel=function(e){if(this._model=this._viewer.getScene().core.models[e],!this._model)return console.warn("No modelId "+e+" is found!"),void this.destroy();this._model.updateBBox();var t=this._model.getTransformMatrix();this._model.isMatrixIdentity&&(this._model.drawables.forEach(function(e){e.recompileShader("MODEL_TRANSFORM",!0)}),this._viewer.invalidate()),U.a.copy(this._transformMatrix,t),this._recordOperation(),this._useForModel=!0},t.prototype.setDrawable=function(e){this._model=e,e.updateBBox();var t=U.a.create();t[12]=(e.bbox[0]+e.bbox[3])/2,t[13]=(e.bbox[1]+e.bbox[4])/2,t[14]=(e.bbox[2]+e.bbox[5])/2,e.recompileShader("MODEL_TRANSFORM",!0),U.a.copy(this._transformMatrix,t),this._useForModel=!1,this._recordOperation(),this._viewer.invalidate()},t.prototype.destroy=function(){this._drawables.length>0&&(this._drawables[0].destroy(),this._drawables[1].destroy(),this._drawables[2].destroy(),this._drawables[3].destroy(),this._drawables[4].destroy(),this._drawables[5].destroy()),this._drawables=null,delete this._drawables,this._pickQuery&&(this._pickQuery.destroy(),this._pickQuery=null,delete this._pickQuery),this._model=null,delete this._model},t.prototype._onEnableChanged=function(){this._needUpdate=!0,this._enabled&&(this._drawables.length>0||(this._createGizmo(),this._pickQuery=new sr.a(this._scene,this._resourceManager)))},t.prototype._render=function(){this._enabled&&this._drawables.length&&(this._beginRenderGizmo(),this._drawGizmo(),this._endRenderGizmo())},t.prototype._renderProgressively=function(){this._enabled&&this._drawables.length&&(this._beginRenderGizmo(),this._drawGizmoProgressively(),this._endRenderGizmo())},t.prototype._beginRenderGizmo=function(){U.a.copy(this._tempMat,this._camera.vpMatrix);var e=U.d.create(),t=U.d.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]);U.d.subtract(e,this._camera._at,this._camera.eye),U.d.normalize(e,e),U.d.subtract(t,t,this._camera.eye),this._scaleMatrix[0]=this._scaleMatrix[5]=this._scaleMatrix[10]=U.d.dot(e,t),U.a.multiply(this._scaleMatrix,this._transformMatrix,this._scaleMatrix),U.a.multiply(this._camera.vpMatrix,this._camera.vpMatrix,this._scaleMatrix)},t.prototype._drawGizmo=function(){var e=this;this._renderer.clear(this._rtDefault,this._resourceManager.gl.DEPTH_BUFFER_BIT),this._drawables.forEach(function(t){return e._renderer.drawGizmo(e._rtDefault,t,e._camera)})},t.prototype._drawGizmoProgressively=function(){var e=this;this._renderer.clear(this._rtProgressively,this._resourceManager.gl.DEPTH_BUFFER_BIT),this._drawables.forEach(function(t){return e._renderer.drawGizmo(e._rtProgressively,t,e._camera)})},t.prototype._updateGizmo=function(e){if(this._model&&this._model.name===e){var t=this._model.getTransformMatrix();U.a.copy(this._transformMatrix,t),this._recordOperation()}},t.prototype._endRenderGizmo=function(){U.a.copy(this._camera.vpMatrix,this._tempMat),U.a.identity(this._scaleMatrix)},t.prototype.addInput=function(e){switch(e.name){case"mouse":return this._registerMouseEvents(e);case"touch":return this._registerTouchEvents(e);case"keyboard":return this._registerKeyboardEvents(e)}},t.prototype._registerMouseEvents=function(e){var t=this;e.addMouseDownListener(function(e){return t._onMouseDown(e)},"TransformGizmo"),e.addMouseMoveListener(function(e){return t._onMouseMove(e)},"TransformGizmo"),e.addMouseUpListener(function(e){return t._onMouseUp(e)},"TransformGizmo")},t.prototype._registerTouchEvents=function(e){var t=this;e.addTouchStartListener(function(e){return t._onTouchStart(e)},"TransformGizmo"),e.addTouchStopListener(function(e){return t._onTouchStop(e)},"TransformGizmo"),e.addTouchMoveListener(function(e){return t._onTouchMove(e)},"TransformGizmo")},t.prototype._registerKeyboardEvents=function(e){var t=this;e.addKeyDownListener(function(e){return t._onKeyDown(e)},"TransformGizmo"),e.addKeyUpListener(function(e){return t._onKeyUp(e)},"TransformGizmo")},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupport3D=function(e){return!0},t.prototype._recordOperation=function(){var e=U.a.clone(this._transformMatrix);this._keyOperation.length>=20&&this._keyOperation.shift();var t={modelId:this._model.name,matrix:e};this._keyOperation.push(t)},t.prototype._onMouseDown=function(e){return!!this._picked&&(this._mouseCumulative=U.c.create(),this._blockRotate=!1,this._recordOperation(),this._currentAxisX=U.d.fromValues(this._transformMatrix[0],this._transformMatrix[1],this._transformMatrix[2]),this._currentAxisY=U.d.fromValues(this._transformMatrix[4],this._transformMatrix[5],this._transformMatrix[6]),this._currentAxisZ=U.d.fromValues(this._transformMatrix[8],this._transformMatrix[9],this._transformMatrix[10]),this._viewer.setProgressiveRendering(0),!0)},t.prototype._onMouseUp=function(e){return!!this._picked&&(this._viewer.getScene().core.updateBBox(),this._viewer.setProgressiveRendering(16),this._viewer.notifyEventListener("TransformGizmo-End"),!0)},t.prototype._onMouseMove=function(e){return!!this._enabled&&(e.pressed?this._moveGizmo(e):this._hoverGizmo(e))},t.prototype._moveGizmo=function(e){return!!this._picked&&(this._useForModel?this._updateTransformForModel(e):this._updateTransformForDrawable(e),this._scene.updateBBox(),this._viewer.setProgressiveRendering(0),this._viewer.invalidate(16),this._viewer.notifyEventListener("TransformGizmo-Move"),!0)},t.prototype._hoverGizmo=function(e){this._beginRenderGizmo();var t=this._pickQuery.pickDrawable(e.x,e.y,this._renderer,this._camera,this._drawables);return this._endRenderGizmo(),t!==this._picked&&(t&&t.setColor(cs.picked),this._picked&&this._picked.setColor(cs[this._picked.name]),this._picked=t,this._viewer.invalidate(1),!0)},t.prototype._onTouchStart=function(e){if(!this._enabled)return!1;var t=this._pickQuery.pickDrawable(e.cursor(0).x,e.cursor(0).y,this._renderer,this._camera,this._drawables);return t!==this._picked&&(this._picked&&this._picked.setColor(cs[this._picked.name]),this._picked=t,this._picked&&(this._picked.setColor(cs.picked),this._picked&&(this._currentAxisX=U.d.fromValues(this._transformMatrix[0],this._transformMatrix[1],this._transformMatrix[2]),this._currentAxisY=U.d.fromValues(this._transformMatrix[4],this._transformMatrix[5],this._transformMatrix[6]),this._currentAxisZ=U.d.fromValues(this._transformMatrix[8],this._transformMatrix[9],this._transformMatrix[10]))),!0)},t.prototype._onTouchStop=function(e){return!!this._enabled&&(this._picked&&(this._picked.setColor(cs[this._picked.name]),this._viewer.getEventEmitter().emit("TransformGizmo-End")),this._picked=null,!0)},t.prototype._onTouchMove=function(e){return!!this._enabled&&(!(1!==e.numCursors||!this._picked)&&(this._useForModel?this._updateTransformForModel(e):this._updateTransformForDrawable(e),this._scene.updateBBox(),this._viewer.invalidate(),this._viewer.getEventEmitter().emit("TransformGizmo-Move"),!0))},t.prototype._onKeyDown=function(e){return"Control"===e.key&&(this._isCtrlDown=!0),!this._isCtrlDown||"z"!==e.key&&"Z"!==e.key||this.revokeOperation(),!1},t.prototype._onKeyUp=function(e){return"Control"===e.key&&(this._isCtrlDown=!1),!1},t.prototype._intersectPlane=function(e,t,r,i){var n=U.d.create();U.d.sub(n,t,e);var a=(i-U.d.dot(e,r))/U.d.dot(n,r),o=U.d.create();return U.d.scaleAndAdd(o,e,n,a),o},t.prototype._getTranslation=function(e,t,r,i){var n=U.d.create(),a=U.c.create(),o=U.d.create(),s=U.d.create(),l=U.a.create();l[12]=this._transformMatrix[12],l[13]=this._transformMatrix[13],l[14]=this._transformMatrix[14];var u=this._camera.project(r,l),c=this._camera.project(s,l);U.c.sub(n,e,t),a=U.c.fromValues(u[0]-c[0],u[1]-c[1]),U.c.normalize(a,a);var h=U.c.dot(n,a),d=this._camera._distance/(this._camera.viewport[2]-this._camera.viewport[0]);return U.d.scale(o,r,h*d),o},t.prototype._getRotation=function(e,t,r,i,n){t=this._camera.unproject(t[0],t[1]),e=this._camera.unproject(e[0],e[1]);var a=this._intersectPlane(this._camera.eye,e,r,i),o=this._intersectPlane(this._camera.eye,t,r,i),s=U.d.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]);if(U.d.sub(a,a,s),U.d.sub(o,o,s),0===U.d.distance(a,o))return 0;var l=Math.acos(U.d.dot(a,o)/U.d.length(a)/U.d.length(o));U.d.cross(a,o,a),l*=Math.sign(U.d.dot(a,r));var u=!1;if(this._needAdsorb&&U.c.length(this._mouseCumulative)>20){var c=U.d.create(),h=U.d.create(),d=U.d.fromValues(this._transformMatrix[0],this._transformMatrix[1],this._transformMatrix[2]),p=U.d.fromValues(this._transformMatrix[4],this._transformMatrix[5],this._transformMatrix[6]),f=U.d.fromValues(this._transformMatrix[8],this._transformMatrix[9],this._transformMatrix[10]),m=U.d.fromValues(1,0,0),_=U.d.fromValues(0,1,0),v=U.d.fromValues(0,0,1),y=void 0,g=void 0,b=void 0;switch(n){case"rotate-xy":g=U.d.angle(_,f),b=U.d.angle(m,f),y=Math.abs(g-Math.PI/2)-Math.abs(b-Math.PI/2)>0?m:_,U.d.cross(h,y,f),U.d.copy(c,d);break;case"rotate-yz":g=U.d.angle(_,d),b=U.d.angle(v,d),y=Math.abs(g-Math.PI/2)-Math.abs(b-Math.PI/2)>0?v:_,U.d.cross(h,y,d),U.d.copy(c,p);break;case"rotate-xz":g=U.d.angle(m,p),b=U.d.angle(_,p),y=Math.abs(g-Math.PI/2)-Math.abs(b-Math.PI/2)>0?_:m,U.d.cross(h,y,p),U.d.copy(c,f)}U.d.normalize(c,c);var w=U.d.angle(c,h),x=0;if(Math.abs(w)<.1&&(u=!0,x=l>0?Math.abs(w):-Math.abs(w)),Math.abs(w+Math.PI/2)<.1&&(u=!0,x=l>0?Math.abs(w+Math.PI/2):-Math.abs(w+Math.PI/2)),Math.abs(w-Math.PI/2)<.1&&(u=!0,x=l>0?Math.abs(w-Math.PI/2):-Math.abs(w-Math.PI/2)),Math.abs(Math.abs(w)-Math.PI)<.1&&(u=!0,x=l>0?Math.PI-Math.abs(w):Math.abs(w)-Math.PI),u){var M=this._blockRotate?0:x;return this._blockRotate=!0,M}}return l},t.prototype._updateTransformForModel=function(e){var t,r,i;e instanceof h?(t=U.c.fromValues(e.x,e.y),i=U.c.fromValues(e.dx,e.dy),r=U.c.fromValues(e.x-e.dx,e.y-e.dy)):(t=U.c.fromValues(e.cursor(0).x,e.cursor(0).y),i=U.c.fromValues(e.cursor(0).dx,e.cursor(0).dy),r=U.c.fromValues(e.cursor(0).x-e.cursor(0).dx,e.cursor(0).y-e.cursor(0).dy)),U.c.add(this._mouseCumulative,this._mouseCumulative,[Math.abs(i[0]),Math.abs(i[1])]);var n=[0,0,0],a=0,o=[0,0,1],s=0,l=U.d.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]);switch(this._picked.name){case"axis-x":o=this._currentAxisX,s=U.d.dot(l,this._currentAxisY)/U.d.length(this._currentAxisZ),n=this._getTranslation(t,r,o,s);break;case"axis-y":o=this._currentAxisY,s=U.d.dot(l,this._currentAxisX)/U.d.length(this._currentAxisZ),n=this._getTranslation(t,r,o,s);break;case"axis-z":o=this._currentAxisZ,s=U.d.dot(l,this._currentAxisX)/U.d.length(this._currentAxisX),n=this._getTranslation(t,r,o,s);break;case"rotate-xy":o=this._currentAxisZ,s=U.d.dot(l,o)/U.d.length(o),a=this._getRotation(t,r,o,s,"rotate-xy");break;case"rotate-yz":o=this._currentAxisX,s=U.d.dot(l,o)/U.d.length(o),a=this._getRotation(t,r,o,s,"rotate-yz");break;case"rotate-xz":o=this._currentAxisY,s=U.d.dot(l,o)/U.d.length(o),a=this._getRotation(t,r,o,s,"rotate-xz")}var u=U.d.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]),c=U.a.create();U.a.fromRotation(c,a,o);var d=U.d.create();U.d.transformMat4(d,u,c),c[12]=u[0]-d[0],c[13]=u[1]-d[1],c[14]=u[2]-d[2],U.a.multiply(this._transformMatrix,c,this._transformMatrix),this._transformMatrix[12]+=n[0],this._transformMatrix[13]+=n[1],this._transformMatrix[14]+=n[2],this._model.setTransformMatrix(this._transformMatrix),this._viewer.getRenderScene().recompileShadow();for(var p=0;p<this._cameras.length;p++)this._cameras[p]._updateProjection();var f=this._model.getTransformArray();switch(this._picked.name){case"axis-x":case"axis-y":case"axis-z":this._viewer.getEventEmitter().emit("TransformGizmo-Update",f);break;case"rotate-xy":case"rotate-yz":case"rotate-xz":this._viewer.getEventEmitter().emit("TransformGizmo-Update",f)}this._needUpdate=!0},t.prototype._updateTransformForDrawable=function(e){var t,r;e instanceof h?(t=U.c.fromValues(e.x,e.y),r=U.c.fromValues(e.x-e.dx,e.y-e.dy)):(t=U.c.fromValues(e.cursor(0).x,e.cursor(0).y),r=U.c.fromValues(e.cursor(0).x-e.cursor(0).dx,e.cursor(0).y-e.cursor(0).dy));var i=[0,0,0],n=0,a=[0,0,1],o=0,s=U.d.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]);switch(this._picked.name){case"axis-x":a=this._currentAxisX,o=U.d.dot(s,this._currentAxisY)/U.d.length(this._currentAxisZ),i=this._getTranslation(t,r,a,o);break;case"axis-y":a=this._currentAxisY,o=U.d.dot(s,this._currentAxisX)/U.d.length(this._currentAxisZ),i=this._getTranslation(t,r,a,o);break;case"axis-z":a=this._currentAxisZ,o=U.d.dot(s,this._currentAxisX)/U.d.length(this._currentAxisX),i=this._getTranslation(t,r,a,o);break;case"rotate-xy":a=this._currentAxisZ,o=U.d.dot(s,a)/U.d.length(a),n=this._getRotation(t,r,a,o,"rotate-xy");break;case"rotate-yz":a=this._currentAxisX,o=U.d.dot(s,a)/U.d.length(a),n=this._getRotation(t,r,a,o,"rotate-yz");break;case"rotate-xz":a=this._currentAxisY,o=U.d.dot(s,a)/U.d.length(a),n=this._getRotation(t,r,a,o,"rotate-xz")}var l=U.a.create();U.a.fromRotation(l,n,a);var u=U.d.fromValues(this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]),c=U.d.create();U.d.transformMat4(c,u,l),l[12]=u[0]-c[0],l[13]=u[1]-c[1],l[14]=u[2]-c[2],U.a.multiply(this._transformMatrix,l,this._transformMatrix),this._transformMatrix[12]+=i[0],this._transformMatrix[13]+=i[1],this._transformMatrix[14]+=i[2];var d=this._model.getTransformMatrix(),p=U.a.create();p[12]=-this._transformMatrix[12],p[13]=-this._transformMatrix[13],p[14]=-this._transformMatrix[14],U.a.fromRotation(l,n,a),U.a.multiply(p,l,p);var f=U.a.create();U.a.multiply(f,p,d),f[12]=this._transformMatrix[12],f[13]=this._transformMatrix[13],f[14]=this._transformMatrix[14],this._model.setTransform(f),this._viewer.getRenderScene().recompileShadow();for(var m=0;m<this._cameras.length;m++)this._cameras[m]._updateProjection();this._needUpdate=!0},t.prototype._createGizmo=function(){var e=.05*this._scale,t=this._scale,r=this._resourceManager.getMesh("transformX");r.createArrow(e,t);var i=this._resourceManager.getMesh("rotateXY");i.createArc(.5*this._scale,.05*this._scale,Math.PI/2,100),this._drawables=new Array(6),this._drawables[0]=new ln(r,this._resourceManager,new Float32Array([0,0,0,2*e,2*e,t])),this._drawables[0].transform.setRotation([0,1,0],Math.PI/2),this._drawables[0].setColor(cs["axis-x"]),this._drawables[0].setTransparent(cs["axis-x"][3]),this._drawables[0].name="axis-x",this._drawables[1]=new ln(r,this._resourceManager,new Float32Array([0,0,0,2*e,2*e,t])),this._drawables[1].transform.setRotation([1,0,0],-Math.PI/2),this._drawables[1].setColor(cs["axis-y"]),this._drawables[1].setTransparent(cs["axis-y"][3]),this._drawables[1].name="axis-y",this._drawables[2]=new ln(r,this._resourceManager,new Float32Array([0,0,0,2*e,2*e,t])),this._drawables[2].setColor(cs["axis-z"]),this._drawables[2].setTransparent(cs["axis-z"][3]),this._drawables[2].name="axis-z",this._drawables[3]=new ln(i,this._resourceManager,new Float32Array([0,0,0,t,t,t])),this._drawables[3].setColor(cs["axis-z"]),this._drawables[3].setTransparent(cs["axis-z"][3]),this._drawables[3].name="rotate-xy",this._drawables[4]=new ln(i,this._resourceManager,new Float32Array([0,0,0,t,t,t])),this._drawables[4].transform.setRotation([0,1,0],-Math.PI/2),this._drawables[4].setColor(cs["axis-x"]),this._drawables[4].setTransparent(cs["axis-x"][3]),this._drawables[4].name="rotate-yz",this._drawables[5]=new ln(i,this._resourceManager,new Float32Array([0,0,0,t,t,t])),this._drawables[5].transform.setRotation([1,0,0],Math.PI/2),this._drawables[5].setColor(cs["axis-y"]),this._drawables[5].setTransparent(cs["axis-y"][3]),this._drawables[5].name="rotate-xz"},t.prototype.translate=function(e,t,r){if(this._model){this._transformMatrix[12]=this._model.initMatrix[12]+e,this._transformMatrix[13]=this._model.initMatrix[13]+t,this._transformMatrix[14]=this._model.initMatrix[14]+r,this._model.setTransformMatrix(this._transformMatrix);for(var i=0;i<this._cameras.length;i++)this._cameras[i]._updateProjection()}},t.prototype.enabledAdsorb=function(e){this._needAdsorb=e},t.prototype.rotate=function(e,t,r){var i=[this._transformMatrix[12],this._transformMatrix[13],this._transformMatrix[14]],n=U.a.create();U.a.setFromEuler(n,e,t,r);var a=U.d.create();U.d.transformMat4(a,i,n),n[12]=i[0]-a[0],n[13]=i[1]-a[1],n[14]=i[2]-a[2];var o=U.a.create();o[12]=i[0],o[13]=i[1],o[14]=i[2],U.a.multiply(this._transformMatrix,n,o),this._model.setTransformMatrix(this._transformMatrix);for(var s=0;s<this._cameras.length;s++)this._cameras[s]._updateProjection()},t.prototype.getRotation=function(){var e=U.a.create();U.a.copy(e,this._transformMatrix);return U.a.getEuler(e)},t.prototype.getTranslation=function(){var e=[];return e[0]=this._transformMatrix[12]-this._model.initMatrix[12],e[1]=this._transformMatrix[13]-this._model.initMatrix[13],e[2]=this._transformMatrix[14]-this._model.initMatrix[14],e},t.prototype.getTransformMatrix=function(){var e=U.a.create();return U.a.copy(e,this._transformMatrix),e},t.prototype.getinitTranslation=function(){if(this._model){var e=[];return e[0]=this._model.initMatrix[12],e[1]=this._model.initMatrix[13],e[2]=this._model.initMatrix[14],e}console.warn("please use .setModel to add model")},t.prototype.getworldMatrix=function(){var e=U.a.create();return U.a.copy(e,this._transformMatrix),e},t.prototype.revokeOperation=function(){if(this._keyOperation.length>0){var e=1===this._keyOperation.length?this._keyOperation[0]:this._keyOperation.pop();U.a.copy(this._transformMatrix,e.matrix);var t=this._scene.getModel(e.modelId);this._model=t,this._model.setTransformMatrix(this._transformMatrix),this._scene.updateBBox(),this._viewer.getRenderScene().recompileShadow();for(var r=0;r<this._cameras.length;r++)this._cameras[r]._updateProjection();var i=this._model.getTransformArray();this._viewer.getEventEmitter().emit("TransformGizmo-Update",i),this._viewer.invalidate()}},t}(Zt.a),ds=r(50),ps=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),fs=[0,0],ms=[0,0,0],_s=function(e){function t(t){var r=e.call(this,"SelectModel",!1,t)||this;return r._snapping=null,r._pickQuery=null,r._snapped=-1,r.currentModel=-1,r.currentPosition=new Array(3),r}return ps(t,e),t.prototype.destroy=function(){this._snapping&&(this._snapping.destroy(),this._snapping=null,delete this._snapping),this._pickQuery&&(this._pickQuery.destroy(),this._pickQuery=null,delete this._pickQuery),this.currentModel=null,delete this.currentModel,this.currentPosition=null,delete this.currentPosition},t.prototype.addInput=function(e){switch(e.name){case"mouse":return this._registerMouseEvents(e)}},t.prototype._registerMouseEvents=function(e){var t=this;e.addMouseMoveListener(function(e){return t._onMouseMove(e)},"SelectModel"),e.addMouseUpListener(function(e){return t._onMouseUp(e)},"SelectModel")},t.prototype.doesSupportMobile=function(e){return!e},t.prototype.doesSupport3D=function(e){return!0},t.prototype._udpateSnapping=function(e){this._snapping.update(this._renderer,this._scene,this._camera)},t.prototype._render=function(){this._snapping.render(this._renderer,this._camera)},t.prototype.resize=function(e,t){this._snapping.resize(e,t)},t.prototype._setEnabled=function(e){e?(null===this._snapping&&(this._snapping=new fn(this._scene,this._camera,this._resourceManager,this._viewer.getRenderScene().getRenderQueueManager()),this._snapping.setRenderingEnabled(!0),this._snapping.setSnappingRadius(8)),null===this._pickQuery&&(this._pickQuery=new sr.a(this._scene,this._resourceManager)),this._camera.addUpdateStopListener(this._udpateSnapping.bind(this))):this._camera.removeUpdateStopListener(this._udpateSnapping.bind(this)),this._viewer.setSmartCullingEnabled(!e)},t.prototype._onMouseMove=function(e){return!!this._enabled&&(e.pressed||this._camera.updated||(fs[0]=e.x,fs[1]=e.y,this._snapped=this._snapping.snap(fs,ms),this._snapped>=0&&(this.currentPosition[0]=ms[0],this.currentPosition[1]=ms[1],this.currentPosition[2]=ms[2]),this._viewer.getEventEmitter().emit("SelectModel-SnappedTo",fs)),!1)},t.prototype._onMouseUp=function(e){return!!this._enabled&&(e.moved||(this.currentModel=-1,fs[0]=e.x,fs[1]=e.y,this._snapped<0&&(this._snapped=this._snapping.snap(fs,ms)),this._snapped>=0&&(this.currentModel=this._pickQuery.pickModel(fs[0],fs[1],this._renderer,this._camera),this._viewer.getEventEmitter().emit("SelectModel-Selected",this.currentModel,ms))),!1)},t}(Zt.a),vs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ys=function(e){function t(t,r){return e.call(this,t,r)||this}return vs(t,e),t.prototype.attachShader=function(t,r){var i=e.prototype.attachShader.call(this,t,r);if(!i)return null;for(var n in t.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uPlatte"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=5,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uData"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=6,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uRes"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uThickness"===n&&(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue));return i},t.prototype.setPlatteTexture=function(e){this.reservedParameters.m_uPlatte.value=e},t.prototype.setDataTexture=function(e){this.reservedParameters.m_uData.value=e},t.prototype.setResolution=function(e){this.reservedParameters.m_uRes.value=e},t.prototype.setThickness=function(e){this.reservedParameters.m_uThickness.value=.5*e},t}(V),gs=function(){function e(e,t){this.needUpdate=!1,this.alwaysUpdate=!0,this.name=e+t.getVisualizes(e).length,this._renderScene=t,this._enabled=!1,this._position=[0,0,0],this._scale=[1,1,1],this._quaternion=U.b.create(),this._drawables=[]}return e.prototype.destroy=function(){this._renderScene=null,delete this._renderScene,this._position=null,delete this._position,this._scale=null,delete this._scale;for(var e=0;e<this._drawables.length;e++)this._drawables[e].destroy();this._drawables=null,delete this._drawables},e.prototype.setPosition=function(e){this._position=e;for(var t=0;t<this._drawables.length;t++)this._drawables[t].transform.setTranslation(e[0],e[1],e[2]),this._drawables[t].updateBBox()},e.prototype.setScaling=function(e){this._scale=e;for(var t=0;t<this._drawables.length;t++)this._drawables[t].transform.setScaling(e[0],e[1],e[2]),this._drawables[t].updateBBox()},e.prototype.setRotation=function(e,t){U.b.setAxisAngle(this._quaternion,[e[0],e[1],e[2]],t);for(var r=0;r<this._drawables.length;r++)this._drawables[r].transform.setRotation(e,t),this._drawables[r].updateBBox()},e.prototype.setRotationByQuat=function(e){this._quaternion=e;for(var t=0;t<this._drawables.length;t++)this._drawables[t].transform.setRotationByQuat(e),this._drawables[t].updateBBox()},e.prototype.setEnabled=function(e){this._enabled=e,this._onEnableChanged()},e.prototype._onEnableChanged=function(){},e.prototype.doesSupportMobile=function(e){return!0},e.prototype.doesSupportWebGL1=function(){return!0},e.prototype.isEnabled=function(){return this._enabled},e.prototype.resize=function(e,t){},e.prototype.draw=function(e,t,r,i,n,a,o){void 0===o&&(o=-1)},e.prototype.setParameter=function(e,t){},e.prototype.getParameter=function(e){},e.prototype.getTexture=function(){return null},e.prototype.isNeedUpdate=function(){return this.needUpdate&&this.alwaysUpdate},e.prototype.setAlwaysUpdate=function(e){this.alwaysUpdate=e},e.prototype.addEffects=function(){},e.prototype.removeEffects=function(){},e.prototype.isAdded=function(){for(var e=this._renderScene._visualizes,t=0;t<e.length;t++)if(e[t]===this)return!0;return!1},e}(),bs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ws=function(e){function t(t){var r=e.call(this,"BarChart",t)||this;return r._resourceManager=t.getResourceManager(),r._xres=32,r._yres=32,r._thickness=1,r._showLines=!0,r._lineColor=[.2,.2,.2],r._dataTexture=null,r._platteTexture=r._resourceManager.getTexture(r.name+"-barchart-platte"),r}return bs(t,e),t.prototype.destroy=function(){this._resourceManager=null,delete this._resourceManager,this._xres=null,delete this._xres,this._yres=null,delete this._yres,this._thickness=null,delete this._thickness,this._showLines=null,delete this._showLines,this._lineColor=null,delete this._lineColor,this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,e.prototype.destroy.call(this)},t.prototype._initialize=function(){return!!this._resourceManager.gl.isWebGL2||(console.warn("BarChart is not supported in webgl1.0 context!"),!1)},t.prototype.setParameter=function(e,t){var r=!1,i=this._resourceManager.gl;switch(e){case"xres":this._xres=t,r=!0;break;case"yres":this._yres=t,r=!0;break;case"thickness":this._thickness=2*t;break;case"showLines":this._showLines=t;break;case"lineColor":this._lineColor=t;break;case"dataTexture":this._dataTexture=t;break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,null)}r&&this._updateGeometry()},t.prototype._updateGeometry=function(){this._resourceManager.hasMesh(this.name+"-barchart")&&this._resourceManager.getMesh(this.name+"-barchart").destroy(!0);var e=this._resourceManager.getMesh(this.name+"-barchart");(e.createSolidCubeField(this._xres,this._yres),this._resourceManager.hasMesh(this.name+"-barchart-wireframe"))&&this._resourceManager.getMesh(this.name+"-barchart-wireframe").destroy(!0);var t=this._resourceManager.getMesh(this.name+"-barchart-wireframe");if(t.createWiredCubeField(this._xres,this._yres),this._drawables.length<1){var r="barchart",i=this._resourceManager.getShader(r,["MODEL_TRANSFORM"]);if(!i.ready){var n=N.a[r];if(i.createFromShaderSource(n,["MODEL_TRANSFORM"]),!i.ready)throw new Error("Error at creating shader '"+r+"'!")}r="barchart_wireframe";var a=this._resourceManager.getShader(r,["MODEL_TRANSFORM"]);if(!a.ready){n=N.a[r];if(a.createFromShaderSource(n,["MODEL_TRANSFORM"]),!a.ready)throw new Error("Error at create shader '"+r+"'!")}var o=new ys("barchart",this._resourceManager);o.attachShader(i,this._resourceManager);var s=new I.a(e,i,o,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(s);var l=new ys("barchart-wireframe",this._resourceManager);l.attachShader(a,this._resourceManager),s=new I.a(t,a,l,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),this._drawables.push(s),this.setPosition(this._position),this.setScaling(this._scale)}else this._drawables[0].mesh=e,this._drawables[1].mesh=t},t.prototype.draw=function(e,t,r,i,n,a,o){if(void 0===o&&(o=-1),this._enabled)if(this._platteTexture.ready&&this._dataTexture.ready){var s=this._drawables[0].material;s.setPlatteTexture(this._platteTexture),s.setDataTexture(this._dataTexture),s.setThickness(this._thickness),s.setResolution([this._xres,this._yres]),this._showLines?(this._drawables[1].visible=!0,(s=this._drawables[1].material).setDiffuse(this._lineColor),s.setTransparent(1),s.setDataTexture(this._dataTexture),s.setThickness(this._thickness),s.setResolution([this._xres,this._yres])):this._drawables[1].visible=!1;var l=this._resourceManager.gl;e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,l.CCW)}else console.warn("cannot visualize 3D bar field without field data!")},t.prototype.doesSupportWebGL1=function(){return!1},t}(gs),xs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ms=function(e){function t(t,r){return e.call(this,t,r)||this}return xs(t,e),t.prototype.attachShader=function(t,r){var i=e.prototype.attachShader.call(this,t,r);if(!t)return null;for(var n in t.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uPlatte"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=5,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uData"===n&&(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=6,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture));return i},t.prototype.setPlatteTexture=function(e){this.reservedParameters.m_uPlatte.value=e},t.prototype.setDataTexture=function(e){this.reservedParameters.m_uData.value=e},t}(V),Ts=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Es=function(e){function t(t,r){return e.call(this,t,r)||this}return Ts(t,e),t.prototype.attachShader=function(t,r){var i=e.prototype.attachShader.call(this,t,r);if(!t)return null;for(var n in t.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uPlatte"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=5,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uData"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=6,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uForeground"===n&&(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=7,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture));return i},t.prototype.setForegroundImage=function(e){this.reservedParameters.m_uForeground.value=e},t}(Ms),Ss=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),As=function(e){function t(t){var r=e.call(this,"heatmap",t)||this;return r._resourceManager=t.getResourceManager(),r._dataTexture=r._resourceManager.getTexture(r.name+"-heatmap-density"),r._platteTexture=r._resourceManager.getTexture(r.name+"-heatmap-platte"),r._foregroundTexture=r._resourceManager.getTexture(r.name+"-heatmap-foreground"),r._width=1024,r._height=1024,r._gridSize=32,r._needUpdate=!0,r._showGridLine=!1,r._showPoints=!1,r._enableBlend=!0,r._enableForeground=!1,r._resourceManager.gl.isWebGL2?r._imageData=new Float32Array(r._width*r._height):r._imageData=new Uint8Array(r._width*r._height),r}return Ss(t,e),t.prototype.destroy=function(){this._dataTexture.destroy(),this._dataTexture=null,delete this._dataTexture,this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,this._foregroundTexture.destroy(),this._foregroundTexture=null,delete this._foregroundTexture,this._points=null,delete this._points,this._resourceManager=null,delete this._resourceManager,e.prototype.destroy.call(this)},t.prototype.setParameter=function(e,t){var r=this._resourceManager.gl;switch(e){case"points":this._points=t;break;case"width":this._width=t;break;case"height":this._height=t;break;case"gridSize":this._gridSize=t;break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,null);break;case"blend":this._enableBlend=t;break;case"foregroundImage":this._enableForeground=!0,this._foregroundTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,null)}this._needUpdate=!0},t.prototype._cubic=function(e,t,r,i,n){var a=.5;return(-a*e+1.5*t+(a-2)*r+a*i)*n*n*n+(1*e+(a-3)*t+2*r-a*i)*n*n+(-a*e+a*r)*n+t},t.prototype._sampleImage=function(e,t,r,i,n){return i<0&&(i=0),n<0&&(n=0),i>=t&&(i=t-1),n>=r&&(n=r-1),e[i+t*n]},t.prototype._linear=function(e,t,r){return e*(1-r)+t*r},t.prototype._bilinear=function(e,t,r,i,n){var a=Math.max(e*r-.5,0),o=Math.floor(a),s=a-o,l=Math.max(t*i-.5,0),u=Math.floor(l),c=l-u,h=this._sampleImage(n,r,i,o,u),d=this._sampleImage(n,r,i,o+1,u),p=this._sampleImage(n,r,i,o,u+1),f=this._sampleImage(n,r,i,o+1,u+1),m=this._linear(h,d,s),_=this._linear(p,f,s);return this._linear(m,_,c)},t.prototype._bicubic=function(e,t,r,i,n){var a=Math.max(e*r-.5,0),o=Math.floor(a),s=a-o,l=Math.max(t*i-.5,0),u=Math.floor(l),c=l-u,h=this._sampleImage(n,r,i,o-1,u-1),d=this._sampleImage(n,r,i,o+0,u-1),p=this._sampleImage(n,r,i,o+1,u-1),f=this._sampleImage(n,r,i,o+2,u-1),m=this._sampleImage(n,r,i,o-1,u+0),_=this._sampleImage(n,r,i,o+0,u+0),v=this._sampleImage(n,r,i,o+1,u+0),y=this._sampleImage(n,r,i,o+2,u+0),g=this._sampleImage(n,r,i,o-1,u+1),b=this._sampleImage(n,r,i,o+0,u+1),w=this._sampleImage(n,r,i,o+1,u+1),x=this._sampleImage(n,r,i,o+2,u+1),M=this._sampleImage(n,r,i,o-1,u+2),T=this._sampleImage(n,r,i,o+0,u+2),E=this._sampleImage(n,r,i,o+1,u+2),S=this._sampleImage(n,r,i,o+2,u+2),A=this._cubic(h,d,p,f,s),k=this._cubic(m,_,v,y,s),P=this._cubic(g,b,w,x,s),N=this._cubic(M,T,E,S,s);return this._cubic(A,k,P,N,c)},t.prototype._updateImage=function(){if(this._points){for(var e=this._width/this._gridSize,t=this._height/this._gridSize,r=new Float32Array(e*t),i=1e-6,n=0;n<this._points.length;n++){var a=this._points[n],o=Math.floor(a.x*e),s=r[(d=Math.floor(a.y*t))*e+o];s+=a.number,r[d*e+o]=s,i<s&&(i=s)}for(var l=0;l<this._height;l++)for(var u=0;u<this._width;u++){(s=this._bicubic((u+.5)/this._width,(l+.5)/this._height,e,t,r))<0&&(s=0),this._resourceManager.gl.isWebGL2?this._imageData[l*this._width+u]=s/i:this._imageData[l*this._width+u]=255*s/i}if(this._showGridLine){for(l=1;l<t;l++)for(var c=l*this._gridSize-1,h=l*this._gridSize+1,d=c;d<=h;d++)for(u=0;u<this._width;u++)this._imageData[d*this._width+u]=1,this._resourceManager.gl.isWebGL2||(this._imageData[d*this._width+u]*=255);for(u=1;u<e;u++)for(c=u*this._gridSize-1,h=u*this._gridSize+1,o=c;o<=h;o++)for(l=0;l<this._height;l++)this._resourceManager.gl.isWebGL2?this._imageData[l*this._width+o]=1:this._imageData[l*this._width+o]=255}if(this._showPoints)for(n=0;n<this._points.length;n++)for(a=this._points[n],u=Math.floor(a.x*this._width),l=Math.floor(a.y*this._height),o=u-1;o<=u+1;o++)for(d=l-1;d<=l+1;d++)this._resourceManager.gl.isWebGL2?this._imageData[d*this._width+o]=1:this._imageData[d*this._width+o]=255;var p=this._resourceManager.gl;this._dataTexture.ready||(p.isWebGL2?this._dataTexture.create(this._width,this._height,p.R32F,p.LINEAR,p.CLAMP_TO_EDGE):this._dataTexture.create(this._width,this._height,p.ALPHA,p.LINEAR,p.CLAMP_TO_EDGE)),this._dataTexture.resize(this._width,this._height),this._dataTexture.update(this._imageData);var f=["MODEL_TRANSFORM"];this._enableBlend||f.push("DISABLE_BLEND"),this._enableForeground&&f.push("ENABLE_FOREGROUND");var m=this._resourceManager.getShader("heatmap",f);if(!m.ready){var _=N.a.heatmap;if(m.createFromShaderSource(_,f),!m.ready)throw new Error("Error at creating shader 'heatmap'!")}if(this._drawables.length<1){var v=this._resourceManager.getMesh("heatmap");v.ready||v.createQuad(!0);var y=new Es("HeatMap",this._resourceManager);y.attachShader(m,this._resourceManager);var g=new I.a(v,m,y,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(g),this.setPosition(this._position),this.setScaling(this._scale)}}},t.prototype.getTexture=function(){return this._needUpdate&&(this._updateImage(),this._needUpdate=!1),this._dataTexture},t.prototype.getImageData=function(){if(this._needUpdate&&(this._updateImage(),this._needUpdate=!0),this._imageData instanceof Float32Array)return this._imageData;for(var e=new Float32Array(this._imageData.length),t=0;t<this._imageData.length;t++)e[t]=this._imageData[t]/255;return e},t.prototype.draw=function(e,t,r,i,n,a,o){if(void 0===o&&(o=-1),this._enabled)if(this.getTexture(),this._platteTexture.ready&&this._dataTexture.ready){var s=this._drawables[0].material;s.setPlatteTexture(this._platteTexture),s.setDataTexture(this._dataTexture),this._enableForeground&&s.setForegroundImage(this._foregroundTexture),e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,!1)}else console.warn("cannot visualize heatmap without necessary data!")},t}(gs),ks=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ps=function(e){function t(t){var r=e.call(this,"HeightMap",t)||this;return r._xres=1024,r._yres=1024,r._resourceManager=t.getResourceManager(),r._dataTexture=null,r._platteTexture=r._resourceManager.getTexture(r.name+"-HeightMap-platte"),r}return ks(t,e),t.prototype.destroy=function(){this._resourceManager=null,delete this._resourceManager,delete this._xres,delete this._yres,this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,e.prototype.destroy.call(this)},t.prototype._initialize=function(){return!0},t.prototype.setParameter=function(e,t){var r=!1,i=this._resourceManager.gl;switch(e){case"xres":this._xres=t,r=!0;break;case"yres":this._yres=t,r=!0;break;case"dataTexture":this._dataTexture=t;break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,null)}r&&this._updateGeometry()},t.prototype._updateGeometry=function(){var e=this._resourceManager.getMesh("HeightMap");if(e.ready&&(e.destroy(),e=this._resourceManager.getMesh("HeightMap")),e.createGrid(this._xres,this._yres),this._drawables.length<1){var t=this._resourceManager.getShader("heightmap",["MODEL_TRANSFORM"]);if(!t.ready){var r=N.a.heightmap;if(t.createFromShaderSource(r,["MODEL_TRANSFORM"]),!t.ready)throw new Error("Error at creating shader 'heightmap'!")}var i=new Ms("HeightMap",this._resourceManager);i.attachShader(t,this._resourceManager);var n=new I.a(e,t,i,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(n),this.setPosition(this._position),this.setScaling(this._scale)}else this._drawables[0].mesh=e},t.prototype.draw=function(e,t,r,i,n,a,o){if(void 0===o&&(o=-1),this._enabled)if(this._platteTexture.ready&&this._dataTexture.ready){var s=this._drawables[0].material;s.setPlatteTexture(this._platteTexture),s.setDataTexture(this._dataTexture);this._resourceManager.gl;e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,!1)}else console.warn("cannot visualize height map without necessary data!")},t}(gs),Ns=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ds=function(e){function t(t){var r=e.call(this,"metaball",t)||this;r._resourceManager=t.getResourceManager(),r._width=1024,r._height=1024,r._showPoints=!0,r._showContour=!1,r._color=[1,0,0,1],r._contourWidth=1.75,r._contourColor=[1,1,0,1],r._backgroundColor=[1,1,1,1],r._radius=64,r._ballTexture=r._resourceManager.getTexture(r.name+"-metaball-ball"),r._foregroundTexture=r._resourceManager.getTexture(r.name+"-metaball-foreground"),r._enableForeground=!1,r._updateBallImage(),r._point=null,r._ball=null,r._needUpdate=!0,r._blit=new cr(r._resourceManager,N.a.metaball,s.a.isMobile),r._blitForeground=new cr(r._resourceManager,N.a.overlay,s.a.isMobile),r._blitBackground=new cr(r._resourceManager,N.a.background,s.a.isMobile);var i=r._resourceManager.gl;return r._camera=new Bt.a([0,0,r._width,r._height]),r._renderTarget1=new Jt.a("metaball1",r._resourceManager,r._width,r._height,{depthTest:!1,blend:!0,depthFunc:i.LEQUAL,colorFormat:i.RGBA8,clearColor:[0,0,0,0],colorFilter:i.LINEAR,depthFormat:i.DEPTH_COMPONENT24,colorBuffer:0,depthBuffer:0}),r._renderTarget2=new Jt.a("metaball2"+Math.random(),r._resourceManager,r._width,r._height,{depthTest:!1,depthFunc:i.LEQUAL,colorFormat:i.RGBA8,clearColor:[0,0,0,0],colorFilter:i.LINEAR,depthFormat:i.DEPTH_COMPONENT24,depthBuffer:0}),r._dataTexture=r._renderTarget2.getColorBuffer(),r._enableForeground=!1,r._needUpdate=!0,r}return Ns(t,e),t.prototype.destroy=function(){this._dataTexture.destroy(),this._dataTexture=null,delete this._dataTexture,this._ballTexture.destroy(),this._ballTexture=null,delete this._ballTexture,this._foregroundTexture.destroy(),this._foregroundTexture=null,delete this._foregroundTexture,this._renderTarget1.destroy(),this._renderTarget1=null,delete this._renderTarget1,this._renderTarget2.destroy(),this._renderTarget2=null,delete this._renderTarget2,this._points=null,delete this._points,this._color=null,delete this._color,this._contourColor=null,delete this._contourColor,this._backgroundColor=null,delete this._backgroundColor,this._resourceManager=null,delete this._resourceManager,this._point.destroy(),this._point=null,delete this._point,this._ball.destroy(),this._ball=null,delete this._ball,this._blit.destroy(),this._blit=null,delete this._blit,e.prototype.destroy.call(this)},t.prototype.setParameter=function(e,t){var r=this;switch(e){case"points":this._points=t;break;case"colors":this._colors=t;break;case"width":this._width=t;break;case"height":this._height=t;break;case"contourColor":this._contourColor=t;break;case"contourWidth":this._contourWidth=1+t;break;case"backgroundColor":this._backgroundColor=t;break;case"color":this._color=t;break;case"radius":this._radius=t;break;case"contour":this._showContour!==t&&(this._showContour=t,this._blit.recompile("CONTOUR",this._showContour));break;case"foregroundImage":var i=this._resourceManager.gl;this._enableForeground=!0,this._foregroundTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,function(){r._updateImage()})}this._needUpdate=!0},t.prototype._updateBallImage=function(){var e=2*this._radius+1,t=1/this._radius,r=this._resourceManager.gl,i=null;r.isWebGL2?(i=new Float32Array(e*e),this._ballTexture.create(e,e,r.R32F,r.LINEAR,r.CLAMP_TO_EDGE)):(i=new Uint8Array(e*e),this._ballTexture.create(e,e,r.LUMINANCE,r.LINEAR,r.CLAMP_TO_EDGE)),this._ballTexture.resize(e,e);for(var n=0;n<this._radius;n++)for(var a=0;a<this._radius;a++){var o=Math.sqrt(Math.max(1-Math.sqrt(n*n+a*a)*t,0)),s=void 0;s=this._radius+a,i[(this._radius+n)*e+s]=o*(r.isWebGL2?1:255),s=this._radius-a,i[(this._radius+n)*e+s]=o*(r.isWebGL2?1:255),s=this._radius+a,i[(this._radius-n)*e+s]=o*(r.isWebGL2?1:255),s=this._radius-a,i[(this._radius-n)*e+s]=o*(r.isWebGL2?1:255)}this._ballTexture.update(i)},t.prototype._updateImage=function(){if(this._points){if(!this._ball||!this._point){var e=this._resourceManager.getMesh("metaball-quad");e.ready||e.createQuad(),this._ball=new no(e,this._resourceManager),this._ball.setTexture(this._ballTexture),this._ball.transform.setScaling(this._radius/this._width,this._radius/this._height,1),(e=this._resourceManager.getMesh("point")).ready||e.createPoint(),this._point=new no(e,this._resourceManager),this._point.setColor([1,1,1])}this._renderTarget1.resize(this._width,this._height),this._renderTarget2.resize(this._width,this._height),this._camera.setViewport([0,0,this._width,this._height]);var t=this._resourceManager.gl,r=this._renderScene.getRenderer();if(r.renderState.invalidateStates(),r.clear(this._renderTarget2,t.COLOR_BUFFER_BIT),r.renderState.viewport([0,0,this._width,this._height]),this._blitBackground.setParameter("uColor",this._backgroundColor),this._blitBackground.render(r,this._renderTarget2),this._colors)for(var i=0;i<this._colors.length;i++){r.clear(this._renderTarget1,t.COLOR_BUFFER_BIT),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE);for(var n=0;n<this._points.length;n++)if(this._points[n].colorIndex===i){var a=2*this._points[n].x-1,o=2*this._points[n].y-1;this._ball.transform.setTranslation(a,o,0),r.drawDrawable(this._renderTarget1,this._ball,this._camera,null,null,null,null,null)}t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this._blit.setTexture(this._renderTarget1.getColorBuffer()),this._blit.setParameter("uColor",this._colors[i].color),this._showContour&&(this._blit.setParameter("uContourColor",this._colors[i].contourColor),this._blit.setParameter("uContourWidth",this._contourWidth)),this._blit.render(r,this._renderTarget2,!0)}else{r.clear(this._renderTarget1,t.COLOR_BUFFER_BIT),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE);for(i=0;i<this._points.length;i++){a=2*this._points[i].x-1,o=2*this._points[i].y-1;this._ball.transform.setTranslation(a,o,0),r.drawDrawable(this._renderTarget1,this._ball,this._camera,null,null,null,null,null)}t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this._blit.setTexture(this._renderTarget1.getColorBuffer()),this._blit.setParameter("uColor",this._color),this._showContour&&(this._blit.setParameter("uContourColor",this._contourColor),this._blit.setParameter("uContourWidth",this._contourWidth)),this._blit.render(r,this._renderTarget2)}this._enableForeground&&(this._blitForeground.setForegroundTexture(this._foregroundTexture),this._renderTarget2.setOption("blendFunc",[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA]),this._blitForeground.render(r,this._renderTarget2,!0)),this._dataTexture=this._renderTarget2.getColorBuffer()}},t.prototype.getTexture=function(){return this._needUpdate&&(this._updateImage(),this._needUpdate=!1),this._dataTexture},t}(gs),Is=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Os=function(){function e(e,t,r){var i=t.getMesh("trail-path"+e);i.createLineStrip();var n=t.getShader("plain",["MODEL_TRANSFORM"]);if(!n.ready){var a=N.a.plain;if(n.createFromShaderSource(a,["MODEL_TRANSFORM"]),!n.ready)throw new Error("Error at creating shader 'plain'!")}var o=r.createMaterialAdhoc("trail");o.attachShader(n,t),o.setTransparent(.2),this.drawable=new I.a(i,n,o,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]))}return e.prototype.destroy=function(){this.points=null,delete this.points,this.distances=null,delete this.distances,this.drawable.destroy(),this.drawable=null,delete this.drawable},e.prototype.update=function(e){this.points=e;for(var t=this.points.length/3,r=new Uint16Array(t),i=0;i<t;i++)r[i]=i;this.drawable.mesh.update(new Float32Array(this.points),r);var n=0;this.distances=new Array(this.points.length/3);for(i=0;i<this.points.length-3;i+=3){var a=this.points[i+3]-this.points[i],o=this.points[i+4]-this.points[i+1],s=this.points[i+5]-this.points[i+2],l=Math.sqrt(a*a+o*o+s*s);this.distances[i/3]=n,n+=l}this.distances[this.points.length/3-1]=n},e.prototype.draw=function(e,t){e%=this.distances[this.distances.length-1];for(var r=-1,i=0;i<this.distances.length;i++)if(e<this.distances[i]){r=i;break}var n=r-1,a=(e-this.distances[n])/(this.distances[r]-this.distances[n]);return t[0]=this.points[3*n],t[1]=this.points[3*n+1],t[2]=this.points[3*n+2],t[3]=this.points[3*n]*(1-a)+this.points[3*r]*a,t[4]=this.points[3*n+1]*(1-a)+this.points[3*r+1]*a,t[5]=this.points[3*n+2]*(1-a)+this.points[3*r+2]*a,r},e}(),Rs=function(e){function t(t){var r=e.call(this,"trail",t)||this;r._resourceManager=t.getResourceManager(),r._start=-1,r._speed=.01;Math.random();var i=r._resourceManager.getShader("plain",["MODEL_TRANSFORM"]);if(!i.ready){var n=N.a.plain;if(i.createFromShaderSource(n,["MODEL_TRANSFORM"]),!i.ready)throw new Error("Error at creating shader 'plain'!")}var a=t.getScene().materialManager.createMaterialAdhoc("trail");a.attachShader(i),a.setTransparent(.2);var o=r._resourceManager.getMesh("trail-growing");return o.createLine(),r._current=new I.a(o,i,a,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),r._vertices=new Float32Array(6),r._indices=new Uint16Array(2),r._indices[0]=0,r._indices[1]=1,(o=r._resourceManager.getMesh("trail-tip")).createPoint(),r._tip=new I.a(o,i,a,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),r._paths=[],r}return Is(t,e),t.prototype.destroy=function(){this._indices=null,delete this._indices,this._vertices=null,delete this._vertices;for(var e=0;e<this._paths.length;e++)this._paths[e].destroy();this._paths=null,delete this._paths,this._tip.destroy(),this._tip=null,delete this._tip,this._current.destroy(),this._current=null,delete this._current},t.prototype.setParameter=function(e,t){switch(e){case"color":for(var r=0;r<this._paths.length;r++)this._paths[r].drawable.material.setDiffuse(t);this._tip.material.setDiffuse(t),this._current.material.setDiffuse(t);break;case"transparent":for(r=0;r<this._paths.length;r++)this._paths[r].drawable.material.setTransparent(t);this._tip.material.setTransparent(t),this._current.material.setTransparent(t);break;case"speed":this._speed=t}},t.prototype.addTrail=function(e){var t=new Os(this._paths.length,this._resourceManager,this._renderScene.getScene().materialManager);t.update(e),this._paths.push(t)},t.prototype.draw=function(e,t,r,i,n,a,o){if(void 0===o&&(o=-1),this._enabled)for(var s=(Date.now()-this._start)*this._speed,l=0;l<this._paths.length;l++){var u=a.getOption("blend");if(a.setOption("blend",!0),a.always=!0,this._animate){var c=this._paths[l].draw(s,this._vertices);e.drawDrawable(a,this._paths[l].drawable,t,r,i,n,!1,[0,c]),this._current.mesh.update(this._vertices,this._indices),e.drawDrawable(a,this._current,t,r,i,n,!1),a.setOption("blend",u);var h=new Float32Array(this._vertices.buffer,12,3),d=new Uint16Array(this._indices.buffer,0,1);this._tip.mesh.update(h,d),e.drawDrawable(a,this._tip,t,r,i,n,!1)}else{e.drawDrawable(a,this._paths[l].drawable,t,r,i,n,!1),a.setOption("blend",u);var p=this._paths[l].points;h=new Float32Array([p[p.length-3],p[p.length-2],p[p.length-1]]),d=new Uint16Array(this._indices.buffer,0,1);this._tip.mesh.update(h,d),e.drawDrawable(a,this._tip,t,r,i,n,!1)}}},t.prototype.setEnabled=function(t){e.prototype.setEnabled.call(this,t),this._start=Date.now()},t.prototype.setAnimationEnabled=function(e){this._animate=e},t}(gs),Cs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Bs=function(e){function t(t,r){return e.call(this,t,r)||this}return Cs(t,e),t.prototype.attachShader=function(t,r){var i=e.prototype.attachShader.call(this,t,r);if(!i)return null;for(var n in t.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uInvTransform"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uPlatteTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=6,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uGradientTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=8,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uDensityTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=9,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uMaskTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=10,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uAlphaCorrection"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uLayers"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uGridSize"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uSampleNumber"===n&&(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue));return i},t.prototype.setPlatteTexture=function(e){this.reservedParameters.m_uPlatteTexture&&(this.reservedParameters.m_uPlatteTexture.value=e)},t.prototype.setGradientTexture=function(e){this.reservedParameters.m_uGradientTexture&&(this.reservedParameters.m_uGradientTexture.value=e)},t.prototype.setDataTexture=function(e){this.reservedParameters.m_uDensityTexture&&(this.reservedParameters.m_uDensityTexture.value=e)},t.prototype.setAlphaCorrection=function(e){this.reservedParameters.m_uAlphaCorrection&&(this.reservedParameters.m_uAlphaCorrection.value=e)},t.prototype.setInvTransform=function(e){this.reservedParameters.m_uInvTransform&&(this.reservedParameters.m_uInvTransform.value=e)},t.prototype.setLayers=function(e){this.reservedParameters.m_uLayers&&(this.reservedParameters.m_uLayers.value=e)},t.prototype.setGridSize=function(e){this.reservedParameters.m_uGridSize&&(this.reservedParameters.m_uGridSize.value=e)},t.prototype.setSampleNumber=function(e){this.reservedParameters.m_uSampleNumber&&(this.reservedParameters.m_uSampleNumber.value=e)},t}(V),Ls=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Fs=function(e){function t(t){var r=e.call(this,"volume",t)||this;return r._resourceManager=t.getResourceManager(),r._dataTexture=null,r._platteTexture=r._resourceManager.getTexture(r.name+"-volume-platte"),r._gradientTexture=r._resourceManager.getTexture(r.name+"-volume-gradient"),r}return Ls(t,e),t.prototype.destroy=function(){this._gradientTexture.destroy(),this._gradientTexture=null,delete this._gradientTexture,this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,this._resourceManager=null,delete this._resourceManager,e.prototype.destroy.call(this)},t.prototype.setParameter=function(e,t){var r=this._resourceManager.gl;switch(e){case"data":if(this._dataTexture=this._resourceManager.getTexture(this.name+"-volume"),!this._dataTexture.ready){var i=this._resourceManager.gl;i.isWebGL2?this._dataTexture.create(t.width,t.height,i.R32F,i.LINEAR,i.CLAMP_TO_EDGE):this._dataTexture.create(t.width,t.height,i.LUMINANCE,i.LINEAR,i.CLAMP_TO_EDGE)}var n=t.data;if(!(r.isWebGL2||t.data instanceof Uint8Array)){n=new Uint8Array(t.data.length);for(var a=0;a<t.data.length;a++)n[a]=255*t.data[a]}this._dataTexture.update(n);break;case"dataTexture":this._dataTexture=t;break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,r.RGBA,r.LINEAR,r.CLAMP_TO_EDGE,null);break;case"gradientImage":this._gradientTexture.createFromFile(t,r.RGB,r.LINEAR,r.CLAMP_TO_EDGE,null)}},t.prototype._updateInvTransform=function(e){var t=U.a.create();U.a.invert(t,e.transform.matrix),e.material.setInvTransform(t)},t.prototype.setPosition=function(t){e.prototype.setPosition.call(this,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.setScaling=function(t){e.prototype.setScaling.call(this,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.draw=function(e,t,r,i,n,a,o){if(void 0===o&&(o=-1),this._enabled)if(this._platteTexture.ready&&this._dataTexture.ready&&this._gradientTexture.ready){if(0===this._drawables.length){var s=this._resourceManager.getMesh("volume");s.createSolidCube(.5);var l=this._resourceManager.getShader("volume",["MODEL_TRANSFORM"]);if(!l.ready){var u=N.a.volume;if(l.createFromShaderSource(u,["MODEL_TRANSFORM"]),!l.ready)throw new Error("Error at creating shader 'volume'!")}var c=new Bs("volume",this._resourceManager);c.attachShader(l,this._resourceManager);var h=new I.a(s,l,c,null,new Float32Array([-.5,-.5,-.5,.5,.5,.5]));this._drawables.push(h),this.setPosition(this._position),this.setScaling(this._scale)}var d=this._drawables[0].material;d.setPlatteTexture(this._platteTexture),d.setGradientTexture(this._gradientTexture),d.setDataTexture(this._dataTexture),d.setAlphaCorrection(.03),e.drawDrawables(a,this._drawables,t,null,null,r,i,n)}else console.warn("The resources of "+this.name+" are not ready!")},t}(gs),Vs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Us=function(e){function t(t){var r=e.call(this,"MultiLayerVolume",t)||this;r._resourceManager=t.getResourceManager(),r._dataTexture=null,r._platteTexture=r._resourceManager.getTexture(r.name+"-volume-platte"),r._maskTexture=null,r._layers=33,r._sampleNumber=1,r._gridSize=[8,8],r._blit=new cr(r._resourceManager,N.a.blit_simple,s.a.isMobile);var i=r._resourceManager.gl;return r._renderTarget=new Jt.a(r.name+"-volume-data-texture",r._resourceManager,1024,1024,{clearColor:[0,0,0,0],colorFormat:i.RGBA8,colorFilter:i.LINEAR}),r}return Vs(t,e),t.prototype.destroy=function(){this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,this._resourceManager=null,delete this._resourceManager,e.prototype.destroy.call(this)},t.prototype._updateDataTexture=function(){var e=this;if(this._dataTexture&&this._dataTexture.ready&&(this._blit.setTexture(this._dataTexture),this._renderScene.getRenderer().renderState.viewport([0,0,this._renderTarget.getWidth(),this._renderTarget.getHeight()]),this._blit.render(this._renderScene.getRenderer(),this._renderTarget,!1)),this._maskTexture&&this._maskTexture.ready){var t=this._resourceManager.gl;this._blit.setTexture(this._maskTexture);var r=this._renderTarget.getOption("blendFunc");this._renderTarget.setOption("blendFunc",[t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA]),this._renderScene.getRenderer().renderState.viewport([0,0,this._renderTarget.getWidth(),this._renderTarget.getHeight()]),this._blit.render(this._renderScene.getRenderer(),this._renderTarget,!0),this._renderTarget.setOption("blendFunc",r),this._renderTarget.always=!0}this._drawables.forEach(function(t){t.material.setDataTexture(e._renderTarget.getColorBuffer())})},t.prototype.setParameter=function(e,t){var r=this,i=this._resourceManager.gl;switch(e){case"sampleNumber":this._sampleNumber=t;break;case"gridSize":this._gridSize=t,this._renderTarget.resize(1024,1024/this._gridSize[0]*this._gridSize[1]);break;case"maskImage":if(this._maskTexture=this._resourceManager.getTexture(this.name+"-mask"),this._maskTexture.ready){console.warn("Can not set maskImage multiple times.");break}this._maskTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,function(){r._updateDataTexture()});break;case"dataImage":this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-volume"),this._dataTexture.ready&&(this._dataTexture.destroy(!0),this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-volume")),this._dataTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,function(){r._updateDataTexture()});break;case"data":this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-volume");var n=t.data;if(!this._dataTexture.ready)if(i.isWebGL2)this._dataTexture.create(t.width,t.height,i.R32F,i.LINEAR,i.CLAMP_TO_EDGE);else if(this._dataTexture.create(t.width,t.height,i.LUMINANCE,i.LINEAR,i.CLAMP_TO_EDGE),!(n instanceof Uint8Array)){n=new Uint8Array(t.data.length);for(var a=0;a<t.data.length;a++)n[a]=255*t.data[a]}this._dataTexture.update(n),this._updateDataTexture();break;case"dataTexture":this._dataTexture=t,this._updateDataTexture();break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,null),this._drawables.forEach(function(e){e.material.setPlatteTexture(r._platteTexture)});break;case"layers":this._layers=t,this._drawables.forEach(function(e){e.material.setLayers(r._layers)})}},t.prototype.getVolumeTexture=function(){return this._renderTarget.getColorBuffer()},t.prototype._updateInvTransform=function(e){var t=U.a.create();U.a.invert(t,e.transform.matrix),e.material.setInvTransform(t)},t.prototype.setPosition=function(t){e.prototype.setPosition.call(this,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.setScaling=function(t){e.prototype.setScaling.call(this,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.setRotation=function(t,r){e.prototype.setRotation.call(this,t,r),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.setRotationByQuat=function(t){e.prototype.setRotationByQuat.call(this,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.draw=function(e,t,r,i,n,a,o){var s=this;if(void 0===o&&(o=-1),this._enabled)if(this._platteTexture.ready&&this._renderTarget.getColorBuffer().ready){if(0===this._drawables.length){var l=this._resourceManager.getMesh("volume-multi-layer");l.createSolidCube(.5);var u=["MODEL_TRANSFORM"];this._maskTexture&&u.push("HAS_MASK");var c=this._resourceManager.getShader("volume_multi_layer",u);if(!c.ready){var h=N.a.volume_multi_layer;if(c.createFromShaderSource(h,u),!c.ready)throw new Error("Error at creating shader 'volume_multi_layer'!")}var d=new Bs("volume-multi-layer",this._resourceManager);d.attachShader(c,this._resourceManager),d.setPlatteTexture(this._platteTexture),d.setAlphaCorrection(.09),d.setLayers(this._layers),d.setSampleNumber(this._sampleNumber);var p=new I.a(l,c,d,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(p),this.setRotationByQuat(this._quaternion),this.setPosition(this._position),this.setScaling(this._scale),this._updateDataTexture()}this._drawables.forEach(function(e){e.material.setGridSize(s._gridSize)}),e.drawDrawables(a,this._drawables,t,null,null,r,i,n)}else console.warn("The resources of "+this.name+" are not ready!")},t}(gs),zs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),js=function(e){function t(t,r){return e.call(this,t,r)||this}return zs(t,e),t.prototype.attachShader=function(t,r){var i=e.prototype.attachShader.call(this,t,r);if(!i)return null;for(var n in t.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uInvTransform"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uPlatteTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=6,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uGradientTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=8,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uDensityTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=9,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uMaskTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=10,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uAlphaCorrection"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uLayers"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uInstanceFilter"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uGridSize"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uSampleNumber"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uDiffuseTexture"===n&&(this.reservedParameters[n]=new R.a,this.hasTexture=!0,this.reservedParameters[n].texUnit=5,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture));return i},t.prototype.setDiffuseTexture=function(e){var t=this;if(this.reservedParameters.m_uDiffuseTexture)if(e instanceof D.a)this.reservedParameters.m_uDiffuseTexture.value=e;else{var r=this.reservedParameters.m_uDiffuseTexture.value,i=r.getFilter(),n=r.getWrap(),a=this._resourceManager.gl.RGB;if(e instanceof HTMLImageElement){var o=new D.a("texture-"+e.src,this._resourceManager);"png"===(s=e.src.split("."))[s.length-1]&&(a=this._resourceManager.gl.RGBA),o.createFromImage(e,a,this._resourceManager.gl.UNSIGNED_BYTE,i,n),this.reservedParameters.m_uDiffuseTexture.value=o}else{var s,l=new D.a("texture-"+e,this._resourceManager);a=this._resourceManager.gl.RGB;"png"===(s=e.split("."))[s.length-1]&&(a=this._resourceManager.gl.RGBA),l.createFromFile(e,a,i,n,function(){t.reservedParameters.m_uDiffuseTexture.value=l})}}else console.warn("can not set texture for "+this.name)},t.prototype.setPlatteTexture=function(e){this.reservedParameters.m_uPlatteTexture&&(this.reservedParameters.m_uPlatteTexture.value=e)},t.prototype.setGradientTexture=function(e){this.reservedParameters.m_uGradientTexture&&(this.reservedParameters.m_uGradientTexture.value=e)},t.prototype.setDataTexture=function(e){this.reservedParameters.m_uDensityTexture&&(this.reservedParameters.m_uDensityTexture.value=e)},t.prototype.setAlphaCorrection=function(e){this.reservedParameters.m_uAlphaCorrection&&(this.reservedParameters.m_uAlphaCorrection.value=e)},t.prototype.setInvTransform=function(e){this.reservedParameters.m_uInvTransform&&(this.reservedParameters.m_uInvTransform.value=e)},t.prototype.setLayers=function(e){this.reservedParameters.m_uLayers&&(this.reservedParameters.m_uLayers.value=e)},t.prototype.setinstanceFilter=function(e){this.reservedParameters.m_uInstanceFilter&&(this.reservedParameters.m_uInstanceFilter.value=e)},t.prototype.setGridSize=function(e){this.reservedParameters.m_uGridSize&&(this.reservedParameters.m_uGridSize.value=e)},t.prototype.setSampleNumber=function(e){this.reservedParameters.m_uSampleNumber&&(this.reservedParameters.m_uSampleNumber.value=e)},t}(V),Gs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),qs=function(e){function t(t){var r=e.call(this,"MultiLayerColor",t)||this;r._resourceManager=t.getResourceManager(),r._dataTexture=null,r._platteTexture=r._resourceManager.getTexture(r.name+"-volume-platte"),r._maskTexture=null,r._layers=33,r._sampleNumber=1,r._gridSize=[8,8],r._blit=new cr(r._resourceManager,N.a.blit_simple,s.a.isMobile),r._instanceFilter=0;var i=r._resourceManager.gl;return r._renderTarget=new Jt.a(r.name+"-volume-data-texture",r._resourceManager,1024,1024,{clearColor:[0,0,0,0],colorFormat:i.RGBA8,colorFilter:i.LINEAR}),r}return Gs(t,e),t.prototype.destroy=function(){this._platteTexture.destroy(),this._platteTexture=null,delete this._platteTexture,this._resourceManager=null,delete this._resourceManager,e.prototype.destroy.call(this)},t.prototype._updateDataTexture=function(){var e=this;if(this._dataTexture&&this._dataTexture.ready&&(this._blit.setTexture(this._dataTexture),this._renderScene.getRenderer().renderState.viewport([0,0,this._renderTarget.getWidth(),this._renderTarget.getHeight()]),this._blit.render(this._renderScene.getRenderer(),this._renderTarget,!1)),this._maskTexture&&this._maskTexture.ready){var t=this._resourceManager.gl;this._blit.setTexture(this._maskTexture);var r=this._renderTarget.getOption("blendFunc");this._renderTarget.setOption("blendFunc",[t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA]),this._renderScene.getRenderer().renderState.viewport([0,0,this._renderTarget.getWidth(),this._renderTarget.getHeight()]),this._blit.render(this._renderScene.getRenderer(),this._renderTarget,!0),this._renderTarget.setOption("blendFunc",r),this._renderTarget.always=!0}this._drawables.forEach(function(t){t.material.setDataTexture(e._renderTarget.getColorBuffer())})},t.prototype.setParameter=function(e,t){var r=this,i=this._resourceManager.gl;switch(e){case"sampleNumber":this._sampleNumber=t;break;case"gridSize":this._gridSize=t,this._renderTarget.resize(1024,1024/this._gridSize[0]*this._gridSize[1]);break;case"maskImage":if(this._maskTexture=this._resourceManager.getTexture(this.name+"-mask"),this._maskTexture.ready){console.warn("Can not set maskImage multiple times.");break}this._maskTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,function(){r._updateDataTexture()});break;case"dataImage":this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-color"),this._dataTexture.ready&&(this._dataTexture.destroy(!0),this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-color")),this._dataTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,function(){r._updateDataTexture()});break;case"data":var n=t.data;if(this._dataTexture=this._resourceManager.getTexture(this.name+"-multi-layer-color"),!this._dataTexture.ready)if(i.isWebGL2)this._dataTexture.create(t.width,t.height,i.R32F,i.LINEAR,i.CLAMP_TO_EDGE,null,t.depth);else if(this._dataTexture.create(t.width,t.height,i.LUMINANCE,i.LINEAR,i.CLAMP_TO_EDGE,null,t.depth),!(n instanceof Uint8Array)){n=new Uint8Array(t.data.length);for(var a=0;a<t.data.length;a++)n[a]=255*t.data[a]}this._dataTexture.update(n),this._updateDataTexture();break;case"dataTexture":this._dataTexture=t,this._updateDataTexture();break;case"paletteImage":case"platteImage":this._platteTexture.createFromFile(t,i.RGBA,i.LINEAR,i.CLAMP_TO_EDGE,null),this._drawables.forEach(function(e){e.material.setPlatteTexture(r._platteTexture)});break;case"layers":this._layers=t,this._drawables.forEach(function(e){e.material.setLayers(r._layers)});case"instanceFilter":this._instanceFilter=t,this._drawables.forEach(function(e){e.material.setinstanceFilter(r._instanceFilter)})}},t.prototype.getVolumeTexture=function(){return this._renderTarget.getColorBuffer()},t.prototype._updateInvTransform=function(e){var t=U.a.create();U.a.invert(t,e.transform.matrix),e.material.setInvTransform(t)},t.prototype.setPosition=function(t){e.prototype.setPosition.call(this,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.setScaling=function(t){e.prototype.setScaling.call(this,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.setRotation=function(t,r){e.prototype.setRotation.call(this,t,r),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.setRotationByQuat=function(t){e.prototype.setRotationByQuat.call(this,t),this._drawables.length>0&&this._updateInvTransform(this._drawables[0])},t.prototype.draw=function(e,t,r,i,n,a,o){var s=this;if(void 0===o&&(o=-1),this._enabled)if(this._platteTexture.ready&&this._renderTarget.getColorBuffer().ready){if(0===this._drawables.length){var l=this._resourceManager.getMesh("volume-multi-layer");l.createSolidCube(.5);var u=["MODEL_TRANSFORM"];this._maskTexture&&u.push("HAS_MASK");var c=this._resourceManager.getShader("color_multi_layer",u);if(!c.ready){var h=N.a.color_multi_layer;if(c.createFromShaderSource(h,u),!c.ready)throw new Error("Error at creating shader 'color_multi_layer'!")}var d=new js("volume-multi-layer",this._resourceManager);d.attachShader(c,this._resourceManager),d.setPlatteTexture(this._platteTexture),d.setAlphaCorrection(.09),d.setLayers(this._layers),d.setinstanceFilter(this._instanceFilter),d.setSampleNumber(this._sampleNumber);var p=new I.a(l,c,d,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));this._drawables.push(p),this.setRotationByQuat(this._quaternion),this.setPosition(this._position),this.setScaling(this._scale),this._updateDataTexture()}this._drawables.forEach(function(e){e.material.setGridSize(s._gridSize)}),e.drawDrawables(a,this._drawables,t,null,null,r,i,n)}else console.warn("The resources of "+this.name+" are not ready!")},t}(gs),Qs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Hs=function(e){function t(t,r){return e.call(this,t,r)||this}return Qs(t,e),t.prototype.attachShader=function(t,r){var i=e.prototype.attachShader.call(this,t,r);if(!i)return null;for(var n in t.reservedUniforms)this.reservedParameters.hasOwnProperty(n)||("m_uPlatteTexture"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].texUnit=5,this.reservedParameters[n].upload=this.reservedParameters[n].uploadTexture):"m_uTime"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uSpeed"===n?(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue):"m_uWidth"===n&&(this.reservedParameters[n]=new R.a,this.reservedParameters[n].upload=this.reservedParameters[n].uploadValue));return i},t.prototype.setPlatteTexture=function(e){this.reservedParameters.m_uPlatteTexture.value=e},t.prototype.setTime=function(e){this.reservedParameters.m_uTime.value=e},t.prototype.setSpeed=function(e){this.reservedParameters.m_uSpeed.value=e},t.prototype.setWidth=function(e){this.reservedParameters.m_uWidth.value=e},t}(V),Ws=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ys=function(){function e(e,t,r,i,n,a){this._mesh=e.getMesh("ribbon-"+t),this._mesh.createQuad(!0,!0,!1,!0),this._resourceManager=e,this._points=r,this._width=i,this._unitLength=n,this._speed=a,this.update()}return e.prototype.setWidth=function(e){this._width=e},e.prototype.setPoints=function(e){this._points=e},e.prototype.setUnitLength=function(e){this._unitLength=e},e.prototype.setSpeed=function(e){this._speed=e},e.prototype.update=function(){var e=2*this._points.length*12,t=new Float32Array(e),r=null;r=e/3>65536?new Uint32Array(6*(this._points.length-1)):new Uint16Array(6*(this._points.length-1));for(var i=0,n=0,a=0;a<this._points.length;a++){var o=this._points[a],s=this._points[Math.max(0,a-1)],l=this._points[Math.min(this._points.length-1,a+1)],u=[(i+=U.d.distance(o,s))/this._unitLength,0];t[n+0]=o[0],t[n+1]=o[1],t[n+2]=o[2],t[n+3]=s[0],t[n+4]=s[1],t[n+5]=s[2],t[n+6]=u[0],t[n+7]=u[1],t[n+8]=l[0],t[n+9]=l[1],t[n+10]=l[2],t[n+11]=1,t[(n+=12)+0]=o[0],t[n+1]=o[1],t[n+2]=o[2],t[n+3]=s[0],t[n+4]=s[1],t[n+5]=s[2],t[n+6]=u[0],t[n+7]=u[1],t[n+8]=l[0],t[n+9]=l[1],t[n+10]=l[2],t[n+11]=-1,n+=12}var c=0;for(a=1;a<this._points.length;a++)r[c+0]=2*(a-1),r[c+1]=2*(a-1)+1,r[c+2]=2*(a-1)+2,r[c+3]=2*(a-1)+2,r[c+4]=2*(a-1)+1,r[c+5]=2*(a-1)+3,c+=6;var h=this._resourceManager.gl;this._mesh.update(t,r,r instanceof Uint32Array?h.UNSIGNED_INT:h.UNSIGNED_SHORT);var d=this._resourceManager.getShader("animating-ribbon",["MODEL_TRANSFORM"]);if(!d.ready){var p=N.a["animating-ribbon"];if(d.createFromShaderSource(p,["MODEL_TRANSFORM"]),!d.ready)throw new Error("Error at creating shader 'animating-ribbon'!")}this.material=new Hs("ribbon-"+this.id,this._resourceManager),this.material.attachShader(d,this._resourceManager),this.material.setSpeed(this._speed),this.material.setWidth(this._width),this.drawable=new I.a(this._mesh,d,this.material,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]))},e}(),Xs=function(e){function t(t){var r=e.call(this,"AnimatingRibbon",t)||this;return r._milliSeconds=0,r._width=4,r._unitLength=10,r._speed=1,r._ribbons=[],r._platteTexture=null,r._resourceManager=t.getResourceManager(),r._lastDate=new Date,r}return Ws(t,e),t.prototype.destroy=function(){this._resourceManager=null,delete this._resourceManager,e.prototype.destroy.call(this)},t.prototype.doesSupportMobile=function(e){return!0},t.prototype._initialize=function(){return!0},t.prototype.setParameter=function(e,t){var r=this,i=!1;switch(e){case"width":this._width=t/2,this._ribbons.forEach(function(e){e.material.setWidth(r._width)});break;case"paletteTexture":case"platteTexture":if(t instanceof D.a)this._platteTexture=t;else{this._platteTexture=this._resourceManager.getTexture(this.name+"-animatingRibbon-platte");var n=this._resourceManager.gl,a=n.RGB,o=t.split(".");"png"===o[o.length-1]&&(a=n.RGBA),this._platteTexture.createFromFile(t,a,n.LINEAR,n.REPEAT,function(){})}this._ribbons.forEach(function(e){e.material.setPlatteTexture(r._platteTexture)});break;case"speed":this._speed=t,this._ribbons.forEach(function(e){e.material.setSpeed(r._speed)});break;case"unitLength":case"unitLenght":this._unitLength=t,i=!0}i&&this._updateGeometry()},t.prototype.resize=function(e,t){this._ribbons.forEach(function(r){r.material.parameters.uTexSizeAndInv.value=[e,t,1/e,1/t]})},t.prototype.addRibbon=function(e){if(!(e.length<2)){var t=new Ys(this._resourceManager,this.name+this._ribbons.length,e,this._width,this._unitLength,this._speed),r=this._renderScene.getRenderTarget();if(t.material.parameters.uTexSizeAndInv.value=[r.getWidth(),r.getHeight(),1/r.getWidth(),1/r.getHeight()],this._platteTexture&&t.material.setPlatteTexture(this._platteTexture),this._ribbons.push(t),this._drawables.push(t.drawable),this._resourceManager.gl.isWebGL2){this._renderScene.addEffect("Glow");var i=this._renderScene.getEffect("Glow");this.isAdded()&&i.addCustomDrawable(t.drawable),i.setEnabled(!0)}return t}console.warn("points length must be greater than 1!")},t.prototype.addEffects=function(){if(this._resourceManager.gl.isWebGL2){var e=this._renderScene.getEffect("Glow");this._ribbons.forEach(function(t){e.addCustomDrawable(t.drawable)})}},t.prototype.removeEffects=function(){if(this._resourceManager.gl.isWebGL2){var e=this._renderScene.getEffect("Glow");e&&this._ribbons.forEach(function(t){e.removeCustomDrawable(t.drawable)})}},t.prototype.removeRibbon=function(e){var t=this._ribbons.findIndex(function(t){return t===e});if(-1===t)return console.warn("can not find ribbon."),void console.warn(e);if(this._ribbons.splice(t,1),-1!==(t=this._drawables.findIndex(function(t){return e.drawable===t}))){this._renderScene.addEffect("Glow");var r=this._renderScene.getEffect("Glow");r&&this.isAdded()&&r.removeCustomDrawable(e.drawable),e.drawable.destroy(),this._drawables.splice(t,1)}else console.warn("no drawable attached to this ribbon found.")},t.prototype._updateGeometry=function(){var e=this;this._ribbons.forEach(function(t){t.setWidth(e._width),t.setUnitLength(e._unitLength),t.update()})},t.prototype._onEnableChanged=function(){this.needUpdate=this._enabled},t.prototype.draw=function(e,t,r,i,n,a,o){var s=this;if(void 0===o&&(o=-1),this._enabled)if(this._platteTexture.ready){var l=new Date;this._milliSeconds+=l.getTime()-this._lastDate.getTime(),this._milliSeconds>36e5&&(this._milliSeconds=0),this._lastDate=l,this._ribbons.forEach(function(e){e.material.setTime(s._milliSeconds)}),e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,null)}else console.warn("cannot visualize animation ribbon without a platte texture!")},t}(gs),Zs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ks=function(){function e(e,t,r,i,n,a,o){void 0===o&&(o=[0,0,1]),this._mesh=e.getMesh("stripe-"+t),this._mesh.createQuad(!0),this._resourceManager=e,this._points=r,this._width=i,this._unitLength=n,this._speed=a,this._normal=o,this.update()}return e.prototype.setWidth=function(e){this._width=e},e.prototype.setPoints=function(e){this._points=e},e.prototype.setUnitLength=function(e){this._unitLength=e},e.prototype.setSpeed=function(e){this._speed=e},e.prototype.update=function(){var e=2*this._points.length*5,t=new Float32Array(e),r=null;r=e/3>65536?new Uint32Array(6*(this._points.length-1)):new Uint16Array(6*(this._points.length-1));var i=0,n=0,a=U.d.create();U.d.sub(a,this._points[1],this._points[0]);for(var o=U.d.create(),s=U.d.create(),l=0;l<this._points.length;l++){var u=this._points[l],c=this._points[Math.max(0,l-1)],h=(i+=U.d.distance(u,c))/this._unitLength;U.d.cross(o,a,this._normal),U.d.normalize(o,o),U.d.scaleAndAdd(s,this._points[l],o,.5*this._width),t[n+0]=s[0],t[n+1]=s[1],t[n+2]=s[2],t[n+3]=h,t[n+4]=0,U.d.scaleAndAdd(s,this._points[l],o,.5*-this._width),t[n+5]=s[0],t[n+6]=s[1],t[n+7]=s[2],t[n+8]=h,t[n+9]=1,l<this._points.length-2?(U.d.sub(s,this._points[l+1],this._points[l]),U.d.normalize(s,s),U.d.sub(a,this._points[l+2],this._points[l+1]),U.d.normalize(a,a),U.d.add(a,a,s)):this._points[l+1]&&U.d.sub(a,this._points[l+1],this._points[l]),n+=10}var d=0;for(l=0;l<this._points.length-1;l++)r[d+0]=2*l,r[d+1]=2*l+2,r[d+2]=2*l+1,r[d+3]=2*l+1,r[d+4]=2*l+2,r[d+5]=2*l+3,d+=6;var p=this._resourceManager.gl;this._mesh.update(t,r,r instanceof Uint16Array?p.UNSIGNED_SHORT:p.UNSIGNED_INT);var f=this._resourceManager.getShader("animating-stripe",["MODEL_TRANSFORM"]);if(!f.ready){var m=N.a["animating-stripe"];if(f.createFromShaderSource(m,["MODEL_TRANSFORM"]),!f.ready)throw new Error("Error at creating shader 'animating-stripe'!")}this.material=new Hs("stripe-"+this.id,this._resourceManager),this.material.attachShader(f,this._resourceManager),this.material.setSpeed(this._speed),this.drawable=new I.a(this._mesh,f,this.material,null,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]))},e}(),Js=function(e){function t(t){var r=e.call(this,"AnimatingStripe",t)||this;return r._milliSeconds=0,r._width=4,r._unitLength=10,r._speed=1,r._stripes=[],r._platteTexture=null,r._resourceManager=t.getResourceManager(),r._lastDate=new Date,r}return Zs(t,e),t.prototype.destroy=function(){this._resourceManager=null,delete this._resourceManager,e.prototype.destroy.call(this)},t.prototype.doesSupportMobile=function(e){return!0},t.prototype._initialize=function(){return!0},t.prototype.setParameter=function(e,t){var r=this,i=!1;switch(e){case"width":this._width=t;break;case"paletteTexture":case"platteTexture":if(t instanceof D.a)this._platteTexture=t;else{this._platteTexture=this._resourceManager.getTexture(this.name+"-animatingStripe-platte");var n=this._resourceManager.gl,a=n.RGB,o=t.split(".");"png"===o[o.length-1]&&(a=n.RGBA),this._platteTexture.createFromFile(t,a,n.LINEAR,n.REPEAT,function(){})}this._stripes.forEach(function(e){e.material.setPlatteTexture(r._platteTexture)});break;case"speed":this._speed=t,this._stripes.forEach(function(e){e.material.setSpeed(r._speed)});break;case"unitLength":case"unitLenght":this._unitLength=t,i=!0}i&&this._updateGeometry()},t.prototype.resize=function(e,t){},t.prototype.addStripe=function(e){if(!(e.length<2)){var t=new Ks(this._resourceManager,this.name+this._stripes.length,e,this._width,this._unitLength,this._speed);this._platteTexture&&t.material.setPlatteTexture(this._platteTexture),this._stripes.push(t),this._drawables.push(t.drawable),this._renderScene.addEffect("Glow");var r=this._renderScene.getEffect("Glow");return this.isAdded()&&r.addCustomDrawable(t.drawable),r.setEnabled(!0),t}console.warn("points length must be greater than 1!")},t.prototype.removeStripe=function(e){var t=this._stripes.findIndex(function(t){return t===e});if(-1===t)return console.warn("can not find stripe."),void console.warn(e);if(this._stripes.splice(t,1),-1!==(t=this._drawables.findIndex(function(t){return e.drawable===t}))){if(this.isAdded(),this._resourceManager.gl.isWebGL2){var r=this._renderScene.getEffect("Glow");r&&this.isAdded()&&r.removeCustomDrawable(e.drawable)}e.drawable.destroy(),this._drawables.splice(t,1)}else console.warn("no drawable attached to this stripe found.")},t.prototype.addEffects=function(){if(this._resourceManager.gl.isWebGL2){var e=this._renderScene.getEffect("Glow");this._stripes.forEach(function(t){e.addCustomDrawable(t.drawable)})}},t.prototype.removeEffects=function(){if(this._resourceManager.gl.isWebGL2){var e=this._renderScene.getEffect("Glow");e&&this._stripes.forEach(function(t){e.removeCustomDrawable(t.drawable)})}},t.prototype._updateGeometry=function(){var e=this;this._stripes.forEach(function(t){t.setWidth(e._width),t.setUnitLength(e._unitLength),t.update()})},t.prototype.draw=function(e,t,r,i,n,a,o){var s=this;if(void 0===o&&(o=-1),this._enabled)if(this._platteTexture.ready){var l=new Date;this._milliSeconds+=l.getTime()-this._lastDate.getTime(),this._milliSeconds>36e5&&(this._milliSeconds=0),this._lastDate=l,this._stripes.forEach(function(e){e.material.setTime(s._milliSeconds)}),e.drawDrawables(a,this._drawables,t,null,null,r,i,n,null,null)}else console.warn("cannot visualize animation stripe without a platte texture!")},t}(gs),$s=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),el=new Uint8Array([0,1,1,2,2,3,3,0,0,4,1,5,2,6,3,7,4,5,5,6,6,7,7,4]),tl=function(e){function t(t){var r=e.call(this,"BBoxSize",!0,t)||this;r._cube=null,r._vertices=new Float32Array(24),r._indices=[],r._indices[0]=new Uint16Array([0,4,7,7,3,0]),r._indices[1]=new Uint16Array([0,1,5,5,4,0]),r._indices[2]=new Uint16Array([0,3,2,2,1,0]),r._indices[3]=new Uint16Array([5,1,2,2,6,5]),r._indices[4]=new Uint16Array([6,2,3,3,7,6]),r._indices[5]=new Uint16Array([4,5,6,6,7,4]);var i=r._resourceManager.getMesh("wiredcube");i.createWiredCube(),r._cube=new ln(i,r._resourceManager),r._cube.setColor([.2,.2,.2]),r._cube.setTransparent(1),t.getRenderScene().addBboxDrawable(r._cube),r._anchors=[{x:0,y:0,number:NaN,position:U.d.create()},{x:0,y:0,number:NaN,position:U.d.create()},{x:0,y:0,number:NaN,position:U.d.create()}];r._resourceManager.gl;return r._rotate=!1,r._rotateMatrix=U.a.create(),r._invertedRotateMatrix=U.a.create(),r._bbox=P.a.aabb.create(),r._BBoxSizeedBBox=P.a.aabb.create(),r._points=P.a.aabb.points(r._scene.clipping.getBBox()),r}return $s(t,e),t.prototype.destroy=function(){this._vertices=null,this._indices=null,this._cube.destroy()},t.prototype._updateAnchor=function(){var e=[0,0,0],t=[0,0,0];U.d.copy(e,this._points[4]),U.d.copy(t,this._points[2]);var r=U.d.fromValues(t[0]-e[0],t[1]-e[1],t[2]-e[2]);U.d.set(this._anchors[0].position,e[0]+r[0]/2,e[1],e[2]),U.d.set(this._anchors[1].position,e[0],e[1]+r[1]/2,e[2]),U.d.set(this._anchors[2].position,e[0],e[1],e[2]+r[2]/2),this._anchors[0].number=r[0],this._anchors[1].number=r[1],this._anchors[2].number=r[2]},t.prototype.setBBoxSizeBox=function(e){this._BBoxSizeedBBox=e,this._updatePoints(),this.updateGeometry(),this._renderer.renderState.invalidateClip(),this._viewer.invalidate()},t.prototype.getBBoxSizeBox=function(){return this._BBoxSizeedBBox},t.prototype._render=function(){for(var e=this._viewer.getCamera().core,t=0;t<3;++t){var r=e.project(this._anchors[t].position);this._anchors[t].x=r[0],this._anchors[t].y=r[1]}this._viewer.notifyEventListener("showBoxUpdate",[this._anchors[0],this._anchors[1],this._anchors[2]])},t.prototype.dump=function(){var e=this._viewer.getCamera().core;if(this._enabled){for(var t=0;t<3;++t){var r=e.project(this._anchors[t].position);this._anchors[t].x=r[0],this._anchors[t].y=r[1]}this._viewer.getEventEmitter().emit("showBoxDump",[this._anchors[0],this._anchors[1],this._anchors[2]])}},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupport3D=function(e){return!0},t.prototype.updateGeometry=function(e){var t=this._resourceManager.gl;this._vertices[0]=this._points[0][0],this._vertices[1]=this._points[0][1],this._vertices[2]=this._points[0][2],this._vertices[3]=this._points[1][0],this._vertices[4]=this._points[1][1],this._vertices[5]=this._points[1][2],this._vertices[6]=this._points[2][0],this._vertices[7]=this._points[2][1],this._vertices[8]=this._points[2][2],this._vertices[9]=this._points[3][0],this._vertices[10]=this._points[3][1],this._vertices[11]=this._points[3][2],this._vertices[12]=this._points[4][0],this._vertices[13]=this._points[4][1],this._vertices[14]=this._points[4][2],this._vertices[15]=this._points[5][0],this._vertices[16]=this._points[5][1],this._vertices[17]=this._points[5][2],this._vertices[18]=this._points[6][0],this._vertices[19]=this._points[6][1],this._vertices[20]=this._points[6][2],this._vertices[21]=this._points[7][0],this._vertices[22]=this._points[7][1],this._vertices[23]=this._points[7][2],this._cube.mesh.update(this._vertices,el,t.UNSIGNED_BYTE),e&&e.renderState.invalidateClip()},t.prototype.reset=function(e){this._rotate=!1,this._updateBBox([0,-1,0]),this._updatePoints(),this.updateGeometry(e),this._updateAnchor()},t.prototype.setVisible=function(e){this._enabled=e,this._viewer.setCullingEnabled(!e),this._enabled&&this.reset(),this._viewer.getRenderScene().setBBoxEnabled(e),this._viewer.invalidate()},t.prototype.isRotatable=function(){return this._rotate},t.prototype._updateBBox=function(e){var t=P.a.aabb.center(this._scene.bbox),r=U.d.create();U.d.scaleAndAdd(r,t,e,this._scene.radius),Math.abs(e[2])>.9999?U.a.lookAt(this._rotateMatrix,r,t,[0,1,0]):U.a.lookAt(this._rotateMatrix,r,t,[0,0,1]),U.a.invert(this._invertedRotateMatrix,this._rotateMatrix);var i=this._scene.clipping.getBBox();if(tr.a.compressNormals){i[0]-=1e-4,i[1]-=1e-4,i[2]-=1e-4,i[3]+=1e-4,i[4]+=1e-4,i[5]+=1e-4}P.a.aabb.points2(i,this._points);for(var n=0,a=this._points.length;n<a;n++)U.d.transformMat4(this._points[n],this._points[n],this._rotateMatrix);P.a.aabb.createFromPoints(this._bbox,this._points),P.a.aabb.copy(this._BBoxSizeedBBox,this._bbox),this._cube.bbox=P.a.aabb.createFromArray(this._BBoxSizeedBBox),this._cube.bsphere=P.a.sphere.createFromAABB(this._BBoxSizeedBBox),this._updatePoints()},t.prototype._updatePoints=function(){P.a.aabb.points2(this._BBoxSizeedBBox,this._points),U.d.transformMat4(this._points[0],this._points[0],this._invertedRotateMatrix),U.d.transformMat4(this._points[1],this._points[1],this._invertedRotateMatrix),U.d.transformMat4(this._points[2],this._points[2],this._invertedRotateMatrix),U.d.transformMat4(this._points[3],this._points[3],this._invertedRotateMatrix),U.d.transformMat4(this._points[4],this._points[4],this._invertedRotateMatrix),U.d.transformMat4(this._points[5],this._points[5],this._invertedRotateMatrix),U.d.transformMat4(this._points[6],this._points[6],this._invertedRotateMatrix),U.d.transformMat4(this._points[7],this._points[7],this._invertedRotateMatrix),this._scene.clipping.update(this._points)},t}(Zt.a),rl=r(10),il=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),nl=function(e){function t(t,r,i){var n=e.call(this,t,null,null,null,i)||this;n.name=null,n.isHeighLight=!1,n.isHeighLight=!1;var a=r.getShader("mark",["MODEL_TRANSFORM"]);a.ready||a.createFromShaderSource(N.a.constant,["MODEL_TRANSFORM"]);var o=new V("",r);return o.attachShader(a,r),n.shader=a,n.material=o,n.recompileShader("DRAW_POINT",!0),n}return il(t,e),t.prototype.setHeighLight=function(e){e?this.material.heighLight():this.material.restoreDiffuse()},t.prototype.setColor=function(e){this.material.setDiffuse(e)},t.prototype.setTransparent=function(e){this.material.setTransparent(e)},t}(I.a),al=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ol=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.POINT=1]="POINT",e[e.LINE=2]="LINE",e[e.AREA=3]="AREA",e[e.RECT=4]="RECT"}(es||(es={})),function(e){e[e.NONE=0]="NONE",e[e.HIGHLIGHT=1]="HIGHLIGHT",e[e.OUTLINE=2]="OUTLINE"}(ts||(ts={})),function(e){e[e.NONE=-1]="NONE",e[e.TRIANGLE=0]="TRIANGLE",e[e.Arrow=1]="Arrow"}(rs||(rs={}));var sl,ll=function(){function e(e,t){this._visible=!0,this.id=e,this.renderScene=t}return e.prototype.use=function(){this.drawable.setId(this.id),this.renderScene.addMarkDrawable(this.drawable)},e.prototype.detach=function(){this.renderScene.removeMarkDrawable(this.drawable)},e.prototype.destory=function(){this.detach(),this.drawable.destroy()},e.prototype.setVisible=function(e){this.drawable.visible=e},e.prototype.isVisible=function(){return this.drawable.visible},e.prototype.calcAlignment=function(e,t){var r=rl.a.create();rl.a.subtract(r,t,e);var i=Math.min(rl.a.angle([1,0,0],r),rl.a.angle([-1,0,0],r)),n=Math.min(rl.a.angle([0,1,0],r),rl.a.angle([0,-1,0],r)),a=Math.min(rl.a.angle([0,0,1],r),rl.a.angle([0,0,-1],r)),o=Math.min(i,n,a);return Math.abs(o-i)<1e-4?[t[0],e[1],e[2]]:Math.abs(o-n)<1e-4?[e[0],t[1],e[2]]:Math.abs(o-a)<1e-4?[e[0],e[1],t[2]]:void 0},e.prototype.select=function(){},e.prototype.unSelect=function(){},e.prototype.setColor=function(e){this.color=e,this.drawable.setColor(this.color)},e.prototype.setTransparent=function(e){this.drawable.setTransparent(e)},e}(),ul=function(e){function t(t,r,i){var n=e.call(this,t,r)||this;n._worldPoint=i,n.type="point",n._pointSize=10;var a=r.getResourceManager(),o=a.getMesh("point"+t);o.createPoint(),n.drawable=new nl(o,a,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),o.update(new Float32Array(i),new Uint16Array([0]));var s=n._calcBbox(i);return n.drawable.setBbox(s),n}return al(t,e),t.prototype._calcBbox=function(e){return P.a.aabb.createFromArray([e[0]-this._pointSize,e[1]-this._pointSize,e[2]-this._pointSize,e[0]+this._pointSize,e[1]+this._pointSize,e[2]+this._pointSize])},t.prototype.update=function(e){e.unproject(this._worldPoint)},t}(ll),cl=function(e){function t(t,r){var i=e.call(this,t,r)||this,n=r.getResourceManager();return i._worldPoints=[],i.type="line",i._mesh=n.getMesh("Line"+t),i._mesh.createLineStrip(),i.drawable=new nl(i._mesh,n,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),i}return al(t,e),t.prototype.addKeyPoint=function(e,t){var r=null;r=t?this.calcAlignment(this._worldPoints[this._worldPoints.length-1],e):e,this._worldPoints.push(r)},t.prototype.setWorldPoints=function(e){this._worldPoints=e,this._updateVertices()},t.prototype.updateActivePoint=function(e,t){this._activePoint=t?this.calcAlignment(this._worldPoints[this._worldPoints.length-1],e):e,this._updateVertices()},t.prototype.stopDrawing=function(e,t){this.addKeyPoint(e,t),this._activePoint=null,this._updateVertices();var r=this._calcBbox();this.drawable.setBbox(r)},t.prototype._calcBbox=function(){for(var e=P.a.aabb.createFromArray([1/0,1/0,1/0,-1/0,-1/0,-1/0]),t=0,r=this._worldPoints.length;t<r;t++)e[0]=Math.min(this._worldPoints[t][0],e[0]),e[1]=Math.min(this._worldPoints[t][1],e[1]),e[2]=Math.min(this._worldPoints[t][2],e[2]),e[3]=Math.max(this._worldPoints[t][0],e[3]),e[4]=Math.max(this._worldPoints[t][1],e[4]),e[5]=Math.max(this._worldPoints[t][2],e[5]);return e},t.prototype._updateVertices=function(){for(var e=[],t=new Uint16Array(this._worldPoints.length+(this._activePoint?1:0)),r=0;r<this._worldPoints.length;r++)e.push(this._worldPoints[r][0]),e.push(this._worldPoints[r][1]),e.push(this._worldPoints[r][2]),t[r]=r;this._activePoint&&(e.push(this._activePoint[0]),e.push(this._activePoint[1]),e.push(this._activePoint[2]),t[t.length-1]=t.length-1),this._mesh.update(new Float32Array(e),t)},t.prototype.update=function(e){},t}(ll),hl=function(e){function t(t,r){var i=e.call(this,t,r)||this,n=r.getResourceManager();return i._worldPoints=[],i._anchorPoints=[],i.type="area",i._mesh=n.getMesh("Area"+t),i._mesh.createSharePolygon(),i.drawable=new nl(i._mesh,n,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),i}return al(t,e),t.prototype.destory=function(){var e,t;try{for(var r=ol(this._anchorPoints),i=r.next();!i.done;i=r.next()){var n=i.value;this.renderScene.removeMarkDrawable(n)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}this._anchorPoints=[],this.detach(),this.drawable.destroy()},t.prototype.addKeyPoint=function(e,t){var r=null;r=t?this.calcAlignment(this._worldPoints[this._worldPoints.length-1],e):e,this._worldPoints.push(r),this._addAnchorPoint(r),this._worldPoints.length>=3&&this._removeAnchorPoint(0)},t.prototype.setWorldPoints=function(e){this._worldPoints=e,this._updateVertices()},t.prototype._addAnchorPoint=function(e){var t=this.renderScene.getResourceManager().getMesh(a.a.generateUUID());t.createPoint();var r=new nl(t,this.renderScene.getResourceManager(),new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0]));r.setTranslation(e[0],e[1],e[2]),r.setColor(pl),r.setTransparent(1),this.renderScene.addMarkDrawable(r),this._anchorPoints.push(r)},t.prototype._removeAnchorPoint=function(e){var t=this._anchorPoints[e];this.renderScene.removeMarkDrawable(t),this._anchorPoints.splice(e,1),t.destroy()},t.prototype._removeAllAnchorPoint=function(){var e,t;try{for(var r=ol(this._anchorPoints),i=r.next();!i.done;i=r.next()){var n=i.value;this.renderScene.removeMarkDrawable(n),n.destroy()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}this._anchorPoints=[]},t.prototype.updateActivePoint=function(e,t){this._activePoint=t?this.calcAlignment(this._worldPoints[this._worldPoints.length-1],e):e,this._updateVertices()},t.prototype.stopDrawing=function(e,t){var r=null;r=t?this.calcAlignment(this._worldPoints[this._worldPoints.length-1],e):e,this._removeAllAnchorPoint(),this._worldPoints.push(r),this._activePoint=null,this._updateVertices();var i=this._calcBbox();this.drawable.setBbox(i)},t.prototype._calcBbox=function(){for(var e=P.a.aabb.createFromArray([1/0,1/0,1/0,-1/0,-1/0,-1/0]),t=0,r=this._worldPoints.length;t<r;t++)e[0]=Math.min(this._worldPoints[t][0],e[0]),e[1]=Math.min(this._worldPoints[t][1],e[1]),e[2]=Math.min(this._worldPoints[t][2],e[2]),e[3]=Math.max(this._worldPoints[t][0],e[3]),e[4]=Math.max(this._worldPoints[t][1],e[4]),e[5]=Math.max(this._worldPoints[t][2],e[5]);return e},t.prototype._updateVertices=function(){for(var e=[],t=0;t<this._worldPoints.length;t++)e.push(this._worldPoints[t][0]),e.push(this._worldPoints[t][1]),e.push(this._worldPoints[t][2]);this._activePoint&&(e.push(this._activePoint[0]),e.push(this._activePoint[1]),e.push(this._activePoint[2]));var r=e.length/3-2,i=new Uint16Array(3*r);for(t=0;t<r;t++)i[3*t]=t,i[3*t+1]=t+1,i[3*t+2]=t+2;this._mesh.update(new Float32Array(e),i)},t.prototype.update=function(e){},t}(ll),dl=function(e){function t(t,r){var i=e.call(this,t,r)||this;i._width=1;var n=r.getResourceManager();return i._worldPoints=[],i._arrowStyle=0,i.type="rect",i._mesh=n.getMesh("rect"+t),i._mesh.createSharePolygon(),i.drawable=new nl(i._mesh,n,new Float32Array([-1/0,-1/0,-1/0,1/0,1/0,1/0])),i._normal=[0,0,1],i}return al(t,e),t.prototype.setWidth=function(e){this._width=e,this._updateVertices()},t.prototype.setArrowStyle=function(e){this._arrowStyle=e,this._updateVertices()},t.prototype.addKeyPoint=function(e,t){var r=null;r=t?this.calcAlignment(this._worldPoints[this._worldPoints.length-1],e):e,this._worldPoints.push(r)},t.prototype.setWorldPoints=function(e){this._worldPoints=e,this._updateVertices()},t.prototype.updateActivePoint=function(e,t){this._activePoint=t?this.calcAlignment(this._worldPoints[0],e):e,this._updateVertices()},t.prototype.stopDrawing=function(e,t){this.addKeyPoint(e,t),this._activePoint=null,this._updateVertices();var r=this._calcBbox();this.drawable.setBbox(r)},t.prototype._calcBbox=function(){for(var e=P.a.aabb.createFromArray([1/0,1/0,1/0,-1/0,-1/0,-1/0]),t=0,r=this._worldPoints.length;t<r;t++)e[0]=Math.min(this._worldPoints[t][0],e[0]),e[1]=Math.min(this._worldPoints[t][1],e[1]),e[2]=Math.min(this._worldPoints[t][2],e[2]),e[3]=Math.max(this._worldPoints[t][0],e[3]),e[4]=Math.max(this._worldPoints[t][1],e[4]),e[5]=Math.max(this._worldPoints[t][2],e[5]);return e},t.prototype._updateVertices=function(){for(var e=[],t=0;t<this._worldPoints.length;t++)e.push(this._worldPoints[t][0]),e.push(this._worldPoints[t][1]),e.push(this._worldPoints[t][2]);this._activePoint&&(e.push(this._activePoint[0]),e.push(this._activePoint[1]),e.push(this._activePoint[2]));var r=rl.a.fromValues(e[0],e[1],e[2]),i=rl.a.fromValues(e[3],e[4],e[5]),n=rl.a.create(),a=rl.a.create(),o=rl.a.create();rl.a.subtract(a,i,r),rl.a.normalize(a,a),rl.a.cross(o,a,this._normal),this._arrowStyle>-1?rl.a.scaleAndAdd(n,i,a,-1.57*this._width):rl.a.copy(n,i);var s=rl.a.create(),l=rl.a.create(),u=rl.a.create(),c=rl.a.create(),h=rl.a.create(),d=rl.a.create(),p=rl.a.create();rl.a.scaleAndAdd(s,r,o,this._width),rl.a.scaleAndAdd(l,r,o,-this._width),rl.a.scaleAndAdd(u,n,o,this._width),rl.a.scaleAndAdd(c,n,o,-this._width),this._arrowStyle>-1&&(rl.a.scaleAndAdd(h,n,o,2*this._width),rl.a.scaleAndAdd(d,n,o,-2*this._width),rl.a.copy(p,i));var f=[];f=this._arrowStyle>-1?[s[0],s[1],s[2],l[0],l[1],l[2],u[0],u[1],u[2],c[0],c[1],c[2],h[0],h[1],h[2],d[0],d[1],d[2],p[0],p[1],p[2]]:[s[0],s[1],s[2],l[0],l[1],l[2],u[0],u[1],u[2],c[0],c[1],c[2]];var m=new Uint16Array(this._arrowStyle>-1?9:6);m[0]=0,m[1]=1,m[2]=2,m[3]=2,m[4]=3,m[5]=1,this._arrowStyle>-1&&(m[6]=4,m[7]=5,m[8]=6),this._mesh.update(new Float32Array(f),m)},t.prototype.update=function(e){},t}(ll),pl=[247/255,82/255,35/255],fl=function(e){function t(t){var r=e.call(this,"MarkGraph",!0,t)||this;return r._arrowStyle=0,r._rectWidth=1,r._alignment=!1,r._turnCorner=!1,r._multiselect=!1,r.mode=es.DEFAULT,r._preventEffect=!0,r._depthQuery=new Kt.a(t.getScene().core,t.getResourceManager()),r._pickQuery=new sr.a(t.getScene().core,t.getResourceManager()),r._contour=new hr(r._resourceManager,r._scene,r._viewer.getWidth(),r._viewer.getHeight()),r._contour.setColor([.968,.322,.137,1]),r.marks=new Map,r._selectType=ts.HIGHLIGHT,r._alignment=!1,r._rectWidth=1,r._arrowStyle=rs.TRIANGLE,r._selectMarks=new Map,r.defaultColor=null,r.defaultOpacity=null,r}return al(t,e),t.prototype.update=function(){},t.prototype.doesSupportMobile=function(e){return!0},t.prototype.doesSupport3D=function(e){return!0},t.prototype.addInput=function(e){switch(e.name){case"mouse":return this._registerMouseEvents(e);case"keyboard":return this._registerKeyboardEvents(e)}},t.prototype._registerMouseEvents=function(e){var t=this;e.addMouseDownListener(function(e){return t._onMouseDown(e)},"MarkGraph"),e.addMouseMoveListener(function(e){return t._onMouseMove(e)},"MarkGraph"),e.addMouseUpListener(function(e){return t._onMouseUp(e)},"MarkGraph")},t.prototype._registerKeyboardEvents=function(e){var t=this;e.addKeyDownListener(function(e){return t._onKeyDown(e)},"MarkGraph"),e.addKeyUpListener(function(e){return t._onKeyUp(e)},"MarkGraph")},t.prototype.destroy=function(){this.marks.forEach(function(e){e.destory()}),this._depthQuery.destroy(),this._contour.destroy(),this._pickQuery.destroy()},t.prototype.resize=function(e,t){this._contour.resize(e,t)},t.prototype.recompileShader=function(e){this._pickQuery.recompileShader(this._resourceManager,e),this._contour.recompileShader(this._resourceManager,e)},t.prototype.setMarkType=function(e){this.mode=e,this._drawing&&(this._viewer.notifyEventListener("MarkGraph-Removed",this._drawing.id),this._selectMarks.delete(this._drawing.id),this.marks.delete(this._drawing.id),this._drawing.destory(),this._drawing=null),this._viewer.invalidate()},t.prototype._onEnableChanged=function(){this._viewer.getRenderScene().setMarkEnabled(this._enabled),this._enabled?this._viewer.registerEventListener("before-rendering",this.update):this._viewer.removeEventListener("before-rendering",this.update)},t.prototype._onMouseDown=function(e){return!1},t.prototype._onMouseUp=function(e){if(!this._enabled||e.moved)return!1;switch(this.mode){case es.POINT:this._createPoint(e.x,e.y);break;case es.LINE:this._setLineKeyPoints(e);break;case es.AREA:this._setAreaKeyPoints(e);break;case es.RECT:this._setRectKeyPoints(e);break;case es.DEFAULT:this._select(e.x,e.y)}return!0},t.prototype._onKeyDown=function(e){return"Control"===e.key&&(this._alignment=!0,this._multiselect=!0),"Shift"===e.key&&(this._turnCorner=!0),!1},t.prototype._onKeyUp=function(e){return"Control"===e.key&&(this._alignment=!1,this._multiselect=!1),"Shift"===e.key&&(this._turnCorner=!1),!1},t.prototype._getPickables=function(){if(!this._pickables){var e=this._viewer.getRenderScene().getMarks();this._pickables=e.queue.drawables}return this._pickables},t.prototype._onMouseMove=function(e){if(this._drawing){var t=this._depthQuery.unproject(e.x,e.y,this._renderer,this._camera);t&&(this._drawing.updateActivePoint(t,this._alignment),this._viewer.invalidate())}return!1},t.prototype._select=function(e,t){var r=this._getPickables(),i=this._pickQuery.pickDrawable(e,t,this._renderer,this._camera,r);this._multiselect||this.clearAllSelect(),i?this._setSelect(i,this._selectType):this.clearAllSelect()},t.prototype._render=function(){if(this._enabled&&this._selectType===ts.OUTLINE){var e=[],t=[];this.marks.forEach(function(e){t.push(e.drawable)}),this._selectMarks.forEach(function(t){e.push(t.drawable)}),this._contour.renderMark(this._renderer,this._scene,e,this._camera,t)}},t.prototype.clearAllSelect=function(){var e=this;this.marks.forEach(function(e){e.drawable.setHeighLight(!1)}),this._selectMarks.forEach(function(t){e._selectMarks.delete(t.id)}),this._viewer.invalidate()},t.prototype._setSelect=function(e,t){var r=this.marks.get(e.getId());r?(t==ts.HIGHLIGHT&&e.setHeighLight(!0),this._selectMarks.set(r.id,r),this._viewer.invalidate()):console.warn("drawable named: "+e.name+" without mark")},t.prototype._createPoint=function(e,t){var r=this._depthQuery.unproject(e,t,this._renderer,this._camera);if(!r)return null;var i=new ul(a.a.generateUUID(),this._viewer.getRenderScene(),r);return this.marks.set(i.id,i),i.setColor(this.defaultColor?this.defaultColor:pl),i.setTransparent(this.defaultOpacity?this.defaultOpacity:.6),i.use(),this._viewer.notifyEventListener("MarkGraph-Created",i.id),this._viewer.invalidate(),i},t.prototype._createLines=function(){var e=new cl(a.a.generateUUID(),this._viewer.getRenderScene());return this.marks.set(e.id,e),e.setColor(this.defaultColor?this.defaultColor:pl),e.setTransparent(this.defaultOpacity?this.defaultOpacity:1),e.use(),this._viewer.notifyEventListener("MarkGraph-Created",e.id),this._viewer.invalidate(),e},t.prototype._createArea=function(){var e=new hl(a.a.generateUUID(),this._viewer.getRenderScene());return this.marks.set(e.id,e),e.setColor(this.defaultColor?this.defaultColor:pl),e.setTransparent(this.defaultOpacity?this.defaultOpacity:.6),e.use(),this._viewer.notifyEventListener("MarkGraph-Created",e.id),this._viewer.invalidate(),e},t.prototype._createRect=function(){var e=new dl(a.a.generateUUID(),this._viewer.getRenderScene());return e.setArrowStyle(this._arrowStyle),e.setWidth(this._rectWidth),this.marks.set(e.id,e),e.setColor(this.defaultColor?this.defaultColor:pl),e.setTransparent(this.defaultOpacity?this.defaultOpacity:.6),e.use(),this._viewer.notifyEventListener("MarkGraph-Created",e.id),this._viewer.invalidate(),e},t.prototype._setLineKeyPoints=function(e){var t=this._depthQuery.unproject(e.x,e.y,this._renderer,this._camera);this._drawing?t&&(e.button===e.LEFT_BUTTON?this._drawing.addKeyPoint(t,this._alignment):(this._drawing.stopDrawing(t,this._alignment),this._drawing=null)):e.button===e.LEFT_BUTTON&&(this._drawing=this._createLines(),t&&this._drawing.addKeyPoint(t,this._alignment)),this._viewer.invalidate()},t.prototype._setAreaKeyPoints=function(e){var t=this._depthQuery.unproject(e.x,e.y,this._renderer,this._camera);this._drawing?t&&(e.button===e.LEFT_BUTTON?this._drawing.addKeyPoint(t,this._alignment):(this._drawing.stopDrawing(t,this._alignment),this._drawing=null)):e.button===e.LEFT_BUTTON&&(this._drawing=this._createArea(),t&&this._drawing.addKeyPoint(t,this._alignment)),this._viewer.invalidate()},t.prototype._setRectKeyPoints=function(e){var t=this._depthQuery.unproject(e.x,e.y,this._renderer,this._camera);this._drawing?this._drawing&&(this._drawing.stopDrawing(t,this._alignment),this._drawing=null):e.button===e.LEFT_BUTTON&&(this._drawing=this._createRect(),t&&this._drawing.addKeyPoint(t,this._alignment)),this._viewer.invalidate()},t.prototype.reset=function(){var e=this;this.marks.forEach(function(t){e._viewer.notifyEventListener("MarkGraph-Removed",t.id),t.destory(),e.marks.delete(t.id)}),this._selectMarks=new Map,this._viewer.invalidate()},t.prototype.getMark=function(e){return this.marks.get(e)},t.prototype.remove=function(e){if("string"==typeof e){var t=this.getMark(e);this._viewer.notifyEventListener("MarkGraph-Removed",e),this._selectMarks.delete(e),this.marks.delete(e),t.destory()}else{var r=e.id;this._viewer.notifyEventListener("MarkGraph-Removed",r),this._selectMarks.delete(r),this.marks.delete(r),e.destory()}this._viewer.invalidate()},t.prototype.setRectWidth=function(e){this._rectWidth=e,this.marks.forEach(function(t){t instanceof dl&&t.setWidth(e)}),this._viewer.invalidate()},t.prototype.setPointSize=function(e){},t.prototype.setRectArrowMode=function(e){this._arrowStyle=e,this.marks.forEach(function(t){t instanceof dl&&t.setArrowStyle(e)}),this._viewer.invalidate()},t.prototype.setSelectType=function(e){this._selectType=e,this._viewer.invalidate()},t.prototype.getSelectMarks=function(){var e=[];return this._selectMarks.forEach(function(t){e.push(t)}),e},t.prototype.setDefaultColor=function(e,t){var r=this;e?(this.defaultColor=[],this.defaultColor[0]=e[0],this.defaultColor[1]=e[1],this.defaultColor[2]=e[2]):this.defaultColor=null,t&&this.marks.forEach(function(e){e.setColor(r.defaultColor?r.defaultColor:pl)}),this._viewer.invalidate()},t.prototype.setDefaultOpacity=function(e,t){var r=this;this.defaultOpacity=e||null,t&&this.marks.forEach(function(e){e.setTransparent(r.defaultOpacity?r.defaultOpacity:.6)}),this._viewer.invalidate()},t.prototype.setMarkDiffuse=function(e,t){("string"==typeof e?this.getMark(e):e).setColor(t),this._viewer.invalidate()},t.prototype.setMarkOpacity=function(e,t){("string"==typeof e?this.getMark(e):e).setTransparent(t),this._viewer.invalidate()},t.prototype.setContourColor=function(e){this._contour.setColor([e[0],e[1],e[2],1])},t.prototype.drawMark=function(e,t){switch(t){case es.POINT:this._drawPoint(e);break;case es.LINE:this._drawLine(e);break;case es.AREA:this._drawArea(e);break;case es.RECT:this._drwaRect(e)}},t.prototype._drawPoint=function(e){var t=new ul(a.a.generateUUID(),this._viewer.getRenderScene(),e);this.marks.set(t.id,t),t.setColor(this.defaultColor?this.defaultColor:pl),t.setTransparent(this.defaultOpacity?this.defaultOpacity:.6),t.use(),this._viewer.notifyEventListener("MarkGraph-Created",t.id),this._viewer.invalidate()},t.prototype._drawLine=function(e){if(e){var t=new cl(a.a.generateUUID(),this._viewer.getRenderScene());this.marks.set(t.id,t),t.setColor(this.defaultColor?this.defaultColor:pl),t.setTransparent(this.defaultOpacity?this.defaultOpacity:1),t.setWorldPoints(e),t.use(),this._viewer.notifyEventListener("MarkGraph-Created",t.id),this._viewer.invalidate()}},t.prototype._drawArea=function(e){if(e){var t=new hl(a.a.generateUUID(),this._viewer.getRenderScene());this.marks.set(t.id,t),t.setColor(this.defaultColor?this.defaultColor:pl),t.setTransparent(this.defaultOpacity?this.defaultOpacity:.6),t.setWorldPoints(e),t.use(),this._viewer.notifyEventListener("MarkGraph-Created",t.id),this._viewer.invalidate()}},t.prototype._drwaRect=function(e){if(e){var t=new dl(a.a.generateUUID(),this._viewer.getRenderScene());t.setArrowStyle(this._arrowStyle),t.setWidth(this._rectWidth),this.marks.set(t.id,t),t.setColor(this.defaultColor?this.defaultColor:pl),t.setTransparent(this.defaultOpacity?this.defaultOpacity:.6),t.setWorldPoints(e),t.use(),this._viewer.notifyEventListener("MarkGraph-Created",t.id),this._viewer.invalidate()}},t}(Zt.a);r.d(t,"a",function(){return sl}),function(e){!function(e){!function(e){e[e.LINES=0]="LINES",e[e.LINE=1]="LINE",e[e.LINESTRIP=2]="LINESTRIP",e[e.LINEFAN=3]="LINEFAN",e[e.ANGLE=4]="ANGLE",e[e.AREA=5]="AREA"}(e.MeasureType||(e.MeasureType={})),function(e){e.FEET="feet",e.INCHES="inches",e.CM="cm",e.M="m"}(e.MeasureUnit||(e.MeasureUnit={})),function(e){e[e.NONE=-1]="NONE",e[e.VERTEX=0]="VERTEX",e[e.EDGE=1]="EDGE",e[e.EDGE_MIDPOINT=2]="EDGE_MIDPOINT"}(e.SnappingMode||(e.SnappingMode={})),e.MeasureLine=bo,e.MeasureLineFan=Po,e.MeasureLines=To,e.MeasureLineStrip=Oo,e.MeasureAngle=Lo,e.MeasureArea=zo,e.Section=Ho,e.MagnifyGlass=Xo,e.SelectElements=is,e.CameraManipulator=nr,e.TransformGizmo=hs,e.Comment=ds.a,e.SelectModel=_s,e.CameraNavigator=os,e.BBoxSize=tl,e.MarkGraph=fl}(e.Tool||(e.Tool={})),function(e){e.Mouse=h,e.Keyboard=g,e.Touch=m}(e.Input||(e.Input={})),e.ViewAngle=ar.a,e.DrawMode=es,e.ArrowStyle=rs,e.SelectType=ts,function(e){e[e.SOLIDCOLOR=0]="SOLIDCOLOR",e[e.WALLPAPER=1]="WALLPAPER",e[e.EQUIRECTANGLE=2]="EQUIRECTANGLE",e[e.CUBEMAP=3]="CUBEMAP",e[e.WALLPAPER_TILED=4]="WALLPAPER_TILED"}(e.ViewBackground||(e.ViewBackground={})),e.State=i,e.Scene3D=Ct,e.Camera=or,e.Pawn=H,e.GLTFLoader=Ae,e.Text3D=Re,e.Text3DBillboard=ze,e.PawnBillboard=Ke,function(e){e.AnimatingRibbon=Xs,e.BarChart=ws,e.AnimatingStripe=Js,e.HeatMap=As,e.HeightMap=Ps,e.MetaBall=Ds,e.Trail=Rs,e.Volume=Fs,e.MultiLayerVolume=Us,e.MultiLayerColor=qs}(e.Visualize||(e.Visualize={})),e.Viewer3D=ba,e.Viewer3DBase=kn,e.Viewer360=qa,e.Viewer360Base=Na,e.Viewer3DCompare=Ja,e.Viewer3DDark=ro,e.PathFollowingAnimator=ls}(sl||(sl={}))},function(e,t,r){"use strict";t.a=function(){var e=function(e){return'<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+e+"</div></div></td></tr></table>"},t=function(e,t){var r=null;if(t.webgl2){if(r=e.getContext("webgl2",t),console.log("Try to use webgl2.0."),!!r)return r;console.warn("webgl2.0 is not supported on this browser!")}for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=0;n<i.length;++n){try{r=e.getContext(i[n],t)}catch(e){}if(r)break}return r};return window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout(e,1e3/60)},window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout,{create3DContext:t,setupWebGL:function(r,i){return window.WebGLRenderingContext?t(r,i):(function(t){var i=r.parentNode;i&&(i.innerHTML=e(t))}('This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>'),null)}}}},function(e,t,r){"use strict";r.d(t,"a",function(){return s});var i,n=r(26),a=(r(20),function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})}),o=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};!function(e){e.Architect="Architect",e.Product="Product"}(i||(i={}));var s,l={};!function(e){!function(e){e.Architect="Architect",e.Product="Product"}(e.ModelShaderSetting||(e.ModelShaderSetting={})),e.get=function(e){return a(this,void 0,void 0,function(){return o(this,function(t){return[2,new Promise(function(t,r){n.i(e).then(function(e){return e.forEach(function(e){l[e.id]=e}),t(e)}).catch(r)})]})})},e.create=function(e,t){return a(this,void 0,void 0,function(){return o(this,function(r){return[2,n.c(e,t)]})})},e.update=function(e,t){return a(this,void 0,void 0,function(){return o(this,function(r){return[2,n.n(e,t)]})})},e.remove=function(e){return a(this,void 0,void 0,function(){return o(this,function(t){return[2,n.d(e)]})})}}(s||(s={}))},function(e,t,r){"use strict";(function(e,i){function n(e){return e.arrayBuffer?e.arrayBuffer():new Promise((t,r)=>{const i=new FileReader;i.addEventListener("loadend",()=>{t(i.result)}),i.addEventListener("error",r),i.readAsArrayBuffer(e)})}async function a(e){const t=await n(e);return new Uint8Array(t)}function o(e){return"undefined"!=typeof Blob&&e instanceof Blob}function s(e){return"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}r.d(t,"a",function(){return ie});const l=void 0!==e&&e.versions&&void 0!==e.versions.node&&void 0===e.versions.electron;class u{constructor(e){this.typedArray=e instanceof ArrayBuffer||s(e)?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}async getLength(){return this.typedArray.byteLength}async read(e,t){return new Uint8Array(this.typedArray.buffer,this.typedArray.byteOffset+e,t)}}class c{constructor(e){this.blob=e}async getLength(){return this.blob.size}async read(e,t){const r=this.blob.slice(e,e+t),i=await n(r);return new Uint8Array(i)}async sliceAsBlob(e,t,r=""){return this.blob.slice(e,e+t,r)}}function h(e,t){var r=e.length;if(t<=r)return e;var i=new Uint8Array(Math.max(r<<1,t));return i.set(e,0),i}function d(e,t,r,i,n,a){for(var o=v,s=g,l=0;l<r;){var u=e[s(i,n)&t];n+=15&u;var c=u>>>4;if(c<=15)a[l]=c,l++;else{var h=0,d=0;16==c?(d=3+o(i,n,2),n+=2,h=a[l-1]):17==c?(d=3+o(i,n,3),n+=3):18==c&&(d=11+o(i,n,7),n+=7);for(var p=l+d;l<p;)a[l]=h,l++}}return n}function p(e,t,r,i){for(var n=0,a=0,o=i.length>>>1;a<r;){var s=e[a+t];i[a<<1]=0,i[1+(a<<1)]=s,s>n&&(n=s),a++}for(;a<o;)i[a<<1]=0,i[1+(a<<1)]=0,a++;return n}function f(e,t){for(var r,i,n,a,o=e.length,s=b.bl_count,l=0;l<=t;l++)s[l]=0;for(l=1;l<o;l+=2)s[e[l]]++;var u=b.next_code;for(r=0,s[0]=0,i=1;i<=t;i++)r=r+s[i-1]<<1,u[i]=r;for(n=0;n<o;n+=2)0!=(a=e[n+1])&&(e[n]=u[a],u[a]++)}function m(e,t,r){for(var i=e.length,n=b.rev15,a=0;a<i;a+=2)if(0!=e[a+1])for(var o=a>>1,s=e[a+1],l=o<<4|s,u=t-s,c=e[a]<<u,h=c+(1<<u);c!=h;){r[n[c]>>>15-t]=l,c++}}function _(e,t){for(var r=b.rev15,i=15-t,n=0;n<e.length;n+=2){var a=e[n]<<t-e[n+1];e[n]=r[a]>>>i}}function v(e,t,r){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<r)-1}function y(e,t,r){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<r)-1}function g(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)}const b=function(){var e=Uint16Array,t=Uint32Array;return{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new t(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(32768),lhst:new t(286),dhst:new t(30),ihst:new t(19),lits:new t(15e3),strt:new e(65536),prev:new e(32768)}}();!function(){for(var e=0;e<32768;e++){var t=e;t=(4278255360&(t=(4042322160&(t=(3435973836&(t=(2863311530&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8,b.rev15[e]=(t>>>16|t<<16)>>>17}function r(e,t,r){for(;0!=t--;)e.push(0,r)}for(e=0;e<32;e++)b.ldef[e]=b.of0[e]<<3|b.exb[e],b.ddef[e]=b.df0[e]<<4|b.dxb[e];r(b.fltree,144,8),r(b.fltree,112,9),r(b.fltree,24,7),r(b.fltree,8,8),f(b.fltree,9),m(b.fltree,9,b.flmap),_(b.fltree,9),r(b.fdtree,32,5),f(b.fdtree,5),m(b.fdtree,5,b.fdmap),_(b.fdtree,5),r(b.itree,19,0),r(b.ltree,286,0),r(b.dtree,30,0),r(b.ttree,320,0)}();const w={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var r=t,i=0;i<8;i++)1&r?r=3988292384^r>>>1:r>>>=1;e[t]=r}return e}(),update:function(e,t,r,i){for(var n=0;n<i;n++)e=w.table[255&(e^t[r+n])]^e>>>8;return e},crc:function(e,t,r){return 4294967295^w.update(4294967295,e,t,r)}};function x(e,t){return function(e,t){var r=Uint8Array;if(3==e[0]&&0==e[1])return t||new r(0);var i=y,n=v,a=d,o=g,s=null==t;s&&(t=new r(e.length>>>2<<3));for(var l,u,c=0,_=0,w=0,x=0,M=0,T=0,E=0,S=0,A=0;0==c;)if(c=i(e,A,1),_=i(e,A+1,2),A+=3,0!=_){if(s&&(t=h(t,S+(1<<17))),1==_&&(l=b.flmap,u=b.fdmap,T=511,E=31),2==_){w=n(e,A,5)+257,x=n(e,A+5,5)+1,M=n(e,A+10,4)+4,A+=14;for(var k=0;k<38;k+=2)b.itree[k]=0,b.itree[k+1]=0;var P=1;for(k=0;k<M;k++){var N=n(e,A+3*k,3);b.itree[1+(b.ordr[k]<<1)]=N,N>P&&(P=N)}A+=3*M,f(b.itree,P),m(b.itree,P,b.imap),l=b.lmap,u=b.dmap,A=a(b.imap,(1<<P)-1,w+x,e,A,b.ttree);var D=p(b.ttree,0,w,b.ltree);T=(1<<D)-1;var I=p(b.ttree,w,x,b.dtree);E=(1<<I)-1,f(b.ltree,D),m(b.ltree,D,l),f(b.dtree,I),m(b.dtree,I,u)}for(;;){var O=l[o(e,A)&T];A+=15&O;var R=O>>>4;if(R>>>8==0)t[S++]=R;else{if(256==R)break;var C=S+R-254;if(R>264){var B=b.ldef[R-257];C=S+(B>>>3)+n(e,A,7&B),A+=7&B}var L=u[o(e,A)&E];A+=15&L;var F=L>>>4,V=b.ddef[F],U=(V>>>4)+i(e,A,15&V);for(A+=15&V,s&&(t=h(t,S+(1<<17)));S<C;)t[S]=t[S++-U],t[S]=t[S++-U],t[S]=t[S++-U],t[S]=t[S++-U];S=C}}}else{0!=(7&A)&&(A+=8-(7&A));var z=4+(A>>>3),j=e[z-4]|e[z-3]<<8;s&&(t=h(t,S+j)),t.set(new r(e.buffer,e.byteOffset+z,j),S),A=z+j<<3,S+=j}return t.length==S?t:t.slice(0,S)}(e,t)}const M={numWorkers:1,workerURL:"",useWorkers:!1};let T=0,E=0,S=!0;const A=[],k=[],P=[],N=new Map;function D(e){R(e.target);const{id:t,error:r,data:i}=e.data,n=N.get(t);N.delete(t),r?n.reject(r):n.resolve(i)}function I(e){return new Promise((t,r)=>{const i=new Worker(e);i.onmessage=(e=>{"start"===e.data?(i.onerror=void 0,i.onmessage=void 0,t(i)):r(new Error(`unexpected message: ${e.data}`))}),i.onerror=r})}const O=function(){if(l){const{Worker:e}=function(e,t){return e.require(t)}(i,"worker_threads");return{createWorker:async t=>new e(t),addEventListener(e,t){e.on("message",r=>{t({target:e,data:r})})},async terminate(e){await e.terminate()}}}return{async createWorker(e){try{return await I(e)}catch(t){console.warn("could not load worker:",e)}let t;try{const r=await fetch(e,{mode:"cors"});if(!r.ok)throw new Error(`could not load: ${e}`);t=await r.text(),e=URL.createObjectURL(new Blob([t],{type:"application/javascript"}));const i=await I(e);return M.workerURL=e,i}catch(t){console.warn("could not load worker via fetch:",e)}if(void 0!==t)try{e=`data:application/javascript;base64,${btoa(t)}`;const r=await I(e);return M.workerURL=e,r}catch(e){console.warn("could not load worker via dataURI")}throw console.warn("workers will not be used"),new Error("can not start workers")},addEventListener(e,t){e.addEventListener("message",t)},async terminate(e){e.terminate()}}}();function R(e){k.push(e),B()}function C(e,t,r,i){const n=new Uint8Array(t);x(e,n),i(r?new Blob([n],{type:r}):n.buffer)}async function B(){if(0!==P.length){if(M.useWorkers&&S){const e=await async function(){if(0===k.length&&E<M.numWorkers){++E;try{const e=await O.createWorker(M.workerURL);A.push(e),k.push(e),O.addEventListener(e,D)}catch(e){S=!1}}return k.pop()}();if(S){if(e){if(0===P.length)return void R(e);const{id:t,src:r,uncompressedSize:i,type:n,resolve:a,reject:o}=P.shift();N.set(t,{id:t,resolve:a,reject:o});const s=[];e.postMessage({type:"inflate",data:{id:t,type:n,src:r,uncompressedSize:i}},s)}return}}for(;P.length;){const{src:e,uncompressedSize:t,type:r,resolve:i}=P.shift();let n=e;o(e)&&(n=await a(e)),C(n,t,r,i)}}}function L(e,t,r){return new Promise((i,n)=>{P.push({src:e,uncompressedSize:t,type:r,resolve:i,reject:n,id:T++}),B()})}class F{constructor(e,t){this._reader=e,this._rawEntry=t,this.name=t.name,this.nameBytes=t.nameBytes,this.size=t.uncompressedSize,this.compressedSize=t.compressedSize,this.comment=t.comment,this.commentBytes=t.commentBytes,this.compressionMethod=t.compressionMethod,this.lastModDate=function(e,t){return new Date(1980+(e>>9&127),(e>>5&15)-1,31&e,t>>11&31,t>>5&63,2*(31&t),0)}(t.lastModFileDate,t.lastModFileTime),this.isDirectory=0===t.uncompressedSize&&t.name.endsWith("/"),this.encrypted=!!(1&t.generalPurposeBitFlag)}async blob(e="application/octet-stream"){return await async function(e,t,r){const{decompress:i,fileDataStart:n}=await te(e,t);if(!i){const i=await q(e,n,t.compressedSize,r);return o(i)?i:new Blob([s(i.buffer)?new Uint8Array(i):i],{type:r})}const a=await q(e,n,t.compressedSize);return await L(a,t.uncompressedSize,r)}(this._reader,this._rawEntry,e)}async arrayBuffer(){return await async function(e,t){const{decompress:r,fileDataStart:i}=await te(e,t);if(!r){const r=await G(e,i,t.compressedSize);return function(e){return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength}(r)?r.buffer:r.slice().buffer}const n=await q(e,i,t.compressedSize);return await L(n,t.uncompressedSize)}(this._reader,this._rawEntry)}async text(){const e=await this.arrayBuffer();return Z(new Uint8Array(e))}async json(){const e=await this.text();return JSON.parse(e)}}const V=22,U=65535,z=101010256,j=101075792;async function G(e,t,r){return await e.read(t,r)}async function q(e,t,r,i){return e.sliceAsBlob?await e.sliceAsBlob(t,r,i):await e.read(t,r)}const Q={unsigned:()=>0};function H(e,t){return e[t]+256*e[t+1]}function W(e,t){return e[t]+256*e[t+1]+65536*e[t+2]+16777216*e[t+3]}function Y(e,t){return W(e,t)+4294967296*W(e,t+4)}const X=new TextDecoder;function Z(e,t){return s(e.buffer)&&(e=new Uint8Array(e)),X.decode(e)}const K=117853008;async function J(e,t,r,i){const n=t-20,a=await G(e,n,20);if(W(a,0)!==K)throw new Error("invalid zip64 end of central directory locator signature");const o=Y(a,8),s=await G(e,o,56);if(W(s,0)!==j)throw new Error("invalid zip64 end of central directory record signature");const l=Y(s,32),u=Y(s,40);return ee(e,Y(s,48),u,l,r,i)}const $=33639248;async function ee(e,t,r,i,n,a){let o=0;const s=await G(e,t,r),l=[];for(let e=0;e<i;++e){const e=s.subarray(o,o+46),t=W(e,0);if(t!==$)throw new Error(`invalid central directory file header signature: 0x${t.toString(16)}`);const r={versionMadeBy:H(e,4),versionNeededToExtract:H(e,6),generalPurposeBitFlag:H(e,8),compressionMethod:H(e,10),lastModFileTime:H(e,12),lastModFileDate:H(e,14),crc32:W(e,16),compressedSize:W(e,20),uncompressedSize:W(e,24),fileNameLength:H(e,28),extraFieldLength:H(e,30),fileCommentLength:H(e,32),internalFileAttributes:H(e,36),externalFileAttributes:W(e,38),relativeOffsetOfLocalHeader:W(e,42)};if(64&r.generalPurposeBitFlag)throw new Error("strong encryption is not supported");o+=46;const i=s.subarray(o,o+r.fileNameLength+r.extraFieldLength+r.fileCommentLength);r.nameBytes=i.slice(0,r.fileNameLength),r.name=Z(r.nameBytes);const n=r.fileNameLength+r.extraFieldLength,a=i.slice(r.fileNameLength,n);r.extraFields=[];let u=0;for(;u<a.length-3;){const e=H(a,u+0),t=u+4,i=t+H(a,u+2);if(i>a.length)throw new Error("extra field length exceeds extra field buffer size");r.extraFields.push({id:e,data:a.slice(t,i)}),u=i}if(r.commentBytes=i.slice(n,n+r.fileCommentLength),r.comment=Z(r.commentBytes),o+=i.length,4294967295===r.uncompressedSize||4294967295===r.compressedSize||4294967295===r.relativeOffsetOfLocalHeader){const e=r.extraFields.find(e=>1===e.id);if(!e)return new Error("expected zip64 extended information extra field");const t=e.data;let i=0;if(4294967295===r.uncompressedSize){if(i+8>t.length)throw new Error("zip64 extended information extra field does not include uncompressed size");r.uncompressedSize=Y(t,i),i+=8}if(4294967295===r.compressedSize){if(i+8>t.length)throw new Error("zip64 extended information extra field does not include compressed size");r.compressedSize=Y(t,i),i+=8}if(4294967295===r.relativeOffsetOfLocalHeader){if(i+8>t.length)throw new Error("zip64 extended information extra field does not include relative header offset");r.relativeOffsetOfLocalHeader=Y(t,i),i+=8}}const c=r.extraFields.find(e=>28789===e.id&&e.data.length>=6&&1===e.data[0]&&W(e.data,1),Q.unsigned(r.nameBytes));if(c&&(r.fileName=Z(c.data.slice(5))),0===r.compressionMethod){let e=r.uncompressedSize;if(0!=(1&r.generalPurposeBitFlag)&&(e+=12),r.compressedSize!==e)throw new Error(`compressed size mismatch for stored file: ${r.compressedSize} != ${e}`)}l.push(r)}return{zip:{comment:n,commentBytes:a},entries:l.map(t=>new F(e,t))}}async function te(e,t){if(1&t.generalPurposeBitFlag)throw new Error("encrypted entries not supported");const r=await G(e,t.relativeOffsetOfLocalHeader,30),i=await e.getLength(),n=W(r,0);if(67324752!==n)throw new Error(`invalid local file header signature: 0x${n.toString(16)}`);const a=H(r,26),o=H(r,28),s=t.relativeOffsetOfLocalHeader+r.length+a+o;let l;if(0===t.compressionMethod)l=!1;else{if(8!==t.compressionMethod)throw new Error(`unsupported compression method: ${t.compressionMethod}`);l=!0}const u=s,c=u+t.compressedSize;if(0!==t.compressedSize&&c>i)throw new Error(`file data overflows file bounds: ${u} +  ${t.compressedSize}  > ${i}`);return{decompress:l,fileDataStart:u}}async function re(e){let t;if("undefined"!=typeof Blob&&e instanceof Blob)t=new c(e);else if(e instanceof ArrayBuffer||e&&e.buffer&&e.buffer instanceof ArrayBuffer)t=new u(e);else if(s(e)||s(e.buffer))t=new u(e);else if("string"==typeof e){const r=await fetch(e);if(!r.ok)throw new Error(`failed http request ${e}, status: ${r.status}: ${r.statusText}`);const i=await r.blob();t=new c(i)}else{if("function"!=typeof e.getLength||"function"!=typeof e.read)throw new Error("unsupported source type");t=e}const r=await t.getLength();if(r>Number.MAX_SAFE_INTEGER)throw new Error(`file too large. size: ${r}. Only file sizes up 4503599627370496 bytes are supported`);return await async function(e,t){const r=Math.min(V+U,t),i=t-r,n=await G(e,i,r);for(let t=r-V;t>=0;--t){if(W(n,t)!==z)continue;const r=new Uint8Array(n.buffer,n.byteOffset+t,n.byteLength-t),a=H(r,4);if(0!==a)throw new Error(`multi-volume zip files are not supported. This is volume: ${a}`);const o=H(r,10),s=W(r,12),l=W(r,16),u=H(r,20),c=r.length-V;if(u!==c)throw new Error(`invalid comment length. expected: ${c}, actual: ${u}`);const h=new Uint8Array(r.buffer,r.byteOffset+22,u),d=Z(h);return 65535===o||4294967295===l?await J(e,i+t,d,h):await ee(e,l,s,o,d,h)}throw new Error("could not find end of central directory. maybe not zip file")}(t,r)}async function ie(e){const{zip:t,entries:r}=await re(e);return{zip:t,entries:Object.fromEntries(r.map(e=>[e.name,e]))}}}).call(this,r(52),r(64)(e))},function(e,t,r){var i;
/*!
 * UAParser.js v0.7.23
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright © 2012-2019 Faisal Salman <f@faisalman.com>
 * Licensed under MIT License
 */
/*!
 * UAParser.js v0.7.23
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright © 2012-2019 Faisal Salman <f@faisalman.com>
 * Licensed under MIT License
 */
!function(n,a){"use strict";var o="model",s="name",l="type",u="vendor",c="version",h="mobile",d="tablet",p="smarttv",f={extend:function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},m={rgx:function(e,t){for(var r,i,n,a,o,s,l=0;l<t.length&&!o;){var u=t[l],c=t[l+1];for(r=i=0;r<u.length&&!o;)if(o=u[r++].exec(e))for(n=0;n<c.length;n++)s=o[++i],"object"==typeof(a=c[n])&&a.length>0?2==a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,s):this[a[0]]=a[1]:3==a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=s?s.replace(a[1],a[2]):void 0:this[a[0]]=s?a[1].call(this,s,a[2]):void 0:4==a.length&&(this[a[0]]=s?a[3].call(this,s.replace(a[1],a[2])):void 0):this[a]=s||void 0;l+=2}},str:function(e,t){for(var r in t)if("object"==typeof t[r]&&t[r].length>0){for(var i=0;i<t[r].length;i++)if(f.has(t[r][i],e))return"?"===r?void 0:r}else if(f.has(t[r],e))return"?"===r?void 0:r;return e}},_={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},v={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6}).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[s,c],[/(opios)[\/\s]+([\w\.]+)/i],[[s,"Opera Mini"],c],[/\s(opr)\/([\w\.]+)/i],[[s,"Opera"],c],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[s,c],[/(konqueror)\/([\w\.]+)/i],[[s,"Konqueror"],c],[/(trident).+rv[:\s]([\w\.]{1,9}).+like\sgecko/i],[[s,"IE"],c],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[s,"Edge"],c],[/(yabrowser)\/([\w\.]+)/i],[[s,"Yandex"],c],[/(Avast)\/([\w\.]+)/i],[[s,"Avast Secure Browser"],c],[/(AVG)\/([\w\.]+)/i],[[s,"AVG Secure Browser"],c],[/(puffin)\/([\w\.]+)/i],[[s,"Puffin"],c],[/(focus)\/([\w\.]+)/i],[[s,"Firefox Focus"],c],[/(opt)\/([\w\.]+)/i],[[s,"Opera Touch"],c],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[s,"UCBrowser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],c],[/(windowswechat qbcore)\/([\w\.]+)/i],[[s,"WeChat(Win) Desktop"],c],[/(micromessenger)\/([\w\.]+)/i],[[s,"WeChat"],c],[/(brave)\/([\w\.]+)/i],[[s,"Brave"],c],[/(whale)\/([\w\.]+)/i],[[s,"Whale"],c],[/(qqbrowserlite)\/([\w\.]+)/i],[s,c],[/(QQ)\/([\d\.]+)/i],[s,c],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[s,c],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[s,c],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[s,c],[/(MetaSr)[\/\s]?([\w\.]+)/i],[s],[/(LBBROWSER)/i],[s],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[c,[s,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[c,[s,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[s,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[s,c],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[c,[s,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[s,/(.+)/,"$1 WebView"],c],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[s,/(.+(?:g|us))(.+)/,"$1 $2"],c],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[c,[s,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[s,"Sailfish Browser"],c],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[s,c],[/(dolfin)\/([\w\.]+)/i],[[s,"Dolphin"],c],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[s,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[s,"Chrome"],c],[/(coast)\/([\w\.]+)/i],[[s,"Opera Coast"],c],[/fxios\/([\w\.-]+)/i],[c,[s,"Firefox"]],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[c,[s,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[c,s],[/webkit.+?(gsa)\/([\w\.]+)\s.*(mobile\s?safari|safari)(\/[\w\.]+)/i],[[s,"GSA"],c],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s,[c,m.str,_.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[s,c],[/(navigator|netscape)\/([\w\.-]+)/i],[[s,"Netscape"],c],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s,c]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",f.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",f.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",f.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[o,u,[l,d]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[u,"Apple"],[l,d]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[u,"Apple"],[l,p]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,o,[l,d]],[/(kf[A-z]+)(\sbuild\/|\)).+silk\//i],[o,[u,"Amazon"],[l,d]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[o,m.str,_.device.amazon.model],[u,"Amazon"],[l,h]],[/android.+aft([bms])\sbuild/i],[o,[u,"Amazon"],[l,p]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,u,[l,h]],[/\((ip[honed|\s\w*]+);/i],[o,[u,"Apple"],[l,h]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,o,[l,h]],[/\(bb10;\s(\w+)/i],[o,[u,"BlackBerry"],[l,h]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[o,[u,"Asus"],[l,d]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[o,"Xperia Tablet"],[l,d]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[u,"Sony"],[l,h]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[u,o,[l,"console"]],[/android.+;\s(shield)\sbuild/i],[o,[u,"Nvidia"],[l,"console"]],[/(playstation\s[34portablevi]+)/i],[o,[u,"Sony"],[l,"console"]],[/(sprint\s(\w+))/i],[[u,m.str,_.device.sprint.vendor],[o,m.str,_.device.sprint.model],[l,h]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[u,[o,/_/g," "],[l,h]],[/(nexus\s9)/i],[o,[u,"HTC"],[l,d]],[/d\/huawei([\w\s-]+)[;\)]/i,/android.+\s(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?)/i],[o,[u,"Huawei"],[l,h]],[/android.+(bah2?-a?[lw]\d{2})/i],[o,[u,"Huawei"],[l,d]],[/(microsoft);\s(lumia[\s\w]+)/i],[u,o,[l,h]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[u,"Microsoft"],[l,"console"]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[u,"Microsoft"],[l,h]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[u,"Motorola"],[l,h]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[u,"Motorola"],[l,d]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[u,f.trim],[o,f.trim],[l,p]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[u,"Samsung"],[l,p]],[/\(dtv[\);].+(aquos)/i],[o,[u,"Sharp"],[l,p]],[/android.+((sch-i[89]0\d|shw-m380s|SM-P605|SM-P610|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],o,[l,d]],[/smart-tv.+(samsung)/i],[u,[l,p],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[u,"Samsung"],o,[l,h]],[/sie-(\w*)/i],[o,[u,"Siemens"],[l,h]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[u,"Nokia"],o,[l,h]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[o,[u,"Acer"],[l,d]],[/android.+([vl]k\-?\d{3})\s+build/i],[o,[u,"LG"],[l,d]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],o,[l,d]],[/linux;\snetcast.+smarttv/i,/lg\snetcast\.tv-201\d/i],[[u,"LG"],o,[l,p]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[o,[u,"LG"],[l,h]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[u,o,[l,d]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[u,"Lenovo"],[l,d]],[/(lenovo)[_\s-]?([\w-]+)/i],[u,o,[l,h]],[/linux;.+((jolla));/i],[u,o,[l,h]],[/((pebble))app\/[\d\.]+\s/i],[u,o,[l,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[u,o,[l,h]],[/crkey/i],[[o,"Chromecast"],[u,"Google"],[l,p]],[/android.+;\s(glass)\s\d/i],[o,[u,"Google"],[l,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[o,[u,"Google"],[l,d]],[/android.+;\s(pixel( [2-9]a?)?( xl)?)[\s)]/i],[o,[u,"Google"],[l,h]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/android.+(redmi[\s\-_]?(?:note|k)?(?:[\s_]?[\w\s]+))(?:\sbuild|\))/i,/android.+(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[o,/_/g," "],[u,"Xiaomi"],[l,h]],[/android.+(mi[\s\-_]?(?:pad)(?:[\s_]?[\w\s]+))(?:\sbuild|\))/i],[[o,/_/g," "],[u,"Xiaomi"],[l,d]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[o,[u,"Meizu"],[l,h]],[/(mz)-([\w-]{2,})/i],[[u,"Meizu"],o,[l,h]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[o,[u,"OnePlus"],[l,h]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[o,[u,"RCA"],[l,d]],[/android.+[;\/\s](Venue[\d\s]{2,7})\s+build/i],[o,[u,"Dell"],[l,d]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[o,[u,"Verizon"],[l,d]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[u,"Barnes & Noble"],o,[l,d]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[o,[u,"NuVision"],[l,d]],[/android.+;\s(k88)\sbuild/i],[o,[u,"ZTE"],[l,d]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[o,[u,"Swiss"],[l,h]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[o,[u,"Swiss"],[l,d]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[o,[u,"Zeki"],[l,d]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[u,"Dragon Touch"],o,[l,d]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[o,[u,"Insignia"],[l,d]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[o,[u,"NextBook"],[l,d]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[u,"Voice"],o,[l,h]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[u,"LvTel"],o,[l,h]],[/android.+;\s(PH-1)\s/i],[o,[u,"Essential"],[l,h]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[o,[u,"Envizen"],[l,d]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[u,o,[l,d]],[/android.+[;\/]\s*(Trio[\s\w\-\.]+)\s+build/i],[o,[u,"MachSpeed"],[l,d]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[u,o,[l,d]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[o,[u,"Rotor"],[l,d]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[u,o,[l,d]],[/android .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[o,[l,h]],[/android .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[o,[l,d]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[l,f.lowerize],u,o],[/[\s\/\(](smart-?tv)[;\)]/i],[[l,p]],[/(android[\w\.\s\-]{0,9});.+build/i],[o,[u,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[c,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[c,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,c],[/rv\:([\w\.]{1,9}).+(gecko)/i],[c,s]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[s,c],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[c,m.str,_.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[c,m.str,_.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],c],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[s,c],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[s,"Symbian"],c],[/\((series40);/i],[s],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],c],[/crkey\/([\d\.]+)/i],[c,[s,"Chromecast"]],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[s,c],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],c],[/(sunos)\s?([\w\.\d]*)/i],[[s,"Solaris"],c],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[s,c],[/(haiku)\s(\w+)/i],[s,c],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[c,/_/g,"."],[s,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[s,"Mac OS"],[c,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[s,c]]},y=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof y))return new y(e,t).getResult();var r=e||(n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:""),i=t?f.extend(v,t):v;return this.getBrowser=function(){var e={name:void 0,version:void 0};return m.rgx.call(e,r,i.browser),e.major=f.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return m.rgx.call(e,r,i.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return m.rgx.call(e,r,i.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return m.rgx.call(e,r,i.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return m.rgx.call(e,r,i.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=e,this},this};y.VERSION="0.7.23",y.BROWSER={NAME:s,MAJOR:"major",VERSION:c},y.CPU={ARCHITECTURE:"architecture"},y.DEVICE={MODEL:o,VENDOR:u,TYPE:l,CONSOLE:"console",MOBILE:h,SMARTTV:p,TABLET:d,WEARABLE:"wearable",EMBEDDED:"embedded"},y.ENGINE={NAME:s,VERSION:c},y.OS={NAME:s,VERSION:c},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=y),t.UAParser=y):void 0===(i=function(){return y}.call(t,r,t,e))||(e.exports=i);var g=n&&(n.jQuery||n.Zepto);if(g&&!g.ua){var b=new y;g.ua=b.getResult(),g.ua.get=function(){return b.getUA()},g.ua.set=function(e){b.setUA(e);var t=b.getResult();for(var r in t)g.ua[r]=t[r]}}}("object"==typeof window?window:this)},function(e,t,r){"use strict";(function(e){var r=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var r=-1;return e.some(function(e,i){return e[0]===t&&(r=i,!0)}),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var r=e(this.__entries__,t),i=this.__entries__[r];return i&&i[1]},t.prototype.set=function(t,r){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,i=e(r,t);~i&&r.splice(i,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,i=this.__entries__;r<i.length;r++){var n=i[r];e.call(t,n[1],n[0])}},t}()}(),i="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,n=void 0!==e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(n):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},o=2;var s=20,l=["top","right","bottom","left","width","height","size","weight"],u="undefined"!=typeof MutationObserver,c=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var r=!1,i=!1,n=0;function s(){r&&(r=!1,e()),i&&u()}function l(){a(s)}function u(){var e=Date.now();if(r){if(e-n<o)return;i=!0}else r=!0,i=!1,setTimeout(l,t);n=e}return u}(this.refresh.bind(this),s)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},e.prototype.connect_=function(){i&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),u?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){i&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=void 0===t?"":t;l.some(function(e){return!!~r.indexOf(e)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),h=function(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var n=i[r];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},d=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||n},p=g(0,0,0,0);function f(e){return parseFloat(e)||0}function m(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce(function(t,r){return t+f(e["border-"+r+"-width"])},0)}function _(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return p;var i=d(e).getComputedStyle(e),n=function(e){for(var t={},r=0,i=["top","right","bottom","left"];r<i.length;r++){var n=i[r],a=e["padding-"+n];t[n]=f(a)}return t}(i),a=n.left+n.right,o=n.top+n.bottom,s=f(i.width),l=f(i.height);if("border-box"===i.boxSizing&&(Math.round(s+a)!==t&&(s-=m(i,"left","right")+a),Math.round(l+o)!==r&&(l-=m(i,"top","bottom")+o)),!function(e){return e===d(e).document.documentElement}(e)){var u=Math.round(s+a)-t,c=Math.round(l+o)-r;1!==Math.abs(u)&&(s-=u),1!==Math.abs(c)&&(l-=c)}return g(n.left,n.top,s,l)}var v="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof d(e).SVGGraphicsElement}:function(e){return e instanceof d(e).SVGElement&&"function"==typeof e.getBBox};function y(e){return i?v(e)?function(e){var t=e.getBBox();return g(0,0,t.width,t.height)}(e):_(e):p}function g(e,t,r,i){return{x:e,y:t,width:r,height:i}}var b=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=g(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=y(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),w=function(){return function(e,t){var r=function(e){var t=e.x,r=e.y,i=e.width,n=e.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,o=Object.create(a.prototype);return h(o,{x:t,y:r,width:i,height:n,top:r,right:t+i,bottom:n+r,left:t}),o}(t);h(this,{target:e,contentRect:r})}}(),x=function(){function e(e,t,i){if(this.activeObservations_=[],this.observations_=new r,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof d(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new b(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof d(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new w(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),M="undefined"!=typeof WeakMap?new WeakMap:new r,T=function(){return function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=c.getInstance(),i=new x(t,r,this);M.set(this,i)}}();["observe","unobserve","disconnect"].forEach(function(e){T.prototype[e]=function(){var t;return(t=M.get(this))[e].apply(t,arguments)}});var E=void 0!==n.ResizeObserver?n.ResizeObserver:T;t.a=E}).call(this,r(60))},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i,n=r(26),a=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},o=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};!function(e){!function(e){e.Family="family",e.Level="level",e.Element="element",e.Category="category",e.Type="type",e.File="file"}(e.BIMTreeNodeType||(e.BIMTreeNodeType={})),e.getElementProperties=function(e,t,r){return a(this,void 0,void 0,function(){return o(this,function(i){return[2,n.f(e,t,r)]})})},e.getElementsProperties=function(e,t){return a(this,void 0,void 0,function(){return o(this,function(r){return[2,n.g(e,t)]})})},e.addCustomElementProperty=function(e,t,r,i){return a(this,void 0,void 0,function(){return o(this,function(a){return[2,n.a(e,t,r,i)]})})},e.addCustomElementsProperty=function(e,t,r,i){return a(this,void 0,void 0,function(){return o(this,function(a){return[2,n.b(e,t,r,i)]})})},e.removeCustomElementProperty=function(e,t,r){return a(this,void 0,void 0,function(){return o(this,function(i){return[2,n.j(e,t,r)]})})},e.removeCustomElementsProperty=function(e,t,r){return a(this,void 0,void 0,function(){return o(this,function(i){return[2,n.k(e,t,r)]})})},e.updateElementProperty=function(e,t,r){return a(this,void 0,void 0,function(){return o(this,function(i){return[2,n.l(e,t,r)]})})},e.updateElementsProperty=function(e,t,r){return a(this,void 0,void 0,function(){return o(this,function(i){return[2,n.m(e,t,r)]})})},e.getTreeInfo=function(e,t){return a(this,void 0,void 0,function(){return o(this,function(r){return[2,n.e(e,t)]})})}}(i||(i={}))},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i,n=r(45),a=r(25),o=r(37),s=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},l=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};!function(e){e.upload=function(e,t){return s(this,void 0,void 0,function(){var r,i,s;return l(this,function(l){return function(e){return"object"==typeof e&&null!==e}(t)?(r=t.onProgress,s=void 0===r?function(){}:r,(i=t.type)&&Object(a.b)(i,Object(a.g)([o.b.File,o.b.Dwg,o.b.Img,o.b.Wbs,o.b.ModelConvertedPdf,o.b.Image360]),"asset type not supported"),[2,Object(n.d)(e,i,s)]):(s=t||function(){},[2,Object(n.d)(e,null,s)])})})},e.get=function(e){return s(this,void 0,void 0,function(){return l(this,function(t){return[2,Object(n.b)(e)]})})},e.remove=function(e){return s(this,void 0,void 0,function(){return l(this,function(t){return[2,Object(n.a)(e)]})})},e.update=function(e,t){return s(this,void 0,void 0,function(){return l(this,function(r){return[2,Object(n.c)(e,t)]})})}}(i||(i={}))},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateModelRenderSetting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Id"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enhancedRendering"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acceleratedRendering"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"architectEffect"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"penDetail"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inkContrast"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"blackAndWhite"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shadow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"brightness"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"latitude"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"longitude"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"materials"}},type:{kind:"NamedType",name:{kind:"Name",value:"JSONObject"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundMode"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundColor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundImage"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reflectionImage"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shader"}},type:{kind:"NamedType",name:{kind:"Name",value:"ModelShaderSetting"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateModelSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}},{kind:"Argument",name:{kind:"Name",value:"enhancedRendering"},value:{kind:"Variable",name:{kind:"Name",value:"enhancedRendering"}}},{kind:"Argument",name:{kind:"Name",value:"acceleratedRendering"},value:{kind:"Variable",name:{kind:"Name",value:"acceleratedRendering"}}},{kind:"Argument",name:{kind:"Name",value:"architectEffect"},value:{kind:"Variable",name:{kind:"Name",value:"architectEffect"}}},{kind:"Argument",name:{kind:"Name",value:"penDetail"},value:{kind:"Variable",name:{kind:"Name",value:"penDetail"}}},{kind:"Argument",name:{kind:"Name",value:"inkContrast"},value:{kind:"Variable",name:{kind:"Name",value:"inkContrast"}}},{kind:"Argument",name:{kind:"Name",value:"blackAndWhite"},value:{kind:"Variable",name:{kind:"Name",value:"blackAndWhite"}}},{kind:"Argument",name:{kind:"Name",value:"shadow"},value:{kind:"Variable",name:{kind:"Name",value:"shadow"}}},{kind:"Argument",name:{kind:"Name",value:"brightness"},value:{kind:"Variable",name:{kind:"Name",value:"brightness"}}},{kind:"Argument",name:{kind:"Name",value:"latitude"},value:{kind:"Variable",name:{kind:"Name",value:"latitude"}}},{kind:"Argument",name:{kind:"Name",value:"longitude"},value:{kind:"Variable",name:{kind:"Name",value:"longitude"}}},{kind:"Argument",name:{kind:"Name",value:"materials"},value:{kind:"Variable",name:{kind:"Name",value:"materials"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundMode"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundMode"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundColor"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundColor"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundImage"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundImage"}}},{kind:"Argument",name:{kind:"Name",value:"reflectionImage"},value:{kind:"Variable",name:{kind:"Name",value:"reflectionImage"}}},{kind:"Argument",name:{kind:"Name",value:"shader"},value:{kind:"Variable",name:{kind:"Name",value:"shader"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filter"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enhancedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"acceleratedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"architectEffect"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"penDetail"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inkContrast"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blackAndWhite"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shadow"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"brightness"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"latitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"longitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"materials"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundMode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reflectionImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shader"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:1701}};r.loc.source={body:"mutation UpdateModelRenderSetting(\r\n    $id: Int!\r\n    $modelId: Id\r\n    $name: String\r\n    $filter: String\r\n    $enhancedRendering: Boolean\r\n    $acceleratedRendering: Boolean\r\n    $architectEffect: Boolean\r\n    $penDetail: Float\r\n    $inkContrast: Float\r\n    $blackAndWhite: Boolean\r\n    $shadow: Boolean\r\n    $brightness: Float\r\n    $latitude: Float\r\n    $longitude: Float\r\n    $materials: JSONObject\r\n    $backgroundMode: Int\r\n    $backgroundColor: String\r\n    $backgroundImage: [String]\r\n    $reflectionImage: [String]\r\n    $shader: ModelShaderSetting\r\n) {\r\n    updateModelSettings(\r\n        id: $id\r\n        modelId: $modelId\r\n        name: $name\r\n        filter: $filter\r\n        enhancedRendering: $enhancedRendering\r\n        acceleratedRendering: $acceleratedRendering\r\n        architectEffect: $architectEffect\r\n        penDetail: $penDetail\r\n        inkContrast: $inkContrast\r\n        blackAndWhite: $blackAndWhite\r\n        shadow: $shadow\r\n        brightness: $brightness\r\n        latitude: $latitude\r\n        longitude: $longitude\r\n        materials: $materials\r\n        backgroundMode: $backgroundMode\r\n        backgroundColor: $backgroundColor\r\n        backgroundImage: $backgroundImage\r\n        reflectionImage: $reflectionImage\r\n        shader: $shader\r\n    ) {\r\n        id\r\n        modelId\r\n        name\r\n        filter\r\n        enhancedRendering\r\n        acceleratedRendering\r\n        architectEffect\r\n        penDetail\r\n        inkContrast\r\n        blackAndWhite\r\n        shadow\r\n        brightness\r\n        latitude\r\n        longitude\r\n        materials\r\n        backgroundMode\r\n        backgroundColor\r\n        backgroundImage\r\n        reflectionImage\r\n        shader\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateModelRenderSetting=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateModelRenderSetting")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteModelRenderSetting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteModelSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}}],loc:{start:0,end:83}};r.loc.source={body:"mutation DeleteModelRenderSetting($id: Int!) {\r\n  deleteModelSettings(id: $id)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteModelRenderSetting=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteModelRenderSetting")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddModelRenderSetting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enhancedRendering"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acceleratedRendering"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"architectEffect"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"penDetail"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inkContrast"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"blackAndWhite"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shadow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"brightness"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"latitude"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"longitude"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"materials"}},type:{kind:"NamedType",name:{kind:"Name",value:"JSONObject"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundMode"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundColor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"backgroundImage"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reflectionImage"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shader"}},type:{kind:"NamedType",name:{kind:"Name",value:"ModelShaderSetting"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addModelSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}},{kind:"Argument",name:{kind:"Name",value:"enhancedRendering"},value:{kind:"Variable",name:{kind:"Name",value:"enhancedRendering"}}},{kind:"Argument",name:{kind:"Name",value:"acceleratedRendering"},value:{kind:"Variable",name:{kind:"Name",value:"acceleratedRendering"}}},{kind:"Argument",name:{kind:"Name",value:"architectEffect"},value:{kind:"Variable",name:{kind:"Name",value:"architectEffect"}}},{kind:"Argument",name:{kind:"Name",value:"penDetail"},value:{kind:"Variable",name:{kind:"Name",value:"penDetail"}}},{kind:"Argument",name:{kind:"Name",value:"inkContrast"},value:{kind:"Variable",name:{kind:"Name",value:"inkContrast"}}},{kind:"Argument",name:{kind:"Name",value:"blackAndWhite"},value:{kind:"Variable",name:{kind:"Name",value:"blackAndWhite"}}},{kind:"Argument",name:{kind:"Name",value:"shadow"},value:{kind:"Variable",name:{kind:"Name",value:"shadow"}}},{kind:"Argument",name:{kind:"Name",value:"brightness"},value:{kind:"Variable",name:{kind:"Name",value:"brightness"}}},{kind:"Argument",name:{kind:"Name",value:"latitude"},value:{kind:"Variable",name:{kind:"Name",value:"latitude"}}},{kind:"Argument",name:{kind:"Name",value:"longitude"},value:{kind:"Variable",name:{kind:"Name",value:"longitude"}}},{kind:"Argument",name:{kind:"Name",value:"materials"},value:{kind:"Variable",name:{kind:"Name",value:"materials"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundMode"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundMode"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundColor"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundColor"}}},{kind:"Argument",name:{kind:"Name",value:"backgroundImage"},value:{kind:"Variable",name:{kind:"Name",value:"backgroundImage"}}},{kind:"Argument",name:{kind:"Name",value:"reflectionImage"},value:{kind:"Variable",name:{kind:"Name",value:"reflectionImage"}}},{kind:"Argument",name:{kind:"Name",value:"shader"},value:{kind:"Variable",name:{kind:"Name",value:"shader"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filter"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enhancedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"acceleratedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"architectEffect"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"penDetail"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inkContrast"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blackAndWhite"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shadow"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"brightness"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"latitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"longitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"materials"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundMode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reflectionImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shader"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:1664}};r.loc.source={body:"mutation AddModelRenderSetting(\r\n    $modelId: Id!\r\n    $name: String\r\n    $filter: String\r\n    $enhancedRendering: Boolean\r\n    $acceleratedRendering: Boolean\r\n    $architectEffect: Boolean\r\n    $penDetail: Float\r\n    $inkContrast: Float\r\n    $blackAndWhite: Boolean\r\n    $shadow: Boolean\r\n    $brightness: Float\r\n    $latitude: Float\r\n    $longitude: Float\r\n    $materials: JSONObject\r\n    $backgroundMode: Int\r\n    $backgroundColor: String\r\n    $backgroundImage: [String]\r\n    $reflectionImage: [String]\r\n    $shader: ModelShaderSetting\r\n) {\r\n    addModelSettings(\r\n        modelId: $modelId\r\n        name: $name\r\n        filter: $filter\r\n        enhancedRendering: $enhancedRendering\r\n        acceleratedRendering: $acceleratedRendering\r\n        architectEffect: $architectEffect\r\n        penDetail: $penDetail\r\n        inkContrast: $inkContrast\r\n        blackAndWhite: $blackAndWhite\r\n        shadow: $shadow\r\n        brightness: $brightness\r\n        latitude: $latitude\r\n        longitude: $longitude\r\n        materials: $materials\r\n        backgroundMode: $backgroundMode\r\n        backgroundColor: $backgroundColor\r\n        backgroundImage: $backgroundImage\r\n        reflectionImage: $reflectionImage\r\n        shader: $shader\r\n    ) {\r\n        id\r\n        modelId\r\n        name\r\n        filter\r\n        enhancedRendering\r\n        acceleratedRendering\r\n        architectEffect\r\n        penDetail\r\n        inkContrast\r\n        blackAndWhite\r\n        shadow\r\n        brightness\r\n        latitude\r\n        longitude\r\n        materials\r\n        backgroundMode\r\n        backgroundColor\r\n        backgroundImage\r\n        reflectionImage\r\n        shader\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddModelRenderSetting=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddModelRenderSetting")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelRenderSetting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filter"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enhancedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"acceleratedRendering"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"architectEffect"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"penDetail"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"inkContrast"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blackAndWhite"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shadow"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"brightness"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"latitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"longitude"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"materials"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundMode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"backgroundImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reflectionImage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shader"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:617}};r.loc.source={body:"query GetModelRenderSetting($modelId: Id!) {\r\n    model(id: $modelId) {\r\n        id\r\n        settings {\r\n            id\r\n            name\r\n            modelId\r\n            filter\r\n            enhancedRendering\r\n            acceleratedRendering\r\n            architectEffect\r\n            penDetail\r\n            inkContrast\r\n            blackAndWhite\r\n            shadow\r\n            brightness\r\n            latitude\r\n            longitude\r\n            materials\r\n            backgroundMode\r\n            backgroundColor\r\n            backgroundImage\r\n            reflectionImage\r\n            shader\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelRenderSetting=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelRenderSetting")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteModelSelectionSet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteModelSelectionSet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}}],loc:{start:0,end:88}};r.loc.source={body:"mutation DeleteModelSelectionSet($id: Int!) {\r\n    deleteModelSelectionSet(id: $id)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteModelSelectionSet=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteModelSelectionSet")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateModelSelectionSet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIds"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateModelSelectionSet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"elementIds"},value:{kind:"Variable",name:{kind:"Name",value:"elementIds"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"elementIds"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:274}};r.loc.source={body:"mutation UpdateModelSelectionSet($id: Int!, $name: String, $elementIds: [String]) {\r\n    updateModelSelectionSet(id: $id, name: $name, elementIds: $elementIds) {\r\n        id\r\n        name\r\n        modelId\r\n        elementIds\r\n        createdAt\r\n        updatedAt\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateModelSelectionSet=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateModelSelectionSet")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelSelectionSets"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelSelectionSets"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"elementIds"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:261}};r.loc.source={body:"query GetModelSelectionSets($modelId: Id!) {\r\n    model(id: $modelId) {\r\n        id\r\n        modelSelectionSets {\r\n            id\r\n            name\r\n            modelId\r\n            elementIds\r\n            createdAt\r\n            updatedAt\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelSelectionSets=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelSelectionSets")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddModelSelectionSet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addModelSelectionSet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"elementIds"},value:{kind:"Variable",name:{kind:"Name",value:"elementIds"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"elementIds"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:284}};r.loc.source={body:"mutation AddModelSelectionSet($name: String!, $modelId: Id!, $elementIds: [String]!) {\r\n    addModelSelectionSet(name: $name, modelId: $modelId, elementIds: $elementIds) {\r\n        id\r\n        name\r\n        modelId\r\n        elementIds\r\n        createdAt\r\n        updatedAt\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddModelSelectionSet=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddModelSelectionSet")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateModelComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"plainText"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateModelComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"plainText"},value:{kind:"Variable",name:{kind:"Name",value:"plainText"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bimdata"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"camera"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plainText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:305}};r.loc.source={body:"mutation UpdateModelComment($id: Int!, $message: String!, $plainText: String!) {\r\n    updateModelComment(id: $id, message: $message, plainText: $plainText) {\r\n        id\r\n        bimdata\r\n        camera\r\n        modelId\r\n        message\r\n        plainText\r\n        createdAt\r\n        updatedAt\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateModelComment=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateModelComment")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteModelComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteModelComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}}],loc:{start:0,end:78}};r.loc.source={body:"mutation DeleteModelComment($id: Int!) {\r\n    deleteModelComment(id: $id)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteModelComment=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteModelComment")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"modelComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"commentId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bimdata"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"camera"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plainText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:295}};r.loc.source={body:"query GetModelComment($commentId: Int!) {\r\n    modelComment(id: $commentId) {\r\n        id\r\n        bimdata\r\n        camera\r\n        modelId\r\n        message\r\n        plainText\r\n        createdAt\r\n        updatedAt\r\n        createdBy {\r\n            id\r\n            username\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelComment=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelComment")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelComments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"modelComments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bimdata"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"camera"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plainText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:297}};r.loc.source={body:"query GetModelComments($modelId: Id!) {\r\n    modelComments(modelId: $modelId) {\r\n        id\r\n        bimdata\r\n        camera\r\n        modelId\r\n        message\r\n        plainText\r\n        createdAt\r\n        updatedAt\r\n        createdBy {\r\n            id\r\n            username\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelComments=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelComments")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"BatchUpdateProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"strValueArr"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numValueArr"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"batchUpdateProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"docAndCatIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"elementIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"propertyArr"},value:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}}},{kind:"Argument",name:{kind:"Name",value:"strValueArr"},value:{kind:"Variable",name:{kind:"Name",value:"strValueArr"}}},{kind:"Argument",name:{kind:"Name",value:"numValueArr"},value:{kind:"Variable",name:{kind:"Name",value:"numValueArr"}}}],directives:[]}]}}],loc:{start:0,end:403}};r.loc.source={body:"mutation BatchUpdateProperty(\r\n  $modelId: Id!\r\n  $docAndCatIdArr: [Int]!\r\n  $elementIdArr: [Int]!\r\n  $propertyArr: [String]!\r\n  $strValueArr: [String]\r\n  $numValueArr: [Float]\r\n) {\r\n  batchUpdateProperties(\r\n    modelId: $modelId\r\n    docAndCatIdArr: $docAndCatIdArr\r\n    elementIdArr: $elementIdArr\r\n    propertyArr: $propertyArr\r\n    strValueArr: $strValueArr\r\n    numValueArr: $numValueArr\r\n  )\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.BatchUpdateProperty=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"BatchUpdateProperty")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateElementProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"property"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"strValue"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numValue"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updatePropertyValue"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"docAndCatId"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatId"}}},{kind:"Argument",name:{kind:"Name",value:"elementId"},value:{kind:"Variable",name:{kind:"Name",value:"elementId"}}},{kind:"Argument",name:{kind:"Name",value:"property"},value:{kind:"Variable",name:{kind:"Name",value:"property"}}},{kind:"Argument",name:{kind:"Name",value:"strValue"},value:{kind:"Variable",name:{kind:"Name",value:"strValue"}}},{kind:"Argument",name:{kind:"Name",value:"numValue"},value:{kind:"Variable",name:{kind:"Name",value:"numValue"}}}],directives:[]}]}}],loc:{start:0,end:388}};r.loc.source={body:"mutation UpdateElementProperty(\r\n    $modelId: Id!\r\n    $docAndCatId: Int!\r\n    $elementId: Int!\r\n    $property: String!\r\n    $strValue: String\r\n    $numValue: Float\r\n) {\r\n    updatePropertyValue(\r\n        modelId: $modelId\r\n        docAndCatId: $docAndCatId\r\n        elementId: $elementId\r\n        property: $property\r\n        strValue: $strValue\r\n        numValue: $numValue\r\n    )\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateElementProperty=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateElementProperty")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"InitElementProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"property"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"strValue"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numValue"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"initModelElementProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"property"},value:{kind:"Variable",name:{kind:"Name",value:"property"}}},{kind:"Argument",name:{kind:"Name",value:"strValue"},value:{kind:"Variable",name:{kind:"Name",value:"strValue"}}},{kind:"Argument",name:{kind:"Name",value:"numValue"},value:{kind:"Variable",name:{kind:"Name",value:"numValue"}}}],directives:[]}]}}],loc:{start:0,end:221}};r.loc.source={body:"mutation InitElementProperty($modelId: Id!, $property: String!, $strValue: String, $numValue: Float) {\r\n    initModelElementProperties(modelId: $modelId, property: $property, strValue: $strValue, numValue: $numValue)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.InitElementProperty=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"InitElementProperty")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"BatchGetProperties"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"batchGetElementProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"elementIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"propertyArr"},value:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"elementIdArr"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"properties"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"strValues"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"numValues"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:332}};r.loc.source={body:"query BatchGetProperties($modelId: Id!, $elementIdArr: [Int]!, $propertyArr: [String]!) {\r\n    batchGetElementProperties(modelId: $modelId, elementIdArr: $elementIdArr, propertyArr: $propertyArr) {\r\n        elementIdArr\r\n        properties {\r\n            property\r\n            strValues\r\n            numValues\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.BatchGetProperties=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"BatchGetProperties")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"BatchAddProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"strValueArr"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numValueArr"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"batchAddProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"docAndCatIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"elementIdArr"},value:{kind:"Variable",name:{kind:"Name",value:"elementIdArr"}}},{kind:"Argument",name:{kind:"Name",value:"propertyArr"},value:{kind:"Variable",name:{kind:"Name",value:"propertyArr"}}},{kind:"Argument",name:{kind:"Name",value:"strValueArr"},value:{kind:"Variable",name:{kind:"Name",value:"strValueArr"}}},{kind:"Argument",name:{kind:"Name",value:"numValueArr"},value:{kind:"Variable",name:{kind:"Name",value:"numValueArr"}}}],directives:[]}]}}],loc:{start:0,end:397}};r.loc.source={body:"mutation BatchAddProperty(\r\n  $modelId: Id!\r\n  $docAndCatIdArr: [Int]!\r\n  $elementIdArr: [Int]!\r\n  $propertyArr: [String]!\r\n  $strValueArr: [String]\r\n  $numValueArr: [Float]\r\n) {\r\n  batchAddProperties(\r\n    modelId: $modelId\r\n    docAndCatIdArr: $docAndCatIdArr\r\n    elementIdArr: $elementIdArr\r\n    propertyArr: $propertyArr\r\n    strValueArr: $strValueArr\r\n    numValueArr: $numValueArr\r\n  )\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.BatchAddProperty=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"BatchAddProperty")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetElementProperties"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"docAndCatId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elementId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"elementProperties"},arguments:[{kind:"Argument",name:{kind:"Name",value:"docAndCatId"},value:{kind:"Variable",name:{kind:"Name",value:"docAndCatId"}}},{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"elementId"},value:{kind:"Variable",name:{kind:"Name",value:"elementId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"strValue"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"numValue"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:241}};r.loc.source={body:"query GetElementProperties($docAndCatId: Int!, $modelId: Id!, $elementId: Int!) {\r\n    elementProperties(docAndCatId: $docAndCatId, modelId: $modelId, elementId: $elementId) {\r\n        property\r\n        strValue\r\n        numValue\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetElementProperties=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetElementProperties")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadAssetSuccess"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uploadAssetSuccess"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"folderId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filenames"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:302}};r.loc.source={body:"mutation UploadAssetSuccess($assetId: Int!) {\r\n  uploadAssetSuccess(id: $assetId) {\r\n    id\r\n    name\r\n    folderId\r\n    type\r\n    status\r\n    filenames\r\n    downloadUrls {\r\n        filename\r\n        url\r\n    }\r\n    createdBy {\r\n        id\r\n      username\r\n    }\r\n    createdAt\r\n    updatedAt\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UploadAssetSuccess=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UploadAssetSuccess")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteAsset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}}],directives:[]}]}}],loc:{start:0,end:72}};r.loc.source={body:"mutation DeleteAsset($assetId: Int!) {\r\n  deleteAsset(id: $assetId)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteAsset=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteAsset")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAsset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:152}};r.loc.source={body:"mutation UpdateAsset($assetId: Int!, $name: String, $folderId: Int) {\r\n  updateAsset(id: $assetId, name: $name, folderId: $folderId) {\r\n    id\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateAsset=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateAsset")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileNames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AssetType"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uploadAsset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"assetName"}}},{kind:"Argument",name:{kind:"Name",value:"filenames"},value:{kind:"Variable",name:{kind:"Name",value:"fileNames"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"uploadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:275}};r.loc.source={body:"mutation UploadAsset(\r\n  $folderId: Int\r\n  $assetName: String!\r\n  $fileNames: [String]!\r\n  $type: AssetType!\r\n) {\r\n  uploadAsset(folderId: $folderId, name: $assetName, filenames: $fileNames, type: $type) {\r\n    id\r\n    uploadUrls {\r\n      filename\r\n      url\r\n    }\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UploadAsset=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UploadAsset")},function(e,t,r){"use strict";let i=r(121);e.exports=new i(r(120),r(119))},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetAssetFolder"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"projects"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assetFolder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:155}};r.loc.source={body:"query GetAssetFolder {\r\n    user {\r\n        projects {\r\n            id\r\n            assetFolder {\r\n                id\r\n            }\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetAssetFolder=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetAssetFolder")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelFolder"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"projects"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelFolder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:155}};r.loc.source={body:"query GetModelFolder {\r\n    user {\r\n        projects {\r\n            id\r\n            modelFolder {\r\n                id\r\n            }\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelFolder=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelFolder")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.print=function(e){return(0,i.visit)(e,{leave:a})};var i=r(30),n=r(122);var a={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return s(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var t=e.operation,r=e.name,i=u("(",s(e.variableDefinitions,", "),")"),n=s(e.directives," "),a=e.selectionSet;return r||n||i||"query"!==t?s([t,s([r,i]),n,a]," "):a},VariableDefinition:function(e){var t=e.variable,r=e.type,i=e.defaultValue,n=e.directives;return t+": "+r+u(" = ",i)+u(" ",s(n," "))},SelectionSet:function(e){return l(e.selections)},Field:function(e){var t=e.alias,r=e.name,i=e.arguments,n=e.directives,a=e.selectionSet;return s([u("",t,": ")+r+u("(",s(i,", "),")"),s(n," "),a]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+u(" ",s(e.directives," "))},InlineFragment:function(e){var t=e.typeCondition,r=e.directives,i=e.selectionSet;return s(["...",u("on ",t),s(r," "),i]," ")},FragmentDefinition:function(e){var t=e.name,r=e.typeCondition,i=e.variableDefinitions,n=e.directives,a=e.selectionSet;return"fragment ".concat(t).concat(u("(",s(i,", "),")")," ")+"on ".concat(r," ").concat(u("",s(n," ")," "))+a},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e,t){var r=e.value;return e.block?(0,n.printBlockString)(r,"description"===t?"":"  "):JSON.stringify(r)},BooleanValue:function(e){return e.value?"true":"false"},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+s(e.values,", ")+"]"},ObjectValue:function(e){return"{"+s(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+u("(",s(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:function(e){var t=e.directives,r=e.operationTypes;return s(["schema",s(t," "),l(r)]," ")},OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:o(function(e){return s(["scalar",e.name,s(e.directives," ")]," ")}),ObjectTypeDefinition:o(function(e){var t=e.name,r=e.interfaces,i=e.directives,n=e.fields;return s(["type",t,u("implements ",s(r," & ")),s(i," "),l(n)]," ")}),FieldDefinition:o(function(e){var t=e.name,r=e.arguments,i=e.type,n=e.directives;return t+(d(r)?u("(\n",c(s(r,"\n")),"\n)"):u("(",s(r,", "),")"))+": "+i+u(" ",s(n," "))}),InputValueDefinition:o(function(e){var t=e.name,r=e.type,i=e.defaultValue,n=e.directives;return s([t+": "+r,u("= ",i),s(n," ")]," ")}),InterfaceTypeDefinition:o(function(e){var t=e.name,r=e.directives,i=e.fields;return s(["interface",t,s(r," "),l(i)]," ")}),UnionTypeDefinition:o(function(e){var t=e.name,r=e.directives,i=e.types;return s(["union",t,s(r," "),i&&0!==i.length?"= "+s(i," | "):""]," ")}),EnumTypeDefinition:o(function(e){var t=e.name,r=e.directives,i=e.values;return s(["enum",t,s(r," "),l(i)]," ")}),EnumValueDefinition:o(function(e){return s([e.name,s(e.directives," ")]," ")}),InputObjectTypeDefinition:o(function(e){var t=e.name,r=e.directives,i=e.fields;return s(["input",t,s(r," "),l(i)]," ")}),DirectiveDefinition:o(function(e){var t=e.name,r=e.arguments,i=e.repeatable,n=e.locations;return"directive @"+t+(d(r)?u("(\n",c(s(r,"\n")),"\n)"):u("(",s(r,", "),")"))+(i?" repeatable":"")+" on "+s(n," | ")}),SchemaExtension:function(e){var t=e.directives,r=e.operationTypes;return s(["extend schema",s(t," "),l(r)]," ")},ScalarTypeExtension:function(e){return s(["extend scalar",e.name,s(e.directives," ")]," ")},ObjectTypeExtension:function(e){var t=e.name,r=e.interfaces,i=e.directives,n=e.fields;return s(["extend type",t,u("implements ",s(r," & ")),s(i," "),l(n)]," ")},InterfaceTypeExtension:function(e){var t=e.name,r=e.directives,i=e.fields;return s(["extend interface",t,s(r," "),l(i)]," ")},UnionTypeExtension:function(e){var t=e.name,r=e.directives,i=e.types;return s(["extend union",t,s(r," "),i&&0!==i.length?"= "+s(i," | "):""]," ")},EnumTypeExtension:function(e){var t=e.name,r=e.directives,i=e.values;return s(["extend enum",t,s(r," "),l(i)]," ")},InputObjectTypeExtension:function(e){var t=e.name,r=e.directives,i=e.fields;return s(["extend input",t,s(r," "),l(i)]," ")}};function o(e){return function(t){return s([t.description,e(t)],"\n")}}function s(e,t){return e?e.filter(function(e){return e}).join(t||""):""}function l(e){return e&&0!==e.length?"{\n"+c(s(e,"\n"))+"\n}":""}function u(e,t,r){return t?e+t+(r||""):""}function c(e){return e&&"  "+e.replace(/\n/g,"\n  ")}function h(e){return-1!==e.indexOf("\n")}function d(e){return e&&e.some(h)}},function(e,t,r){"use strict";function i(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",function(){return i})},function(e,t,r){"use strict";(function(e,i){var n,a=r(105);n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:i;var o=Object(a.a)(n);t.a=o}).call(this,r(60),r(64)(e))},function(e,t,r){e.exports=r(123).Observable},function(e,t,r){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&function(e){return function(t){return function(r,i){var n={key:r,value:t[r]},a={key:i,value:t[i]};return e(n,a)}}}(t.cmp),n=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var a,o;if(Array.isArray(t)){for(o="[",a=0;a<t.length;a++)a&&(o+=","),o+=e(t[a])||"null";return o+"]"}if(null===t)return"null";if(-1!==n.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=n.push(t)-1,l=Object.keys(t).sort(i&&i(t));for(o="",a=0;a<l.length;a++){var u=l[a],c=e(t[u]);c&&(o&&(o+=","),o+=JSON.stringify(u)+":"+c)}return n.splice(s,1),"{"+o+"}"}}(e)}},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Get3DPDFURL"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"asset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"assetId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:108}};r.loc.source={body:"query Get3DPDFURL($assetId: Int!) {\r\n  asset(id: $assetId) {\r\n    downloadUrls {\r\n      url\r\n    }\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.Get3DPDFURL=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"Get3DPDFURL")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"Generate3DPDF"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"modelStartConvertToPdf"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"assetId"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:109}};r.loc.source={body:"mutation Generate3DPDF($modelId: Id!) {\r\n  modelStartConvertToPdf(modelId: $modelId) {\r\n    assetId\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.Generate3DPDF=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"Generate3DPDF")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddSliceModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"query"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isTerrain"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sliceModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"Argument",name:{kind:"Name",value:"query"},value:{kind:"Variable",name:{kind:"Name",value:"query"}}},{kind:"Argument",name:{kind:"Name",value:"isTerrain"},value:{kind:"Variable",name:{kind:"Name",value:"isTerrain"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"folderId"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:224}};r.loc.source={body:"mutation AddSliceModel($name: String!, $folderId: Int, $query: String!, $isTerrain: Boolean) {\r\n  sliceModel(name: $name, folderId: $folderId, query: $query, isTerrain: $isTerrain) {\r\n    id\r\n    name\r\n    folderId\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddSliceModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddSliceModel")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddCombinedModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addCombinedModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"modelIds"},value:{kind:"Variable",name:{kind:"Name",value:"modelIds"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:197}};r.loc.source={body:"mutation AddCombinedModel($folderId: Int!, $name: String!, $modelIds: [Id]!) {\r\n    addCombinedModel(folderId: $folderId, name: $name, modelIds: $modelIds) {\r\n        id\r\n        status\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.AddCombinedModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"AddCombinedModel")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:159}};r.loc.source={body:"mutation UpdateModel($modelId: Id!, $name: String, $folderId: Int) {\r\n    updateModel(id: $modelId, name: $name, folderId: $folderId) {\r\n        id\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UpdateModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UpdateModel")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadModelSuccess"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uploadModelSuccess"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"folderId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"targetModelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"version"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"convertedUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:467}};r.loc.source={body:"mutation UploadModelSuccess($modelId: Id!) {\r\n    uploadModelSuccess(id: $modelId) {\r\n        id\r\n        folderId\r\n        targetModelId\r\n        type\r\n        name\r\n        status\r\n        version\r\n        createdBy {\r\n            id\r\n            username\r\n        }\r\n        createdAt\r\n        updatedAt\r\n        downloadUrls {\r\n            filename\r\n            url\r\n        }\r\n        convertedUrls {\r\n            filename\r\n            url\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UploadModelSuccess=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UploadModelSuccess")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filenames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cvtOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uploadModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"filenames"},value:{kind:"Variable",name:{kind:"Name",value:"filenames"}}},{kind:"Argument",name:{kind:"Name",value:"cvtOptions"},value:{kind:"Variable",name:{kind:"Name",value:"cvtOptions"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"uploadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:296}};r.loc.source={body:"mutation UploadModel($folderId: Int!, $name: String!, $filenames: [String]!, $cvtOptions: String) {\r\n    uploadModel(folderId: $folderId, name: $name, filenames: $filenames, cvtOptions: $cvtOptions) {\r\n        id\r\n        uploadUrls {\r\n            filename\r\n            url\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.UploadModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"UploadModel")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[]}]}}],loc:{start:0,end:71}};r.loc.source={body:"mutation DeleteModel($modelId: Id!) {\r\n  deleteModel(id: $modelId)\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.DeleteModel=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"DeleteModel")},function(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelFiles"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"convertedUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:236}};r.loc.source={body:"query GetModelFiles($modelId: Id!) {\r\n    model(id: $modelId) {\r\n        id\r\n        downloadUrls {\r\n            filename\r\n            url\r\n        }\r\n        convertedUrls {\r\n            filename\r\n            url\r\n        }\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function n(e,t){for(var r=0;r<e.definitions.length;r++){var i=e.definitions[r];if(i.name&&i.name.value==t)return i}}r.definitions.forEach(function(e){if(e.name){var t=new Set;!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var i=t.type;"NamedType"===i.kind&&r.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r)}),t.definitions&&t.definitions.forEach(function(t){e(t,r)})}(e,t),i[e.name.value]=t}}),e.exports=r,e.exports.GetModelFiles=function(e,t){var r={kind:e.kind,definitions:[n(e,t)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=i[t]||new Set,o=new Set,s=new Set;for(a.forEach(function(e){s.add(e)});s.size>0;){var l=s;s=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return o.forEach(function(t){var i=n(e,t);i&&r.definitions.push(i)}),r}(r,"GetModelFiles")},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i,n=r(26),a=r(27),o=r(19),s=r(28),l=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())})},u=function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};!function(e){e.ElementType=o.a,e.get=function(e){return l(this,void 0,void 0,function(){return u(this,function(t){return[2,Object(n.h)(e)]})})},e.remove=function(e){return l(this,void 0,void 0,function(){return u(this,function(t){return[2,Object(a.a)(e)]})})},e.update=function(e,t){return l(this,void 0,void 0,function(){return u(this,function(r){return[2,Object(a.g)(e,t)]})})},e.upload=function(e,t){return l(this,void 0,void 0,function(){var r,i,n;return u(this,function(o){return function(e){return"object"==typeof e&&null!==e}(t)?(r=t.onProgress,n=void 0===r?function(){}:r,i=t.reduceTextures,[2,Object(a.h)(e,i,n)]):(n=t||function(){},[2,Object(a.h)(e,!1,n)])})})},e.merge=function(e,t,r){return l(this,void 0,void 0,function(){return u(this,function(i){return[2,Object(a.f)(e,t,r)]})})},e.generate3DPDF=function(e){return l(this,void 0,void 0,function(){return u(this,function(t){return[2,Object(a.b)(e)]})})},e.compare=function(e,t){return l(this,void 0,void 0,function(){return u(this,function(r){return[2,new Promise(function(r,i){var n=new Blob(['\n        function Node(name, type) {\n            this.father   = null;\n            this.children = null;\n            this.name     = name;\n            this.type     = type;\n            this.docId    = null;\n        }\n        var extractNode = function(element, nodes) {\n            if (element.children === null) {\n                nodes.push(element.name);\n            } else {\n                for (var i = 0, len = element.children.length; i < len; i++) {\n                    extractNode(element.children[i], nodes);\n                }\n            }\n        }\n        \n        var parseGraph = function(modelGraphBin, modelBin) {\n            var byteLength = modelGraphBin.byteLength;\n            var len = byteLength / 9;\n            var index = 0;\n            var e_name, e_father, e_type;\n            var root = new Node(-1, -1);\n            root.children = [];\n            var fathers = [];\n            fathers.push(root);\n    \n            var currentDocName = 0;\n    \n            var elements = [];\n            for (var i = 0; i < len; i++) {\n                var data = new Uint8Array(modelGraphBin, i * 9, 9);\n                e_name   = ((data[3] << 24) | (data[2] << 16) | (data[1] << 8) | data[0]);\n                e_father = ((data[7] << 24) | (data[6] << 16) | (data[5] << 8) | data[4]);\n                e_type   = data[8];\n                \n                while (fathers.length > 0 && fathers[fathers.length - 1].name !== e_father) {\n                    fathers.pop();\n                }\n                if (fathers.length === 0) {\n                    postMessage("father of " + e_name + " is wrong");\n                    close();\n                }\n                var father = fathers[fathers.length - 1];\n                if (e_type === 4) { // NODE\n                    var node = new Node(e_name, e_type);\n                    node.father = father;\n                    father.children.push(node);\n                } else {\n                    if (e_type === 5) { // link\n                        currentDocName = e_name;\n                    } \n                    var element = new Node(e_name, e_type);\n                    element.children = [];\n                    element.docId = currentDocName;\n                    if (e_type === 3) { // ElEMENT\n                        elements.push(element);\n                    }\n                    element.father = father;\n                    father.children.push(element);\n                    fathers.push(element);\n                }\n            }\n            for (var i = 0, len = elements.length; i < len; i++) {\n                var element = elements[i];\n                element.nodes = [];\n                extractNode(element, element.nodes);\n            }\n    \n            return elements;\n        };    \n    \n        var parseBBox = function(bboxBuffer, index) {\n            return new Float32Array(bboxBuffer, (index * 21 + 3) * 4, 6);\n        };\n    \n        var getElementBBox = function(nodes, bboxBuffer) {\n            var bbox = new Float32Array([Infinity, Infinity, Infinity, -Infinity, -Infinity, -Infinity]);\n            for (var i = 0, len = nodes.length; i < len; i++) {\n                var nodeBBox = parseBBox(bboxBuffer, nodes[i]);\n                if (bbox[0] > nodeBBox[0]) {\n                    bbox[0] = nodeBBox[0]\n                }\n                if (bbox[1] > nodeBBox[1]) {\n                    bbox[1] = nodeBBox[1]\n                }\n                if (bbox[2] > nodeBBox[2]) {\n                    bbox[2] = nodeBBox[2]\n                }\n                if (bbox[3] < nodeBBox[3]) {\n                    bbox[3] = nodeBBox[3]\n                }\n                if (bbox[4] < nodeBBox[4]) {\n                    bbox[4] = nodeBBox[4]\n                }\n                if (bbox[5] < nodeBBox[5]) {\n                    bbox[5] = nodeBBox[5]\n                }\n            }\n            return bbox;\n        }\n        var compareModel = function(elements1, elements2, bboxBuffer1, bboxBuffer2, modelId1, modelId2) {\n            if (elements1 === null || elements2 === null || bboxBuffer1 === null || bboxBuffer2 === null) {\n                return;\n            }\n            var EPS                 = 0.001;\n            var newElementIds1      = [];\n            var newElementIds2      = [];\n            var modifiedElementIds1 = [];\n            var modifiedElementIds2 = [];\n            elements1.sort(function(a, b) {\n                return a.name - b.name;\n            });\n            elements2.sort(function(a, b) {\n                return a.name - b.name;\n            });\n            var idx1 = 0, idx2 = 0;\n            var element1 = elements1[idx1];\n            var element2 = elements2[idx2];\n            while(element1 !== undefined && element2 !== undefined) {\n                if (element1.name === element2.name) {\n                    // compare nodes number and bbox\n                    if (element1.nodes.length != element2.nodes.length) {\n                        modifiedElementIds1.push(modelId1 + "+" + element1.docId + "/" + element1.name);\n                        modifiedElementIds2.push(modelId2 + "+" + element1.docId + "/" + element2.name);\n                    } else {\n                        var bbox1 = getElementBBox(element1.nodes, bboxBuffer1);\n                        var bbox2 = getElementBBox(element2.nodes, bboxBuffer2);\n                        if (Math.abs(bbox1[0] - bbox2[0]) > EPS ||\n                            Math.abs(bbox1[1] - bbox2[1]) > EPS ||\n                            Math.abs(bbox1[2] - bbox2[2]) > EPS ||\n                            Math.abs(bbox1[3] - bbox2[3]) > EPS ||\n                            Math.abs(bbox1[4] - bbox2[4]) > EPS ||\n                            Math.abs(bbox1[5] - bbox2[5]) > EPS) {\n                            modifiedElementIds1.push(modelId1 + "+" + element1.docId + "/" + element1.name);\n                            modifiedElementIds2.push(modelId2 + "+" + element1.docId + "/" + element2.name);\n                        }\n                    }\n                    idx1++;\n                    idx2++;\n                    element1 = elements1[idx1];\n                    element2 = elements2[idx2];\n                } else if (element1 === undefined || element1.name > element2.name) {\n                    // element2 doesn\'t exist in elements1;\n                    newElementIds2.push(modelId2 + "+" + element2.docId + "/" + element2.name);\n                    idx2++;\n                    element2 = elements2[idx2];\n                } else if (element2 === undefined || element1.name <= element2.name) {\n                    // element1 doesn\'t exist in elements2;\n                    newElementIds1.push(modelId1 + "+" + element1.docId + "/" + element1.name);\n                    idx1++;\n                    element1 = elements1[idx1];\n                }\n            }\n            postMessage({\n                newElements1: newElementIds1,\n                newElements2: newElementIds2,\n                modifiedElements1: modifiedElementIds1,\n                modifiedElements2: modifiedElementIds2\n            });\n            close();\n        }\n        var elements1 = null;\n        var elements2 = null;\n        var bboxBuffer1 = null;\n        var bboxBuffer2 = null;\n        var modelId1 = null;\n        var modelId2 = null;\n            \n        onmessage = function(evt) {\n            switch(evt.data.name) {\n                case "graph1":\n                    elements1 = parseGraph(evt.data.buffer);\n                    break;\n                case "graph2":\n                    elements2 = parseGraph(evt.data.buffer);\n                    break;\n                case "model1": \n                    var len = new Uint32Array(evt.data.buffer, 0, 1)[0];\n                    var nodesLocation = len * 20 + 8; // len * sizeof(uint32) * 5 + 8\n                    bboxBuffer1 = evt.data.buffer.slice(nodesLocation);\n                    modelId1 = evt.data.modelId;\n                    break;\n                case "model2":\n                    var len = new Uint32Array(evt.data.buffer, 0, 1)[0];\n                    var nodesLocation = len * 20 + 8; // len * sizeof(uint32) * 5 + 8\n                    bboxBuffer2 = evt.data.buffer.slice(nodesLocation);\n                    modelId2 = evt.data.modelId;\n                    break;\n            }\n            compareModel(elements1, elements2, bboxBuffer1, bboxBuffer2, modelId1, modelId2);\n        };\n        '],{type:"text/javascript"}),a=new Worker(window.URL.createObjectURL(n));a.onmessage=function(e){if(e.data instanceof String)i(e.data);else{var t=e.data;r(t)}},Object(s.b)(e).then(function(t){t["model.bin"].downloadFile().then(function(t){var r={buffer:t.data,name:"model1",modelId:e};a.postMessage(r,[r.buffer]),t.data.byteLength&&console.warn("transferred buffer not supported")},function(e){i(e)}),t["modelgraph.bin"].downloadFile().then(function(e){var t={buffer:e.data,name:"graph1"};a.postMessage(t,[t.buffer]),e.data.byteLength&&console.warn("transferred buffer not supported")},function(e){i(e)})}).catch(function(e){i(e)}),Object(s.b)(t).then(function(e){e["model.bin"].downloadFile().then(function(e){var r={buffer:e.data,name:"model2",modelId:t};a.postMessage(r,[r.buffer])},function(e){i(e)}),e["modelgraph.bin"].downloadFile().then(function(e){var t={buffer:e.data,name:"graph2"};a.postMessage(t,[t.buffer])},function(e){i(e)})}).catch(function(e){i(e)})})]})})},e.get3DPDFURL=function(e){return l(this,void 0,void 0,function(){return u(this,function(t){return[2,Object(a.c)(e)]})})},e.getBBox=function(e){return l(this,void 0,void 0,function(){return u(this,function(t){return[2,new Promise(function(t,r){Object(s.b)(e).then(function(e){e["model.json"].downloadFile().then(function(e){var r=e.data;t(r["model.bin"].bbox)}).catch(function(){r("error")})})})]})})}}(i||(i={}))},function(e,t){e.exports={"application/prs.cww":["cww"],"application/vnd.1000minds.decision-model+xml":["1km"],"application/vnd.3gpp.pic-bw-large":["plb"],"application/vnd.3gpp.pic-bw-small":["psb"],"application/vnd.3gpp.pic-bw-var":["pvb"],"application/vnd.3gpp2.tcap":["tcap"],"application/vnd.3m.post-it-notes":["pwn"],"application/vnd.accpac.simply.aso":["aso"],"application/vnd.accpac.simply.imp":["imp"],"application/vnd.acucobol":["acu"],"application/vnd.acucorp":["atc","acutc"],"application/vnd.adobe.air-application-installer-package+zip":["air"],"application/vnd.adobe.formscentral.fcdt":["fcdt"],"application/vnd.adobe.fxp":["fxp","fxpl"],"application/vnd.adobe.xdp+xml":["xdp"],"application/vnd.adobe.xfdf":["xfdf"],"application/vnd.ahead.space":["ahead"],"application/vnd.airzip.filesecure.azf":["azf"],"application/vnd.airzip.filesecure.azs":["azs"],"application/vnd.amazon.ebook":["azw"],"application/vnd.americandynamics.acc":["acc"],"application/vnd.amiga.ami":["ami"],"application/vnd.android.package-archive":["apk"],"application/vnd.anser-web-certificate-issue-initiation":["cii"],"application/vnd.anser-web-funds-transfer-initiation":["fti"],"application/vnd.antix.game-component":["atx"],"application/vnd.apple.installer+xml":["mpkg"],"application/vnd.apple.keynote":["key"],"application/vnd.apple.mpegurl":["m3u8"],"application/vnd.apple.numbers":["numbers"],"application/vnd.apple.pages":["pages"],"application/vnd.apple.pkpass":["pkpass"],"application/vnd.aristanetworks.swi":["swi"],"application/vnd.astraea-software.iota":["iota"],"application/vnd.audiograph":["aep"],"application/vnd.balsamiq.bmml+xml":["bmml"],"application/vnd.blueice.multipass":["mpm"],"application/vnd.bmi":["bmi"],"application/vnd.businessobjects":["rep"],"application/vnd.chemdraw+xml":["cdxml"],"application/vnd.chipnuts.karaoke-mmd":["mmd"],"application/vnd.cinderella":["cdy"],"application/vnd.citationstyles.style+xml":["csl"],"application/vnd.claymore":["cla"],"application/vnd.cloanto.rp9":["rp9"],"application/vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"application/vnd.cluetrust.cartomobile-config":["c11amc"],"application/vnd.cluetrust.cartomobile-config-pkg":["c11amz"],"application/vnd.commonspace":["csp"],"application/vnd.contact.cmsg":["cdbcmsg"],"application/vnd.cosmocaller":["cmc"],"application/vnd.crick.clicker":["clkx"],"application/vnd.crick.clicker.keyboard":["clkk"],"application/vnd.crick.clicker.palette":["clkp"],"application/vnd.crick.clicker.template":["clkt"],"application/vnd.crick.clicker.wordbank":["clkw"],"application/vnd.criticaltools.wbs+xml":["wbs"],"application/vnd.ctc-posml":["pml"],"application/vnd.cups-ppd":["ppd"],"application/vnd.curl.car":["car"],"application/vnd.curl.pcurl":["pcurl"],"application/vnd.dart":["dart"],"application/vnd.data-vision.rdz":["rdz"],"application/vnd.dbf":["dbf"],"application/vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"application/vnd.dece.ttml+xml":["uvt","uvvt"],"application/vnd.dece.unspecified":["uvx","uvvx"],"application/vnd.dece.zip":["uvz","uvvz"],"application/vnd.denovo.fcselayout-link":["fe_launch"],"application/vnd.dna":["dna"],"application/vnd.dolby.mlp":["mlp"],"application/vnd.dpgraph":["dpg"],"application/vnd.dreamfactory":["dfac"],"application/vnd.ds-keypoint":["kpxx"],"application/vnd.dvb.ait":["ait"],"application/vnd.dvb.service":["svc"],"application/vnd.dynageo":["geo"],"application/vnd.ecowin.chart":["mag"],"application/vnd.enliven":["nml"],"application/vnd.epson.esf":["esf"],"application/vnd.epson.msf":["msf"],"application/vnd.epson.quickanime":["qam"],"application/vnd.epson.salt":["slt"],"application/vnd.epson.ssf":["ssf"],"application/vnd.eszigno3+xml":["es3","et3"],"application/vnd.ezpix-album":["ez2"],"application/vnd.ezpix-package":["ez3"],"application/vnd.fdf":["fdf"],"application/vnd.fdsn.mseed":["mseed"],"application/vnd.fdsn.seed":["seed","dataless"],"application/vnd.flographit":["gph"],"application/vnd.fluxtime.clip":["ftc"],"application/vnd.framemaker":["fm","frame","maker","book"],"application/vnd.frogans.fnc":["fnc"],"application/vnd.frogans.ltf":["ltf"],"application/vnd.fsc.weblaunch":["fsc"],"application/vnd.fujitsu.oasys":["oas"],"application/vnd.fujitsu.oasys2":["oa2"],"application/vnd.fujitsu.oasys3":["oa3"],"application/vnd.fujitsu.oasysgp":["fg5"],"application/vnd.fujitsu.oasysprs":["bh2"],"application/vnd.fujixerox.ddd":["ddd"],"application/vnd.fujixerox.docuworks":["xdw"],"application/vnd.fujixerox.docuworks.binder":["xbd"],"application/vnd.fuzzysheet":["fzs"],"application/vnd.genomatix.tuxedo":["txd"],"application/vnd.geogebra.file":["ggb"],"application/vnd.geogebra.tool":["ggt"],"application/vnd.geometry-explorer":["gex","gre"],"application/vnd.geonext":["gxt"],"application/vnd.geoplan":["g2w"],"application/vnd.geospace":["g3w"],"application/vnd.gmx":["gmx"],"application/vnd.google-apps.document":["gdoc"],"application/vnd.google-apps.presentation":["gslides"],"application/vnd.google-apps.spreadsheet":["gsheet"],"application/vnd.google-earth.kml+xml":["kml"],"application/vnd.google-earth.kmz":["kmz"],"application/vnd.grafeq":["gqf","gqs"],"application/vnd.groove-account":["gac"],"application/vnd.groove-help":["ghf"],"application/vnd.groove-identity-message":["gim"],"application/vnd.groove-injector":["grv"],"application/vnd.groove-tool-message":["gtm"],"application/vnd.groove-tool-template":["tpl"],"application/vnd.groove-vcard":["vcg"],"application/vnd.hal+xml":["hal"],"application/vnd.handheld-entertainment+xml":["zmm"],"application/vnd.hbci":["hbci"],"application/vnd.hhe.lesson-player":["les"],"application/vnd.hp-hpgl":["hpgl"],"application/vnd.hp-hpid":["hpid"],"application/vnd.hp-hps":["hps"],"application/vnd.hp-jlyt":["jlt"],"application/vnd.hp-pcl":["pcl"],"application/vnd.hp-pclxl":["pclxl"],"application/vnd.hydrostatix.sof-data":["sfd-hdstx"],"application/vnd.ibm.minipay":["mpy"],"application/vnd.ibm.modcap":["afp","listafp","list3820"],"application/vnd.ibm.rights-management":["irm"],"application/vnd.ibm.secure-container":["sc"],"application/vnd.iccprofile":["icc","icm"],"application/vnd.igloader":["igl"],"application/vnd.immervision-ivp":["ivp"],"application/vnd.immervision-ivu":["ivu"],"application/vnd.insors.igm":["igm"],"application/vnd.intercon.formnet":["xpw","xpx"],"application/vnd.intergeo":["i2g"],"application/vnd.intu.qbo":["qbo"],"application/vnd.intu.qfx":["qfx"],"application/vnd.ipunplugged.rcprofile":["rcprofile"],"application/vnd.irepository.package+xml":["irp"],"application/vnd.is-xpr":["xpr"],"application/vnd.isac.fcs":["fcs"],"application/vnd.jam":["jam"],"application/vnd.jcp.javame.midlet-rms":["rms"],"application/vnd.jisp":["jisp"],"application/vnd.joost.joda-archive":["joda"],"application/vnd.kahootz":["ktz","ktr"],"application/vnd.kde.karbon":["karbon"],"application/vnd.kde.kchart":["chrt"],"application/vnd.kde.kformula":["kfo"],"application/vnd.kde.kivio":["flw"],"application/vnd.kde.kontour":["kon"],"application/vnd.kde.kpresenter":["kpr","kpt"],"application/vnd.kde.kspread":["ksp"],"application/vnd.kde.kword":["kwd","kwt"],"application/vnd.kenameaapp":["htke"],"application/vnd.kidspiration":["kia"],"application/vnd.kinar":["kne","knp"],"application/vnd.koan":["skp","skd","skt","skm"],"application/vnd.kodak-descriptor":["sse"],"application/vnd.las.las+xml":["lasxml"],"application/vnd.llamagraphics.life-balance.desktop":["lbd"],"application/vnd.llamagraphics.life-balance.exchange+xml":["lbe"],"application/vnd.lotus-1-2-3":["123"],"application/vnd.lotus-approach":["apr"],"application/vnd.lotus-freelance":["pre"],"application/vnd.lotus-notes":["nsf"],"application/vnd.lotus-organizer":["org"],"application/vnd.lotus-screencam":["scm"],"application/vnd.lotus-wordpro":["lwp"],"application/vnd.macports.portpkg":["portpkg"],"application/vnd.mcd":["mcd"],"application/vnd.medcalcdata":["mc1"],"application/vnd.mediastation.cdkey":["cdkey"],"application/vnd.mfer":["mwf"],"application/vnd.mfmp":["mfm"],"application/vnd.micrografx.flo":["flo"],"application/vnd.micrografx.igx":["igx"],"application/vnd.mif":["mif"],"application/vnd.mobius.daf":["daf"],"application/vnd.mobius.dis":["dis"],"application/vnd.mobius.mbk":["mbk"],"application/vnd.mobius.mqy":["mqy"],"application/vnd.mobius.msl":["msl"],"application/vnd.mobius.plc":["plc"],"application/vnd.mobius.txf":["txf"],"application/vnd.mophun.application":["mpn"],"application/vnd.mophun.certificate":["mpc"],"application/vnd.mozilla.xul+xml":["xul"],"application/vnd.ms-artgalry":["cil"],"application/vnd.ms-cab-compressed":["cab"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.addin.macroenabled.12":["xlam"],"application/vnd.ms-excel.sheet.binary.macroenabled.12":["xlsb"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.ms-excel.template.macroenabled.12":["xltm"],"application/vnd.ms-fontobject":["eot"],"application/vnd.ms-htmlhelp":["chm"],"application/vnd.ms-ims":["ims"],"application/vnd.ms-lrm":["lrm"],"application/vnd.ms-officetheme":["thmx"],"application/vnd.ms-outlook":["msg"],"application/vnd.ms-pki.seccat":["cat"],"application/vnd.ms-pki.stl":["*stl"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.ms-powerpoint.addin.macroenabled.12":["ppam"],"application/vnd.ms-powerpoint.presentation.macroenabled.12":["pptm"],"application/vnd.ms-powerpoint.slide.macroenabled.12":["sldm"],"application/vnd.ms-powerpoint.slideshow.macroenabled.12":["ppsm"],"application/vnd.ms-powerpoint.template.macroenabled.12":["potm"],"application/vnd.ms-project":["mpp","mpt"],"application/vnd.ms-word.document.macroenabled.12":["docm"],"application/vnd.ms-word.template.macroenabled.12":["dotm"],"application/vnd.ms-works":["wps","wks","wcm","wdb"],"application/vnd.ms-wpl":["wpl"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.mseq":["mseq"],"application/vnd.musician":["mus"],"application/vnd.muvee.style":["msty"],"application/vnd.mynfc":["taglet"],"application/vnd.neurolanguage.nlu":["nlu"],"application/vnd.nitf":["ntf","nitf"],"application/vnd.noblenet-directory":["nnd"],"application/vnd.noblenet-sealer":["nns"],"application/vnd.noblenet-web":["nnw"],"application/vnd.nokia.n-gage.ac+xml":["*ac"],"application/vnd.nokia.n-gage.data":["ngdat"],"application/vnd.nokia.n-gage.symbian.install":["n-gage"],"application/vnd.nokia.radio-preset":["rpst"],"application/vnd.nokia.radio-presets":["rpss"],"application/vnd.novadigm.edm":["edm"],"application/vnd.novadigm.edx":["edx"],"application/vnd.novadigm.ext":["ext"],"application/vnd.oasis.opendocument.chart":["odc"],"application/vnd.oasis.opendocument.chart-template":["otc"],"application/vnd.oasis.opendocument.database":["odb"],"application/vnd.oasis.opendocument.formula":["odf"],"application/vnd.oasis.opendocument.formula-template":["odft"],"application/vnd.oasis.opendocument.graphics":["odg"],"application/vnd.oasis.opendocument.graphics-template":["otg"],"application/vnd.oasis.opendocument.image":["odi"],"application/vnd.oasis.opendocument.image-template":["oti"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.presentation-template":["otp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.spreadsheet-template":["ots"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.oasis.opendocument.text-master":["odm"],"application/vnd.oasis.opendocument.text-template":["ott"],"application/vnd.oasis.opendocument.text-web":["oth"],"application/vnd.olpc-sugar":["xo"],"application/vnd.oma.dd2+xml":["dd2"],"application/vnd.openblox.game+xml":["obgx"],"application/vnd.openofficeorg.extension":["oxt"],"application/vnd.openstreetmap.data+xml":["osm"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.osgeo.mapguide.package":["mgp"],"application/vnd.osgi.dp":["dp"],"application/vnd.osgi.subsystem":["esa"],"application/vnd.palm":["pdb","pqa","oprc"],"application/vnd.pawaafile":["paw"],"application/vnd.pg.format":["str"],"application/vnd.pg.osasli":["ei6"],"application/vnd.picsel":["efif"],"application/vnd.pmi.widget":["wg"],"application/vnd.pocketlearn":["plf"],"application/vnd.powerbuilder6":["pbd"],"application/vnd.previewsystems.box":["box"],"application/vnd.proteus.magazine":["mgz"],"application/vnd.publishare-delta-tree":["qps"],"application/vnd.pvi.ptid1":["ptid"],"application/vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"application/vnd.rar":["rar"],"application/vnd.realvnc.bed":["bed"],"application/vnd.recordare.musicxml":["mxl"],"application/vnd.recordare.musicxml+xml":["musicxml"],"application/vnd.rig.cryptonote":["cryptonote"],"application/vnd.rim.cod":["cod"],"application/vnd.rn-realmedia":["rm"],"application/vnd.rn-realmedia-vbr":["rmvb"],"application/vnd.route66.link66+xml":["link66"],"application/vnd.sailingtracker.track":["st"],"application/vnd.seemail":["see"],"application/vnd.sema":["sema"],"application/vnd.semd":["semd"],"application/vnd.semf":["semf"],"application/vnd.shana.informed.formdata":["ifm"],"application/vnd.shana.informed.formtemplate":["itp"],"application/vnd.shana.informed.interchange":["iif"],"application/vnd.shana.informed.package":["ipk"],"application/vnd.simtech-mindmapper":["twd","twds"],"application/vnd.smaf":["mmf"],"application/vnd.smart.teacher":["teacher"],"application/vnd.software602.filler.form+xml":["fo"],"application/vnd.solent.sdkm+xml":["sdkm","sdkd"],"application/vnd.spotfire.dxp":["dxp"],"application/vnd.spotfire.sfs":["sfs"],"application/vnd.stardivision.calc":["sdc"],"application/vnd.stardivision.draw":["sda"],"application/vnd.stardivision.impress":["sdd"],"application/vnd.stardivision.math":["smf"],"application/vnd.stardivision.writer":["sdw","vor"],"application/vnd.stardivision.writer-global":["sgl"],"application/vnd.stepmania.package":["smzip"],"application/vnd.stepmania.stepchart":["sm"],"application/vnd.sun.wadl+xml":["wadl"],"application/vnd.sun.xml.calc":["sxc"],"application/vnd.sun.xml.calc.template":["stc"],"application/vnd.sun.xml.draw":["sxd"],"application/vnd.sun.xml.draw.template":["std"],"application/vnd.sun.xml.impress":["sxi"],"application/vnd.sun.xml.impress.template":["sti"],"application/vnd.sun.xml.math":["sxm"],"application/vnd.sun.xml.writer":["sxw"],"application/vnd.sun.xml.writer.global":["sxg"],"application/vnd.sun.xml.writer.template":["stw"],"application/vnd.sus-calendar":["sus","susp"],"application/vnd.svd":["svd"],"application/vnd.symbian.install":["sis","sisx"],"application/vnd.syncml+xml":["xsm"],"application/vnd.syncml.dm+wbxml":["bdm"],"application/vnd.syncml.dm+xml":["xdm"],"application/vnd.syncml.dmddf+xml":["ddf"],"application/vnd.tao.intent-module-archive":["tao"],"application/vnd.tcpdump.pcap":["pcap","cap","dmp"],"application/vnd.tmobile-livetv":["tmo"],"application/vnd.trid.tpt":["tpt"],"application/vnd.triscape.mxs":["mxs"],"application/vnd.trueapp":["tra"],"application/vnd.ufdl":["ufd","ufdl"],"application/vnd.uiq.theme":["utz"],"application/vnd.umajin":["umj"],"application/vnd.unity":["unityweb"],"application/vnd.uoml+xml":["uoml"],"application/vnd.vcx":["vcx"],"application/vnd.visio":["vsd","vst","vss","vsw"],"application/vnd.visionary":["vis"],"application/vnd.vsf":["vsf"],"application/vnd.wap.wbxml":["wbxml"],"application/vnd.wap.wmlc":["wmlc"],"application/vnd.wap.wmlscriptc":["wmlsc"],"application/vnd.webturbo":["wtb"],"application/vnd.wolfram.player":["nbp"],"application/vnd.wordperfect":["wpd"],"application/vnd.wqd":["wqd"],"application/vnd.wt.stf":["stf"],"application/vnd.xara":["xar"],"application/vnd.xfdl":["xfdl"],"application/vnd.yamaha.hv-dic":["hvd"],"application/vnd.yamaha.hv-script":["hvs"],"application/vnd.yamaha.hv-voice":["hvp"],"application/vnd.yamaha.openscoreformat":["osf"],"application/vnd.yamaha.openscoreformat.osfpvg+xml":["osfpvg"],"application/vnd.yamaha.smaf-audio":["saf"],"application/vnd.yamaha.smaf-phrase":["spf"],"application/vnd.yellowriver-custom-menu":["cmp"],"application/vnd.zul":["zir","zirz"],"application/vnd.zzazz.deck+xml":["zaz"],"application/x-7z-compressed":["7z"],"application/x-abiword":["abw"],"application/x-ace-compressed":["ace"],"application/x-apple-diskimage":["*dmg"],"application/x-arj":["arj"],"application/x-authorware-bin":["aab","x32","u32","vox"],"application/x-authorware-map":["aam"],"application/x-authorware-seg":["aas"],"application/x-bcpio":["bcpio"],"application/x-bdoc":["*bdoc"],"application/x-bittorrent":["torrent"],"application/x-blorb":["blb","blorb"],"application/x-bzip":["bz"],"application/x-bzip2":["bz2","boz"],"application/x-cbr":["cbr","cba","cbt","cbz","cb7"],"application/x-cdlink":["vcd"],"application/x-cfs-compressed":["cfs"],"application/x-chat":["chat"],"application/x-chess-pgn":["pgn"],"application/x-chrome-extension":["crx"],"application/x-cocoa":["cco"],"application/x-conference":["nsc"],"application/x-cpio":["cpio"],"application/x-csh":["csh"],"application/x-debian-package":["*deb","udeb"],"application/x-dgc-compressed":["dgc"],"application/x-director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"application/x-doom":["wad"],"application/x-dtbncx+xml":["ncx"],"application/x-dtbook+xml":["dtb"],"application/x-dtbresource+xml":["res"],"application/x-dvi":["dvi"],"application/x-envoy":["evy"],"application/x-eva":["eva"],"application/x-font-bdf":["bdf"],"application/x-font-ghostscript":["gsf"],"application/x-font-linux-psf":["psf"],"application/x-font-pcf":["pcf"],"application/x-font-snf":["snf"],"application/x-font-type1":["pfa","pfb","pfm","afm"],"application/x-freearc":["arc"],"application/x-futuresplash":["spl"],"application/x-gca-compressed":["gca"],"application/x-glulx":["ulx"],"application/x-gnumeric":["gnumeric"],"application/x-gramps-xml":["gramps"],"application/x-gtar":["gtar"],"application/x-hdf":["hdf"],"application/x-httpd-php":["php"],"application/x-install-instructions":["install"],"application/x-iso9660-image":["*iso"],"application/x-java-archive-diff":["jardiff"],"application/x-java-jnlp-file":["jnlp"],"application/x-keepass2":["kdbx"],"application/x-latex":["latex"],"application/x-lua-bytecode":["luac"],"application/x-lzh-compressed":["lzh","lha"],"application/x-makeself":["run"],"application/x-mie":["mie"],"application/x-mobipocket-ebook":["prc","mobi"],"application/x-ms-application":["application"],"application/x-ms-shortcut":["lnk"],"application/x-ms-wmd":["wmd"],"application/x-ms-wmz":["wmz"],"application/x-ms-xbap":["xbap"],"application/x-msaccess":["mdb"],"application/x-msbinder":["obd"],"application/x-mscardfile":["crd"],"application/x-msclip":["clp"],"application/x-msdos-program":["*exe"],"application/x-msdownload":["*exe","*dll","com","bat","*msi"],"application/x-msmediaview":["mvb","m13","m14"],"application/x-msmetafile":["*wmf","*wmz","*emf","emz"],"application/x-msmoney":["mny"],"application/x-mspublisher":["pub"],"application/x-msschedule":["scd"],"application/x-msterminal":["trm"],"application/x-mswrite":["wri"],"application/x-netcdf":["nc","cdf"],"application/x-ns-proxy-autoconfig":["pac"],"application/x-nzb":["nzb"],"application/x-perl":["pl","pm"],"application/x-pilot":["*prc","*pdb"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b","spc"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["*rar"],"application/x-redhat-package-manager":["rpm"],"application/x-research-info-systems":["ris"],"application/x-sea":["sea"],"application/x-sh":["sh"],"application/x-shar":["shar"],"application/x-shockwave-flash":["swf"],"application/x-silverlight-app":["xap"],"application/x-sql":["sql"],"application/x-stuffit":["sit"],"application/x-stuffitx":["sitx"],"application/x-subrip":["srt"],"application/x-sv4cpio":["sv4cpio"],"application/x-sv4crc":["sv4crc"],"application/x-t3vm-image":["t3"],"application/x-tads":["gam"],"application/x-tar":["tar"],"application/x-tcl":["tcl","tk"],"application/x-tex":["tex"],"application/x-tex-tfm":["tfm"],"application/x-texinfo":["texinfo","texi"],"application/x-tgif":["*obj"],"application/x-ustar":["ustar"],"application/x-virtualbox-hdd":["hdd"],"application/x-virtualbox-ova":["ova"],"application/x-virtualbox-ovf":["ovf"],"application/x-virtualbox-vbox":["vbox"],"application/x-virtualbox-vbox-extpack":["vbox-extpack"],"application/x-virtualbox-vdi":["vdi"],"application/x-virtualbox-vhd":["vhd"],"application/x-virtualbox-vmdk":["vmdk"],"application/x-wais-source":["src"],"application/x-web-app-manifest+json":["webapp"],"application/x-x509-ca-cert":["der","crt","pem"],"application/x-xfig":["fig"],"application/x-xliff+xml":["*xlf"],"application/x-xpinstall":["xpi"],"application/x-xz":["xz"],"application/x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/x-aac":["aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-m4a":["*m4a"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-realaudio":["*ra"],"audio/x-wav":["*wav"],"chemical/x-cdx":["cdx"],"chemical/x-cif":["cif"],"chemical/x-cmdf":["cmdf"],"chemical/x-cml":["cml"],"chemical/x-csml":["csml"],"chemical/x-xyz":["xyz"],"image/prs.btif":["btif"],"image/prs.pti":["pti"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["*sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-dds":["dds"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.pco.b16":["b16"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/x-3ds":["3ds"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["*ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["*bmp"],"image/x-pcx":["*pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"],"message/vnd.wfa.wsc":["wsc"],"model/vnd.collada+xml":["dae"],"model/vnd.dwf":["dwf"],"model/vnd.gdl":["gdl"],"model/vnd.gtw":["gtw"],"model/vnd.mts":["mts"],"model/vnd.opengex":["ogex"],"model/vnd.parasolid.transmit.binary":["x_b"],"model/vnd.parasolid.transmit.text":["x_t"],"model/vnd.usdz+zip":["usdz"],"model/vnd.valve.source.compiled-map":["bsp"],"model/vnd.vtu":["vtu"],"text/prs.lines.tag":["dsc"],"text/vnd.curl":["curl"],"text/vnd.curl.dcurl":["dcurl"],"text/vnd.curl.mcurl":["mcurl"],"text/vnd.curl.scurl":["scurl"],"text/vnd.dvb.subtitle":["sub"],"text/vnd.fly":["fly"],"text/vnd.fmi.flexstor":["flx"],"text/vnd.graphviz":["gv"],"text/vnd.in3d.3dml":["3dml"],"text/vnd.in3d.spot":["spot"],"text/vnd.sun.j2me.app-descriptor":["jad"],"text/vnd.wap.wml":["wml"],"text/vnd.wap.wmlscript":["wmls"],"text/x-asm":["s","asm"],"text/x-c":["c","cc","cxx","cpp","h","hh","dic"],"text/x-component":["htc"],"text/x-fortran":["f","for","f77","f90"],"text/x-handlebars-template":["hbs"],"text/x-java-source":["java"],"text/x-lua":["lua"],"text/x-markdown":["mkd"],"text/x-nfo":["nfo"],"text/x-opml":["opml"],"text/x-org":["*org"],"text/x-pascal":["p","pas"],"text/x-processing":["pde"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/x-setext":["etx"],"text/x-sfv":["sfv"],"text/x-suse-ymp":["ymp"],"text/x-uuencode":["uu"],"text/x-vcalendar":["vcs"],"text/x-vcard":["vcf"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"],"x-conference/x-cooltalk":["ice"]}},function(e,t){e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma","es"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/mrb-consumer+xml":["*xdf"],"application/mrb-publish+xml":["*xdf"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["*xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-error+xml":["xer"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},function(e,t,r){"use strict";function i(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}i.prototype.define=function(e,t){for(let r in e){let i=e[r].map(function(e){return e.toLowerCase()});r=r.toLowerCase();for(let e=0;e<i.length;e++){const n=i[e];if("*"!==n[0]){if(!t&&n in this._types)throw new Error('Attempt to change mapping for "'+n+'" extension from "'+this._types[n]+'" to "'+r+'". Pass `force=true` to allow this, otherwise remove "'+n+'" from the list of extensions for "'+r+'".');this._types[n]=r}}if(t||!this._extensions[r]){const e=i[0];this._extensions[r]="*"!==e[0]?e:e.substr(1)}}},i.prototype.getType=function(e){let t=(e=String(e)).replace(/^.*[/\\]/,"").toLowerCase(),r=t.replace(/^.*\./,"").toLowerCase(),i=t.length<e.length;return(r.length<t.length-1||!i)&&this._types[r]||null},i.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null},e.exports=i},function(e,t,r){"use strict";function i(e){for(var t=null,r=1;r<e.length;r++){var i=e[r],a=n(i);if(a!==i.length&&((null===t||a<t)&&0===(t=a)))break}return null===t?0:t}function n(e){for(var t=0;t<e.length&&(" "===e[t]||"\t"===e[t]);)t++;return t}function a(e){return n(e)===e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.dedentBlockStringValue=function(e){var t=e.split(/\r\n|[\n\r]/g),r=i(t);if(0!==r)for(var n=1;n<t.length;n++)t[n]=t[n].slice(r);for(;t.length>0&&a(t[0]);)t.shift();for(;t.length>0&&a(t[t.length-1]);)t.pop();return t.join("\n")},t.getBlockStringIndentation=i,t.printBlockString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=-1===e.indexOf("\n"),n=" "===e[0]||"\t"===e[0],a='"'===e[e.length-1],o=!i||a||r,s="";!o||i&&n||(s+="\n"+t);s+=t?e.replace(/\n/g,"\n"+t):e,o&&(s+="\n");return'"""'+s.replace(/"""/g,'\\"""')+'"""'}},function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Observable=void 0;var o=function(){return"function"==typeof Symbol},s=function(e){return o()&&Boolean(Symbol[e])},l=function(e){return s(e)?Symbol[e]:"@@"+e};o()&&!s("observable")&&(Symbol.observable=Symbol("observable"));var u=l("iterator"),c=l("observable"),h=l("species");function d(e,t){var r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}}function p(e){var t=e.constructor;return void 0!==t&&null===(t=t[h])&&(t=void 0),void 0!==t?t:M}function f(e){return e instanceof M}function m(e){m.log?m.log(e):setTimeout(function(){throw e})}function _(e){Promise.resolve().then(function(){try{e()}catch(e){m(e)}})}function v(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var r=d(t,"unsubscribe");r&&r.call(t)}}catch(e){m(e)}}function y(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function g(e,t,r){e._state="running";var i=e._observer;try{var n=d(i,t);switch(t){case"next":n&&n.call(i,r);break;case"error":if(y(e),!n)throw r;n.call(i,r);break;case"complete":y(e),n&&n.call(i)}}catch(e){m(e)}"closed"===e._state?v(e):"running"===e._state&&(e._state="ready")}function b(e,t,r){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:r}],void _(function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var r=0;r<t.length&&(g(e,t[r].type,t[r].value),"closed"!==e._state);++r);}}(e)})):void g(e,t,r);e._queue.push({type:t,value:r})}}var w=function(){function e(t,r){i(this,e),this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var n=new x(this);try{this._cleanup=r.call(void 0,n)}catch(e){n.error(e)}"initializing"===this._state&&(this._state="ready")}return a(e,[{key:"unsubscribe",value:function(){"closed"!==this._state&&(y(this),v(this))}},{key:"closed",get:function(){return"closed"===this._state}}]),e}(),x=function(){function e(t){i(this,e),this._subscription=t}return a(e,[{key:"next",value:function(e){b(this._subscription,"next",e)}},{key:"error",value:function(e){b(this._subscription,"error",e)}},{key:"complete",value:function(){b(this._subscription,"complete")}},{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),M=function(){function e(t){if(i(this,e),!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}return a(e,[{key:"subscribe",value:function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new w(e,this._subscriber)}},{key:"forEach",value:function(e){var t=this;return new Promise(function(r,i){if("function"==typeof e)var n=t.subscribe({next:function(t){try{e(t,a)}catch(e){i(e),n.unsubscribe()}},error:i,complete:r});else i(new TypeError(e+" is not a function"));function a(){n.unsubscribe(),r()}})}},{key:"map",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(p(this))(function(r){return t.subscribe({next:function(t){try{t=e(t)}catch(e){return r.error(e)}r.next(t)},error:function(e){r.error(e)},complete:function(){r.complete()}})})}},{key:"filter",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(p(this))(function(r){return t.subscribe({next:function(t){try{if(!e(t))return}catch(e){return r.error(e)}r.next(t)},error:function(e){r.error(e)},complete:function(){r.complete()}})})}},{key:"reduce",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var r=p(this),i=arguments.length>1,n=!1,a=arguments[1];return new r(function(r){return t.subscribe({next:function(t){var o=!n;if(n=!0,!o||i)try{a=e(a,t)}catch(e){return r.error(e)}else a=t},error:function(e){r.error(e)},complete:function(){if(!n&&!i)return r.error(new TypeError("Cannot reduce an empty sequence"));r.next(a),r.complete()}})})}},{key:"concat",value:function(){for(var e=this,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var n=p(this);return new n(function(t){var i,a=0;return function e(o){i=o.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){a===r.length?(i=void 0,t.complete()):e(n.from(r[a++]))}})}(e),function(){i&&(i.unsubscribe(),i=void 0)}})}},{key:"flatMap",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var r=p(this);return new r(function(i){var n=[],a=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(e){return i.error(e)}var a=r.from(t).subscribe({next:function(e){i.next(e)},error:function(e){i.error(e)},complete:function(){var e=n.indexOf(a);e>=0&&n.splice(e,1),o()}});n.push(a)},error:function(e){i.error(e)},complete:function(){o()}});function o(){a.closed&&0===n.length&&i.complete()}return function(){n.forEach(function(e){return e.unsubscribe()}),a.unsubscribe()}})}},{key:c,value:function(){return this}}],[{key:"from",value:function(t){var r="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var i=d(t,c);if(i){var n=i.call(t);if(Object(n)!==n)throw new TypeError(n+" is not an object");return f(n)&&n.constructor===r?n:new r(function(e){return n.subscribe(e)})}if(s("iterator")&&(i=d(t,u)))return new r(function(e){_(function(){if(!e.closed){var r=!0,n=!1,a=void 0;try{for(var o,s=i.call(t)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;if(e.next(l),e.closed)return}}catch(e){n=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}e.complete()}})});if(Array.isArray(t))return new r(function(e){_(function(){if(!e.closed){for(var r=0;r<t.length;++r)if(e.next(t[r]),e.closed)return;e.complete()}})});throw new TypeError(t+" is not observable")}},{key:"of",value:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return new("function"==typeof this?this:e)(function(e){_(function(){if(!e.closed){for(var t=0;t<r.length;++t)if(e.next(r[t]),e.closed)return;e.complete()}})})}},{key:h,get:function(){return this}}]),e}();t.Observable=M,o()&&Object.defineProperty(M,Symbol("extensions"),{value:{symbol:c,hostReportError:m},configurable:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):void 0;t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return s(e,[])};var i=function(e){return e&&e.__esModule?e:{default:e}}(r(124));function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=10,o=2;function s(e,t){switch(n(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return null===e?"null":function(e,t){if(-1!==t.indexOf(e))return"[Circular]";var r=[].concat(t,[e]),n=function(e){var t=e[String(i.default)];if("function"==typeof t)return t;if("function"==typeof e.inspect)return e.inspect}(e);if(void 0!==n){var l=n.call(e);if(l!==e)return"string"==typeof l?l:s(l,r)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>o)return"[Array]";for(var r=Math.min(a,e.length),i=e.length-r,n=[],l=0;l<r;++l)n.push(s(e[l],t));1===i?n.push("... 1 more item"):i>1&&n.push("... ".concat(i," more items"));return"["+n.join(", ")+"]"}(e,r);return function(e,t){var r=Object.keys(e);if(0===r.length)return"{}";if(t.length>o)return"["+function(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){var r=e.constructor.name;if("string"==typeof r&&""!==r)return r}return t}(e)+"]";return"{ "+r.map(function(r){var i=s(e[r],t);return r+": "+i}).join(", ")+" }"}(e,r)}(e,t);default:return String(e)}}},function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){"use strict";var i=r(66);function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new i(e),t(r.reason))})}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e;return{token:new n(function(t){e=t}),cancel:e}},e.exports=n},function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,r){"use strict";var i=r(31);e.exports=function(e,t,r){return i.forEach(r,function(r){e=r(e,t)}),e}},function(e,t,r){"use strict";var i=r(31),n=r(130),a=r(67),o=r(59),s=r(129),l=r(128);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!s(e.url)&&(e.url=l(e.baseURL,e.url)),e.headers=e.headers||{},e.data=n(e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),i.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||o.adapter)(e).then(function(t){return u(e),t.data=n(t.data,t.headers,e.transformResponse),t},function(t){return a(t)||(u(e),t&&t.response&&(t.response.data=n(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,r){"use strict";var i=r(31);function n(){this.handlers=[]}n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){i.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=n},function(e,t,r){"use strict";var i=r(31);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,r,n,a,o){var s=[];s.push(e+"="+encodeURIComponent(t)),i.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),i.isString(n)&&s.push("path="+n),i.isString(a)&&s.push("domain="+a),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,r){"use strict";var i=r(31);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var i=e;return t&&(r.setAttribute("href",i),i=r.href),r.setAttribute("href",i),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=i.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},function(e,t,r){"use strict";var i=r(31),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,a,o={};return e?(i.forEach(e.split("\n"),function(e){if(a=e.indexOf(":"),t=i.trim(e.substr(0,a)).toLowerCase(),r=i.trim(e.substr(a+1)),t){if(o[t]&&n.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([r]):o[t]?o[t]+", "+r:r}}),o):o}},function(e,t,r){"use strict";var i=r(31);function n(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var a;if(r)a=r(t);else if(i.isURLSearchParams(t))a=t.toString();else{var o=[];i.forEach(t,function(e,t){null!==e&&void 0!==e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),o.push(n(t)+"="+n(e))}))}),a=o.join("&")}return a&&(e+=(-1===e.indexOf("?")?"?":"&")+a),e}},function(e,t,r){"use strict";e.exports=function(e,t,r,i,n){return e.config=t,r&&(e.code=r),e.request=i,e.response=n,e}},function(e,t,r){"use strict";var i=r(68);e.exports=function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(i("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},function(e,t,r){"use strict";var i=r(31);e.exports=function(e,t){i.forEach(e,function(r,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[i])})}},function(e,t,r){"use strict";var i=r(59),n=r(31),a=r(132),o=r(131);function s(e){this.defaults=e,this.interceptors={request:new a,response:new a}}s.prototype.request=function(e){"string"==typeof e&&(e=n.merge({url:arguments[0]},arguments[1])),(e=n.merge(i,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[o,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},n.forEach(["delete","get","head","options"],function(e){s.prototype[e]=function(t,r){return this.request(n.merge(r||{},{method:e,url:t}))}}),n.forEach(["post","put","patch"],function(e){s.prototype[e]=function(t,r,i){return this.request(n.merge(i||{},{method:e,url:t,data:r}))}}),e.exports=s},function(e,t){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,r){"use strict";var i=r(31),n=r(70),a=r(140),o=r(59);function s(e){var t=new a(e),r=n(a.prototype.request,t);return i.extend(r,a.prototype,t),i.extend(r,t),r}var l=s(o);l.Axios=a,l.create=function(e){return s(i.merge(o,e))},l.Cancel=r(66),l.CancelToken=r(127),l.isCancel=r(67),l.all=function(e){return Promise.all(e)},l.spread=r(126),e.exports=l,e.exports.default=l},function(e,t){var r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ModelInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Model"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"folderId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"targetModelId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"version"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updatedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"downloadUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"convertedUrls"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:321}};r.loc.source={body:"fragment ModelInfo on Model {\r\n    id\r\n    folderId\r\n    targetModelId\r\n    type\r\n    name\r\n    status\r\n    version\r\n    createdBy {\r\n        id\r\n        username\r\n    }\r\n    createdAt\r\n    updatedAt\r\n    downloadUrls {\r\n        filename\r\n        url\r\n    }\r\n    convertedUrls {\r\n        filename\r\n        url\r\n    }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=r},function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"init",function(){return m});var i=r(39),n=r(118),a=r(78),o=r(77),s=r(71),l=r(48),u=r(73),c=r(25),h=r(72),d=r(63);for(var p in d)["init","default"].indexOf(p)<0&&function(e){r.d(t,e,function(){return d[e]})}(p);var f=r(37);function m(e){Object(c.b)(e,Object(c.d)(["endpoint","appToken"]),"initial config not valid"),Object(i.b)(e)}r.d(t,"ComStatus",function(){return f.c}),r.d(t,"AssetType",function(){return f.b}),r.d(t,"TaskPriority",function(){return f.k}),r.d(t,"TaskCommentType",function(){return f.j}),r.d(t,"IssuePriority",function(){return f.d}),r.d(t,"IssueStatus",function(){return f.e}),r.d(t,"ModelType",function(){return f.h}),r.d(t,"ModelStatus",function(){return f.g}),r.d(t,"SelectionType",function(){return f.i}),r.d(t,"ModelShaderSetting",function(){return f.f}),r.d(t,"AssetStatus",function(){return f.a}),r.d(t,"WechatMessageType",function(){return f.l}),e.WebGLUtils=Object(h.a)(),t.default={Model:n.a,Asset:a.a,BIM:o.a,Comment:l.a,RenderSetting:u.a,View:s.a,isSupportWebGL:c.e,isSupportWebGL2:c.f,init:m}}.call(this,r(60))},function(e,t,r){e.exports=r(144)}]).default});
//# sourceMappingURL=build.js.map