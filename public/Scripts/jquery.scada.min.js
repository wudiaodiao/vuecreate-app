(function(){var s=/^[\s,#]+/,r=/\s+$/,o=0,u=Math,a=u.round,h=u.min,c=u.max,e=u.random;var d=function(e,t){e=e?e:"";t=t||{};if(e instanceof d){return e}if(!(this instanceof d)){return new d(e,t)}var i=n(e);this._originalInput=e,this._r=i.r,this._g=i.g,this._b=i.b,this._a=i.a,this._roundA=a(100*this._a)/100,this._format=t.format||i.format;this._gradientType=t.gradientType;if(this._r<1){this._r=a(this._r)}if(this._g<1){this._g=a(this._g)}if(this._b<1){this._b=a(this._b)}this._ok=i.ok;this._tc_id=o++};d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},setAlpha:function(e){this._a=U(e);this._roundA=a(100*this._a)/100;return this},toHsv:function(){var e=g(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=g(this._r,this._g,this._b);var t=a(e.h*360),i=a(e.s*100),s=a(e.v*100);return this._a==1?"hsv("+t+", "+i+"%, "+s+"%)":"hsva("+t+", "+i+"%, "+s+"%, "+this._roundA+")"},toHsl:function(){var e=f(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=f(this._r,this._g,this._b);var t=a(e.h*360),i=a(e.s*100),s=a(e.l*100);return this._a==1?"hsl("+t+", "+i+"%, "+s+"%)":"hsla("+t+", "+i+"%, "+s+"%, "+this._roundA+")"},toHex:function(e){return t(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return _(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+a(this._r)+","+a(this._g)+","+a(this._b)+")":"rgba("+a(this._r)+","+a(this._g)+","+a(this._b)+","+this._roundA+")"},toPercentageRgb:function(){return{r:a(N(this._r,255)*100)+"%",g:a(N(this._g,255)*100)+"%",b:a(N(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+a(N(this._r,255)*100)+"%, "+a(N(this._g,255)*100)+"%, "+a(N(this._b,255)*100)+"%)":"rgba("+a(N(this._r,255)*100)+"%, "+a(N(this._g,255)*100)+"%, "+a(N(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0){return"transparent"}if(this._a<1){return false}return E[t(this._r,this._g,this._b,true)]||false},toFilter:function(e){var t="#"+_(this._r,this._g,this._b,this._a);var i=t;var s=this._gradientType?"GradientType = 1, ":"";if(e){var r=d(e);i=r.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+s+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){return this.toName()||(this._a==1?this.toHexString():this.toRgbString())},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));this._r=i._r;this._g=i._g;this._b=i._b;this.setAlpha(i._a);return this},lighten:function(){return this._applyModification(b,arguments)},brighten:function(){return this._applyModification(w,arguments)},darken:function(){return this._applyModification(x,arguments)},desaturate:function(){return this._applyModification(i,arguments)},saturate:function(){return this._applyModification(v,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(C,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(T,arguments)},complement:function(){return this._applyCombination(k,arguments)},monochromatic:function(){return this._applyCombination(G,arguments)},splitcomplement:function(){return this._applyCombination(M,arguments)},triad:function(){return this._applyCombination(S,arguments)},tetrad:function(){return this._applyCombination(R,arguments)}};d.fromRatio=function(e,t){if(typeof e=="object"){var i={};for(var s in e){if(e.hasOwnProperty(s)){if(s==="a"){i[s]=e[s]}else{i[s]=P(e[s])}}}e=i}return d(e,t)};function n(e){var t={r:0,g:0,b:0};var i=1;var s=false;var r=false;if(typeof e=="string"){e=j(e)}if(typeof e=="object"){if(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")){t=l(e.r,e.g,e.b);s=true;r=String(e.r).substr(-1)==="%"?"prgb":"rgb"}else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")){e.s=P(e.s);e.v=P(e.v);t=y(e.h,e.s,e.v);s=true;r="hsv"}else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")){e.s=P(e.s);e.l=P(e.l);t=p(e.h,e.s,e.l);s=true;r="hsl"}if(e.hasOwnProperty("a")){i=e.a}}i=U(i);return{ok:s,format:e.format||r,r:h(255,c(t.r,0)),g:h(255,c(t.g,0)),b:h(255,c(t.b,0)),a:i}}function l(e,t,i){return{r:N(e,255)*255,g:N(t,255)*255,b:N(i,255)*255}}function f(e,t,i){e=N(e,255);t=N(t,255);i=N(i,255);var s=c(e,t,i),r=h(e,t,i);var o,a,n=(s+r)/2;if(s==r){o=a=0}else{var l=s-r;a=n>.5?l/(2-s-r):l/(s+r);switch(s){case e:o=(t-i)/l+(t<i?6:0);break;case t:o=(i-e)/l+2;break;case i:o=(e-t)/l+4;break}o/=6}return{h:o,s:a,l:n}}function p(e,t,i){var s,r,o;e=N(e,360);t=N(t,100);i=N(i,100);function a(e,t,i){if(i<0)i+=1;if(i>1)i-=1;if(i<1/6)return e+(t-e)*6*i;if(i<1/2)return t;if(i<2/3)return e+(t-e)*(2/3-i)*6;return e}if(t===0){s=r=o=i}else{var n=i<.5?i*(1+t):i+t-i*t;var l=2*i-n;s=a(l,n,e+1/3);r=a(l,n,e);o=a(l,n,e-1/3)}return{r:s*255,g:r*255,b:o*255}}function g(e,t,i){e=N(e,255);t=N(t,255);i=N(i,255);var s=c(e,t,i),r=h(e,t,i);var o,a,n=s;var l=s-r;a=s===0?0:l/s;if(s==r){o=0}else{switch(s){case e:o=(t-i)/l+(t<i?6:0);break;case t:o=(i-e)/l+2;break;case i:o=(e-t)/l+4;break}o/=6}return{h:o,s:a,v:n}}function y(e,t,i){e=N(e,360)*6;t=N(t,100);i=N(i,100);var s=u.floor(e),r=e-s,o=i*(1-t),a=i*(1-r*t),n=i*(1-(1-r)*t),l=s%6,h=[i,a,o,o,n,i][l],c=[n,i,i,a,o,o][l],d=[o,o,n,i,i,a][l];return{r:h*255,g:c*255,b:d*255}}function t(e,t,i,s){var r=[B(a(e).toString(16)),B(a(t).toString(16)),B(a(i).toString(16))];if(s&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)){return r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)}return r.join("")}function _(e,t,i,s){var r=[B(V(s)),B(a(e).toString(16)),B(a(t).toString(16)),B(a(i).toString(16))];return r.join("")}d.equals=function(e,t){if(!e||!t){return false}return d(e).toRgbString()==d(t).toRgbString()};d.random=function(){return d.fromRatio({r:e(),g:e(),b:e()})};function i(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.s-=t/100;i.s=A(i.s);return d(i)}function v(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.s+=t/100;i.s=A(i.s);return d(i)}function m(e){return d(e).desaturate(100)}function b(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.l+=t/100;i.l=A(i.l);return d(i)}function w(e,t){t=t===0?0:t||10;var i=d(e).toRgb();i.r=c(0,h(255,i.r-a(255*-(t/100))));i.g=c(0,h(255,i.g-a(255*-(t/100))));i.b=c(0,h(255,i.b-a(255*-(t/100))));return d(i)}function x(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.l-=t/100;i.l=A(i.l);return d(i)}function C(e,t){var i=d(e).toHsl();var s=(a(i.h)+t)%360;i.h=s<0?360+s:s;return d(i)}function k(e){var t=d(e).toHsl();t.h=(t.h+180)%360;return d(t)}function S(e){var t=d(e).toHsl();var i=t.h;return[d(e),d({h:(i+120)%360,s:t.s,l:t.l}),d({h:(i+240)%360,s:t.s,l:t.l})]}function R(e){var t=d(e).toHsl();var i=t.h;return[d(e),d({h:(i+90)%360,s:t.s,l:t.l}),d({h:(i+180)%360,s:t.s,l:t.l}),d({h:(i+270)%360,s:t.s,l:t.l})]}function M(e){var t=d(e).toHsl();var i=t.h;return[d(e),d({h:(i+72)%360,s:t.s,l:t.l}),d({h:(i+216)%360,s:t.s,l:t.l})]}function T(e,t,i){t=t||6;i=i||30;var s=d(e).toHsl();var r=360/i;var o=[d(e)];for(s.h=(s.h-(r*t>>1)+720)%360;--t;){s.h=(s.h+r)%360;o.push(d(s))}return o}function G(e,t){t=t||6;var i=d(e).toHsv();var s=i.h,r=i.s,o=i.v;var a=[];var n=1/t;while(t--){a.push(d({h:s,s:r,v:o}));o=(o+n)%1}return a}d.mix=function(e,t,i){i=i===0?0:i||50;var s=d(e).toRgb();var r=d(t).toRgb();var o=i/100;var a=o*2-1;var n=r.a-s.a;var l;if(a*n==-1){l=a}else{l=(a+n)/(1+a*n)}l=(l+1)/2;var h=1-l;var c={r:r.r*l+s.r*h,g:r.g*l+s.g*h,b:r.b*l+s.b*h,a:r.a*o+s.a*(1-o)};return d(c)};d.readability=function(e,t){var i=d(e);var s=d(t);var r=i.toRgb();var o=s.toRgb();var a=i.getBrightness();var n=s.getBrightness();var l=Math.max(r.r,o.r)-Math.min(r.r,o.r)+Math.max(r.g,o.g)-Math.min(r.g,o.g)+Math.max(r.b,o.b)-Math.min(r.b,o.b);return{brightness:Math.abs(a-n),color:l}};d.isReadable=function(e,t){var i=d.readability(e,t);return i.brightness>125&&i.color>500};d.mostReadable=function(e,t){var i=null;var s=0;var r=false;for(var o=0;o<t.length;o++){var a=d.readability(e,t[o]);var n=a.brightness>125&&a.color>500;var l=3*(a.brightness/125)+a.color/500;if(n&&!r||n&&r&&l>s||!n&&!r&&l>s){r=n;s=l;i=d(t[o])}}return i};var I=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var E=d.hexNames=F(I);function F(e){var t={};for(var i in e){if(e.hasOwnProperty(i)){t[e[i]]=i}}return t}function U(e){e=parseFloat(e);if(isNaN(e)||e<0||e>1){e=1}return e}function N(e,t){if(H(e)){e="100%"}var i=O(e);e=h(t,c(0,parseFloat(e)));if(i){e=parseInt(e*t,10)/100}if(u.abs(e-t)<1e-6){return 1}return e%t/parseFloat(t)}function A(e){return h(1,c(0,e))}function D(e){return parseInt(e,16)}function H(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function O(e){return typeof e==="string"&&e.indexOf("%")!=-1}function B(e){return e.length==1?"0"+e:""+e}function P(e){if(e<=1){e=e*100+"%"}return e}function V(e){return Math.round(parseFloat(e)*255).toString(16)}function W(e){return D(e)/255}var z=function(){var e="[-\\+]?\\d+%?";var t="[-\\+]?\\d*\\.\\d+%?";var i="(?:"+t+")|(?:"+e+")";var s="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";var r="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";return{rgb:new RegExp("rgb"+s),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+s),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+s),hsva:new RegExp("hsva"+r),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function j(e){e=e.replace(s,"").replace(r,"").toLowerCase();var t=false;if(I[e]){e=I[e];t=true}else if(e=="transparent"){return{r:0,g:0,b:0,a:0,format:"name"}}var i;if(i=z.rgb.exec(e)){return{r:i[1],g:i[2],b:i[3]}}if(i=z.rgba.exec(e)){return{r:i[1],g:i[2],b:i[3],a:i[4]}}if(i=z.hsl.exec(e)){return{h:i[1],s:i[2],l:i[3]}}if(i=z.hsla.exec(e)){return{h:i[1],s:i[2],l:i[3],a:i[4]}}if(i=z.hsv.exec(e)){return{h:i[1],s:i[2],v:i[3]}}if(i=z.hsva.exec(e)){return{h:i[1],s:i[2],v:i[3],a:i[4]}}if(i=z.hex8.exec(e)){return{a:W(i[1]),r:D(i[2]),g:D(i[3]),b:D(i[4]),format:t?"name":"hex8"}}if(i=z.hex6.exec(e)){return{r:D(i[1]),g:D(i[2]),b:D(i[3]),format:t?"name":"hex"}}if(i=z.hex3.exec(e)){return{r:D(i[1]+""+i[1]),g:D(i[2]+""+i[2]),b:D(i[3]+""+i[3]),format:t?"name":"hex"}}return false}window.tinycolor=d})();(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports=="object"&&typeof module=="object"){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(Ee,Fe){"use strict";var s={beforeShow:e,move:e,change:e,show:e,hide:e,color:false,flat:false,showInput:false,allowEmpty:false,showButtons:true,clickoutFiresChange:true,showInitial:false,showPalette:false,showPaletteOnly:false,hideAfterPaletteSelect:false,togglePaletteOnly:false,showSelectionPalette:true,localStorageKey:false,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:false,className:"",containerClassName:"",replacerClassName:"",showAlpha:false,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:false,offset:null},He=[],Oe=!!/msie/i.exec(window.navigator.userAgent),Ve=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div");var i=t.style;i.cssText="background-color:rgba(0,0,0,.5)";return e(i.backgroundColor,"rgba")||e(i.backgroundColor,"hsla")}(),We=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),je=function(){var e="";if(Oe){for(var t=1;t<=6;t++){e+="<div class='sp-"+t+"'></div>"}}return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function qe(e,t,i,s){var r=[];for(var o=0;o<e.length;o++){var a=e[o];if(a){var n=tinycolor(a);var l=n.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";l+=tinycolor.equals(t,a)?" sp-thumb-active":"";var h=n.toString(s.preferredFormat||"rgb");var c=Ve?"background-color:"+n.toRgbString():"filter:"+n.toFilter();r.push('<span title="'+h+'" data-color="'+n.toRgbString()+'" class="'+l+'"><span class="sp-thumb-inner" style="'+c+';" /></span>')}else{var d="sp-clear-display";r.push(Ee("<div />").append(Ee('<span data-color="" style="background-color:transparent;" class="'+d+'"></span>').attr("title",s.noColorSelectedText)).html())}}return"<div class='sp-cf "+i+"'>"+r.join("")+"</div>"}function Le(){for(var e=0;e<He.length;e++){if(He[e]){He[e].hide()}}}function Ke(e,t){var i=Ee.extend({},s,e);i.callbacks={move:r(i.move,t),change:r(i.change,t),show:r(i.show,t),hide:r(i.hide,t),beforeShow:r(i.beforeShow,t)};return i}function o(e,G){var h=Ke(G,e),s=h.flat,E=h.showSelectionPalette,i=h.localStorageKey,F=h.theme,a=h.callbacks,H=Je(T,10),t=false,O=false,l=0,c=0,n=0,d=0,V=0,W=0,j=0,q=0,u=0,f=0,p=0,g=1,L=[],r=[],K={},o=h.selectionPalette.slice(0),X=h.maxSelectionSize,$="sp-dragging",y=null;var _=e.ownerDocument,Y=_.body,v=Ee(e),J=false,m=Ee(je,_).addClass(F),Q=m.find(".sp-picker-container"),Z=m.find(".sp-color"),ee=m.find(".sp-dragger"),te=m.find(".sp-hue"),ie=m.find(".sp-slider"),b=m.find(".sp-alpha-inner"),se=m.find(".sp-alpha"),re=m.find(".sp-alpha-handle"),w=m.find(".sp-input"),oe=m.find(".sp-palette"),ae=m.find(".sp-initial"),ne=m.find(".sp-cancel"),le=m.find(".sp-clear"),he=m.find(".sp-choose"),ce=m.find(".sp-palette-toggle"),de=v.is("input"),ue=de&&v.attr("type")==="color"&&Qe(),fe=false,x=fe?Ee(We).addClass(F).addClass(h.className).addClass(h.replacerClassName):Ee([]),C=fe?x:v,k=x.find(".sp-preview-inner"),S=h.color||de&&v.val(),R=false,M=h.preferredFormat,pe=!h.showButtons||h.clickoutFiresChange,I=!S,U=h.allowEmpty&&!ue;function ge(){if(h.showPaletteOnly){h.showPalette=true}ce.text(h.showPaletteOnly?h.togglePaletteMoreText:h.togglePaletteLessText);if(h.palette){L=h.palette.slice(0);r=Ee.isArray(L[0])?L:[L];K={};for(var e=0;e<r.length;e++){for(var t=0;t<r[e].length;t++){var i=tinycolor(r[e][t]).toRgbString();K[i]=true}}}m.toggleClass("sp-flat",s);m.toggleClass("sp-input-disabled",!h.showInput);m.toggleClass("sp-alpha-enabled",h.showAlpha);m.toggleClass("sp-clear-enabled",U);m.toggleClass("sp-buttons-disabled",!h.showButtons);m.toggleClass("sp-palette-buttons-disabled",!h.togglePaletteOnly);m.toggleClass("sp-palette-disabled",!h.showPalette);m.toggleClass("sp-palette-only",h.showPaletteOnly);m.toggleClass("sp-initial-disabled",!h.showInitial);m.addClass(h.className).addClass(h.containerClassName);T()}function ye(){if(Oe){m.find("*:not(input)").attr("unselectable","on")}ge();if(fe){v.after(x).hide()}if(!U){le.hide()}if(s){v.after(m).hide()}else{var e=h.appendTo==="parent"?v.parent():Ee(h.appendTo);if(e.length!==1){e=Ee("body")}e.append(m)}_e();C.bind("click.spectrum touchstart.spectrum",function(e){if(!J){Se()}e.stopPropagation();if(!Ee(e.target).is("input")){e.preventDefault()}});if(v.is(":disabled")||h.disabled===true){ze()}m.click($e);w.change(ke);w.bind("paste",function(){setTimeout(ke,1)});w.keydown(function(e){if(e.keyCode==13){ke()}});ne.text(h.cancelText);ne.bind("click.spectrum",function(e){e.stopPropagation();e.preventDefault();Ue();N()});le.attr("title",h.clearText);le.bind("click.spectrum",function(e){e.stopPropagation();e.preventDefault();I=true;B();if(s){z(true)}});he.text(h.chooseText);he.bind("click.spectrum",function(e){e.stopPropagation();e.preventDefault();if(Oe&&w.is(":focus")){w.trigger("change")}if(Ne()){z(true);N()}});ce.text(h.showPaletteOnly?h.togglePaletteMoreText:h.togglePaletteLessText);ce.bind("click.spectrum",function(e){e.stopPropagation();e.preventDefault();h.showPaletteOnly=!h.showPaletteOnly;if(!h.showPaletteOnly&&!s){m.css("left","-="+(Q.outerWidth(true)+5))}ge()});Ye(se,function(e,t,i){g=e/W;I=false;if(i.shiftKey){g=Math.round(g*10)/10}B()},xe,Ce);Ye(te,function(e,t){u=parseFloat(t/d);I=false;if(!h.showAlpha){g=1}B()},xe,Ce);Ye(Z,function(e,t,i){if(!i.shiftKey){y=null}else if(!y){var s=f*l;var r=c-p*c;var o=Math.abs(e-s)>Math.abs(t-r);y=o?"x":"y"}var a=!y||y==="x";var n=!y||y==="y";if(a){f=parseFloat(e/l)}if(n){p=parseFloat((c-t)/c)}I=false;if(!h.showAlpha){g=1}B()},xe,Ce);if(!!S){A(S);P();M=h.preferredFormat||tinycolor(S).format;ve(S)}else{P()}if(s){Re()}function t(e){if(e.data&&e.data.ignore){A(Ee(e.target).closest(".sp-thumb-el").data("color"));B()}else{A(Ee(e.target).closest(".sp-thumb-el").data("color"));B();z(true);if(h.hideAfterPaletteSelect){N()}}return false}var i=Oe?"mousedown.spectrum":"click.spectrum touchstart.spectrum";oe.delegate(".sp-thumb-el",i,t);ae.delegate(".sp-thumb-el:nth-child(1)",i,{ignore:true},t)}function _e(){if(i&&window.localStorage){try{var e=window.localStorage[i].split(",#");if(e.length>1){delete window.localStorage[i];Ee.each(e,function(e,t){ve(t)})}}catch(e){}try{o=window.localStorage[i].split(";")}catch(e){}}}function ve(e){if(E){var t=tinycolor(e).toRgbString();if(!K[t]&&Ee.inArray(t,o)===-1){o.push(t);while(o.length>X){o.shift()}}if(i&&window.localStorage){try{window.localStorage[i]=o.join(";")}catch(e){}}}}function me(){var e=[];if(h.showPalette){for(var t=0;t<o.length;t++){var i=tinycolor(o[t]).toRgbString();if(!K[i]){e.push(o[t])}}}return e.reverse().slice(0,h.maxSelectionSize)}function be(){var i=D();var e=Ee.map(r,function(e,t){return qe(e,i,"sp-palette-row sp-palette-row-"+t,h)});_e();if(o){e.push(qe(me(),i,"sp-palette-row sp-palette-row-selection",h))}oe.html(e.join(""))}function we(){if(h.showInitial){var e=R;var t=D();ae.html(qe([e,t],t,"sp-palette-row-initial",h))}}function xe(){if(c<=0||l<=0||d<=0){T()}O=true;m.addClass($);y=null;v.trigger("dragstart.spectrum",[D()])}function Ce(){O=false;m.removeClass($);v.trigger("dragstop.spectrum",[D()])}function ke(){var e=w.val();if((e===null||e==="")&&U){A(null);z(true)}else{var t=tinycolor(e);if(t.isValid()){A(t);z(true)}else{w.addClass("sp-validation-error")}}}function Se(){if(t){N()}else{Re()}}function Re(){var e=Ee.Event("beforeShow.spectrum");if(t){T();return}v.trigger(e,[D()]);if(a.beforeShow(D())===false||e.isDefaultPrevented()){return}Le();t=true;Ee(_).bind("keydown.spectrum",Me);Ee(_).bind("click.spectrum",Ie);Ee(window).bind("resize.spectrum",H);x.addClass("sp-active");m.removeClass("sp-hidden");T();P();R=D();we();a.show(R);v.trigger("show.spectrum",[R])}function Me(e){if(e.keyCode===27){N()}}function Ie(e){if(e.button==2){return}if(O){return}if(pe){z(true)}else{Ue()}N()}function N(){if(!t||s){return}t=false;Ee(_).unbind("keydown.spectrum",Me);Ee(_).unbind("click.spectrum",Ie);Ee(window).unbind("resize.spectrum",H);x.removeClass("sp-active");m.addClass("sp-hidden");a.hide(D());v.trigger("hide.spectrum",[D()])}function Ue(){A(R,true)}function A(e,t){if(tinycolor.equals(e,D())){P();return}var i,s;if(!e&&U){I=true}else{I=false;i=tinycolor(e);s=i.toHsv();u=s.h%360/360;f=s.s;p=s.v;g=s.a}P();if(i&&i.isValid()&&!t){M=h.preferredFormat||i.getFormat()}}function D(e){e=e||{};if(U&&I){return null}return tinycolor.fromRatio({h:u,s:f,v:p,a:Math.round(g*100)/100},{format:e.format||M})}function Ne(){return!w.hasClass("sp-validation-error")}function B(){P();a.move(D());v.trigger("move.spectrum",[D()])}function P(){w.removeClass("sp-validation-error");Ae();var e=tinycolor.fromRatio({h:u,s:1,v:1});Z.css("background-color",e.toHexString());var t=M;if(g<1&&!(g===0&&t==="name")){if(t==="hex"||t==="hex3"||t==="hex6"||t==="name"){t="rgb"}}var i=D({format:t}),s="";k.removeClass("sp-clear-display");k.css("background-color","transparent");if(!i&&U){k.addClass("sp-clear-display")}else{var r=i.toHexString(),o=i.toRgbString();if(Ve||i.alpha===1){k.css("background-color",o)}else{k.css("background-color","transparent");k.css("filter",i.toFilter())}if(h.showAlpha){var a=i.toRgb();a.a=0;var n=tinycolor(a).toRgbString();var l="linear-gradient(left, "+n+", "+r+")";if(Oe){b.css("filter",tinycolor(n).toFilter({gradientType:1},r))}else{b.css("background","-webkit-"+l);b.css("background","-moz-"+l);b.css("background","-ms-"+l);b.css("background","linear-gradient(to right, "+n+", "+r+")")}}s=i.toString()}if(h.showInput){w.val(s)}if(h.showPalette){be()}we()}function Ae(){var e=f;var t=p;if(U&&I){re.hide();ie.hide();ee.hide()}else{re.show();ie.show();ee.show();var i=e*l;var s=c-t*c;i=Math.max(-n,Math.min(l-n,i-n));s=Math.max(-n,Math.min(c-n,s-n));ee.css({top:s+"px",left:i+"px"});var r=g*W;re.css({left:r-j/2+"px"});var o=u*d;ie.css({top:o-q+"px"})}}function z(e){var t=D(),i="",s=!tinycolor.equals(t,R);if(t){i=t.toString(M);ve(t)}if(de){var r=tinycolor.mix("#154474",t);var o=r.getBrightness()>128?"#000000":"#ffffff";v.css("background-color",i).css("color",o).val(i)}if(e&&s){a.change(t);v.trigger("change",[t])}}function T(){if(!t){return}l=Z.width();c=Z.height();n=ee.height();V=te.width();d=te.height();q=ie.height();W=se.width();j=re.width();if(!s){m.css("position","absolute");if(h.offset){m.offset(h.offset)}else{m.offset(Xe(m,C))}}Ae();if(h.showPalette){be()}v.trigger("reflow.spectrum")}function De(){v.show();C.unbind("click.spectrum touchstart.spectrum");m.remove();x.remove();He[Ge.id]=null}function Be(e,t){if(e===Fe){return Ee.extend({},h)}if(t===Fe){return h[e]}h[e]=t;if(e==="preferredFormat"){M=h.preferredFormat}ge()}function Pe(){J=false;v.attr("disabled",false);C.removeClass("sp-disabled")}function ze(){N();J=true;v.attr("disabled",true);C.addClass("sp-disabled")}function Te(e){h.offset=e;T()}ye();var Ge={show:Re,hide:N,toggle:Se,reflow:T,option:Be,enable:Pe,disable:ze,offset:Te,set:function(e){A(e);z()},get:D,destroy:De,container:m};Ge.id=He.push(Ge)-1;return Ge}function Xe(e,t){var i=0;var s=e.outerWidth();var r=e.outerHeight();var o=t.outerHeight();var a=e[0].ownerDocument;var n=a.documentElement;var l=n.clientWidth+Ee(a).scrollLeft();var h=n.clientHeight+Ee(a).scrollTop();var c=t.offset();c.top+=o;c.left-=Math.min(c.left,c.left+s>l&&l>s?Math.abs(c.left+s-l):0);c.top-=Math.min(c.top,c.top+r>h&&h>r?Math.abs(r+o-i):i);return c}function e(){}function $e(e){e.stopPropagation()}function r(e,t){var i=Array.prototype.slice;var s=i.call(arguments,2);return function(){return e.apply(t,s.concat(i.call(arguments)))}}function Ye(a,n,i,e){n=n||function(){};i=i||function(){};e=e||function(){};var l=document;var h=false;var c={};var d=0;var u=0;var f="ontouchstart"in window;var s={};s["selectstart"]=p;s["dragstart"]=p;s["touchmove mousemove"]=r;s["touchend mouseup"]=g;function p(e){if(e.stopPropagation){e.stopPropagation()}if(e.preventDefault){e.preventDefault()}e.returnValue=false}function r(e){if(h){if(Oe&&l.documentMode<9&&!e.button){return g()}var t=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0];var i=t&&t.pageX||e.pageX;var s=t&&t.pageY||e.pageY;var r=Math.max(0,Math.min(i-c.left,u));var o=Math.max(0,Math.min(s-c.top,d));if(f){p(e)}n.apply(a,[r,o,e])}}function t(e){var t=e.which?e.which==3:e.button==2;if(!t&&!h){if(i.apply(a,arguments)!==false){h=true;d=Ee(a).height();u=Ee(a).width();c=Ee(a).offset();Ee(l).bind(s);Ee(l.body).addClass("sp-dragging");r(e);p(e)}}}function g(){if(h){Ee(l).unbind(s);Ee(l.body).removeClass("sp-dragging");setTimeout(function(){e.apply(a,arguments)},0)}h=false}Ee(a).bind("touchstart mousedown",t)}function Je(s,r,o){var a;return function(){var e=this,t=arguments;var i=function(){a=null;s.apply(e,t)};if(o)clearTimeout(a);if(o||!a)a=setTimeout(i,r)}}function Qe(){return Ee.fn.spectrum.inputTypeColorSupport()}var a="spectrum.id";Ee.fn.spectrum=function(i,e){if(typeof i=="string"){var s=this;var r=Array.prototype.slice.call(arguments,1);this.each(function(){var e=He[Ee(this).data(a)];if(e){var t=e[i];if(!t){throw new Error("Spectrum: no such method: '"+i+"'")}if(i=="get"){s=e.get()}else if(i=="container"){s=e.container}else if(i=="option"){s=e.option.apply(e,r)}else if(i=="destroy"){e.destroy();Ee(this).removeData(a)}else{t.apply(e,r)}}});return s}return this.spectrum("destroy").each(function(){var e=Ee.extend({},i,Ee(this).data());var t=o(this,e);Ee(this).data(a,t.id)})};Ee.fn.spectrum.load=true;Ee.fn.spectrum.loadOpts={};Ee.fn.spectrum.draggable=Ye;Ee.fn.spectrum.defaults=s;Ee.fn.spectrum.inputTypeColorSupport=function e(){if(typeof e._cachedResult==="undefined"){var t=Ee("<input type='color'/>")[0];e._cachedResult=t.type==="color"&&t.value!==""}return e._cachedResult};Ee.spectrum={};Ee.spectrum.localization={};Ee.spectrum.palettes={};Ee.fn.spectrum.processNativeColorInputs=function(){var e=Ee("input[type=color]");if(e.length&&!Qe()){e.spectrum({preferredFormat:"hex6"})}};Ee(function(){if(Ee.fn.spectrum.load){Ee.fn.spectrum.processNativeColorInputs()}})});(function(_){"use strict";_.scada={};_.scada.version="1.0.0";_.scada.handler="ScadaHandler.ashx";_.scada.imageData="ImageData.ashx";_.scada.noImageData="../Images/noimage.jpg";_.scada.imagePicker="ImagePicker.aspx";_.scada.showControlDialog=function(e,t,i){if(i){if(confirm("确定下发控制命令吗？"))_.post(_.scada.handler,{_Type:17,_T:Date.now(),DeviceId:e,SignalId:t,Value:i},function(e){alert(e)})}else showDialog("ControlDialog.aspx?DeviceId="+encodeURIComponent(e)+"&SignalId="+encodeURIComponent(t),"控制",400,200)};var s=false;_(document).keydown(function(e){if(e.ctrlKey)s=true});_(document).keyup(function(e){if(!e.ctrlKey)s=false});var l={none:0,move:1,eResize:2,neResize:3,nwResize:4,nResize:5,seResize:6,swResize:7,sResize:8,wResize:9,boxSelect:10};var e=["default","move","e-resize","ne-resize","nw-resize","n-resize","se-resize","sw-resize","s-resize","w-resize","default"];var v={bool:1,int:2,float:3,floatToInt:4,string:5,color:6,fontFamily:7,imageSource:8,target:9,textAlign:10,monitorNo:11,cameraNo:12,channelId:13,deviceId:14,signalId:15};var m=["Arial","Geogia","Times New Roman","Vedana","仿宋","黑体","华文彩云","华文仿宋","华文楷体","华文宋体","华文细黑","华文新魏","华文中宋","楷体","隶书","宋体","微软雅黑","幼圆"];var b={_self:"当前页面",_blank:"新页面",_dialog:"弹框"};var w={left:"左对齐",center:"居中对齐",right:"右对齐"};var r={};function t(e,t){r[e]=t}function i(e,t){var i=t["type"];if(!i)return null;var s=r[i];if(!s)return null;return new s(e,t)}function o(e){return String(e)+"px"}function a(e){e=e.replace(/&/g,"&amp;");e=e.replace(/</g,"&lt;");e=e.replace(/>/g,"&gt;");e=e.replace(/ /g,"&nbsp;");e=e.replace(/\'/g,"&#39;");e=e.replace(/\"/g,"&quot;");return e}function n(e){e=e.replace(/&amp;/g,"&");e=e.replace(/&lt;/g,"<");e=e.replace(/&gt;/g,">");e=e.replace(/&nbsp;/g," ");e=e.replace(/&#39;/g,"'");e=e.replace(/&quot;/g,'"');return e}function h(e,t){var i=Object.create(t.prototype);i.constructor=e;e.prototype=i}function c(e){if(e)return _.scada.imageData+"?No="+e;return _.scada.noImageData}function d(e,t){this.x=e;this.y=t}d.prototype.clone=function(){return new d(this.x,this.y)};d.prototype.rotate=function(e,t){if(t==0)return this;var i=this.x-e.x;var s=this.y-e.y;var r=Math.sin(t);var o=Math.cos(t);var a=i*o-s*r;var n=i*r+s*o;this.x=e.x+a;this.y=e.y+n;return this};d.prototype.add=function(e){this.x+=e.x;this.y+=e.y;return this};d.prototype.subtract=function(e){this.x-=e.x;this.y-=e.y;return this};d.prototype.multiply=function(e){this.x*=e.x;this.y*=e.y;return this};d.prototype.divide=function(e){this.x/=e.x;this.y/=e.y;return this};d.prototype.divideNumber=function(e){this.x/=e;this.y/=e;return this};d.prototype.isIn=function(e){return this.x>e.x&&this.x<e.x+e.width&&this.y>e.y&&this.y<e.y+e.height};d.prototype.isEmpty=function(){return this.x==0&&this.y==0};d.prototype.equals=function(e){return this.x==e.x&&this.y==e.y};function u(e,t,i,s){this.x=e;this.y=t;this.width=i;this.height=s}u.prototype.clone=function(){return new u(this.x,this.y,this.width,this.height)};u.prototype.union=function(e){var t=Math.min(this.x,e.x);var i=Math.min(this.y,e.y);this.width=Math.max(this.x+this.width,e.x+e.width)-t;this.height=Math.max(this.y+this.height,e.y+e.height)-i;this.x=t;this.y=i;return this};u.prototype.translate=function(e){this.x+=e.x;this.y+=e.y;return this};u.prototype.scale=function(e,t){var i=this.center().subtract(e).multiply(t).add(e);this.width*=t.x;this.height*=t.y;this.x=i.x-this.width/2;this.y=i.y-this.height/2;return this};u.prototype.center=function(){return new d(this.x+this.width/2,this.y+this.height/2)};u.prototype.isIn=function(e){var t,i,s,r;if(e.width>0){t=e.x;s=e.width}else{t=e.x+e.width;s=-e.width}if(e.height>0){i=e.y;r=e.height}else{i=e.y+e.height;r=-e.height}return this.x>t&&this.x<t+s&&this.y>i&&this.y<i+r&&this.x+this.width>t&&this.x+this.width<t+s&&this.y+this.height>i&&this.y+this.height<i+r};function f(e,t,i){this.element=_("<div>").css("position","absolute").css("left","0px").css("top","0px").css("width","0px").css("height","0px").css("border",t);if(i)this.element.css("background-color",i);this.element.hide().appendTo(e)}f.prototype.show=function(e,t,i,s){this.element.css("left",o(e)).css("top",o(t)).css("width",o(i)).css("height",o(s)).show()};f.prototype.hide=function(){this.element.hide()};function p(e,t){this.undoActions=[];this.redoActions=[];this.maxLength=e;this.currentAction=t}p.prototype.doAction=function(e){if(this.currentAction){this.undoActions.push(this.currentAction);if(this.undoActions.length>this.maxLength)this.undoActions.shift();this.redoActions=[]}this.currentAction=e};p.prototype.canUndo=function(){return this.undoActions.length>0};p.prototype.popUndo=function(){if(this.undoActions.length==0)return null;this.redoActions.push(this.currentAction);if(this.redoActions.length>this.maxLength)this.redoActions.shift();this.currentAction=this.undoActions.pop();return this.currentAction};p.prototype.canRedo=function(){return this.redoActions.length>0};p.prototype.popRedo=function(){if(this.redoActions.length==0)return null;this.undoActions.push(this.currentAction);if(this.undoActions.length>this.maxlength)this.undoActions.shift();this.currentAction=this.redoActions.pop();return this.currentAction};function g(e,t,i,s){this.element=t;e.append(this.element);this.properties=i;_.extend(this,s);for(var r=0;r<this.properties.length;r++){var o=this.properties[r].key;this._apply(o,this[o])}}g.prototype._apply=function(e,t){return false};g.prototype.set=function(e,t){if(this[e]==t)return false;if(!this._apply(e,t))return false;this[e]=t;return true};function y(e,t,i,s,r){var o={left:0,top:0,width:0,height:0,angle:0,remark:"",backgroundColor:"transparent",alarmBackgroundColor:"red",url:"",target:"_self",dialogTitle:"",dialogWidth:600,dialogHeight:400,monitorNo:null,cameraNo:null,channelId:null,deviceId:null,signalId:null,readable:true,alarm:false,writeable:false,controlValue:""};_.extend(o,s,r);g.call(this,e,t,[{category:"布局",key:"left",name:"左",type:v.floatToInt},{category:"布局",key:"top",name:"上",type:v.floatToInt},{category:"布局",key:"width",name:"宽",type:v.floatToInt},{category:"布局",key:"height",name:"高",type:v.floatToInt},{category:"布局",key:"angle",name:"角度",type:v.int},{category:"布局",key:"remark",name:"备注",type:v.string},{category:"背景",key:"backgroundColor",name:"颜色",type:v.color},{category:"背景",key:"alarmBackgroundColor",name:"报警颜色",type:v.color},{category:"链接",key:"monitorNo",name:"页面",type:v.monitorNo},{category:"链接",key:"url",name:"网址",type:v.string},{category:"链接",key:"target",name:"目标",type:v.target},{category:"链接",key:"dialogTitle",name:"弹框标题",type:v.string},{category:"链接",key:"dialogWidth",name:"弹框宽",type:v.int},{category:"链接",key:"dialogHeight",name:"弹框高",type:v.int},{category:"监控",key:"cameraNo",name:"摄像头",type:v.cameraNo},{category:"监控",key:"channelId",name:"通道",type:v.channelId},{category:"监控",key:"deviceId",name:"设备",type:v.deviceId},{category:"监控",key:"signalId",name:"信号",type:v.signalId},{category:"监控",key:"readable",name:"可监",type:v.bool},{category:"监控",key:"alarm",name:"报警",type:v.bool},{category:"监控",key:"writeable",name:"可控",type:v.bool},{category:"监控",key:"controlValue",name:"控制值",type:v.string}].concat(i),o);this.element.bind("click",this._onClick.bind(this))}h(y,g);y.prototype._apply=function(e,t){switch(e){case"left":this.element.css("left",o(t));return true;case"top":this.element.css("top",o(t));return true;case"width":this.element.css("width",o(t));return true;case"height":this.element.css("height",o(t));return true;case"angle":var i="rotate("+t+"deg)";this.element.css("transform",i);return true;case"remark":return true;case"backgroundColor":this.element.css("background-color",t);return true;case"monitorNo":case"url":case"cameraNo":case"channelId":case"writeable":case"deviceId":case"signalId":if(this.monitorNo||this.cameraNo||this.url||this.writeable&&this.deviceId&&this.signalId)this.element.css("cursor","pointer");else this.element.css("cursor","auto");return true;case"alarmBackgroundColor":case"target":case"dialogTitle":case"dialogWidth":case"dialogHeight":case"readable":case"alarm":case"controlValue":return true;default:return g.prototype._apply.call(this,e,t)}};y.prototype._onClick=function(){if(this.monitorNo){if(this.target=="_blank")window.open("Viewer.html?No="+this.monitorNo);else if(this.target=="_dialog")showDialog("Viewer.html?No="+this.monitorNo,this.dialogTitle,this.dialogWidth,this.dialogHeight);else window.linkMonitor&&window.linkMonitor(this.monitorNo)}if(this.cameraNo)window.openCamera&&window.openCamera(this.cameraNo);if(this.url){if(this.target=="_blank")window.open(this.url);else if(this.target=="_dialog")showDialog(this.url,this.dialogTitle,this.dialogWidth,this.dialogHeight);else window.location.href=this.url}if(this.writeable&&this.deviceId&&this.signalId)_.scada.showControlDialog(this.deviceId,this.signalId,this.controlValue)};y.prototype.updateData=function(){};y.prototype.initTitle=function(e){var t="子系统：";t+=e.SubSystemName;t+="\n设备：";t+=e.DeviceName;t+="\n信号：";t+=e.SignalName;if(e.SignalArgument){t+="\n地点：";t+=e.SignalArgument}this.element.attr("title",t)};y.prototype.center=function(){return new d(this.left+this.width/2,this.top+this.height/2)};y.prototype.rect=function(){return new u(this.left,this.top,this.width,this.height)};y.prototype.translate=function(e){var t=this.left+e.x;var i=this.top+e.y;this.set("left",t);this.set("top",i);return this};y.prototype.scale=function(e,t){var i=this.center().subtract(e).multiply(t).add(e);this.width=this.width*t.x;this.height=this.height*t.y;this.left=i.x-this.width/2;this.top=i.y-this.height/2;this._apply("left",this.left);this._apply("top",this.top);this._apply("width",this.width);this._apply("height",this.height);return this};function x(e,t,i,s){if(_.type(e)=="string")e=_("#"+e);g.call(this,e,t,i,s);this._eventListeners={};this._userControls=[];this._propertyGrid=null;this._selectedUserControls=[];this._undoRedo=new p(10,s);if(s.userControls){for(var r=0;r<s.userControls.length;r++)this._addUserControl(s.userControls[r])}}h(x,g);x.prototype._fire=function(e){if(e.type&&this._eventListeners[e.type]){var t=this;_.each(this._eventListeners[e.type],function(){this.call(t,e)})}};x.prototype._fireChangeEvent=function(){this._fire(new _.Event({type:"change"}))};x.prototype._addUserControl=function(e){var t=i(this.element,e);if(t){this._userControls.push(t);this.element.append(t.element)}return t};x.prototype._removeUserControl=function(e){e.element.remove();var t=this._userControls.indexOf(e);this._userControls.splice(t,1)};x.prototype.setPropertyGrid=function(e){this._propertyGrid=e};x.prototype.on=function(e,t){var i=this._eventListeners[e];if(!i){i=[];this._eventListeners[e]=i}i.push(t);return this};x.prototype.off=function(e){delete this._eventListeners[e];return this};x.prototype.clear=function(){for(var e=0;e<this._userControls.length;e++){var t=this._userControls[e];t.element.remove()}this._userControls=[];this._selectedUserControls=[]};x.prototype.getSelectedUserControls=function(){return this._selectedUserControls};x.prototype.serialize=function(e){this.clear();for(var t in e)this.set(t,e[t]);var i=e.userControls;if(i){for(var s=0;s<i.length;s++)this._addUserControl(i[s])}};x.prototype.deserialize=function(){var e={type:this.type};for(var t=0;t<this.properties.length;t++){var i=this.properties[t].key;e[i]=this[i]}e.userControls=[];for(var t=0;t<this._userControls.length;t++){var s=this._userControls[t];var r={type:s.type};for(var o=0;o<s.properties.length;o++){var a=s.properties[o];var i=a.key;if(a.type==v.floatToInt)r[i]=Math.round(s[i]);else r[i]=s[i]}e.userControls.push(r)}return e};x.prototype.canUndo=function(){return this._undoRedo.canUndo()};x.prototype.undo=function(){var e=this._undoRedo.popUndo();if(e){this.serialize(e);if(this._propertyGrid)this._propertyGrid.showControl();this._fireChangeEvent();return true}return false};x.prototype.canRedo=function(){return this._undoRedo.canRedo()};x.prototype.redo=function(){var e=this._undoRedo.popRedo();if(e){this.serialize(e);if(this._propertyGrid)this._propertyGrid.showControl();this._fireChangeEvent();return true}return false};x.prototype.saveControl=function(e,t){var i=false;for(var s in t){if(e.set(s,t[s]))i=true}if(i){this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return i};x.prototype.setCode=function(e){this._selectedUserControls=[];this._propertyGrid.setForm(null);this.serialize(e);this._undoRedo.doAction(e);this._propertyGrid.setForm(this)};function C(e,t){var i={type:"webBrowser",src:""};_.extend(i,t);x.call(this,e,_('<iframe style="position:absolute;left:0px;top:0px;width:100%;height:100%;border:0px;"></iframe>'),[{category:"页面",key:"src",name:"网址",type:v.string}],i);for(var s=0;s<this.properties.length;s++){var r=this.properties[s].key;this._apply(r,this[r])}}h(C,x);C.prototype._apply=function(e,t){switch(e){case"src":this.element.attr("src",t);return true;default:return x.prototype._apply.call(this,e,t)}};function k(e,t){var i={type:"canvas",left:0,top:0,width:1e3,height:800,backgroundImage:null,backgroundColor:"transparent"};_.extend(i,t);this._scale=1;this._interval=0;this._isUpdating=false;x.call(this,e,_('<div class="scadabox" style="position:absolute;left:0px;top:0px;background-repeat:no-repeat;"></div>'),[{category:"布局",key:"width",name:"宽",type:v.int},{category:"布局",key:"height",name:"高",type:v.int},{category:"背景",key:"backgroundColor",name:"颜色",type:v.color},{category:"背景",key:"backgroundImage",name:"图片",type:v.imageSource}],i);this.element.bind("wheel",this._onWheel.bind(this))}h(k,x);k.prototype._apply=function(e,t){switch(e){case"left":this.element.css("left",o(t));return true;case"top":this.element.css("top",o(t));return true;case"width":this.element.css("width",o(t));return true;case"height":this.element.css("height",o(t));return true;case"backgroundImage":this.element.css("background-image",t?"url("+c(t)+")":"none");return true;case"backgroundColor":this.element.css("background-color",t);return true;default:return x.prototype._apply.call(this,e,t)}};k.prototype._getMousePosition=function(e,t){var i=e.offset();return new d(t.clientX-i.left,t.clientY-i.top)};k.prototype._update=function(){var i=this;_.ajax({type:"POST",cache:false,url:_.scada.handler,data:{_Type:15,Identities:JSON.stringify(this._updateIdentities)},success:function(e){if(e){for(var t=0;t<i._updateUserControls.length;t++)i._updateUserControls[t].updateData(e[t])}},complete:function(){if(i._isUpdating)setTimeout(i._update.bind(i),i._interval)}})};k.prototype._initTitle=function(){var e=[];var i=[];for(var t=0;t<this._userControls.length;t++){var s=this._userControls[t];if(s.deviceId&&s.signalId){e.push({deviceId:s.deviceId,signalId:s.signalId});i.push(s)}}_.ajax({type:"POST",url:_.scada.handler,data:{_Type:20,Identities:JSON.stringify(e)},success:function(e){if(e){for(var t=0;t<i.length;t++)i[t].initTitle(e[t])}}})};k.prototype._onWheel=function(e){this._fire(e)};k.prototype.getScale=function(){return this._scale};k.prototype.setScale=function(e){this._scale=e;var t="scale("+e+","+e+")";var i="0 0";this.element.css("transform",t).css("transform-origin",i);return this};k.prototype.start=function(e){this._initTitle();this._updateIdentities=[];this._updateUserControls=[];for(var t=0;t<this._userControls.length;t++){var i=this._userControls[t];if(i.readable&&i.deviceId&&i.signalId){this._updateIdentities.push({deviceId:i.deviceId,signalId:i.signalId});this._updateUserControls.push(i)}}if(this._updateIdentities.length>0){this._interval=Math.max(e||0,1e3);this._isUpdating=true;this._update()}};k.prototype.stop=function(){this._isUpdating=false};function S(e,t){if(_.type(e)=="string")e=_("#"+e);this._container=_('<div class="scadabox" style="position:absolute;width:0;height:0;overflow:hidden;"></div>');this._mask=_('<div style="position:absolute;width:0;height:0;"></div>');k.call(this,this._container,t);this._action=l.none;this._mousePosition=null;this._isUniformScale=false;this._isMouseDown=false;this.element.css("border","1px solid gray");this._container.append(this._mask);e.append(this._container);var i="1px solid #808080";this._selectedRect=null;this._selectedBox=new f(this._mask,i);this._selectedDotSize=6;this._selectedDotNW=new f(this._mask,i);this._selectedDotN=new f(this._mask,i);this._selectedDotNE=new f(this._mask,i);this._selectedDotE=new f(this._mask,i);this._selectedDotSE=new f(this._mask,i);this._selectedDotS=new f(this._mask,i);this._selectedDotSW=new f(this._mask,i);this._selectedDotW=new f(this._mask,i);this._selectionRect=null;this._selectionBox=new f(this._mask,"1px solid #808080","rgba(255,255,255,0.3)",null);this._selectedUserControls=[];this._mask.bind("keydown",this._onKeyDown.bind(this));this._mask.bind("mousedown",this._onMouseDown.bind(this));this._mask.bind("mousemove",this._onMouseMove.bind(this));this._mask.bind("mouseup",this._onMouseUp.bind(this));this._mask.bind("mouseout",this._onMouseOut.bind(this));this._mask.bind("mouseenter",this._onMouseEnter.bind(this));this._mask.bind("wheel",this._onWheel.bind(this));this._mask.bind("dragover",this._onDragOver.bind(this));this._mask.bind("dragenter",this._onDragEnter.bind(this));this._mask.bind("dragleave",this._onDragLeave.bind(this));this._mask.bind("drop",this._onDrop.bind(this))}h(S,k);S.prototype._apply=function(e,t){switch(e){case"left":this._container.css("left",o(t));return true;case"top":this._container.css("top",o(t));return true;case"width":this.element.css("width",o(t));this._container.css("width",o(t*this._scale));this._mask.css("width",o(t*this._scale));return true;case"height":this.element.css("height",o(t));this._container.css("height",o(t*this._scale));this._mask.css("height",o(t*this._scale));return true;default:return k.prototype._apply.call(this,e,t)}};S.prototype._updateSelectedBox=function(){if(this._selectedRect){var e=this._selectedRect.x*this._scale;var t=this._selectedRect.y*this._scale;var i=(this._selectedRect.x+this._selectedRect.width)*this._scale;var s=(this._selectedRect.y+this._selectedRect.height)*this._scale;var r=this._selectedDotSize;this._selectedBox.show(e-1,t-1,i-e+1,s-t+1);this._selectedDotNW.show(e-r,t-r,r*2,r*2);this._selectedDotN.show((e+i)/2-r,t-r,r*2,r*2);this._selectedDotNE.show(i-r,t-r,r*2,r*2);this._selectedDotE.show(i-r,(t+s)/2-r,r*2,r*2);this._selectedDotSE.show(i-r,s-r,r*2,r*2);this._selectedDotS.show((e+i)/2-r,s-r,r*2,r*2);this._selectedDotSW.show(e-r,s-r,r*2,r*2);this._selectedDotW.show(e-r,(t+s)/2-r,r*2,r*2)}else{this._selectedBox.hide();this._selectedDotNW.hide();this._selectedDotN.hide();this._selectedDotNE.hide();this._selectedDotE.hide();this._selectedDotSE.hide();this._selectedDotS.hide();this._selectedDotSW.hide();this._selectedDotW.hide()}};S.prototype._updateSelectionBox=function(){if(this._selectionRect){var e=this._selectionRect.x*this._scale;var t=this._selectionRect.y*this._scale;var i=(this._selectionRect.x+this._selectionRect.width)*this._scale;var s=(this._selectionRect.y+this._selectionRect.height)*this._scale;if(e>i){var r=e;e=i;i=r}if(t>s){var r=t;t=s;s=r}this._selectionBox.show(e-1,t-1,i-e,s-t)}else{this._selectionBox.hide()}};S.prototype._findWidget=function(e){for(var t=this._userControls.length-1;t>=0;t--){var i=this._userControls[t];if(e.isIn(i.rect()))return i}return null};S.prototype._calculateSelectedBox=function(){if(this._selectedUserControls.length==0){this._selectedRect=null;return this}this._selectedRect=this._selectedUserControls[0].rect();for(var e=1;e<this._selectedUserControls.length;e++)this._selectedRect.union(this._selectedUserControls[e].rect());return this};S.prototype._getAction=function(e){if(!this._selectedRect){this._mask.css("cursor","auto");return l.none}var t=this._selectedRect.x;var i=this._selectedRect.y;var s=this._selectedRect.x+this._selectedRect.width;var r=this._selectedRect.y+this._selectedRect.height;var o=this._selectedDotSize;if(Math.abs(e.x-t)<o&&Math.abs(e.y-i)<o){this._mask.css("cursor","nw-resize");return l.nwResize}if(Math.abs(e.x-(t+s)/2)<o&&Math.abs(e.y-i)<o){this._mask.css("cursor","n-resize");return l.nResize}if(Math.abs(e.x-s)<o&&Math.abs(e.y-i)<o){this._mask.css("cursor","ne-resize");return l.neResize}if(Math.abs(e.x-s)<o&&Math.abs(e.y-(i+r)/2)<o){this._mask.css("cursor","e-resize");return l.eResize}if(Math.abs(e.x-s)<o&&Math.abs(e.y-r)<o){this._mask.css("cursor","se-resize");return l.seResize}if(Math.abs(e.x-(t+s)/2)<o&&Math.abs(e.y-r)<o){this._mask.css("cursor","s-resize");return l.sResize}if(Math.abs(e.x-t)<o&&Math.abs(e.y-r)<o){this._mask.css("cursor","sw-resize");return l.swResize}if(Math.abs(e.x-t)<o&&Math.abs(e.y-(i+r)/2)<o){this._mask.css("cursor","w-resize");return l.wResize}if(e.x>t&&e.x<s&&e.y>i&&e.y<r){this._mask.css("cursor","move");return l.move}this._mask.css("cursor","auto");return l.none};S.prototype._convertScale=function(e){if(this._isUniformScale){if(isNaN(e.x))e.x=0;if(isNaN(e.y))e.y=0;if(e.x>=0&&e.x>=0)e.x=e.y=Math.max(e.x,e.y);else if(e.x<=0&&e.y<=0)e.x=e.y=Math.min(e.x,e.y);else if(e.x<=0&&e.y>=0){var t=Math.max(-e.x,e.y);e.x=-t;e.y=t}else if(e.x>=0&&e.y<=0){var t=Math.max(e.x,-e.y);e.x=t;e.y=-t}}else{if(isNaN(e.x))e.x=1;if(isNaN(e.y))e.y=1}};S.prototype._onKeyDown=function(e){this._fire(e)};S.prototype._onMouseDown=function(e){e.originalEvent.preventDefault();e.originalEvent.stopPropagation();this._mousePosition=this._getMousePosition(this._mask,e).divideNumber(this._scale);this._selectionRect=new u(this._mousePosition.x,this._mousePosition.y,0,0);this._isUniformScale=s;this._isMouseDown=true;this._isMouseChange=false;this._action=this._getAction(this._mousePosition);if(this._action==l.none||this._action==l.move){var t=this._findWidget(this._mousePosition);if(s||!t||this._selectedUserControls.indexOf(t)==-1){if(!s)this._selectedUserControls=[];if(t){var i=this._selectedUserControls.indexOf(t);if(i==-1)this._selectedUserControls.push(t);else this._selectedUserControls.splice(i,1)}this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.saveControl().showControl()}}this._fire(e)};S.prototype._onMouseMove=function(e){var t=this._getMousePosition(this._mask,e).divideNumber(this._scale);if(this._mousePosition&&this._mousePosition.equals(t))return;if(this._action==l.none){var i=this._getAction(t);if(this._isMouseDown)this._action=i;if(this._action==l.none){if(this._selectionRect){this._selectionRect.width=t.x-this._selectionRect.x;this._selectionRect.height=t.y-this._selectionRect.y;if(Math.abs(this._selectionRect.width)>=this._selectedDotSize||Math.abs(this._selectionRect.height)>=this._selectedDotSize){this._mask.css("cursor","auto");this._action=l.boxSelect}}}}else if(this._action==l.move){var s=t.clone().subtract(this._mousePosition);_.each(this._selectedUserControls,function(){this.translate(s)});this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._isMouseChange=true}else if(this._action==l.eResize){var r=new d(this._selectedRect.x,this._selectedRect.y+this._selectedRect.height/2);var o=new d(this._selectedRect.x+this._selectedRect.width,this._selectedRect.y+this._selectedRect.height/2);var a=new d(Math.max(t.x,r.x+1),this._selectedRect.y+this._selectedRect.height/2);var n=a.subtract(r).divide(o.subtract(r));this._convertScale(n);_.each(this._selectedUserControls,function(){this.scale(r,n)});this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._isMouseChange=true}else if(this._action==l.neResize){var r=new d(this._selectedRect.x,this._selectedRect.y+this._selectedRect.height);var o=new d(this._selectedRect.x+this._selectedRect.width,this._selectedRect.y);var a=new d(Math.max(t.x,r.x+1),Math.min(t.y,r.y-1));var n=a.subtract(r).divide(o.subtract(r));this._convertScale(n);_.each(this._selectedUserControls,function(){this.scale(r,n)});this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._isMouseChange=true}else if(this._action==l.nwResize){var r=new d(this._selectedRect.x+this._selectedRect.width,this._selectedRect.y+this._selectedRect.height);var o=new d(this._selectedRect.x,this._selectedRect.y);var a=new d(Math.min(t.x,r.x-1),Math.min(t.y,r.y-1));var n=a.subtract(r).divide(o.subtract(r));this._convertScale(n);_.each(this._selectedUserControls,function(){this.scale(r,n)});this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._isMouseChange=true}else if(this._action==l.nResize){var r=new d(this._selectedRect.x+this._selectedRect.width/2,this._selectedRect.y+this._selectedRect.height);var o=new d(this._selectedRect.x+this._selectedRect.width/2,this._selectedRect.y);var a=new d(this._selectedRect.x+this._selectedRect.width/2,Math.min(t.y,r.y-1));var n=a.subtract(r).divide(o.subtract(r));this._convertScale(n);_.each(this._selectedUserControls,function(){this.scale(r,n)});this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._isMouseChange=true}else if(this._action==l.seResize){var r=new d(this._selectedRect.x,this._selectedRect.y);var o=new d(this._selectedRect.x+this._selectedRect.width,this._selectedRect.y+this._selectedRect.height);var a=new d(Math.max(t.x,r.x+1),Math.max(t.y,r.y+1));var n=a.subtract(r).divide(o.subtract(r));this._convertScale(n);_.each(this._selectedUserControls,function(){this.scale(r,n)});this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._isMouseChange=true}else if(this._action==l.swResize){var r=new d(this._selectedRect.x+this._selectedRect.width,this._selectedRect.y);var o=new d(this._selectedRect.x,this._selectedRect.y+this._selectedRect.height);var a=new d(Math.min(t.x,r.x-1),Math.max(t.y,r.y+1));var n=a.subtract(r).divide(o.subtract(r));this._convertScale(n);_.each(this._selectedUserControls,function(){this.scale(r,n)});this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._isMouseChange=true}else if(this._action==l.sResize){var r=new d(this._selectedRect.x+this._selectedRect.width/2,this._selectedRect.y);var o=new d(this._selectedRect.x+this._selectedRect.width/2,this._selectedRect.y+this._selectedRect.height);var a=new d(this._selectedRect.x+this._selectedRect.width/2,Math.max(t.y,r.y+1));var n=a.subtract(r).divide(o.subtract(r));this._convertScale(n);_.each(this._selectedUserControls,function(){this.scale(r,n)});this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._isMouseChange=true}else if(this._action==l.wResize){var r=new d(this._selectedRect.x+this._selectedRect.width,this._selectedRect.y+this._selectedRect.height/2);var o=new d(this._selectedRect.x,this._selectedRect.y+this._selectedRect.height/2);var a=new d(Math.min(t.x,r.x-1),this._selectedRect.y+this._selectedRect.height/2);var n=a.subtract(r).divide(o.subtract(r));this._convertScale(n);_.each(this._selectedUserControls,function(){this.scale(r,n)});this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._isMouseChange=true}else if(this._action==l.boxSelect){this._selectionRect.width=t.x-this._selectionRect.x;this._selectionRect.height=t.y-this._selectionRect.y;this._updateSelectionBox()}this._mousePosition=t;this._fire(e)};S.prototype._onMouseUp=function(e){if(this._action==l.boxSelect){this._selectedUserControls=[];for(var t=0;t<this._userControls.length;t++){var i=this._userControls[t];if(i.rect().isIn(this._selectionRect))this._selectedUserControls.push(i)}this._calculateSelectedBox()._updateSelectedBox();this._propertyGrid.saveControl().showControl()}else if(this._action!=l.none){if(this._isMouseChange){_.each(this._selectedUserControls,function(){this.set("left",Math.round(this.left));this.set("top",Math.round(this.top));this.set("width",Math.round(this.width));this.set("height",Math.round(this.height))});this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}}this._mousePosition=null;this._selectionRect=null;this._updateSelectionBox();this._action=l.none;this._isMouseDown=false;this._isMouseChange=false;this._fire(e)};S.prototype._onMouseOut=function(e){this._fire(e)};S.prototype._onMouseEnter=function(e){this._fire(e)};S.prototype._onWheel=function(e){this._fire(e)};S.prototype._onDragOver=function(e){e.originalEvent.preventDefault();e.originalEvent.stopPropagation()};S.prototype._onDragEnter=function(e){};S.prototype._onDragLeave=function(e){};S.prototype._onDrop=function(e){e.originalEvent.preventDefault();e.originalEvent.stopPropagation();var t=e.originalEvent.dataTransfer.getData("Text");var i=_(this.element).offset();var s=this._addUserControl({type:t,left:(e.originalEvent.clientX-i.left)/this._scale,top:(e.originalEvent.clientY-i.top)/this._scale});if(s){this._selectedUserControls=[s];this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.showControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}};S.prototype.clear=function(){k.prototype.clear.call(this);this._calculateSelectedBox()._updateSelectedBox()};S.prototype.setScale=function(e){k.prototype.setScale.call(this,e);this._container.css("width",o(this.width*this._scale)).css("height",o(this.height*this._scale));this._mask.css("width",o(this.width*this._scale)).css("height",o(this.height*this._scale));this._updateSelectedBox();return this};S.prototype.setMonitor=function(e){if(this._selectedUserControls.length==0)return;var t=false;for(var i=0;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];if(s.set("monitorNo",e))t=true}if(t){if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}};S.prototype.setPoint=function(e,t,i){if(this._selectedUserControls.length==0)return;var s=false;for(var r=0;r<this._selectedUserControls.length;r++){var o=this._selectedUserControls[r];if(o.set("channelId",e))s=true;if(o.set("deviceId",t))s=true;if(o.set("signalId",i))s=true}if(s){if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}};S.prototype.setCamera=function(e){if(this._selectedUserControls.length==0)return;var t=false;for(var i=0;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];if(s.set("cameraNo",e))t=true}if(t){if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}};S.prototype.saveControl=function(e,t){var i=k.prototype.saveControl.call(this,e,t);if(i)this._calculateSelectedBox()._updateSelectedBox()};S.prototype.selectAll=function(){if(this._selectedUserControls.length==this._userControls.length)return;this._selectedUserControls=this._userControls.concat();this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.saveControl().showControl()};S.prototype.copy=function(){var e=[];for(var t=0;t<this._selectedUserControls.length;t++){var i=this._selectedUserControls[t];var s={type:i.type};for(var r=0;r<i.properties.length;r++){var o=i.properties[r].key;s[o]=i[o]}e.push(s)}return e};S.prototype.paste=function(e){var t=[];for(var i=0;i<e.length;i++){var s=this._addUserControl(e[i]);t.push(s)}this._selectedUserControls=t;this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.showControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()};S.prototype.del=function(){if(this._selectedUserControls.length==0)return this;for(var e=0;e<this._selectedUserControls.length;e++){var t=this._selectedUserControls[e];this._removeUserControl(t)}this._selectedUserControls=[];this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.showControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent();return this};S.prototype.alignLeft=function(){if(this._selectedUserControls.length<=1)return this;var e=this._selectedUserControls[0].left;var t=false;for(var i=1;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];if(s.set("left",e))t=true}if(t){this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return this};S.prototype.alignCenter=function(){if(this._selectedUserControls.length<=1)return this;var e=this._selectedUserControls[0].left+this._selectedUserControls[0].width/2;var t=false;for(var i=1;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];var r=e-s.width/2;if(s.set("left",r))t=true}if(t){this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return this};S.prototype.alignRight=function(){if(this._selectedUserControls.length<=1)return this;var e=this._selectedUserControls[0].left+this._selectedUserControls[0].width;var t=false;for(var i=1;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];var r=e-s.width;if(s.set("left",r))t=true}if(t){this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return this};S.prototype.alignTop=function(){if(this._selectedUserControls.length<=1)return this;var e=this._selectedUserControls[0].top;var t=false;for(var i=1;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];if(s.set("top",e))t=true}if(t){this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return this};S.prototype.alignMiddle=function(){if(this._selectedUserControls.length<=1)return this;var e=this._selectedUserControls[0].top+this._selectedUserControls[0].height/2;var t=false;for(var i=1;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];var r=e-s.height/2;if(s.set("top",r))t=true}if(t){this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return this};S.prototype.alignBottom=function(){if(this._selectedUserControls.length<=1)return this;var e=this._selectedUserControls[0].top+this._selectedUserControls[0].height;var t=false;for(var i=1;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];var r=e-s.height;if(s.set("top",r))t=true}if(t){this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return this};S.prototype.alignWidth=function(){if(this._selectedUserControls.length<=1)return this;var e=this._selectedUserControls[0].width;var t=false;for(var i=1;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];if(s.set("width",e))t=true}if(t){this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return this};S.prototype.alignHeight=function(){if(this._selectedUserControls.length<=1)return this;var e=this._selectedUserControls[0].height;var t=false;for(var i=1;i<this._selectedUserControls.length;i++){var s=this._selectedUserControls[i];if(s.set("height",e))t=true}if(t){this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return this};S.prototype.move=function(e,t){if(this._selectedUserControls.length==0)return this;var i=false;for(var s=0;s<this._selectedUserControls.length;s++){var r=this._selectedUserControls[s];var o=r.left+e;var a=r.top+t;if(r.set("left",o)||r.set("top",a))i=true}if(i){this._calculateSelectedBox()._updateSelectedBox();if(this._propertyGrid)this._propertyGrid.refreshControl();this._undoRedo.doAction(this.deserialize());this._fireChangeEvent()}return this};function R(e,t){y.call(this,e,_('<div style="position:absolute;"></div>'),[{category:"文本",key:"color",name:"颜色",type:v.color},{category:"文本",key:"alarmColor",name:"报警颜色",type:v.color},{category:"文本",key:"fontSize",name:"大小",type:v.int},{category:"文本",key:"fontFamily",name:"字体",type:v.fontFamily},{category:"文本",key:"fontBold",name:"粗体",type:v.bool},{category:"文本",key:"textAlign",name:"文本对齐",type:v.textAlign},{category:"文本",key:"text",name:"文本",type:v.string}],{type:"text",width:100,height:40,text:"Text",textAlign:"left",color:"white",alarmColor:"white",fontSize:16,fontFamily:"微软雅黑",fontBold:false},t)}h(R,y);t("text",R);R.prototype._apply=function(e,t){switch(e){case"color":this.element.css("color",t);return true;case"alarmColor":return true;case"fontSize":this.element.css("font-size",o(t));return true;case"fontFamily":this.element.css("font-family",t);return true;case"fontBold":this.element.css("font-weight",t?"bold":"normal");return true;case"textAlign":this.element.css("textAlign",t);return true;case"text":this.element.html(t);return true;default:return y.prototype._apply.call(this,e,t)}};R.prototype.updateData=function(e){if(e){this.element.html(e.Text);if(this.alarm&&e.IsAlarm)this.element.css("color",this.alarmColor).css("background-color",this.alarmBackgroundColor);else this.element.css("color",this.color).css("background-color",this.backgroundColor)}else{this.element.html("").css("color",this.color).css("background-color",this.backgroundColor)}};function M(e,t){y.call(this,e,_('<input type="button" style="position:absolute;" />'),[{category:"文本",key:"color",name:"颜色",type:v.color},{category:"文本",key:"alarmColor",name:"报警颜色",type:v.color},{category:"文本",key:"fontSize",name:"大小",type:v.int},{category:"文本",key:"fontFamily",name:"字体",type:v.fontFamily},{category:"文本",key:"fontBold",name:"粗体",type:v.bool},{category:"文本",key:"text",name:"文本",type:v.string}],{type:"button",width:100,height:40,backgroundColor:"#F0F0F0",color:"black",alarmColor:"black",fontSize:16,fontFamily:"微软雅黑",fontBold:false,text:"Button",readable:false,writeable:true},t)}h(M,y);t("button",M);M.prototype._apply=function(e,t){switch(e){case"color":this.element.css("color",t);return true;case"alarmColor":return true;case"fontSize":this.element.css("font-size",o(t));return true;case"fontFamily":this.element.css("font-family",t);return true;case"fontBold":this.element.css("font-weight",t?"bold":"normal");return true;case"text":this.element.val(t);return true;default:return y.prototype._apply.call(this,e,t)}};M.prototype.updateData=function(e){if(e){this.element.val(e.Text);if(this.alarm&&e.IsAlarm)this.element.css("color",this.alarmColor).css("background-color",this.alarmBackgroundColor);else this.element.css("color",this.color).css("background-color",this.backgroundColor)}else this.element.val("").css("color",this.color).css("background-color",this.backgroundColor)};function I(e,t){y.call(this,e,_('<img style="position:absolute;" />'),[{category:"背景",key:"source",name:"图片",type:v.imageSource},{category:"背景",key:"alarmSource",name:"报警图片",type:v.imageSource},{category:"背景",key:"source0",name:"图片0",type:v.imageSource},{category:"背景",key:"source1",name:"图片1",type:v.imageSource},{category:"背景",key:"source2",name:"图片2",type:v.imageSource},{category:"背景",key:"source3",name:"图片3",type:v.imageSource},{category:"背景",key:"source4",name:"图片4",type:v.imageSource},{category:"背景",key:"source5",name:"图片5",type:v.imageSource},{category:"背景",key:"source6",name:"图片6",type:v.imageSource},{category:"背景",key:"source7",name:"图片7",type:v.imageSource}],{type:"image",width:100,height:100,source:null,alarmSource:null,source0:null,source1:null,source2:null,source3:null,source4:null,source5:null,source6:null,source7:null},t)}h(I,y);t("image",I);I.prototype._apply=function(e,t){switch(e){case"source":this.element.attr("src",c(t));return true;case"alarmSource":case"source0":case"source1":case"source2":case"source3":case"source4":case"source5":case"source6":case"source7":return true;default:return y.prototype._apply.call(this,e,t)}};I.prototype.updateData=function(e){if(e){if(this.alarm&&e.IsAlarm)this.element.attr("src",c(this.alarmSource));else if(e.Value=="0")this.element.attr("src",c(this.source0));else if(e.Value=="1")this.element.attr("src",c(this.source1));else if(e.Value=="2")this.element.attr("src",c(this.source2));else if(e.Value=="3")this.element.attr("src",c(this.source3));else if(e.Value=="4")this.element.attr("src",c(this.source4));else if(e.Value=="5")this.element.attr("src",c(this.source5));else if(e.Value=="6")this.element.attr("src",c(this.source6));else if(e.Value=="7")this.element.attr("src",c(this.source7));else this.element.attr("src",c(this.source))}else this.element.attr("src",c(this.source))};function U(e,t){y.call(this,e,_('<div style="position:absolute;"></div>'),[{category:"布局",key:"borderRadius",name:"边界半径",type:v.int},{category:"布局",key:"borderWidth",name:"边框粗细",type:v.int},{category:"布局",key:"borderColor",name:"边框颜色",type:v.color},{category:"背景",key:"backgroundColor0",name:"颜色0",type:v.color},{category:"背景",key:"backgroundColor1",name:"颜色1",type:v.color},{category:"背景",key:"backgroundColor2",name:"颜色2",type:v.color},{category:"背景",key:"backgroundColor3",name:"颜色3",type:v.color},{category:"背景",key:"backgroundColor4",name:"颜色4",type:v.color},{category:"背景",key:"backgroundColor5",name:"颜色5",type:v.color},{category:"背景",key:"backgroundColor6",name:"颜色6",type:v.color},{category:"背景",key:"backgroundColor7",name:"颜色7",type:v.color}],{type:"rectangle",width:200,height:100,borderRadius:0,borderWidth:0,borderColor:"transparent",backgroundColor:"green",backgroundColor0:"green",backgroundColor1:"green",backgroundColor2:"green",backgroundColor3:"green",backgroundColor4:"green",backgroundColor5:"green",backgroundColor6:"green",backgroundColor7:"green"},t);this.element.css("border-style","solid")}h(U,y);t("rectangle",U);U.prototype._apply=function(e,t){switch(e){case"borderRadius":this.element.css("border-radius",o(t));return true;case"borderWidth":this.element.css("border-width",o(t));return true;case"borderColor":this.element.css("border-color",t);return true;case"backgroundColor":this.element.css("background-color",t);return true;case"backgroundColor0":case"backgroundColor1":case"backgroundColor2":case"backgroundColor3":case"backgroundColor4":case"backgroundColor5":case"backgroundColor6":case"backgroundColor7":return true;default:return y.prototype._apply.call(this,e,t)}};U.prototype.updateData=function(e){if(e){if(this.alarm&&e.IsAlarm)this.element.css("background-color",this.alarmBackgroundColor);else if(e.Value=="0")this.element.css("background-color",this.backgroundColor0);else if(e.Value=="1")this.element.css("background-color",this.backgroundColor1);else if(e.Value=="2")this.element.css("background-color",this.backgroundColor2);else if(e.Value=="3")this.element.css("background-color",this.backgroundColor3);else if(e.Value=="4")this.element.css("background-color",this.backgroundColor4);else if(e.Value=="5")this.element.css("background-color",this.backgroundColor5);else if(e.Value=="6")this.element.css("background-color",this.backgroundColor6);else if(e.Value=="7")this.element.css("background-color",this.backgroundColor7);else this.element.attr("background-color",this.backgroundColor)}else this.element.attr("background-color",this.backgroundColor)};function N(e,t){y.call(this,e,_('<iframe style="position:absolute;border:0px;"></iframe>'),[{category:"页面",key:"src",name:"网址",type:v.string}],{type:"webcontrol",width:400,height:300,src:""},t)}h(N,y);t("webcontrol",N);N.prototype._apply=function(e,t){switch(e){case"src":this.element.attr("src",t);return true;default:return y.prototype._apply.call(this,e,t)}};N.prototype.updateData=function(e){};function A(e){this._form=null;this._control=null;this._table=_('<table class="propertygrid"></table>');this._channels=[];this._devices=[];this._signals=[];this._monitors=[];this._cameras=[];this._images=[];this._spectrums=[];this._isChangeValid=true;_("#"+e).append(this._table);var t=this;this._table.on("click","span.icon",function(e){var t=_(this).parent().parent();var i=t.attr("data-category");if(_(this).hasClass("icon-expand")){_(this).removeClass("icon-expand").addClass("icon-collapse");t.siblings("[data-category='"+i+"']").hide()}else{_(this).removeClass("icon-collapse").addClass("icon-expand");t.siblings("[data-category='"+i+"']").show()}}).on("keydown",":input",function(e){if(e.which==13){e.preventDefault();e.stopPropagation();_(this).blur()}}).on("change",":input",function(){if(t._isChangeValid)t.saveControl(_(this))})}var D=null;_.scada.pickImage=function(){var e=document.getElementById("imageFrame").contentWindow;var t=e.no||"";var i=e.name||"";_(D).attr("data-value",t).val(i).change()};_.fn.imagePicker=function(){this.click(function(){D=this;w2popup.open({title:"选择图片",body:'<iframe id="imageFrame" src="'+_.scada.imagePicker+'" frameborder="0" style="width:100%;height:100%;"></iframe>',buttons:'<button class="w2ui-btn" onclick="$.scada.pickImage();w2popup.close();">确定</button><button class="w2ui-btn" onclick="w2popup.close();">取消</button>',width:810,height:600,modal:true})})};A.prototype._addText=function(e){this._table.append("<tr><th>"+e+"</th></tr>")};A.prototype._addHead=function(){this._table.append('<tr class="head"><th class="index"></th><th class="key">属性</th><th>值</th></tr>')};A.prototype._addCategory=function(e){var t=this._table.find("tr[data-category='"+e+"']");if(t.length==0)this._table.append('<tr class="category" data-category="'+e+'"><td class="index"><span class="icon icon-expand"></span></td><td colspan="2">'+e+"</td></tr>")};A.prototype._addProperty=function(e,t){var i=_('<tr class="property" data-category="'+t.category+'"><td class="index"></td><td class="key">'+t.name+"</td></tr>");var s=_('<td data-index="'+e+'"></td>').appendTo(i);var r=t.key;var o=this._control[r];if(t.type==v.bool){var a=_('<input type="checkbox" />');a.prop("checked",o);s.append(a)}else if(t.type==v.int){var n=_('<input type="text" />');n.val(o);s.append(n)}else if(t.type==v.float){var n=_('<input type="text" />');n.val(o);s.append(n)}else if(t.type==v.floatToInt){var n=_('<input type="text" />');n.attr("data-value",o).val(Math.round(o));s.append(n)}else if(t.type==v.string){var n=_('<input type="text" />');n.val(o);s.append(n)}else if(t.type==v.color){var n=_('<input type="text" readonly="readonly" />');this._spectrums.push(n);n.val(o).spectrum({showAlpha:true,showPalette:true,palette:[["transparent"],["white"],["gray"],["black"],["red"],["green"],["blue"]],showInitial:true,showInput:true,cancelText:" 取消 ",chooseText:" 确定 ",hideAfterPaletteSelect:true,showSelectionPalette:false,preferredFormat:"hex",theme:"sp-dark"});s.append(n)}else if(t.type==v.fontFamily){var l=_("<select></select>");for(var h=0;h<m.length;h++)l.append('<option value="'+m[h]+'">'+m[h]+"</option>");l.val(o);s.append(l)}else if(t.type==v.imageSource){var c="";if(o){var d=this._findImageName(o);if(d)c=d}var n=_('<input type="text" readonly="readonly">');n.attr("data-value",o).val(c).imagePicker();s.append(n)}else if(t.type==v.target){var l=_("<select></select>");for(var r in b)l.append('<option value="'+r+'">'+b[r]+"</option>");l.val(o);s.append(l)}else if(t.type==v.textAlign){var l=_("<select></select>");for(var r in w)l.append('<option value="'+r+'">'+w[r]+"</option>");l.val(o);s.append(l)}else if(t.type==v.channelId){var c="";if(o){var u=this._findChannel(o);if(u)c=u.Name}var n=_('<input type="text" readonly="readonly">');n.attr("data-value",o).val(c).change();s.append(n)}else if(t.type==v.deviceId){var c="";if(o){var f=this._findDevice(o);if(f)c=f.Name}var n=_('<input type="text" readonly="readonly">');n.attr("data-value",o).val(c).change();s.append(n)}else if(t.type==v.signalId){var c="";if(o){var p=this._control.deviceId;var g=this._findSignal(p,o);if(g)c=g.Name}var n=_('<input type="text" readonly="readonly">');n.attr("data-value",o).val(c).change();s.append(n)}else if(t.type==v.monitorNo){var c="";if(o)c=this._findMonitorName(o);var n=_('<input type="text" readonly="readonly">');n.attr("data-value",o).val(c).change();s.append(n)}else if(t.type==v.cameraNo){var c="";if(o){var y=this._findCamera(o);if(y)c=y.Name}var n=_('<input type="text" readonly="readonly">');n.attr("data-value",o).val(c).change();s.append(n)}else{var n=_('<input type="text" />');n.val(o);s.append(n)}this._table.find("tr[data-category='"+t.category+"']").last().after(i)};A.prototype.showControl=function(){var e=null;var t=1;if(this._form){var i=this._form.getSelectedUserControls();if(i.length==0)e=this._form;else if(i.length==1)e=i[0];else{t=i.length;this._isChangeValid=false;this._table.empty();this._isChangeValid=true;this._addText("选择了"+t+"个控件")}}if(this._control==e){this.refreshControl();return this}for(var s=0;s<this._spectrums.length;s++)this._spectrums[s].spectrum("destroy");this._spectrums=[];this._control=e;if(t==1){this._isChangeValid=false;this._table.empty();this._isChangeValid=true;this._addHead();if(this._control&&this._control.properties){var r=this._control.properties;for(var s=0;s<r.length;s++){var o=r[s];this._addCategory(o.category);this._addProperty(s,o)}}}return this};A.prototype.refreshControl=function(){if(!this._control)return this;var u=this;this._table.find(":input").each(function(){var e=parseInt(_(this).parent().attr("data-index"));var t=u._control.properties[e];var i=t.key;var s=u._control[i];if(t.type==v.bool){if(s!=_(this).prop("checked"))_(this).prop("checked",s).change()}else if(t.type==v.floatToInt){if(s!=parseFloat(_(this).attr("data-value")))_(this).attr("data-value",s).val(Math.round(s)).change()}else if(t.type==v.imageSource){var r=parseInt(_(this).attr("data-value"));if(isNaN(r))r=null;if(s!=r){var o="";if(s){var a=u._findImageName(s);if(a)o=a}_(this).attr("data-value",s).val(o).change()}}else if(t.type==v.channelId){if(s!=_(this).attr("data-value")){var o="";if(s){var n=u._findChannel(s);if(n)o=n.Name}_(this).attr("data-value",s).val(o).change()}}else if(t.type==v.deviceId){if(s!=_(this).attr("data-value")){var o="";if(s){var l=u._findDevice(s);if(l)o=l.Name}_(this).attr("data-value",s).val(o).change()}}else if(t.type==v.signalId){if(s!=_(this).attr("data-value")){var o="";if(s){var h=u._control.deviceId;if(h){var c=u._findSignal(h,s);if(c)o=c.Name}}_(this).attr("data-value",s).val(o).change()}}else if(t.type==v.monitorNo){var r=parseInt(_(this).attr("data-value"));if(isNaN(r))r=null;if(s!=r){var o="";if(s)o=u._findMonitorName(s);_(this).attr("data-value",s).val(o).change()}}else if(t.type==v.cameraNo){var r=parseInt(_(this).attr("data-value"));if(isNaN(r))r=null;if(s!=r){var o="";if(s){var d=u._findCamera(s);if(d)o=d.Name}_(this).attr("data-value",s).val(o).change()}}else{if(s!=_(this).val())_(this).val(s).change()}});return this};A.prototype.saveControl=function(e){if(!this._control)return this;var s={};var r=this;e=e||this._table.find(":input");e.each(function(){var e=parseInt(_(this).parent().attr("data-index"));var t=r._control.properties[e];if(t.type==v.bool){var i=_(this).prop("checked");s[t.key]=i}else if(t.type==v.int){var i=parseInt(_(this).val());if(isNaN(i))i=r._control[t.key];_(this).val(i);s[t.key]=i}else if(t.type==v.float){var i=parseFloat(_(this).val());if(isNaN(i))i=r._control[t.key];_(this).val(i);s[t.key]=i}else if(t.type==v.floatToInt){var i=parseInt(_(this).val());if(isNaN(i))i=r._control[t.key];_(this).attr("data-value",i).val(Math.round(i));s[t.key]=i}else if(t.type==v.color){var i=_(this).val();s[t.key]=i==""?"transparent":i}else if(t.type==v.imageSource||t.type==v.monitorNo||t.type==v.cameraNo){var i=parseInt(_(this).attr("data-value"));if(isNaN(i))i=null;s[t.key]=i}else if(t.type==v.channelId||t.type==v.deviceId||t.type==v.signalId){var i=_(this).attr("data-value");s[t.key]=i==""?null:i}else{var i=_(this).val();s[t.key]=i}});this._form.saveControl(this._control,s);return this};A.prototype.setForm=function(e){if(this._form==e)return false;this._form=e;if(this._form)this._form.setPropertyGrid(this);this.showControl();return true};A.prototype.setPoints=function(e,t,i){this._channels=e;this._devices=t;this._signals=i};A.prototype.setMonitors=function(e){this._monitors=e};A.prototype.setCameras=function(e){this._cameras=e};A.prototype.setImages=function(e){this._images=e};A.prototype._getPointName=function(e,t){if(e.length==0||t.length==0)return"";var i=this._findDevice(e);if(!i)return"";var s=this._findChannel(i.ChannelId);if(!s)return"";var r=this._findSignalId(e,t);if(!r)return"";return s.Name+">"+i.Name+">"+r.Name};A.prototype._findChannel=function(e){for(var t=0;t<this._channels.length;t++){var i=this._channels[t];if(i.Id==e)return i}return null};A.prototype._findDevice=function(e){for(var t=0;t<this._devices.length;t++){var i=this._devices[t];if(i.Id==e)return i}return null};A.prototype._findSignal=function(e,t){for(var i=0;i<this._signals.length;i++){var s=this._signals[i];if(s.Id==t&&s.DeviceId==e)return s}return null};A.prototype._findMonitorName=function(e){var t="";while(true){var i=this._findMonitor(e);if(!i)break;if(t)t=i.Name+">"+t;else t=i.Name;e=i.ParentNo;if(e==0)break}return t};A.prototype._findMonitor=function(e){for(var t=0;t<this._monitors.length;t++){var i=this._monitors[t];if(i.No==e)return i}return null};A.prototype._findCamera=function(e){for(var t=0;t<this._cameras.length;t++){var i=this._cameras[t];if(i.No==e)return i}return null};A.prototype._findImageName=function(e){if(e==0||e=="0")return"noimage.jpg";for(var t=0;t<this._images.length;t++){var i=this._images[t];if(i.No==e)return i.Name}return""};function B(e){_("#"+e).find(".widgetitem").on("dragstart",function(e){e.originalEvent.dataTransfer.setData("text",_(this).attr("data-userControl"))})}_.scada.WebBrowser=C;_.scada.StaticCanvas=k;_.scada.Canvas=S;_.scada.PropertyGrid=A;_.scada.WidgetBar=B})(jQuery);